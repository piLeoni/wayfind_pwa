function b7(t,e){for(var n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&!Array.isArray(o)){for(const u in o)if(u!=="default"&&!(u in t)){const d=Object.getOwnPropertyDescriptor(o,u);d&&Object.defineProperty(t,u,d.get?d:{enumerable:!0,get:()=>o[u]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const _ of d.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function n(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(u){if(u.ep)return;u.ep=!0;const d=n(u);fetch(u.href,d)}})();var Cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function wh(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var u=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,u.get?u:{enumerable:!0,get:function(){return t[o]}})}),n}var w7={exports:{}},lT={},C7={exports:{}},Nn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1=Symbol.for("react.element"),qJ=Symbol.for("react.portal"),KJ=Symbol.for("react.fragment"),YJ=Symbol.for("react.strict_mode"),ZJ=Symbol.for("react.profiler"),XJ=Symbol.for("react.provider"),QJ=Symbol.for("react.context"),JJ=Symbol.for("react.forward_ref"),eee=Symbol.for("react.suspense"),tee=Symbol.for("react.memo"),ree=Symbol.for("react.lazy"),a6=Symbol.iterator;function nee(t){return t===null||typeof t!="object"?null:(t=a6&&t[a6]||t["@@iterator"],typeof t=="function"?t:null)}var E7={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S7=Object.assign,T7={};function C_(t,e,n){this.props=t,this.context=e,this.refs=T7,this.updater=n||E7}C_.prototype.isReactComponent={};C_.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};C_.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function A7(){}A7.prototype=C_.prototype;function X4(t,e,n){this.props=t,this.context=e,this.refs=T7,this.updater=n||E7}var Q4=X4.prototype=new A7;Q4.constructor=X4;S7(Q4,C_.prototype);Q4.isPureReactComponent=!0;var l6=Array.isArray,I7=Object.prototype.hasOwnProperty,J4={current:null},M7={key:!0,ref:!0,__self:!0,__source:!0};function P7(t,e,n){var o,u={},d=null,_=null;if(e!=null)for(o in e.ref!==void 0&&(_=e.ref),e.key!==void 0&&(d=""+e.key),e)I7.call(e,o)&&!M7.hasOwnProperty(o)&&(u[o]=e[o]);var v=arguments.length-2;if(v===1)u.children=n;else if(1<v){for(var a=Array(v),C=0;C<v;C++)a[C]=arguments[C+2];u.children=a}if(t&&t.defaultProps)for(o in v=t.defaultProps,v)u[o]===void 0&&(u[o]=v[o]);return{$$typeof:k1,type:t,key:d,ref:_,props:u,_owner:J4.current}}function iee(t,e){return{$$typeof:k1,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function eD(t){return typeof t=="object"&&t!==null&&t.$$typeof===k1}function oee(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var c6=/\/+/g;function cM(t,e){return typeof t=="object"&&t!==null&&t.key!=null?oee(""+t.key):e.toString(36)}function XC(t,e,n,o,u){var d=typeof t;(d==="undefined"||d==="boolean")&&(t=null);var _=!1;if(t===null)_=!0;else switch(d){case"string":case"number":_=!0;break;case"object":switch(t.$$typeof){case k1:case qJ:_=!0}}if(_)return _=t,u=u(_),t=o===""?"."+cM(_,0):o,l6(u)?(n="",t!=null&&(n=t.replace(c6,"$&/")+"/"),XC(u,e,n,"",function(C){return C})):u!=null&&(eD(u)&&(u=iee(u,n+(!u.key||_&&_.key===u.key?"":(""+u.key).replace(c6,"$&/")+"/")+t)),e.push(u)),1;if(_=0,o=o===""?".":o+":",l6(t))for(var v=0;v<t.length;v++){d=t[v];var a=o+cM(d,v);_+=XC(d,e,n,a,u)}else if(a=nee(t),typeof a=="function")for(t=a.call(t),v=0;!(d=t.next()).done;)d=d.value,a=o+cM(d,v++),_+=XC(d,e,n,a,u);else if(d==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return _}function iC(t,e,n){if(t==null)return t;var o=[],u=0;return XC(t,o,"","",function(d){return e.call(n,d,u++)}),o}function see(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var na={current:null},QC={transition:null},aee={ReactCurrentDispatcher:na,ReactCurrentBatchConfig:QC,ReactCurrentOwner:J4};function R7(){throw Error("act(...) is not supported in production builds of React.")}Nn.Children={map:iC,forEach:function(t,e,n){iC(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return iC(t,function(){e++}),e},toArray:function(t){return iC(t,function(e){return e})||[]},only:function(t){if(!eD(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Nn.Component=C_;Nn.Fragment=KJ;Nn.Profiler=ZJ;Nn.PureComponent=X4;Nn.StrictMode=YJ;Nn.Suspense=eee;Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aee;Nn.act=R7;Nn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var o=S7({},t.props),u=t.key,d=t.ref,_=t._owner;if(e!=null){if(e.ref!==void 0&&(d=e.ref,_=J4.current),e.key!==void 0&&(u=""+e.key),t.type&&t.type.defaultProps)var v=t.type.defaultProps;for(a in e)I7.call(e,a)&&!M7.hasOwnProperty(a)&&(o[a]=e[a]===void 0&&v!==void 0?v[a]:e[a])}var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){v=Array(a);for(var C=0;C<a;C++)v[C]=arguments[C+2];o.children=v}return{$$typeof:k1,type:t.type,key:u,ref:d,props:o,_owner:_}};Nn.createContext=function(t){return t={$$typeof:QJ,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:XJ,_context:t},t.Consumer=t};Nn.createElement=P7;Nn.createFactory=function(t){var e=P7.bind(null,t);return e.type=t,e};Nn.createRef=function(){return{current:null}};Nn.forwardRef=function(t){return{$$typeof:JJ,render:t}};Nn.isValidElement=eD;Nn.lazy=function(t){return{$$typeof:ree,_payload:{_status:-1,_result:t},_init:see}};Nn.memo=function(t,e){return{$$typeof:tee,type:t,compare:e===void 0?null:e}};Nn.startTransition=function(t){var e=QC.transition;QC.transition={};try{t()}finally{QC.transition=e}};Nn.unstable_act=R7;Nn.useCallback=function(t,e){return na.current.useCallback(t,e)};Nn.useContext=function(t){return na.current.useContext(t)};Nn.useDebugValue=function(){};Nn.useDeferredValue=function(t){return na.current.useDeferredValue(t)};Nn.useEffect=function(t,e){return na.current.useEffect(t,e)};Nn.useId=function(){return na.current.useId()};Nn.useImperativeHandle=function(t,e,n){return na.current.useImperativeHandle(t,e,n)};Nn.useInsertionEffect=function(t,e){return na.current.useInsertionEffect(t,e)};Nn.useLayoutEffect=function(t,e){return na.current.useLayoutEffect(t,e)};Nn.useMemo=function(t,e){return na.current.useMemo(t,e)};Nn.useReducer=function(t,e,n){return na.current.useReducer(t,e,n)};Nn.useRef=function(t){return na.current.useRef(t)};Nn.useState=function(t){return na.current.useState(t)};Nn.useSyncExternalStore=function(t,e,n){return na.current.useSyncExternalStore(t,e,n)};Nn.useTransition=function(){return na.current.useTransition()};Nn.version="18.3.1";C7.exports=Nn;var fe=C7.exports;const wi=aT(fe),Hg=b7({__proto__:null,default:wi},[fe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lee=fe,cee=Symbol.for("react.element"),uee=Symbol.for("react.fragment"),hee=Object.prototype.hasOwnProperty,dee=lee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fee={key:!0,ref:!0,__self:!0,__source:!0};function k7(t,e,n){var o,u={},d=null,_=null;n!==void 0&&(d=""+n),e.key!==void 0&&(d=""+e.key),e.ref!==void 0&&(_=e.ref);for(o in e)hee.call(e,o)&&!fee.hasOwnProperty(o)&&(u[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps,e)u[o]===void 0&&(u[o]=e[o]);return{$$typeof:cee,type:t,key:d,ref:_,props:u,_owner:dee.current}}lT.Fragment=uee;lT.jsx=k7;lT.jsxs=k7;w7.exports=lT;var Ke=w7.exports,AR={},D7={exports:{}},rl={},O7={exports:{}},L7={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Xe,Mt){var Lt=Xe.length;Xe.push(Mt);e:for(;0<Lt;){var nt=Lt-1>>>1,at=Xe[nt];if(0<u(at,Mt))Xe[nt]=Mt,Xe[Lt]=at,Lt=nt;else break e}}function n(Xe){return Xe.length===0?null:Xe[0]}function o(Xe){if(Xe.length===0)return null;var Mt=Xe[0],Lt=Xe.pop();if(Lt!==Mt){Xe[0]=Lt;e:for(var nt=0,at=Xe.length,it=at>>>1;nt<it;){var tt=2*(nt+1)-1,Jt=Xe[tt],$t=tt+1,Lr=Xe[$t];if(0>u(Jt,Lt))$t<at&&0>u(Lr,Jt)?(Xe[nt]=Lr,Xe[$t]=Lt,nt=$t):(Xe[nt]=Jt,Xe[tt]=Lt,nt=tt);else if($t<at&&0>u(Lr,Lt))Xe[nt]=Lr,Xe[$t]=Lt,nt=$t;else break e}}return Mt}function u(Xe,Mt){var Lt=Xe.sortIndex-Mt.sortIndex;return Lt!==0?Lt:Xe.id-Mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;t.unstable_now=function(){return d.now()}}else{var _=Date,v=_.now();t.unstable_now=function(){return _.now()-v}}var a=[],C=[],A=1,k=null,O=3,R=!1,z=!1,N=!1,K=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(Xe){for(var Mt=n(C);Mt!==null;){if(Mt.callback===null)o(C);else if(Mt.startTime<=Xe)o(C),Mt.sortIndex=Mt.expirationTime,e(a,Mt);else break;Mt=n(C)}}function Y(Xe){if(N=!1,H(Xe),!z)if(n(a)!==null)z=!0,ft(te);else{var Mt=n(C);Mt!==null&&et(Y,Mt.startTime-Xe)}}function te(Xe,Mt){z=!1,N&&(N=!1,q(de),de=-1),R=!0;var Lt=O;try{for(H(Mt),k=n(a);k!==null&&(!(k.expirationTime>Mt)||Xe&&!Ae());){var nt=k.callback;if(typeof nt=="function"){k.callback=null,O=k.priorityLevel;var at=nt(k.expirationTime<=Mt);Mt=t.unstable_now(),typeof at=="function"?k.callback=at:k===n(a)&&o(a),H(Mt)}else o(a);k=n(a)}if(k!==null)var it=!0;else{var tt=n(C);tt!==null&&et(Y,tt.startTime-Mt),it=!1}return it}finally{k=null,O=Lt,R=!1}}var J=!1,ae=null,de=-1,Me=5,Ce=-1;function Ae(){return!(t.unstable_now()-Ce<Me)}function Ne(){if(ae!==null){var Xe=t.unstable_now();Ce=Xe;var Mt=!0;try{Mt=ae(!0,Xe)}finally{Mt?Re():(J=!1,ae=null)}}else J=!1}var Re;if(typeof j=="function")Re=function(){j(Ne)};else if(typeof MessageChannel<"u"){var Ye=new MessageChannel,ht=Ye.port2;Ye.port1.onmessage=Ne,Re=function(){ht.postMessage(null)}}else Re=function(){K(Ne,0)};function ft(Xe){ae=Xe,J||(J=!0,Re())}function et(Xe,Mt){de=K(function(){Xe(t.unstable_now())},Mt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Xe){Xe.callback=null},t.unstable_continueExecution=function(){z||R||(z=!0,ft(te))},t.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Me=0<Xe?Math.floor(1e3/Xe):5},t.unstable_getCurrentPriorityLevel=function(){return O},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(Xe){switch(O){case 1:case 2:case 3:var Mt=3;break;default:Mt=O}var Lt=O;O=Mt;try{return Xe()}finally{O=Lt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Xe,Mt){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var Lt=O;O=Xe;try{return Mt()}finally{O=Lt}},t.unstable_scheduleCallback=function(Xe,Mt,Lt){var nt=t.unstable_now();switch(typeof Lt=="object"&&Lt!==null?(Lt=Lt.delay,Lt=typeof Lt=="number"&&0<Lt?nt+Lt:nt):Lt=nt,Xe){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=Lt+at,Xe={id:A++,callback:Mt,priorityLevel:Xe,startTime:Lt,expirationTime:at,sortIndex:-1},Lt>nt?(Xe.sortIndex=Lt,e(C,Xe),n(a)===null&&Xe===n(C)&&(N?(q(de),de=-1):N=!0,et(Y,Lt-nt))):(Xe.sortIndex=at,e(a,Xe),z||R||(z=!0,ft(te))),Xe},t.unstable_shouldYield=Ae,t.unstable_wrapCallback=function(Xe){var Mt=O;return function(){var Lt=O;O=Mt;try{return Xe.apply(this,arguments)}finally{O=Lt}}}})(L7);O7.exports=L7;var pee=O7.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mee=fe,Qa=pee;function nr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B7=new Set,Gx={};function gm(t,e){Gg(t,e),Gg(t+"Capture",e)}function Gg(t,e){for(Gx[t]=e,t=0;t<e.length;t++)B7.add(e[t])}var ph=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),IR=Object.prototype.hasOwnProperty,gee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u6={},h6={};function _ee(t){return IR.call(h6,t)?!0:IR.call(u6,t)?!1:gee.test(t)?h6[t]=!0:(u6[t]=!0,!1)}function yee(t,e,n,o){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vee(t,e,n,o){if(e===null||typeof e>"u"||yee(t,e,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ia(t,e,n,o,u,d,_){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=u,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=d,this.removeEmptyString=_}var Ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ts[t]=new ia(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ts[e]=new ia(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ts[t]=new ia(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ts[t]=new ia(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ts[t]=new ia(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ts[t]=new ia(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ts[t]=new ia(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ts[t]=new ia(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ts[t]=new ia(t,5,!1,t.toLowerCase(),null,!1,!1)});var tD=/[\-:]([a-z])/g;function rD(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tD,rD);Ts[e]=new ia(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tD,rD);Ts[e]=new ia(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tD,rD);Ts[e]=new ia(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ts[t]=new ia(t,1,!1,t.toLowerCase(),null,!1,!1)});Ts.xlinkHref=new ia("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ts[t]=new ia(t,1,!1,t.toLowerCase(),null,!0,!0)});function nD(t,e,n,o){var u=Ts.hasOwnProperty(e)?Ts[e]:null;(u!==null?u.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vee(e,n,u,o)&&(n=null),o||u===null?_ee(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):u.mustUseProperty?t[u.propertyName]=n===null?u.type===3?!1:"":n:(e=u.attributeName,o=u.attributeNamespace,n===null?t.removeAttribute(e):(u=u.type,n=u===3||u===4&&n===!0?"":""+n,o?t.setAttributeNS(o,e,n):t.setAttribute(e,n))))}var Ch=mee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oC=Symbol.for("react.element"),sg=Symbol.for("react.portal"),ag=Symbol.for("react.fragment"),iD=Symbol.for("react.strict_mode"),MR=Symbol.for("react.profiler"),F7=Symbol.for("react.provider"),z7=Symbol.for("react.context"),oD=Symbol.for("react.forward_ref"),PR=Symbol.for("react.suspense"),RR=Symbol.for("react.suspense_list"),sD=Symbol.for("react.memo"),Md=Symbol.for("react.lazy"),N7=Symbol.for("react.offscreen"),d6=Symbol.iterator;function Lv(t){return t===null||typeof t!="object"?null:(t=d6&&t[d6]||t["@@iterator"],typeof t=="function"?t:null)}var so=Object.assign,uM;function nx(t){if(uM===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uM=e&&e[1]||""}return`
`+uM+t}var hM=!1;function dM(t,e){if(!t||hM)return"";hM=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(C){var o=C}Reflect.construct(t,[],e)}else{try{e.call()}catch(C){o=C}t.call(e.prototype)}else{try{throw Error()}catch(C){o=C}t()}}catch(C){if(C&&o&&typeof C.stack=="string"){for(var u=C.stack.split(`
`),d=o.stack.split(`
`),_=u.length-1,v=d.length-1;1<=_&&0<=v&&u[_]!==d[v];)v--;for(;1<=_&&0<=v;_--,v--)if(u[_]!==d[v]){if(_!==1||v!==1)do if(_--,v--,0>v||u[_]!==d[v]){var a=`
`+u[_].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=_&&0<=v);break}}}finally{hM=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?nx(t):""}function xee(t){switch(t.tag){case 5:return nx(t.type);case 16:return nx("Lazy");case 13:return nx("Suspense");case 19:return nx("SuspenseList");case 0:case 2:case 15:return t=dM(t.type,!1),t;case 11:return t=dM(t.type.render,!1),t;case 1:return t=dM(t.type,!0),t;default:return""}}function kR(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ag:return"Fragment";case sg:return"Portal";case MR:return"Profiler";case iD:return"StrictMode";case PR:return"Suspense";case RR:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case z7:return(t.displayName||"Context")+".Consumer";case F7:return(t._context.displayName||"Context")+".Provider";case oD:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sD:return e=t.displayName||null,e!==null?e:kR(t.type)||"Memo";case Md:e=t._payload,t=t._init;try{return kR(t(e))}catch{}}return null}function bee(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kR(e);case 8:return e===iD?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ef(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function U7(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wee(t){var e=U7(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),o=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var u=n.get,d=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return u.call(this)},set:function(_){o=""+_,d.call(this,_)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(_){o=""+_},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sC(t){t._valueTracker||(t._valueTracker=wee(t))}function $7(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),o="";return t&&(o=U7(t)?t.checked?"true":"false":t.value),t=o,t!==n?(e.setValue(t),!0):!1}function zE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function DR(t,e){var n=e.checked;return so({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function f6(t,e){var n=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;n=ef(e.value!=null?e.value:n),t._wrapperState={initialChecked:o,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function j7(t,e){e=e.checked,e!=null&&nD(t,"checked",e,!1)}function OR(t,e){j7(t,e);var n=ef(e.value),o=e.type;if(n!=null)o==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(o==="submit"||o==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?LR(t,e.type,n):e.hasOwnProperty("defaultValue")&&LR(t,e.type,ef(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function p6(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function LR(t,e,n){(e!=="number"||zE(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ix=Array.isArray;function Ag(t,e,n,o){if(t=t.options,e){e={};for(var u=0;u<n.length;u++)e["$"+n[u]]=!0;for(n=0;n<t.length;n++)u=e.hasOwnProperty("$"+t[n].value),t[n].selected!==u&&(t[n].selected=u),u&&o&&(t[n].defaultSelected=!0)}else{for(n=""+ef(n),e=null,u=0;u<t.length;u++){if(t[u].value===n){t[u].selected=!0,o&&(t[u].defaultSelected=!0);return}e!==null||t[u].disabled||(e=t[u])}e!==null&&(e.selected=!0)}}function BR(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(nr(91));return so({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function m6(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(nr(92));if(ix(n)){if(1<n.length)throw Error(nr(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ef(n)}}function V7(t,e){var n=ef(e.value),o=ef(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),o!=null&&(t.defaultValue=""+o)}function g6(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function H7(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function FR(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?H7(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var aC,G7=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,o,u){MSApp.execUnsafeLocalFunction(function(){return t(e,n,o,u)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(aC=aC||document.createElement("div"),aC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=aC.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Wx(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cee=["Webkit","ms","Moz","O"];Object.keys(bx).forEach(function(t){Cee.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bx[e]=bx[t]})});function W7(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bx.hasOwnProperty(t)&&bx[t]?(""+e).trim():e+"px"}function q7(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var o=n.indexOf("--")===0,u=W7(n,e[n],o);n==="float"&&(n="cssFloat"),o?t.setProperty(n,u):t[n]=u}}var Eee=so({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zR(t,e){if(e){if(Eee[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(nr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(nr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(nr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(nr(62))}}function NR(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var UR=null;function aD(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $R=null,Ig=null,Mg=null;function _6(t){if(t=L1(t)){if(typeof $R!="function")throw Error(nr(280));var e=t.stateNode;e&&(e=fT(e),$R(t.stateNode,t.type,e))}}function K7(t){Ig?Mg?Mg.push(t):Mg=[t]:Ig=t}function Y7(){if(Ig){var t=Ig,e=Mg;if(Mg=Ig=null,_6(t),e)for(t=0;t<e.length;t++)_6(e[t])}}function Z7(t,e){return t(e)}function X7(){}var fM=!1;function Q7(t,e,n){if(fM)return t(e,n);fM=!0;try{return Z7(t,e,n)}finally{fM=!1,(Ig!==null||Mg!==null)&&(X7(),Y7())}}function qx(t,e){var n=t.stateNode;if(n===null)return null;var o=fT(n);if(o===null)return null;n=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(nr(231,e,typeof n));return n}var jR=!1;if(ph)try{var Bv={};Object.defineProperty(Bv,"passive",{get:function(){jR=!0}}),window.addEventListener("test",Bv,Bv),window.removeEventListener("test",Bv,Bv)}catch{jR=!1}function See(t,e,n,o,u,d,_,v,a){var C=Array.prototype.slice.call(arguments,3);try{e.apply(n,C)}catch(A){this.onError(A)}}var wx=!1,NE=null,UE=!1,VR=null,Tee={onError:function(t){wx=!0,NE=t}};function Aee(t,e,n,o,u,d,_,v,a){wx=!1,NE=null,See.apply(Tee,arguments)}function Iee(t,e,n,o,u,d,_,v,a){if(Aee.apply(this,arguments),wx){if(wx){var C=NE;wx=!1,NE=null}else throw Error(nr(198));UE||(UE=!0,VR=C)}}function _m(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function J7(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function y6(t){if(_m(t)!==t)throw Error(nr(188))}function Mee(t){var e=t.alternate;if(!e){if(e=_m(t),e===null)throw Error(nr(188));return e!==t?null:t}for(var n=t,o=e;;){var u=n.return;if(u===null)break;var d=u.alternate;if(d===null){if(o=u.return,o!==null){n=o;continue}break}if(u.child===d.child){for(d=u.child;d;){if(d===n)return y6(u),t;if(d===o)return y6(u),e;d=d.sibling}throw Error(nr(188))}if(n.return!==o.return)n=u,o=d;else{for(var _=!1,v=u.child;v;){if(v===n){_=!0,n=u,o=d;break}if(v===o){_=!0,o=u,n=d;break}v=v.sibling}if(!_){for(v=d.child;v;){if(v===n){_=!0,n=d,o=u;break}if(v===o){_=!0,o=d,n=u;break}v=v.sibling}if(!_)throw Error(nr(189))}}if(n.alternate!==o)throw Error(nr(190))}if(n.tag!==3)throw Error(nr(188));return n.stateNode.current===n?t:e}function e$(t){return t=Mee(t),t!==null?t$(t):null}function t$(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=t$(t);if(e!==null)return e;t=t.sibling}return null}var r$=Qa.unstable_scheduleCallback,v6=Qa.unstable_cancelCallback,Pee=Qa.unstable_shouldYield,Ree=Qa.unstable_requestPaint,wo=Qa.unstable_now,kee=Qa.unstable_getCurrentPriorityLevel,lD=Qa.unstable_ImmediatePriority,n$=Qa.unstable_UserBlockingPriority,$E=Qa.unstable_NormalPriority,Dee=Qa.unstable_LowPriority,i$=Qa.unstable_IdlePriority,cT=null,cu=null;function Oee(t){if(cu&&typeof cu.onCommitFiberRoot=="function")try{cu.onCommitFiberRoot(cT,t,void 0,(t.current.flags&128)===128)}catch{}}var _c=Math.clz32?Math.clz32:Fee,Lee=Math.log,Bee=Math.LN2;function Fee(t){return t>>>=0,t===0?32:31-(Lee(t)/Bee|0)|0}var lC=64,cC=4194304;function ox(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jE(t,e){var n=t.pendingLanes;if(n===0)return 0;var o=0,u=t.suspendedLanes,d=t.pingedLanes,_=n&268435455;if(_!==0){var v=_&~u;v!==0?o=ox(v):(d&=_,d!==0&&(o=ox(d)))}else _=n&~u,_!==0?o=ox(_):d!==0&&(o=ox(d));if(o===0)return 0;if(e!==0&&e!==o&&!(e&u)&&(u=o&-o,d=e&-e,u>=d||u===16&&(d&4194240)!==0))return e;if(o&4&&(o|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=o;0<e;)n=31-_c(e),u=1<<n,o|=t[n],e&=~u;return o}function zee(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nee(t,e){for(var n=t.suspendedLanes,o=t.pingedLanes,u=t.expirationTimes,d=t.pendingLanes;0<d;){var _=31-_c(d),v=1<<_,a=u[_];a===-1?(!(v&n)||v&o)&&(u[_]=zee(v,e)):a<=e&&(t.expiredLanes|=v),d&=~v}}function HR(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function o$(){var t=lC;return lC<<=1,!(lC&4194240)&&(lC=64),t}function pM(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function D1(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_c(e),t[e]=n}function Uee(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var o=t.eventTimes;for(t=t.expirationTimes;0<n;){var u=31-_c(n),d=1<<u;e[u]=0,o[u]=-1,t[u]=-1,n&=~d}}function cD(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var o=31-_c(n),u=1<<o;u&e|t[o]&e&&(t[o]|=e),n&=~u}}var gi=0;function s$(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var a$,uD,l$,c$,u$,GR=!1,uC=[],jd=null,Vd=null,Hd=null,Kx=new Map,Yx=new Map,Dd=[],$ee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function x6(t,e){switch(t){case"focusin":case"focusout":jd=null;break;case"dragenter":case"dragleave":Vd=null;break;case"mouseover":case"mouseout":Hd=null;break;case"pointerover":case"pointerout":Kx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yx.delete(e.pointerId)}}function Fv(t,e,n,o,u,d){return t===null||t.nativeEvent!==d?(t={blockedOn:e,domEventName:n,eventSystemFlags:o,nativeEvent:d,targetContainers:[u]},e!==null&&(e=L1(e),e!==null&&uD(e)),t):(t.eventSystemFlags|=o,e=t.targetContainers,u!==null&&e.indexOf(u)===-1&&e.push(u),t)}function jee(t,e,n,o,u){switch(e){case"focusin":return jd=Fv(jd,t,e,n,o,u),!0;case"dragenter":return Vd=Fv(Vd,t,e,n,o,u),!0;case"mouseover":return Hd=Fv(Hd,t,e,n,o,u),!0;case"pointerover":var d=u.pointerId;return Kx.set(d,Fv(Kx.get(d)||null,t,e,n,o,u)),!0;case"gotpointercapture":return d=u.pointerId,Yx.set(d,Fv(Yx.get(d)||null,t,e,n,o,u)),!0}return!1}function h$(t){var e=Lp(t.target);if(e!==null){var n=_m(e);if(n!==null){if(e=n.tag,e===13){if(e=J7(n),e!==null){t.blockedOn=e,u$(t.priority,function(){l$(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function JC(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=WR(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var o=new n.constructor(n.type,n);UR=o,n.target.dispatchEvent(o),UR=null}else return e=L1(n),e!==null&&uD(e),t.blockedOn=n,!1;e.shift()}return!0}function b6(t,e,n){JC(t)&&n.delete(e)}function Vee(){GR=!1,jd!==null&&JC(jd)&&(jd=null),Vd!==null&&JC(Vd)&&(Vd=null),Hd!==null&&JC(Hd)&&(Hd=null),Kx.forEach(b6),Yx.forEach(b6)}function zv(t,e){t.blockedOn===e&&(t.blockedOn=null,GR||(GR=!0,Qa.unstable_scheduleCallback(Qa.unstable_NormalPriority,Vee)))}function Zx(t){function e(u){return zv(u,t)}if(0<uC.length){zv(uC[0],t);for(var n=1;n<uC.length;n++){var o=uC[n];o.blockedOn===t&&(o.blockedOn=null)}}for(jd!==null&&zv(jd,t),Vd!==null&&zv(Vd,t),Hd!==null&&zv(Hd,t),Kx.forEach(e),Yx.forEach(e),n=0;n<Dd.length;n++)o=Dd[n],o.blockedOn===t&&(o.blockedOn=null);for(;0<Dd.length&&(n=Dd[0],n.blockedOn===null);)h$(n),n.blockedOn===null&&Dd.shift()}var Pg=Ch.ReactCurrentBatchConfig,VE=!0;function Hee(t,e,n,o){var u=gi,d=Pg.transition;Pg.transition=null;try{gi=1,hD(t,e,n,o)}finally{gi=u,Pg.transition=d}}function Gee(t,e,n,o){var u=gi,d=Pg.transition;Pg.transition=null;try{gi=4,hD(t,e,n,o)}finally{gi=u,Pg.transition=d}}function hD(t,e,n,o){if(VE){var u=WR(t,e,n,o);if(u===null)EM(t,e,o,HE,n),x6(t,o);else if(jee(u,t,e,n,o))o.stopPropagation();else if(x6(t,o),e&4&&-1<$ee.indexOf(t)){for(;u!==null;){var d=L1(u);if(d!==null&&a$(d),d=WR(t,e,n,o),d===null&&EM(t,e,o,HE,n),d===u)break;u=d}u!==null&&o.stopPropagation()}else EM(t,e,o,null,n)}}var HE=null;function WR(t,e,n,o){if(HE=null,t=aD(o),t=Lp(t),t!==null)if(e=_m(t),e===null)t=null;else if(n=e.tag,n===13){if(t=J7(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return HE=t,null}function d$(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kee()){case lD:return 1;case n$:return 4;case $E:case Dee:return 16;case i$:return 536870912;default:return 16}default:return 16}}var Ld=null,dD=null,eE=null;function f$(){if(eE)return eE;var t,e=dD,n=e.length,o,u="value"in Ld?Ld.value:Ld.textContent,d=u.length;for(t=0;t<n&&e[t]===u[t];t++);var _=n-t;for(o=1;o<=_&&e[n-o]===u[d-o];o++);return eE=u.slice(t,1<o?1-o:void 0)}function tE(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hC(){return!0}function w6(){return!1}function nl(t){function e(n,o,u,d,_){this._reactName=n,this._targetInst=u,this.type=o,this.nativeEvent=d,this.target=_,this.currentTarget=null;for(var v in t)t.hasOwnProperty(v)&&(n=t[v],this[v]=n?n(d):d[v]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?hC:w6,this.isPropagationStopped=w6,this}return so(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hC)},persist:function(){},isPersistent:hC}),e}var E_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fD=nl(E_),O1=so({},E_,{view:0,detail:0}),Wee=nl(O1),mM,gM,Nv,uT=so({},O1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pD,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nv&&(Nv&&t.type==="mousemove"?(mM=t.screenX-Nv.screenX,gM=t.screenY-Nv.screenY):gM=mM=0,Nv=t),mM)},movementY:function(t){return"movementY"in t?t.movementY:gM}}),C6=nl(uT),qee=so({},uT,{dataTransfer:0}),Kee=nl(qee),Yee=so({},O1,{relatedTarget:0}),_M=nl(Yee),Zee=so({},E_,{animationName:0,elapsedTime:0,pseudoElement:0}),Xee=nl(Zee),Qee=so({},E_,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Jee=nl(Qee),ete=so({},E_,{data:0}),E6=nl(ete),tte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ite(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nte[t])?!!e[t]:!1}function pD(){return ite}var ote=so({},O1,{key:function(t){if(t.key){var e=tte[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tE(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?rte[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pD,charCode:function(t){return t.type==="keypress"?tE(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tE(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ste=nl(ote),ate=so({},uT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S6=nl(ate),lte=so({},O1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pD}),cte=nl(lte),ute=so({},E_,{propertyName:0,elapsedTime:0,pseudoElement:0}),hte=nl(ute),dte=so({},uT,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),fte=nl(dte),pte=[9,13,27,32],mD=ph&&"CompositionEvent"in window,Cx=null;ph&&"documentMode"in document&&(Cx=document.documentMode);var mte=ph&&"TextEvent"in window&&!Cx,p$=ph&&(!mD||Cx&&8<Cx&&11>=Cx),T6=" ",A6=!1;function m$(t,e){switch(t){case"keyup":return pte.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var lg=!1;function gte(t,e){switch(t){case"compositionend":return g$(e);case"keypress":return e.which!==32?null:(A6=!0,T6);case"textInput":return t=e.data,t===T6&&A6?null:t;default:return null}}function _te(t,e){if(lg)return t==="compositionend"||!mD&&m$(t,e)?(t=f$(),eE=dD=Ld=null,lg=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return p$&&e.locale!=="ko"?null:e.data;default:return null}}var yte={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function I6(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yte[t.type]:e==="textarea"}function _$(t,e,n,o){K7(o),e=GE(e,"onChange"),0<e.length&&(n=new fD("onChange","change",null,n,o),t.push({event:n,listeners:e}))}var Ex=null,Xx=null;function vte(t){I$(t,0)}function hT(t){var e=hg(t);if($7(e))return t}function xte(t,e){if(t==="change")return e}var y$=!1;if(ph){var yM;if(ph){var vM="oninput"in document;if(!vM){var M6=document.createElement("div");M6.setAttribute("oninput","return;"),vM=typeof M6.oninput=="function"}yM=vM}else yM=!1;y$=yM&&(!document.documentMode||9<document.documentMode)}function P6(){Ex&&(Ex.detachEvent("onpropertychange",v$),Xx=Ex=null)}function v$(t){if(t.propertyName==="value"&&hT(Xx)){var e=[];_$(e,Xx,t,aD(t)),Q7(vte,e)}}function bte(t,e,n){t==="focusin"?(P6(),Ex=e,Xx=n,Ex.attachEvent("onpropertychange",v$)):t==="focusout"&&P6()}function wte(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hT(Xx)}function Cte(t,e){if(t==="click")return hT(e)}function Ete(t,e){if(t==="input"||t==="change")return hT(e)}function Ste(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cc=typeof Object.is=="function"?Object.is:Ste;function Qx(t,e){if(Cc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var u=n[o];if(!IR.call(e,u)||!Cc(t[u],e[u]))return!1}return!0}function R6(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function k6(t,e){var n=R6(t);t=0;for(var o;n;){if(n.nodeType===3){if(o=t+n.textContent.length,t<=e&&o>=e)return{node:n,offset:e-t};t=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=R6(n)}}function x$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?x$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function b$(){for(var t=window,e=zE();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=zE(t.document)}return e}function gD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Tte(t){var e=b$(),n=t.focusedElem,o=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&x$(n.ownerDocument.documentElement,n)){if(o!==null&&gD(n)){if(e=o.start,t=o.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var u=n.textContent.length,d=Math.min(o.start,u);o=o.end===void 0?d:Math.min(o.end,u),!t.extend&&d>o&&(u=o,o=d,d=u),u=k6(n,d);var _=k6(n,o);u&&_&&(t.rangeCount!==1||t.anchorNode!==u.node||t.anchorOffset!==u.offset||t.focusNode!==_.node||t.focusOffset!==_.offset)&&(e=e.createRange(),e.setStart(u.node,u.offset),t.removeAllRanges(),d>o?(t.addRange(e),t.extend(_.node,_.offset)):(e.setEnd(_.node,_.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ate=ph&&"documentMode"in document&&11>=document.documentMode,cg=null,qR=null,Sx=null,KR=!1;function D6(t,e,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;KR||cg==null||cg!==zE(o)||(o=cg,"selectionStart"in o&&gD(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Sx&&Qx(Sx,o)||(Sx=o,o=GE(qR,"onSelect"),0<o.length&&(e=new fD("onSelect","select",null,e,n),t.push({event:e,listeners:o}),e.target=cg)))}function dC(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ug={animationend:dC("Animation","AnimationEnd"),animationiteration:dC("Animation","AnimationIteration"),animationstart:dC("Animation","AnimationStart"),transitionend:dC("Transition","TransitionEnd")},xM={},w$={};ph&&(w$=document.createElement("div").style,"AnimationEvent"in window||(delete ug.animationend.animation,delete ug.animationiteration.animation,delete ug.animationstart.animation),"TransitionEvent"in window||delete ug.transitionend.transition);function dT(t){if(xM[t])return xM[t];if(!ug[t])return t;var e=ug[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in w$)return xM[t]=e[n];return t}var C$=dT("animationend"),E$=dT("animationiteration"),S$=dT("animationstart"),T$=dT("transitionend"),A$=new Map,O6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function df(t,e){A$.set(t,e),gm(e,[t])}for(var bM=0;bM<O6.length;bM++){var wM=O6[bM],Ite=wM.toLowerCase(),Mte=wM[0].toUpperCase()+wM.slice(1);df(Ite,"on"+Mte)}df(C$,"onAnimationEnd");df(E$,"onAnimationIteration");df(S$,"onAnimationStart");df("dblclick","onDoubleClick");df("focusin","onFocus");df("focusout","onBlur");df(T$,"onTransitionEnd");Gg("onMouseEnter",["mouseout","mouseover"]);Gg("onMouseLeave",["mouseout","mouseover"]);Gg("onPointerEnter",["pointerout","pointerover"]);Gg("onPointerLeave",["pointerout","pointerover"]);gm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gm("onBeforeInput",["compositionend","keypress","textInput","paste"]);gm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pte=new Set("cancel close invalid load scroll toggle".split(" ").concat(sx));function L6(t,e,n){var o=t.type||"unknown-event";t.currentTarget=n,Iee(o,e,void 0,t),t.currentTarget=null}function I$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var o=t[n],u=o.event;o=o.listeners;e:{var d=void 0;if(e)for(var _=o.length-1;0<=_;_--){var v=o[_],a=v.instance,C=v.currentTarget;if(v=v.listener,a!==d&&u.isPropagationStopped())break e;L6(u,v,C),d=a}else for(_=0;_<o.length;_++){if(v=o[_],a=v.instance,C=v.currentTarget,v=v.listener,a!==d&&u.isPropagationStopped())break e;L6(u,v,C),d=a}}}if(UE)throw t=VR,UE=!1,VR=null,t}function zi(t,e){var n=e[JR];n===void 0&&(n=e[JR]=new Set);var o=t+"__bubble";n.has(o)||(M$(e,t,2,!1),n.add(o))}function CM(t,e,n){var o=0;e&&(o|=4),M$(n,t,o,e)}var fC="_reactListening"+Math.random().toString(36).slice(2);function Jx(t){if(!t[fC]){t[fC]=!0,B7.forEach(function(n){n!=="selectionchange"&&(Pte.has(n)||CM(n,!1,t),CM(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fC]||(e[fC]=!0,CM("selectionchange",!1,e))}}function M$(t,e,n,o){switch(d$(e)){case 1:var u=Hee;break;case 4:u=Gee;break;default:u=hD}n=u.bind(null,e,n,t),u=void 0,!jR||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(u=!0),o?u!==void 0?t.addEventListener(e,n,{capture:!0,passive:u}):t.addEventListener(e,n,!0):u!==void 0?t.addEventListener(e,n,{passive:u}):t.addEventListener(e,n,!1)}function EM(t,e,n,o,u){var d=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var _=o.tag;if(_===3||_===4){var v=o.stateNode.containerInfo;if(v===u||v.nodeType===8&&v.parentNode===u)break;if(_===4)for(_=o.return;_!==null;){var a=_.tag;if((a===3||a===4)&&(a=_.stateNode.containerInfo,a===u||a.nodeType===8&&a.parentNode===u))return;_=_.return}for(;v!==null;){if(_=Lp(v),_===null)return;if(a=_.tag,a===5||a===6){o=d=_;continue e}v=v.parentNode}}o=o.return}Q7(function(){var C=d,A=aD(n),k=[];e:{var O=A$.get(t);if(O!==void 0){var R=fD,z=t;switch(t){case"keypress":if(tE(n)===0)break e;case"keydown":case"keyup":R=ste;break;case"focusin":z="focus",R=_M;break;case"focusout":z="blur",R=_M;break;case"beforeblur":case"afterblur":R=_M;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=C6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=Kee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=cte;break;case C$:case E$:case S$:R=Xee;break;case T$:R=hte;break;case"scroll":R=Wee;break;case"wheel":R=fte;break;case"copy":case"cut":case"paste":R=Jee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=S6}var N=(e&4)!==0,K=!N&&t==="scroll",q=N?O!==null?O+"Capture":null:O;N=[];for(var j=C,H;j!==null;){H=j;var Y=H.stateNode;if(H.tag===5&&Y!==null&&(H=Y,q!==null&&(Y=qx(j,q),Y!=null&&N.push(e1(j,Y,H)))),K)break;j=j.return}0<N.length&&(O=new R(O,z,null,n,A),k.push({event:O,listeners:N}))}}if(!(e&7)){e:{if(O=t==="mouseover"||t==="pointerover",R=t==="mouseout"||t==="pointerout",O&&n!==UR&&(z=n.relatedTarget||n.fromElement)&&(Lp(z)||z[mh]))break e;if((R||O)&&(O=A.window===A?A:(O=A.ownerDocument)?O.defaultView||O.parentWindow:window,R?(z=n.relatedTarget||n.toElement,R=C,z=z?Lp(z):null,z!==null&&(K=_m(z),z!==K||z.tag!==5&&z.tag!==6)&&(z=null)):(R=null,z=C),R!==z)){if(N=C6,Y="onMouseLeave",q="onMouseEnter",j="mouse",(t==="pointerout"||t==="pointerover")&&(N=S6,Y="onPointerLeave",q="onPointerEnter",j="pointer"),K=R==null?O:hg(R),H=z==null?O:hg(z),O=new N(Y,j+"leave",R,n,A),O.target=K,O.relatedTarget=H,Y=null,Lp(A)===C&&(N=new N(q,j+"enter",z,n,A),N.target=H,N.relatedTarget=K,Y=N),K=Y,R&&z)t:{for(N=R,q=z,j=0,H=N;H;H=U0(H))j++;for(H=0,Y=q;Y;Y=U0(Y))H++;for(;0<j-H;)N=U0(N),j--;for(;0<H-j;)q=U0(q),H--;for(;j--;){if(N===q||q!==null&&N===q.alternate)break t;N=U0(N),q=U0(q)}N=null}else N=null;R!==null&&B6(k,O,R,N,!1),z!==null&&K!==null&&B6(k,K,z,N,!0)}}e:{if(O=C?hg(C):window,R=O.nodeName&&O.nodeName.toLowerCase(),R==="select"||R==="input"&&O.type==="file")var te=xte;else if(I6(O))if(y$)te=Ete;else{te=wte;var J=bte}else(R=O.nodeName)&&R.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(te=Cte);if(te&&(te=te(t,C))){_$(k,te,n,A);break e}J&&J(t,O,C),t==="focusout"&&(J=O._wrapperState)&&J.controlled&&O.type==="number"&&LR(O,"number",O.value)}switch(J=C?hg(C):window,t){case"focusin":(I6(J)||J.contentEditable==="true")&&(cg=J,qR=C,Sx=null);break;case"focusout":Sx=qR=cg=null;break;case"mousedown":KR=!0;break;case"contextmenu":case"mouseup":case"dragend":KR=!1,D6(k,n,A);break;case"selectionchange":if(Ate)break;case"keydown":case"keyup":D6(k,n,A)}var ae;if(mD)e:{switch(t){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else lg?m$(t,n)&&(de="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(de="onCompositionStart");de&&(p$&&n.locale!=="ko"&&(lg||de!=="onCompositionStart"?de==="onCompositionEnd"&&lg&&(ae=f$()):(Ld=A,dD="value"in Ld?Ld.value:Ld.textContent,lg=!0)),J=GE(C,de),0<J.length&&(de=new E6(de,t,null,n,A),k.push({event:de,listeners:J}),ae?de.data=ae:(ae=g$(n),ae!==null&&(de.data=ae)))),(ae=mte?gte(t,n):_te(t,n))&&(C=GE(C,"onBeforeInput"),0<C.length&&(A=new E6("onBeforeInput","beforeinput",null,n,A),k.push({event:A,listeners:C}),A.data=ae))}I$(k,e)})}function e1(t,e,n){return{instance:t,listener:e,currentTarget:n}}function GE(t,e){for(var n=e+"Capture",o=[];t!==null;){var u=t,d=u.stateNode;u.tag===5&&d!==null&&(u=d,d=qx(t,n),d!=null&&o.unshift(e1(t,d,u)),d=qx(t,e),d!=null&&o.push(e1(t,d,u))),t=t.return}return o}function U0(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function B6(t,e,n,o,u){for(var d=e._reactName,_=[];n!==null&&n!==o;){var v=n,a=v.alternate,C=v.stateNode;if(a!==null&&a===o)break;v.tag===5&&C!==null&&(v=C,u?(a=qx(n,d),a!=null&&_.unshift(e1(n,a,v))):u||(a=qx(n,d),a!=null&&_.push(e1(n,a,v)))),n=n.return}_.length!==0&&t.push({event:e,listeners:_})}var Rte=/\r\n?/g,kte=/\u0000|\uFFFD/g;function F6(t){return(typeof t=="string"?t:""+t).replace(Rte,`
`).replace(kte,"")}function pC(t,e,n){if(e=F6(e),F6(t)!==e&&n)throw Error(nr(425))}function WE(){}var YR=null,ZR=null;function XR(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var QR=typeof setTimeout=="function"?setTimeout:void 0,Dte=typeof clearTimeout=="function"?clearTimeout:void 0,z6=typeof Promise=="function"?Promise:void 0,Ote=typeof queueMicrotask=="function"?queueMicrotask:typeof z6<"u"?function(t){return z6.resolve(null).then(t).catch(Lte)}:QR;function Lte(t){setTimeout(function(){throw t})}function SM(t,e){var n=e,o=0;do{var u=n.nextSibling;if(t.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"){if(o===0){t.removeChild(u),Zx(e);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=u}while(n);Zx(e)}function Gd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function N6(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var S_=Math.random().toString(36).slice(2),eu="__reactFiber$"+S_,t1="__reactProps$"+S_,mh="__reactContainer$"+S_,JR="__reactEvents$"+S_,Bte="__reactListeners$"+S_,Fte="__reactHandles$"+S_;function Lp(t){var e=t[eu];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mh]||n[eu]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=N6(t);t!==null;){if(n=t[eu])return n;t=N6(t)}return e}t=n,n=t.parentNode}return null}function L1(t){return t=t[eu]||t[mh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(nr(33))}function fT(t){return t[t1]||null}var ek=[],dg=-1;function ff(t){return{current:t}}function Ui(t){0>dg||(t.current=ek[dg],ek[dg]=null,dg--)}function Li(t,e){dg++,ek[dg]=t.current,t.current=e}var tf={},Hs=ff(tf),pa=ff(!1),em=tf;function Wg(t,e){var n=t.type.contextTypes;if(!n)return tf;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var u={},d;for(d in n)u[d]=e[d];return o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=u),u}function ma(t){return t=t.childContextTypes,t!=null}function qE(){Ui(pa),Ui(Hs)}function U6(t,e,n){if(Hs.current!==tf)throw Error(nr(168));Li(Hs,e),Li(pa,n)}function P$(t,e,n){var o=t.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var u in o)if(!(u in e))throw Error(nr(108,bee(t)||"Unknown",u));return so({},n,o)}function KE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||tf,em=Hs.current,Li(Hs,t),Li(pa,pa.current),!0}function $6(t,e,n){var o=t.stateNode;if(!o)throw Error(nr(169));n?(t=P$(t,e,em),o.__reactInternalMemoizedMergedChildContext=t,Ui(pa),Ui(Hs),Li(Hs,t)):Ui(pa),Li(pa,n)}var eh=null,pT=!1,TM=!1;function R$(t){eh===null?eh=[t]:eh.push(t)}function zte(t){pT=!0,R$(t)}function pf(){if(!TM&&eh!==null){TM=!0;var t=0,e=gi;try{var n=eh;for(gi=1;t<n.length;t++){var o=n[t];do o=o(!0);while(o!==null)}eh=null,pT=!1}catch(u){throw eh!==null&&(eh=eh.slice(t+1)),r$(lD,pf),u}finally{gi=e,TM=!1}}return null}var fg=[],pg=0,YE=null,ZE=0,wl=[],Cl=0,tm=null,ih=1,oh="";function Ip(t,e){fg[pg++]=ZE,fg[pg++]=YE,YE=t,ZE=e}function k$(t,e,n){wl[Cl++]=ih,wl[Cl++]=oh,wl[Cl++]=tm,tm=t;var o=ih;t=oh;var u=32-_c(o)-1;o&=~(1<<u),n+=1;var d=32-_c(e)+u;if(30<d){var _=u-u%5;d=(o&(1<<_)-1).toString(32),o>>=_,u-=_,ih=1<<32-_c(e)+u|n<<u|o,oh=d+t}else ih=1<<d|n<<u|o,oh=t}function _D(t){t.return!==null&&(Ip(t,1),k$(t,1,0))}function yD(t){for(;t===YE;)YE=fg[--pg],fg[pg]=null,ZE=fg[--pg],fg[pg]=null;for(;t===tm;)tm=wl[--Cl],wl[Cl]=null,oh=wl[--Cl],wl[Cl]=null,ih=wl[--Cl],wl[Cl]=null}var Ka=null,Ha=null,Wi=!1,fc=null;function D$(t,e){var n=Al(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function j6(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ka=t,Ha=Gd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ka=t,Ha=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=tm!==null?{id:ih,overflow:oh}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Al(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ka=t,Ha=null,!0):!1;default:return!1}}function tk(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rk(t){if(Wi){var e=Ha;if(e){var n=e;if(!j6(t,e)){if(tk(t))throw Error(nr(418));e=Gd(n.nextSibling);var o=Ka;e&&j6(t,e)?D$(o,n):(t.flags=t.flags&-4097|2,Wi=!1,Ka=t)}}else{if(tk(t))throw Error(nr(418));t.flags=t.flags&-4097|2,Wi=!1,Ka=t}}}function V6(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ka=t}function mC(t){if(t!==Ka)return!1;if(!Wi)return V6(t),Wi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!XR(t.type,t.memoizedProps)),e&&(e=Ha)){if(tk(t))throw O$(),Error(nr(418));for(;e;)D$(t,e),e=Gd(e.nextSibling)}if(V6(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(nr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ha=Gd(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ha=null}}else Ha=Ka?Gd(t.stateNode.nextSibling):null;return!0}function O$(){for(var t=Ha;t;)t=Gd(t.nextSibling)}function qg(){Ha=Ka=null,Wi=!1}function vD(t){fc===null?fc=[t]:fc.push(t)}var Nte=Ch.ReactCurrentBatchConfig;function Uv(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(nr(309));var o=n.stateNode}if(!o)throw Error(nr(147,t));var u=o,d=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===d?e.ref:(e=function(_){var v=u.refs;_===null?delete v[d]:v[d]=_},e._stringRef=d,e)}if(typeof t!="string")throw Error(nr(284));if(!n._owner)throw Error(nr(290,t))}return t}function gC(t,e){throw t=Object.prototype.toString.call(e),Error(nr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function H6(t){var e=t._init;return e(t._payload)}function L$(t){function e(q,j){if(t){var H=q.deletions;H===null?(q.deletions=[j],q.flags|=16):H.push(j)}}function n(q,j){if(!t)return null;for(;j!==null;)e(q,j),j=j.sibling;return null}function o(q,j){for(q=new Map;j!==null;)j.key!==null?q.set(j.key,j):q.set(j.index,j),j=j.sibling;return q}function u(q,j){return q=Yd(q,j),q.index=0,q.sibling=null,q}function d(q,j,H){return q.index=H,t?(H=q.alternate,H!==null?(H=H.index,H<j?(q.flags|=2,j):H):(q.flags|=2,j)):(q.flags|=1048576,j)}function _(q){return t&&q.alternate===null&&(q.flags|=2),q}function v(q,j,H,Y){return j===null||j.tag!==6?(j=DM(H,q.mode,Y),j.return=q,j):(j=u(j,H),j.return=q,j)}function a(q,j,H,Y){var te=H.type;return te===ag?A(q,j,H.props.children,Y,H.key):j!==null&&(j.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Md&&H6(te)===j.type)?(Y=u(j,H.props),Y.ref=Uv(q,j,H),Y.return=q,Y):(Y=lE(H.type,H.key,H.props,null,q.mode,Y),Y.ref=Uv(q,j,H),Y.return=q,Y)}function C(q,j,H,Y){return j===null||j.tag!==4||j.stateNode.containerInfo!==H.containerInfo||j.stateNode.implementation!==H.implementation?(j=OM(H,q.mode,Y),j.return=q,j):(j=u(j,H.children||[]),j.return=q,j)}function A(q,j,H,Y,te){return j===null||j.tag!==7?(j=Gp(H,q.mode,Y,te),j.return=q,j):(j=u(j,H),j.return=q,j)}function k(q,j,H){if(typeof j=="string"&&j!==""||typeof j=="number")return j=DM(""+j,q.mode,H),j.return=q,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case oC:return H=lE(j.type,j.key,j.props,null,q.mode,H),H.ref=Uv(q,null,j),H.return=q,H;case sg:return j=OM(j,q.mode,H),j.return=q,j;case Md:var Y=j._init;return k(q,Y(j._payload),H)}if(ix(j)||Lv(j))return j=Gp(j,q.mode,H,null),j.return=q,j;gC(q,j)}return null}function O(q,j,H,Y){var te=j!==null?j.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return te!==null?null:v(q,j,""+H,Y);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case oC:return H.key===te?a(q,j,H,Y):null;case sg:return H.key===te?C(q,j,H,Y):null;case Md:return te=H._init,O(q,j,te(H._payload),Y)}if(ix(H)||Lv(H))return te!==null?null:A(q,j,H,Y,null);gC(q,H)}return null}function R(q,j,H,Y,te){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return q=q.get(H)||null,v(j,q,""+Y,te);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case oC:return q=q.get(Y.key===null?H:Y.key)||null,a(j,q,Y,te);case sg:return q=q.get(Y.key===null?H:Y.key)||null,C(j,q,Y,te);case Md:var J=Y._init;return R(q,j,H,J(Y._payload),te)}if(ix(Y)||Lv(Y))return q=q.get(H)||null,A(j,q,Y,te,null);gC(j,Y)}return null}function z(q,j,H,Y){for(var te=null,J=null,ae=j,de=j=0,Me=null;ae!==null&&de<H.length;de++){ae.index>de?(Me=ae,ae=null):Me=ae.sibling;var Ce=O(q,ae,H[de],Y);if(Ce===null){ae===null&&(ae=Me);break}t&&ae&&Ce.alternate===null&&e(q,ae),j=d(Ce,j,de),J===null?te=Ce:J.sibling=Ce,J=Ce,ae=Me}if(de===H.length)return n(q,ae),Wi&&Ip(q,de),te;if(ae===null){for(;de<H.length;de++)ae=k(q,H[de],Y),ae!==null&&(j=d(ae,j,de),J===null?te=ae:J.sibling=ae,J=ae);return Wi&&Ip(q,de),te}for(ae=o(q,ae);de<H.length;de++)Me=R(ae,q,de,H[de],Y),Me!==null&&(t&&Me.alternate!==null&&ae.delete(Me.key===null?de:Me.key),j=d(Me,j,de),J===null?te=Me:J.sibling=Me,J=Me);return t&&ae.forEach(function(Ae){return e(q,Ae)}),Wi&&Ip(q,de),te}function N(q,j,H,Y){var te=Lv(H);if(typeof te!="function")throw Error(nr(150));if(H=te.call(H),H==null)throw Error(nr(151));for(var J=te=null,ae=j,de=j=0,Me=null,Ce=H.next();ae!==null&&!Ce.done;de++,Ce=H.next()){ae.index>de?(Me=ae,ae=null):Me=ae.sibling;var Ae=O(q,ae,Ce.value,Y);if(Ae===null){ae===null&&(ae=Me);break}t&&ae&&Ae.alternate===null&&e(q,ae),j=d(Ae,j,de),J===null?te=Ae:J.sibling=Ae,J=Ae,ae=Me}if(Ce.done)return n(q,ae),Wi&&Ip(q,de),te;if(ae===null){for(;!Ce.done;de++,Ce=H.next())Ce=k(q,Ce.value,Y),Ce!==null&&(j=d(Ce,j,de),J===null?te=Ce:J.sibling=Ce,J=Ce);return Wi&&Ip(q,de),te}for(ae=o(q,ae);!Ce.done;de++,Ce=H.next())Ce=R(ae,q,de,Ce.value,Y),Ce!==null&&(t&&Ce.alternate!==null&&ae.delete(Ce.key===null?de:Ce.key),j=d(Ce,j,de),J===null?te=Ce:J.sibling=Ce,J=Ce);return t&&ae.forEach(function(Ne){return e(q,Ne)}),Wi&&Ip(q,de),te}function K(q,j,H,Y){if(typeof H=="object"&&H!==null&&H.type===ag&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case oC:e:{for(var te=H.key,J=j;J!==null;){if(J.key===te){if(te=H.type,te===ag){if(J.tag===7){n(q,J.sibling),j=u(J,H.props.children),j.return=q,q=j;break e}}else if(J.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Md&&H6(te)===J.type){n(q,J.sibling),j=u(J,H.props),j.ref=Uv(q,J,H),j.return=q,q=j;break e}n(q,J);break}else e(q,J);J=J.sibling}H.type===ag?(j=Gp(H.props.children,q.mode,Y,H.key),j.return=q,q=j):(Y=lE(H.type,H.key,H.props,null,q.mode,Y),Y.ref=Uv(q,j,H),Y.return=q,q=Y)}return _(q);case sg:e:{for(J=H.key;j!==null;){if(j.key===J)if(j.tag===4&&j.stateNode.containerInfo===H.containerInfo&&j.stateNode.implementation===H.implementation){n(q,j.sibling),j=u(j,H.children||[]),j.return=q,q=j;break e}else{n(q,j);break}else e(q,j);j=j.sibling}j=OM(H,q.mode,Y),j.return=q,q=j}return _(q);case Md:return J=H._init,K(q,j,J(H._payload),Y)}if(ix(H))return z(q,j,H,Y);if(Lv(H))return N(q,j,H,Y);gC(q,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,j!==null&&j.tag===6?(n(q,j.sibling),j=u(j,H),j.return=q,q=j):(n(q,j),j=DM(H,q.mode,Y),j.return=q,q=j),_(q)):n(q,j)}return K}var Kg=L$(!0),B$=L$(!1),XE=ff(null),QE=null,mg=null,xD=null;function bD(){xD=mg=QE=null}function wD(t){var e=XE.current;Ui(XE),t._currentValue=e}function nk(t,e,n){for(;t!==null;){var o=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),t===n)break;t=t.return}}function Rg(t,e){QE=t,xD=mg=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fa=!0),t.firstContext=null)}function kl(t){var e=t._currentValue;if(xD!==t)if(t={context:t,memoizedValue:e,next:null},mg===null){if(QE===null)throw Error(nr(308));mg=t,QE.dependencies={lanes:0,firstContext:t}}else mg=mg.next=t;return e}var Bp=null;function CD(t){Bp===null?Bp=[t]:Bp.push(t)}function F$(t,e,n,o){var u=e.interleaved;return u===null?(n.next=n,CD(e)):(n.next=u.next,u.next=n),e.interleaved=n,gh(t,o)}function gh(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pd=!1;function ED(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wd(t,e,n){var o=t.updateQueue;if(o===null)return null;if(o=o.shared,ti&2){var u=o.pending;return u===null?e.next=e:(e.next=u.next,u.next=e),o.pending=e,gh(t,n)}return u=o.interleaved,u===null?(e.next=e,CD(o)):(e.next=u.next,u.next=e),o.interleaved=e,gh(t,n)}function rE(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,cD(t,n)}}function G6(t,e){var n=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var u=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var _={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};d===null?u=d=_:d=d.next=_,n=n.next}while(n!==null);d===null?u=d=e:d=d.next=e}else u=d=e;n={baseState:o.baseState,firstBaseUpdate:u,lastBaseUpdate:d,shared:o.shared,effects:o.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function JE(t,e,n,o){var u=t.updateQueue;Pd=!1;var d=u.firstBaseUpdate,_=u.lastBaseUpdate,v=u.shared.pending;if(v!==null){u.shared.pending=null;var a=v,C=a.next;a.next=null,_===null?d=C:_.next=C,_=a;var A=t.alternate;A!==null&&(A=A.updateQueue,v=A.lastBaseUpdate,v!==_&&(v===null?A.firstBaseUpdate=C:v.next=C,A.lastBaseUpdate=a))}if(d!==null){var k=u.baseState;_=0,A=C=a=null,v=d;do{var O=v.lane,R=v.eventTime;if((o&O)===O){A!==null&&(A=A.next={eventTime:R,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var z=t,N=v;switch(O=e,R=n,N.tag){case 1:if(z=N.payload,typeof z=="function"){k=z.call(R,k,O);break e}k=z;break e;case 3:z.flags=z.flags&-65537|128;case 0:if(z=N.payload,O=typeof z=="function"?z.call(R,k,O):z,O==null)break e;k=so({},k,O);break e;case 2:Pd=!0}}v.callback!==null&&v.lane!==0&&(t.flags|=64,O=u.effects,O===null?u.effects=[v]:O.push(v))}else R={eventTime:R,lane:O,tag:v.tag,payload:v.payload,callback:v.callback,next:null},A===null?(C=A=R,a=k):A=A.next=R,_|=O;if(v=v.next,v===null){if(v=u.shared.pending,v===null)break;O=v,v=O.next,O.next=null,u.lastBaseUpdate=O,u.shared.pending=null}}while(!0);if(A===null&&(a=k),u.baseState=a,u.firstBaseUpdate=C,u.lastBaseUpdate=A,e=u.shared.interleaved,e!==null){u=e;do _|=u.lane,u=u.next;while(u!==e)}else d===null&&(u.shared.lanes=0);nm|=_,t.lanes=_,t.memoizedState=k}}function W6(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var o=t[e],u=o.callback;if(u!==null){if(o.callback=null,o=n,typeof u!="function")throw Error(nr(191,u));u.call(o)}}}var B1={},uu=ff(B1),r1=ff(B1),n1=ff(B1);function Fp(t){if(t===B1)throw Error(nr(174));return t}function SD(t,e){switch(Li(n1,e),Li(r1,t),Li(uu,B1),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:FR(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=FR(e,t)}Ui(uu),Li(uu,e)}function Yg(){Ui(uu),Ui(r1),Ui(n1)}function N$(t){Fp(n1.current);var e=Fp(uu.current),n=FR(e,t.type);e!==n&&(Li(r1,t),Li(uu,n))}function TD(t){r1.current===t&&(Ui(uu),Ui(r1))}var ro=ff(0);function eS(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var AM=[];function AD(){for(var t=0;t<AM.length;t++)AM[t]._workInProgressVersionPrimary=null;AM.length=0}var nE=Ch.ReactCurrentDispatcher,IM=Ch.ReactCurrentBatchConfig,rm=0,oo=null,qo=null,os=null,tS=!1,Tx=!1,i1=0,Ute=0;function Ls(){throw Error(nr(321))}function ID(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cc(t[n],e[n]))return!1;return!0}function MD(t,e,n,o,u,d){if(rm=d,oo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nE.current=t===null||t.memoizedState===null?Hte:Gte,t=n(o,u),Tx){d=0;do{if(Tx=!1,i1=0,25<=d)throw Error(nr(301));d+=1,os=qo=null,e.updateQueue=null,nE.current=Wte,t=n(o,u)}while(Tx)}if(nE.current=rS,e=qo!==null&&qo.next!==null,rm=0,os=qo=oo=null,tS=!1,e)throw Error(nr(300));return t}function PD(){var t=i1!==0;return i1=0,t}function Yc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?oo.memoizedState=os=t:os=os.next=t,os}function Dl(){if(qo===null){var t=oo.alternate;t=t!==null?t.memoizedState:null}else t=qo.next;var e=os===null?oo.memoizedState:os.next;if(e!==null)os=e,qo=t;else{if(t===null)throw Error(nr(310));qo=t,t={memoizedState:qo.memoizedState,baseState:qo.baseState,baseQueue:qo.baseQueue,queue:qo.queue,next:null},os===null?oo.memoizedState=os=t:os=os.next=t}return os}function o1(t,e){return typeof e=="function"?e(t):e}function MM(t){var e=Dl(),n=e.queue;if(n===null)throw Error(nr(311));n.lastRenderedReducer=t;var o=qo,u=o.baseQueue,d=n.pending;if(d!==null){if(u!==null){var _=u.next;u.next=d.next,d.next=_}o.baseQueue=u=d,n.pending=null}if(u!==null){d=u.next,o=o.baseState;var v=_=null,a=null,C=d;do{var A=C.lane;if((rm&A)===A)a!==null&&(a=a.next={lane:0,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null}),o=C.hasEagerState?C.eagerState:t(o,C.action);else{var k={lane:A,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null};a===null?(v=a=k,_=o):a=a.next=k,oo.lanes|=A,nm|=A}C=C.next}while(C!==null&&C!==d);a===null?_=o:a.next=v,Cc(o,e.memoizedState)||(fa=!0),e.memoizedState=o,e.baseState=_,e.baseQueue=a,n.lastRenderedState=o}if(t=n.interleaved,t!==null){u=t;do d=u.lane,oo.lanes|=d,nm|=d,u=u.next;while(u!==t)}else u===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function PM(t){var e=Dl(),n=e.queue;if(n===null)throw Error(nr(311));n.lastRenderedReducer=t;var o=n.dispatch,u=n.pending,d=e.memoizedState;if(u!==null){n.pending=null;var _=u=u.next;do d=t(d,_.action),_=_.next;while(_!==u);Cc(d,e.memoizedState)||(fa=!0),e.memoizedState=d,e.baseQueue===null&&(e.baseState=d),n.lastRenderedState=d}return[d,o]}function U$(){}function $$(t,e){var n=oo,o=Dl(),u=e(),d=!Cc(o.memoizedState,u);if(d&&(o.memoizedState=u,fa=!0),o=o.queue,RD(H$.bind(null,n,o,t),[t]),o.getSnapshot!==e||d||os!==null&&os.memoizedState.tag&1){if(n.flags|=2048,s1(9,V$.bind(null,n,o,u,e),void 0,null),cs===null)throw Error(nr(349));rm&30||j$(n,e,u)}return u}function j$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=oo.updateQueue,e===null?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function V$(t,e,n,o){e.value=n,e.getSnapshot=o,G$(e)&&W$(t)}function H$(t,e,n){return n(function(){G$(e)&&W$(t)})}function G$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cc(t,n)}catch{return!0}}function W$(t){var e=gh(t,1);e!==null&&yc(e,t,1,-1)}function q6(t){var e=Yc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o1,lastRenderedState:t},e.queue=t,t=t.dispatch=Vte.bind(null,oo,t),[e.memoizedState,t]}function s1(t,e,n,o){return t={tag:t,create:e,destroy:n,deps:o,next:null},e=oo.updateQueue,e===null?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(o=n.next,n.next=t,t.next=o,e.lastEffect=t)),t}function q$(){return Dl().memoizedState}function iE(t,e,n,o){var u=Yc();oo.flags|=t,u.memoizedState=s1(1|e,n,void 0,o===void 0?null:o)}function mT(t,e,n,o){var u=Dl();o=o===void 0?null:o;var d=void 0;if(qo!==null){var _=qo.memoizedState;if(d=_.destroy,o!==null&&ID(o,_.deps)){u.memoizedState=s1(e,n,d,o);return}}oo.flags|=t,u.memoizedState=s1(1|e,n,d,o)}function K6(t,e){return iE(8390656,8,t,e)}function RD(t,e){return mT(2048,8,t,e)}function K$(t,e){return mT(4,2,t,e)}function Y$(t,e){return mT(4,4,t,e)}function Z$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function X$(t,e,n){return n=n!=null?n.concat([t]):null,mT(4,4,Z$.bind(null,e,t),n)}function kD(){}function Q$(t,e){var n=Dl();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&ID(e,o[1])?o[0]:(n.memoizedState=[t,e],t)}function J$(t,e){var n=Dl();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&ID(e,o[1])?o[0]:(t=t(),n.memoizedState=[t,e],t)}function ej(t,e,n){return rm&21?(Cc(n,e)||(n=o$(),oo.lanes|=n,nm|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fa=!0),t.memoizedState=n)}function $te(t,e){var n=gi;gi=n!==0&&4>n?n:4,t(!0);var o=IM.transition;IM.transition={};try{t(!1),e()}finally{gi=n,IM.transition=o}}function tj(){return Dl().memoizedState}function jte(t,e,n){var o=Kd(t);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},rj(t))nj(e,n);else if(n=F$(t,e,n,o),n!==null){var u=ea();yc(n,t,o,u),ij(n,e,o)}}function Vte(t,e,n){var o=Kd(t),u={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(rj(t))nj(e,u);else{var d=t.alternate;if(t.lanes===0&&(d===null||d.lanes===0)&&(d=e.lastRenderedReducer,d!==null))try{var _=e.lastRenderedState,v=d(_,n);if(u.hasEagerState=!0,u.eagerState=v,Cc(v,_)){var a=e.interleaved;a===null?(u.next=u,CD(e)):(u.next=a.next,a.next=u),e.interleaved=u;return}}catch{}finally{}n=F$(t,e,u,o),n!==null&&(u=ea(),yc(n,t,o,u),ij(n,e,o))}}function rj(t){var e=t.alternate;return t===oo||e!==null&&e===oo}function nj(t,e){Tx=tS=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ij(t,e,n){if(n&4194240){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,cD(t,n)}}var rS={readContext:kl,useCallback:Ls,useContext:Ls,useEffect:Ls,useImperativeHandle:Ls,useInsertionEffect:Ls,useLayoutEffect:Ls,useMemo:Ls,useReducer:Ls,useRef:Ls,useState:Ls,useDebugValue:Ls,useDeferredValue:Ls,useTransition:Ls,useMutableSource:Ls,useSyncExternalStore:Ls,useId:Ls,unstable_isNewReconciler:!1},Hte={readContext:kl,useCallback:function(t,e){return Yc().memoizedState=[t,e===void 0?null:e],t},useContext:kl,useEffect:K6,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,iE(4194308,4,Z$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return iE(4194308,4,t,e)},useInsertionEffect:function(t,e){return iE(4,2,t,e)},useMemo:function(t,e){var n=Yc();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var o=Yc();return e=n!==void 0?n(e):e,o.memoizedState=o.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},o.queue=t,t=t.dispatch=jte.bind(null,oo,t),[o.memoizedState,t]},useRef:function(t){var e=Yc();return t={current:t},e.memoizedState=t},useState:q6,useDebugValue:kD,useDeferredValue:function(t){return Yc().memoizedState=t},useTransition:function(){var t=q6(!1),e=t[0];return t=$te.bind(null,t[1]),Yc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var o=oo,u=Yc();if(Wi){if(n===void 0)throw Error(nr(407));n=n()}else{if(n=e(),cs===null)throw Error(nr(349));rm&30||j$(o,e,n)}u.memoizedState=n;var d={value:n,getSnapshot:e};return u.queue=d,K6(H$.bind(null,o,d,t),[t]),o.flags|=2048,s1(9,V$.bind(null,o,d,n,e),void 0,null),n},useId:function(){var t=Yc(),e=cs.identifierPrefix;if(Wi){var n=oh,o=ih;n=(o&~(1<<32-_c(o)-1)).toString(32)+n,e=":"+e+"R"+n,n=i1++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Ute++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Gte={readContext:kl,useCallback:Q$,useContext:kl,useEffect:RD,useImperativeHandle:X$,useInsertionEffect:K$,useLayoutEffect:Y$,useMemo:J$,useReducer:MM,useRef:q$,useState:function(){return MM(o1)},useDebugValue:kD,useDeferredValue:function(t){var e=Dl();return ej(e,qo.memoizedState,t)},useTransition:function(){var t=MM(o1)[0],e=Dl().memoizedState;return[t,e]},useMutableSource:U$,useSyncExternalStore:$$,useId:tj,unstable_isNewReconciler:!1},Wte={readContext:kl,useCallback:Q$,useContext:kl,useEffect:RD,useImperativeHandle:X$,useInsertionEffect:K$,useLayoutEffect:Y$,useMemo:J$,useReducer:PM,useRef:q$,useState:function(){return PM(o1)},useDebugValue:kD,useDeferredValue:function(t){var e=Dl();return qo===null?e.memoizedState=t:ej(e,qo.memoizedState,t)},useTransition:function(){var t=PM(o1)[0],e=Dl().memoizedState;return[t,e]},useMutableSource:U$,useSyncExternalStore:$$,useId:tj,unstable_isNewReconciler:!1};function cc(t,e){if(t&&t.defaultProps){e=so({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ik(t,e,n,o){e=t.memoizedState,n=n(o,e),n=n==null?e:so({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var gT={isMounted:function(t){return(t=t._reactInternals)?_m(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var o=ea(),u=Kd(t),d=hh(o,u);d.payload=e,n!=null&&(d.callback=n),e=Wd(t,d,u),e!==null&&(yc(e,t,u,o),rE(e,t,u))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var o=ea(),u=Kd(t),d=hh(o,u);d.tag=1,d.payload=e,n!=null&&(d.callback=n),e=Wd(t,d,u),e!==null&&(yc(e,t,u,o),rE(e,t,u))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ea(),o=Kd(t),u=hh(n,o);u.tag=2,e!=null&&(u.callback=e),e=Wd(t,u,o),e!==null&&(yc(e,t,o,n),rE(e,t,o))}};function Y6(t,e,n,o,u,d,_){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,d,_):e.prototype&&e.prototype.isPureReactComponent?!Qx(n,o)||!Qx(u,d):!0}function oj(t,e,n){var o=!1,u=tf,d=e.contextType;return typeof d=="object"&&d!==null?d=kl(d):(u=ma(e)?em:Hs.current,o=e.contextTypes,d=(o=o!=null)?Wg(t,u):tf),e=new e(n,d),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gT,t.stateNode=e,e._reactInternals=t,o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=u,t.__reactInternalMemoizedMaskedChildContext=d),e}function Z6(t,e,n,o){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,o),e.state!==t&&gT.enqueueReplaceState(e,e.state,null)}function ok(t,e,n,o){var u=t.stateNode;u.props=n,u.state=t.memoizedState,u.refs={},ED(t);var d=e.contextType;typeof d=="object"&&d!==null?u.context=kl(d):(d=ma(e)?em:Hs.current,u.context=Wg(t,d)),u.state=t.memoizedState,d=e.getDerivedStateFromProps,typeof d=="function"&&(ik(t,e,d,n),u.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(e=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),e!==u.state&&gT.enqueueReplaceState(u,u.state,null),JE(t,n,u,o),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308)}function Zg(t,e){try{var n="",o=e;do n+=xee(o),o=o.return;while(o);var u=n}catch(d){u=`
Error generating stack: `+d.message+`
`+d.stack}return{value:t,source:e,stack:u,digest:null}}function RM(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sk(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var qte=typeof WeakMap=="function"?WeakMap:Map;function sj(t,e,n){n=hh(-1,n),n.tag=3,n.payload={element:null};var o=e.value;return n.callback=function(){iS||(iS=!0,gk=o),sk(t,e)},n}function aj(t,e,n){n=hh(-1,n),n.tag=3;var o=t.type.getDerivedStateFromError;if(typeof o=="function"){var u=e.value;n.payload=function(){return o(u)},n.callback=function(){sk(t,e)}}var d=t.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(n.callback=function(){sk(t,e),typeof o!="function"&&(qd===null?qd=new Set([this]):qd.add(this));var _=e.stack;this.componentDidCatch(e.value,{componentStack:_!==null?_:""})}),n}function X6(t,e,n){var o=t.pingCache;if(o===null){o=t.pingCache=new qte;var u=new Set;o.set(e,u)}else u=o.get(e),u===void 0&&(u=new Set,o.set(e,u));u.has(n)||(u.add(n),t=are.bind(null,t,e,n),e.then(t,t))}function Q6(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function J6(t,e,n,o,u){return t.mode&1?(t.flags|=65536,t.lanes=u,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hh(-1,1),e.tag=2,Wd(n,e,1))),n.lanes|=1),t)}var Kte=Ch.ReactCurrentOwner,fa=!1;function Qs(t,e,n,o){e.child=t===null?B$(e,null,n,o):Kg(e,t.child,n,o)}function eN(t,e,n,o,u){n=n.render;var d=e.ref;return Rg(e,u),o=MD(t,e,n,o,d,u),n=PD(),t!==null&&!fa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~u,_h(t,e,u)):(Wi&&n&&_D(e),e.flags|=1,Qs(t,e,o,u),e.child)}function tN(t,e,n,o,u){if(t===null){var d=n.type;return typeof d=="function"&&!UD(d)&&d.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=d,lj(t,e,d,o,u)):(t=lE(n.type,null,o,e,e.mode,u),t.ref=e.ref,t.return=e,e.child=t)}if(d=t.child,!(t.lanes&u)){var _=d.memoizedProps;if(n=n.compare,n=n!==null?n:Qx,n(_,o)&&t.ref===e.ref)return _h(t,e,u)}return e.flags|=1,t=Yd(d,o),t.ref=e.ref,t.return=e,e.child=t}function lj(t,e,n,o,u){if(t!==null){var d=t.memoizedProps;if(Qx(d,o)&&t.ref===e.ref)if(fa=!1,e.pendingProps=o=d,(t.lanes&u)!==0)t.flags&131072&&(fa=!0);else return e.lanes=t.lanes,_h(t,e,u)}return ak(t,e,n,o,u)}function cj(t,e,n){var o=e.pendingProps,u=o.children,d=t!==null?t.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Li(_g,za),za|=n;else{if(!(n&1073741824))return t=d!==null?d.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Li(_g,za),za|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:n,Li(_g,za),za|=o}else d!==null?(o=d.baseLanes|n,e.memoizedState=null):o=n,Li(_g,za),za|=o;return Qs(t,e,u,n),e.child}function uj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ak(t,e,n,o,u){var d=ma(n)?em:Hs.current;return d=Wg(e,d),Rg(e,u),n=MD(t,e,n,o,d,u),o=PD(),t!==null&&!fa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~u,_h(t,e,u)):(Wi&&o&&_D(e),e.flags|=1,Qs(t,e,n,u),e.child)}function rN(t,e,n,o,u){if(ma(n)){var d=!0;KE(e)}else d=!1;if(Rg(e,u),e.stateNode===null)oE(t,e),oj(e,n,o),ok(e,n,o,u),o=!0;else if(t===null){var _=e.stateNode,v=e.memoizedProps;_.props=v;var a=_.context,C=n.contextType;typeof C=="object"&&C!==null?C=kl(C):(C=ma(n)?em:Hs.current,C=Wg(e,C));var A=n.getDerivedStateFromProps,k=typeof A=="function"||typeof _.getSnapshotBeforeUpdate=="function";k||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==o||a!==C)&&Z6(e,_,o,C),Pd=!1;var O=e.memoizedState;_.state=O,JE(e,o,_,u),a=e.memoizedState,v!==o||O!==a||pa.current||Pd?(typeof A=="function"&&(ik(e,n,A,o),a=e.memoizedState),(v=Pd||Y6(e,n,v,o,O,a,C))?(k||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(e.flags|=4194308)):(typeof _.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=a),_.props=o,_.state=a,_.context=C,o=v):(typeof _.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{_=e.stateNode,z$(t,e),v=e.memoizedProps,C=e.type===e.elementType?v:cc(e.type,v),_.props=C,k=e.pendingProps,O=_.context,a=n.contextType,typeof a=="object"&&a!==null?a=kl(a):(a=ma(n)?em:Hs.current,a=Wg(e,a));var R=n.getDerivedStateFromProps;(A=typeof R=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==k||O!==a)&&Z6(e,_,o,a),Pd=!1,O=e.memoizedState,_.state=O,JE(e,o,_,u);var z=e.memoizedState;v!==k||O!==z||pa.current||Pd?(typeof R=="function"&&(ik(e,n,R,o),z=e.memoizedState),(C=Pd||Y6(e,n,C,o,O,z,a)||!1)?(A||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(o,z,a),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(o,z,a)),typeof _.componentDidUpdate=="function"&&(e.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof _.componentDidUpdate!="function"||v===t.memoizedProps&&O===t.memoizedState||(e.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&O===t.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=z),_.props=o,_.state=z,_.context=a,o=C):(typeof _.componentDidUpdate!="function"||v===t.memoizedProps&&O===t.memoizedState||(e.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&O===t.memoizedState||(e.flags|=1024),o=!1)}return lk(t,e,n,o,d,u)}function lk(t,e,n,o,u,d){uj(t,e);var _=(e.flags&128)!==0;if(!o&&!_)return u&&$6(e,n,!1),_h(t,e,d);o=e.stateNode,Kte.current=e;var v=_&&typeof n.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,t!==null&&_?(e.child=Kg(e,t.child,null,d),e.child=Kg(e,null,v,d)):Qs(t,e,v,d),e.memoizedState=o.state,u&&$6(e,n,!0),e.child}function hj(t){var e=t.stateNode;e.pendingContext?U6(t,e.pendingContext,e.pendingContext!==e.context):e.context&&U6(t,e.context,!1),SD(t,e.containerInfo)}function nN(t,e,n,o,u){return qg(),vD(u),e.flags|=256,Qs(t,e,n,o),e.child}var ck={dehydrated:null,treeContext:null,retryLane:0};function uk(t){return{baseLanes:t,cachePool:null,transitions:null}}function dj(t,e,n){var o=e.pendingProps,u=ro.current,d=!1,_=(e.flags&128)!==0,v;if((v=_)||(v=t!==null&&t.memoizedState===null?!1:(u&2)!==0),v?(d=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(u|=1),Li(ro,u&1),t===null)return rk(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(_=o.children,t=o.fallback,d?(o=e.mode,d=e.child,_={mode:"hidden",children:_},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=_):d=vT(_,o,0,null),t=Gp(t,o,n,null),d.return=e,t.return=e,d.sibling=t,e.child=d,e.child.memoizedState=uk(n),e.memoizedState=ck,t):DD(e,_));if(u=t.memoizedState,u!==null&&(v=u.dehydrated,v!==null))return Yte(t,e,_,o,v,u,n);if(d){d=o.fallback,_=e.mode,u=t.child,v=u.sibling;var a={mode:"hidden",children:o.children};return!(_&1)&&e.child!==u?(o=e.child,o.childLanes=0,o.pendingProps=a,e.deletions=null):(o=Yd(u,a),o.subtreeFlags=u.subtreeFlags&14680064),v!==null?d=Yd(v,d):(d=Gp(d,_,n,null),d.flags|=2),d.return=e,o.return=e,o.sibling=d,e.child=o,o=d,d=e.child,_=t.child.memoizedState,_=_===null?uk(n):{baseLanes:_.baseLanes|n,cachePool:null,transitions:_.transitions},d.memoizedState=_,d.childLanes=t.childLanes&~n,e.memoizedState=ck,o}return d=t.child,t=d.sibling,o=Yd(d,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=n),o.return=e,o.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=o,e.memoizedState=null,o}function DD(t,e){return e=vT({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _C(t,e,n,o){return o!==null&&vD(o),Kg(e,t.child,null,n),t=DD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Yte(t,e,n,o,u,d,_){if(n)return e.flags&256?(e.flags&=-257,o=RM(Error(nr(422))),_C(t,e,_,o)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(d=o.fallback,u=e.mode,o=vT({mode:"visible",children:o.children},u,0,null),d=Gp(d,u,_,null),d.flags|=2,o.return=e,d.return=e,o.sibling=d,e.child=o,e.mode&1&&Kg(e,t.child,null,_),e.child.memoizedState=uk(_),e.memoizedState=ck,d);if(!(e.mode&1))return _C(t,e,_,null);if(u.data==="$!"){if(o=u.nextSibling&&u.nextSibling.dataset,o)var v=o.dgst;return o=v,d=Error(nr(419)),o=RM(d,o,void 0),_C(t,e,_,o)}if(v=(_&t.childLanes)!==0,fa||v){if(o=cs,o!==null){switch(_&-_){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(o.suspendedLanes|_)?0:u,u!==0&&u!==d.retryLane&&(d.retryLane=u,gh(t,u),yc(o,t,u,-1))}return ND(),o=RM(Error(nr(421))),_C(t,e,_,o)}return u.data==="$?"?(e.flags|=128,e.child=t.child,e=lre.bind(null,t),u._reactRetry=e,null):(t=d.treeContext,Ha=Gd(u.nextSibling),Ka=e,Wi=!0,fc=null,t!==null&&(wl[Cl++]=ih,wl[Cl++]=oh,wl[Cl++]=tm,ih=t.id,oh=t.overflow,tm=e),e=DD(e,o.children),e.flags|=4096,e)}function iN(t,e,n){t.lanes|=e;var o=t.alternate;o!==null&&(o.lanes|=e),nk(t.return,e,n)}function kM(t,e,n,o,u){var d=t.memoizedState;d===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:u}:(d.isBackwards=e,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=n,d.tailMode=u)}function fj(t,e,n){var o=e.pendingProps,u=o.revealOrder,d=o.tail;if(Qs(t,e,o.children,n),o=ro.current,o&2)o=o&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iN(t,n,e);else if(t.tag===19)iN(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(Li(ro,o),!(e.mode&1))e.memoizedState=null;else switch(u){case"forwards":for(n=e.child,u=null;n!==null;)t=n.alternate,t!==null&&eS(t)===null&&(u=n),n=n.sibling;n=u,n===null?(u=e.child,e.child=null):(u=n.sibling,n.sibling=null),kM(e,!1,u,n,d);break;case"backwards":for(n=null,u=e.child,e.child=null;u!==null;){if(t=u.alternate,t!==null&&eS(t)===null){e.child=u;break}t=u.sibling,u.sibling=n,n=u,u=t}kM(e,!0,n,null,d);break;case"together":kM(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oE(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _h(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),nm|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(nr(153));if(e.child!==null){for(t=e.child,n=Yd(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Yd(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Zte(t,e,n){switch(e.tag){case 3:hj(e),qg();break;case 5:N$(e);break;case 1:ma(e.type)&&KE(e);break;case 4:SD(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,u=e.memoizedProps.value;Li(XE,o._currentValue),o._currentValue=u;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(Li(ro,ro.current&1),e.flags|=128,null):n&e.child.childLanes?dj(t,e,n):(Li(ro,ro.current&1),t=_h(t,e,n),t!==null?t.sibling:null);Li(ro,ro.current&1);break;case 19:if(o=(n&e.childLanes)!==0,t.flags&128){if(o)return fj(t,e,n);e.flags|=128}if(u=e.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Li(ro,ro.current),o)break;return null;case 22:case 23:return e.lanes=0,cj(t,e,n)}return _h(t,e,n)}var pj,hk,mj,gj;pj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hk=function(){};mj=function(t,e,n,o){var u=t.memoizedProps;if(u!==o){t=e.stateNode,Fp(uu.current);var d=null;switch(n){case"input":u=DR(t,u),o=DR(t,o),d=[];break;case"select":u=so({},u,{value:void 0}),o=so({},o,{value:void 0}),d=[];break;case"textarea":u=BR(t,u),o=BR(t,o),d=[];break;default:typeof u.onClick!="function"&&typeof o.onClick=="function"&&(t.onclick=WE)}zR(n,o);var _;n=null;for(C in u)if(!o.hasOwnProperty(C)&&u.hasOwnProperty(C)&&u[C]!=null)if(C==="style"){var v=u[C];for(_ in v)v.hasOwnProperty(_)&&(n||(n={}),n[_]="")}else C!=="dangerouslySetInnerHTML"&&C!=="children"&&C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(Gx.hasOwnProperty(C)?d||(d=[]):(d=d||[]).push(C,null));for(C in o){var a=o[C];if(v=u?.[C],o.hasOwnProperty(C)&&a!==v&&(a!=null||v!=null))if(C==="style")if(v){for(_ in v)!v.hasOwnProperty(_)||a&&a.hasOwnProperty(_)||(n||(n={}),n[_]="");for(_ in a)a.hasOwnProperty(_)&&v[_]!==a[_]&&(n||(n={}),n[_]=a[_])}else n||(d||(d=[]),d.push(C,n)),n=a;else C==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,v=v?v.__html:void 0,a!=null&&v!==a&&(d=d||[]).push(C,a)):C==="children"?typeof a!="string"&&typeof a!="number"||(d=d||[]).push(C,""+a):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&(Gx.hasOwnProperty(C)?(a!=null&&C==="onScroll"&&zi("scroll",t),d||v===a||(d=[])):(d=d||[]).push(C,a))}n&&(d=d||[]).push("style",n);var C=d;(e.updateQueue=C)&&(e.flags|=4)}};gj=function(t,e,n,o){n!==o&&(e.flags|=4)};function $v(t,e){if(!Wi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function Bs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,o=0;if(e)for(var u=t.child;u!==null;)n|=u.lanes|u.childLanes,o|=u.subtreeFlags&14680064,o|=u.flags&14680064,u.return=t,u=u.sibling;else for(u=t.child;u!==null;)n|=u.lanes|u.childLanes,o|=u.subtreeFlags,o|=u.flags,u.return=t,u=u.sibling;return t.subtreeFlags|=o,t.childLanes=n,e}function Xte(t,e,n){var o=e.pendingProps;switch(yD(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bs(e),null;case 1:return ma(e.type)&&qE(),Bs(e),null;case 3:return o=e.stateNode,Yg(),Ui(pa),Ui(Hs),AD(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(mC(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fc!==null&&(vk(fc),fc=null))),hk(t,e),Bs(e),null;case 5:TD(e);var u=Fp(n1.current);if(n=e.type,t!==null&&e.stateNode!=null)mj(t,e,n,o,u),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(nr(166));return Bs(e),null}if(t=Fp(uu.current),mC(e)){o=e.stateNode,n=e.type;var d=e.memoizedProps;switch(o[eu]=e,o[t1]=d,t=(e.mode&1)!==0,n){case"dialog":zi("cancel",o),zi("close",o);break;case"iframe":case"object":case"embed":zi("load",o);break;case"video":case"audio":for(u=0;u<sx.length;u++)zi(sx[u],o);break;case"source":zi("error",o);break;case"img":case"image":case"link":zi("error",o),zi("load",o);break;case"details":zi("toggle",o);break;case"input":f6(o,d),zi("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},zi("invalid",o);break;case"textarea":m6(o,d),zi("invalid",o)}zR(n,d),u=null;for(var _ in d)if(d.hasOwnProperty(_)){var v=d[_];_==="children"?typeof v=="string"?o.textContent!==v&&(d.suppressHydrationWarning!==!0&&pC(o.textContent,v,t),u=["children",v]):typeof v=="number"&&o.textContent!==""+v&&(d.suppressHydrationWarning!==!0&&pC(o.textContent,v,t),u=["children",""+v]):Gx.hasOwnProperty(_)&&v!=null&&_==="onScroll"&&zi("scroll",o)}switch(n){case"input":sC(o),p6(o,d,!0);break;case"textarea":sC(o),g6(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=WE)}o=u,e.updateQueue=o,o!==null&&(e.flags|=4)}else{_=u.nodeType===9?u:u.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=H7(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=_.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof o.is=="string"?t=_.createElement(n,{is:o.is}):(t=_.createElement(n),n==="select"&&(_=t,o.multiple?_.multiple=!0:o.size&&(_.size=o.size))):t=_.createElementNS(t,n),t[eu]=e,t[t1]=o,pj(t,e,!1,!1),e.stateNode=t;e:{switch(_=NR(n,o),n){case"dialog":zi("cancel",t),zi("close",t),u=o;break;case"iframe":case"object":case"embed":zi("load",t),u=o;break;case"video":case"audio":for(u=0;u<sx.length;u++)zi(sx[u],t);u=o;break;case"source":zi("error",t),u=o;break;case"img":case"image":case"link":zi("error",t),zi("load",t),u=o;break;case"details":zi("toggle",t),u=o;break;case"input":f6(t,o),u=DR(t,o),zi("invalid",t);break;case"option":u=o;break;case"select":t._wrapperState={wasMultiple:!!o.multiple},u=so({},o,{value:void 0}),zi("invalid",t);break;case"textarea":m6(t,o),u=BR(t,o),zi("invalid",t);break;default:u=o}zR(n,u),v=u;for(d in v)if(v.hasOwnProperty(d)){var a=v[d];d==="style"?q7(t,a):d==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&G7(t,a)):d==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Wx(t,a):typeof a=="number"&&Wx(t,""+a):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Gx.hasOwnProperty(d)?a!=null&&d==="onScroll"&&zi("scroll",t):a!=null&&nD(t,d,a,_))}switch(n){case"input":sC(t),p6(t,o,!1);break;case"textarea":sC(t),g6(t);break;case"option":o.value!=null&&t.setAttribute("value",""+ef(o.value));break;case"select":t.multiple=!!o.multiple,d=o.value,d!=null?Ag(t,!!o.multiple,d,!1):o.defaultValue!=null&&Ag(t,!!o.multiple,o.defaultValue,!0);break;default:typeof u.onClick=="function"&&(t.onclick=WE)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bs(e),null;case 6:if(t&&e.stateNode!=null)gj(t,e,t.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(nr(166));if(n=Fp(n1.current),Fp(uu.current),mC(e)){if(o=e.stateNode,n=e.memoizedProps,o[eu]=e,(d=o.nodeValue!==n)&&(t=Ka,t!==null))switch(t.tag){case 3:pC(o.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pC(o.nodeValue,n,(t.mode&1)!==0)}d&&(e.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[eu]=e,e.stateNode=o}return Bs(e),null;case 13:if(Ui(ro),o=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wi&&Ha!==null&&e.mode&1&&!(e.flags&128))O$(),qg(),e.flags|=98560,d=!1;else if(d=mC(e),o!==null&&o.dehydrated!==null){if(t===null){if(!d)throw Error(nr(318));if(d=e.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(nr(317));d[eu]=e}else qg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bs(e),d=!1}else fc!==null&&(vk(fc),fc=null),d=!0;if(!d)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(o=o!==null,o!==(t!==null&&t.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(t===null||ro.current&1?Yo===0&&(Yo=3):ND())),e.updateQueue!==null&&(e.flags|=4),Bs(e),null);case 4:return Yg(),hk(t,e),t===null&&Jx(e.stateNode.containerInfo),Bs(e),null;case 10:return wD(e.type._context),Bs(e),null;case 17:return ma(e.type)&&qE(),Bs(e),null;case 19:if(Ui(ro),d=e.memoizedState,d===null)return Bs(e),null;if(o=(e.flags&128)!==0,_=d.rendering,_===null)if(o)$v(d,!1);else{if(Yo!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(_=eS(t),_!==null){for(e.flags|=128,$v(d,!1),o=_.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=n,n=e.child;n!==null;)d=n,t=o,d.flags&=14680066,_=d.alternate,_===null?(d.childLanes=0,d.lanes=t,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=_.childLanes,d.lanes=_.lanes,d.child=_.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=_.memoizedProps,d.memoizedState=_.memoizedState,d.updateQueue=_.updateQueue,d.type=_.type,t=_.dependencies,d.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Li(ro,ro.current&1|2),e.child}t=t.sibling}d.tail!==null&&wo()>Xg&&(e.flags|=128,o=!0,$v(d,!1),e.lanes=4194304)}else{if(!o)if(t=eS(_),t!==null){if(e.flags|=128,o=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),$v(d,!0),d.tail===null&&d.tailMode==="hidden"&&!_.alternate&&!Wi)return Bs(e),null}else 2*wo()-d.renderingStartTime>Xg&&n!==1073741824&&(e.flags|=128,o=!0,$v(d,!1),e.lanes=4194304);d.isBackwards?(_.sibling=e.child,e.child=_):(n=d.last,n!==null?n.sibling=_:e.child=_,d.last=_)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=wo(),e.sibling=null,n=ro.current,Li(ro,o?n&1|2:n&1),e):(Bs(e),null);case 22:case 23:return zD(),o=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?za&1073741824&&(Bs(e),e.subtreeFlags&6&&(e.flags|=8192)):Bs(e),null;case 24:return null;case 25:return null}throw Error(nr(156,e.tag))}function Qte(t,e){switch(yD(e),e.tag){case 1:return ma(e.type)&&qE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yg(),Ui(pa),Ui(Hs),AD(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return TD(e),null;case 13:if(Ui(ro),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(nr(340));qg()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ui(ro),null;case 4:return Yg(),null;case 10:return wD(e.type._context),null;case 22:case 23:return zD(),null;case 24:return null;default:return null}}var yC=!1,Ns=!1,Jte=typeof WeakSet=="function"?WeakSet:Set,Ir=null;function gg(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){fo(t,e,o)}else n.current=null}function dk(t,e,n){try{n()}catch(o){fo(t,e,o)}}var oN=!1;function ere(t,e){if(YR=VE,t=b$(),gD(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var u=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var _=0,v=-1,a=-1,C=0,A=0,k=t,O=null;t:for(;;){for(var R;k!==n||u!==0&&k.nodeType!==3||(v=_+u),k!==d||o!==0&&k.nodeType!==3||(a=_+o),k.nodeType===3&&(_+=k.nodeValue.length),(R=k.firstChild)!==null;)O=k,k=R;for(;;){if(k===t)break t;if(O===n&&++C===u&&(v=_),O===d&&++A===o&&(a=_),(R=k.nextSibling)!==null)break;k=O,O=k.parentNode}k=R}n=v===-1||a===-1?null:{start:v,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(ZR={focusedElem:t,selectionRange:n},VE=!1,Ir=e;Ir!==null;)if(e=Ir,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ir=t;else for(;Ir!==null;){e=Ir;try{var z=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(z!==null){var N=z.memoizedProps,K=z.memoizedState,q=e.stateNode,j=q.getSnapshotBeforeUpdate(e.elementType===e.type?N:cc(e.type,N),K);q.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var H=e.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(nr(163))}}catch(Y){fo(e,e.return,Y)}if(t=e.sibling,t!==null){t.return=e.return,Ir=t;break}Ir=e.return}return z=oN,oN=!1,z}function Ax(t,e,n){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&t)===t){var d=u.destroy;u.destroy=void 0,d!==void 0&&dk(e,n,d)}u=u.next}while(u!==o)}}function _T(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var o=n.create;n.destroy=o()}n=n.next}while(n!==e)}}function fk(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _j(t){var e=t.alternate;e!==null&&(t.alternate=null,_j(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[eu],delete e[t1],delete e[JR],delete e[Bte],delete e[Fte])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yj(t){return t.tag===5||t.tag===3||t.tag===4}function sN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yj(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pk(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=WE));else if(o!==4&&(t=t.child,t!==null))for(pk(t,e,n),t=t.sibling;t!==null;)pk(t,e,n),t=t.sibling}function mk(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(o!==4&&(t=t.child,t!==null))for(mk(t,e,n),t=t.sibling;t!==null;)mk(t,e,n),t=t.sibling}var bs=null,uc=!1;function bd(t,e,n){for(n=n.child;n!==null;)vj(t,e,n),n=n.sibling}function vj(t,e,n){if(cu&&typeof cu.onCommitFiberUnmount=="function")try{cu.onCommitFiberUnmount(cT,n)}catch{}switch(n.tag){case 5:Ns||gg(n,e);case 6:var o=bs,u=uc;bs=null,bd(t,e,n),bs=o,uc=u,bs!==null&&(uc?(t=bs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):bs.removeChild(n.stateNode));break;case 18:bs!==null&&(uc?(t=bs,n=n.stateNode,t.nodeType===8?SM(t.parentNode,n):t.nodeType===1&&SM(t,n),Zx(t)):SM(bs,n.stateNode));break;case 4:o=bs,u=uc,bs=n.stateNode.containerInfo,uc=!0,bd(t,e,n),bs=o,uc=u;break;case 0:case 11:case 14:case 15:if(!Ns&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){u=o=o.next;do{var d=u,_=d.destroy;d=d.tag,_!==void 0&&(d&2||d&4)&&dk(n,e,_),u=u.next}while(u!==o)}bd(t,e,n);break;case 1:if(!Ns&&(gg(n,e),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(v){fo(n,e,v)}bd(t,e,n);break;case 21:bd(t,e,n);break;case 22:n.mode&1?(Ns=(o=Ns)||n.memoizedState!==null,bd(t,e,n),Ns=o):bd(t,e,n);break;default:bd(t,e,n)}}function aN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Jte),e.forEach(function(o){var u=cre.bind(null,t,o);n.has(o)||(n.add(o),o.then(u,u))})}}function sc(t,e){var n=e.deletions;if(n!==null)for(var o=0;o<n.length;o++){var u=n[o];try{var d=t,_=e,v=_;e:for(;v!==null;){switch(v.tag){case 5:bs=v.stateNode,uc=!1;break e;case 3:bs=v.stateNode.containerInfo,uc=!0;break e;case 4:bs=v.stateNode.containerInfo,uc=!0;break e}v=v.return}if(bs===null)throw Error(nr(160));vj(d,_,u),bs=null,uc=!1;var a=u.alternate;a!==null&&(a.return=null),u.return=null}catch(C){fo(u,e,C)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xj(e,t),e=e.sibling}function xj(t,e){var n=t.alternate,o=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(sc(e,t),Wc(t),o&4){try{Ax(3,t,t.return),_T(3,t)}catch(N){fo(t,t.return,N)}try{Ax(5,t,t.return)}catch(N){fo(t,t.return,N)}}break;case 1:sc(e,t),Wc(t),o&512&&n!==null&&gg(n,n.return);break;case 5:if(sc(e,t),Wc(t),o&512&&n!==null&&gg(n,n.return),t.flags&32){var u=t.stateNode;try{Wx(u,"")}catch(N){fo(t,t.return,N)}}if(o&4&&(u=t.stateNode,u!=null)){var d=t.memoizedProps,_=n!==null?n.memoizedProps:d,v=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{v==="input"&&d.type==="radio"&&d.name!=null&&j7(u,d),NR(v,_);var C=NR(v,d);for(_=0;_<a.length;_+=2){var A=a[_],k=a[_+1];A==="style"?q7(u,k):A==="dangerouslySetInnerHTML"?G7(u,k):A==="children"?Wx(u,k):nD(u,A,k,C)}switch(v){case"input":OR(u,d);break;case"textarea":V7(u,d);break;case"select":var O=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!d.multiple;var R=d.value;R!=null?Ag(u,!!d.multiple,R,!1):O!==!!d.multiple&&(d.defaultValue!=null?Ag(u,!!d.multiple,d.defaultValue,!0):Ag(u,!!d.multiple,d.multiple?[]:"",!1))}u[t1]=d}catch(N){fo(t,t.return,N)}}break;case 6:if(sc(e,t),Wc(t),o&4){if(t.stateNode===null)throw Error(nr(162));u=t.stateNode,d=t.memoizedProps;try{u.nodeValue=d}catch(N){fo(t,t.return,N)}}break;case 3:if(sc(e,t),Wc(t),o&4&&n!==null&&n.memoizedState.isDehydrated)try{Zx(e.containerInfo)}catch(N){fo(t,t.return,N)}break;case 4:sc(e,t),Wc(t);break;case 13:sc(e,t),Wc(t),u=t.child,u.flags&8192&&(d=u.memoizedState!==null,u.stateNode.isHidden=d,!d||u.alternate!==null&&u.alternate.memoizedState!==null||(BD=wo())),o&4&&aN(t);break;case 22:if(A=n!==null&&n.memoizedState!==null,t.mode&1?(Ns=(C=Ns)||A,sc(e,t),Ns=C):sc(e,t),Wc(t),o&8192){if(C=t.memoizedState!==null,(t.stateNode.isHidden=C)&&!A&&t.mode&1)for(Ir=t,A=t.child;A!==null;){for(k=Ir=A;Ir!==null;){switch(O=Ir,R=O.child,O.tag){case 0:case 11:case 14:case 15:Ax(4,O,O.return);break;case 1:gg(O,O.return);var z=O.stateNode;if(typeof z.componentWillUnmount=="function"){o=O,n=O.return;try{e=o,z.props=e.memoizedProps,z.state=e.memoizedState,z.componentWillUnmount()}catch(N){fo(o,n,N)}}break;case 5:gg(O,O.return);break;case 22:if(O.memoizedState!==null){cN(k);continue}}R!==null?(R.return=O,Ir=R):cN(k)}A=A.sibling}e:for(A=null,k=t;;){if(k.tag===5){if(A===null){A=k;try{u=k.stateNode,C?(d=u.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(v=k.stateNode,a=k.memoizedProps.style,_=a!=null&&a.hasOwnProperty("display")?a.display:null,v.style.display=W7("display",_))}catch(N){fo(t,t.return,N)}}}else if(k.tag===6){if(A===null)try{k.stateNode.nodeValue=C?"":k.memoizedProps}catch(N){fo(t,t.return,N)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===t)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===t)break e;for(;k.sibling===null;){if(k.return===null||k.return===t)break e;A===k&&(A=null),k=k.return}A===k&&(A=null),k.sibling.return=k.return,k=k.sibling}}break;case 19:sc(e,t),Wc(t),o&4&&aN(t);break;case 21:break;default:sc(e,t),Wc(t)}}function Wc(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yj(n)){var o=n;break e}n=n.return}throw Error(nr(160))}switch(o.tag){case 5:var u=o.stateNode;o.flags&32&&(Wx(u,""),o.flags&=-33);var d=sN(t);mk(t,d,u);break;case 3:case 4:var _=o.stateNode.containerInfo,v=sN(t);pk(t,v,_);break;default:throw Error(nr(161))}}catch(a){fo(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tre(t,e,n){Ir=t,bj(t)}function bj(t,e,n){for(var o=(t.mode&1)!==0;Ir!==null;){var u=Ir,d=u.child;if(u.tag===22&&o){var _=u.memoizedState!==null||yC;if(!_){var v=u.alternate,a=v!==null&&v.memoizedState!==null||Ns;v=yC;var C=Ns;if(yC=_,(Ns=a)&&!C)for(Ir=u;Ir!==null;)_=Ir,a=_.child,_.tag===22&&_.memoizedState!==null?uN(u):a!==null?(a.return=_,Ir=a):uN(u);for(;d!==null;)Ir=d,bj(d),d=d.sibling;Ir=u,yC=v,Ns=C}lN(t)}else u.subtreeFlags&8772&&d!==null?(d.return=u,Ir=d):lN(t)}}function lN(t){for(;Ir!==null;){var e=Ir;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ns||_T(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!Ns)if(n===null)o.componentDidMount();else{var u=e.elementType===e.type?n.memoizedProps:cc(e.type,n.memoizedProps);o.componentDidUpdate(u,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=e.updateQueue;d!==null&&W6(e,d,o);break;case 3:var _=e.updateQueue;if(_!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}W6(e,_,n)}break;case 5:var v=e.stateNode;if(n===null&&e.flags&4){n=v;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var C=e.alternate;if(C!==null){var A=C.memoizedState;if(A!==null){var k=A.dehydrated;k!==null&&Zx(k)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(nr(163))}Ns||e.flags&512&&fk(e)}catch(O){fo(e,e.return,O)}}if(e===t){Ir=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ir=n;break}Ir=e.return}}function cN(t){for(;Ir!==null;){var e=Ir;if(e===t){Ir=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ir=n;break}Ir=e.return}}function uN(t){for(;Ir!==null;){var e=Ir;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_T(4,e)}catch(a){fo(e,n,a)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var u=e.return;try{o.componentDidMount()}catch(a){fo(e,u,a)}}var d=e.return;try{fk(e)}catch(a){fo(e,d,a)}break;case 5:var _=e.return;try{fk(e)}catch(a){fo(e,_,a)}}}catch(a){fo(e,e.return,a)}if(e===t){Ir=null;break}var v=e.sibling;if(v!==null){v.return=e.return,Ir=v;break}Ir=e.return}}var rre=Math.ceil,nS=Ch.ReactCurrentDispatcher,OD=Ch.ReactCurrentOwner,Pl=Ch.ReactCurrentBatchConfig,ti=0,cs=null,No=null,Ss=0,za=0,_g=ff(0),Yo=0,a1=null,nm=0,yT=0,LD=0,Ix=null,da=null,BD=0,Xg=1/0,Xu=null,iS=!1,gk=null,qd=null,vC=!1,Bd=null,oS=0,Mx=0,_k=null,sE=-1,aE=0;function ea(){return ti&6?wo():sE!==-1?sE:sE=wo()}function Kd(t){return t.mode&1?ti&2&&Ss!==0?Ss&-Ss:Nte.transition!==null?(aE===0&&(aE=o$()),aE):(t=gi,t!==0||(t=window.event,t=t===void 0?16:d$(t.type)),t):1}function yc(t,e,n,o){if(50<Mx)throw Mx=0,_k=null,Error(nr(185));D1(t,n,o),(!(ti&2)||t!==cs)&&(t===cs&&(!(ti&2)&&(yT|=n),Yo===4&&Od(t,Ss)),ga(t,o),n===1&&ti===0&&!(e.mode&1)&&(Xg=wo()+500,pT&&pf()))}function ga(t,e){var n=t.callbackNode;Nee(t,e);var o=jE(t,t===cs?Ss:0);if(o===0)n!==null&&v6(n),t.callbackNode=null,t.callbackPriority=0;else if(e=o&-o,t.callbackPriority!==e){if(n!=null&&v6(n),e===1)t.tag===0?zte(hN.bind(null,t)):R$(hN.bind(null,t)),Ote(function(){!(ti&6)&&pf()}),n=null;else{switch(s$(o)){case 1:n=lD;break;case 4:n=n$;break;case 16:n=$E;break;case 536870912:n=i$;break;default:n=$E}n=Mj(n,wj.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wj(t,e){if(sE=-1,aE=0,ti&6)throw Error(nr(327));var n=t.callbackNode;if(kg()&&t.callbackNode!==n)return null;var o=jE(t,t===cs?Ss:0);if(o===0)return null;if(o&30||o&t.expiredLanes||e)e=sS(t,o);else{e=o;var u=ti;ti|=2;var d=Ej();(cs!==t||Ss!==e)&&(Xu=null,Xg=wo()+500,Hp(t,e));do try{ore();break}catch(v){Cj(t,v)}while(!0);bD(),nS.current=d,ti=u,No!==null?e=0:(cs=null,Ss=0,e=Yo)}if(e!==0){if(e===2&&(u=HR(t),u!==0&&(o=u,e=yk(t,u))),e===1)throw n=a1,Hp(t,0),Od(t,o),ga(t,wo()),n;if(e===6)Od(t,o);else{if(u=t.current.alternate,!(o&30)&&!nre(u)&&(e=sS(t,o),e===2&&(d=HR(t),d!==0&&(o=d,e=yk(t,d))),e===1))throw n=a1,Hp(t,0),Od(t,o),ga(t,wo()),n;switch(t.finishedWork=u,t.finishedLanes=o,e){case 0:case 1:throw Error(nr(345));case 2:Mp(t,da,Xu);break;case 3:if(Od(t,o),(o&130023424)===o&&(e=BD+500-wo(),10<e)){if(jE(t,0)!==0)break;if(u=t.suspendedLanes,(u&o)!==o){ea(),t.pingedLanes|=t.suspendedLanes&u;break}t.timeoutHandle=QR(Mp.bind(null,t,da,Xu),e);break}Mp(t,da,Xu);break;case 4:if(Od(t,o),(o&4194240)===o)break;for(e=t.eventTimes,u=-1;0<o;){var _=31-_c(o);d=1<<_,_=e[_],_>u&&(u=_),o&=~d}if(o=u,o=wo()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*rre(o/1960))-o,10<o){t.timeoutHandle=QR(Mp.bind(null,t,da,Xu),o);break}Mp(t,da,Xu);break;case 5:Mp(t,da,Xu);break;default:throw Error(nr(329))}}}return ga(t,wo()),t.callbackNode===n?wj.bind(null,t):null}function yk(t,e){var n=Ix;return t.current.memoizedState.isDehydrated&&(Hp(t,e).flags|=256),t=sS(t,e),t!==2&&(e=da,da=n,e!==null&&vk(e)),t}function vk(t){da===null?da=t:da.push.apply(da,t)}function nre(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var u=n[o],d=u.getSnapshot;u=u.value;try{if(!Cc(d(),u))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Od(t,e){for(e&=~LD,e&=~yT,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_c(e),o=1<<n;t[n]=-1,e&=~o}}function hN(t){if(ti&6)throw Error(nr(327));kg();var e=jE(t,0);if(!(e&1))return ga(t,wo()),null;var n=sS(t,e);if(t.tag!==0&&n===2){var o=HR(t);o!==0&&(e=o,n=yk(t,o))}if(n===1)throw n=a1,Hp(t,0),Od(t,e),ga(t,wo()),n;if(n===6)throw Error(nr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Mp(t,da,Xu),ga(t,wo()),null}function FD(t,e){var n=ti;ti|=1;try{return t(e)}finally{ti=n,ti===0&&(Xg=wo()+500,pT&&pf())}}function im(t){Bd!==null&&Bd.tag===0&&!(ti&6)&&kg();var e=ti;ti|=1;var n=Pl.transition,o=gi;try{if(Pl.transition=null,gi=1,t)return t()}finally{gi=o,Pl.transition=n,ti=e,!(ti&6)&&pf()}}function zD(){za=_g.current,Ui(_g)}function Hp(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Dte(n)),No!==null)for(n=No.return;n!==null;){var o=n;switch(yD(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&qE();break;case 3:Yg(),Ui(pa),Ui(Hs),AD();break;case 5:TD(o);break;case 4:Yg();break;case 13:Ui(ro);break;case 19:Ui(ro);break;case 10:wD(o.type._context);break;case 22:case 23:zD()}n=n.return}if(cs=t,No=t=Yd(t.current,null),Ss=za=e,Yo=0,a1=null,LD=yT=nm=0,da=Ix=null,Bp!==null){for(e=0;e<Bp.length;e++)if(n=Bp[e],o=n.interleaved,o!==null){n.interleaved=null;var u=o.next,d=n.pending;if(d!==null){var _=d.next;d.next=u,o.next=_}n.pending=o}Bp=null}return t}function Cj(t,e){do{var n=No;try{if(bD(),nE.current=rS,tS){for(var o=oo.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}tS=!1}if(rm=0,os=qo=oo=null,Tx=!1,i1=0,OD.current=null,n===null||n.return===null){Yo=1,a1=e,No=null;break}e:{var d=t,_=n.return,v=n,a=e;if(e=Ss,v.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var C=a,A=v,k=A.tag;if(!(A.mode&1)&&(k===0||k===11||k===15)){var O=A.alternate;O?(A.updateQueue=O.updateQueue,A.memoizedState=O.memoizedState,A.lanes=O.lanes):(A.updateQueue=null,A.memoizedState=null)}var R=Q6(_);if(R!==null){R.flags&=-257,J6(R,_,v,d,e),R.mode&1&&X6(d,C,e),e=R,a=C;var z=e.updateQueue;if(z===null){var N=new Set;N.add(a),e.updateQueue=N}else z.add(a);break e}else{if(!(e&1)){X6(d,C,e),ND();break e}a=Error(nr(426))}}else if(Wi&&v.mode&1){var K=Q6(_);if(K!==null){!(K.flags&65536)&&(K.flags|=256),J6(K,_,v,d,e),vD(Zg(a,v));break e}}d=a=Zg(a,v),Yo!==4&&(Yo=2),Ix===null?Ix=[d]:Ix.push(d),d=_;do{switch(d.tag){case 3:d.flags|=65536,e&=-e,d.lanes|=e;var q=sj(d,a,e);G6(d,q);break e;case 1:v=a;var j=d.type,H=d.stateNode;if(!(d.flags&128)&&(typeof j.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(qd===null||!qd.has(H)))){d.flags|=65536,e&=-e,d.lanes|=e;var Y=aj(d,v,e);G6(d,Y);break e}}d=d.return}while(d!==null)}Tj(n)}catch(te){e=te,No===n&&n!==null&&(No=n=n.return);continue}break}while(!0)}function Ej(){var t=nS.current;return nS.current=rS,t===null?rS:t}function ND(){(Yo===0||Yo===3||Yo===2)&&(Yo=4),cs===null||!(nm&268435455)&&!(yT&268435455)||Od(cs,Ss)}function sS(t,e){var n=ti;ti|=2;var o=Ej();(cs!==t||Ss!==e)&&(Xu=null,Hp(t,e));do try{ire();break}catch(u){Cj(t,u)}while(!0);if(bD(),ti=n,nS.current=o,No!==null)throw Error(nr(261));return cs=null,Ss=0,Yo}function ire(){for(;No!==null;)Sj(No)}function ore(){for(;No!==null&&!Pee();)Sj(No)}function Sj(t){var e=Ij(t.alternate,t,za);t.memoizedProps=t.pendingProps,e===null?Tj(t):No=e,OD.current=null}function Tj(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Qte(n,e),n!==null){n.flags&=32767,No=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yo=6,No=null;return}}else if(n=Xte(n,e,za),n!==null){No=n;return}if(e=e.sibling,e!==null){No=e;return}No=e=t}while(e!==null);Yo===0&&(Yo=5)}function Mp(t,e,n){var o=gi,u=Pl.transition;try{Pl.transition=null,gi=1,sre(t,e,n,o)}finally{Pl.transition=u,gi=o}return null}function sre(t,e,n,o){do kg();while(Bd!==null);if(ti&6)throw Error(nr(327));n=t.finishedWork;var u=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(nr(177));t.callbackNode=null,t.callbackPriority=0;var d=n.lanes|n.childLanes;if(Uee(t,d),t===cs&&(No=cs=null,Ss=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vC||(vC=!0,Mj($E,function(){return kg(),null})),d=(n.flags&15990)!==0,n.subtreeFlags&15990||d){d=Pl.transition,Pl.transition=null;var _=gi;gi=1;var v=ti;ti|=4,OD.current=null,ere(t,n),xj(n,t),Tte(ZR),VE=!!YR,ZR=YR=null,t.current=n,tre(n),Ree(),ti=v,gi=_,Pl.transition=d}else t.current=n;if(vC&&(vC=!1,Bd=t,oS=u),d=t.pendingLanes,d===0&&(qd=null),Oee(n.stateNode),ga(t,wo()),e!==null)for(o=t.onRecoverableError,n=0;n<e.length;n++)u=e[n],o(u.value,{componentStack:u.stack,digest:u.digest});if(iS)throw iS=!1,t=gk,gk=null,t;return oS&1&&t.tag!==0&&kg(),d=t.pendingLanes,d&1?t===_k?Mx++:(Mx=0,_k=t):Mx=0,pf(),null}function kg(){if(Bd!==null){var t=s$(oS),e=Pl.transition,n=gi;try{if(Pl.transition=null,gi=16>t?16:t,Bd===null)var o=!1;else{if(t=Bd,Bd=null,oS=0,ti&6)throw Error(nr(331));var u=ti;for(ti|=4,Ir=t.current;Ir!==null;){var d=Ir,_=d.child;if(Ir.flags&16){var v=d.deletions;if(v!==null){for(var a=0;a<v.length;a++){var C=v[a];for(Ir=C;Ir!==null;){var A=Ir;switch(A.tag){case 0:case 11:case 15:Ax(8,A,d)}var k=A.child;if(k!==null)k.return=A,Ir=k;else for(;Ir!==null;){A=Ir;var O=A.sibling,R=A.return;if(_j(A),A===C){Ir=null;break}if(O!==null){O.return=R,Ir=O;break}Ir=R}}}var z=d.alternate;if(z!==null){var N=z.child;if(N!==null){z.child=null;do{var K=N.sibling;N.sibling=null,N=K}while(N!==null)}}Ir=d}}if(d.subtreeFlags&2064&&_!==null)_.return=d,Ir=_;else e:for(;Ir!==null;){if(d=Ir,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Ax(9,d,d.return)}var q=d.sibling;if(q!==null){q.return=d.return,Ir=q;break e}Ir=d.return}}var j=t.current;for(Ir=j;Ir!==null;){_=Ir;var H=_.child;if(_.subtreeFlags&2064&&H!==null)H.return=_,Ir=H;else e:for(_=j;Ir!==null;){if(v=Ir,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:_T(9,v)}}catch(te){fo(v,v.return,te)}if(v===_){Ir=null;break e}var Y=v.sibling;if(Y!==null){Y.return=v.return,Ir=Y;break e}Ir=v.return}}if(ti=u,pf(),cu&&typeof cu.onPostCommitFiberRoot=="function")try{cu.onPostCommitFiberRoot(cT,t)}catch{}o=!0}return o}finally{gi=n,Pl.transition=e}}return!1}function dN(t,e,n){e=Zg(n,e),e=sj(t,e,1),t=Wd(t,e,1),e=ea(),t!==null&&(D1(t,1,e),ga(t,e))}function fo(t,e,n){if(t.tag===3)dN(t,t,n);else for(;e!==null;){if(e.tag===3){dN(e,t,n);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(qd===null||!qd.has(o))){t=Zg(n,t),t=aj(e,t,1),e=Wd(e,t,1),t=ea(),e!==null&&(D1(e,1,t),ga(e,t));break}}e=e.return}}function are(t,e,n){var o=t.pingCache;o!==null&&o.delete(e),e=ea(),t.pingedLanes|=t.suspendedLanes&n,cs===t&&(Ss&n)===n&&(Yo===4||Yo===3&&(Ss&130023424)===Ss&&500>wo()-BD?Hp(t,0):LD|=n),ga(t,e)}function Aj(t,e){e===0&&(t.mode&1?(e=cC,cC<<=1,!(cC&130023424)&&(cC=4194304)):e=1);var n=ea();t=gh(t,e),t!==null&&(D1(t,e,n),ga(t,n))}function lre(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Aj(t,n)}function cre(t,e){var n=0;switch(t.tag){case 13:var o=t.stateNode,u=t.memoizedState;u!==null&&(n=u.retryLane);break;case 19:o=t.stateNode;break;default:throw Error(nr(314))}o!==null&&o.delete(e),Aj(t,n)}var Ij;Ij=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pa.current)fa=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fa=!1,Zte(t,e,n);fa=!!(t.flags&131072)}else fa=!1,Wi&&e.flags&1048576&&k$(e,ZE,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;oE(t,e),t=e.pendingProps;var u=Wg(e,Hs.current);Rg(e,n),u=MD(null,e,o,t,u,n);var d=PD();return e.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ma(o)?(d=!0,KE(e)):d=!1,e.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,ED(e),u.updater=gT,e.stateNode=u,u._reactInternals=e,ok(e,o,t,n),e=lk(null,e,o,!0,d,n)):(e.tag=0,Wi&&d&&_D(e),Qs(null,e,u,n),e=e.child),e;case 16:o=e.elementType;e:{switch(oE(t,e),t=e.pendingProps,u=o._init,o=u(o._payload),e.type=o,u=e.tag=hre(o),t=cc(o,t),u){case 0:e=ak(null,e,o,t,n);break e;case 1:e=rN(null,e,o,t,n);break e;case 11:e=eN(null,e,o,t,n);break e;case 14:e=tN(null,e,o,cc(o.type,t),n);break e}throw Error(nr(306,o,""))}return e;case 0:return o=e.type,u=e.pendingProps,u=e.elementType===o?u:cc(o,u),ak(t,e,o,u,n);case 1:return o=e.type,u=e.pendingProps,u=e.elementType===o?u:cc(o,u),rN(t,e,o,u,n);case 3:e:{if(hj(e),t===null)throw Error(nr(387));o=e.pendingProps,d=e.memoizedState,u=d.element,z$(t,e),JE(e,o,null,n);var _=e.memoizedState;if(o=_.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},e.updateQueue.baseState=d,e.memoizedState=d,e.flags&256){u=Zg(Error(nr(423)),e),e=nN(t,e,o,n,u);break e}else if(o!==u){u=Zg(Error(nr(424)),e),e=nN(t,e,o,n,u);break e}else for(Ha=Gd(e.stateNode.containerInfo.firstChild),Ka=e,Wi=!0,fc=null,n=B$(e,null,o,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qg(),o===u){e=_h(t,e,n);break e}Qs(t,e,o,n)}e=e.child}return e;case 5:return N$(e),t===null&&rk(e),o=e.type,u=e.pendingProps,d=t!==null?t.memoizedProps:null,_=u.children,XR(o,u)?_=null:d!==null&&XR(o,d)&&(e.flags|=32),uj(t,e),Qs(t,e,_,n),e.child;case 6:return t===null&&rk(e),null;case 13:return dj(t,e,n);case 4:return SD(e,e.stateNode.containerInfo),o=e.pendingProps,t===null?e.child=Kg(e,null,o,n):Qs(t,e,o,n),e.child;case 11:return o=e.type,u=e.pendingProps,u=e.elementType===o?u:cc(o,u),eN(t,e,o,u,n);case 7:return Qs(t,e,e.pendingProps,n),e.child;case 8:return Qs(t,e,e.pendingProps.children,n),e.child;case 12:return Qs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(o=e.type._context,u=e.pendingProps,d=e.memoizedProps,_=u.value,Li(XE,o._currentValue),o._currentValue=_,d!==null)if(Cc(d.value,_)){if(d.children===u.children&&!pa.current){e=_h(t,e,n);break e}}else for(d=e.child,d!==null&&(d.return=e);d!==null;){var v=d.dependencies;if(v!==null){_=d.child;for(var a=v.firstContext;a!==null;){if(a.context===o){if(d.tag===1){a=hh(-1,n&-n),a.tag=2;var C=d.updateQueue;if(C!==null){C=C.shared;var A=C.pending;A===null?a.next=a:(a.next=A.next,A.next=a),C.pending=a}}d.lanes|=n,a=d.alternate,a!==null&&(a.lanes|=n),nk(d.return,n,e),v.lanes|=n;break}a=a.next}}else if(d.tag===10)_=d.type===e.type?null:d.child;else if(d.tag===18){if(_=d.return,_===null)throw Error(nr(341));_.lanes|=n,v=_.alternate,v!==null&&(v.lanes|=n),nk(_,n,e),_=d.sibling}else _=d.child;if(_!==null)_.return=d;else for(_=d;_!==null;){if(_===e){_=null;break}if(d=_.sibling,d!==null){d.return=_.return,_=d;break}_=_.return}d=_}Qs(t,e,u.children,n),e=e.child}return e;case 9:return u=e.type,o=e.pendingProps.children,Rg(e,n),u=kl(u),o=o(u),e.flags|=1,Qs(t,e,o,n),e.child;case 14:return o=e.type,u=cc(o,e.pendingProps),u=cc(o.type,u),tN(t,e,o,u,n);case 15:return lj(t,e,e.type,e.pendingProps,n);case 17:return o=e.type,u=e.pendingProps,u=e.elementType===o?u:cc(o,u),oE(t,e),e.tag=1,ma(o)?(t=!0,KE(e)):t=!1,Rg(e,n),oj(e,o,u),ok(e,o,u,n),lk(null,e,o,!0,t,n);case 19:return fj(t,e,n);case 22:return cj(t,e,n)}throw Error(nr(156,e.tag))};function Mj(t,e){return r$(t,e)}function ure(t,e,n,o){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Al(t,e,n,o){return new ure(t,e,n,o)}function UD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function hre(t){if(typeof t=="function")return UD(t)?1:0;if(t!=null){if(t=t.$$typeof,t===oD)return 11;if(t===sD)return 14}return 2}function Yd(t,e){var n=t.alternate;return n===null?(n=Al(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function lE(t,e,n,o,u,d){var _=2;if(o=t,typeof t=="function")UD(t)&&(_=1);else if(typeof t=="string")_=5;else e:switch(t){case ag:return Gp(n.children,u,d,e);case iD:_=8,u|=8;break;case MR:return t=Al(12,n,e,u|2),t.elementType=MR,t.lanes=d,t;case PR:return t=Al(13,n,e,u),t.elementType=PR,t.lanes=d,t;case RR:return t=Al(19,n,e,u),t.elementType=RR,t.lanes=d,t;case N7:return vT(n,u,d,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case F7:_=10;break e;case z7:_=9;break e;case oD:_=11;break e;case sD:_=14;break e;case Md:_=16,o=null;break e}throw Error(nr(130,t==null?t:typeof t,""))}return e=Al(_,n,e,u),e.elementType=t,e.type=o,e.lanes=d,e}function Gp(t,e,n,o){return t=Al(7,t,o,e),t.lanes=n,t}function vT(t,e,n,o){return t=Al(22,t,o,e),t.elementType=N7,t.lanes=n,t.stateNode={isHidden:!1},t}function DM(t,e,n){return t=Al(6,t,null,e),t.lanes=n,t}function OM(t,e,n){return e=Al(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function dre(t,e,n,o,u){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pM(0),this.expirationTimes=pM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pM(0),this.identifierPrefix=o,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function $D(t,e,n,o,u,d,_,v,a){return t=new dre(t,e,n,v,a),e===1?(e=1,d===!0&&(e|=8)):e=0,d=Al(3,null,null,e),t.current=d,d.stateNode=t,d.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ED(d),t}function fre(t,e,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sg,key:o==null?null:""+o,children:t,containerInfo:e,implementation:n}}function Pj(t){if(!t)return tf;t=t._reactInternals;e:{if(_m(t)!==t||t.tag!==1)throw Error(nr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ma(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(nr(171))}if(t.tag===1){var n=t.type;if(ma(n))return P$(t,n,e)}return e}function Rj(t,e,n,o,u,d,_,v,a){return t=$D(n,o,!0,t,u,d,_,v,a),t.context=Pj(null),n=t.current,o=ea(),u=Kd(n),d=hh(o,u),d.callback=e??null,Wd(n,d,u),t.current.lanes=u,D1(t,u,o),ga(t,o),t}function xT(t,e,n,o){var u=e.current,d=ea(),_=Kd(u);return n=Pj(n),e.context===null?e.context=n:e.pendingContext=n,e=hh(d,_),e.payload={element:t},o=o===void 0?null:o,o!==null&&(e.callback=o),t=Wd(u,e,_),t!==null&&(yc(t,u,_,d),rE(t,u,_)),_}function aS(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function jD(t,e){fN(t,e),(t=t.alternate)&&fN(t,e)}function pre(){return null}var kj=typeof reportError=="function"?reportError:function(t){console.error(t)};function VD(t){this._internalRoot=t}bT.prototype.render=VD.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(nr(409));xT(t,e,null,null)};bT.prototype.unmount=VD.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;im(function(){xT(null,t,null,null)}),e[mh]=null}};function bT(t){this._internalRoot=t}bT.prototype.unstable_scheduleHydration=function(t){if(t){var e=c$();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Dd.length&&e!==0&&e<Dd[n].priority;n++);Dd.splice(n,0,t),n===0&&h$(t)}};function HD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pN(){}function mre(t,e,n,o,u){if(u){if(typeof o=="function"){var d=o;o=function(){var C=aS(_);d.call(C)}}var _=Rj(e,o,t,0,null,!1,!1,"",pN);return t._reactRootContainer=_,t[mh]=_.current,Jx(t.nodeType===8?t.parentNode:t),im(),_}for(;u=t.lastChild;)t.removeChild(u);if(typeof o=="function"){var v=o;o=function(){var C=aS(a);v.call(C)}}var a=$D(t,0,!1,null,null,!1,!1,"",pN);return t._reactRootContainer=a,t[mh]=a.current,Jx(t.nodeType===8?t.parentNode:t),im(function(){xT(e,a,n,o)}),a}function CT(t,e,n,o,u){var d=n._reactRootContainer;if(d){var _=d;if(typeof u=="function"){var v=u;u=function(){var a=aS(_);v.call(a)}}xT(e,_,t,u)}else _=mre(n,e,t,u,o);return aS(_)}a$=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ox(e.pendingLanes);n!==0&&(cD(e,n|1),ga(e,wo()),!(ti&6)&&(Xg=wo()+500,pf()))}break;case 13:im(function(){var o=gh(t,1);if(o!==null){var u=ea();yc(o,t,1,u)}}),jD(t,1)}};uD=function(t){if(t.tag===13){var e=gh(t,134217728);if(e!==null){var n=ea();yc(e,t,134217728,n)}jD(t,134217728)}};l$=function(t){if(t.tag===13){var e=Kd(t),n=gh(t,e);if(n!==null){var o=ea();yc(n,t,e,o)}jD(t,e)}};c$=function(){return gi};u$=function(t,e){var n=gi;try{return gi=t,e()}finally{gi=n}};$R=function(t,e,n){switch(e){case"input":if(OR(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var o=n[e];if(o!==t&&o.form===t.form){var u=fT(o);if(!u)throw Error(nr(90));$7(o),OR(o,u)}}}break;case"textarea":V7(t,n);break;case"select":e=n.value,e!=null&&Ag(t,!!n.multiple,e,!1)}};Z7=FD;X7=im;var gre={usingClientEntryPoint:!1,Events:[L1,hg,fT,K7,Y7,FD]},jv={findFiberByHostInstance:Lp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_re={bundleType:jv.bundleType,version:jv.version,rendererPackageName:jv.rendererPackageName,rendererConfig:jv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ch.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=e$(t),t===null?null:t.stateNode},findFiberByHostInstance:jv.findFiberByHostInstance||pre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xC.isDisabled&&xC.supportsFiber)try{cT=xC.inject(_re),cu=xC}catch{}}rl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gre;rl.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!HD(e))throw Error(nr(200));return fre(t,e,null,n)};rl.createRoot=function(t,e){if(!HD(t))throw Error(nr(299));var n=!1,o="",u=kj;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(u=e.onRecoverableError)),e=$D(t,1,!1,null,null,n,!1,o,u),t[mh]=e.current,Jx(t.nodeType===8?t.parentNode:t),new VD(e)};rl.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(nr(188)):(t=Object.keys(t).join(","),Error(nr(268,t)));return t=e$(e),t=t===null?null:t.stateNode,t};rl.flushSync=function(t){return im(t)};rl.hydrate=function(t,e,n){if(!wT(e))throw Error(nr(200));return CT(null,t,e,!0,n)};rl.hydrateRoot=function(t,e,n){if(!HD(t))throw Error(nr(405));var o=n!=null&&n.hydratedSources||null,u=!1,d="",_=kj;if(n!=null&&(n.unstable_strictMode===!0&&(u=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onRecoverableError!==void 0&&(_=n.onRecoverableError)),e=Rj(e,null,t,1,n??null,u,!1,d,_),t[mh]=e.current,Jx(t),o)for(t=0;t<o.length;t++)n=o[t],u=n._getVersion,u=u(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,u]:e.mutableSourceEagerHydrationData.push(n,u);return new bT(e)};rl.render=function(t,e,n){if(!wT(e))throw Error(nr(200));return CT(null,t,e,!1,n)};rl.unmountComponentAtNode=function(t){if(!wT(t))throw Error(nr(40));return t._reactRootContainer?(im(function(){CT(null,null,t,!1,function(){t._reactRootContainer=null,t[mh]=null})}),!0):!1};rl.unstable_batchedUpdates=FD;rl.unstable_renderSubtreeIntoContainer=function(t,e,n,o){if(!wT(n))throw Error(nr(200));if(t==null||t._reactInternals===void 0)throw Error(nr(38));return CT(t,e,n,!1,o)};rl.version="18.3.1-next-f1338f8080-20240426";function Dj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dj)}catch(t){console.error(t)}}Dj(),D7.exports=rl;var ET=D7.exports;const ax=aT(ET),yre=b7({__proto__:null,default:ax},[ET]);var mN=ET;AR.createRoot=mN.createRoot,AR.hydrateRoot=mN.hydrateRoot;function om(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const vre=Object.freeze(Object.defineProperty({__proto__:null,default:om},Symbol.toStringTag,{value:"Module"})),Qg="$$material";function We(){return We=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},We.apply(null,arguments)}function tn(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;n[o]=t[o]}return n}function Oj(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var xre=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,bre=Oj(function(t){return xre.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function wre(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Cre(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Ere=function(){function t(n){var o=this;this._insertTag=function(u){var d;o.tags.length===0?o.insertionPoint?d=o.insertionPoint.nextSibling:o.prepend?d=o.container.firstChild:d=o.before:d=o.tags[o.tags.length-1].nextSibling,o.container.insertBefore(u,d),o.tags.push(u)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(o){o.forEach(this._insertTag)},e.insert=function(o){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Cre(this));var u=this.tags[this.tags.length-1];if(this.isSpeedy){var d=wre(u);try{d.insertRule(o,d.cssRules.length)}catch{}}else u.appendChild(document.createTextNode(o));this.ctr++},e.flush=function(){this.tags.forEach(function(o){return o.parentNode&&o.parentNode.removeChild(o)}),this.tags=[],this.ctr=0},t}(),Fs="-ms-",lS="-moz-",si="-webkit-",Lj="comm",GD="rule",WD="decl",Sre="@import",Bj="@keyframes",Tre="@layer",Are=Math.abs,ST=String.fromCharCode,Ire=Object.assign;function Mre(t,e){return ws(t,0)^45?(((e<<2^ws(t,0))<<2^ws(t,1))<<2^ws(t,2))<<2^ws(t,3):0}function Fj(t){return t.trim()}function Pre(t,e){return(t=e.exec(t))?t[0]:t}function ai(t,e,n){return t.replace(e,n)}function xk(t,e){return t.indexOf(e)}function ws(t,e){return t.charCodeAt(e)|0}function l1(t,e,n){return t.slice(e,n)}function Xc(t){return t.length}function qD(t){return t.length}function bC(t,e){return e.push(t),t}function Rre(t,e){return t.map(e).join("")}var TT=1,Jg=1,zj=0,Ca=0,zo=0,T_="";function AT(t,e,n,o,u,d,_){return{value:t,root:e,parent:n,type:o,props:u,children:d,line:TT,column:Jg,length:_,return:""}}function Vv(t,e){return Ire(AT("",null,null,"",null,null,0),t,{length:-t.length},e)}function kre(){return zo}function Dre(){return zo=Ca>0?ws(T_,--Ca):0,Jg--,zo===10&&(Jg=1,TT--),zo}function Ya(){return zo=Ca<zj?ws(T_,Ca++):0,Jg++,zo===10&&(Jg=1,TT++),zo}function hu(){return ws(T_,Ca)}function cE(){return Ca}function F1(t,e){return l1(T_,t,e)}function c1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Nj(t){return TT=Jg=1,zj=Xc(T_=t),Ca=0,[]}function Uj(t){return T_="",t}function uE(t){return Fj(F1(Ca-1,bk(t===91?t+2:t===40?t+1:t)))}function Ore(t){for(;(zo=hu())&&zo<33;)Ya();return c1(t)>2||c1(zo)>3?"":" "}function Lre(t,e){for(;--e&&Ya()&&!(zo<48||zo>102||zo>57&&zo<65||zo>70&&zo<97););return F1(t,cE()+(e<6&&hu()==32&&Ya()==32))}function bk(t){for(;Ya();)switch(zo){case t:return Ca;case 34:case 39:t!==34&&t!==39&&bk(zo);break;case 40:t===41&&bk(t);break;case 92:Ya();break}return Ca}function Bre(t,e){for(;Ya()&&t+zo!==57;)if(t+zo===84&&hu()===47)break;return"/*"+F1(e,Ca-1)+"*"+ST(t===47?t:Ya())}function Fre(t){for(;!c1(hu());)Ya();return F1(t,Ca)}function zre(t){return Uj(hE("",null,null,null,[""],t=Nj(t),0,[0],t))}function hE(t,e,n,o,u,d,_,v,a){for(var C=0,A=0,k=_,O=0,R=0,z=0,N=1,K=1,q=1,j=0,H="",Y=u,te=d,J=o,ae=H;K;)switch(z=j,j=Ya()){case 40:if(z!=108&&ws(ae,k-1)==58){xk(ae+=ai(uE(j),"&","&\f"),"&\f")!=-1&&(q=-1);break}case 34:case 39:case 91:ae+=uE(j);break;case 9:case 10:case 13:case 32:ae+=Ore(z);break;case 92:ae+=Lre(cE()-1,7);continue;case 47:switch(hu()){case 42:case 47:bC(Nre(Bre(Ya(),cE()),e,n),a);break;default:ae+="/"}break;case 123*N:v[C++]=Xc(ae)*q;case 125*N:case 59:case 0:switch(j){case 0:case 125:K=0;case 59+A:q==-1&&(ae=ai(ae,/\f/g,"")),R>0&&Xc(ae)-k&&bC(R>32?_N(ae+";",o,n,k-1):_N(ai(ae," ","")+";",o,n,k-2),a);break;case 59:ae+=";";default:if(bC(J=gN(ae,e,n,C,A,u,v,H,Y=[],te=[],k),d),j===123)if(A===0)hE(ae,e,J,J,Y,d,k,v,te);else switch(O===99&&ws(ae,3)===110?100:O){case 100:case 108:case 109:case 115:hE(t,J,J,o&&bC(gN(t,J,J,0,0,u,v,H,u,Y=[],k),te),u,te,k,v,o?Y:te);break;default:hE(ae,J,J,J,[""],te,0,v,te)}}C=A=R=0,N=q=1,H=ae="",k=_;break;case 58:k=1+Xc(ae),R=z;default:if(N<1){if(j==123)--N;else if(j==125&&N++==0&&Dre()==125)continue}switch(ae+=ST(j),j*N){case 38:q=A>0?1:(ae+="\f",-1);break;case 44:v[C++]=(Xc(ae)-1)*q,q=1;break;case 64:hu()===45&&(ae+=uE(Ya())),O=hu(),A=k=Xc(H=ae+=Fre(cE())),j++;break;case 45:z===45&&Xc(ae)==2&&(N=0)}}return d}function gN(t,e,n,o,u,d,_,v,a,C,A){for(var k=u-1,O=u===0?d:[""],R=qD(O),z=0,N=0,K=0;z<o;++z)for(var q=0,j=l1(t,k+1,k=Are(N=_[z])),H=t;q<R;++q)(H=Fj(N>0?O[q]+" "+j:ai(j,/&\f/g,O[q])))&&(a[K++]=H);return AT(t,e,n,u===0?GD:v,a,C,A)}function Nre(t,e,n){return AT(t,e,n,Lj,ST(kre()),l1(t,2,-2),0)}function _N(t,e,n,o){return AT(t,e,n,WD,l1(t,0,o),l1(t,o+1,-1),o)}function Dg(t,e){for(var n="",o=qD(t),u=0;u<o;u++)n+=e(t[u],u,t,e)||"";return n}function Ure(t,e,n,o){switch(t.type){case Tre:if(t.children.length)break;case Sre:case WD:return t.return=t.return||t.value;case Lj:return"";case Bj:return t.return=t.value+"{"+Dg(t.children,o)+"}";case GD:t.value=t.props.join(",")}return Xc(n=Dg(t.children,o))?t.return=t.value+"{"+n+"}":""}function $re(t){var e=qD(t);return function(n,o,u,d){for(var _="",v=0;v<e;v++)_+=t[v](n,o,u,d)||"";return _}}function jre(t){return function(e){e.root||(e=e.return)&&t(e)}}var Vre=function(e,n,o){for(var u=0,d=0;u=d,d=hu(),u===38&&d===12&&(n[o]=1),!c1(d);)Ya();return F1(e,Ca)},Hre=function(e,n){var o=-1,u=44;do switch(c1(u)){case 0:u===38&&hu()===12&&(n[o]=1),e[o]+=Vre(Ca-1,n,o);break;case 2:e[o]+=uE(u);break;case 4:if(u===44){e[++o]=hu()===58?"&\f":"",n[o]=e[o].length;break}default:e[o]+=ST(u)}while(u=Ya());return e},Gre=function(e,n){return Uj(Hre(Nj(e),n))},yN=new WeakMap,Wre=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,o=e.parent,u=e.column===o.column&&e.line===o.line;o.type!=="rule";)if(o=o.parent,!o)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!yN.get(o))&&!u){yN.set(e,!0);for(var d=[],_=Gre(n,d),v=o.props,a=0,C=0;a<_.length;a++)for(var A=0;A<v.length;A++,C++)e.props[C]=d[a]?_[a].replace(/&\f/g,v[A]):v[A]+" "+_[a]}}},qre=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function $j(t,e){switch(Mre(t,e)){case 5103:return si+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return si+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return si+t+lS+t+Fs+t+t;case 6828:case 4268:return si+t+Fs+t+t;case 6165:return si+t+Fs+"flex-"+t+t;case 5187:return si+t+ai(t,/(\w+).+(:[^]+)/,si+"box-$1$2"+Fs+"flex-$1$2")+t;case 5443:return si+t+Fs+"flex-item-"+ai(t,/flex-|-self/,"")+t;case 4675:return si+t+Fs+"flex-line-pack"+ai(t,/align-content|flex-|-self/,"")+t;case 5548:return si+t+Fs+ai(t,"shrink","negative")+t;case 5292:return si+t+Fs+ai(t,"basis","preferred-size")+t;case 6060:return si+"box-"+ai(t,"-grow","")+si+t+Fs+ai(t,"grow","positive")+t;case 4554:return si+ai(t,/([^-])(transform)/g,"$1"+si+"$2")+t;case 6187:return ai(ai(ai(t,/(zoom-|grab)/,si+"$1"),/(image-set)/,si+"$1"),t,"")+t;case 5495:case 3959:return ai(t,/(image-set\([^]*)/,si+"$1$`$1");case 4968:return ai(ai(t,/(.+:)(flex-)?(.*)/,si+"box-pack:$3"+Fs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+si+t+t;case 4095:case 3583:case 4068:case 2532:return ai(t,/(.+)-inline(.+)/,si+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xc(t)-1-e>6)switch(ws(t,e+1)){case 109:if(ws(t,e+4)!==45)break;case 102:return ai(t,/(.+:)(.+)-([^]+)/,"$1"+si+"$2-$3$1"+lS+(ws(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~xk(t,"stretch")?$j(ai(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(ws(t,e+1)!==115)break;case 6444:switch(ws(t,Xc(t)-3-(~xk(t,"!important")&&10))){case 107:return ai(t,":",":"+si)+t;case 101:return ai(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+si+(ws(t,14)===45?"inline-":"")+"box$3$1"+si+"$2$3$1"+Fs+"$2box$3")+t}break;case 5936:switch(ws(t,e+11)){case 114:return si+t+Fs+ai(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return si+t+Fs+ai(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return si+t+Fs+ai(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return si+t+Fs+t+t}return t}var Kre=function(e,n,o,u){if(e.length>-1&&!e.return)switch(e.type){case WD:e.return=$j(e.value,e.length);break;case Bj:return Dg([Vv(e,{value:ai(e.value,"@","@"+si)})],u);case GD:if(e.length)return Rre(e.props,function(d){switch(Pre(d,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Dg([Vv(e,{props:[ai(d,/:(read-\w+)/,":"+lS+"$1")]})],u);case"::placeholder":return Dg([Vv(e,{props:[ai(d,/:(plac\w+)/,":"+si+"input-$1")]}),Vv(e,{props:[ai(d,/:(plac\w+)/,":"+lS+"$1")]}),Vv(e,{props:[ai(d,/:(plac\w+)/,Fs+"input-$1")]})],u)}return""})}},Yre=[Kre],jj=function(e){var n=e.key;if(n==="css"){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,function(N){var K=N.getAttribute("data-emotion");K.indexOf(" ")!==-1&&(document.head.appendChild(N),N.setAttribute("data-s",""))})}var u=e.stylisPlugins||Yre,d={},_,v=[];_=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(N){for(var K=N.getAttribute("data-emotion").split(" "),q=1;q<K.length;q++)d[K[q]]=!0;v.push(N)});var a,C=[Wre,qre];{var A,k=[Ure,jre(function(N){A.insert(N)})],O=$re(C.concat(u,k)),R=function(K){return Dg(zre(K),O)};a=function(K,q,j,H){A=j,R(K?K+"{"+q.styles+"}":q.styles),H&&(z.inserted[q.name]=!0)}}var z={key:n,sheet:new Ere({key:n,container:_,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:d,registered:{},insert:a};return z.sheet.hydrate(v),z},Vj={exports:{}},_i={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hs=typeof Symbol=="function"&&Symbol.for,KD=hs?Symbol.for("react.element"):60103,YD=hs?Symbol.for("react.portal"):60106,IT=hs?Symbol.for("react.fragment"):60107,MT=hs?Symbol.for("react.strict_mode"):60108,PT=hs?Symbol.for("react.profiler"):60114,RT=hs?Symbol.for("react.provider"):60109,kT=hs?Symbol.for("react.context"):60110,ZD=hs?Symbol.for("react.async_mode"):60111,DT=hs?Symbol.for("react.concurrent_mode"):60111,OT=hs?Symbol.for("react.forward_ref"):60112,LT=hs?Symbol.for("react.suspense"):60113,Zre=hs?Symbol.for("react.suspense_list"):60120,BT=hs?Symbol.for("react.memo"):60115,FT=hs?Symbol.for("react.lazy"):60116,Xre=hs?Symbol.for("react.block"):60121,Qre=hs?Symbol.for("react.fundamental"):60117,Jre=hs?Symbol.for("react.responder"):60118,ene=hs?Symbol.for("react.scope"):60119;function il(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case KD:switch(t=t.type,t){case ZD:case DT:case IT:case PT:case MT:case LT:return t;default:switch(t=t&&t.$$typeof,t){case kT:case OT:case FT:case BT:case RT:return t;default:return e}}case YD:return e}}}function Hj(t){return il(t)===DT}_i.AsyncMode=ZD;_i.ConcurrentMode=DT;_i.ContextConsumer=kT;_i.ContextProvider=RT;_i.Element=KD;_i.ForwardRef=OT;_i.Fragment=IT;_i.Lazy=FT;_i.Memo=BT;_i.Portal=YD;_i.Profiler=PT;_i.StrictMode=MT;_i.Suspense=LT;_i.isAsyncMode=function(t){return Hj(t)||il(t)===ZD};_i.isConcurrentMode=Hj;_i.isContextConsumer=function(t){return il(t)===kT};_i.isContextProvider=function(t){return il(t)===RT};_i.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===KD};_i.isForwardRef=function(t){return il(t)===OT};_i.isFragment=function(t){return il(t)===IT};_i.isLazy=function(t){return il(t)===FT};_i.isMemo=function(t){return il(t)===BT};_i.isPortal=function(t){return il(t)===YD};_i.isProfiler=function(t){return il(t)===PT};_i.isStrictMode=function(t){return il(t)===MT};_i.isSuspense=function(t){return il(t)===LT};_i.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===IT||t===DT||t===PT||t===MT||t===LT||t===Zre||typeof t=="object"&&t!==null&&(t.$$typeof===FT||t.$$typeof===BT||t.$$typeof===RT||t.$$typeof===kT||t.$$typeof===OT||t.$$typeof===Qre||t.$$typeof===Jre||t.$$typeof===ene||t.$$typeof===Xre)};_i.typeOf=il;Vj.exports=_i;var tne=Vj.exports,Gj=tne,rne={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},nne={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Wj={};Wj[Gj.ForwardRef]=rne;Wj[Gj.Memo]=nne;var ine=!0;function one(t,e,n){var o="";return n.split(" ").forEach(function(u){t[u]!==void 0?e.push(t[u]+";"):o+=u+" "}),o}var qj=function(e,n,o){var u=e.key+"-"+n.name;(o===!1||ine===!1)&&e.registered[u]===void 0&&(e.registered[u]=n.styles)},Kj=function(e,n,o){qj(e,n,o);var u=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var d=n;do e.insert(n===d?"."+u:"",d,e.sheet,!0),d=d.next;while(d!==void 0)}};function sne(t){for(var e=0,n,o=0,u=t.length;u>=4;++o,u-=4)n=t.charCodeAt(o)&255|(t.charCodeAt(++o)&255)<<8|(t.charCodeAt(++o)&255)<<16|(t.charCodeAt(++o)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(u){case 3:e^=(t.charCodeAt(o+2)&255)<<16;case 2:e^=(t.charCodeAt(o+1)&255)<<8;case 1:e^=t.charCodeAt(o)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var ane={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},lne=/[A-Z]|^ms/g,cne=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Yj=function(e){return e.charCodeAt(1)===45},vN=function(e){return e!=null&&typeof e!="boolean"},LM=Oj(function(t){return Yj(t)?t:t.replace(lne,"-$&").toLowerCase()}),xN=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(cne,function(o,u,d){return Qc={name:u,styles:d,next:Qc},u})}return ane[e]!==1&&!Yj(e)&&typeof n=="number"&&n!==0?n+"px":n};function u1(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Qc={name:n.name,styles:n.styles,next:Qc},n.name;if(n.styles!==void 0){var o=n.next;if(o!==void 0)for(;o!==void 0;)Qc={name:o.name,styles:o.styles,next:Qc},o=o.next;var u=n.styles+";";return u}return une(t,e,n)}case"function":{if(t!==void 0){var d=Qc,_=n(t);return Qc=d,u1(t,e,_)}break}}if(e==null)return n;var v=e[n];return v!==void 0?v:n}function une(t,e,n){var o="";if(Array.isArray(n))for(var u=0;u<n.length;u++)o+=u1(t,e,n[u])+";";else for(var d in n){var _=n[d];if(typeof _!="object")e!=null&&e[_]!==void 0?o+=d+"{"+e[_]+"}":vN(_)&&(o+=LM(d)+":"+xN(d,_)+";");else if(Array.isArray(_)&&typeof _[0]=="string"&&(e==null||e[_[0]]===void 0))for(var v=0;v<_.length;v++)vN(_[v])&&(o+=LM(d)+":"+xN(d,_[v])+";");else{var a=u1(t,e,_);switch(d){case"animation":case"animationName":{o+=LM(d)+":"+a+";";break}default:o+=d+"{"+a+"}"}}}return o}var bN=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Qc,XD=function(e,n,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var u=!0,d="";Qc=void 0;var _=e[0];_==null||_.raw===void 0?(u=!1,d+=u1(o,n,_)):d+=_[0];for(var v=1;v<e.length;v++)d+=u1(o,n,e[v]),u&&(d+=_[v]);bN.lastIndex=0;for(var a="",C;(C=bN.exec(d))!==null;)a+="-"+C[1];var A=sne(d)+a;return{name:A,styles:d,next:Qc}},hne=function(e){return e()},Zj=Hg.useInsertionEffect?Hg.useInsertionEffect:!1,dne=Zj||hne,wN=Zj||fe.useLayoutEffect,Xj=fe.createContext(typeof HTMLElement<"u"?jj({key:"css"}):null),fne=Xj.Provider,Qj=function(e){return fe.forwardRef(function(n,o){var u=fe.useContext(Xj);return e(n,u,o)})},z1=fe.createContext({}),BM={exports:{}},CN;function Jj(){return CN||(CN=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var d in u)({}).hasOwnProperty.call(u,d)&&(n[d]=u[d])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(BM)),BM.exports}Jj();var pne=Qj(function(t,e){var n=t.styles,o=XD([n],void 0,fe.useContext(z1)),u=fe.useRef();return wN(function(){var d=e.key+"-global",_=new e.sheet.constructor({key:d,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),v=!1,a=document.querySelector('style[data-emotion="'+d+" "+o.name+'"]');return e.sheet.tags.length&&(_.before=e.sheet.tags[0]),a!==null&&(v=!0,a.setAttribute("data-emotion",d),_.hydrate([a])),u.current=[_,v],function(){_.flush()}},[e]),wN(function(){var d=u.current,_=d[0],v=d[1];if(v){d[1]=!1;return}if(o.next!==void 0&&Kj(e,o.next,!0),_.tags.length){var a=_.tags[_.tags.length-1].nextElementSibling;_.before=a,_.flush()}e.insert("",o,_,!1)},[e,o.name]),null});function zT(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return XD(e)}var A_=function(){var e=zT.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},mne=bre,gne=function(e){return e!=="theme"},EN=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?mne:gne},SN=function(e,n,o){var u;if(n){var d=n.shouldForwardProp;u=e.__emotion_forwardProp&&d?function(_){return e.__emotion_forwardProp(_)&&d(_)}:d}return typeof u!="function"&&o&&(u=e.__emotion_forwardProp),u},_ne=function(e){var n=e.cache,o=e.serialized,u=e.isStringTag;return qj(n,o,u),dne(function(){return Kj(n,o,u)}),null},yne=function t(e,n){var o=e.__emotion_real===e,u=o&&e.__emotion_base||e,d,_;n!==void 0&&(d=n.label,_=n.target);var v=SN(e,n,o),a=v||EN(u),C=!a("as");return function(){var A=arguments,k=o&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(d!==void 0&&k.push("label:"+d+";"),A[0]==null||A[0].raw===void 0)k.push.apply(k,A);else{k.push(A[0][0]);for(var O=A.length,R=1;R<O;R++)k.push(A[R],A[0][R])}var z=Qj(function(N,K,q){var j=C&&N.as||u,H="",Y=[],te=N;if(N.theme==null){te={};for(var J in N)te[J]=N[J];te.theme=fe.useContext(z1)}typeof N.className=="string"?H=one(K.registered,Y,N.className):N.className!=null&&(H=N.className+" ");var ae=XD(k.concat(Y),K.registered,te);H+=K.key+"-"+ae.name,_!==void 0&&(H+=" "+_);var de=C&&v===void 0?EN(j):a,Me={};for(var Ce in N)C&&Ce==="as"||de(Ce)&&(Me[Ce]=N[Ce]);return Me.className=H,Me.ref=q,fe.createElement(fe.Fragment,null,fe.createElement(_ne,{cache:K,serialized:ae,isStringTag:typeof j=="string"}),fe.createElement(j,Me))});return z.displayName=d!==void 0?d:"Styled("+(typeof u=="string"?u:u.displayName||u.name||"Component")+")",z.defaultProps=e.defaultProps,z.__emotion_real=z,z.__emotion_base=u,z.__emotion_styles=k,z.__emotion_forwardProp=v,Object.defineProperty(z,"toString",{value:function(){return"."+_}}),z.withComponent=function(N,K){return t(N,We({},n,K,{shouldForwardProp:SN(z,K,!0)})).apply(void 0,k)},z}},vne=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],wk=yne.bind();vne.forEach(function(t){wk[t]=wk(t)});let Ck;typeof document=="object"&&(Ck=jj({key:"css",prepend:!0}));function xne(t){const{injectFirst:e,children:n}=t;return e&&Ck?Ke.jsx(fne,{value:Ck,children:n}):n}function bne(t){return t==null||Object.keys(t).length===0}function eV(t){const{styles:e,defaultTheme:n={}}=t,o=typeof e=="function"?u=>e(bne(u)?n:u):e;return Ke.jsx(pne,{styles:o})}function QD(t,e){return wk(t,e)}const tV=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},wne=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:eV,StyledEngineProvider:xne,ThemeContext:z1,css:zT,default:QD,internal_processStyles:tV,keyframes:A_},Symbol.toStringTag,{value:"Module"}));function nh(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function rV(t){if(!nh(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=rV(t[n])}),e}function ta(t,e,n={clone:!0}){const o=n.clone?We({},t):t;return nh(t)&&nh(e)&&Object.keys(e).forEach(u=>{nh(e[u])&&Object.prototype.hasOwnProperty.call(t,u)&&nh(t[u])?o[u]=ta(t[u],e[u],n):n.clone?o[u]=nh(e[u])?rV(e[u]):e[u]:o[u]=e[u]}),o}const Cne=Object.freeze(Object.defineProperty({__proto__:null,default:ta,isPlainObject:nh},Symbol.toStringTag,{value:"Module"})),Ene=["values","unit","step"],Sne=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,o)=>n.val-o.val),e.reduce((n,o)=>We({},n,{[o.key]:o.val}),{})};function nV(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:o=5}=t,u=tn(t,Ene),d=Sne(e),_=Object.keys(d);function v(O){return`@media (min-width:${typeof e[O]=="number"?e[O]:O}${n})`}function a(O){return`@media (max-width:${(typeof e[O]=="number"?e[O]:O)-o/100}${n})`}function C(O,R){const z=_.indexOf(R);return`@media (min-width:${typeof e[O]=="number"?e[O]:O}${n}) and (max-width:${(z!==-1&&typeof e[_[z]]=="number"?e[_[z]]:R)-o/100}${n})`}function A(O){return _.indexOf(O)+1<_.length?C(O,_[_.indexOf(O)+1]):v(O)}function k(O){const R=_.indexOf(O);return R===0?v(_[1]):R===_.length-1?a(_[R]):C(O,_[_.indexOf(O)+1]).replace("@media","@media not all and")}return We({keys:_,values:d,up:v,down:a,between:C,only:A,not:k,unit:n},u)}const Tne={borderRadius:4};function Px(t,e){return e?ta(t,e,{clone:!1}):t}const JD={xs:0,sm:600,md:900,lg:1200,xl:1536},TN={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${JD[t]}px)`};function Ec(t,e,n){const o=t.theme||{};if(Array.isArray(e)){const d=o.breakpoints||TN;return e.reduce((_,v,a)=>(_[d.up(d.keys[a])]=n(e[a]),_),{})}if(typeof e=="object"){const d=o.breakpoints||TN;return Object.keys(e).reduce((_,v)=>{if(Object.keys(d.values||JD).indexOf(v)!==-1){const a=d.up(v);_[a]=n(e[v],v)}else{const a=v;_[a]=e[a]}return _},{})}return n(e)}function iV(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((o,u)=>{const d=t.up(u);return o[d]={},o},{}))||{}}function oV(t,e){return t.reduce((n,o)=>{const u=n[o];return(!u||Object.keys(u).length===0)&&delete n[o],n},e)}function Ane(t,...e){const n=iV(t),o=[n,...e].reduce((u,d)=>ta(u,d),{});return oV(Object.keys(n),o)}function Ine(t,e){if(typeof t!="object")return{};const n={},o=Object.keys(e);return Array.isArray(t)?o.forEach((u,d)=>{d<t.length&&(n[u]=!0)}):o.forEach(u=>{t[u]!=null&&(n[u]=!0)}),n}function FM({values:t,breakpoints:e,base:n}){const o=n||Ine(t,e),u=Object.keys(o);if(u.length===0)return t;let d;return u.reduce((_,v,a)=>(Array.isArray(t)?(_[v]=t[a]!=null?t[a]:t[d],d=a):typeof t=="object"?(_[v]=t[v]!=null?t[v]:t[d],d=v):_[v]=t,_),{})}function qn(t){if(typeof t!="string")throw new Error(om(7));return t.charAt(0).toUpperCase()+t.slice(1)}const Mne=Object.freeze(Object.defineProperty({__proto__:null,default:qn},Symbol.toStringTag,{value:"Module"}));function NT(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const o=`vars.${e}`.split(".").reduce((u,d)=>u&&u[d]?u[d]:null,t);if(o!=null)return o}return e.split(".").reduce((o,u)=>o&&o[u]!=null?o[u]:null,t)}function cS(t,e,n,o=n){let u;return typeof t=="function"?u=t(n):Array.isArray(t)?u=t[n]||o:u=NT(t,n)||o,e&&(u=e(u,o,t)),u}function So(t){const{prop:e,cssProperty:n=t.prop,themeKey:o,transform:u}=t,d=_=>{if(_[e]==null)return null;const v=_[e],a=_.theme,C=NT(a,o)||{};return Ec(_,v,k=>{let O=cS(C,u,k);return k===O&&typeof k=="string"&&(O=cS(C,u,`${e}${k==="default"?"":qn(k)}`,k)),n===!1?O:{[n]:O}})};return d.propTypes={},d.filterProps=[e],d}function Pne(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const Rne={m:"margin",p:"padding"},kne={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},AN={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Dne=Pne(t=>{if(t.length>2)if(AN[t])t=AN[t];else return[t];const[e,n]=t.split(""),o=Rne[e],u=kne[n]||"";return Array.isArray(u)?u.map(d=>o+d):[o+u]}),eO=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],tO=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...eO,...tO];function N1(t,e,n,o){var u;const d=(u=NT(t,e,!1))!=null?u:n;return typeof d=="number"?_=>typeof _=="string"?_:d*_:Array.isArray(d)?_=>typeof _=="string"?_:d[_]:typeof d=="function"?d:()=>{}}function rO(t){return N1(t,"spacing",8)}function sm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),o=t(n);return e>=0?o:typeof o=="number"?-o:`-${o}`}function One(t,e){return n=>t.reduce((o,u)=>(o[u]=sm(e,n),o),{})}function Lne(t,e,n,o){if(e.indexOf(n)===-1)return null;const u=Dne(n),d=One(u,o),_=t[n];return Ec(t,_,d)}function sV(t,e){const n=rO(t.theme);return Object.keys(t).map(o=>Lne(t,e,o,n)).reduce(Px,{})}function uo(t){return sV(t,eO)}uo.propTypes={};uo.filterProps=eO;function ho(t){return sV(t,tO)}ho.propTypes={};ho.filterProps=tO;function Bne(t=8){if(t.mui)return t;const e=rO({spacing:t}),n=(...o)=>(o.length===0?[1]:o).map(d=>{const _=e(d);return typeof _=="number"?`${_}px`:_}).join(" ");return n.mui=!0,n}function UT(...t){const e=t.reduce((o,u)=>(u.filterProps.forEach(d=>{o[d]=u}),o),{}),n=o=>Object.keys(o).reduce((u,d)=>e[d]?Px(u,e[d](o)):u,{});return n.propTypes={},n.filterProps=t.reduce((o,u)=>o.concat(u.filterProps),[]),n}function El(t){return typeof t!="number"?t:`${t}px solid`}function Bl(t,e){return So({prop:t,themeKey:"borders",transform:e})}const Fne=Bl("border",El),zne=Bl("borderTop",El),Nne=Bl("borderRight",El),Une=Bl("borderBottom",El),$ne=Bl("borderLeft",El),jne=Bl("borderColor"),Vne=Bl("borderTopColor"),Hne=Bl("borderRightColor"),Gne=Bl("borderBottomColor"),Wne=Bl("borderLeftColor"),qne=Bl("outline",El),Kne=Bl("outlineColor"),$T=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=N1(t.theme,"shape.borderRadius",4),n=o=>({borderRadius:sm(e,o)});return Ec(t,t.borderRadius,n)}return null};$T.propTypes={};$T.filterProps=["borderRadius"];UT(Fne,zne,Nne,Une,$ne,jne,Vne,Hne,Gne,Wne,$T,qne,Kne);const jT=t=>{if(t.gap!==void 0&&t.gap!==null){const e=N1(t.theme,"spacing",8),n=o=>({gap:sm(e,o)});return Ec(t,t.gap,n)}return null};jT.propTypes={};jT.filterProps=["gap"];const VT=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=N1(t.theme,"spacing",8),n=o=>({columnGap:sm(e,o)});return Ec(t,t.columnGap,n)}return null};VT.propTypes={};VT.filterProps=["columnGap"];const HT=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=N1(t.theme,"spacing",8),n=o=>({rowGap:sm(e,o)});return Ec(t,t.rowGap,n)}return null};HT.propTypes={};HT.filterProps=["rowGap"];const Yne=So({prop:"gridColumn"}),Zne=So({prop:"gridRow"}),Xne=So({prop:"gridAutoFlow"}),Qne=So({prop:"gridAutoColumns"}),Jne=So({prop:"gridAutoRows"}),eie=So({prop:"gridTemplateColumns"}),tie=So({prop:"gridTemplateRows"}),rie=So({prop:"gridTemplateAreas"}),nie=So({prop:"gridArea"});UT(jT,VT,HT,Yne,Zne,Xne,Qne,Jne,eie,tie,rie,nie);function Og(t,e){return e==="grey"?e:t}const iie=So({prop:"color",themeKey:"palette",transform:Og}),oie=So({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Og}),sie=So({prop:"backgroundColor",themeKey:"palette",transform:Og});UT(iie,oie,sie);function $a(t){return t<=1&&t!==0?`${t*100}%`:t}const aie=So({prop:"width",transform:$a}),nO=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var o,u;const d=((o=t.theme)==null||(o=o.breakpoints)==null||(o=o.values)==null?void 0:o[n])||JD[n];return d?((u=t.theme)==null||(u=u.breakpoints)==null?void 0:u.unit)!=="px"?{maxWidth:`${d}${t.theme.breakpoints.unit}`}:{maxWidth:d}:{maxWidth:$a(n)}};return Ec(t,t.maxWidth,e)}return null};nO.filterProps=["maxWidth"];const lie=So({prop:"minWidth",transform:$a}),cie=So({prop:"height",transform:$a}),uie=So({prop:"maxHeight",transform:$a}),hie=So({prop:"minHeight",transform:$a});So({prop:"size",cssProperty:"width",transform:$a});So({prop:"size",cssProperty:"height",transform:$a});const die=So({prop:"boxSizing"});UT(aie,nO,lie,cie,uie,hie,die);const U1={border:{themeKey:"borders",transform:El},borderTop:{themeKey:"borders",transform:El},borderRight:{themeKey:"borders",transform:El},borderBottom:{themeKey:"borders",transform:El},borderLeft:{themeKey:"borders",transform:El},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:El},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:$T},color:{themeKey:"palette",transform:Og},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Og},backgroundColor:{themeKey:"palette",transform:Og},p:{style:ho},pt:{style:ho},pr:{style:ho},pb:{style:ho},pl:{style:ho},px:{style:ho},py:{style:ho},padding:{style:ho},paddingTop:{style:ho},paddingRight:{style:ho},paddingBottom:{style:ho},paddingLeft:{style:ho},paddingX:{style:ho},paddingY:{style:ho},paddingInline:{style:ho},paddingInlineStart:{style:ho},paddingInlineEnd:{style:ho},paddingBlock:{style:ho},paddingBlockStart:{style:ho},paddingBlockEnd:{style:ho},m:{style:uo},mt:{style:uo},mr:{style:uo},mb:{style:uo},ml:{style:uo},mx:{style:uo},my:{style:uo},margin:{style:uo},marginTop:{style:uo},marginRight:{style:uo},marginBottom:{style:uo},marginLeft:{style:uo},marginX:{style:uo},marginY:{style:uo},marginInline:{style:uo},marginInlineStart:{style:uo},marginInlineEnd:{style:uo},marginBlock:{style:uo},marginBlockStart:{style:uo},marginBlockEnd:{style:uo},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:jT},rowGap:{style:HT},columnGap:{style:VT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:$a},maxWidth:{style:nO},minWidth:{transform:$a},height:{transform:$a},maxHeight:{transform:$a},minHeight:{transform:$a},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function fie(...t){const e=t.reduce((o,u)=>o.concat(Object.keys(u)),[]),n=new Set(e);return t.every(o=>n.size===Object.keys(o).length)}function pie(t,e){return typeof t=="function"?t(e):t}function aV(){function t(n,o,u,d){const _={[n]:o,theme:u},v=d[n];if(!v)return{[n]:o};const{cssProperty:a=n,themeKey:C,transform:A,style:k}=v;if(o==null)return null;if(C==="typography"&&o==="inherit")return{[n]:o};const O=NT(u,C)||{};return k?k(_):Ec(_,o,z=>{let N=cS(O,A,z);return z===N&&typeof z=="string"&&(N=cS(O,A,`${n}${z==="default"?"":qn(z)}`,z)),a===!1?N:{[a]:N}})}function e(n){var o;const{sx:u,theme:d={}}=n||{};if(!u)return null;const _=(o=d.unstable_sxConfig)!=null?o:U1;function v(a){let C=a;if(typeof a=="function")C=a(d);else if(typeof a!="object")return a;if(!C)return null;const A=iV(d.breakpoints),k=Object.keys(A);let O=A;return Object.keys(C).forEach(R=>{const z=pie(C[R],d);if(z!=null)if(typeof z=="object")if(_[R])O=Px(O,t(R,z,d,_));else{const N=Ec({theme:d},z,K=>({[R]:K}));fie(N,z)?O[R]=e({sx:z,theme:d}):O=Px(O,N)}else O=Px(O,t(R,z,d,_))}),oV(k,O)}return Array.isArray(u)?u.map(v):v(u)}return e}const I_=aV();I_.filterProps=["sx"];function lV(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const mie=["breakpoints","palette","spacing","shape"];function $1(t={},...e){const{breakpoints:n={},palette:o={},spacing:u,shape:d={}}=t,_=tn(t,mie),v=nV(n),a=Bne(u);let C=ta({breakpoints:v,direction:"ltr",components:{},palette:We({mode:"light"},o),spacing:a,shape:We({},Tne,d)},_);return C.applyStyles=lV,C=e.reduce((A,k)=>ta(A,k),C),C.unstable_sxConfig=We({},U1,_?.unstable_sxConfig),C.unstable_sx=function(k){return I_({sx:k,theme:this})},C}const gie=Object.freeze(Object.defineProperty({__proto__:null,default:$1,private_createBreakpoints:nV,unstable_applyStyles:lV},Symbol.toStringTag,{value:"Module"}));function _ie(t){return Object.keys(t).length===0}function iO(t=null){const e=fe.useContext(z1);return!e||_ie(e)?t:e}const yie=$1();function GT(t=yie){return iO(t)}function vie({styles:t,themeId:e,defaultTheme:n={}}){const o=GT(n),u=typeof t=="function"?t(e&&o[e]||o):t;return Ke.jsx(eV,{styles:u})}const xie=["sx"],bie=t=>{var e,n;const o={systemProps:{},otherProps:{}},u=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:U1;return Object.keys(t).forEach(d=>{u[d]?o.systemProps[d]=t[d]:o.otherProps[d]=t[d]}),o};function oO(t){const{sx:e}=t,n=tn(t,xie),{systemProps:o,otherProps:u}=bie(n);let d;return Array.isArray(e)?d=[o,...e]:typeof e=="function"?d=(..._)=>{const v=e(..._);return nh(v)?We({},o,v):o}:d=We({},o,e),We({},u,{sx:d})}const wie=Object.freeze(Object.defineProperty({__proto__:null,default:I_,extendSxProp:oO,unstable_createStyleFunctionSx:aV,unstable_defaultSxConfig:U1},Symbol.toStringTag,{value:"Module"})),IN=t=>t,Cie=()=>{let t=IN;return{configure(e){t=e},generate(e){return t(e)},reset(){t=IN}}},cV=Cie();function uV(t){var e,n,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(e=0;e<u;e++)t[e]&&(n=uV(t[e]))&&(o&&(o+=" "),o+=n)}else for(n in t)t[n]&&(o&&(o+=" "),o+=n);return o}function zn(){for(var t,e,n=0,o="",u=arguments.length;n<u;n++)(t=arguments[n])&&(e=uV(t))&&(o&&(o+=" "),o+=e);return o}const Eie=["className","component"];function Sie(t={}){const{themeId:e,defaultTheme:n,defaultClassName:o="MuiBox-root",generateClassName:u}=t,d=QD("div",{shouldForwardProp:v=>v!=="theme"&&v!=="sx"&&v!=="as"})(I_);return fe.forwardRef(function(a,C){const A=GT(n),k=oO(a),{className:O,component:R="div"}=k,z=tn(k,Eie);return Ke.jsx(d,We({as:R,ref:C,className:zn(O,u?u(o):o),theme:e&&A[e]||A},z))})}const Tie={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Ki(t,e,n="Mui"){const o=Tie[e];return o?`${n}-${o}`:`${cV.generate(t)}-${e}`}function Yi(t,e,n="Mui"){const o={};return e.forEach(u=>{o[u]=Ki(t,u,n)}),o}var hV={exports:{}},yi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sO=Symbol.for("react.element"),aO=Symbol.for("react.portal"),WT=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),KT=Symbol.for("react.profiler"),YT=Symbol.for("react.provider"),ZT=Symbol.for("react.context"),Aie=Symbol.for("react.server_context"),XT=Symbol.for("react.forward_ref"),QT=Symbol.for("react.suspense"),JT=Symbol.for("react.suspense_list"),eA=Symbol.for("react.memo"),tA=Symbol.for("react.lazy"),Iie=Symbol.for("react.offscreen"),dV;dV=Symbol.for("react.module.reference");function Fl(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case sO:switch(t=t.type,t){case WT:case KT:case qT:case QT:case JT:return t;default:switch(t=t&&t.$$typeof,t){case Aie:case ZT:case XT:case tA:case eA:case YT:return t;default:return e}}case aO:return e}}}yi.ContextConsumer=ZT;yi.ContextProvider=YT;yi.Element=sO;yi.ForwardRef=XT;yi.Fragment=WT;yi.Lazy=tA;yi.Memo=eA;yi.Portal=aO;yi.Profiler=KT;yi.StrictMode=qT;yi.Suspense=QT;yi.SuspenseList=JT;yi.isAsyncMode=function(){return!1};yi.isConcurrentMode=function(){return!1};yi.isContextConsumer=function(t){return Fl(t)===ZT};yi.isContextProvider=function(t){return Fl(t)===YT};yi.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===sO};yi.isForwardRef=function(t){return Fl(t)===XT};yi.isFragment=function(t){return Fl(t)===WT};yi.isLazy=function(t){return Fl(t)===tA};yi.isMemo=function(t){return Fl(t)===eA};yi.isPortal=function(t){return Fl(t)===aO};yi.isProfiler=function(t){return Fl(t)===KT};yi.isStrictMode=function(t){return Fl(t)===qT};yi.isSuspense=function(t){return Fl(t)===QT};yi.isSuspenseList=function(t){return Fl(t)===JT};yi.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===WT||t===KT||t===qT||t===QT||t===JT||t===Iie||typeof t=="object"&&t!==null&&(t.$$typeof===tA||t.$$typeof===eA||t.$$typeof===YT||t.$$typeof===ZT||t.$$typeof===XT||t.$$typeof===dV||t.getModuleId!==void 0)};yi.typeOf=Fl;hV.exports=yi;var MN=hV.exports;const Mie=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function fV(t){const e=`${t}`.match(Mie);return e&&e[1]||""}function pV(t,e=""){return t.displayName||t.name||fV(t)||e}function PN(t,e,n){const o=pV(e);return t.displayName||(o!==""?`${n}(${o})`:n)}function Pie(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return pV(t,"Component");if(typeof t=="object")switch(t.$$typeof){case MN.ForwardRef:return PN(t,t.render,"ForwardRef");case MN.Memo:return PN(t,t.type,"memo");default:return}}}const Rie=Object.freeze(Object.defineProperty({__proto__:null,default:Pie,getFunctionName:fV},Symbol.toStringTag,{value:"Module"})),kie=["ownerState"],Die=["variants"],Oie=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Lie(t){return Object.keys(t).length===0}function Bie(t){return typeof t=="string"&&t.charCodeAt(0)>96}function zM(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Fie=$1(),zie=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function wC({defaultTheme:t,theme:e,themeId:n}){return Lie(e)?t:e[n]||e}function Nie(t){return t?(e,n)=>n[t]:null}function dE(t,e){let{ownerState:n}=e,o=tn(e,kie);const u=typeof t=="function"?t(We({ownerState:n},o)):t;if(Array.isArray(u))return u.flatMap(d=>dE(d,We({ownerState:n},o)));if(u&&typeof u=="object"&&Array.isArray(u.variants)){const{variants:d=[]}=u;let v=tn(u,Die);return d.forEach(a=>{let C=!0;typeof a.props=="function"?C=a.props(We({ownerState:n},o,n)):Object.keys(a.props).forEach(A=>{n?.[A]!==a.props[A]&&o[A]!==a.props[A]&&(C=!1)}),C&&(Array.isArray(v)||(v=[v]),v.push(typeof a.style=="function"?a.style(We({ownerState:n},o,n)):a.style))}),v}return u}function Uie(t={}){const{themeId:e,defaultTheme:n=Fie,rootShouldForwardProp:o=zM,slotShouldForwardProp:u=zM}=t,d=_=>I_(We({},_,{theme:wC(We({},_,{defaultTheme:n,themeId:e}))}));return d.__mui_systemSx=!0,(_,v={})=>{tV(_,te=>te.filter(J=>!(J!=null&&J.__mui_systemSx)));const{name:a,slot:C,skipVariantsResolver:A,skipSx:k,overridesResolver:O=Nie(zie(C))}=v,R=tn(v,Oie),z=A!==void 0?A:C&&C!=="Root"&&C!=="root"||!1,N=k||!1;let K,q=zM;C==="Root"||C==="root"?q=o:C?q=u:Bie(_)&&(q=void 0);const j=QD(_,We({shouldForwardProp:q,label:K},R)),H=te=>typeof te=="function"&&te.__emotion_real!==te||nh(te)?J=>dE(te,We({},J,{theme:wC({theme:J.theme,defaultTheme:n,themeId:e})})):te,Y=(te,...J)=>{let ae=H(te);const de=J?J.map(H):[];a&&O&&de.push(Ae=>{const Ne=wC(We({},Ae,{defaultTheme:n,themeId:e}));if(!Ne.components||!Ne.components[a]||!Ne.components[a].styleOverrides)return null;const Re=Ne.components[a].styleOverrides,Ye={};return Object.entries(Re).forEach(([ht,ft])=>{Ye[ht]=dE(ft,We({},Ae,{theme:Ne}))}),O(Ae,Ye)}),a&&!z&&de.push(Ae=>{var Ne;const Re=wC(We({},Ae,{defaultTheme:n,themeId:e})),Ye=Re==null||(Ne=Re.components)==null||(Ne=Ne[a])==null?void 0:Ne.variants;return dE({variants:Ye},We({},Ae,{theme:Re}))}),N||de.push(d);const Me=de.length-J.length;if(Array.isArray(te)&&Me>0){const Ae=new Array(Me).fill("");ae=[...te,...Ae],ae.raw=[...te.raw,...Ae]}const Ce=j(ae,...de);return _.muiName&&(Ce.muiName=_.muiName),Ce};return j.withConfig&&(Y.withConfig=j.withConfig),Y}}const $ie=Uie();function h1(t,e){const n=We({},e);return Object.keys(t).forEach(o=>{if(o.toString().match(/^(components|slots)$/))n[o]=We({},t[o],n[o]);else if(o.toString().match(/^(componentsProps|slotProps)$/)){const u=t[o]||{},d=e[o];n[o]={},!d||!Object.keys(d)?n[o]=u:!u||!Object.keys(u)?n[o]=d:(n[o]=We({},d),Object.keys(u).forEach(_=>{n[o][_]=h1(u[_],d[_])}))}else n[o]===void 0&&(n[o]=t[o])}),n}function mV(t){const{theme:e,name:n,props:o}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?o:h1(e.components[n].defaultProps,o)}function jie({props:t,name:e,defaultTheme:n,themeId:o}){let u=GT(n);return o&&(u=u[o]||u),mV({theme:u,name:e,props:t})}const rf=typeof window<"u"?fe.useLayoutEffect:fe.useEffect;function Vie(t,e,n,o,u){const[d,_]=fe.useState(()=>u&&n?n(t).matches:o?o(t).matches:e);return rf(()=>{let v=!0;if(!n)return;const a=n(t),C=()=>{v&&_(a.matches)};return C(),a.addListener(C),()=>{v=!1,a.removeListener(C)}},[t,n]),d}const gV=fe.useSyncExternalStore;function Hie(t,e,n,o,u){const d=fe.useCallback(()=>e,[e]),_=fe.useMemo(()=>{if(u&&n)return()=>n(t).matches;if(o!==null){const{matches:A}=o(t);return()=>A}return d},[d,t,o,u,n]),[v,a]=fe.useMemo(()=>{if(n===null)return[d,()=>()=>{}];const A=n(t);return[()=>A.matches,k=>(A.addListener(k),()=>{A.removeListener(k)})]},[d,n,t]);return gV(a,v,_)}function Gie(t,e={}){const n=iO(),o=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:u=!1,matchMedia:d=o?window.matchMedia:null,ssrMatchMedia:_=null,noSsr:v=!1}=mV({name:"MuiUseMediaQuery",props:e,theme:n});let a=t;return a=a.replace(/^@media( ?)/m,""),(gV!==void 0?Hie:Vie)(a,u,d,_,v)}function Wie(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const qie=Object.freeze(Object.defineProperty({__proto__:null,default:Wie},Symbol.toStringTag,{value:"Module"}));function RN(...t){return t.reduce((e,n)=>n==null?e:function(...u){e.apply(this,u),n.apply(this,u)},()=>{})}function _V(t,e=166){let n;function o(...u){const d=()=>{t.apply(this,u)};clearTimeout(n),n=setTimeout(d,e)}return o.clear=()=>{clearTimeout(n)},o}function NM(t,e){var n,o;return fe.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(o=t.type)==null||(o=o._payload)==null||(o=o.value)==null?void 0:o.muiName)!==-1}function Za(t){return t&&t.ownerDocument||document}function am(t){return Za(t).defaultView||window}function Ek(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let kN=0;function Kie(t){const[e,n]=fe.useState(t),o=t||e;return fe.useEffect(()=>{e==null&&(kN+=1,n(`mui-${kN}`))},[e]),o}const DN=Hg.useId;function yV(t){if(DN!==void 0){const e=DN();return t??e}return Kie(t)}function ON({controlled:t,default:e,name:n,state:o="value"}){const{current:u}=fe.useRef(t!==void 0),[d,_]=fe.useState(e),v=u?t:d,a=fe.useCallback(C=>{u||_(C)},[]);return[v,a]}function yg(t){const e=fe.useRef(t);return rf(()=>{e.current=t}),fe.useRef((...n)=>(0,e.current)(...n)).current}function ra(...t){return fe.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Ek(n,e)})},t)}const LN={};function Yie(t,e){const n=fe.useRef(LN);return n.current===LN&&(n.current=t(e)),n}const Zie=[];function Xie(t){fe.useEffect(t,Zie)}class rA{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new rA}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function lO(){const t=Yie(rA.create).current;return Xie(t.disposeEffect),t}let nA=!0,Sk=!1;const Qie=new rA,Jie={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function eoe(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&Jie[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function toe(t){t.metaKey||t.altKey||t.ctrlKey||(nA=!0)}function UM(){nA=!1}function roe(){this.visibilityState==="hidden"&&Sk&&(nA=!0)}function noe(t){t.addEventListener("keydown",toe,!0),t.addEventListener("mousedown",UM,!0),t.addEventListener("pointerdown",UM,!0),t.addEventListener("touchstart",UM,!0),t.addEventListener("visibilitychange",roe,!0)}function ioe(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return nA||eoe(e)}function ooe(){const t=fe.useCallback(u=>{u!=null&&noe(u.ownerDocument)},[]),e=fe.useRef(!1);function n(){return e.current?(Sk=!0,Qie.start(100,()=>{Sk=!1}),e.current=!1,!0):!1}function o(u){return ioe(u)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:o,onBlur:n,ref:t}}function vV(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function ao(t,e,n=void 0){const o={};return Object.keys(t).forEach(u=>{o[u]=t[u].reduce((d,_)=>{if(_){const v=e(_);v!==""&&d.push(v),n&&n[_]&&d.push(n[_])}return d},[]).join(" ")}),o}const xV=fe.createContext(null);function bV(){return fe.useContext(xV)}const soe=typeof Symbol=="function"&&Symbol.for,aoe=soe?Symbol.for("mui.nested"):"__THEME_NESTED__";function loe(t,e){return typeof e=="function"?e(t):We({},t,e)}function coe(t){const{children:e,theme:n}=t,o=bV(),u=fe.useMemo(()=>{const d=o===null?n:loe(o,n);return d!=null&&(d[aoe]=o!==null),d},[n,o]);return Ke.jsx(xV.Provider,{value:u,children:e})}const uoe=["value"],wV=fe.createContext();function hoe(t){let{value:e}=t,n=tn(t,uoe);return Ke.jsx(wV.Provider,We({value:e??!0},n))}const doe=()=>{const t=fe.useContext(wV);return t??!1},CV=fe.createContext(void 0);function foe({value:t,children:e}){return Ke.jsx(CV.Provider,{value:t,children:e})}function poe(t){const{theme:e,name:n,props:o}=t;if(!e||!e.components||!e.components[n])return o;const u=e.components[n];return u.defaultProps?h1(u.defaultProps,o):!u.styleOverrides&&!u.variants?h1(u,o):o}function moe({props:t,name:e}){const n=fe.useContext(CV);return poe({props:t,name:e,theme:{components:n}})}const BN={};function FN(t,e,n,o=!1){return fe.useMemo(()=>{const u=t&&e[t]||e;if(typeof n=="function"){const d=n(u),_=t?We({},e,{[t]:d}):d;return o?()=>_:_}return t?We({},e,{[t]:n}):We({},e,n)},[t,e,n,o])}function goe(t){const{children:e,theme:n,themeId:o}=t,u=iO(BN),d=bV()||BN,_=FN(o,u,n),v=FN(o,d,n,!0),a=_.direction==="rtl";return Ke.jsx(coe,{theme:v,children:Ke.jsx(z1.Provider,{value:_,children:Ke.jsx(hoe,{value:a,children:Ke.jsx(foe,{value:_?.components,children:e})})})})}const _oe=["component","direction","spacing","divider","children","className","useFlexGap"],yoe=$1(),voe=$ie("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function xoe(t){return jie({props:t,name:"MuiStack",defaultTheme:yoe})}function boe(t,e){const n=fe.Children.toArray(t).filter(Boolean);return n.reduce((o,u,d)=>(o.push(u),d<n.length-1&&o.push(fe.cloneElement(e,{key:`separator-${d}`})),o),[])}const woe=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Coe=({ownerState:t,theme:e})=>{let n=We({display:"flex",flexDirection:"column"},Ec({theme:e},FM({values:t.direction,breakpoints:e.breakpoints.values}),o=>({flexDirection:o})));if(t.spacing){const o=rO(e),u=Object.keys(e.breakpoints.values).reduce((a,C)=>((typeof t.spacing=="object"&&t.spacing[C]!=null||typeof t.direction=="object"&&t.direction[C]!=null)&&(a[C]=!0),a),{}),d=FM({values:t.direction,base:u}),_=FM({values:t.spacing,base:u});typeof d=="object"&&Object.keys(d).forEach((a,C,A)=>{if(!d[a]){const O=C>0?d[A[C-1]]:"column";d[a]=O}}),n=ta(n,Ec({theme:e},_,(a,C)=>t.useFlexGap?{gap:sm(o,a)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${woe(C?d[C]:t.direction)}`]:sm(o,a)}}))}return n=Ane(e.breakpoints,n),n};function Eoe(t={}){const{createStyledComponent:e=voe,useThemeProps:n=xoe,componentName:o="MuiStack"}=t,u=()=>ao({root:["root"]},a=>Ki(o,a),{}),d=e(Coe);return fe.forwardRef(function(a,C){const A=n(a),k=oO(A),{component:O="div",direction:R="column",spacing:z=0,divider:N,children:K,className:q,useFlexGap:j=!1}=k,H=tn(k,_oe),Y={direction:R,spacing:z,useFlexGap:j},te=u();return Ke.jsx(d,We({as:O,ownerState:Y,ref:C,className:zn(te.root,q)},H,{children:N?boe(K,N):K}))})}function Soe(t,e){return We({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var To={},EV={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(EV);var SV=EV.exports;const Toe=wh(vre),Aoe=wh(qie);var TV=SV;Object.defineProperty(To,"__esModule",{value:!0});var vg=To.alpha=PV;To.blend=Uoe;To.colorChannel=void 0;var Ioe=To.darken=uO;To.decomposeColor=Ol;To.emphasize=RV;var Moe=To.getContrastRatio=Loe;To.getLuminance=uS;To.hexToRgb=AV;To.hslToRgb=MV;var Poe=To.lighten=hO;To.private_safeAlpha=Boe;To.private_safeColorChannel=void 0;To.private_safeDarken=Foe;To.private_safeEmphasize=Noe;To.private_safeLighten=zoe;To.recomposeColor=M_;To.rgbToHex=Ooe;var zN=TV(Toe),Roe=TV(Aoe);function cO(t,e=0,n=1){return(0,Roe.default)(t,e,n)}function AV(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(o=>o+o)),n?`rgb${n.length===4?"a":""}(${n.map((o,u)=>u<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function koe(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function Ol(t){if(t.type)return t;if(t.charAt(0)==="#")return Ol(AV(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,zN.default)(9,t));let o=t.substring(e+1,t.length-1),u;if(n==="color"){if(o=o.split(" "),u=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(u)===-1)throw new Error((0,zN.default)(10,u))}else o=o.split(",");return o=o.map(d=>parseFloat(d)),{type:n,values:o,colorSpace:u}}const IV=t=>{const e=Ol(t);return e.values.slice(0,3).map((n,o)=>e.type.indexOf("hsl")!==-1&&o!==0?`${n}%`:n).join(" ")};To.colorChannel=IV;const Doe=(t,e)=>{try{return IV(t)}catch{return t}};To.private_safeColorChannel=Doe;function M_(t){const{type:e,colorSpace:n}=t;let{values:o}=t;return e.indexOf("rgb")!==-1?o=o.map((u,d)=>d<3?parseInt(u,10):u):e.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),e.indexOf("color")!==-1?o=`${n} ${o.join(" ")}`:o=`${o.join(", ")}`,`${e}(${o})`}function Ooe(t){if(t.indexOf("#")===0)return t;const{values:e}=Ol(t);return`#${e.map((n,o)=>koe(o===3?Math.round(255*n):n)).join("")}`}function MV(t){t=Ol(t);const{values:e}=t,n=e[0],o=e[1]/100,u=e[2]/100,d=o*Math.min(u,1-u),_=(C,A=(C+n/30)%12)=>u-d*Math.max(Math.min(A-3,9-A,1),-1);let v="rgb";const a=[Math.round(_(0)*255),Math.round(_(8)*255),Math.round(_(4)*255)];return t.type==="hsla"&&(v+="a",a.push(e[3])),M_({type:v,values:a})}function uS(t){t=Ol(t);let e=t.type==="hsl"||t.type==="hsla"?Ol(MV(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Loe(t,e){const n=uS(t),o=uS(e);return(Math.max(n,o)+.05)/(Math.min(n,o)+.05)}function PV(t,e){return t=Ol(t),e=cO(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,M_(t)}function Boe(t,e,n){try{return PV(t,e)}catch{return t}}function uO(t,e){if(t=Ol(t),e=cO(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return M_(t)}function Foe(t,e,n){try{return uO(t,e)}catch{return t}}function hO(t,e){if(t=Ol(t),e=cO(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return M_(t)}function zoe(t,e,n){try{return hO(t,e)}catch{return t}}function RV(t,e=.15){return uS(t)>.5?uO(t,e):hO(t,e)}function Noe(t,e,n){try{return RV(t,e)}catch{return t}}function Uoe(t,e,n,o=1){const u=(a,C)=>Math.round((a**(1/o)*(1-n)+C**(1/o)*n)**o),d=Ol(t),_=Ol(e),v=[u(d.values[0],_.values[0]),u(d.values[1],_.values[1]),u(d.values[2],_.values[2])];return M_({type:"rgb",values:v})}const d1={black:"#000",white:"#fff"},$oe={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},$0={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},j0={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Hv={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},V0={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},H0={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},G0={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},joe=["mode","contrastThreshold","tonalOffset"],NN={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:d1.white,default:d1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},$M={text:{primary:d1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:d1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function UN(t,e,n,o){const u=o.light||o,d=o.dark||o*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=Poe(t.main,u):e==="dark"&&(t.dark=Ioe(t.main,d)))}function Voe(t="light"){return t==="dark"?{main:V0[200],light:V0[50],dark:V0[400]}:{main:V0[700],light:V0[400],dark:V0[800]}}function Hoe(t="light"){return t==="dark"?{main:$0[200],light:$0[50],dark:$0[400]}:{main:$0[500],light:$0[300],dark:$0[700]}}function Goe(t="light"){return t==="dark"?{main:j0[500],light:j0[300],dark:j0[700]}:{main:j0[700],light:j0[400],dark:j0[800]}}function Woe(t="light"){return t==="dark"?{main:H0[400],light:H0[300],dark:H0[700]}:{main:H0[700],light:H0[500],dark:H0[900]}}function qoe(t="light"){return t==="dark"?{main:G0[400],light:G0[300],dark:G0[700]}:{main:G0[800],light:G0[500],dark:G0[900]}}function Koe(t="light"){return t==="dark"?{main:Hv[400],light:Hv[300],dark:Hv[700]}:{main:"#ed6c02",light:Hv[500],dark:Hv[900]}}function Yoe(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:o=.2}=t,u=tn(t,joe),d=t.primary||Voe(e),_=t.secondary||Hoe(e),v=t.error||Goe(e),a=t.info||Woe(e),C=t.success||qoe(e),A=t.warning||Koe(e);function k(N){return Moe(N,$M.text.primary)>=n?$M.text.primary:NN.text.primary}const O=({color:N,name:K,mainShade:q=500,lightShade:j=300,darkShade:H=700})=>{if(N=We({},N),!N.main&&N[q]&&(N.main=N[q]),!N.hasOwnProperty("main"))throw new Error(om(11,K?` (${K})`:"",q));if(typeof N.main!="string")throw new Error(om(12,K?` (${K})`:"",JSON.stringify(N.main)));return UN(N,"light",j,o),UN(N,"dark",H,o),N.contrastText||(N.contrastText=k(N.main)),N},R={dark:$M,light:NN};return ta(We({common:We({},d1),mode:e,primary:O({color:d,name:"primary"}),secondary:O({color:_,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:O({color:v,name:"error"}),warning:O({color:A,name:"warning"}),info:O({color:a,name:"info"}),success:O({color:C,name:"success"}),grey:$oe,contrastThreshold:n,getContrastText:k,augmentColor:O,tonalOffset:o},R[e]),u)}const Zoe=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function Xoe(t){return Math.round(t*1e5)/1e5}const $N={textTransform:"uppercase"},jN='"Roboto", "Helvetica", "Arial", sans-serif';function Qoe(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:o=jN,fontSize:u=14,fontWeightLight:d=300,fontWeightRegular:_=400,fontWeightMedium:v=500,fontWeightBold:a=700,htmlFontSize:C=16,allVariants:A,pxToRem:k}=n,O=tn(n,Zoe),R=u/14,z=k||(q=>`${q/C*R}rem`),N=(q,j,H,Y,te)=>We({fontFamily:o,fontWeight:q,fontSize:z(j),lineHeight:H},o===jN?{letterSpacing:`${Xoe(Y/j)}em`}:{},te,A),K={h1:N(d,96,1.167,-1.5),h2:N(d,60,1.2,-.5),h3:N(_,48,1.167,0),h4:N(_,34,1.235,.25),h5:N(_,24,1.334,0),h6:N(v,20,1.6,.15),subtitle1:N(_,16,1.75,.15),subtitle2:N(v,14,1.57,.1),body1:N(_,16,1.5,.15),body2:N(_,14,1.43,.15),button:N(v,14,1.75,.4,$N),caption:N(_,12,1.66,.4),overline:N(_,12,2.66,1,$N),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ta(We({htmlFontSize:C,pxToRem:z,fontFamily:o,fontSize:u,fontWeightLight:d,fontWeightRegular:_,fontWeightMedium:v,fontWeightBold:a},K),O,{clone:!1})}const Joe=.2,ese=.14,tse=.12;function Hi(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Joe})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${ese})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${tse})`].join(",")}const rse=["none",Hi(0,2,1,-1,0,1,1,0,0,1,3,0),Hi(0,3,1,-2,0,2,2,0,0,1,5,0),Hi(0,3,3,-2,0,3,4,0,0,1,8,0),Hi(0,2,4,-1,0,4,5,0,0,1,10,0),Hi(0,3,5,-1,0,5,8,0,0,1,14,0),Hi(0,3,5,-1,0,6,10,0,0,1,18,0),Hi(0,4,5,-2,0,7,10,1,0,2,16,1),Hi(0,5,5,-3,0,8,10,1,0,3,14,2),Hi(0,5,6,-3,0,9,12,1,0,3,16,2),Hi(0,6,6,-3,0,10,14,1,0,4,18,3),Hi(0,6,7,-4,0,11,15,1,0,4,20,3),Hi(0,7,8,-4,0,12,17,2,0,5,22,4),Hi(0,7,8,-4,0,13,19,2,0,5,24,4),Hi(0,7,9,-4,0,14,21,2,0,5,26,4),Hi(0,8,9,-5,0,15,22,2,0,6,28,5),Hi(0,8,10,-5,0,16,24,2,0,6,30,5),Hi(0,8,11,-5,0,17,26,2,0,6,32,5),Hi(0,9,11,-5,0,18,28,2,0,7,34,6),Hi(0,9,12,-6,0,19,29,2,0,7,36,6),Hi(0,10,13,-6,0,20,31,3,0,8,38,7),Hi(0,10,13,-6,0,21,33,3,0,8,40,7),Hi(0,10,14,-6,0,22,35,3,0,8,42,7),Hi(0,11,14,-7,0,23,36,3,0,9,44,8),Hi(0,11,15,-7,0,24,38,3,0,9,46,8)],nse=["duration","easing","delay"],ise={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},kV={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function VN(t){return`${Math.round(t)}ms`}function ose(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function sse(t){const e=We({},ise,t.easing),n=We({},kV,t.duration);return We({getAutoHeightDuration:ose,create:(u=["all"],d={})=>{const{duration:_=n.standard,easing:v=e.easeInOut,delay:a=0}=d;return tn(d,nse),(Array.isArray(u)?u:[u]).map(C=>`${C} ${typeof _=="string"?_:VN(_)} ${v} ${typeof a=="string"?a:VN(a)}`).join(",")}},t,{easing:e,duration:n})}const ase={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},lse=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function iA(t={},...e){const{mixins:n={},palette:o={},transitions:u={},typography:d={}}=t,_=tn(t,lse);if(t.vars)throw new Error(om(18));const v=Yoe(o),a=$1(t);let C=ta(a,{mixins:Soe(a.breakpoints,n),palette:v,shadows:rse.slice(),typography:Qoe(v,d),transitions:sse(u),zIndex:We({},ase)});return C=ta(C,_),C=e.reduce((A,k)=>ta(A,k),C),C.unstable_sxConfig=We({},U1,_?.unstable_sxConfig),C.unstable_sx=function(k){return I_({sx:k,theme:this})},C}const dO=iA();function fO(){const t=GT(dO);return t[Qg]||t}var j1={},jM={exports:{}},HN;function cse(){return HN||(HN=1,function(t){function e(n,o){if(n==null)return{};var u={};for(var d in n)if({}.hasOwnProperty.call(n,d)){if(o.includes(d))continue;u[d]=n[d]}return u}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(jM)),jM.exports}const use=wh(wne),hse=wh(Cne),dse=wh(Mne),fse=wh(Rie),pse=wh(gie),mse=wh(wie);var P_=SV;Object.defineProperty(j1,"__esModule",{value:!0});var gse=j1.default=Mse;j1.shouldForwardProp=fE;j1.systemDefaultTheme=void 0;var xl=P_(Jj()),Tk=P_(cse()),GN=Cse(use),_se=hse;P_(dse);P_(fse);var yse=P_(pse),vse=P_(mse);const xse=["ownerState"],bse=["variants"],wse=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function DV(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(DV=function(o){return o?n:e})(t)}function Cse(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=DV(e);if(n&&n.has(t))return n.get(t);var o={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var _=u?Object.getOwnPropertyDescriptor(t,d):null;_&&(_.get||_.set)?Object.defineProperty(o,d,_):o[d]=t[d]}return o.default=t,n&&n.set(t,o),o}function Ese(t){return Object.keys(t).length===0}function Sse(t){return typeof t=="string"&&t.charCodeAt(0)>96}function fE(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Tse=j1.systemDefaultTheme=(0,yse.default)(),Ase=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function CC({defaultTheme:t,theme:e,themeId:n}){return Ese(e)?t:e[n]||e}function Ise(t){return t?(e,n)=>n[t]:null}function pE(t,e){let{ownerState:n}=e,o=(0,Tk.default)(e,xse);const u=typeof t=="function"?t((0,xl.default)({ownerState:n},o)):t;if(Array.isArray(u))return u.flatMap(d=>pE(d,(0,xl.default)({ownerState:n},o)));if(u&&typeof u=="object"&&Array.isArray(u.variants)){const{variants:d=[]}=u;let v=(0,Tk.default)(u,bse);return d.forEach(a=>{let C=!0;typeof a.props=="function"?C=a.props((0,xl.default)({ownerState:n},o,n)):Object.keys(a.props).forEach(A=>{n?.[A]!==a.props[A]&&o[A]!==a.props[A]&&(C=!1)}),C&&(Array.isArray(v)||(v=[v]),v.push(typeof a.style=="function"?a.style((0,xl.default)({ownerState:n},o,n)):a.style))}),v}return u}function Mse(t={}){const{themeId:e,defaultTheme:n=Tse,rootShouldForwardProp:o=fE,slotShouldForwardProp:u=fE}=t,d=_=>(0,vse.default)((0,xl.default)({},_,{theme:CC((0,xl.default)({},_,{defaultTheme:n,themeId:e}))}));return d.__mui_systemSx=!0,(_,v={})=>{(0,GN.internal_processStyles)(_,te=>te.filter(J=>!(J!=null&&J.__mui_systemSx)));const{name:a,slot:C,skipVariantsResolver:A,skipSx:k,overridesResolver:O=Ise(Ase(C))}=v,R=(0,Tk.default)(v,wse),z=A!==void 0?A:C&&C!=="Root"&&C!=="root"||!1,N=k||!1;let K,q=fE;C==="Root"||C==="root"?q=o:C?q=u:Sse(_)&&(q=void 0);const j=(0,GN.default)(_,(0,xl.default)({shouldForwardProp:q,label:K},R)),H=te=>typeof te=="function"&&te.__emotion_real!==te||(0,_se.isPlainObject)(te)?J=>pE(te,(0,xl.default)({},J,{theme:CC({theme:J.theme,defaultTheme:n,themeId:e})})):te,Y=(te,...J)=>{let ae=H(te);const de=J?J.map(H):[];a&&O&&de.push(Ae=>{const Ne=CC((0,xl.default)({},Ae,{defaultTheme:n,themeId:e}));if(!Ne.components||!Ne.components[a]||!Ne.components[a].styleOverrides)return null;const Re=Ne.components[a].styleOverrides,Ye={};return Object.entries(Re).forEach(([ht,ft])=>{Ye[ht]=pE(ft,(0,xl.default)({},Ae,{theme:Ne}))}),O(Ae,Ye)}),a&&!z&&de.push(Ae=>{var Ne;const Re=CC((0,xl.default)({},Ae,{defaultTheme:n,themeId:e})),Ye=Re==null||(Ne=Re.components)==null||(Ne=Ne[a])==null?void 0:Ne.variants;return pE({variants:Ye},(0,xl.default)({},Ae,{theme:Re}))}),N||de.push(d);const Me=de.length-J.length;if(Array.isArray(te)&&Me>0){const Ae=new Array(Me).fill("");ae=[...te,...Ae],ae.raw=[...te.raw,...Ae]}const Ce=j(ae,...de);return _.muiName&&(Ce.muiName=_.muiName),Ce};return j.withConfig&&(Y.withConfig=j.withConfig),Y}}function OV(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Tc=t=>OV(t)&&t!=="classes",Hr=gse({themeId:Qg,defaultTheme:dO,rootShouldForwardProp:Tc}),Pse=["theme"];function Rse(t){let{theme:e}=t,n=tn(t,Pse);const o=e[Qg];return Ke.jsx(goe,We({},n,{themeId:o?Qg:void 0,theme:o||e}))}const WN=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},qN="/wayfind_pwa/assets/GT-America-Standard-Regular-Trial-BT6uWkjE.woff2",kse="/wayfind_pwa/assets/GT-America-Standard-Medium-Trial-CWL3jY6u.woff2",Dse="/wayfind_pwa/assets/GT-America-Standard-Bold-Trial-BSxVjWS5.woff2",LV={typography:{button:{textTransform:"none"},fontFamily:["GTAmerica, Baskerville"].join(","),h4:{fontSize:"2.4rem"},h5:{fontSize:"1.85rem"},h6:{fontSize:"1.3rem"}},components:{MuiCssBaseline:{styleOverrides:`
             @font-face {
              font-family: 'GTAmerica';
              font-style: thin;
              font-display: swap;
              font-weight: 200;
              src: url(${qN}) format('woff2');
              unicodeRange: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF;
            }
            @font-face {
              font-family: 'GTAmerica';
              font-style: normal;
              font-display: swap;
              font-weight: 400;
              src: url(${qN}) format('woff2');
              unicodeRange: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF;
            }
            @font-face {
              font-family: 'GTAmerica';
              font-style: medium;
              font-display: swap;
              font-weight: 800;
              src: url(${kse}) format('woff2');
              unicodeRange: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF;
            }
                @font-face {
              font-family: 'GTAmerica';
              font-style: bold;
              font-display: swap;
              font-weight: 900;
              src: url(${Dse}) format('woff2');
              unicodeRange: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF;
            }
          `},MuiButton:{styleOverrides:{sizeSmall:{"&:focus,focusVisible":{outline:"none",borderWidth:"2px",borderColor:"inherit"}},sizeMedium:{fontSize:"1.25rem",padding:"10px 0px",minWidth:"48px",minHeight:"48px",borderRadius:"12px",borderWidth:"2px","&:focus,focusVisible":{outline:"none",borderWidth:"2px",borderColor:"inherit"}},sizeLarge:{fontSize:"1.35rem",borderRadius:"16px",minHeight:"60px","&:focus,focusVisible":{outline:"none",borderWidth:"2px",borderColor:"inherit"}}}}}},Ose={palette:{background:{paper:"#fff"},primary:{main:"#353535",contrastText:"white"},info:{main:"#ECECEC"},success:{main:"#7DFBC9"}}},Lse={palette:{background:{paper:"#ff0"},primary:{main:"#fff",contrastText:"#353535"}}},Bse=iA({...LV,...Ose});iA({...LV,...Lse});function Zi(t){return moe(t)}function Fse(t){return Ki("MuiSvgIcon",t)}Yi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const zse=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Nse=t=>{const{color:e,fontSize:n,classes:o}=t,u={root:["root",e!=="inherit"&&`color${qn(e)}`,`fontSize${qn(n)}`]};return ao(u,Fse,o)},Use=Hr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${qn(n.color)}`],e[`fontSize${qn(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,o,u,d,_,v,a,C,A,k,O,R,z;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(o=n.create)==null?void 0:o.call(n,"fill",{duration:(u=t.transitions)==null||(u=u.duration)==null?void 0:u.shorter}),fontSize:{inherit:"inherit",small:((d=t.typography)==null||(_=d.pxToRem)==null?void 0:_.call(d,20))||"1.25rem",medium:((v=t.typography)==null||(a=v.pxToRem)==null?void 0:a.call(v,24))||"1.5rem",large:((C=t.typography)==null||(A=C.pxToRem)==null?void 0:A.call(C,35))||"2.1875rem"}[e.fontSize],color:(k=(O=(t.vars||t).palette)==null||(O=O[e.color])==null?void 0:O.main)!=null?k:{action:(R=(t.vars||t).palette)==null||(R=R.action)==null?void 0:R.active,disabled:(z=(t.vars||t).palette)==null||(z=z.action)==null?void 0:z.disabled,inherit:void 0}[e.color]}}),Ak=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiSvgIcon"}),{children:u,className:d,color:_="inherit",component:v="svg",fontSize:a="medium",htmlColor:C,inheritViewBox:A=!1,titleAccess:k,viewBox:O="0 0 24 24"}=o,R=tn(o,zse),z=fe.isValidElement(u)&&u.type==="svg",N=We({},o,{color:_,component:v,fontSize:a,instanceFontSize:e.fontSize,inheritViewBox:A,viewBox:O,hasSvgAsChild:z}),K={};A||(K.viewBox=O);const q=Nse(N);return Ke.jsxs(Use,We({as:v,className:zn(q.root,d),focusable:"false",color:C,"aria-hidden":k?void 0:!0,role:k?"img":void 0,ref:n},K,R,z&&u.props,{ownerState:N,children:[z?u.props.children:u,k?Ke.jsx("title",{children:k}):null]}))});Ak.muiName="SvgIcon";function $se(t,e){function n(o,u){return Ke.jsx(Ak,We({"data-testid":`${e}Icon`,ref:u},o,{children:t}))}return n.muiName=Ak.muiName,fe.memo(fe.forwardRef(n))}var Ci={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pO=Symbol.for("react.element"),mO=Symbol.for("react.portal"),oA=Symbol.for("react.fragment"),sA=Symbol.for("react.strict_mode"),aA=Symbol.for("react.profiler"),lA=Symbol.for("react.provider"),cA=Symbol.for("react.context"),jse=Symbol.for("react.server_context"),uA=Symbol.for("react.forward_ref"),hA=Symbol.for("react.suspense"),dA=Symbol.for("react.suspense_list"),fA=Symbol.for("react.memo"),pA=Symbol.for("react.lazy"),Vse=Symbol.for("react.offscreen"),BV;BV=Symbol.for("react.module.reference");function zl(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case pO:switch(t=t.type,t){case oA:case aA:case sA:case hA:case dA:return t;default:switch(t=t&&t.$$typeof,t){case jse:case cA:case uA:case pA:case fA:case lA:return t;default:return e}}case mO:return e}}}Ci.ContextConsumer=cA;Ci.ContextProvider=lA;Ci.Element=pO;Ci.ForwardRef=uA;Ci.Fragment=oA;Ci.Lazy=pA;Ci.Memo=fA;Ci.Portal=mO;Ci.Profiler=aA;Ci.StrictMode=sA;Ci.Suspense=hA;Ci.SuspenseList=dA;Ci.isAsyncMode=function(){return!1};Ci.isConcurrentMode=function(){return!1};Ci.isContextConsumer=function(t){return zl(t)===cA};Ci.isContextProvider=function(t){return zl(t)===lA};Ci.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===pO};Ci.isForwardRef=function(t){return zl(t)===uA};Ci.isFragment=function(t){return zl(t)===oA};Ci.isLazy=function(t){return zl(t)===pA};Ci.isMemo=function(t){return zl(t)===fA};Ci.isPortal=function(t){return zl(t)===mO};Ci.isProfiler=function(t){return zl(t)===aA};Ci.isStrictMode=function(t){return zl(t)===sA};Ci.isSuspense=function(t){return zl(t)===hA};Ci.isSuspenseList=function(t){return zl(t)===dA};Ci.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===oA||t===aA||t===sA||t===hA||t===dA||t===Vse||typeof t=="object"&&t!==null&&(t.$$typeof===pA||t.$$typeof===fA||t.$$typeof===lA||t.$$typeof===cA||t.$$typeof===uA||t.$$typeof===BV||t.getModuleId!==void 0)};Ci.typeOf=zl;function Ik(t,e){return Ik=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ik(t,e)}function mA(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Ik(t,e)}function Hse(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function Gse(t,e){t.classList?t.classList.add(e):Hse(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function KN(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Wse(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=KN(t.className,e):t.setAttribute("class",KN(t.className&&t.className.baseVal||"",e))}const YN={disabled:!1},f1=wi.createContext(null);var FV=function(e){return e.scrollTop},lx="unmounted",Pp="exited",Sl="entering",tu="entered",p1="exiting",Nl=function(t){mA(e,t);function e(o,u){var d;d=t.call(this,o,u)||this;var _=u,v=_&&!_.isMounting?o.enter:o.appear,a;return d.appearStatus=null,o.in?v?(a=Pp,d.appearStatus=Sl):a=tu:o.unmountOnExit||o.mountOnEnter?a=lx:a=Pp,d.state={status:a},d.nextCallback=null,d}e.getDerivedStateFromProps=function(u,d){var _=u.in;return _&&d.status===lx?{status:Pp}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(u){var d=null;if(u!==this.props){var _=this.state.status;this.props.in?_!==Sl&&_!==tu&&(d=Sl):(_===Sl||_===tu)&&(d=p1)}this.updateStatus(!1,d)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var u=this.props.timeout,d,_,v;return d=_=v=u,u!=null&&typeof u!="number"&&(d=u.exit,_=u.enter,v=u.appear!==void 0?u.appear:_),{exit:d,enter:_,appear:v}},n.updateStatus=function(u,d){if(u===void 0&&(u=!1),d!==null)if(this.cancelNextCallback(),d===Sl){if(this.props.unmountOnExit||this.props.mountOnEnter){var _=this.props.nodeRef?this.props.nodeRef.current:ax.findDOMNode(this);_&&FV(_)}this.performEnter(u)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Pp&&this.setState({status:lx})},n.performEnter=function(u){var d=this,_=this.props.enter,v=this.context?this.context.isMounting:u,a=this.props.nodeRef?[v]:[ax.findDOMNode(this),v],C=a[0],A=a[1],k=this.getTimeouts(),O=v?k.appear:k.enter;if(!u&&!_||YN.disabled){this.safeSetState({status:tu},function(){d.props.onEntered(C)});return}this.props.onEnter(C,A),this.safeSetState({status:Sl},function(){d.props.onEntering(C,A),d.onTransitionEnd(O,function(){d.safeSetState({status:tu},function(){d.props.onEntered(C,A)})})})},n.performExit=function(){var u=this,d=this.props.exit,_=this.getTimeouts(),v=this.props.nodeRef?void 0:ax.findDOMNode(this);if(!d||YN.disabled){this.safeSetState({status:Pp},function(){u.props.onExited(v)});return}this.props.onExit(v),this.safeSetState({status:p1},function(){u.props.onExiting(v),u.onTransitionEnd(_.exit,function(){u.safeSetState({status:Pp},function(){u.props.onExited(v)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(u,d){d=this.setNextCallback(d),this.setState(u,d)},n.setNextCallback=function(u){var d=this,_=!0;return this.nextCallback=function(v){_&&(_=!1,d.nextCallback=null,u(v))},this.nextCallback.cancel=function(){_=!1},this.nextCallback},n.onTransitionEnd=function(u,d){this.setNextCallback(d);var _=this.props.nodeRef?this.props.nodeRef.current:ax.findDOMNode(this),v=u==null&&!this.props.addEndListener;if(!_||v){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[_,this.nextCallback],C=a[0],A=a[1];this.props.addEndListener(C,A)}u!=null&&setTimeout(this.nextCallback,u)},n.render=function(){var u=this.state.status;if(u===lx)return null;var d=this.props,_=d.children;d.in,d.mountOnEnter,d.unmountOnExit,d.appear,d.enter,d.exit,d.timeout,d.addEndListener,d.onEnter,d.onEntering,d.onEntered,d.onExit,d.onExiting,d.onExited,d.nodeRef;var v=tn(d,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return wi.createElement(f1.Provider,{value:null},typeof _=="function"?_(u,v):wi.cloneElement(wi.Children.only(_),v))},e}(wi.Component);Nl.contextType=f1;Nl.propTypes={};function W0(){}Nl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:W0,onEntering:W0,onEntered:W0,onExit:W0,onExiting:W0,onExited:W0};Nl.UNMOUNTED=lx;Nl.EXITED=Pp;Nl.ENTERING=Sl;Nl.ENTERED=tu;Nl.EXITING=p1;var qse=function(e,n){return e&&n&&n.split(" ").forEach(function(o){return Gse(e,o)})},VM=function(e,n){return e&&n&&n.split(" ").forEach(function(o){return Wse(e,o)})},gA=function(t){mA(e,t);function e(){for(var o,u=arguments.length,d=new Array(u),_=0;_<u;_++)d[_]=arguments[_];return o=t.call.apply(t,[this].concat(d))||this,o.appliedClasses={appear:{},enter:{},exit:{}},o.onEnter=function(v,a){var C=o.resolveArguments(v,a),A=C[0],k=C[1];o.removeClasses(A,"exit"),o.addClass(A,k?"appear":"enter","base"),o.props.onEnter&&o.props.onEnter(v,a)},o.onEntering=function(v,a){var C=o.resolveArguments(v,a),A=C[0],k=C[1],O=k?"appear":"enter";o.addClass(A,O,"active"),o.props.onEntering&&o.props.onEntering(v,a)},o.onEntered=function(v,a){var C=o.resolveArguments(v,a),A=C[0],k=C[1],O=k?"appear":"enter";o.removeClasses(A,O),o.addClass(A,O,"done"),o.props.onEntered&&o.props.onEntered(v,a)},o.onExit=function(v){var a=o.resolveArguments(v),C=a[0];o.removeClasses(C,"appear"),o.removeClasses(C,"enter"),o.addClass(C,"exit","base"),o.props.onExit&&o.props.onExit(v)},o.onExiting=function(v){var a=o.resolveArguments(v),C=a[0];o.addClass(C,"exit","active"),o.props.onExiting&&o.props.onExiting(v)},o.onExited=function(v){var a=o.resolveArguments(v),C=a[0];o.removeClasses(C,"exit"),o.addClass(C,"exit","done"),o.props.onExited&&o.props.onExited(v)},o.resolveArguments=function(v,a){return o.props.nodeRef?[o.props.nodeRef.current,v]:[v,a]},o.getClassNames=function(v){var a=o.props.classNames,C=typeof a=="string",A=C&&a?a+"-":"",k=C?""+A+v:a[v],O=C?k+"-active":a[v+"Active"],R=C?k+"-done":a[v+"Done"];return{baseClassName:k,activeClassName:O,doneClassName:R}},o}var n=e.prototype;return n.addClass=function(u,d,_){var v=this.getClassNames(d)[_+"ClassName"],a=this.getClassNames("enter"),C=a.doneClassName;d==="appear"&&_==="done"&&C&&(v+=" "+C),_==="active"&&u&&FV(u),v&&(this.appliedClasses[d][_]=v,qse(u,v))},n.removeClasses=function(u,d){var _=this.appliedClasses[d],v=_.base,a=_.active,C=_.done;this.appliedClasses[d]={},v&&VM(u,v),a&&VM(u,a),C&&VM(u,C)},n.render=function(){var u=this.props;u.classNames;var d=tn(u,["classNames"]);return wi.createElement(Nl,We({},d,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(wi.Component);gA.defaultProps={classNames:""};gA.propTypes={};function Kse(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gO(t,e){var n=function(d){return e&&fe.isValidElement(d)?e(d):d},o=Object.create(null);return t&&fe.Children.map(t,function(u){return u}).forEach(function(u){o[u.key]=n(u)}),o}function Yse(t,e){t=t||{},e=e||{};function n(A){return A in e?e[A]:t[A]}var o=Object.create(null),u=[];for(var d in t)d in e?u.length&&(o[d]=u,u=[]):u.push(d);var _,v={};for(var a in e){if(o[a])for(_=0;_<o[a].length;_++){var C=o[a][_];v[o[a][_]]=n(C)}v[a]=n(a)}for(_=0;_<u.length;_++)v[u[_]]=n(u[_]);return v}function zp(t,e,n){return n[e]!=null?n[e]:t.props[e]}function Zse(t,e){return gO(t.children,function(n){return fe.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:zp(n,"appear",t),enter:zp(n,"enter",t),exit:zp(n,"exit",t)})})}function Xse(t,e,n){var o=gO(t.children),u=Yse(e,o);return Object.keys(u).forEach(function(d){var _=u[d];if(fe.isValidElement(_)){var v=d in e,a=d in o,C=e[d],A=fe.isValidElement(C)&&!C.props.in;a&&(!v||A)?u[d]=fe.cloneElement(_,{onExited:n.bind(null,_),in:!0,exit:zp(_,"exit",t),enter:zp(_,"enter",t)}):!a&&v&&!A?u[d]=fe.cloneElement(_,{in:!1}):a&&v&&fe.isValidElement(C)&&(u[d]=fe.cloneElement(_,{onExited:n.bind(null,_),in:C.props.in,exit:zp(_,"exit",t),enter:zp(_,"enter",t)}))}}),u}var Qse=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Jse={component:"div",childFactory:function(e){return e}},_O=function(t){mA(e,t);function e(o,u){var d;d=t.call(this,o,u)||this;var _=d.handleExited.bind(Kse(d));return d.state={contextValue:{isMounting:!0},handleExited:_,firstRender:!0},d}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(u,d){var _=d.children,v=d.handleExited,a=d.firstRender;return{children:a?Zse(u,v):Xse(u,_,v),firstRender:!1}},n.handleExited=function(u,d){var _=gO(this.props.children);u.key in _||(u.props.onExited&&u.props.onExited(d),this.mounted&&this.setState(function(v){var a=We({},v.children);return delete a[u.key],{children:a}}))},n.render=function(){var u=this.props,d=u.component,_=u.childFactory,v=tn(u,["component","childFactory"]),a=this.state.contextValue,C=Qse(this.state.children).map(_);return delete v.appear,delete v.enter,delete v.exit,d===null?wi.createElement(f1.Provider,{value:a},C):wi.createElement(f1.Provider,{value:a},wi.createElement(d,v,C))},e}(wi.Component);_O.propTypes={};_O.defaultProps=Jse;var EC,SC;function eae(t,e){return!(t===e||wi.isValidElement(t)&&wi.isValidElement(e)&&t.key!=null&&t.key===e.key)}var e_={out:"out-in",in:"in-out"},hS=function(e,n,o){return function(){var u;e.props[n]&&(u=e.props)[n].apply(u,arguments),o()}},tae=(EC={},EC[e_.out]=function(t){var e=t.current,n=t.changeState;return wi.cloneElement(e,{in:!1,onExited:hS(e,"onExited",function(){n(Sl,null)})})},EC[e_.in]=function(t){var e=t.current,n=t.changeState,o=t.children;return[e,wi.cloneElement(o,{in:!0,onEntered:hS(o,"onEntered",function(){n(Sl)})})]},EC),rae=(SC={},SC[e_.out]=function(t){var e=t.children,n=t.changeState;return wi.cloneElement(e,{in:!0,onEntered:hS(e,"onEntered",function(){n(tu,wi.cloneElement(e,{in:!0}))})})},SC[e_.in]=function(t){var e=t.current,n=t.children,o=t.changeState;return[wi.cloneElement(e,{in:!1,onExited:hS(e,"onExited",function(){o(tu,wi.cloneElement(n,{in:!0}))})}),wi.cloneElement(n,{in:!0})]},SC),_A=function(t){mA(e,t);function e(){for(var o,u=arguments.length,d=new Array(u),_=0;_<u;_++)d[_]=arguments[_];return o=t.call.apply(t,[this].concat(d))||this,o.state={status:tu,current:null},o.appeared=!1,o.changeState=function(v,a){a===void 0&&(a=o.state.current),o.setState({status:v,current:a})},o}var n=e.prototype;return n.componentDidMount=function(){this.appeared=!0},e.getDerivedStateFromProps=function(u,d){return u.children==null?{current:null}:d.status===Sl&&u.mode===e_.in?{status:Sl}:d.current&&eae(d.current,u.children)?{status:p1}:{current:wi.cloneElement(u.children,{in:!0})}},n.render=function(){var u=this.props,d=u.children,_=u.mode,v=this.state,a=v.status,C=v.current,A={children:d,current:C,changeState:this.changeState,status:a},k;switch(a){case Sl:k=rae[_](A);break;case p1:k=tae[_](A);break;case tu:k=C}return wi.createElement(f1.Provider,{value:{isMounting:!this.appeared}},k)},e}(wi.Component);_A.propTypes={};_A.defaultProps={mode:e_.out};const zV=t=>t.scrollTop;function t_(t,e){var n,o;const{timeout:u,easing:d,style:_={}}=t;return{duration:(n=_.transitionDuration)!=null?n:typeof u=="number"?u:u[e.mode]||0,easing:(o=_.transitionTimingFunction)!=null?o:typeof d=="object"?d[e.mode]:d,delay:_.transitionDelay}}function nae(t){return Ki("MuiCollapse",t)}Yi("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const iae=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],oae=t=>{const{orientation:e,classes:n}=t,o={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return ao(o,nae,n)},sae=Hr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.state==="entered"&&e.entered,n.state==="exited"&&!n.in&&n.collapsedSize==="0px"&&e.hidden]}})(({theme:t,ownerState:e})=>We({height:0,overflow:"hidden",transition:t.transitions.create("height")},e.orientation==="horizontal"&&{height:"auto",width:0,transition:t.transitions.create("width")},e.state==="entered"&&We({height:"auto",overflow:"visible"},e.orientation==="horizontal"&&{width:"auto"}),e.state==="exited"&&!e.in&&e.collapsedSize==="0px"&&{visibility:"hidden"})),aae=Hr("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(t,e)=>e.wrapper})(({ownerState:t})=>We({display:"flex",width:"100%"},t.orientation==="horizontal"&&{width:"auto",height:"100%"})),lae=Hr("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(t,e)=>e.wrapperInner})(({ownerState:t})=>We({width:"100%"},t.orientation==="horizontal"&&{width:"auto",height:"100%"})),NV=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiCollapse"}),{addEndListener:u,children:d,className:_,collapsedSize:v="0px",component:a,easing:C,in:A,onEnter:k,onEntered:O,onEntering:R,onExit:z,onExited:N,onExiting:K,orientation:q="vertical",style:j,timeout:H=kV.standard,TransitionComponent:Y=Nl}=o,te=tn(o,iae),J=We({},o,{orientation:q,collapsedSize:v}),ae=oae(J),de=fO(),Me=lO(),Ce=fe.useRef(null),Ae=fe.useRef(),Ne=typeof v=="number"?`${v}px`:v,Re=q==="horizontal",Ye=Re?"width":"height",ht=fe.useRef(null),ft=ra(n,ht),et=$t=>Lr=>{if($t){const rr=ht.current;Lr===void 0?$t(rr):$t(rr,Lr)}},Xe=()=>Ce.current?Ce.current[Re?"clientWidth":"clientHeight"]:0,Mt=et(($t,Lr)=>{Ce.current&&Re&&(Ce.current.style.position="absolute"),$t.style[Ye]=Ne,k&&k($t,Lr)}),Lt=et(($t,Lr)=>{const rr=Xe();Ce.current&&Re&&(Ce.current.style.position="");const{duration:Zt,easing:dn}=t_({style:j,timeout:H,easing:C},{mode:"enter"});if(H==="auto"){const dr=de.transitions.getAutoHeightDuration(rr);$t.style.transitionDuration=`${dr}ms`,Ae.current=dr}else $t.style.transitionDuration=typeof Zt=="string"?Zt:`${Zt}ms`;$t.style[Ye]=`${rr}px`,$t.style.transitionTimingFunction=dn,R&&R($t,Lr)}),nt=et(($t,Lr)=>{$t.style[Ye]="auto",O&&O($t,Lr)}),at=et($t=>{$t.style[Ye]=`${Xe()}px`,z&&z($t)}),it=et(N),tt=et($t=>{const Lr=Xe(),{duration:rr,easing:Zt}=t_({style:j,timeout:H,easing:C},{mode:"exit"});if(H==="auto"){const dn=de.transitions.getAutoHeightDuration(Lr);$t.style.transitionDuration=`${dn}ms`,Ae.current=dn}else $t.style.transitionDuration=typeof rr=="string"?rr:`${rr}ms`;$t.style[Ye]=Ne,$t.style.transitionTimingFunction=Zt,K&&K($t)}),Jt=$t=>{H==="auto"&&Me.start(Ae.current||0,$t),u&&u(ht.current,$t)};return Ke.jsx(Y,We({in:A,onEnter:Mt,onEntered:nt,onEntering:Lt,onExit:at,onExited:it,onExiting:tt,addEndListener:Jt,nodeRef:ht,timeout:H==="auto"?null:H},te,{children:($t,Lr)=>Ke.jsx(sae,We({as:a,className:zn(ae.root,_,{entered:ae.entered,exited:!A&&Ne==="0px"&&ae.hidden}[$t]),style:We({[Re?"minWidth":"minHeight"]:Ne},j),ref:ft},Lr,{ownerState:We({},J,{state:$t}),children:Ke.jsx(aae,{ownerState:We({},J,{state:$t}),className:ae.wrapper,ref:Ce,children:Ke.jsx(lae,{ownerState:We({},J,{state:$t}),className:ae.wrapperInner,children:d})})}))}))});NV.muiSupportAuto=!0;function cae(t){return Ki("MuiPaper",t)}Yi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const uae=["className","component","elevation","square","variant"],hae=t=>{const{square:e,elevation:n,variant:o,classes:u}=t,d={root:["root",o,!e&&"rounded",o==="elevation"&&`elevation${n}`]};return ao(d,cae,u)},dae=Hr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return We({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&We({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${vg("#fff",WN(e.elevation))}, ${vg("#fff",WN(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),fae=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiPaper"}),{className:u,component:d="div",elevation:_=1,square:v=!1,variant:a="elevation"}=o,C=tn(o,uae),A=We({},o,{component:d,elevation:_,square:v,variant:a}),k=hae(A);return Ke.jsx(dae,We({as:d,ownerState:A,className:zn(k.root,u),ref:n},C))});function dS(t){return typeof t=="string"}function pae(t,e,n){return t===void 0||dS(t)?e:We({},e,{ownerState:We({},e.ownerState,n)})}function UV(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(o=>o.match(/^on[A-Z]/)&&typeof t[o]=="function"&&!e.includes(o)).forEach(o=>{n[o]=t[o]}),n}function mae(t,e,n){return typeof t=="function"?t(e,n):t}function ZN(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function gae(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:o,externalForwardedProps:u,className:d}=t;if(!e){const R=zn(n?.className,d,u?.className,o?.className),z=We({},n?.style,u?.style,o?.style),N=We({},n,u,o);return R.length>0&&(N.className=R),Object.keys(z).length>0&&(N.style=z),{props:N,internalRef:void 0}}const _=UV(We({},u,o)),v=ZN(o),a=ZN(u),C=e(_),A=zn(C?.className,n?.className,d,u?.className,o?.className),k=We({},C?.style,n?.style,u?.style,o?.style),O=We({},C,n,a,v);return A.length>0&&(O.className=A),Object.keys(k).length>0&&(O.style=k),{props:O,internalRef:C.ref}}const _ae=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function r_(t){var e;const{elementType:n,externalSlotProps:o,ownerState:u,skipResolvingSlotProps:d=!1}=t,_=tn(t,_ae),v=d?{}:mae(o,u),{props:a,internalRef:C}=gae(We({},_,{externalSlotProps:v})),A=ra(C,v?.ref,(e=t.additionalProps)==null?void 0:e.ref);return pae(n,We({},a,{ref:A}),u)}function yae(t){const{className:e,classes:n,pulsate:o=!1,rippleX:u,rippleY:d,rippleSize:_,in:v,onExited:a,timeout:C}=t,[A,k]=fe.useState(!1),O=zn(e,n.ripple,n.rippleVisible,o&&n.ripplePulsate),R={width:_,height:_,top:-(_/2)+d,left:-(_/2)+u},z=zn(n.child,A&&n.childLeaving,o&&n.childPulsate);return!v&&!A&&k(!0),fe.useEffect(()=>{if(!v&&a!=null){const N=setTimeout(a,C);return()=>{clearTimeout(N)}}},[a,v,C]),Ke.jsx("span",{className:O,style:R,children:Ke.jsx("span",{className:z})})}const bl=Yi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),vae=["center","classes","className"];let yA=t=>t,XN,QN,JN,e8;const Mk=550,xae=80,bae=A_(XN||(XN=yA`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),wae=A_(QN||(QN=yA`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Cae=A_(JN||(JN=yA`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Eae=Hr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Sae=Hr(yae,{name:"MuiTouchRipple",slot:"Ripple"})(e8||(e8=yA`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),bl.rippleVisible,bae,Mk,({theme:t})=>t.transitions.easing.easeInOut,bl.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,bl.child,bl.childLeaving,wae,Mk,({theme:t})=>t.transitions.easing.easeInOut,bl.childPulsate,Cae,({theme:t})=>t.transitions.easing.easeInOut),Tae=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiTouchRipple"}),{center:u=!1,classes:d={},className:_}=o,v=tn(o,vae),[a,C]=fe.useState([]),A=fe.useRef(0),k=fe.useRef(null);fe.useEffect(()=>{k.current&&(k.current(),k.current=null)},[a]);const O=fe.useRef(!1),R=lO(),z=fe.useRef(null),N=fe.useRef(null),K=fe.useCallback(Y=>{const{pulsate:te,rippleX:J,rippleY:ae,rippleSize:de,cb:Me}=Y;C(Ce=>[...Ce,Ke.jsx(Sae,{classes:{ripple:zn(d.ripple,bl.ripple),rippleVisible:zn(d.rippleVisible,bl.rippleVisible),ripplePulsate:zn(d.ripplePulsate,bl.ripplePulsate),child:zn(d.child,bl.child),childLeaving:zn(d.childLeaving,bl.childLeaving),childPulsate:zn(d.childPulsate,bl.childPulsate)},timeout:Mk,pulsate:te,rippleX:J,rippleY:ae,rippleSize:de},A.current)]),A.current+=1,k.current=Me},[d]),q=fe.useCallback((Y={},te={},J=()=>{})=>{const{pulsate:ae=!1,center:de=u||te.pulsate,fakeElement:Me=!1}=te;if(Y?.type==="mousedown"&&O.current){O.current=!1;return}Y?.type==="touchstart"&&(O.current=!0);const Ce=Me?null:N.current,Ae=Ce?Ce.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ne,Re,Ye;if(de||Y===void 0||Y.clientX===0&&Y.clientY===0||!Y.clientX&&!Y.touches)Ne=Math.round(Ae.width/2),Re=Math.round(Ae.height/2);else{const{clientX:ht,clientY:ft}=Y.touches&&Y.touches.length>0?Y.touches[0]:Y;Ne=Math.round(ht-Ae.left),Re=Math.round(ft-Ae.top)}if(de)Ye=Math.sqrt((2*Ae.width**2+Ae.height**2)/3),Ye%2===0&&(Ye+=1);else{const ht=Math.max(Math.abs((Ce?Ce.clientWidth:0)-Ne),Ne)*2+2,ft=Math.max(Math.abs((Ce?Ce.clientHeight:0)-Re),Re)*2+2;Ye=Math.sqrt(ht**2+ft**2)}Y!=null&&Y.touches?z.current===null&&(z.current=()=>{K({pulsate:ae,rippleX:Ne,rippleY:Re,rippleSize:Ye,cb:J})},R.start(xae,()=>{z.current&&(z.current(),z.current=null)})):K({pulsate:ae,rippleX:Ne,rippleY:Re,rippleSize:Ye,cb:J})},[u,K,R]),j=fe.useCallback(()=>{q({},{pulsate:!0})},[q]),H=fe.useCallback((Y,te)=>{if(R.clear(),Y?.type==="touchend"&&z.current){z.current(),z.current=null,R.start(0,()=>{H(Y,te)});return}z.current=null,C(J=>J.length>0?J.slice(1):J),k.current=te},[R]);return fe.useImperativeHandle(n,()=>({pulsate:j,start:q,stop:H}),[j,q,H]),Ke.jsx(Eae,We({className:zn(bl.root,d.root,_),ref:N},v,{children:Ke.jsx(_O,{component:null,exit:!0,children:a})}))});function Aae(t){return Ki("MuiButtonBase",t)}const Iae=Yi("MuiButtonBase",["root","disabled","focusVisible"]),Mae=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],Pae=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:o,classes:u}=t,_=ao({root:["root",e&&"disabled",n&&"focusVisible"]},Aae,u);return n&&o&&(_.root+=` ${o}`),_},Rae=Hr("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Iae.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),kae=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiButtonBase"}),{action:u,centerRipple:d=!1,children:_,className:v,component:a="button",disabled:C=!1,disableRipple:A=!1,disableTouchRipple:k=!1,focusRipple:O=!1,LinkComponent:R="a",onBlur:z,onClick:N,onContextMenu:K,onDragLeave:q,onFocus:j,onFocusVisible:H,onKeyDown:Y,onKeyUp:te,onMouseDown:J,onMouseLeave:ae,onMouseUp:de,onTouchEnd:Me,onTouchMove:Ce,onTouchStart:Ae,tabIndex:Ne=0,TouchRippleProps:Re,touchRippleRef:Ye,type:ht}=o,ft=tn(o,Mae),et=fe.useRef(null),Xe=fe.useRef(null),Mt=ra(Xe,Ye),{isFocusVisibleRef:Lt,onFocus:nt,onBlur:at,ref:it}=ooe(),[tt,Jt]=fe.useState(!1);C&&tt&&Jt(!1),fe.useImperativeHandle(u,()=>({focusVisible:()=>{Jt(!0),et.current.focus()}}),[]);const[$t,Lr]=fe.useState(!1);fe.useEffect(()=>{Lr(!0)},[]);const rr=$t&&!A&&!C;fe.useEffect(()=>{tt&&O&&!A&&$t&&Xe.current.pulsate()},[A,O,tt,$t]);function Zt(yr,xi,Ei=k){return yg($i=>(xi&&xi($i),!Ei&&Xe.current&&Xe.current[yr]($i),!0))}const dn=Zt("start",J),dr=Zt("stop",K),Ur=Zt("stop",q),Tr=Zt("stop",de),wr=Zt("stop",yr=>{tt&&yr.preventDefault(),ae&&ae(yr)}),Er=Zt("start",Ae),Zn=Zt("stop",Me),fn=Zt("stop",Ce),pn=Zt("stop",yr=>{at(yr),Lt.current===!1&&Jt(!1),z&&z(yr)},!1),li=yg(yr=>{et.current||(et.current=yr.currentTarget),nt(yr),Lt.current===!0&&(Jt(!0),H&&H(yr)),j&&j(yr)}),or=()=>{const yr=et.current;return a&&a!=="button"&&!(yr.tagName==="A"&&yr.href)},Yt=fe.useRef(!1),un=yg(yr=>{O&&!Yt.current&&tt&&Xe.current&&yr.key===" "&&(Yt.current=!0,Xe.current.stop(yr,()=>{Xe.current.start(yr)})),yr.target===yr.currentTarget&&or()&&yr.key===" "&&yr.preventDefault(),Y&&Y(yr),yr.target===yr.currentTarget&&or()&&yr.key==="Enter"&&!C&&(yr.preventDefault(),N&&N(yr))}),_n=yg(yr=>{O&&yr.key===" "&&Xe.current&&tt&&!yr.defaultPrevented&&(Yt.current=!1,Xe.current.stop(yr,()=>{Xe.current.pulsate(yr)})),te&&te(yr),N&&yr.target===yr.currentTarget&&or()&&yr.key===" "&&!yr.defaultPrevented&&N(yr)});let rn=a;rn==="button"&&(ft.href||ft.to)&&(rn=R);const ri={};rn==="button"?(ri.type=ht===void 0?"button":ht,ri.disabled=C):(!ft.href&&!ft.to&&(ri.role="button"),C&&(ri["aria-disabled"]=C));const Ln=ra(n,it,et),Vn=We({},o,{centerRipple:d,component:a,disabled:C,disableRipple:A,disableTouchRipple:k,focusRipple:O,tabIndex:Ne,focusVisible:tt}),Xr=Pae(Vn);return Ke.jsxs(Rae,We({as:rn,className:zn(Xr.root,v),ownerState:Vn,onBlur:pn,onClick:N,onContextMenu:dr,onFocus:li,onKeyDown:un,onKeyUp:_n,onMouseDown:dn,onMouseLeave:wr,onMouseUp:Tr,onDragLeave:Ur,onTouchEnd:Zn,onTouchMove:fn,onTouchStart:Er,ref:Ln,tabIndex:C?-1:Ne,type:ht},ri,ft,{children:[_,rr?Ke.jsx(Tae,We({ref:Mt,center:d},Re)):null]}))}),Dae=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Oae(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Lae(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=o=>t.ownerDocument.querySelector(`input[type="radio"]${o}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function Bae(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Lae(t))}function Fae(t){const e=[],n=[];return Array.from(t.querySelectorAll(Dae)).forEach((o,u)=>{const d=Oae(o);d===-1||!Bae(o)||(d===0?e.push(o):n.push({documentOrder:u,tabIndex:d,node:o}))}),n.sort((o,u)=>o.tabIndex===u.tabIndex?o.documentOrder-u.documentOrder:o.tabIndex-u.tabIndex).map(o=>o.node).concat(e)}function zae(){return!0}function Nae(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:o=!1,disableRestoreFocus:u=!1,getTabbable:d=Fae,isEnabled:_=zae,open:v}=t,a=fe.useRef(!1),C=fe.useRef(null),A=fe.useRef(null),k=fe.useRef(null),O=fe.useRef(null),R=fe.useRef(!1),z=fe.useRef(null),N=ra(e.ref,z),K=fe.useRef(null);fe.useEffect(()=>{!v||!z.current||(R.current=!n)},[n,v]),fe.useEffect(()=>{if(!v||!z.current)return;const H=Za(z.current);return z.current.contains(H.activeElement)||(z.current.hasAttribute("tabIndex")||z.current.setAttribute("tabIndex","-1"),R.current&&z.current.focus()),()=>{u||(k.current&&k.current.focus&&(a.current=!0,k.current.focus()),k.current=null)}},[v]),fe.useEffect(()=>{if(!v||!z.current)return;const H=Za(z.current),Y=ae=>{K.current=ae,!(o||!_()||ae.key!=="Tab")&&H.activeElement===z.current&&ae.shiftKey&&(a.current=!0,A.current&&A.current.focus())},te=()=>{const ae=z.current;if(ae===null)return;if(!H.hasFocus()||!_()||a.current){a.current=!1;return}if(ae.contains(H.activeElement)||o&&H.activeElement!==C.current&&H.activeElement!==A.current)return;if(H.activeElement!==O.current)O.current=null;else if(O.current!==null)return;if(!R.current)return;let de=[];if((H.activeElement===C.current||H.activeElement===A.current)&&(de=d(z.current)),de.length>0){var Me,Ce;const Ae=!!((Me=K.current)!=null&&Me.shiftKey&&((Ce=K.current)==null?void 0:Ce.key)==="Tab"),Ne=de[0],Re=de[de.length-1];typeof Ne!="string"&&typeof Re!="string"&&(Ae?Re.focus():Ne.focus())}else ae.focus()};H.addEventListener("focusin",te),H.addEventListener("keydown",Y,!0);const J=setInterval(()=>{H.activeElement&&H.activeElement.tagName==="BODY"&&te()},50);return()=>{clearInterval(J),H.removeEventListener("focusin",te),H.removeEventListener("keydown",Y,!0)}},[n,o,u,_,v,d]);const q=H=>{k.current===null&&(k.current=H.relatedTarget),R.current=!0,O.current=H.target;const Y=e.props.onFocus;Y&&Y(H)},j=H=>{k.current===null&&(k.current=H.relatedTarget),R.current=!0};return Ke.jsxs(fe.Fragment,{children:[Ke.jsx("div",{tabIndex:v?0:-1,onFocus:j,ref:C,"data-testid":"sentinelStart"}),fe.cloneElement(e,{ref:N,onFocus:q}),Ke.jsx("div",{tabIndex:v?0:-1,onFocus:j,ref:A,"data-testid":"sentinelEnd"})]})}function Uae(t){return typeof t=="function"?t():t}const $ae=fe.forwardRef(function(e,n){const{children:o,container:u,disablePortal:d=!1}=e,[_,v]=fe.useState(null),a=ra(fe.isValidElement(o)?o.ref:null,n);if(rf(()=>{d||v(Uae(u)||document.body)},[u,d]),rf(()=>{if(_&&!d)return Ek(n,_),()=>{Ek(n,null)}},[n,_,d]),d){if(fe.isValidElement(o)){const C={ref:a};return fe.cloneElement(o,C)}return Ke.jsx(fe.Fragment,{children:o})}return Ke.jsx(fe.Fragment,{children:_&&ET.createPortal(o,_)})});function jae(t){const e=Za(t);return e.body===t?am(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Rx(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function t8(t){return parseInt(am(t).getComputedStyle(t).paddingRight,10)||0}function Vae(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,o=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||o}function r8(t,e,n,o,u){const d=[e,n,...o];[].forEach.call(t.children,_=>{const v=d.indexOf(_)===-1,a=!Vae(_);v&&a&&Rx(_,u)})}function HM(t,e){let n=-1;return t.some((o,u)=>e(o)?(n=u,!0):!1),n}function Hae(t,e){const n=[],o=t.container;if(!e.disableScrollLock){if(jae(o)){const _=vV(Za(o));n.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight=`${t8(o)+_}px`;const v=Za(o).querySelectorAll(".mui-fixed");[].forEach.call(v,a=>{n.push({value:a.style.paddingRight,property:"padding-right",el:a}),a.style.paddingRight=`${t8(a)+_}px`})}let d;if(o.parentNode instanceof DocumentFragment)d=Za(o).body;else{const _=o.parentElement,v=am(o);d=_?.nodeName==="HTML"&&v.getComputedStyle(_).overflowY==="scroll"?_:o}n.push({value:d.style.overflow,property:"overflow",el:d},{value:d.style.overflowX,property:"overflow-x",el:d},{value:d.style.overflowY,property:"overflow-y",el:d}),d.style.overflow="hidden"}return()=>{n.forEach(({value:d,el:_,property:v})=>{d?_.style.setProperty(v,d):_.style.removeProperty(v)})}}function Gae(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class Wae{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let o=this.modals.indexOf(e);if(o!==-1)return o;o=this.modals.length,this.modals.push(e),e.modalRef&&Rx(e.modalRef,!1);const u=Gae(n);r8(n,e.mount,e.modalRef,u,!0);const d=HM(this.containers,_=>_.container===n);return d!==-1?(this.containers[d].modals.push(e),o):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:u}),o)}mount(e,n){const o=HM(this.containers,d=>d.modals.indexOf(e)!==-1),u=this.containers[o];u.restore||(u.restore=Hae(u,n))}remove(e,n=!0){const o=this.modals.indexOf(e);if(o===-1)return o;const u=HM(this.containers,_=>_.modals.indexOf(e)!==-1),d=this.containers[u];if(d.modals.splice(d.modals.indexOf(e),1),this.modals.splice(o,1),d.modals.length===0)d.restore&&d.restore(),e.modalRef&&Rx(e.modalRef,n),r8(d.container,e.mount,e.modalRef,d.hiddenSiblings,!1),this.containers.splice(u,1);else{const _=d.modals[d.modals.length-1];_.modalRef&&Rx(_.modalRef,!1)}return o}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function qae(t){return typeof t=="function"?t():t}function Kae(t){return t?t.props.hasOwnProperty("in"):!1}const Yae=new Wae;function Zae(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:o=!1,manager:u=Yae,closeAfterTransition:d=!1,onTransitionEnter:_,onTransitionExited:v,children:a,onClose:C,open:A,rootRef:k}=t,O=fe.useRef({}),R=fe.useRef(null),z=fe.useRef(null),N=ra(z,k),[K,q]=fe.useState(!A),j=Kae(a);let H=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(H=!1);const Y=()=>Za(R.current),te=()=>(O.current.modalRef=z.current,O.current.mount=R.current,O.current),J=()=>{u.mount(te(),{disableScrollLock:o}),z.current&&(z.current.scrollTop=0)},ae=yg(()=>{const ft=qae(e)||Y().body;u.add(te(),ft),z.current&&J()}),de=fe.useCallback(()=>u.isTopModal(te()),[u]),Me=yg(ft=>{R.current=ft,ft&&(A&&de()?J():z.current&&Rx(z.current,H))}),Ce=fe.useCallback(()=>{u.remove(te(),H)},[H,u]);fe.useEffect(()=>()=>{Ce()},[Ce]),fe.useEffect(()=>{A?ae():(!j||!d)&&Ce()},[A,Ce,j,d,ae]);const Ae=ft=>et=>{var Xe;(Xe=ft.onKeyDown)==null||Xe.call(ft,et),!(et.key!=="Escape"||et.which===229||!de())&&(n||(et.stopPropagation(),C&&C(et,"escapeKeyDown")))},Ne=ft=>et=>{var Xe;(Xe=ft.onClick)==null||Xe.call(ft,et),et.target===et.currentTarget&&C&&C(et,"backdropClick")};return{getRootProps:(ft={})=>{const et=UV(t);delete et.onTransitionEnter,delete et.onTransitionExited;const Xe=We({},et,ft);return We({role:"presentation"},Xe,{onKeyDown:Ae(Xe),ref:N})},getBackdropProps:(ft={})=>{const et=ft;return We({"aria-hidden":!0},et,{onClick:Ne(et),open:A})},getTransitionProps:()=>{const ft=()=>{q(!1),_&&_()},et=()=>{q(!0),v&&v(),d&&Ce()};return{onEnter:RN(ft,a?.props.onEnter),onExited:RN(et,a?.props.onExited)}},rootRef:N,portalRef:Me,isTopModal:de,exited:K,hasTransition:j}}const Xae=["onChange","maxRows","minRows","style","value"];function TC(t){return parseInt(t,10)||0}const Qae={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Jae(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflowing}const ele=fe.forwardRef(function(e,n){const{onChange:o,maxRows:u,minRows:d=1,style:_,value:v}=e,a=tn(e,Xae),{current:C}=fe.useRef(v!=null),A=fe.useRef(null),k=ra(n,A),O=fe.useRef(null),R=fe.useCallback(()=>{const K=A.current,j=am(K).getComputedStyle(K);if(j.width==="0px")return{outerHeightStyle:0,overflowing:!1};const H=O.current;H.style.width=j.width,H.value=K.value||e.placeholder||"x",H.value.slice(-1)===`
`&&(H.value+=" ");const Y=j.boxSizing,te=TC(j.paddingBottom)+TC(j.paddingTop),J=TC(j.borderBottomWidth)+TC(j.borderTopWidth),ae=H.scrollHeight;H.value="x";const de=H.scrollHeight;let Me=ae;d&&(Me=Math.max(Number(d)*de,Me)),u&&(Me=Math.min(Number(u)*de,Me)),Me=Math.max(Me,de);const Ce=Me+(Y==="border-box"?te+J:0),Ae=Math.abs(Me-ae)<=1;return{outerHeightStyle:Ce,overflowing:Ae}},[u,d,e.placeholder]),z=fe.useCallback(()=>{const K=R();if(Jae(K))return;const q=A.current;q.style.height=`${K.outerHeightStyle}px`,q.style.overflow=K.overflowing?"hidden":""},[R]);rf(()=>{const K=()=>{z()};let q;const j=_V(K),H=A.current,Y=am(H);Y.addEventListener("resize",j);let te;return typeof ResizeObserver<"u"&&(te=new ResizeObserver(K),te.observe(H)),()=>{j.clear(),cancelAnimationFrame(q),Y.removeEventListener("resize",j),te&&te.disconnect()}},[R,z]),rf(()=>{z()});const N=K=>{C||z(),o&&o(K)};return Ke.jsxs(fe.Fragment,{children:[Ke.jsx("textarea",We({value:v,onChange:N,ref:k,rows:d,style:_},a)),Ke.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:O,tabIndex:-1,style:We({},Qae.shadow,_,{paddingTop:0,paddingBottom:0})})]})});function R_({props:t,states:e,muiFormControl:n}){return e.reduce((o,u)=>(o[u]=t[u],n&&typeof t[u]>"u"&&(o[u]=n[u]),o),{})}const yO=fe.createContext(void 0);function k_(){return fe.useContext(yO)}function $V(t){return Ke.jsx(vie,We({},t,{defaultTheme:dO,themeId:Qg}))}function n8(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function fS(t,e=!1){return t&&(n8(t.value)&&t.value!==""||e&&n8(t.defaultValue)&&t.defaultValue!=="")}function tle(t){return t.startAdornment}function rle(t){return Ki("MuiInputBase",t)}const n_=Yi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),nle=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],vA=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${qn(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},xA=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},ile=t=>{const{classes:e,color:n,disabled:o,error:u,endAdornment:d,focused:_,formControl:v,fullWidth:a,hiddenLabel:C,multiline:A,readOnly:k,size:O,startAdornment:R,type:z}=t,N={root:["root",`color${qn(n)}`,o&&"disabled",u&&"error",a&&"fullWidth",_&&"focused",v&&"formControl",O&&O!=="medium"&&`size${qn(O)}`,A&&"multiline",R&&"adornedStart",d&&"adornedEnd",C&&"hiddenLabel",k&&"readOnly"],input:["input",o&&"disabled",z==="search"&&"inputTypeSearch",A&&"inputMultiline",O==="small"&&"inputSizeSmall",C&&"inputHiddenLabel",R&&"inputAdornedStart",d&&"inputAdornedEnd",k&&"readOnly"]};return ao(N,rle,e)},bA=Hr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:vA})(({theme:t,ownerState:e})=>We({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${n_.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&We({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),wA=Hr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:xA})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",o=We({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),u={opacity:"0 !important"},d=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return We({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${n_.formControl} &`]:{"&::-webkit-input-placeholder":u,"&::-moz-placeholder":u,"&:-ms-input-placeholder":u,"&::-ms-input-placeholder":u,"&:focus::-webkit-input-placeholder":d,"&:focus::-moz-placeholder":d,"&:focus:-ms-input-placeholder":d,"&:focus::-ms-input-placeholder":d},[`&.${n_.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),ole=Ke.jsx($V,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),sle=fe.forwardRef(function(e,n){var o;const u=Zi({props:e,name:"MuiInputBase"}),{"aria-describedby":d,autoComplete:_,autoFocus:v,className:a,components:C={},componentsProps:A={},defaultValue:k,disabled:O,disableInjectingGlobalStyles:R,endAdornment:z,fullWidth:N=!1,id:K,inputComponent:q="input",inputProps:j={},inputRef:H,maxRows:Y,minRows:te,multiline:J=!1,name:ae,onBlur:de,onChange:Me,onClick:Ce,onFocus:Ae,onKeyDown:Ne,onKeyUp:Re,placeholder:Ye,readOnly:ht,renderSuffix:ft,rows:et,slotProps:Xe={},slots:Mt={},startAdornment:Lt,type:nt="text",value:at}=u,it=tn(u,nle),tt=j.value!=null?j.value:at,{current:Jt}=fe.useRef(tt!=null),$t=fe.useRef(),Lr=fe.useCallback(Xr=>{},[]),rr=ra($t,H,j.ref,Lr),[Zt,dn]=fe.useState(!1),dr=k_(),Ur=R_({props:u,muiFormControl:dr,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Ur.focused=dr?dr.focused:Zt,fe.useEffect(()=>{!dr&&O&&Zt&&(dn(!1),de&&de())},[dr,O,Zt,de]);const Tr=dr&&dr.onFilled,wr=dr&&dr.onEmpty,Er=fe.useCallback(Xr=>{fS(Xr)?Tr&&Tr():wr&&wr()},[Tr,wr]);rf(()=>{Jt&&Er({value:tt})},[tt,Er,Jt]);const Zn=Xr=>{if(Ur.disabled){Xr.stopPropagation();return}Ae&&Ae(Xr),j.onFocus&&j.onFocus(Xr),dr&&dr.onFocus?dr.onFocus(Xr):dn(!0)},fn=Xr=>{de&&de(Xr),j.onBlur&&j.onBlur(Xr),dr&&dr.onBlur?dr.onBlur(Xr):dn(!1)},pn=(Xr,...yr)=>{if(!Jt){const xi=Xr.target||$t.current;if(xi==null)throw new Error(om(1));Er({value:xi.value})}j.onChange&&j.onChange(Xr,...yr),Me&&Me(Xr,...yr)};fe.useEffect(()=>{Er($t.current)},[]);const li=Xr=>{$t.current&&Xr.currentTarget===Xr.target&&$t.current.focus(),Ce&&Ce(Xr)};let or=q,Yt=j;J&&or==="input"&&(et?Yt=We({type:void 0,minRows:et,maxRows:et},Yt):Yt=We({type:void 0,maxRows:Y,minRows:te},Yt),or=ele);const un=Xr=>{Er(Xr.animationName==="mui-auto-fill-cancel"?$t.current:{value:"x"})};fe.useEffect(()=>{dr&&dr.setAdornedStart(!!Lt)},[dr,Lt]);const _n=We({},u,{color:Ur.color||"primary",disabled:Ur.disabled,endAdornment:z,error:Ur.error,focused:Ur.focused,formControl:dr,fullWidth:N,hiddenLabel:Ur.hiddenLabel,multiline:J,size:Ur.size,startAdornment:Lt,type:nt}),rn=ile(_n),ri=Mt.root||C.Root||bA,Ln=Xe.root||A.root||{},Vn=Mt.input||C.Input||wA;return Yt=We({},Yt,(o=Xe.input)!=null?o:A.input),Ke.jsxs(fe.Fragment,{children:[!R&&ole,Ke.jsxs(ri,We({},Ln,!dS(ri)&&{ownerState:We({},_n,Ln.ownerState)},{ref:n,onClick:li},it,{className:zn(rn.root,Ln.className,a,ht&&"MuiInputBase-readOnly"),children:[Lt,Ke.jsx(yO.Provider,{value:null,children:Ke.jsx(Vn,We({ownerState:_n,"aria-invalid":Ur.error,"aria-describedby":d,autoComplete:_,autoFocus:v,defaultValue:k,disabled:Ur.disabled,id:K,onAnimationStart:un,name:ae,placeholder:Ye,readOnly:ht,required:Ur.required,rows:et,value:tt,onKeyDown:Ne,onKeyUp:Re,type:nt},Yt,!dS(Vn)&&{as:or,ownerState:We({},_n,Yt.ownerState)},{ref:rr,className:zn(rn.input,Yt.className,ht&&"MuiInputBase-readOnly"),onBlur:fn,onChange:pn,onFocus:Zn}))}),z,ft?ft(We({},Ur,{startAdornment:Lt})):null]}))]})}),vO=sle;function ale(t){return Ki("MuiInput",t)}const Gv=We({},n_,Yi("MuiInput",["root","underline","input"]));function lle(t){return Ki("MuiOutlinedInput",t)}const wd=We({},n_,Yi("MuiOutlinedInput",["root","notchedOutline","input"]));function cle(t){return Ki("MuiFilledInput",t)}const bp=We({},n_,Yi("MuiFilledInput",["root","underline","input"])),ule=$se(Ke.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),hle=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],dle={entering:{opacity:1},entered:{opacity:1}},fle=fe.forwardRef(function(e,n){const o=fO(),u={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:d,appear:_=!0,children:v,easing:a,in:C,onEnter:A,onEntered:k,onEntering:O,onExit:R,onExited:z,onExiting:N,style:K,timeout:q=u,TransitionComponent:j=Nl}=e,H=tn(e,hle),Y=fe.useRef(null),te=ra(Y,v.ref,n),J=Ye=>ht=>{if(Ye){const ft=Y.current;ht===void 0?Ye(ft):Ye(ft,ht)}},ae=J(O),de=J((Ye,ht)=>{zV(Ye);const ft=t_({style:K,timeout:q,easing:a},{mode:"enter"});Ye.style.webkitTransition=o.transitions.create("opacity",ft),Ye.style.transition=o.transitions.create("opacity",ft),A&&A(Ye,ht)}),Me=J(k),Ce=J(N),Ae=J(Ye=>{const ht=t_({style:K,timeout:q,easing:a},{mode:"exit"});Ye.style.webkitTransition=o.transitions.create("opacity",ht),Ye.style.transition=o.transitions.create("opacity",ht),R&&R(Ye)}),Ne=J(z),Re=Ye=>{d&&d(Y.current,Ye)};return Ke.jsx(j,We({appear:_,in:C,nodeRef:Y,onEnter:de,onEntered:Me,onEntering:ae,onExit:Ae,onExited:Ne,onExiting:Ce,addEndListener:Re,timeout:q},H,{children:(Ye,ht)=>fe.cloneElement(v,We({style:We({opacity:0,visibility:Ye==="exited"&&!C?"hidden":void 0},dle[Ye],K,v.props.style),ref:te},ht))}))});function ple(t){return Ki("MuiBackdrop",t)}Yi("MuiBackdrop",["root","invisible"]);const mle=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],gle=t=>{const{classes:e,invisible:n}=t;return ao({root:["root",n&&"invisible"]},ple,e)},_le=Hr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>We({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),yle=fe.forwardRef(function(e,n){var o,u,d;const _=Zi({props:e,name:"MuiBackdrop"}),{children:v,className:a,component:C="div",components:A={},componentsProps:k={},invisible:O=!1,open:R,slotProps:z={},slots:N={},TransitionComponent:K=fle,transitionDuration:q}=_,j=tn(_,mle),H=We({},_,{component:C,invisible:O}),Y=gle(H),te=(o=z.root)!=null?o:k.root;return Ke.jsx(K,We({in:R,timeout:q},j,{children:Ke.jsx(_le,We({"aria-hidden":!0},te,{as:(u=(d=N.root)!=null?d:A.Root)!=null?u:C,className:zn(Y.root,a,te?.className),ownerState:We({},H,te?.ownerState),classes:Y,ref:n,children:v}))}))}),vle=Yi("MuiBox",["root"]),xle=iA(),kn=Sie({themeId:Qg,defaultTheme:xle,defaultClassName:vle.root,generateClassName:cV.generate});function ble(t){return Ki("MuiButton",t)}const AC=Yi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),wle=fe.createContext({}),Cle=fe.createContext(void 0),Ele=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Sle=t=>{const{color:e,disableElevation:n,fullWidth:o,size:u,variant:d,classes:_}=t,v={root:["root",d,`${d}${qn(e)}`,`size${qn(u)}`,`${d}Size${qn(u)}`,`color${qn(e)}`,n&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${qn(u)}`],endIcon:["icon","endIcon",`iconSize${qn(u)}`]},a=ao(v,ble,_);return We({},_,a)},jV=t=>We({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Tle=Hr(kae,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${qn(n.color)}`],e[`size${qn(n.size)}`],e[`${n.variant}Size${qn(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,o;const u=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],d=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return We({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":We({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:vg(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:vg(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:vg(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:d,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":We({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${AC.focusVisible}`]:We({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${AC.disabled}`]:We({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${vg(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(o=t.palette).getContrastText)==null?void 0:n.call(o,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:u,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${AC.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${AC.disabled}`]:{boxShadow:"none"}}),Ale=Hr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${qn(n.size)}`]]}})(({ownerState:t})=>We({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},jV(t))),Ile=Hr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${qn(n.size)}`]]}})(({ownerState:t})=>We({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},jV(t))),m1=fe.forwardRef(function(e,n){const o=fe.useContext(wle),u=fe.useContext(Cle),d=h1(o,e),_=Zi({props:d,name:"MuiButton"}),{children:v,color:a="primary",component:C="button",className:A,disabled:k=!1,disableElevation:O=!1,disableFocusRipple:R=!1,endIcon:z,focusVisibleClassName:N,fullWidth:K=!1,size:q="medium",startIcon:j,type:H,variant:Y="text"}=_,te=tn(_,Ele),J=We({},_,{color:a,component:C,disabled:k,disableElevation:O,disableFocusRipple:R,fullWidth:K,size:q,type:H,variant:Y}),ae=Sle(J),de=j&&Ke.jsx(Ale,{className:ae.startIcon,ownerState:J,children:j}),Me=z&&Ke.jsx(Ile,{className:ae.endIcon,ownerState:J,children:z}),Ce=u||"";return Ke.jsxs(Tle,We({ownerState:J,className:zn(o.className,ae.root,A,Ce),component:C,disabled:k,focusRipple:!R,focusVisibleClassName:zn(ae.focusVisible,N),ref:n,type:H},te,{classes:ae,children:[de,v,Me]}))});function Mle(t){return Ki("MuiCircularProgress",t)}Yi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ple=["className","color","disableShrink","size","style","thickness","value","variant"];let CA=t=>t,i8,o8,s8,a8;const Cd=44,Rle=A_(i8||(i8=CA`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),kle=A_(o8||(o8=CA`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Dle=t=>{const{classes:e,variant:n,color:o,disableShrink:u}=t,d={root:["root",n,`color${qn(o)}`],svg:["svg"],circle:["circle",`circle${qn(n)}`,u&&"circleDisableShrink"]};return ao(d,Mle,e)},Ole=Hr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${qn(n.color)}`]]}})(({ownerState:t,theme:e})=>We({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&zT(s8||(s8=CA`
      animation: ${0} 1.4s linear infinite;
    `),Rle)),Lle=Hr("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),Ble=Hr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${qn(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>We({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&zT(a8||(a8=CA`
      animation: ${0} 1.4s ease-in-out infinite;
    `),kle)),Fle=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiCircularProgress"}),{className:u,color:d="primary",disableShrink:_=!1,size:v=40,style:a,thickness:C=3.6,value:A=0,variant:k="indeterminate"}=o,O=tn(o,Ple),R=We({},o,{color:d,disableShrink:_,size:v,thickness:C,value:A,variant:k}),z=Dle(R),N={},K={},q={};if(k==="determinate"){const j=2*Math.PI*((Cd-C)/2);N.strokeDasharray=j.toFixed(3),q["aria-valuenow"]=Math.round(A),N.strokeDashoffset=`${((100-A)/100*j).toFixed(3)}px`,K.transform="rotate(-90deg)"}return Ke.jsx(Ole,We({className:zn(z.root,u),style:We({width:v,height:v},K,a),ownerState:R,ref:n,role:"progressbar"},q,O,{children:Ke.jsx(Lle,{className:z.svg,ownerState:R,viewBox:`${Cd/2} ${Cd/2} ${Cd} ${Cd}`,children:Ke.jsx(Ble,{className:z.circle,style:N,ownerState:R,cx:Cd,cy:Cd,r:(Cd-C)/2,fill:"none",strokeWidth:C})})}))}),zle=(t,e)=>We({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),Nle=t=>We({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),Ule=(t,e=!1)=>{var n;const o={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([_,v])=>{var a;o[t.getColorSchemeSelector(_).replace(/\s*&/,"")]={colorScheme:(a=v.palette)==null?void 0:a.mode}});let u=We({html:zle(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:We({margin:0},Nle(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},o);const d=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return d&&(u=[u,d]),u};function $le(t){const e=Zi({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:o=!1}=e;return Ke.jsxs(fe.Fragment,{children:[Ke.jsx($V,{styles:u=>Ule(u,o)}),n]})}function jle(t){return Ki("MuiModal",t)}Yi("MuiModal",["root","hidden","backdrop"]);const Vle=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Hle=t=>{const{open:e,exited:n,classes:o}=t;return ao({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},jle,o)},Gle=Hr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>We({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Wle=Hr(yle,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),qle=fe.forwardRef(function(e,n){var o,u,d,_,v,a;const C=Zi({name:"MuiModal",props:e}),{BackdropComponent:A=Wle,BackdropProps:k,className:O,closeAfterTransition:R=!1,children:z,container:N,component:K,components:q={},componentsProps:j={},disableAutoFocus:H=!1,disableEnforceFocus:Y=!1,disableEscapeKeyDown:te=!1,disablePortal:J=!1,disableRestoreFocus:ae=!1,disableScrollLock:de=!1,hideBackdrop:Me=!1,keepMounted:Ce=!1,onBackdropClick:Ae,open:Ne,slotProps:Re,slots:Ye}=C,ht=tn(C,Vle),ft=We({},C,{closeAfterTransition:R,disableAutoFocus:H,disableEnforceFocus:Y,disableEscapeKeyDown:te,disablePortal:J,disableRestoreFocus:ae,disableScrollLock:de,hideBackdrop:Me,keepMounted:Ce}),{getRootProps:et,getBackdropProps:Xe,getTransitionProps:Mt,portalRef:Lt,isTopModal:nt,exited:at,hasTransition:it}=Zae(We({},ft,{rootRef:n})),tt=We({},ft,{exited:at}),Jt=Hle(tt),$t={};if(z.props.tabIndex===void 0&&($t.tabIndex="-1"),it){const{onEnter:Tr,onExited:wr}=Mt();$t.onEnter=Tr,$t.onExited=wr}const Lr=(o=(u=Ye?.root)!=null?u:q.Root)!=null?o:Gle,rr=(d=(_=Ye?.backdrop)!=null?_:q.Backdrop)!=null?d:A,Zt=(v=Re?.root)!=null?v:j.root,dn=(a=Re?.backdrop)!=null?a:j.backdrop,dr=r_({elementType:Lr,externalSlotProps:Zt,externalForwardedProps:ht,getSlotProps:et,additionalProps:{ref:n,as:K},ownerState:tt,className:zn(O,Zt?.className,Jt?.root,!tt.open&&tt.exited&&Jt?.hidden)}),Ur=r_({elementType:rr,externalSlotProps:dn,additionalProps:k,getSlotProps:Tr=>Xe(We({},Tr,{onClick:wr=>{Ae&&Ae(wr),Tr!=null&&Tr.onClick&&Tr.onClick(wr)}})),className:zn(dn?.className,k?.className,Jt?.backdrop),ownerState:tt});return!Ce&&!Ne&&(!it||at)?null:Ke.jsx($ae,{ref:Lt,container:N,disablePortal:J,children:Ke.jsxs(Lr,We({},dr,{children:[!Me&&A?Ke.jsx(rr,We({},Ur)):null,Ke.jsx(Nae,{disableEnforceFocus:Y,disableAutoFocus:H,disableRestoreFocus:ae,isEnabled:nt,open:Ne,children:fe.cloneElement(z,$t)})]}))})}),Kle=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Yle=t=>{const{classes:e,disableUnderline:n}=t,u=ao({root:["root",!n&&"underline"],input:["input"]},cle,e);return We({},e,u)},Zle=Hr(bA,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...vA(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const o=t.palette.mode==="light",u=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",d=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",_=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",v=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return We({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:d,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:_,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:d}},[`&.${bp.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:d},[`&.${bp.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:v}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${bp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${bp.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:u}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${bp.disabled}, .${bp.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${bp.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&We({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),Xle=Hr(wA,{name:"MuiFilledInput",slot:"Input",overridesResolver:xA})(({theme:t,ownerState:e})=>We({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),xO=fe.forwardRef(function(e,n){var o,u,d,_;const v=Zi({props:e,name:"MuiFilledInput"}),{components:a={},componentsProps:C,fullWidth:A=!1,inputComponent:k="input",multiline:O=!1,slotProps:R,slots:z={},type:N="text"}=v,K=tn(v,Kle),q=We({},v,{fullWidth:A,inputComponent:k,multiline:O,type:N}),j=Yle(v),H={root:{ownerState:q},input:{ownerState:q}},Y=R??C?ta(H,R??C):H,te=(o=(u=z.root)!=null?u:a.Root)!=null?o:Zle,J=(d=(_=z.input)!=null?_:a.Input)!=null?d:Xle;return Ke.jsx(vO,We({slots:{root:te,input:J},componentsProps:Y,fullWidth:A,inputComponent:k,multiline:O,ref:n,type:N},K,{classes:j}))});xO.muiName="Input";function Qle(t){return Ki("MuiFormControl",t)}Yi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Jle=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],ece=t=>{const{classes:e,margin:n,fullWidth:o}=t,u={root:["root",n!=="none"&&`margin${qn(n)}`,o&&"fullWidth"]};return ao(u,Qle,e)},tce=Hr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>We({},e.root,e[`margin${qn(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>We({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),rce=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiFormControl"}),{children:u,className:d,color:_="primary",component:v="div",disabled:a=!1,error:C=!1,focused:A,fullWidth:k=!1,hiddenLabel:O=!1,margin:R="none",required:z=!1,size:N="medium",variant:K="outlined"}=o,q=tn(o,Jle),j=We({},o,{color:_,component:v,disabled:a,error:C,fullWidth:k,hiddenLabel:O,margin:R,required:z,size:N,variant:K}),H=ece(j),[Y,te]=fe.useState(()=>{let Re=!1;return u&&fe.Children.forEach(u,Ye=>{if(!NM(Ye,["Input","Select"]))return;const ht=NM(Ye,["Select"])?Ye.props.input:Ye;ht&&tle(ht.props)&&(Re=!0)}),Re}),[J,ae]=fe.useState(()=>{let Re=!1;return u&&fe.Children.forEach(u,Ye=>{NM(Ye,["Input","Select"])&&(fS(Ye.props,!0)||fS(Ye.props.inputProps,!0))&&(Re=!0)}),Re}),[de,Me]=fe.useState(!1);a&&de&&Me(!1);const Ce=A!==void 0&&!a?A:de;let Ae;const Ne=fe.useMemo(()=>({adornedStart:Y,setAdornedStart:te,color:_,disabled:a,error:C,filled:J,focused:Ce,fullWidth:k,hiddenLabel:O,size:N,onBlur:()=>{Me(!1)},onEmpty:()=>{ae(!1)},onFilled:()=>{ae(!0)},onFocus:()=>{Me(!0)},registerEffect:Ae,required:z,variant:K}),[Y,_,a,C,J,Ce,k,O,Ae,z,N,K]);return Ke.jsx(yO.Provider,{value:Ne,children:Ke.jsx(tce,We({as:v,ownerState:j,className:zn(H.root,d),ref:n},q,{children:u}))})}),nce=Eoe({createStyledComponent:Hr("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>Zi({props:t,name:"MuiStack"})});function ice(t){return Ki("MuiFormHelperText",t)}const l8=Yi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var c8;const oce=["children","className","component","disabled","error","filled","focused","margin","required","variant"],sce=t=>{const{classes:e,contained:n,size:o,disabled:u,error:d,filled:_,focused:v,required:a}=t,C={root:["root",u&&"disabled",d&&"error",o&&`size${qn(o)}`,n&&"contained",v&&"focused",_&&"filled",a&&"required"]};return ao(C,ice,e)},ace=Hr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${qn(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>We({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${l8.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${l8.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),lce=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiFormHelperText"}),{children:u,className:d,component:_="p"}=o,v=tn(o,oce),a=k_(),C=R_({props:o,muiFormControl:a,states:["variant","size","disabled","error","filled","focused","required"]}),A=We({},o,{component:_,contained:C.variant==="filled"||C.variant==="outlined",variant:C.variant,size:C.size,disabled:C.disabled,error:C.error,filled:C.filled,focused:C.focused,required:C.required}),k=sce(A);return Ke.jsx(ace,We({as:_,ownerState:A,className:zn(k.root,d),ref:n},v,{children:u===" "?c8||(c8=Ke.jsx("span",{className:"notranslate",children:"​"})):u}))});function cce(t){return Ki("MuiFormLabel",t)}const kx=Yi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),uce=["children","className","color","component","disabled","error","filled","focused","required"],hce=t=>{const{classes:e,color:n,focused:o,disabled:u,error:d,filled:_,required:v}=t,a={root:["root",`color${qn(n)}`,u&&"disabled",d&&"error",_&&"filled",o&&"focused",v&&"required"],asterisk:["asterisk",d&&"error"]};return ao(a,cce,e)},dce=Hr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>We({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>We({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${kx.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${kx.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${kx.error}`]:{color:(t.vars||t).palette.error.main}})),fce=Hr("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${kx.error}`]:{color:(t.vars||t).palette.error.main}})),pce=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiFormLabel"}),{children:u,className:d,component:_="label"}=o,v=tn(o,uce),a=k_(),C=R_({props:o,muiFormControl:a,states:["color","required","focused","disabled","error","filled"]}),A=We({},o,{color:C.color||"primary",component:_,disabled:C.disabled,error:C.error,filled:C.filled,focused:C.focused,required:C.required}),k=hce(A);return Ke.jsxs(dce,We({as:_,ownerState:A,className:zn(k.root,d),ref:n},v,{children:[u,C.required&&Ke.jsxs(fce,{ownerState:A,"aria-hidden":!0,className:k.asterisk,children:[" ","*"]})]}))}),mce=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Pk(t){return`scale(${t}, ${t**2})`}const gce={entering:{opacity:1,transform:Pk(1)},entered:{opacity:1,transform:"none"}},GM=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),VV=fe.forwardRef(function(e,n){const{addEndListener:o,appear:u=!0,children:d,easing:_,in:v,onEnter:a,onEntered:C,onEntering:A,onExit:k,onExited:O,onExiting:R,style:z,timeout:N="auto",TransitionComponent:K=Nl}=e,q=tn(e,mce),j=lO(),H=fe.useRef(),Y=fO(),te=fe.useRef(null),J=ra(te,d.ref,n),ae=ht=>ft=>{if(ht){const et=te.current;ft===void 0?ht(et):ht(et,ft)}},de=ae(A),Me=ae((ht,ft)=>{zV(ht);const{duration:et,delay:Xe,easing:Mt}=t_({style:z,timeout:N,easing:_},{mode:"enter"});let Lt;N==="auto"?(Lt=Y.transitions.getAutoHeightDuration(ht.clientHeight),H.current=Lt):Lt=et,ht.style.transition=[Y.transitions.create("opacity",{duration:Lt,delay:Xe}),Y.transitions.create("transform",{duration:GM?Lt:Lt*.666,delay:Xe,easing:Mt})].join(","),a&&a(ht,ft)}),Ce=ae(C),Ae=ae(R),Ne=ae(ht=>{const{duration:ft,delay:et,easing:Xe}=t_({style:z,timeout:N,easing:_},{mode:"exit"});let Mt;N==="auto"?(Mt=Y.transitions.getAutoHeightDuration(ht.clientHeight),H.current=Mt):Mt=ft,ht.style.transition=[Y.transitions.create("opacity",{duration:Mt,delay:et}),Y.transitions.create("transform",{duration:GM?Mt:Mt*.666,delay:GM?et:et||Mt*.333,easing:Xe})].join(","),ht.style.opacity=0,ht.style.transform=Pk(.75),k&&k(ht)}),Re=ae(O),Ye=ht=>{N==="auto"&&j.start(H.current||0,ht),o&&o(te.current,ht)};return Ke.jsx(K,We({appear:u,in:v,nodeRef:te,onEnter:Me,onEntered:Ce,onEntering:de,onExit:Ne,onExited:Re,onExiting:Ae,addEndListener:Ye,timeout:N==="auto"?null:N},q,{children:(ht,ft)=>fe.cloneElement(d,We({style:We({opacity:0,transform:Pk(.75),visibility:ht==="exited"&&!v?"hidden":void 0},gce[ht],z,d.props.style),ref:J},ft))}))});VV.muiSupportAuto=!0;const _ce=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],yce=t=>{const{classes:e,disableUnderline:n}=t,u=ao({root:["root",!n&&"underline"],input:["input"]},ale,e);return We({},e,u)},vce=Hr(bA,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...vA(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let o=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(o=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),We({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Gv.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Gv.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${o}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Gv.disabled}, .${Gv.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${o}`}},[`&.${Gv.disabled}:before`]:{borderBottomStyle:"dotted"}})}),xce=Hr(wA,{name:"MuiInput",slot:"Input",overridesResolver:xA})({}),bO=fe.forwardRef(function(e,n){var o,u,d,_;const v=Zi({props:e,name:"MuiInput"}),{disableUnderline:a,components:C={},componentsProps:A,fullWidth:k=!1,inputComponent:O="input",multiline:R=!1,slotProps:z,slots:N={},type:K="text"}=v,q=tn(v,_ce),j=yce(v),Y={root:{ownerState:{disableUnderline:a}}},te=z??A?ta(z??A,Y):Y,J=(o=(u=N.root)!=null?u:C.Root)!=null?o:vce,ae=(d=(_=N.input)!=null?_:C.Input)!=null?d:xce;return Ke.jsx(vO,We({slots:{root:J,input:ae},slotProps:te,fullWidth:k,inputComponent:O,multiline:R,ref:n,type:K},q,{classes:j}))});bO.muiName="Input";function bce(t){return Ki("MuiInputLabel",t)}Yi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const wce=["disableAnimation","margin","shrink","variant","className"],Cce=t=>{const{classes:e,formControl:n,size:o,shrink:u,disableAnimation:d,variant:_,required:v}=t,a={root:["root",n&&"formControl",!d&&"animated",u&&"shrink",o&&o!=="normal"&&`size${qn(o)}`,_],asterisk:[v&&"asterisk"]},C=ao(a,bce,e);return We({},e,C)},Ece=Hr(pce,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${kx.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>We({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&We({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&We({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&We({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Sce=fe.forwardRef(function(e,n){const o=Zi({name:"MuiInputLabel",props:e}),{disableAnimation:u=!1,shrink:d,className:_}=o,v=tn(o,wce),a=k_();let C=d;typeof C>"u"&&a&&(C=a.filled||a.focused||a.adornedStart);const A=R_({props:o,muiFormControl:a,states:["size","variant","required","focused"]}),k=We({},o,{disableAnimation:u,formControl:a,shrink:C,size:A.size,variant:A.variant,required:A.required,focused:A.focused}),O=Cce(k);return Ke.jsx(Ece,We({"data-shrink":C,ownerState:k,ref:n,className:zn(O.root,_)},v,{classes:O}))}),Tce=fe.createContext({});function Ace(t){return Ki("MuiList",t)}Yi("MuiList",["root","padding","dense","subheader"]);const Ice=["children","className","component","dense","disablePadding","subheader"],Mce=t=>{const{classes:e,disablePadding:n,dense:o,subheader:u}=t;return ao({root:["root",!n&&"padding",o&&"dense",u&&"subheader"]},Ace,e)},Pce=Hr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>We({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),Rce=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiList"}),{children:u,className:d,component:_="ul",dense:v=!1,disablePadding:a=!1,subheader:C}=o,A=tn(o,Ice),k=fe.useMemo(()=>({dense:v}),[v]),O=We({},o,{component:_,dense:v,disablePadding:a}),R=Mce(O);return Ke.jsx(Tce.Provider,{value:k,children:Ke.jsxs(Pce,We({as:_,className:zn(R.root,d),ref:n,ownerState:O},A,{children:[C,u]}))})}),kce=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function WM(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function u8(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function HV(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function Wv(t,e,n,o,u,d){let _=!1,v=u(t,e,e?n:!1);for(;v;){if(v===t.firstChild){if(_)return!1;_=!0}const a=o?!1:v.disabled||v.getAttribute("aria-disabled")==="true";if(!v.hasAttribute("tabindex")||!HV(v,d)||a)v=u(t,v,n);else return v.focus(),!0}return!1}const Dce=fe.forwardRef(function(e,n){const{actions:o,autoFocus:u=!1,autoFocusItem:d=!1,children:_,className:v,disabledItemsFocusable:a=!1,disableListWrap:C=!1,onKeyDown:A,variant:k="selectedMenu"}=e,O=tn(e,kce),R=fe.useRef(null),z=fe.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});rf(()=>{u&&R.current.focus()},[u]),fe.useImperativeHandle(o,()=>({adjustStyleForScrollbar:(H,{direction:Y})=>{const te=!R.current.style.width;if(H.clientHeight<R.current.clientHeight&&te){const J=`${vV(Za(H))}px`;R.current.style[Y==="rtl"?"paddingLeft":"paddingRight"]=J,R.current.style.width=`calc(100% + ${J})`}return R.current}}),[]);const N=H=>{const Y=R.current,te=H.key,J=Za(Y).activeElement;if(te==="ArrowDown")H.preventDefault(),Wv(Y,J,C,a,WM);else if(te==="ArrowUp")H.preventDefault(),Wv(Y,J,C,a,u8);else if(te==="Home")H.preventDefault(),Wv(Y,null,C,a,WM);else if(te==="End")H.preventDefault(),Wv(Y,null,C,a,u8);else if(te.length===1){const ae=z.current,de=te.toLowerCase(),Me=performance.now();ae.keys.length>0&&(Me-ae.lastTime>500?(ae.keys=[],ae.repeating=!0,ae.previousKeyMatched=!0):ae.repeating&&de!==ae.keys[0]&&(ae.repeating=!1)),ae.lastTime=Me,ae.keys.push(de);const Ce=J&&!ae.repeating&&HV(J,ae);ae.previousKeyMatched&&(Ce||Wv(Y,J,!1,a,WM,ae))?H.preventDefault():ae.previousKeyMatched=!1}A&&A(H)},K=ra(R,n);let q=-1;fe.Children.forEach(_,(H,Y)=>{if(!fe.isValidElement(H)){q===Y&&(q+=1,q>=_.length&&(q=-1));return}H.props.disabled||(k==="selectedMenu"&&H.props.selected||q===-1)&&(q=Y),q===Y&&(H.props.disabled||H.props.muiSkipListHighlight||H.type.muiSkipListHighlight)&&(q+=1,q>=_.length&&(q=-1))});const j=fe.Children.map(_,(H,Y)=>{if(Y===q){const te={};return d&&(te.autoFocus=!0),H.props.tabIndex===void 0&&k==="selectedMenu"&&(te.tabIndex=0),fe.cloneElement(H,te)}return H});return Ke.jsx(Rce,We({role:"menu",ref:K,className:v,onKeyDown:N,tabIndex:u?0:-1},O,{children:j}))});function Oce(t){return Ki("MuiPopover",t)}Yi("MuiPopover",["root","paper"]);const Lce=["onEntering"],Bce=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Fce=["slotProps"];function h8(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function d8(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function f8(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function qM(t){return typeof t=="function"?t():t}const zce=t=>{const{classes:e}=t;return ao({root:["root"],paper:["paper"]},Oce,e)},Nce=Hr(qle,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),GV=Hr(fae,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Uce=fe.forwardRef(function(e,n){var o,u,d;const _=Zi({props:e,name:"MuiPopover"}),{action:v,anchorEl:a,anchorOrigin:C={vertical:"top",horizontal:"left"},anchorPosition:A,anchorReference:k="anchorEl",children:O,className:R,container:z,elevation:N=8,marginThreshold:K=16,open:q,PaperProps:j={},slots:H,slotProps:Y,transformOrigin:te={vertical:"top",horizontal:"left"},TransitionComponent:J=VV,transitionDuration:ae="auto",TransitionProps:{onEntering:de}={},disableScrollLock:Me=!1}=_,Ce=tn(_.TransitionProps,Lce),Ae=tn(_,Bce),Ne=(o=Y?.paper)!=null?o:j,Re=fe.useRef(),Ye=ra(Re,Ne.ref),ht=We({},_,{anchorOrigin:C,anchorReference:k,elevation:N,marginThreshold:K,externalPaperSlotProps:Ne,transformOrigin:te,TransitionComponent:J,transitionDuration:ae,TransitionProps:Ce}),ft=zce(ht),et=fe.useCallback(()=>{if(k==="anchorPosition")return A;const Tr=qM(a),Er=(Tr&&Tr.nodeType===1?Tr:Za(Re.current).body).getBoundingClientRect();return{top:Er.top+h8(Er,C.vertical),left:Er.left+d8(Er,C.horizontal)}},[a,C.horizontal,C.vertical,A,k]),Xe=fe.useCallback(Tr=>({vertical:h8(Tr,te.vertical),horizontal:d8(Tr,te.horizontal)}),[te.horizontal,te.vertical]),Mt=fe.useCallback(Tr=>{const wr={width:Tr.offsetWidth,height:Tr.offsetHeight},Er=Xe(wr);if(k==="none")return{top:null,left:null,transformOrigin:f8(Er)};const Zn=et();let fn=Zn.top-Er.vertical,pn=Zn.left-Er.horizontal;const li=fn+wr.height,or=pn+wr.width,Yt=am(qM(a)),un=Yt.innerHeight-K,_n=Yt.innerWidth-K;if(K!==null&&fn<K){const rn=fn-K;fn-=rn,Er.vertical+=rn}else if(K!==null&&li>un){const rn=li-un;fn-=rn,Er.vertical+=rn}if(K!==null&&pn<K){const rn=pn-K;pn-=rn,Er.horizontal+=rn}else if(or>_n){const rn=or-_n;pn-=rn,Er.horizontal+=rn}return{top:`${Math.round(fn)}px`,left:`${Math.round(pn)}px`,transformOrigin:f8(Er)}},[a,k,et,Xe,K]),[Lt,nt]=fe.useState(q),at=fe.useCallback(()=>{const Tr=Re.current;if(!Tr)return;const wr=Mt(Tr);wr.top!==null&&(Tr.style.top=wr.top),wr.left!==null&&(Tr.style.left=wr.left),Tr.style.transformOrigin=wr.transformOrigin,nt(!0)},[Mt]);fe.useEffect(()=>(Me&&window.addEventListener("scroll",at),()=>window.removeEventListener("scroll",at)),[a,Me,at]);const it=(Tr,wr)=>{de&&de(Tr,wr),at()},tt=()=>{nt(!1)};fe.useEffect(()=>{q&&at()}),fe.useImperativeHandle(v,()=>q?{updatePosition:()=>{at()}}:null,[q,at]),fe.useEffect(()=>{if(!q)return;const Tr=_V(()=>{at()}),wr=am(a);return wr.addEventListener("resize",Tr),()=>{Tr.clear(),wr.removeEventListener("resize",Tr)}},[a,q,at]);let Jt=ae;ae==="auto"&&!J.muiSupportAuto&&(Jt=void 0);const $t=z||(a?Za(qM(a)).body:void 0),Lr=(u=H?.root)!=null?u:Nce,rr=(d=H?.paper)!=null?d:GV,Zt=r_({elementType:rr,externalSlotProps:We({},Ne,{style:Lt?Ne.style:We({},Ne.style,{opacity:0})}),additionalProps:{elevation:N,ref:Ye},ownerState:ht,className:zn(ft.paper,Ne?.className)}),dn=r_({elementType:Lr,externalSlotProps:Y?.root||{},externalForwardedProps:Ae,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:$t,open:q},ownerState:ht,className:zn(ft.root,R)}),{slotProps:dr}=dn,Ur=tn(dn,Fce);return Ke.jsx(Lr,We({},Ur,!dS(Lr)&&{slotProps:dr,disableScrollLock:Me},{children:Ke.jsx(J,We({appear:!0,in:q,onEntering:it,onExited:tt,timeout:Jt},Ce,{children:Ke.jsx(rr,We({},Zt,{children:O}))}))}))});function $ce(t){return Ki("MuiMenu",t)}Yi("MuiMenu",["root","paper","list"]);const jce=["onEntering"],Vce=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Hce={vertical:"top",horizontal:"right"},Gce={vertical:"top",horizontal:"left"},Wce=t=>{const{classes:e}=t;return ao({root:["root"],paper:["paper"],list:["list"]},$ce,e)},qce=Hr(Uce,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Kce=Hr(GV,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Yce=Hr(Dce,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),Zce=fe.forwardRef(function(e,n){var o,u;const d=Zi({props:e,name:"MuiMenu"}),{autoFocus:_=!0,children:v,className:a,disableAutoFocusItem:C=!1,MenuListProps:A={},onClose:k,open:O,PaperProps:R={},PopoverClasses:z,transitionDuration:N="auto",TransitionProps:{onEntering:K}={},variant:q="selectedMenu",slots:j={},slotProps:H={}}=d,Y=tn(d.TransitionProps,jce),te=tn(d,Vce),J=doe(),ae=We({},d,{autoFocus:_,disableAutoFocusItem:C,MenuListProps:A,onEntering:K,PaperProps:R,transitionDuration:N,TransitionProps:Y,variant:q}),de=Wce(ae),Me=_&&!C&&O,Ce=fe.useRef(null),Ae=(Xe,Mt)=>{Ce.current&&Ce.current.adjustStyleForScrollbar(Xe,{direction:J?"rtl":"ltr"}),K&&K(Xe,Mt)},Ne=Xe=>{Xe.key==="Tab"&&(Xe.preventDefault(),k&&k(Xe,"tabKeyDown"))};let Re=-1;fe.Children.map(v,(Xe,Mt)=>{fe.isValidElement(Xe)&&(Xe.props.disabled||(q==="selectedMenu"&&Xe.props.selected||Re===-1)&&(Re=Mt))});const Ye=(o=j.paper)!=null?o:Kce,ht=(u=H.paper)!=null?u:R,ft=r_({elementType:j.root,externalSlotProps:H.root,ownerState:ae,className:[de.root,a]}),et=r_({elementType:Ye,externalSlotProps:ht,ownerState:ae,className:de.paper});return Ke.jsx(qce,We({onClose:k,anchorOrigin:{vertical:"bottom",horizontal:J?"right":"left"},transformOrigin:J?Hce:Gce,slots:{paper:Ye,root:j.root},slotProps:{root:ft,paper:et},open:O,ref:n,transitionDuration:N,TransitionProps:We({onEntering:Ae},Y),ownerState:ae},te,{classes:z,children:Ke.jsx(Yce,We({onKeyDown:Ne,actions:Ce,autoFocus:_&&(Re===-1||C),autoFocusItem:Me,variant:q},A,{className:zn(de.list,A.className),children:v}))}))});function Xce(t){return Ki("MuiNativeSelect",t)}const wO=Yi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Qce=["className","disabled","error","IconComponent","inputRef","variant"],Jce=t=>{const{classes:e,variant:n,disabled:o,multiple:u,open:d,error:_}=t,v={select:["select",n,o&&"disabled",u&&"multiple",_&&"error"],icon:["icon",`icon${qn(n)}`,d&&"iconOpen",o&&"disabled"]};return ao(v,Xce,e)},WV=({ownerState:t,theme:e})=>We({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":We({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${wO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),eue=Hr("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Tc,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${wO.multiple}`]:e.multiple}]}})(WV),qV=({ownerState:t,theme:e})=>We({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${wO.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),tue=Hr("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${qn(n.variant)}`],n.open&&e.iconOpen]}})(qV),rue=fe.forwardRef(function(e,n){const{className:o,disabled:u,error:d,IconComponent:_,inputRef:v,variant:a="standard"}=e,C=tn(e,Qce),A=We({},e,{disabled:u,variant:a,error:d}),k=Jce(A);return Ke.jsxs(fe.Fragment,{children:[Ke.jsx(eue,We({ownerState:A,className:zn(k.select,o),disabled:u,ref:v||n},C)),e.multiple?null:Ke.jsx(tue,{as:_,ownerState:A,className:k.icon})]})});var p8;const nue=["children","classes","className","label","notched"],iue=Hr("fieldset",{shouldForwardProp:Tc})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),oue=Hr("legend",{shouldForwardProp:Tc})(({ownerState:t,theme:e})=>We({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&We({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function sue(t){const{className:e,label:n,notched:o}=t,u=tn(t,nue),d=n!=null&&n!=="",_=We({},t,{notched:o,withLabel:d});return Ke.jsx(iue,We({"aria-hidden":!0,className:e,ownerState:_},u,{children:Ke.jsx(oue,{ownerState:_,children:d?Ke.jsx("span",{children:n}):p8||(p8=Ke.jsx("span",{className:"notranslate",children:"​"}))})}))}const aue=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],lue=t=>{const{classes:e}=t,o=ao({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},lle,e);return We({},e,o)},cue=Hr(bA,{shouldForwardProp:t=>Tc(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:vA})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return We({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${wd.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${wd.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${wd.focused} .${wd.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${wd.error} .${wd.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${wd.disabled} .${wd.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&We({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),uue=Hr(sue,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),hue=Hr(wA,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:xA})(({theme:t,ownerState:e})=>We({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),CO=fe.forwardRef(function(e,n){var o,u,d,_,v;const a=Zi({props:e,name:"MuiOutlinedInput"}),{components:C={},fullWidth:A=!1,inputComponent:k="input",label:O,multiline:R=!1,notched:z,slots:N={},type:K="text"}=a,q=tn(a,aue),j=lue(a),H=k_(),Y=R_({props:a,muiFormControl:H,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),te=We({},a,{color:Y.color||"primary",disabled:Y.disabled,error:Y.error,focused:Y.focused,formControl:H,fullWidth:A,hiddenLabel:Y.hiddenLabel,multiline:R,size:Y.size,type:K}),J=(o=(u=N.root)!=null?u:C.Root)!=null?o:cue,ae=(d=(_=N.input)!=null?_:C.Input)!=null?d:hue;return Ke.jsx(vO,We({slots:{root:J,input:ae},renderSuffix:de=>Ke.jsx(uue,{ownerState:te,className:j.notchedOutline,label:O!=null&&O!==""&&Y.required?v||(v=Ke.jsxs(fe.Fragment,{children:[O," ","*"]})):O,notched:typeof z<"u"?z:!!(de.startAdornment||de.filled||de.focused)}),fullWidth:A,inputComponent:k,multiline:R,ref:n,type:K},q,{classes:We({},j,{notchedOutline:null})}))});CO.muiName="Input";function due(t){return Ki("MuiSelect",t)}const qv=Yi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var m8;const fue=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],pue=Hr("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${qv.select}`]:e.select},{[`&.${qv.select}`]:e[n.variant]},{[`&.${qv.error}`]:e.error},{[`&.${qv.multiple}`]:e.multiple}]}})(WV,{[`&.${qv.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),mue=Hr("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${qn(n.variant)}`],n.open&&e.iconOpen]}})(qV),gue=Hr("input",{shouldForwardProp:t=>OV(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function g8(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function _ue(t){return t==null||typeof t=="string"&&!t.trim()}const yue=t=>{const{classes:e,variant:n,disabled:o,multiple:u,open:d,error:_}=t,v={select:["select",n,o&&"disabled",u&&"multiple",_&&"error"],icon:["icon",`icon${qn(n)}`,d&&"iconOpen",o&&"disabled"],nativeInput:["nativeInput"]};return ao(v,due,e)},vue=fe.forwardRef(function(e,n){var o;const{"aria-describedby":u,"aria-label":d,autoFocus:_,autoWidth:v,children:a,className:C,defaultOpen:A,defaultValue:k,disabled:O,displayEmpty:R,error:z=!1,IconComponent:N,inputRef:K,labelId:q,MenuProps:j={},multiple:H,name:Y,onBlur:te,onChange:J,onClose:ae,onFocus:de,onOpen:Me,open:Ce,readOnly:Ae,renderValue:Ne,SelectDisplayProps:Re={},tabIndex:Ye,value:ht,variant:ft="standard"}=e,et=tn(e,fue),[Xe,Mt]=ON({controlled:ht,default:k,name:"Select"}),[Lt,nt]=ON({controlled:Ce,default:A,name:"Select"}),at=fe.useRef(null),it=fe.useRef(null),[tt,Jt]=fe.useState(null),{current:$t}=fe.useRef(Ce!=null),[Lr,rr]=fe.useState(),Zt=ra(n,K),dn=fe.useCallback(vr=>{it.current=vr,vr&&Jt(vr)},[]),dr=tt?.parentNode;fe.useImperativeHandle(Zt,()=>({focus:()=>{it.current.focus()},node:at.current,value:Xe}),[Xe]),fe.useEffect(()=>{A&&Lt&&tt&&!$t&&(rr(v?null:dr.clientWidth),it.current.focus())},[tt,v]),fe.useEffect(()=>{_&&it.current.focus()},[_]),fe.useEffect(()=>{if(!q)return;const vr=Za(it.current).getElementById(q);if(vr){const nn=()=>{getSelection().isCollapsed&&it.current.focus()};return vr.addEventListener("click",nn),()=>{vr.removeEventListener("click",nn)}}},[q]);const Ur=(vr,nn)=>{vr?Me&&Me(nn):ae&&ae(nn),$t||(rr(v?null:dr.clientWidth),nt(vr))},Tr=vr=>{vr.button===0&&(vr.preventDefault(),it.current.focus(),Ur(!0,vr))},wr=vr=>{Ur(!1,vr)},Er=fe.Children.toArray(a),Zn=vr=>{const nn=Er.find(Hn=>Hn.props.value===vr.target.value);nn!==void 0&&(Mt(nn.props.value),J&&J(vr,nn))},fn=vr=>nn=>{let Hn;if(nn.currentTarget.hasAttribute("tabindex")){if(H){Hn=Array.isArray(Xe)?Xe.slice():[];const cr=Xe.indexOf(vr.props.value);cr===-1?Hn.push(vr.props.value):Hn.splice(cr,1)}else Hn=vr.props.value;if(vr.props.onClick&&vr.props.onClick(nn),Xe!==Hn&&(Mt(Hn),J)){const cr=nn.nativeEvent||nn,Is=new cr.constructor(cr.type,cr);Object.defineProperty(Is,"target",{writable:!0,value:{value:Hn,name:Y}}),J(Is,vr)}H||Ur(!1,nn)}},pn=vr=>{Ae||[" ","ArrowUp","ArrowDown","Enter"].indexOf(vr.key)!==-1&&(vr.preventDefault(),Ur(!0,vr))},li=tt!==null&&Lt,or=vr=>{!li&&te&&(Object.defineProperty(vr,"target",{writable:!0,value:{value:Xe,name:Y}}),te(vr))};delete et["aria-invalid"];let Yt,un;const _n=[];let rn=!1;(fS({value:Xe})||R)&&(Ne?Yt=Ne(Xe):rn=!0);const ri=Er.map(vr=>{if(!fe.isValidElement(vr))return null;let nn;if(H){if(!Array.isArray(Xe))throw new Error(om(2));nn=Xe.some(Hn=>g8(Hn,vr.props.value)),nn&&rn&&_n.push(vr.props.children)}else nn=g8(Xe,vr.props.value),nn&&rn&&(un=vr.props.children);return fe.cloneElement(vr,{"aria-selected":nn?"true":"false",onClick:fn(vr),onKeyUp:Hn=>{Hn.key===" "&&Hn.preventDefault(),vr.props.onKeyUp&&vr.props.onKeyUp(Hn)},role:"option",selected:nn,value:void 0,"data-value":vr.props.value})});rn&&(H?_n.length===0?Yt=null:Yt=_n.reduce((vr,nn,Hn)=>(vr.push(nn),Hn<_n.length-1&&vr.push(", "),vr),[]):Yt=un);let Ln=Lr;!v&&$t&&tt&&(Ln=dr.clientWidth);let Vn;typeof Ye<"u"?Vn=Ye:Vn=O?null:0;const Xr=Re.id||(Y?`mui-component-select-${Y}`:void 0),yr=We({},e,{variant:ft,value:Xe,open:li,error:z}),xi=yue(yr),Ei=We({},j.PaperProps,(o=j.slotProps)==null?void 0:o.paper),$i=yV();return Ke.jsxs(fe.Fragment,{children:[Ke.jsx(pue,We({ref:dn,tabIndex:Vn,role:"combobox","aria-controls":$i,"aria-disabled":O?"true":void 0,"aria-expanded":li?"true":"false","aria-haspopup":"listbox","aria-label":d,"aria-labelledby":[q,Xr].filter(Boolean).join(" ")||void 0,"aria-describedby":u,onKeyDown:pn,onMouseDown:O||Ae?null:Tr,onBlur:or,onFocus:de},Re,{ownerState:yr,className:zn(Re.className,xi.select,C),id:Xr,children:_ue(Yt)?m8||(m8=Ke.jsx("span",{className:"notranslate",children:"​"})):Yt})),Ke.jsx(gue,We({"aria-invalid":z,value:Array.isArray(Xe)?Xe.join(","):Xe,name:Y,ref:at,"aria-hidden":!0,onChange:Zn,tabIndex:-1,disabled:O,className:xi.nativeInput,autoFocus:_,ownerState:yr},et)),Ke.jsx(mue,{as:N,className:xi.icon,ownerState:yr}),Ke.jsx(Zce,We({id:`menu-${Y||""}`,anchorEl:dr,open:li,onClose:wr,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},j,{MenuListProps:We({"aria-labelledby":q,role:"listbox","aria-multiselectable":H?"true":void 0,disableListWrap:!0,id:$i},j.MenuListProps),slotProps:We({},j.slotProps,{paper:We({},Ei,{style:We({minWidth:Ln},Ei!=null?Ei.style:null)})}),children:ri}))]})}),xue=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],bue=["root"],wue=t=>{const{classes:e}=t;return e},EO={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>Tc(t)&&t!=="variant",slot:"Root"},Cue=Hr(bO,EO)(""),Eue=Hr(CO,EO)(""),Sue=Hr(xO,EO)(""),KV=fe.forwardRef(function(e,n){const o=Zi({name:"MuiSelect",props:e}),{autoWidth:u=!1,children:d,classes:_={},className:v,defaultOpen:a=!1,displayEmpty:C=!1,IconComponent:A=ule,id:k,input:O,inputProps:R,label:z,labelId:N,MenuProps:K,multiple:q=!1,native:j=!1,onClose:H,onOpen:Y,open:te,renderValue:J,SelectDisplayProps:ae,variant:de="outlined"}=o,Me=tn(o,xue),Ce=j?rue:vue,Ae=k_(),Ne=R_({props:o,muiFormControl:Ae,states:["variant","error"]}),Re=Ne.variant||de,Ye=We({},o,{variant:Re,classes:_}),ht=wue(Ye),ft=tn(ht,bue),et=O||{standard:Ke.jsx(Cue,{ownerState:Ye}),outlined:Ke.jsx(Eue,{label:z,ownerState:Ye}),filled:Ke.jsx(Sue,{ownerState:Ye})}[Re],Xe=ra(n,et.ref);return Ke.jsx(fe.Fragment,{children:fe.cloneElement(et,We({inputComponent:Ce,inputProps:We({children:d,error:Ne.error,IconComponent:A,variant:Re,type:void 0,multiple:q},j?{id:k}:{autoWidth:u,defaultOpen:a,displayEmpty:C,labelId:N,MenuProps:K,onClose:H,onOpen:Y,open:te,renderValue:J,SelectDisplayProps:We({id:k},ae)},R,{classes:R?ta(ft,R.classes):ft},O?O.props.inputProps:{})},(q&&j||C)&&Re==="outlined"?{notched:!0}:{},{ref:Xe,className:zn(et.props.className,v,ht.root)},!O&&{variant:Re},Me))})});KV.muiName="Select";function Tue(t){return Ki("MuiTextField",t)}Yi("MuiTextField",["root"]);const Aue=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Iue={standard:bO,filled:xO,outlined:CO},Mue=t=>{const{classes:e}=t;return ao({root:["root"]},Tue,e)},Pue=Hr(rce,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Rue=fe.forwardRef(function(e,n){const o=Zi({props:e,name:"MuiTextField"}),{autoComplete:u,autoFocus:d=!1,children:_,className:v,color:a="primary",defaultValue:C,disabled:A=!1,error:k=!1,FormHelperTextProps:O,fullWidth:R=!1,helperText:z,id:N,InputLabelProps:K,inputProps:q,InputProps:j,inputRef:H,label:Y,maxRows:te,minRows:J,multiline:ae=!1,name:de,onBlur:Me,onChange:Ce,onFocus:Ae,placeholder:Ne,required:Re=!1,rows:Ye,select:ht=!1,SelectProps:ft,type:et,value:Xe,variant:Mt="outlined"}=o,Lt=tn(o,Aue),nt=We({},o,{autoFocus:d,color:a,disabled:A,error:k,fullWidth:R,multiline:ae,required:Re,select:ht,variant:Mt}),at=Mue(nt),it={};Mt==="outlined"&&(K&&typeof K.shrink<"u"&&(it.notched=K.shrink),it.label=Y),ht&&((!ft||!ft.native)&&(it.id=void 0),it["aria-describedby"]=void 0);const tt=yV(N),Jt=z&&tt?`${tt}-helper-text`:void 0,$t=Y&&tt?`${tt}-label`:void 0,Lr=Iue[Mt],rr=Ke.jsx(Lr,We({"aria-describedby":Jt,autoComplete:u,autoFocus:d,defaultValue:C,fullWidth:R,multiline:ae,name:de,rows:Ye,maxRows:te,minRows:J,type:et,value:Xe,id:tt,inputRef:H,onBlur:Me,onChange:Ce,onFocus:Ae,placeholder:Ne,inputProps:q},it,j));return Ke.jsxs(Pue,We({className:zn(at.root,v),disabled:A,error:k,fullWidth:R,ref:n,required:Re,color:a,variant:Mt,ownerState:nt},Lt,{children:[Y!=null&&Y!==""&&Ke.jsx(Sce,We({htmlFor:tt,id:$t},K,{children:Y})),ht?Ke.jsx(KV,We({"aria-describedby":Jt,id:tt,labelId:$t,value:Xe,input:rr},ft,{children:_})):rr,z&&Ke.jsx(lce,We({id:Jt},O,{children:z}))]}))});/**
 * @remix-run/router v1.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function to(){return to=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},to.apply(this,arguments)}var Bo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Bo||(Bo={}));const _8="popstate";function kue(t){t===void 0&&(t={});function e(u,d){let{pathname:_="/",search:v="",hash:a=""}=Eh(u.location.hash.substr(1));return!_.startsWith("/")&&!_.startsWith(".")&&(_="/"+_),g1("",{pathname:_,search:v,hash:a},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function n(u,d){let _=u.document.querySelector("base"),v="";if(_&&_.getAttribute("href")){let a=u.location.href,C=a.indexOf("#");v=C===-1?a:a.slice(0,C)}return v+"#"+(typeof d=="string"?d:V1(d))}function o(u,d){lm(u.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(d)+")")}return Oue(e,n,o,t)}function Fn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function lm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Due(){return Math.random().toString(36).substr(2,8)}function y8(t,e){return{usr:t.state,key:t.key,idx:e}}function g1(t,e,n,o){return n===void 0&&(n=null),to({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Eh(e):e,{state:n,key:e&&e.key||o||Due()})}function V1(t){let{pathname:e="/",search:n="",hash:o=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function Eh(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let o=t.indexOf("?");o>=0&&(e.search=t.substr(o),t=t.substr(0,o)),t&&(e.pathname=t)}return e}function Oue(t,e,n,o){o===void 0&&(o={});let{window:u=document.defaultView,v5Compat:d=!1}=o,_=u.history,v=Bo.Pop,a=null,C=A();C==null&&(C=0,_.replaceState(to({},_.state,{idx:C}),""));function A(){return(_.state||{idx:null}).idx}function k(){v=Bo.Pop;let K=A(),q=K==null?null:K-C;C=K,a&&a({action:v,location:N.location,delta:q})}function O(K,q){v=Bo.Push;let j=g1(N.location,K,q);n&&n(j,K),C=A()+1;let H=y8(j,C),Y=N.createHref(j);try{_.pushState(H,"",Y)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;u.location.assign(Y)}d&&a&&a({action:v,location:N.location,delta:1})}function R(K,q){v=Bo.Replace;let j=g1(N.location,K,q);n&&n(j,K),C=A();let H=y8(j,C),Y=N.createHref(j);_.replaceState(H,"",Y),d&&a&&a({action:v,location:N.location,delta:0})}function z(K){let q=u.location.origin!=="null"?u.location.origin:u.location.href,j=typeof K=="string"?K:V1(K);return j=j.replace(/ $/,"%20"),Fn(q,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,q)}let N={get action(){return v},get location(){return t(u,_)},listen(K){if(a)throw new Error("A history only accepts one active listener");return u.addEventListener(_8,k),a=K,()=>{u.removeEventListener(_8,k),a=null}},createHref(K){return e(u,K)},createURL:z,encodeLocation(K){let q=z(K);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:O,replace:R,go(K){return _.go(K)}};return N}var Di;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Di||(Di={}));const Lue=new Set(["lazy","caseSensitive","path","id","index","children"]);function Bue(t){return t.index===!0}function _1(t,e,n,o){return n===void 0&&(n=[]),o===void 0&&(o={}),t.map((u,d)=>{let _=[...n,String(d)],v=typeof u.id=="string"?u.id:_.join("-");if(Fn(u.index!==!0||!u.children,"Cannot specify children on an index route"),Fn(!o[v],'Found a route id collision on id "'+v+`".  Route id's must be globally unique within Data Router usages`),Bue(u)){let a=to({},u,e(u),{id:v});return o[v]=a,a}else{let a=to({},u,e(u),{id:v,children:void 0});return o[v]=a,u.children&&(a.children=_1(u.children,e,_,o)),a}})}function Dp(t,e,n){return n===void 0&&(n="/"),mE(t,e,n,!1)}function mE(t,e,n,o){let u=typeof e=="string"?Eh(e):e,d=H1(u.pathname||"/",n);if(d==null)return null;let _=YV(t);zue(_);let v=null;for(let a=0;v==null&&a<_.length;++a){let C=Yue(d);v=que(_[a],C,o)}return v}function Fue(t,e){let{route:n,pathname:o,params:u}=t;return{id:n.id,pathname:o,params:u,data:e[n.id],handle:n.handle}}function YV(t,e,n,o){e===void 0&&(e=[]),n===void 0&&(n=[]),o===void 0&&(o="");let u=(d,_,v)=>{let a={relativePath:v===void 0?d.path||"":v,caseSensitive:d.caseSensitive===!0,childrenIndex:_,route:d};a.relativePath.startsWith("/")&&(Fn(a.relativePath.startsWith(o),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(o.length));let C=Zd([o,a.relativePath]),A=n.concat(a);d.children&&d.children.length>0&&(Fn(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+C+'".')),YV(d.children,e,A,C)),!(d.path==null&&!d.index)&&e.push({path:C,score:Gue(C,d.index),routesMeta:A})};return t.forEach((d,_)=>{var v;if(d.path===""||!((v=d.path)!=null&&v.includes("?")))u(d,_);else for(let a of ZV(d.path))u(d,_,a)}),e}function ZV(t){let e=t.split("/");if(e.length===0)return[];let[n,...o]=e,u=n.endsWith("?"),d=n.replace(/\?$/,"");if(o.length===0)return u?[d,""]:[d];let _=ZV(o.join("/")),v=[];return v.push(..._.map(a=>a===""?d:[d,a].join("/"))),u&&v.push(..._),v.map(a=>t.startsWith("/")&&a===""?"/":a)}function zue(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Wue(e.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const Nue=/^:[\w-]+$/,Uue=3,$ue=2,jue=1,Vue=10,Hue=-2,v8=t=>t==="*";function Gue(t,e){let n=t.split("/"),o=n.length;return n.some(v8)&&(o+=Hue),e&&(o+=$ue),n.filter(u=>!v8(u)).reduce((u,d)=>u+(Nue.test(d)?Uue:d===""?jue:Vue),o)}function Wue(t,e){return t.length===e.length&&t.slice(0,-1).every((o,u)=>o===e[u])?t[t.length-1]-e[e.length-1]:0}function que(t,e,n){n===void 0&&(n=!1);let{routesMeta:o}=t,u={},d="/",_=[];for(let v=0;v<o.length;++v){let a=o[v],C=v===o.length-1,A=d==="/"?e:e.slice(d.length)||"/",k=x8({path:a.relativePath,caseSensitive:a.caseSensitive,end:C},A),O=a.route;if(!k&&C&&n&&!o[o.length-1].route.index&&(k=x8({path:a.relativePath,caseSensitive:a.caseSensitive,end:!1},A)),!k)return null;Object.assign(u,k.params),_.push({params:u,pathname:Zd([d,k.pathname]),pathnameBase:Que(Zd([d,k.pathnameBase])),route:O}),k.pathnameBase!=="/"&&(d=Zd([d,k.pathnameBase]))}return _}function x8(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,o]=Kue(t.path,t.caseSensitive,t.end),u=e.match(n);if(!u)return null;let d=u[0],_=d.replace(/(.)\/+$/,"$1"),v=u.slice(1);return{params:o.reduce((C,A,k)=>{let{paramName:O,isOptional:R}=A;if(O==="*"){let N=v[k]||"";_=d.slice(0,d.length-N.length).replace(/(.)\/+$/,"$1")}const z=v[k];return R&&!z?C[O]=void 0:C[O]=(z||"").replace(/%2F/g,"/"),C},{}),pathname:d,pathnameBase:_,pattern:t}}function Kue(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),lm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let o=[],u="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,v,a)=>(o.push({paramName:v,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(o.push({paramName:"*"}),u+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?u+="\\/*$":t!==""&&t!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,e?void 0:"i"),o]}function Yue(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lm(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function H1(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,o=t.charAt(n);return o&&o!=="/"?null:t.slice(n)||"/"}function Zue(t,e){e===void 0&&(e="/");let{pathname:n,search:o="",hash:u=""}=typeof t=="string"?Eh(t):t;return{pathname:n?n.startsWith("/")?n:Xue(n,e):e,search:Jue(o),hash:ehe(u)}}function Xue(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(u=>{u===".."?n.length>1&&n.pop():u!=="."&&n.push(u)}),n.length>1?n.join("/"):"/"}function KM(t,e,n,o){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XV(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function QV(t,e){let n=XV(t);return e?n.map((o,u)=>u===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function JV(t,e,n,o){o===void 0&&(o=!1);let u;typeof t=="string"?u=Eh(t):(u=to({},t),Fn(!u.pathname||!u.pathname.includes("?"),KM("?","pathname","search",u)),Fn(!u.pathname||!u.pathname.includes("#"),KM("#","pathname","hash",u)),Fn(!u.search||!u.search.includes("#"),KM("#","search","hash",u)));let d=t===""||u.pathname==="",_=d?"/":u.pathname,v;if(_==null)v=n;else{let k=e.length-1;if(!o&&_.startsWith("..")){let O=_.split("/");for(;O[0]==="..";)O.shift(),k-=1;u.pathname=O.join("/")}v=k>=0?e[k]:"/"}let a=Zue(u,v),C=_&&_!=="/"&&_.endsWith("/"),A=(d||_===".")&&n.endsWith("/");return!a.pathname.endsWith("/")&&(C||A)&&(a.pathname+="/"),a}const Zd=t=>t.join("/").replace(/\/\/+/g,"/"),Que=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Jue=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ehe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class SO{constructor(e,n,o,u){u===void 0&&(u=!1),this.status=e,this.statusText=n||"",this.internal=u,o instanceof Error?(this.data=o.toString(),this.error=o):this.data=o}}function EA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const eH=["post","put","patch","delete"],the=new Set(eH),rhe=["get",...eH],nhe=new Set(rhe),ihe=new Set([301,302,303,307,308]),ohe=new Set([307,308]),YM={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},she={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Kv={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},TO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ahe=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),tH="remix-router-transitions";function lhe(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",o=!n;Fn(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let u;if(t.mapRouteProperties)u=t.mapRouteProperties;else if(t.detectErrorBoundary){let Be=t.detectErrorBoundary;u=ze=>({hasErrorBoundary:Be(ze)})}else u=ahe;let d={},_=_1(t.routes,u,void 0,d),v,a=t.basename||"/",C=t.unstable_dataStrategy||fhe,A=t.unstable_patchRoutesOnMiss,k=to({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),O=null,R=new Set,z=null,N=null,K=null,q=t.hydrationData!=null,j=Dp(_,t.history.location,a),H=null;if(j==null&&!A){let Be=Xs(404,{pathname:t.history.location.pathname}),{matches:ze,route:lt}=P8(_);j=ze,H={[lt.id]:Be}}j&&A&&!t.hydrationData&&Ct(j,_,t.history.location.pathname).active&&(j=null);let Y;if(!j)Y=!1,j=[];else if(j.some(Be=>Be.route.lazy))Y=!1;else if(!j.some(Be=>Be.route.loader))Y=!0;else if(k.v7_partialHydration){let Be=t.hydrationData?t.hydrationData.loaderData:null,ze=t.hydrationData?t.hydrationData.errors:null,lt=mt=>mt.route.loader?typeof mt.route.loader=="function"&&mt.route.loader.hydrate===!0?!1:Be&&Be[mt.route.id]!==void 0||ze&&ze[mt.route.id]!==void 0:!0;if(ze){let mt=j.findIndex(qt=>ze[qt.route.id]!==void 0);Y=j.slice(0,mt+1).every(lt)}else Y=j.every(lt)}else Y=t.hydrationData!=null;let te,J={historyAction:t.history.action,location:t.history.location,matches:j,initialized:Y,navigation:YM,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||H,fetchers:new Map,blockers:new Map},ae=Bo.Pop,de=!1,Me,Ce=!1,Ae=new Map,Ne=null,Re=!1,Ye=!1,ht=[],ft=[],et=new Map,Xe=0,Mt=-1,Lt=new Map,nt=new Set,at=new Map,it=new Map,tt=new Set,Jt=new Map,$t=new Map,Lr=new Map,rr=!1;function Zt(){if(O=t.history.listen(Be=>{let{action:ze,location:lt,delta:mt}=Be;if(rr){rr=!1;return}lm($t.size===0||mt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let qt=_o({currentLocation:J.location,nextLocation:lt,historyAction:ze});if(qt&&mt!=null){rr=!0,t.history.go(mt*-1),Xi(qt,{state:"blocked",location:lt,proceed(){Xi(qt,{state:"proceeding",proceed:void 0,reset:void 0,location:lt}),t.history.go(mt)},reset(){let ar=new Map(J.blockers);ar.set(qt,Kv),Ur({blockers:ar})}});return}return Zn(ze,lt)}),n){The(e,Ae);let Be=()=>Ahe(e,Ae);e.addEventListener("pagehide",Be),Ne=()=>e.removeEventListener("pagehide",Be)}return J.initialized||Zn(Bo.Pop,J.location,{initialHydration:!0}),te}function dn(){O&&O(),Ne&&Ne(),R.clear(),Me&&Me.abort(),J.fetchers.forEach((Be,ze)=>Ei(ze)),J.blockers.forEach((Be,ze)=>Mn(ze))}function dr(Be){return R.add(Be),()=>R.delete(Be)}function Ur(Be,ze){ze===void 0&&(ze={}),J=to({},J,Be);let lt=[],mt=[];k.v7_fetcherPersist&&J.fetchers.forEach((qt,ar)=>{qt.state==="idle"&&(tt.has(ar)?mt.push(ar):lt.push(ar))}),[...R].forEach(qt=>qt(J,{deletedFetchers:mt,unstable_viewTransitionOpts:ze.viewTransitionOpts,unstable_flushSync:ze.flushSync===!0})),k.v7_fetcherPersist&&(lt.forEach(qt=>J.fetchers.delete(qt)),mt.forEach(qt=>Ei(qt)))}function Tr(Be,ze,lt){var mt,qt;let{flushSync:ar}=lt===void 0?{}:lt,gr=J.actionData!=null&&J.navigation.formMethod!=null&&hc(J.navigation.formMethod)&&J.navigation.state==="loading"&&((mt=Be.state)==null?void 0:mt._isRedirect)!==!0,xe;ze.actionData?Object.keys(ze.actionData).length>0?xe=ze.actionData:xe=null:gr?xe=J.actionData:xe=null;let X=ze.loaderData?I8(J.loaderData,ze.loaderData,ze.matches||[],ze.errors):J.loaderData,re=J.blockers;re.size>0&&(re=new Map(re),re.forEach((Ie,Oe)=>re.set(Oe,Kv)));let le=de===!0||J.navigation.formMethod!=null&&hc(J.navigation.formMethod)&&((qt=Be.state)==null?void 0:qt._isRedirect)!==!0;v&&(_=v,v=void 0),Re||ae===Bo.Pop||(ae===Bo.Push?t.history.push(Be,Be.state):ae===Bo.Replace&&t.history.replace(Be,Be.state));let we;if(ae===Bo.Pop){let Ie=Ae.get(J.location.pathname);Ie&&Ie.has(Be.pathname)?we={currentLocation:J.location,nextLocation:Be}:Ae.has(Be.pathname)&&(we={currentLocation:Be,nextLocation:J.location})}else if(Ce){let Ie=Ae.get(J.location.pathname);Ie?Ie.add(Be.pathname):(Ie=new Set([Be.pathname]),Ae.set(J.location.pathname,Ie)),we={currentLocation:J.location,nextLocation:Be}}Ur(to({},ze,{actionData:xe,loaderData:X,historyAction:ae,location:Be,initialized:!0,navigation:YM,revalidation:"idle",restoreScrollPosition:Vt(Be,ze.matches||J.matches),preventScrollReset:le,blockers:re}),{viewTransitionOpts:we,flushSync:ar===!0}),ae=Bo.Pop,de=!1,Ce=!1,Re=!1,Ye=!1,ht=[],ft=[]}async function wr(Be,ze){if(typeof Be=="number"){t.history.go(Be);return}let lt=Rk(J.location,J.matches,a,k.v7_prependBasename,Be,k.v7_relativeSplatPath,ze?.fromRouteId,ze?.relative),{path:mt,submission:qt,error:ar}=b8(k.v7_normalizeFormMethod,!1,lt,ze),gr=J.location,xe=g1(J.location,mt,ze&&ze.state);xe=to({},xe,t.history.encodeLocation(xe));let X=ze&&ze.replace!=null?ze.replace:void 0,re=Bo.Push;X===!0?re=Bo.Replace:X===!1||qt!=null&&hc(qt.formMethod)&&qt.formAction===J.location.pathname+J.location.search&&(re=Bo.Replace);let le=ze&&"preventScrollReset"in ze?ze.preventScrollReset===!0:void 0,we=(ze&&ze.unstable_flushSync)===!0,Ie=_o({currentLocation:gr,nextLocation:xe,historyAction:re});if(Ie){Xi(Ie,{state:"blocked",location:xe,proceed(){Xi(Ie,{state:"proceeding",proceed:void 0,reset:void 0,location:xe}),wr(Be,ze)},reset(){let Oe=new Map(J.blockers);Oe.set(Ie,Kv),Ur({blockers:Oe})}});return}return await Zn(re,xe,{submission:qt,pendingError:ar,preventScrollReset:le,replace:ze&&ze.replace,enableViewTransition:ze&&ze.unstable_viewTransition,flushSync:we})}function Er(){if(Vn(),Ur({revalidation:"loading"}),J.navigation.state!=="submitting"){if(J.navigation.state==="idle"){Zn(J.historyAction,J.location,{startUninterruptedRevalidation:!0});return}Zn(ae||J.historyAction,J.navigation.location,{overrideNavigation:J.navigation})}}async function Zn(Be,ze,lt){Me&&Me.abort(),Me=null,ae=Be,Re=(lt&&lt.startUninterruptedRevalidation)===!0,Je(J.location,J.matches),de=(lt&&lt.preventScrollReset)===!0,Ce=(lt&&lt.enableViewTransition)===!0;let mt=v||_,qt=lt&&lt.overrideNavigation,ar=Dp(mt,ze,a),gr=(lt&&lt.flushSync)===!0,xe=Ct(ar,mt,ze.pathname);if(xe.active&&xe.matches&&(ar=xe.matches),!ar){let{error:$e,notFoundMatches:Fe,route:qe}=ci(ze.pathname);Tr(ze,{matches:Fe,loaderData:{},errors:{[qe.id]:$e}},{flushSync:gr});return}if(J.initialized&&!Ye&&vhe(J.location,ze)&&!(lt&&lt.submission&&hc(lt.submission.formMethod))){Tr(ze,{matches:ar},{flushSync:gr});return}Me=new AbortController;let X=q0(t.history,ze,Me.signal,lt&&lt.submission),re;if(lt&&lt.pendingError)re=[xg(ar).route.id,{type:Di.error,error:lt.pendingError}];else if(lt&&lt.submission&&hc(lt.submission.formMethod)){let $e=await fn(X,ze,lt.submission,ar,xe.active,{replace:lt.replace,flushSync:gr});if($e.shortCircuited)return;if($e.pendingActionResult){let[Fe,qe]=$e.pendingActionResult;if(Na(qe)&&EA(qe.error)&&qe.error.status===404){Me=null,Tr(ze,{matches:$e.matches,loaderData:{},errors:{[Fe]:qe.error}});return}}ar=$e.matches||ar,re=$e.pendingActionResult,qt=ZM(ze,lt.submission),gr=!1,xe.active=!1,X=q0(t.history,X.url,X.signal)}let{shortCircuited:le,matches:we,loaderData:Ie,errors:Oe}=await pn(X,ze,ar,xe.active,qt,lt&&lt.submission,lt&&lt.fetcherSubmission,lt&&lt.replace,lt&&lt.initialHydration===!0,gr,re);le||(Me=null,Tr(ze,to({matches:we||ar},M8(re),{loaderData:Ie,errors:Oe})))}async function fn(Be,ze,lt,mt,qt,ar){ar===void 0&&(ar={}),Vn();let gr=Ehe(ze,lt);if(Ur({navigation:gr},{flushSync:ar.flushSync===!0}),qt){let re=await Wt(mt,ze.pathname,Be.signal);if(re.type==="aborted")return{shortCircuited:!0};if(re.type==="error"){let{boundaryId:le,error:we}=Bi(ze.pathname,re);return{matches:re.partialMatches,pendingActionResult:[le,{type:Di.error,error:we}]}}else if(re.matches)mt=re.matches;else{let{notFoundMatches:le,error:we,route:Ie}=ci(ze.pathname);return{matches:le,pendingActionResult:[Ie.id,{type:Di.error,error:we}]}}}let xe,X=cx(mt,ze);if(!X.route.action&&!X.route.lazy)xe={type:Di.error,error:Xs(405,{method:Be.method,pathname:ze.pathname,routeId:X.route.id})};else if(xe=(await ri("action",Be,[X],mt))[0],Be.signal.aborted)return{shortCircuited:!0};if(Up(xe)){let re;return ar&&ar.replace!=null?re=ar.replace:re=S8(xe.response.headers.get("Location"),new URL(Be.url),a)===J.location.pathname+J.location.search,await rn(Be,xe,{submission:lt,replace:re}),{shortCircuited:!0}}if(Np(xe))throw Xs(400,{type:"defer-action"});if(Na(xe)){let re=xg(mt,X.route.id);return(ar&&ar.replace)!==!0&&(ae=Bo.Push),{matches:mt,pendingActionResult:[re.route.id,xe]}}return{matches:mt,pendingActionResult:[X.route.id,xe]}}async function pn(Be,ze,lt,mt,qt,ar,gr,xe,X,re,le){let we=qt||ZM(ze,ar),Ie=ar||gr||D8(we),Oe=!Re&&(!k.v7_partialHydration||!X);if(mt){if(Oe){let Dr=li(le);Ur(to({navigation:we},Dr!==void 0?{actionData:Dr}:{}),{flushSync:re})}let xr=await Wt(lt,ze.pathname,Be.signal);if(xr.type==="aborted")return{shortCircuited:!0};if(xr.type==="error"){let{boundaryId:Dr,error:zr}=Bi(ze.pathname,xr);return{matches:xr.partialMatches,loaderData:{},errors:{[Dr]:zr}}}else if(xr.matches)lt=xr.matches;else{let{error:Dr,notFoundMatches:zr,route:Jr}=ci(ze.pathname);return{matches:zr,loaderData:{},errors:{[Jr.id]:Dr}}}}let $e=v||_,[Fe,qe]=w8(t.history,J,lt,Ie,ze,k.v7_partialHydration&&X===!0,k.v7_skipActionErrorRevalidation,Ye,ht,ft,tt,at,nt,$e,a,le);if(Ms(xr=>!(lt&&lt.some(Dr=>Dr.route.id===xr))||Fe&&Fe.some(Dr=>Dr.route.id===xr)),Mt=++Xe,Fe.length===0&&qe.length===0){let xr=Hn();return Tr(ze,to({matches:lt,loaderData:{},errors:le&&Na(le[1])?{[le[0]]:le[1].error}:null},M8(le),xr?{fetchers:new Map(J.fetchers)}:{}),{flushSync:re}),{shortCircuited:!0}}if(Oe){let xr={};if(!mt){xr.navigation=we;let Dr=li(le);Dr!==void 0&&(xr.actionData=Dr)}qe.length>0&&(xr.fetchers=or(qe)),Ur(xr,{flushSync:re})}qe.forEach(xr=>{et.has(xr.key)&&vr(xr.key),xr.controller&&et.set(xr.key,xr.controller)});let kt=()=>qe.forEach(xr=>vr(xr.key));Me&&Me.signal.addEventListener("abort",kt);let{loaderResults:Et,fetcherResults:er}=await Ln(J.matches,lt,Fe,qe,Be);if(Be.signal.aborted)return{shortCircuited:!0};Me&&Me.signal.removeEventListener("abort",kt),qe.forEach(xr=>et.delete(xr.key));let pr=R8([...Et,...er]);if(pr){if(pr.idx>=Fe.length){let xr=qe[pr.idx-Fe.length].key;nt.add(xr)}return await rn(Be,pr.result,{replace:xe}),{shortCircuited:!0}}let{loaderData:kr,errors:Pr}=A8(J,lt,Fe,Et,le,qe,er,Jt);Jt.forEach((xr,Dr)=>{xr.subscribe(zr=>{(zr||xr.done)&&Jt.delete(Dr)})}),k.v7_partialHydration&&X&&J.errors&&Object.entries(J.errors).filter(xr=>{let[Dr]=xr;return!Fe.some(zr=>zr.route.id===Dr)}).forEach(xr=>{let[Dr,zr]=xr;Pr=Object.assign(Pr||{},{[Dr]:zr})});let Ar=Hn(),Yr=cr(Mt),Qt=Ar||Yr||qe.length>0;return to({matches:lt,loaderData:kr,errors:Pr},Qt?{fetchers:new Map(J.fetchers)}:{})}function li(Be){if(Be&&!Na(Be[1]))return{[Be[0]]:Be[1].data};if(J.actionData)return Object.keys(J.actionData).length===0?null:J.actionData}function or(Be){return Be.forEach(ze=>{let lt=J.fetchers.get(ze.key),mt=Yv(void 0,lt?lt.data:void 0);J.fetchers.set(ze.key,mt)}),new Map(J.fetchers)}function Yt(Be,ze,lt,mt){if(o)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");et.has(Be)&&vr(Be);let qt=(mt&&mt.unstable_flushSync)===!0,ar=v||_,gr=Rk(J.location,J.matches,a,k.v7_prependBasename,lt,k.v7_relativeSplatPath,ze,mt?.relative),xe=Dp(ar,gr,a),X=Ct(xe,ar,gr);if(X.active&&X.matches&&(xe=X.matches),!xe){yr(Be,ze,Xs(404,{pathname:gr}),{flushSync:qt});return}let{path:re,submission:le,error:we}=b8(k.v7_normalizeFormMethod,!0,gr,mt);if(we){yr(Be,ze,we,{flushSync:qt});return}let Ie=cx(xe,re);if(de=(mt&&mt.preventScrollReset)===!0,le&&hc(le.formMethod)){un(Be,ze,re,Ie,xe,X.active,qt,le);return}at.set(Be,{routeId:ze,path:re}),_n(Be,ze,re,Ie,xe,X.active,qt,le)}async function un(Be,ze,lt,mt,qt,ar,gr,xe){Vn(),at.delete(Be);function X(Jr){if(!Jr.route.action&&!Jr.route.lazy){let An=Xs(405,{method:xe.formMethod,pathname:lt,routeId:ze});return yr(Be,ze,An,{flushSync:gr}),!0}return!1}if(!ar&&X(mt))return;let re=J.fetchers.get(Be);Xr(Be,She(xe,re),{flushSync:gr});let le=new AbortController,we=q0(t.history,lt,le.signal,xe);if(ar){let Jr=await Wt(qt,lt,we.signal);if(Jr.type==="aborted")return;if(Jr.type==="error"){let{error:An}=Bi(lt,Jr);yr(Be,ze,An,{flushSync:gr});return}else if(Jr.matches){if(qt=Jr.matches,mt=cx(qt,lt),X(mt))return}else{yr(Be,ze,Xs(404,{pathname:lt}),{flushSync:gr});return}}et.set(Be,le);let Ie=Xe,$e=(await ri("action",we,[mt],qt))[0];if(we.signal.aborted){et.get(Be)===le&&et.delete(Be);return}if(k.v7_fetcherPersist&&tt.has(Be)){if(Up($e)||Na($e)){Xr(Be,Ad(void 0));return}}else{if(Up($e))if(et.delete(Be),Mt>Ie){Xr(Be,Ad(void 0));return}else return nt.add(Be),Xr(Be,Yv(xe)),rn(we,$e,{fetcherSubmission:xe});if(Na($e)){yr(Be,ze,$e.error);return}}if(Np($e))throw Xs(400,{type:"defer-action"});let Fe=J.navigation.location||J.location,qe=q0(t.history,Fe,le.signal),kt=v||_,Et=J.navigation.state!=="idle"?Dp(kt,J.navigation.location,a):J.matches;Fn(Et,"Didn't find any matches after fetcher action");let er=++Xe;Lt.set(Be,er);let pr=Yv(xe,$e.data);J.fetchers.set(Be,pr);let[kr,Pr]=w8(t.history,J,Et,xe,Fe,!1,k.v7_skipActionErrorRevalidation,Ye,ht,ft,tt,at,nt,kt,a,[mt.route.id,$e]);Pr.filter(Jr=>Jr.key!==Be).forEach(Jr=>{let An=Jr.key,Si=J.fetchers.get(An),yo=Yv(void 0,Si?Si.data:void 0);J.fetchers.set(An,yo),et.has(An)&&vr(An),Jr.controller&&et.set(An,Jr.controller)}),Ur({fetchers:new Map(J.fetchers)});let Ar=()=>Pr.forEach(Jr=>vr(Jr.key));le.signal.addEventListener("abort",Ar);let{loaderResults:Yr,fetcherResults:Qt}=await Ln(J.matches,Et,kr,Pr,qe);if(le.signal.aborted)return;le.signal.removeEventListener("abort",Ar),Lt.delete(Be),et.delete(Be),Pr.forEach(Jr=>et.delete(Jr.key));let xr=R8([...Yr,...Qt]);if(xr){if(xr.idx>=kr.length){let Jr=Pr[xr.idx-kr.length].key;nt.add(Jr)}return rn(qe,xr.result)}let{loaderData:Dr,errors:zr}=A8(J,J.matches,kr,Yr,void 0,Pr,Qt,Jt);if(J.fetchers.has(Be)){let Jr=Ad($e.data);J.fetchers.set(Be,Jr)}cr(er),J.navigation.state==="loading"&&er>Mt?(Fn(ae,"Expected pending action"),Me&&Me.abort(),Tr(J.navigation.location,{matches:Et,loaderData:Dr,errors:zr,fetchers:new Map(J.fetchers)})):(Ur({errors:zr,loaderData:I8(J.loaderData,Dr,Et,zr),fetchers:new Map(J.fetchers)}),Ye=!1)}async function _n(Be,ze,lt,mt,qt,ar,gr,xe){let X=J.fetchers.get(Be);Xr(Be,Yv(xe,X?X.data:void 0),{flushSync:gr});let re=new AbortController,le=q0(t.history,lt,re.signal);if(ar){let $e=await Wt(qt,lt,le.signal);if($e.type==="aborted")return;if($e.type==="error"){let{error:Fe}=Bi(lt,$e);yr(Be,ze,Fe,{flushSync:gr});return}else if($e.matches)qt=$e.matches,mt=cx(qt,lt);else{yr(Be,ze,Xs(404,{pathname:lt}),{flushSync:gr});return}}et.set(Be,re);let we=Xe,Oe=(await ri("loader",le,[mt],qt))[0];if(Np(Oe)&&(Oe=await sH(Oe,le.signal,!0)||Oe),et.get(Be)===re&&et.delete(Be),!le.signal.aborted){if(tt.has(Be)){Xr(Be,Ad(void 0));return}if(Up(Oe))if(Mt>we){Xr(Be,Ad(void 0));return}else{nt.add(Be),await rn(le,Oe);return}if(Na(Oe)){yr(Be,ze,Oe.error);return}Fn(!Np(Oe),"Unhandled fetcher deferred data"),Xr(Be,Ad(Oe.data))}}async function rn(Be,ze,lt){let{submission:mt,fetcherSubmission:qt,replace:ar}=lt===void 0?{}:lt;ze.response.headers.has("X-Remix-Revalidate")&&(Ye=!0);let gr=ze.response.headers.get("Location");Fn(gr,"Expected a Location header on the redirect Response"),gr=S8(gr,new URL(Be.url),a);let xe=g1(J.location,gr,{_isRedirect:!0});if(n){let Oe=!1;if(ze.response.headers.has("X-Remix-Reload-Document"))Oe=!0;else if(TO.test(gr)){const $e=t.history.createURL(gr);Oe=$e.origin!==e.location.origin||H1($e.pathname,a)==null}if(Oe){ar?e.location.replace(gr):e.location.assign(gr);return}}Me=null;let X=ar===!0?Bo.Replace:Bo.Push,{formMethod:re,formAction:le,formEncType:we}=J.navigation;!mt&&!qt&&re&&le&&we&&(mt=D8(J.navigation));let Ie=mt||qt;if(ohe.has(ze.response.status)&&Ie&&hc(Ie.formMethod))await Zn(X,xe,{submission:to({},Ie,{formAction:gr}),preventScrollReset:de});else{let Oe=ZM(xe,mt);await Zn(X,xe,{overrideNavigation:Oe,fetcherSubmission:qt,preventScrollReset:de})}}async function ri(Be,ze,lt,mt){try{let qt=await phe(C,Be,ze,lt,mt,d,u);return await Promise.all(qt.map((ar,gr)=>{if(bhe(ar)){let xe=ar.result;return{type:Di.redirect,response:_he(xe,ze,lt[gr].route.id,mt,a,k.v7_relativeSplatPath)}}return ghe(ar)}))}catch(qt){return lt.map(()=>({type:Di.error,error:qt}))}}async function Ln(Be,ze,lt,mt,qt){let[ar,...gr]=await Promise.all([lt.length?ri("loader",qt,lt,ze):[],...mt.map(xe=>{if(xe.matches&&xe.match&&xe.controller){let X=q0(t.history,xe.path,xe.controller.signal);return ri("loader",X,[xe.match],xe.matches).then(re=>re[0])}else return Promise.resolve({type:Di.error,error:Xs(404,{pathname:xe.path})})})]);return await Promise.all([k8(Be,lt,ar,ar.map(()=>qt.signal),!1,J.loaderData),k8(Be,mt.map(xe=>xe.match),gr,mt.map(xe=>xe.controller?xe.controller.signal:null),!0)]),{loaderResults:ar,fetcherResults:gr}}function Vn(){Ye=!0,ht.push(...Ms()),at.forEach((Be,ze)=>{et.has(ze)&&(ft.push(ze),vr(ze))})}function Xr(Be,ze,lt){lt===void 0&&(lt={}),J.fetchers.set(Be,ze),Ur({fetchers:new Map(J.fetchers)},{flushSync:(lt&&lt.flushSync)===!0})}function yr(Be,ze,lt,mt){mt===void 0&&(mt={});let qt=xg(J.matches,ze);Ei(Be),Ur({errors:{[qt.route.id]:lt},fetchers:new Map(J.fetchers)},{flushSync:(mt&&mt.flushSync)===!0})}function xi(Be){return k.v7_fetcherPersist&&(it.set(Be,(it.get(Be)||0)+1),tt.has(Be)&&tt.delete(Be)),J.fetchers.get(Be)||she}function Ei(Be){let ze=J.fetchers.get(Be);et.has(Be)&&!(ze&&ze.state==="loading"&&Lt.has(Be))&&vr(Be),at.delete(Be),Lt.delete(Be),nt.delete(Be),tt.delete(Be),J.fetchers.delete(Be)}function $i(Be){if(k.v7_fetcherPersist){let ze=(it.get(Be)||0)-1;ze<=0?(it.delete(Be),tt.add(Be)):it.set(Be,ze)}else Ei(Be);Ur({fetchers:new Map(J.fetchers)})}function vr(Be){let ze=et.get(Be);Fn(ze,"Expected fetch controller: "+Be),ze.abort(),et.delete(Be)}function nn(Be){for(let ze of Be){let lt=xi(ze),mt=Ad(lt.data);J.fetchers.set(ze,mt)}}function Hn(){let Be=[],ze=!1;for(let lt of nt){let mt=J.fetchers.get(lt);Fn(mt,"Expected fetcher: "+lt),mt.state==="loading"&&(nt.delete(lt),Be.push(lt),ze=!0)}return nn(Be),ze}function cr(Be){let ze=[];for(let[lt,mt]of Lt)if(mt<Be){let qt=J.fetchers.get(lt);Fn(qt,"Expected fetcher: "+lt),qt.state==="loading"&&(vr(lt),Lt.delete(lt),ze.push(lt))}return nn(ze),ze.length>0}function Is(Be,ze){let lt=J.blockers.get(Be)||Kv;return $t.get(Be)!==ze&&$t.set(Be,ze),lt}function Mn(Be){J.blockers.delete(Be),$t.delete(Be)}function Xi(Be,ze){let lt=J.blockers.get(Be)||Kv;Fn(lt.state==="unblocked"&&ze.state==="blocked"||lt.state==="blocked"&&ze.state==="blocked"||lt.state==="blocked"&&ze.state==="proceeding"||lt.state==="blocked"&&ze.state==="unblocked"||lt.state==="proceeding"&&ze.state==="unblocked","Invalid blocker state transition: "+lt.state+" -> "+ze.state);let mt=new Map(J.blockers);mt.set(Be,ze),Ur({blockers:mt})}function _o(Be){let{currentLocation:ze,nextLocation:lt,historyAction:mt}=Be;if($t.size===0)return;$t.size>1&&lm(!1,"A router only supports one blocker at a time");let qt=Array.from($t.entries()),[ar,gr]=qt[qt.length-1],xe=J.blockers.get(ar);if(!(xe&&xe.state==="proceeding")&&gr({currentLocation:ze,nextLocation:lt,historyAction:mt}))return ar}function ci(Be){let ze=Xs(404,{pathname:Be}),lt=v||_,{matches:mt,route:qt}=P8(lt);return Ms(),{notFoundMatches:mt,route:qt,error:ze}}function Bi(Be,ze){return{boundaryId:xg(ze.partialMatches).route.id,error:Xs(400,{type:"route-discovery",pathname:Be,message:ze.error!=null&&"message"in ze.error?ze.error:String(ze.error)})}}function Ms(Be){let ze=[];return Jt.forEach((lt,mt)=>{(!Be||Be(mt))&&(lt.cancel(),ze.push(mt),Jt.delete(mt))}),ze}function fs(Be,ze,lt){if(z=Be,K=ze,N=lt||null,!q&&J.navigation===YM){q=!0;let mt=Vt(J.location,J.matches);mt!=null&&Ur({restoreScrollPosition:mt})}return()=>{z=null,K=null,N=null}}function Cr(Be,ze){return N&&N(Be,ze.map(mt=>Fue(mt,J.loaderData)))||Be.key}function Je(Be,ze){if(z&&K){let lt=Cr(Be,ze);z[lt]=K()}}function Vt(Be,ze){if(z){let lt=Cr(Be,ze),mt=z[lt];if(typeof mt=="number")return mt}return null}function Ct(Be,ze,lt){if(A)if(Be){let mt=Be[Be.length-1].route;if(mt.path&&(mt.path==="*"||mt.path.endsWith("/*")))return{active:!0,matches:mE(ze,lt,a,!0)}}else return{active:!0,matches:mE(ze,lt,a,!0)||[]};return{active:!1,matches:null}}async function Wt(Be,ze,lt){let mt=Be,qt=mt.length>0?mt[mt.length-1].route:null;for(;;){let ar=v==null,gr=v||_;try{await dhe(A,ze,mt,gr,d,u,Lr,lt)}catch(le){return{type:"error",error:le,partialMatches:mt}}finally{ar&&(_=[..._])}if(lt.aborted)return{type:"aborted"};let xe=Dp(gr,ze,a),X=!1;if(xe){let le=xe[xe.length-1].route;if(le.index)return{type:"success",matches:xe};if(le.path&&le.path.length>0)if(le.path==="*")X=!0;else return{type:"success",matches:xe}}let re=mE(gr,ze,a,!0);if(!re||mt.map(le=>le.route.id).join("-")===re.map(le=>le.route.id).join("-"))return{type:"success",matches:X?xe:null};if(mt=re,qt=mt[mt.length-1].route,qt.path==="*")return{type:"success",matches:mt}}}function ir(Be){d={},v=_1(Be,u,void 0,d)}function ur(Be,ze){let lt=v==null;nH(Be,ze,v||_,d,u),lt&&(_=[..._],Ur({}))}return te={get basename(){return a},get future(){return k},get state(){return J},get routes(){return _},get window(){return e},initialize:Zt,subscribe:dr,enableScrollRestoration:fs,navigate:wr,fetch:Yt,revalidate:Er,createHref:Be=>t.history.createHref(Be),encodeLocation:Be=>t.history.encodeLocation(Be),getFetcher:xi,deleteFetcher:$i,dispose:dn,getBlocker:Is,deleteBlocker:Mn,patchRoutes:ur,_internalFetchControllers:et,_internalActiveDeferreds:Jt,_internalSetRoutes:ir},te}function che(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Rk(t,e,n,o,u,d,_,v){let a,C;if(_){a=[];for(let k of e)if(a.push(k),k.route.id===_){C=k;break}}else a=e,C=e[e.length-1];let A=JV(u||".",QV(a,d),H1(t.pathname,n)||t.pathname,v==="path");return u==null&&(A.search=t.search,A.hash=t.hash),(u==null||u===""||u===".")&&C&&C.route.index&&!AO(A.search)&&(A.search=A.search?A.search.replace(/^\?/,"?index&"):"?index"),o&&n!=="/"&&(A.pathname=A.pathname==="/"?n:Zd([n,A.pathname])),V1(A)}function b8(t,e,n,o){if(!o||!che(o))return{path:n};if(o.formMethod&&!Che(o.formMethod))return{path:n,error:Xs(405,{method:o.formMethod})};let u=()=>({path:n,error:Xs(400,{type:"invalid-body"})}),d=o.formMethod||"get",_=t?d.toUpperCase():d.toLowerCase(),v=iH(n);if(o.body!==void 0){if(o.formEncType==="text/plain"){if(!hc(_))return u();let O=typeof o.body=="string"?o.body:o.body instanceof FormData||o.body instanceof URLSearchParams?Array.from(o.body.entries()).reduce((R,z)=>{let[N,K]=z;return""+R+N+"="+K+`
`},""):String(o.body);return{path:n,submission:{formMethod:_,formAction:v,formEncType:o.formEncType,formData:void 0,json:void 0,text:O}}}else if(o.formEncType==="application/json"){if(!hc(_))return u();try{let O=typeof o.body=="string"?JSON.parse(o.body):o.body;return{path:n,submission:{formMethod:_,formAction:v,formEncType:o.formEncType,formData:void 0,json:O,text:void 0}}}catch{return u()}}}Fn(typeof FormData=="function","FormData is not available in this environment");let a,C;if(o.formData)a=kk(o.formData),C=o.formData;else if(o.body instanceof FormData)a=kk(o.body),C=o.body;else if(o.body instanceof URLSearchParams)a=o.body,C=T8(a);else if(o.body==null)a=new URLSearchParams,C=new FormData;else try{a=new URLSearchParams(o.body),C=T8(a)}catch{return u()}let A={formMethod:_,formAction:v,formEncType:o&&o.formEncType||"application/x-www-form-urlencoded",formData:C,json:void 0,text:void 0};if(hc(A.formMethod))return{path:n,submission:A};let k=Eh(n);return e&&k.search&&AO(k.search)&&a.append("index",""),k.search="?"+a,{path:V1(k),submission:A}}function uhe(t,e){let n=t;if(e){let o=t.findIndex(u=>u.route.id===e);o>=0&&(n=t.slice(0,o))}return n}function w8(t,e,n,o,u,d,_,v,a,C,A,k,O,R,z,N){let K=N?Na(N[1])?N[1].error:N[1].data:void 0,q=t.createURL(e.location),j=t.createURL(u),H=N&&Na(N[1])?N[0]:void 0,Y=H?uhe(n,H):n,te=N?N[1].statusCode:void 0,J=_&&te&&te>=400,ae=Y.filter((Me,Ce)=>{let{route:Ae}=Me;if(Ae.lazy)return!0;if(Ae.loader==null)return!1;if(d)return typeof Ae.loader!="function"||Ae.loader.hydrate?!0:e.loaderData[Ae.id]===void 0&&(!e.errors||e.errors[Ae.id]===void 0);if(hhe(e.loaderData,e.matches[Ce],Me)||a.some(Ye=>Ye===Me.route.id))return!0;let Ne=e.matches[Ce],Re=Me;return C8(Me,to({currentUrl:q,currentParams:Ne.params,nextUrl:j,nextParams:Re.params},o,{actionResult:K,actionStatus:te,defaultShouldRevalidate:J?!1:v||q.pathname+q.search===j.pathname+j.search||q.search!==j.search||rH(Ne,Re)}))}),de=[];return k.forEach((Me,Ce)=>{if(d||!n.some(ht=>ht.route.id===Me.routeId)||A.has(Ce))return;let Ae=Dp(R,Me.path,z);if(!Ae){de.push({key:Ce,routeId:Me.routeId,path:Me.path,matches:null,match:null,controller:null});return}let Ne=e.fetchers.get(Ce),Re=cx(Ae,Me.path),Ye=!1;O.has(Ce)?Ye=!1:C.includes(Ce)?Ye=!0:Ne&&Ne.state!=="idle"&&Ne.data===void 0?Ye=v:Ye=C8(Re,to({currentUrl:q,currentParams:e.matches[e.matches.length-1].params,nextUrl:j,nextParams:n[n.length-1].params},o,{actionResult:K,actionStatus:te,defaultShouldRevalidate:J?!1:v})),Ye&&de.push({key:Ce,routeId:Me.routeId,path:Me.path,matches:Ae,match:Re,controller:new AbortController})}),[ae,de]}function hhe(t,e,n){let o=!e||n.route.id!==e.route.id,u=t[n.route.id]===void 0;return o||u}function rH(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function C8(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function dhe(t,e,n,o,u,d,_,v){let a=[e,...n.map(C=>C.route.id)].join("-");try{let C=_.get(a);C||(C=t({path:e,matches:n,patch:(A,k)=>{v.aborted||nH(A,k,o,u,d)}}),_.set(a,C)),C&&xhe(C)&&await C}finally{_.delete(a)}}function nH(t,e,n,o,u){if(t){var d;let _=o[t];Fn(_,"No route found to patch children into: routeId = "+t);let v=_1(e,u,[t,"patch",String(((d=_.children)==null?void 0:d.length)||"0")],o);_.children?_.children.push(...v):_.children=v}else{let _=_1(e,u,["patch",String(n.length||"0")],o);n.push(..._)}}async function E8(t,e,n){if(!t.lazy)return;let o=await t.lazy();if(!t.lazy)return;let u=n[t.id];Fn(u,"No route found in manifest");let d={};for(let _ in o){let a=u[_]!==void 0&&_!=="hasErrorBoundary";lm(!a,'Route "'+u.id+'" has a static property "'+_+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+_+'" will be ignored.')),!a&&!Lue.has(_)&&(d[_]=o[_])}Object.assign(u,d),Object.assign(u,to({},e(u),{lazy:void 0}))}function fhe(t){return Promise.all(t.matches.map(e=>e.resolve()))}async function phe(t,e,n,o,u,d,_,v){let a=o.reduce((k,O)=>k.add(O.route.id),new Set),C=new Set,A=await t({matches:u.map(k=>{let O=a.has(k.route.id);return to({},k,{shouldLoad:O,resolve:z=>(C.add(k.route.id),O?mhe(e,n,k,d,_,z,v):Promise.resolve({type:Di.data,result:void 0}))})}),request:n,params:u[0].params,context:v});return u.forEach(k=>Fn(C.has(k.route.id),'`match.resolve()` was not called for route id "'+k.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),A.filter((k,O)=>a.has(u[O].route.id))}async function mhe(t,e,n,o,u,d,_){let v,a,C=A=>{let k,O=new Promise((N,K)=>k=K);a=()=>k(),e.signal.addEventListener("abort",a);let R=N=>typeof A!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):A({request:e,params:n.params,context:_},...N!==void 0?[N]:[]),z;return d?z=d(N=>R(N)):z=(async()=>{try{return{type:"data",result:await R()}}catch(N){return{type:"error",result:N}}})(),Promise.race([z,O])};try{let A=n.route[t];if(n.route.lazy)if(A){let k,[O]=await Promise.all([C(A).catch(R=>{k=R}),E8(n.route,u,o)]);if(k!==void 0)throw k;v=O}else if(await E8(n.route,u,o),A=n.route[t],A)v=await C(A);else if(t==="action"){let k=new URL(e.url),O=k.pathname+k.search;throw Xs(405,{method:e.method,pathname:O,routeId:n.route.id})}else return{type:Di.data,result:void 0};else if(A)v=await C(A);else{let k=new URL(e.url),O=k.pathname+k.search;throw Xs(404,{pathname:O})}Fn(v.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(A){return{type:Di.error,result:A}}finally{a&&e.signal.removeEventListener("abort",a)}return v}async function ghe(t){let{result:e,type:n,status:o}=t;if(oH(e)){let _;try{let v=e.headers.get("Content-Type");v&&/\bapplication\/json\b/.test(v)?e.body==null?_=null:_=await e.json():_=await e.text()}catch(v){return{type:Di.error,error:v}}return n===Di.error?{type:Di.error,error:new SO(e.status,e.statusText,_),statusCode:e.status,headers:e.headers}:{type:Di.data,data:_,statusCode:e.status,headers:e.headers}}if(n===Di.error)return{type:Di.error,error:e,statusCode:EA(e)?e.status:o};if(whe(e)){var u,d;return{type:Di.deferred,deferredData:e,statusCode:(u=e.init)==null?void 0:u.status,headers:((d=e.init)==null?void 0:d.headers)&&new Headers(e.init.headers)}}return{type:Di.data,data:e,statusCode:o}}function _he(t,e,n,o,u,d){let _=t.headers.get("Location");if(Fn(_,"Redirects returned/thrown from loaders/actions must have a Location header"),!TO.test(_)){let v=o.slice(0,o.findIndex(a=>a.route.id===n)+1);_=Rk(new URL(e.url),v,u,!0,_,d),t.headers.set("Location",_)}return t}function S8(t,e,n){if(TO.test(t)){let o=t,u=o.startsWith("//")?new URL(e.protocol+o):new URL(o),d=H1(u.pathname,n)!=null;if(u.origin===e.origin&&d)return u.pathname+u.search+u.hash}return t}function q0(t,e,n,o){let u=t.createURL(iH(e)).toString(),d={signal:n};if(o&&hc(o.formMethod)){let{formMethod:_,formEncType:v}=o;d.method=_.toUpperCase(),v==="application/json"?(d.headers=new Headers({"Content-Type":v}),d.body=JSON.stringify(o.json)):v==="text/plain"?d.body=o.text:v==="application/x-www-form-urlencoded"&&o.formData?d.body=kk(o.formData):d.body=o.formData}return new Request(u,d)}function kk(t){let e=new URLSearchParams;for(let[n,o]of t.entries())e.append(n,typeof o=="string"?o:o.name);return e}function T8(t){let e=new FormData;for(let[n,o]of t.entries())e.append(n,o);return e}function yhe(t,e,n,o,u,d){let _={},v=null,a,C=!1,A={},k=o&&Na(o[1])?o[1].error:void 0;return n.forEach((O,R)=>{let z=e[R].route.id;if(Fn(!Up(O),"Cannot handle redirect results in processLoaderData"),Na(O)){let N=O.error;k!==void 0&&(N=k,k=void 0),v=v||{};{let K=xg(t,z);v[K.route.id]==null&&(v[K.route.id]=N)}_[z]=void 0,C||(C=!0,a=EA(O.error)?O.error.status:500),O.headers&&(A[z]=O.headers)}else Np(O)?(u.set(z,O.deferredData),_[z]=O.deferredData.data,O.statusCode!=null&&O.statusCode!==200&&!C&&(a=O.statusCode),O.headers&&(A[z]=O.headers)):(_[z]=O.data,O.statusCode&&O.statusCode!==200&&!C&&(a=O.statusCode),O.headers&&(A[z]=O.headers))}),k!==void 0&&o&&(v={[o[0]]:k},_[o[0]]=void 0),{loaderData:_,errors:v,statusCode:a||200,loaderHeaders:A}}function A8(t,e,n,o,u,d,_,v){let{loaderData:a,errors:C}=yhe(e,n,o,u,v);for(let A=0;A<d.length;A++){let{key:k,match:O,controller:R}=d[A];Fn(_!==void 0&&_[A]!==void 0,"Did not find corresponding fetcher result");let z=_[A];if(!(R&&R.signal.aborted))if(Na(z)){let N=xg(t.matches,O?.route.id);C&&C[N.route.id]||(C=to({},C,{[N.route.id]:z.error})),t.fetchers.delete(k)}else if(Up(z))Fn(!1,"Unhandled fetcher revalidation redirect");else if(Np(z))Fn(!1,"Unhandled fetcher deferred data");else{let N=Ad(z.data);t.fetchers.set(k,N)}}return{loaderData:a,errors:C}}function I8(t,e,n,o){let u=to({},e);for(let d of n){let _=d.route.id;if(e.hasOwnProperty(_)?e[_]!==void 0&&(u[_]=e[_]):t[_]!==void 0&&d.route.loader&&(u[_]=t[_]),o&&o.hasOwnProperty(_))break}return u}function M8(t){return t?Na(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function xg(t,e){return(e?t.slice(0,t.findIndex(o=>o.route.id===e)+1):[...t]).reverse().find(o=>o.route.hasErrorBoundary===!0)||t[0]}function P8(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Xs(t,e){let{pathname:n,routeId:o,method:u,type:d,message:_}=e===void 0?{}:e,v="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(v="Bad Request",d==="route-discovery"?a='Unable to match URL "'+n+'" - the `unstable_patchRoutesOnMiss()` '+(`function threw the following error:
`+_):u&&n&&o?a="You made a "+u+' request to "'+n+'" but '+('did not provide a `loader` for route "'+o+'", ')+"so there is no way to handle the request.":d==="defer-action"?a="defer() is not supported in actions":d==="invalid-body"&&(a="Unable to encode submission body")):t===403?(v="Forbidden",a='Route "'+o+'" does not match URL "'+n+'"'):t===404?(v="Not Found",a='No route matches URL "'+n+'"'):t===405&&(v="Method Not Allowed",u&&n&&o?a="You made a "+u.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+o+'", ')+"so there is no way to handle the request.":u&&(a='Invalid request method "'+u.toUpperCase()+'"')),new SO(t||500,v,new Error(a),!0)}function R8(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Up(n))return{result:n,idx:e}}}function iH(t){let e=typeof t=="string"?Eh(t):t;return V1(to({},e,{hash:""}))}function vhe(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function xhe(t){return typeof t=="object"&&t!=null&&"then"in t}function bhe(t){return oH(t.result)&&ihe.has(t.result.status)}function Np(t){return t.type===Di.deferred}function Na(t){return t.type===Di.error}function Up(t){return(t&&t.type)===Di.redirect}function whe(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function oH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function Che(t){return nhe.has(t.toLowerCase())}function hc(t){return the.has(t.toLowerCase())}async function k8(t,e,n,o,u,d){for(let _=0;_<n.length;_++){let v=n[_],a=e[_];if(!a)continue;let C=t.find(k=>k.route.id===a.route.id),A=C!=null&&!rH(C,a)&&(d&&d[a.route.id])!==void 0;if(Np(v)&&(u||A)){let k=o[_];Fn(k,"Expected an AbortSignal for revalidating fetcher deferred result"),await sH(v,k,u).then(O=>{O&&(n[_]=O||n[_])})}}}async function sH(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Di.data,data:t.deferredData.unwrappedData}}catch(u){return{type:Di.error,error:u}}return{type:Di.data,data:t.deferredData.data}}}function AO(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function cx(t,e){let n=typeof e=="string"?Eh(e).search:e.search;if(t[t.length-1].route.index&&AO(n||""))return t[t.length-1];let o=XV(t);return o[o.length-1]}function D8(t){let{formMethod:e,formAction:n,formEncType:o,text:u,formData:d,json:_}=t;if(!(!e||!n||!o)){if(u!=null)return{formMethod:e,formAction:n,formEncType:o,formData:void 0,json:void 0,text:u};if(d!=null)return{formMethod:e,formAction:n,formEncType:o,formData:d,json:void 0,text:void 0};if(_!==void 0)return{formMethod:e,formAction:n,formEncType:o,formData:void 0,json:_,text:void 0}}}function ZM(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Ehe(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Yv(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function She(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ad(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function The(t,e){try{let n=t.sessionStorage.getItem(tH);if(n){let o=JSON.parse(n);for(let[u,d]of Object.entries(o||{}))d&&Array.isArray(d)&&e.set(u,new Set(d||[]))}}catch{}}function Ahe(t,e){if(e.size>0){let n={};for(let[o,u]of e)n[o]=[...u];try{t.sessionStorage.setItem(tH,JSON.stringify(n))}catch(o){lm(!1,"Failed to save applied view transitions in sessionStorage ("+o+").")}}}/**
 * React Router v6.25.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pS(){return pS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},pS.apply(this,arguments)}const SA=fe.createContext(null),aH=fe.createContext(null),TA=fe.createContext(null),IO=fe.createContext(null),ym=fe.createContext({outlet:null,matches:[],isDataRoute:!1}),lH=fe.createContext(null);function AA(){return fe.useContext(IO)!=null}function MO(){return AA()||Fn(!1),fe.useContext(IO).location}function cH(t){fe.useContext(TA).static||fe.useLayoutEffect(t)}function uH(){let{isDataRoute:t}=fe.useContext(ym);return t?$he():Ihe()}function Ihe(){AA()||Fn(!1);let t=fe.useContext(SA),{basename:e,future:n,navigator:o}=fe.useContext(TA),{matches:u}=fe.useContext(ym),{pathname:d}=MO(),_=JSON.stringify(QV(u,n.v7_relativeSplatPath)),v=fe.useRef(!1);return cH(()=>{v.current=!0}),fe.useCallback(function(C,A){if(A===void 0&&(A={}),!v.current)return;if(typeof C=="number"){o.go(C);return}let k=JV(C,JSON.parse(_),d,A.relative==="path");t==null&&e!=="/"&&(k.pathname=k.pathname==="/"?e:Zd([e,k.pathname])),(A.replace?o.replace:o.push)(k,A.state,A)},[e,o,_,d,t])}const Mhe=fe.createContext(null);function Phe(t){let e=fe.useContext(ym).outlet;return e&&fe.createElement(Mhe.Provider,{value:t},e)}function Rhe(t,e,n,o){AA()||Fn(!1);let{navigator:u}=fe.useContext(TA),{matches:d}=fe.useContext(ym),_=d[d.length-1],v=_?_.params:{};_&&_.pathname;let a=_?_.pathnameBase:"/";_&&_.route;let C=MO(),A;A=C;let k=A.pathname||"/",O=k;if(a!=="/"){let N=a.replace(/^\//,"").split("/");O="/"+k.replace(/^\//,"").split("/").slice(N.length).join("/")}let R=Dp(t,{pathname:O});return Bhe(R&&R.map(N=>Object.assign({},N,{params:Object.assign({},v,N.params),pathname:Zd([a,u.encodeLocation?u.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?a:Zd([a,u.encodeLocation?u.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),d,n,o)}function khe(){let t=Uhe(),e=EA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return fe.createElement(fe.Fragment,null,fe.createElement("h2",null,"Unexpected Application Error!"),fe.createElement("h3",{style:{fontStyle:"italic"}},e),n?fe.createElement("pre",{style:u},n):null,null)}const Dhe=fe.createElement(khe,null);class Ohe extends fe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?fe.createElement(ym.Provider,{value:this.props.routeContext},fe.createElement(lH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Lhe(t){let{routeContext:e,match:n,children:o}=t,u=fe.useContext(SA);return u&&u.static&&u.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=n.route.id),fe.createElement(ym.Provider,{value:e},o)}function Bhe(t,e,n,o){var u;if(e===void 0&&(e=[]),n===void 0&&(n=null),o===void 0&&(o=null),t==null){var d;if((d=n)!=null&&d.errors)t=n.matches;else return null}let _=t,v=(u=n)==null?void 0:u.errors;if(v!=null){let A=_.findIndex(k=>k.route.id&&v?.[k.route.id]!==void 0);A>=0||Fn(!1),_=_.slice(0,Math.min(_.length,A+1))}let a=!1,C=-1;if(n&&o&&o.v7_partialHydration)for(let A=0;A<_.length;A++){let k=_[A];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(C=A),k.route.id){let{loaderData:O,errors:R}=n,z=k.route.loader&&O[k.route.id]===void 0&&(!R||R[k.route.id]===void 0);if(k.route.lazy||z){a=!0,C>=0?_=_.slice(0,C+1):_=[_[0]];break}}}return _.reduceRight((A,k,O)=>{let R,z=!1,N=null,K=null;n&&(R=v&&k.route.id?v[k.route.id]:void 0,N=k.route.errorElement||Dhe,a&&(C<0&&O===0?(z=!0,K=null):C===O&&(z=!0,K=k.route.hydrateFallbackElement||null)));let q=e.concat(_.slice(0,O+1)),j=()=>{let H;return R?H=N:z?H=K:k.route.Component?H=fe.createElement(k.route.Component,null):k.route.element?H=k.route.element:H=A,fe.createElement(Lhe,{match:k,routeContext:{outlet:A,matches:q,isDataRoute:n!=null},children:H})};return n&&(k.route.ErrorBoundary||k.route.errorElement||O===0)?fe.createElement(Ohe,{location:n.location,revalidation:n.revalidation,component:N,error:R,children:j(),routeContext:{outlet:null,matches:q,isDataRoute:!0}}):j()},null)}var hH=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(hH||{}),mS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(mS||{});function Fhe(t){let e=fe.useContext(SA);return e||Fn(!1),e}function zhe(t){let e=fe.useContext(aH);return e||Fn(!1),e}function Nhe(t){let e=fe.useContext(ym);return e||Fn(!1),e}function dH(t){let e=Nhe(),n=e.matches[e.matches.length-1];return n.route.id||Fn(!1),n.route.id}function Uhe(){var t;let e=fe.useContext(lH),n=zhe(mS.UseRouteError),o=dH(mS.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[o]}function $he(){let{router:t}=Fhe(hH.UseNavigateStable),e=dH(mS.UseNavigateStable),n=fe.useRef(!1);return cH(()=>{n.current=!0}),fe.useCallback(function(u,d){d===void 0&&(d={}),n.current&&(typeof u=="number"?t.navigate(u):t.navigate(u,pS({fromRouteId:e},d)))},[t,e])}function jhe(t){let{basename:e="/",children:n=null,location:o,navigationType:u=Bo.Pop,navigator:d,static:_=!1,future:v}=t;AA()&&Fn(!1);let a=e.replace(/^\/*/,"/"),C=fe.useMemo(()=>({basename:a,navigator:d,static:_,future:pS({v7_relativeSplatPath:!1},v)}),[a,v,d,_]);typeof o=="string"&&(o=Eh(o));let{pathname:A="/",search:k="",hash:O="",state:R=null,key:z="default"}=o,N=fe.useMemo(()=>{let K=H1(A,a);return K==null?null:{location:{pathname:K,search:k,hash:O,state:R,key:z},navigationType:u}},[a,A,k,O,R,z,u]);return N==null?null:fe.createElement(TA.Provider,{value:C},fe.createElement(IO.Provider,{children:n,value:N}))}new Promise(()=>{});function Vhe(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:fe.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:fe.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:fe.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.25.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gS(){return gS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},gS.apply(this,arguments)}const Hhe="6";try{window.__reactRouterVersion=Hhe}catch{}function Ghe(t,e){return lhe({basename:void 0,future:gS({},void 0,{v7_prependBasename:!0}),history:kue({window:void 0}),hydrationData:Whe(),routes:t,mapRouteProperties:Vhe,unstable_dataStrategy:void 0,unstable_patchRoutesOnMiss:void 0,window:void 0}).initialize()}function Whe(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=gS({},e,{errors:qhe(e.errors)})),e}function qhe(t){if(!t)return null;let e=Object.entries(t),n={};for(let[o,u]of e)if(u&&u.__type==="RouteErrorResponse")n[o]=new SO(u.status,u.statusText,u.data,u.internal===!0);else if(u&&u.__type==="Error"){if(u.__subType){let d=window[u.__subType];if(typeof d=="function")try{let _=new d(u.message);_.stack="",n[o]=_}catch{}}if(n[o]==null){let d=new Error(u.message);d.stack="",n[o]=d}}else n[o]=u;return n}const Khe=fe.createContext({isTransitioning:!1}),Yhe=fe.createContext(new Map),Zhe="startTransition",O8=Hg[Zhe],Xhe="flushSync",L8=yre[Xhe];function Qhe(t){O8?O8(t):t()}function Zv(t){L8?L8(t):t()}class Jhe{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=o=>{this.status==="pending"&&(this.status="resolved",e(o))},this.reject=o=>{this.status==="pending"&&(this.status="rejected",n(o))}})}}function ede(t){let{fallbackElement:e,router:n,future:o}=t,[u,d]=fe.useState(n.state),[_,v]=fe.useState(),[a,C]=fe.useState({isTransitioning:!1}),[A,k]=fe.useState(),[O,R]=fe.useState(),[z,N]=fe.useState(),K=fe.useRef(new Map),{v7_startTransition:q}=o||{},j=fe.useCallback(de=>{q?Qhe(de):de()},[q]),H=fe.useCallback((de,Me)=>{let{deletedFetchers:Ce,unstable_flushSync:Ae,unstable_viewTransitionOpts:Ne}=Me;Ce.forEach(Ye=>K.current.delete(Ye)),de.fetchers.forEach((Ye,ht)=>{Ye.data!==void 0&&K.current.set(ht,Ye.data)});let Re=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!Ne||Re){Ae?Zv(()=>d(de)):j(()=>d(de));return}if(Ae){Zv(()=>{O&&(A&&A.resolve(),O.skipTransition()),C({isTransitioning:!0,flushSync:!0,currentLocation:Ne.currentLocation,nextLocation:Ne.nextLocation})});let Ye=n.window.document.startViewTransition(()=>{Zv(()=>d(de))});Ye.finished.finally(()=>{Zv(()=>{k(void 0),R(void 0),v(void 0),C({isTransitioning:!1})})}),Zv(()=>R(Ye));return}O?(A&&A.resolve(),O.skipTransition(),N({state:de,currentLocation:Ne.currentLocation,nextLocation:Ne.nextLocation})):(v(de),C({isTransitioning:!0,flushSync:!1,currentLocation:Ne.currentLocation,nextLocation:Ne.nextLocation}))},[n.window,O,A,K,j]);fe.useLayoutEffect(()=>n.subscribe(H),[n,H]),fe.useEffect(()=>{a.isTransitioning&&!a.flushSync&&k(new Jhe)},[a]),fe.useEffect(()=>{if(A&&_&&n.window){let de=_,Me=A.promise,Ce=n.window.document.startViewTransition(async()=>{j(()=>d(de)),await Me});Ce.finished.finally(()=>{k(void 0),R(void 0),v(void 0),C({isTransitioning:!1})}),R(Ce)}},[j,_,A,n.window]),fe.useEffect(()=>{A&&_&&u.location.key===_.location.key&&A.resolve()},[A,O,u.location,_]),fe.useEffect(()=>{!a.isTransitioning&&z&&(v(z.state),C({isTransitioning:!0,flushSync:!1,currentLocation:z.currentLocation,nextLocation:z.nextLocation}),N(void 0))},[a.isTransitioning,z]),fe.useEffect(()=>{},[]);let Y=fe.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:de=>n.navigate(de),push:(de,Me,Ce)=>n.navigate(de,{state:Me,preventScrollReset:Ce?.preventScrollReset}),replace:(de,Me,Ce)=>n.navigate(de,{replace:!0,state:Me,preventScrollReset:Ce?.preventScrollReset})}),[n]),te=n.basename||"/",J=fe.useMemo(()=>({router:n,navigator:Y,static:!1,basename:te}),[n,Y,te]),ae=fe.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return fe.createElement(fe.Fragment,null,fe.createElement(SA.Provider,{value:J},fe.createElement(aH.Provider,{value:u},fe.createElement(Yhe.Provider,{value:K.current},fe.createElement(Khe.Provider,{value:a},fe.createElement(jhe,{basename:te,location:u.location,navigationType:u.historyAction,navigator:Y,future:ae},u.initialized||n.future.v7_partialHydration?fe.createElement(tde,{routes:n.routes,future:n.future,state:u}):e))))),null)}const tde=fe.memo(rde);function rde(t){let{routes:e,future:n,state:o}=t;return Rhe(e,void 0,o,n)}var B8;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(B8||(B8={}));var F8;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(F8||(F8={}));const nde=fe.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),ide=fe.createContext(null),ode=typeof window<"u",sde=ode?fe.useLayoutEffect:fe.useEffect,ade=fe.createContext({});function fH(t){const e=fe.useRef(null);return e.current===null&&(e.current=t()),e.current}class lde extends fe.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const o=this.props.sizeRef.current;o.height=n.offsetHeight||0,o.width=n.offsetWidth||0,o.top=n.offsetTop,o.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function cde({children:t,isPresent:e}){const n=fe.useId(),o=fe.useRef(null),u=fe.useRef({width:0,height:0,top:0,left:0}),{nonce:d}=fe.useContext(nde);return fe.useInsertionEffect(()=>{const{width:_,height:v,top:a,left:C}=u.current;if(e||!o.current||!_||!v)return;o.current.dataset.motionPopId=n;const A=document.createElement("style");return d&&(A.nonce=d),document.head.appendChild(A),A.sheet&&A.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${_}px !important;
            height: ${v}px !important;
            top: ${a}px !important;
            left: ${C}px !important;
          }
        `),()=>{document.head.removeChild(A)}},[e]),Ke.jsx(lde,{isPresent:e,childRef:o,sizeRef:u,children:fe.cloneElement(t,{ref:o})})}const ude=({children:t,initial:e,isPresent:n,onExitComplete:o,custom:u,presenceAffectsLayout:d,mode:_})=>{const v=fH(hde),a=fe.useId(),C=fe.useMemo(()=>({id:a,initial:e,isPresent:n,custom:u,onExitComplete:A=>{v.set(A,!0);for(const k of v.values())if(!k)return;o&&o()},register:A=>(v.set(A,!1),()=>v.delete(A))}),d?[Math.random()]:[n]);return fe.useMemo(()=>{v.forEach((A,k)=>v.set(k,!1))},[n]),fe.useEffect(()=>{!n&&!v.size&&o&&o()},[n]),_==="popLayout"&&(t=Ke.jsx(cde,{isPresent:n,children:t})),Ke.jsx(ide.Provider,{value:C,children:t})};function hde(){return new Map}const IC=t=>t.key||"";function z8(t){const e=[];return fe.Children.forEach(t,n=>{fe.isValidElement(n)&&e.push(n)}),e}const dde=({children:t,exitBeforeEnter:e,custom:n,initial:o=!0,onExitComplete:u,presenceAffectsLayout:d=!0,mode:_="sync"})=>{const v=fe.useMemo(()=>z8(t),[t]),a=v.map(IC),C=fe.useRef(!0),A=fe.useRef(v),k=fH(()=>new Map),[O,R]=fe.useState(v),[z,N]=fe.useState(v);sde(()=>{C.current=!1,A.current=v;for(let j=0;j<z.length;j++){const H=IC(z[j]);a.includes(H)?k.delete(H):k.get(H)!==!0&&k.set(H,!1)}},[z,a.length,a.join("-")]);const K=[];if(v!==O){let j=[...v];for(let H=0;H<z.length;H++){const Y=z[H],te=IC(Y);a.includes(te)||(j.splice(H,0,Y),K.push(Y))}_==="wait"&&K.length&&(j=K),N(z8(j)),R(v);return}const{forceRender:q}=fe.useContext(ade);return Ke.jsx(Ke.Fragment,{children:z.map(j=>{const H=IC(j),Y=v===z||a.includes(H),te=()=>{if(k.has(H))k.set(H,!0);else return;let J=!0;k.forEach(ae=>{ae||(J=!1)}),J&&(q?.(),N(A.current),u&&u())};return Ke.jsx(ude,{isPresent:Y,initial:!C.current||o?void 0:!1,custom:Y?void 0:n,presenceAffectsLayout:d,mode:_,onExitComplete:Y?void 0:te,children:j},H)})})};var pH={exports:{}},mH={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G1=fe;function fde(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pde=typeof Object.is=="function"?Object.is:fde,mde=G1.useSyncExternalStore,gde=G1.useRef,_de=G1.useEffect,yde=G1.useMemo,vde=G1.useDebugValue;mH.useSyncExternalStoreWithSelector=function(t,e,n,o,u){var d=gde(null);if(d.current===null){var _={hasValue:!1,value:null};d.current=_}else _=d.current;d=yde(function(){function a(R){if(!C){if(C=!0,A=R,R=o(R),u!==void 0&&_.hasValue){var z=_.value;if(u(z,R))return k=z}return k=R}if(z=k,pde(A,R))return z;var N=o(R);return u!==void 0&&u(z,N)?z:(A=R,k=N)}var C=!1,A,k,O=n===void 0?null:n;return[function(){return a(e())},O===null?void 0:function(){return a(O())}]},[e,n,o,u]);var v=mde(t,d[0],d[1]);return _de(function(){_.hasValue=!0,_.value=v},[v]),vde(v),v};pH.exports=mH;var xde=pH.exports,Ga="default"in Hg?wi:Hg,N8=Symbol.for("react-redux-context"),U8=typeof globalThis<"u"?globalThis:{};function bde(){if(!Ga.createContext)return{};const t=U8[N8]??(U8[N8]=new Map);let e=t.get(Ga.createContext);return e||(e=Ga.createContext(null),t.set(Ga.createContext,e)),e}var nf=bde(),wde=()=>{throw new Error("uSES not initialized!")};function PO(t=nf){return function(){return Ga.useContext(t)}}var gH=PO(),_H=wde,Cde=t=>{_H=t},Ede=(t,e)=>t===e;function Sde(t=nf){const e=t===nf?gH:PO(t),n=(o,u={})=>{const{equalityFn:d=Ede,devModeChecks:_={}}=typeof u=="function"?{equalityFn:u}:u,{store:v,subscription:a,getServerState:C,stabilityCheck:A,identityFunctionCheck:k}=e();Ga.useRef(!0);const O=Ga.useCallback({[o.name](z){return o(z)}}[o.name],[o,A,_.stabilityCheck]),R=_H(a.addNestedSub,v.getState,C||v.getState,O,d);return Ga.useDebugValue(R),R};return Object.assign(n,{withTypes:()=>n}),n}var RO=Sde();function Tde(t){t()}function Ade(){let t=null,e=null;return{clear(){t=null,e=null},notify(){Tde(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let o=t;for(;o;)n.push(o),o=o.next;return n},subscribe(n){let o=!0;const u=e={callback:n,next:null,prev:e};return u.prev?u.prev.next=u:t=u,function(){!o||t===null||(o=!1,u.next?u.next.prev=u.prev:e=u.prev,u.prev?u.prev.next=u.next:t=u.next)}}}}var $8={notify(){},get:()=>[]};function Ide(t,e){let n,o=$8,u=0,d=!1;function _(N){A();const K=o.subscribe(N);let q=!1;return()=>{q||(q=!0,K(),k())}}function v(){o.notify()}function a(){z.onStateChange&&z.onStateChange()}function C(){return d}function A(){u++,n||(n=t.subscribe(a),o=Ade())}function k(){u--,n&&u===0&&(n(),n=void 0,o.clear(),o=$8)}function O(){d||(d=!0,A())}function R(){d&&(d=!1,k())}const z={addNestedSub:_,notifyNestedSubs:v,handleChangeWrapper:a,isSubscribed:C,trySubscribe:O,tryUnsubscribe:R,getListeners:()=>o};return z}var Mde=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pde=typeof navigator<"u"&&navigator.product==="ReactNative",Rde=Mde||Pde?Ga.useLayoutEffect:Ga.useEffect;function kde({store:t,context:e,children:n,serverState:o,stabilityCheck:u="once",identityFunctionCheck:d="once"}){const _=Ga.useMemo(()=>{const C=Ide(t);return{store:t,subscription:C,getServerState:o?()=>o:void 0,stabilityCheck:u,identityFunctionCheck:d}},[t,o,u,d]),v=Ga.useMemo(()=>t.getState(),[t]);Rde(()=>{const{subscription:C}=_;return C.onStateChange=C.notifyNestedSubs,C.trySubscribe(),v!==t.getState()&&C.notifyNestedSubs(),()=>{C.tryUnsubscribe(),C.onStateChange=void 0}},[_,v]);const a=e||nf;return Ga.createElement(a.Provider,{value:_},n)}var Dde=kde;function yH(t=nf){const e=t===nf?gH:PO(t),n=()=>{const{store:o}=e();return o};return Object.assign(n,{withTypes:()=>n}),n}var Ode=yH();function Lde(t=nf){const e=t===nf?Ode:yH(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var kO=Lde();Cde(xde.useSyncExternalStoreWithSelector);function xs(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Bde=typeof Symbol=="function"&&Symbol.observable||"@@observable",j8=Bde,XM=()=>Math.random().toString(36).substring(7).split("").join("."),Fde={INIT:`@@redux/INIT${XM()}`,REPLACE:`@@redux/REPLACE${XM()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${XM()}`},_S=Fde;function DO(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function OO(t,e,n){if(typeof t!="function")throw new Error(xs(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(xs(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(xs(1));return n(OO)(t,e)}let o=t,u=e,d=new Map,_=d,v=0,a=!1;function C(){_===d&&(_=new Map,d.forEach((K,q)=>{_.set(q,K)}))}function A(){if(a)throw new Error(xs(3));return u}function k(K){if(typeof K!="function")throw new Error(xs(4));if(a)throw new Error(xs(5));let q=!0;C();const j=v++;return _.set(j,K),function(){if(q){if(a)throw new Error(xs(6));q=!1,C(),_.delete(j),d=null}}}function O(K){if(!DO(K))throw new Error(xs(7));if(typeof K.type>"u")throw new Error(xs(8));if(typeof K.type!="string")throw new Error(xs(17));if(a)throw new Error(xs(9));try{a=!0,u=o(u,K)}finally{a=!1}return(d=_).forEach(j=>{j()}),K}function R(K){if(typeof K!="function")throw new Error(xs(10));o=K,O({type:_S.REPLACE})}function z(){const K=k;return{subscribe(q){if(typeof q!="object"||q===null)throw new Error(xs(11));function j(){const Y=q;Y.next&&Y.next(A())}return j(),{unsubscribe:K(j)}},[j8](){return this}}}return O({type:_S.INIT}),{dispatch:O,subscribe:k,getState:A,replaceReducer:R,[j8]:z}}function zde(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:_S.INIT})>"u")throw new Error(xs(12));if(typeof n(void 0,{type:_S.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xs(13))})}function Nde(t){const e=Object.keys(t),n={};for(let d=0;d<e.length;d++){const _=e[d];typeof t[_]=="function"&&(n[_]=t[_])}const o=Object.keys(n);let u;try{zde(n)}catch(d){u=d}return function(_={},v){if(u)throw u;let a=!1;const C={};for(let A=0;A<o.length;A++){const k=o[A],O=n[k],R=_[k],z=O(R,v);if(typeof z>"u")throw v&&v.type,new Error(xs(14));C[k]=z,a=a||z!==R}return a=a||o.length!==Object.keys(_).length,a?C:_}}function yS(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...o)=>e(n(...o)))}function Ude(...t){return e=>(n,o)=>{const u=e(n,o);let d=()=>{throw new Error(xs(15))};const _={getState:u.getState,dispatch:(a,...C)=>d(a,...C)},v=t.map(a=>a(_));return d=yS(...v)(u.dispatch),{...u,dispatch:d}}}function $de(t){return DO(t)&&"type"in t&&typeof t.type=="string"}var vH=Symbol.for("immer-nothing"),V8=Symbol.for("immer-draftable"),Ja=Symbol.for("immer-state");function mc(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var i_=Object.getPrototypeOf;function of(t){return!!t&&!!t[Ja]}function yh(t){return t?xH(t)||Array.isArray(t)||!!t[V8]||!!t.constructor?.[V8]||MA(t)||PA(t):!1}var jde=Object.prototype.constructor.toString();function xH(t){if(!t||typeof t!="object")return!1;const e=i_(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===jde}function vS(t,e){IA(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,o)=>e(o,n,t))}function IA(t){const e=t[Ja];return e?e.type_:Array.isArray(t)?1:MA(t)?2:PA(t)?3:0}function Dk(t,e){return IA(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function bH(t,e,n){const o=IA(t);o===2?t.set(e,n):o===3?t.add(n):t[e]=n}function Vde(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function MA(t){return t instanceof Map}function PA(t){return t instanceof Set}function Rp(t){return t.copy_||t.base_}function Ok(t,e){if(MA(t))return new Map(t);if(PA(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=xH(t);if(e===!0||e==="class_only"&&!n){const o=Object.getOwnPropertyDescriptors(t);delete o[Ja];let u=Reflect.ownKeys(o);for(let d=0;d<u.length;d++){const _=u[d],v=o[_];v.writable===!1&&(v.writable=!0,v.configurable=!0),(v.get||v.set)&&(o[_]={configurable:!0,writable:!0,enumerable:v.enumerable,value:t[_]})}return Object.create(i_(t),o)}else{const o=i_(t);if(o!==null&&n)return{...t};const u=Object.create(o);return Object.assign(u,t)}}function LO(t,e=!1){return RA(t)||of(t)||!yh(t)||(IA(t)>1&&(t.set=t.add=t.clear=t.delete=Hde),Object.freeze(t),e&&Object.entries(t).forEach(([n,o])=>LO(o,!0))),t}function Hde(){mc(2)}function RA(t){return Object.isFrozen(t)}var Gde={};function cm(t){const e=Gde[t];return e||mc(0,t),e}var y1;function wH(){return y1}function Wde(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function H8(t,e){e&&(cm("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Lk(t){Bk(t),t.drafts_.forEach(qde),t.drafts_=null}function Bk(t){t===y1&&(y1=t.parent_)}function G8(t){return y1=Wde(y1,t)}function qde(t){const e=t[Ja];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function W8(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Ja].modified_&&(Lk(e),mc(4)),yh(t)&&(t=xS(e,t),e.parent_||bS(e,t)),e.patches_&&cm("Patches").generateReplacementPatches_(n[Ja].base_,t,e.patches_,e.inversePatches_)):t=xS(e,n,[]),Lk(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==vH?t:void 0}function xS(t,e,n){if(RA(e))return e;const o=e[Ja];if(!o)return vS(e,(u,d)=>q8(t,o,e,u,d,n)),e;if(o.scope_!==t)return e;if(!o.modified_)return bS(t,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;const u=o.copy_;let d=u,_=!1;o.type_===3&&(d=new Set(u),u.clear(),_=!0),vS(d,(v,a)=>q8(t,o,u,v,a,n,_)),bS(t,u,!1),n&&t.patches_&&cm("Patches").generatePatches_(o,n,t.patches_,t.inversePatches_)}return o.copy_}function q8(t,e,n,o,u,d,_){if(of(u)){const v=d&&e&&e.type_!==3&&!Dk(e.assigned_,o)?d.concat(o):void 0,a=xS(t,u,v);if(bH(n,o,a),of(a))t.canAutoFreeze_=!1;else return}else _&&n.add(u);if(yh(u)&&!RA(u)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;xS(t,u),(!e||!e.scope_.parent_)&&typeof o!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,o)&&bS(t,u)}}function bS(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&LO(e,n)}function Kde(t,e){const n=Array.isArray(t),o={type_:n?1:0,scope_:e?e.scope_:wH(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let u=o,d=BO;n&&(u=[o],d=v1);const{revoke:_,proxy:v}=Proxy.revocable(u,d);return o.draft_=v,o.revoke_=_,v}var BO={get(t,e){if(e===Ja)return t;const n=Rp(t);if(!Dk(n,e))return Yde(t,n,e);const o=n[e];return t.finalized_||!yh(o)?o:o===QM(t.base_,e)?(JM(t),t.copy_[e]=zk(o,t)):o},has(t,e){return e in Rp(t)},ownKeys(t){return Reflect.ownKeys(Rp(t))},set(t,e,n){const o=CH(Rp(t),e);if(o?.set)return o.set.call(t.draft_,n),!0;if(!t.modified_){const u=QM(Rp(t),e),d=u?.[Ja];if(d&&d.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(Vde(n,u)&&(n!==void 0||Dk(t.base_,e)))return!0;JM(t),Fk(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return QM(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,JM(t),Fk(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Rp(t),o=Reflect.getOwnPropertyDescriptor(n,e);return o&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:o.enumerable,value:n[e]}},defineProperty(){mc(11)},getPrototypeOf(t){return i_(t.base_)},setPrototypeOf(){mc(12)}},v1={};vS(BO,(t,e)=>{v1[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});v1.deleteProperty=function(t,e){return v1.set.call(this,t,e,void 0)};v1.set=function(t,e,n){return BO.set.call(this,t[0],e,n,t[0])};function QM(t,e){const n=t[Ja];return(n?Rp(n):t)[e]}function Yde(t,e,n){const o=CH(e,n);return o?"value"in o?o.value:o.get?.call(t.draft_):void 0}function CH(t,e){if(!(e in t))return;let n=i_(t);for(;n;){const o=Object.getOwnPropertyDescriptor(n,e);if(o)return o;n=i_(n)}}function Fk(t){t.modified_||(t.modified_=!0,t.parent_&&Fk(t.parent_))}function JM(t){t.copy_||(t.copy_=Ok(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Zde=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,o)=>{if(typeof e=="function"&&typeof n!="function"){const d=n;n=e;const _=this;return function(a=d,...C){return _.produce(a,A=>n.call(this,A,...C))}}typeof n!="function"&&mc(6),o!==void 0&&typeof o!="function"&&mc(7);let u;if(yh(e)){const d=G8(this),_=zk(e,void 0);let v=!0;try{u=n(_),v=!1}finally{v?Lk(d):Bk(d)}return H8(d,o),W8(u,d)}else if(!e||typeof e!="object"){if(u=n(e),u===void 0&&(u=e),u===vH&&(u=void 0),this.autoFreeze_&&LO(u,!0),o){const d=[],_=[];cm("Patches").generateReplacementPatches_(e,u,d,_),o(d,_)}return u}else mc(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(_,...v)=>this.produceWithPatches(_,a=>e(a,...v));let o,u;return[this.produce(e,n,(_,v)=>{o=_,u=v}),o,u]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){yh(t)||mc(8),of(t)&&(t=EH(t));const e=G8(this),n=zk(t,void 0);return n[Ja].isManual_=!0,Bk(e),n}finishDraft(t,e){const n=t&&t[Ja];(!n||!n.isManual_)&&mc(9);const{scope_:o}=n;return H8(o,e),W8(void 0,o)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const u=e[n];if(u.path.length===0&&u.op==="replace"){t=u.value;break}}n>-1&&(e=e.slice(n+1));const o=cm("Patches").applyPatches_;return of(t)?o(t,e):this.produce(t,u=>o(u,e))}};function zk(t,e){const n=MA(t)?cm("MapSet").proxyMap_(t,e):PA(t)?cm("MapSet").proxySet_(t,e):Kde(t,e);return(e?e.scope_:wH()).drafts_.push(n),n}function EH(t){return of(t)||mc(10,t),SH(t)}function SH(t){if(!yh(t)||RA(t))return t;const e=t[Ja];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=Ok(t,e.scope_.immer_.useStrictShallowCopy_)}else n=Ok(t,!0);return vS(n,(o,u)=>{bH(n,o,SH(u))}),e&&(e.finalized_=!1),n}var el=new Zde,TH=el.produce;el.produceWithPatches.bind(el);el.setAutoFreeze.bind(el);el.setUseStrictShallowCopy.bind(el);el.applyPatches.bind(el);el.createDraft.bind(el);el.finishDraft.bind(el);function Xde(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function Qde(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function Jde(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(o=>typeof o=="function"?`function ${o.name||"unnamed"}()`:typeof o).join(", ");throw new TypeError(`${e}[${n}]`)}}var K8=t=>Array.isArray(t)?t:[t];function efe(t){const e=Array.isArray(t[0])?t[0]:t;return Jde(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function tfe(t,e){const n=[],{length:o}=t;for(let u=0;u<o;u++)n.push(t[u].apply(null,e));return n}var rfe=class{constructor(t){this.value=t}deref(){return this.value}},nfe=typeof WeakRef<"u"?WeakRef:rfe,ife=0,Y8=1;function MC(){return{s:ife,v:void 0,o:null,p:null}}function FO(t,e={}){let n=MC();const{resultEqualityCheck:o}=e;let u,d=0;function _(){let v=n;const{length:a}=arguments;for(let k=0,O=a;k<O;k++){const R=arguments[k];if(typeof R=="function"||typeof R=="object"&&R!==null){let z=v.o;z===null&&(v.o=z=new WeakMap);const N=z.get(R);N===void 0?(v=MC(),z.set(R,v)):v=N}else{let z=v.p;z===null&&(v.p=z=new Map);const N=z.get(R);N===void 0?(v=MC(),z.set(R,v)):v=N}}const C=v;let A;if(v.s===Y8)A=v.v;else if(A=t.apply(null,arguments),d++,o){const k=u?.deref?.()??u;k!=null&&o(k,A)&&(A=k,d!==0&&d--),u=typeof A=="object"&&A!==null||typeof A=="function"?new nfe(A):A}return C.s=Y8,C.v=A,A}return _.clearCache=()=>{n=MC(),_.resetResultsCount()},_.resultsCount=()=>d,_.resetResultsCount=()=>{d=0},_}function AH(t,...e){const n=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,o=(...u)=>{let d=0,_=0,v,a={},C=u.pop();typeof C=="object"&&(a=C,C=u.pop()),Xde(C,`createSelector expects an output function after the inputs, but received: [${typeof C}]`);const A={...n,...a},{memoize:k,memoizeOptions:O=[],argsMemoize:R=FO,argsMemoizeOptions:z=[],devModeChecks:N={}}=A,K=K8(O),q=K8(z),j=efe(u),H=k(function(){return d++,C.apply(null,arguments)},...K),Y=R(function(){_++;const J=tfe(j,arguments);return v=H.apply(null,J),v},...q);return Object.assign(Y,{resultFunc:C,memoizedResultFunc:H,dependencies:j,dependencyRecomputations:()=>_,resetDependencyRecomputations:()=>{_=0},lastResult:()=>v,recomputations:()=>d,resetRecomputations:()=>{d=0},memoize:k,argsMemoize:R})};return Object.assign(o,{withTypes:()=>o}),o}var ofe=AH(FO),sfe=Object.assign((t,e=ofe)=>{Qde(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),o=n.map(d=>t[d]);return e(o,(...d)=>d.reduce((_,v,a)=>(_[n[a]]=v,_),{}))},{withTypes:()=>sfe});function IH(t){return({dispatch:n,getState:o})=>u=>d=>typeof d=="function"?d(n,o,t):u(d)}var MH=IH(),afe=IH,lfe=(...t)=>{const e=AH(...t),n=Object.assign((...o)=>{const u=e(...o),d=(_,...v)=>u(of(_)?EH(_):_,...v);return Object.assign(d,u),d},{withTypes:()=>n});return n};lfe(FO);var cfe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?yS:yS.apply(null,arguments)};function o_(t,e){function n(...o){if(e){let u=e(...o);if(!u)throw new Error(_a(0));return{type:t,payload:u.payload,..."meta"in u&&{meta:u.meta},..."error"in u&&{error:u.error}}}return{type:t,payload:o[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=o=>$de(o)&&o.type===t,n}var PH=class ux extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ux.prototype)}static get[Symbol.species](){return ux}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ux(...e[0].concat(this)):new ux(...e.concat(this))}};function Z8(t){return yh(t)?TH(t,()=>{}):t}function X8(t,e,n){if(t.has(e)){let u=t.get(e);return n.update&&(u=n.update(u,e,t),t.set(e,u)),u}if(!n.insert)throw new Error(_a(10));const o=n.insert(e,t);return t.set(e,o),o}function ufe(t){return typeof t=="boolean"}var hfe=()=>function(e){const{thunk:n=!0,immutableCheck:o=!0,serializableCheck:u=!0,actionCreatorCheck:d=!0}=e??{};let _=new PH;return n&&(ufe(n)?_.push(MH):_.push(afe(n.extraArgument))),_},dfe="RTK_autoBatch",RH=t=>e=>{setTimeout(e,t)},ffe=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:RH(10),pfe=(t={type:"raf"})=>e=>(...n)=>{const o=e(...n);let u=!0,d=!1,_=!1;const v=new Set,a=t.type==="tick"?queueMicrotask:t.type==="raf"?ffe:t.type==="callback"?t.queueNotification:RH(t.timeout),C=()=>{_=!1,d&&(d=!1,v.forEach(A=>A()))};return Object.assign({},o,{subscribe(A){const k=()=>u&&A(),O=o.subscribe(k);return v.add(A),()=>{O(),v.delete(A)}},dispatch(A){try{return u=!A?.meta?.[dfe],d=!u,d&&(_||(_=!0,a(C))),o.dispatch(A)}finally{u=!0}}})},mfe=t=>function(n){const{autoBatch:o=!0}=n??{};let u=new PH(t);return o&&u.push(pfe(typeof o=="object"?o:void 0)),u},gfe=!0;function _fe(t){const e=hfe(),{reducer:n=void 0,middleware:o,devTools:u=!0,preloadedState:d=void 0,enhancers:_=void 0}=t||{};let v;if(typeof n=="function")v=n;else if(DO(n))v=Nde(n);else throw new Error(_a(1));let a;typeof o=="function"?a=o(e):a=e();let C=yS;u&&(C=cfe({trace:!gfe,...typeof u=="object"&&u}));const A=Ude(...a),k=mfe(A);let O=typeof _=="function"?_(k):k();const R=C(...O);return OO(v,d,R)}function kH(t){const e={},n=[];let o;const u={addCase(d,_){const v=typeof d=="string"?d:d.type;if(!v)throw new Error(_a(28));if(v in e)throw new Error(_a(29));return e[v]=_,u},addMatcher(d,_){return n.push({matcher:d,reducer:_}),u},addDefaultCase(d){return o=d,u}};return t(u),[e,n,o]}function yfe(t){return typeof t=="function"}function vfe(t,e){let[n,o,u]=kH(e),d;if(yfe(t))d=()=>Z8(t());else{const v=Z8(t);d=()=>v}function _(v=d(),a){let C=[n[a.type],...o.filter(({matcher:A})=>A(a)).map(({reducer:A})=>A)];return C.filter(A=>!!A).length===0&&(C=[u]),C.reduce((A,k)=>{if(k)if(of(A)){const R=k(A,a);return R===void 0?A:R}else{if(yh(A))return TH(A,O=>k(O,a));{const O=k(A,a);if(O===void 0){if(A===null)return A;throw new Error(_a(9))}return O}}return A},v)}return _.getInitialState=d,_}var xfe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bfe=(t=21)=>{let e="",n=t;for(;n--;)e+=xfe[Math.random()*64|0];return e},wfe=Symbol.for("rtk-slice-createasyncthunk");function Cfe(t,e){return`${t}/${e}`}function Efe({creators:t}={}){const e=t?.asyncThunk?.[wfe];return function(o){const{name:u,reducerPath:d=u}=o;if(!u)throw new Error(_a(11));typeof process<"u";const _=(typeof o.reducers=="function"?o.reducers(Tfe()):o.reducers)||{},v=Object.keys(_),a={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},C={addCase(j,H){const Y=typeof j=="string"?j:j.type;if(!Y)throw new Error(_a(12));if(Y in a.sliceCaseReducersByType)throw new Error(_a(13));return a.sliceCaseReducersByType[Y]=H,C},addMatcher(j,H){return a.sliceMatchers.push({matcher:j,reducer:H}),C},exposeAction(j,H){return a.actionCreators[j]=H,C},exposeCaseReducer(j,H){return a.sliceCaseReducersByName[j]=H,C}};v.forEach(j=>{const H=_[j],Y={reducerName:j,type:Cfe(u,j),createNotation:typeof o.reducers=="function"};Ife(H)?Pfe(Y,H,C,e):Afe(Y,H,C)});function A(){const[j={},H=[],Y=void 0]=typeof o.extraReducers=="function"?kH(o.extraReducers):[o.extraReducers],te={...j,...a.sliceCaseReducersByType};return vfe(o.initialState,J=>{for(let ae in te)J.addCase(ae,te[ae]);for(let ae of a.sliceMatchers)J.addMatcher(ae.matcher,ae.reducer);for(let ae of H)J.addMatcher(ae.matcher,ae.reducer);Y&&J.addDefaultCase(Y)})}const k=j=>j,O=new Map;let R;function z(j,H){return R||(R=A()),R(j,H)}function N(){return R||(R=A()),R.getInitialState()}function K(j,H=!1){function Y(J){let ae=J[j];return typeof ae>"u"&&H&&(ae=N()),ae}function te(J=k){const ae=X8(O,H,{insert:()=>new WeakMap});return X8(ae,J,{insert:()=>{const de={};for(const[Me,Ce]of Object.entries(o.selectors??{}))de[Me]=Sfe(Ce,J,N,H);return de}})}return{reducerPath:j,getSelectors:te,get selectors(){return te(Y)},selectSlice:Y}}const q={name:u,reducer:z,actions:a.actionCreators,caseReducers:a.sliceCaseReducersByName,getInitialState:N,...K(d),injectInto(j,{reducerPath:H,...Y}={}){const te=H??d;return j.inject({reducerPath:te,reducer:z},Y),{...q,...K(te,!0)}}};return q}}function Sfe(t,e,n,o){function u(d,..._){let v=e(d);return typeof v>"u"&&o&&(v=n()),t(v,..._)}return u.unwrapped=t,u}var W1=Efe();function Tfe(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function Afe({type:t,reducerName:e,createNotation:n},o,u){let d,_;if("reducer"in o){if(n&&!Mfe(o))throw new Error(_a(17));d=o.reducer,_=o.prepare}else d=o;u.addCase(t,d).exposeCaseReducer(e,d).exposeAction(e,_?o_(t,_):o_(t))}function Ife(t){return t._reducerDefinitionType==="asyncThunk"}function Mfe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Pfe({type:t,reducerName:e},n,o,u){if(!u)throw new Error(_a(18));const{payloadCreator:d,fulfilled:_,pending:v,rejected:a,settled:C,options:A}=n,k=u(t,d,A);o.exposeAction(e,k),_&&o.addCase(k.fulfilled,_),v&&o.addCase(k.pending,v),a&&o.addCase(k.rejected,a),C&&o.addMatcher(k.settled,C),o.exposeCaseReducer(e,{fulfilled:_||PC,pending:v||PC,rejected:a||PC,settled:C||PC})}function PC(){}var Rfe=(t,e)=>{if(typeof t!="function")throw new Error(_a(32))},zO="listenerMiddleware",kfe=t=>{let{type:e,actionCreator:n,matcher:o,predicate:u,effect:d}=t;if(e)u=o_(e).match;else if(n)e=n.type,u=n.match;else if(o)u=o;else if(!u)throw new Error(_a(21));return Rfe(d),{predicate:u,type:e,effect:d}},Dfe=Object.assign(t=>{const{type:e,predicate:n,effect:o}=kfe(t);return{id:bfe(),effect:o,type:e,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(_a(22))}}},{withTypes:()=>Dfe}),Ofe=Object.assign(o_(`${zO}/add`),{withTypes:()=>Ofe});o_(`${zO}/removeAll`);var Lfe=Object.assign(o_(`${zO}/remove`),{withTypes:()=>Lfe});function _a(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Bfe={flow:"pre_install",state:"WELCOME",statePath:null,authenticated:!1},DH=W1({name:"counter",initialState:Bfe,reducers:{setFlow:(t,e)=>{t.flow=e.payload,t.statePath=`${t.flow}/${t.state}`},setState:(t,e)=>{t.state=e.payload,t.statePath=`${t.flow}/${t.state}`},setAuthenticated:(t,e)=>{t.authenticated=e.payload}}}),{setFlow:_Se,setState:ySe,setAuthenticated:Ffe}=DH.actions,zfe=DH.reducer;var OH={exports:{}};function Nfe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var eP={exports:{}};const Ufe={},$fe=Object.freeze(Object.defineProperty({__proto__:null,default:Ufe},Symbol.toStringTag,{value:"Module"})),LH=wh($fe);var Q8;function Yn(){return Q8||(Q8=1,function(t,e){(function(n,o){t.exports=o()})(Cn,function(){var n=n||function(o,u){var d;if(typeof window<"u"&&window.crypto&&(d=window.crypto),typeof self<"u"&&self.crypto&&(d=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(d=globalThis.crypto),!d&&typeof window<"u"&&window.msCrypto&&(d=window.msCrypto),!d&&typeof Cn<"u"&&Cn.crypto&&(d=Cn.crypto),!d&&typeof Nfe=="function")try{d=LH}catch{}var _=function(){if(d){if(typeof d.getRandomValues=="function")try{return d.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof d.randomBytes=="function")try{return d.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},v=Object.create||function(){function j(){}return function(H){var Y;return j.prototype=H,Y=new j,j.prototype=null,Y}}(),a={},C=a.lib={},A=C.Base=function(){return{extend:function(j){var H=v(this);return j&&H.mixIn(j),(!H.hasOwnProperty("init")||this.init===H.init)&&(H.init=function(){H.$super.init.apply(this,arguments)}),H.init.prototype=H,H.$super=this,H},create:function(){var j=this.extend();return j.init.apply(j,arguments),j},init:function(){},mixIn:function(j){for(var H in j)j.hasOwnProperty(H)&&(this[H]=j[H]);j.hasOwnProperty("toString")&&(this.toString=j.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),k=C.WordArray=A.extend({init:function(j,H){j=this.words=j||[],H!=u?this.sigBytes=H:this.sigBytes=j.length*4},toString:function(j){return(j||R).stringify(this)},concat:function(j){var H=this.words,Y=j.words,te=this.sigBytes,J=j.sigBytes;if(this.clamp(),te%4)for(var ae=0;ae<J;ae++){var de=Y[ae>>>2]>>>24-ae%4*8&255;H[te+ae>>>2]|=de<<24-(te+ae)%4*8}else for(var Me=0;Me<J;Me+=4)H[te+Me>>>2]=Y[Me>>>2];return this.sigBytes+=J,this},clamp:function(){var j=this.words,H=this.sigBytes;j[H>>>2]&=4294967295<<32-H%4*8,j.length=o.ceil(H/4)},clone:function(){var j=A.clone.call(this);return j.words=this.words.slice(0),j},random:function(j){for(var H=[],Y=0;Y<j;Y+=4)H.push(_());return new k.init(H,j)}}),O=a.enc={},R=O.Hex={stringify:function(j){for(var H=j.words,Y=j.sigBytes,te=[],J=0;J<Y;J++){var ae=H[J>>>2]>>>24-J%4*8&255;te.push((ae>>>4).toString(16)),te.push((ae&15).toString(16))}return te.join("")},parse:function(j){for(var H=j.length,Y=[],te=0;te<H;te+=2)Y[te>>>3]|=parseInt(j.substr(te,2),16)<<24-te%8*4;return new k.init(Y,H/2)}},z=O.Latin1={stringify:function(j){for(var H=j.words,Y=j.sigBytes,te=[],J=0;J<Y;J++){var ae=H[J>>>2]>>>24-J%4*8&255;te.push(String.fromCharCode(ae))}return te.join("")},parse:function(j){for(var H=j.length,Y=[],te=0;te<H;te++)Y[te>>>2]|=(j.charCodeAt(te)&255)<<24-te%4*8;return new k.init(Y,H)}},N=O.Utf8={stringify:function(j){try{return decodeURIComponent(escape(z.stringify(j)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(j){return z.parse(unescape(encodeURIComponent(j)))}},K=C.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new k.init,this._nDataBytes=0},_append:function(j){typeof j=="string"&&(j=N.parse(j)),this._data.concat(j),this._nDataBytes+=j.sigBytes},_process:function(j){var H,Y=this._data,te=Y.words,J=Y.sigBytes,ae=this.blockSize,de=ae*4,Me=J/de;j?Me=o.ceil(Me):Me=o.max((Me|0)-this._minBufferSize,0);var Ce=Me*ae,Ae=o.min(Ce*4,J);if(Ce){for(var Ne=0;Ne<Ce;Ne+=ae)this._doProcessBlock(te,Ne);H=te.splice(0,Ce),Y.sigBytes-=Ae}return new k.init(H,Ae)},clone:function(){var j=A.clone.call(this);return j._data=this._data.clone(),j},_minBufferSize:0});C.Hasher=K.extend({cfg:A.extend(),init:function(j){this.cfg=this.cfg.extend(j),this.reset()},reset:function(){K.reset.call(this),this._doReset()},update:function(j){return this._append(j),this._process(),this},finalize:function(j){j&&this._append(j);var H=this._doFinalize();return H},blockSize:16,_createHelper:function(j){return function(H,Y){return new j.init(Y).finalize(H)}},_createHmacHelper:function(j){return function(H,Y){return new q.HMAC.init(j,Y).finalize(H)}}});var q=a.algo={};return a}(Math);return n})}(eP)),eP.exports}var tP={exports:{}},J8;function kA(){return J8||(J8=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(o){var u=n,d=u.lib,_=d.Base,v=d.WordArray,a=u.x64={};a.Word=_.extend({init:function(C,A){this.high=C,this.low=A}}),a.WordArray=_.extend({init:function(C,A){C=this.words=C||[],A!=o?this.sigBytes=A:this.sigBytes=C.length*8},toX32:function(){for(var C=this.words,A=C.length,k=[],O=0;O<A;O++){var R=C[O];k.push(R.high),k.push(R.low)}return v.create(k,this.sigBytes)},clone:function(){for(var C=_.clone.call(this),A=C.words=this.words.slice(0),k=A.length,O=0;O<k;O++)A[O]=A[O].clone();return C}})}(),n})}(tP)),tP.exports}var rP={exports:{}},e2;function jfe(){return e2||(e2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(){if(typeof ArrayBuffer=="function"){var o=n,u=o.lib,d=u.WordArray,_=d.init,v=d.init=function(a){if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||typeof Uint8ClampedArray<"u"&&a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var C=a.byteLength,A=[],k=0;k<C;k++)A[k>>>2]|=a[k]<<24-k%4*8;_.call(this,A,C)}else _.apply(this,arguments)};v.prototype=d}}(),n.lib.WordArray})}(rP)),rP.exports}var nP={exports:{}},t2;function Vfe(){return t2||(t2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=o.enc;_.Utf16=_.Utf16BE={stringify:function(a){for(var C=a.words,A=a.sigBytes,k=[],O=0;O<A;O+=2){var R=C[O>>>2]>>>16-O%4*8&65535;k.push(String.fromCharCode(R))}return k.join("")},parse:function(a){for(var C=a.length,A=[],k=0;k<C;k++)A[k>>>1]|=a.charCodeAt(k)<<16-k%2*16;return d.create(A,C*2)}},_.Utf16LE={stringify:function(a){for(var C=a.words,A=a.sigBytes,k=[],O=0;O<A;O+=2){var R=v(C[O>>>2]>>>16-O%4*8&65535);k.push(String.fromCharCode(R))}return k.join("")},parse:function(a){for(var C=a.length,A=[],k=0;k<C;k++)A[k>>>1]|=v(a.charCodeAt(k)<<16-k%2*16);return d.create(A,C*2)}};function v(a){return a<<8&4278255360|a>>>8&16711935}}(),n.enc.Utf16})}(nP)),nP.exports}var iP={exports:{}},r2;function vm(){return r2||(r2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=o.enc;_.Base64={stringify:function(a){var C=a.words,A=a.sigBytes,k=this._map;a.clamp();for(var O=[],R=0;R<A;R+=3)for(var z=C[R>>>2]>>>24-R%4*8&255,N=C[R+1>>>2]>>>24-(R+1)%4*8&255,K=C[R+2>>>2]>>>24-(R+2)%4*8&255,q=z<<16|N<<8|K,j=0;j<4&&R+j*.75<A;j++)O.push(k.charAt(q>>>6*(3-j)&63));var H=k.charAt(64);if(H)for(;O.length%4;)O.push(H);return O.join("")},parse:function(a){var C=a.length,A=this._map,k=this._reverseMap;if(!k){k=this._reverseMap=[];for(var O=0;O<A.length;O++)k[A.charCodeAt(O)]=O}var R=A.charAt(64);if(R){var z=a.indexOf(R);z!==-1&&(C=z)}return v(a,C,k)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function v(a,C,A){for(var k=[],O=0,R=0;R<C;R++)if(R%4){var z=A[a.charCodeAt(R-1)]<<R%4*2,N=A[a.charCodeAt(R)]>>>6-R%4*2,K=z|N;k[O>>>2]|=K<<24-O%4*8,O++}return d.create(k,O)}}(),n.enc.Base64})}(iP)),iP.exports}var oP={exports:{}},n2;function Hfe(){return n2||(n2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=o.enc;_.Base64url={stringify:function(a,C){C===void 0&&(C=!0);var A=a.words,k=a.sigBytes,O=C?this._safe_map:this._map;a.clamp();for(var R=[],z=0;z<k;z+=3)for(var N=A[z>>>2]>>>24-z%4*8&255,K=A[z+1>>>2]>>>24-(z+1)%4*8&255,q=A[z+2>>>2]>>>24-(z+2)%4*8&255,j=N<<16|K<<8|q,H=0;H<4&&z+H*.75<k;H++)R.push(O.charAt(j>>>6*(3-H)&63));var Y=O.charAt(64);if(Y)for(;R.length%4;)R.push(Y);return R.join("")},parse:function(a,C){C===void 0&&(C=!0);var A=a.length,k=C?this._safe_map:this._map,O=this._reverseMap;if(!O){O=this._reverseMap=[];for(var R=0;R<k.length;R++)O[k.charCodeAt(R)]=R}var z=k.charAt(64);if(z){var N=a.indexOf(z);N!==-1&&(A=N)}return v(a,A,O)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function v(a,C,A){for(var k=[],O=0,R=0;R<C;R++)if(R%4){var z=A[a.charCodeAt(R-1)]<<R%4*2,N=A[a.charCodeAt(R)]>>>6-R%4*2,K=z|N;k[O>>>2]|=K<<24-O%4*8,O++}return d.create(k,O)}}(),n.enc.Base64url})}(oP)),oP.exports}var sP={exports:{}},i2;function xm(){return i2||(i2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(o){var u=n,d=u.lib,_=d.WordArray,v=d.Hasher,a=u.algo,C=[];(function(){for(var N=0;N<64;N++)C[N]=o.abs(o.sin(N+1))*4294967296|0})();var A=a.MD5=v.extend({_doReset:function(){this._hash=new _.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(N,K){for(var q=0;q<16;q++){var j=K+q,H=N[j];N[j]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360}var Y=this._hash.words,te=N[K+0],J=N[K+1],ae=N[K+2],de=N[K+3],Me=N[K+4],Ce=N[K+5],Ae=N[K+6],Ne=N[K+7],Re=N[K+8],Ye=N[K+9],ht=N[K+10],ft=N[K+11],et=N[K+12],Xe=N[K+13],Mt=N[K+14],Lt=N[K+15],nt=Y[0],at=Y[1],it=Y[2],tt=Y[3];nt=k(nt,at,it,tt,te,7,C[0]),tt=k(tt,nt,at,it,J,12,C[1]),it=k(it,tt,nt,at,ae,17,C[2]),at=k(at,it,tt,nt,de,22,C[3]),nt=k(nt,at,it,tt,Me,7,C[4]),tt=k(tt,nt,at,it,Ce,12,C[5]),it=k(it,tt,nt,at,Ae,17,C[6]),at=k(at,it,tt,nt,Ne,22,C[7]),nt=k(nt,at,it,tt,Re,7,C[8]),tt=k(tt,nt,at,it,Ye,12,C[9]),it=k(it,tt,nt,at,ht,17,C[10]),at=k(at,it,tt,nt,ft,22,C[11]),nt=k(nt,at,it,tt,et,7,C[12]),tt=k(tt,nt,at,it,Xe,12,C[13]),it=k(it,tt,nt,at,Mt,17,C[14]),at=k(at,it,tt,nt,Lt,22,C[15]),nt=O(nt,at,it,tt,J,5,C[16]),tt=O(tt,nt,at,it,Ae,9,C[17]),it=O(it,tt,nt,at,ft,14,C[18]),at=O(at,it,tt,nt,te,20,C[19]),nt=O(nt,at,it,tt,Ce,5,C[20]),tt=O(tt,nt,at,it,ht,9,C[21]),it=O(it,tt,nt,at,Lt,14,C[22]),at=O(at,it,tt,nt,Me,20,C[23]),nt=O(nt,at,it,tt,Ye,5,C[24]),tt=O(tt,nt,at,it,Mt,9,C[25]),it=O(it,tt,nt,at,de,14,C[26]),at=O(at,it,tt,nt,Re,20,C[27]),nt=O(nt,at,it,tt,Xe,5,C[28]),tt=O(tt,nt,at,it,ae,9,C[29]),it=O(it,tt,nt,at,Ne,14,C[30]),at=O(at,it,tt,nt,et,20,C[31]),nt=R(nt,at,it,tt,Ce,4,C[32]),tt=R(tt,nt,at,it,Re,11,C[33]),it=R(it,tt,nt,at,ft,16,C[34]),at=R(at,it,tt,nt,Mt,23,C[35]),nt=R(nt,at,it,tt,J,4,C[36]),tt=R(tt,nt,at,it,Me,11,C[37]),it=R(it,tt,nt,at,Ne,16,C[38]),at=R(at,it,tt,nt,ht,23,C[39]),nt=R(nt,at,it,tt,Xe,4,C[40]),tt=R(tt,nt,at,it,te,11,C[41]),it=R(it,tt,nt,at,de,16,C[42]),at=R(at,it,tt,nt,Ae,23,C[43]),nt=R(nt,at,it,tt,Ye,4,C[44]),tt=R(tt,nt,at,it,et,11,C[45]),it=R(it,tt,nt,at,Lt,16,C[46]),at=R(at,it,tt,nt,ae,23,C[47]),nt=z(nt,at,it,tt,te,6,C[48]),tt=z(tt,nt,at,it,Ne,10,C[49]),it=z(it,tt,nt,at,Mt,15,C[50]),at=z(at,it,tt,nt,Ce,21,C[51]),nt=z(nt,at,it,tt,et,6,C[52]),tt=z(tt,nt,at,it,de,10,C[53]),it=z(it,tt,nt,at,ht,15,C[54]),at=z(at,it,tt,nt,J,21,C[55]),nt=z(nt,at,it,tt,Re,6,C[56]),tt=z(tt,nt,at,it,Lt,10,C[57]),it=z(it,tt,nt,at,Ae,15,C[58]),at=z(at,it,tt,nt,Xe,21,C[59]),nt=z(nt,at,it,tt,Me,6,C[60]),tt=z(tt,nt,at,it,ft,10,C[61]),it=z(it,tt,nt,at,ae,15,C[62]),at=z(at,it,tt,nt,Ye,21,C[63]),Y[0]=Y[0]+nt|0,Y[1]=Y[1]+at|0,Y[2]=Y[2]+it|0,Y[3]=Y[3]+tt|0},_doFinalize:function(){var N=this._data,K=N.words,q=this._nDataBytes*8,j=N.sigBytes*8;K[j>>>5]|=128<<24-j%32;var H=o.floor(q/4294967296),Y=q;K[(j+64>>>9<<4)+15]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,K[(j+64>>>9<<4)+14]=(Y<<8|Y>>>24)&16711935|(Y<<24|Y>>>8)&4278255360,N.sigBytes=(K.length+1)*4,this._process();for(var te=this._hash,J=te.words,ae=0;ae<4;ae++){var de=J[ae];J[ae]=(de<<8|de>>>24)&16711935|(de<<24|de>>>8)&4278255360}return te},clone:function(){var N=v.clone.call(this);return N._hash=this._hash.clone(),N}});function k(N,K,q,j,H,Y,te){var J=N+(K&q|~K&j)+H+te;return(J<<Y|J>>>32-Y)+K}function O(N,K,q,j,H,Y,te){var J=N+(K&j|q&~j)+H+te;return(J<<Y|J>>>32-Y)+K}function R(N,K,q,j,H,Y,te){var J=N+(K^q^j)+H+te;return(J<<Y|J>>>32-Y)+K}function z(N,K,q,j,H,Y,te){var J=N+(q^(K|~j))+H+te;return(J<<Y|J>>>32-Y)+K}u.MD5=v._createHelper(A),u.HmacMD5=v._createHmacHelper(A)}(Math),n.MD5})}(sP)),sP.exports}var aP={exports:{}},o2;function BH(){return o2||(o2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=u.Hasher,v=o.algo,a=[],C=v.SHA1=_.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,k){for(var O=this._hash.words,R=O[0],z=O[1],N=O[2],K=O[3],q=O[4],j=0;j<80;j++){if(j<16)a[j]=A[k+j]|0;else{var H=a[j-3]^a[j-8]^a[j-14]^a[j-16];a[j]=H<<1|H>>>31}var Y=(R<<5|R>>>27)+q+a[j];j<20?Y+=(z&N|~z&K)+1518500249:j<40?Y+=(z^N^K)+1859775393:j<60?Y+=(z&N|z&K|N&K)-1894007588:Y+=(z^N^K)-899497514,q=K,K=N,N=z<<30|z>>>2,z=R,R=Y}O[0]=O[0]+R|0,O[1]=O[1]+z|0,O[2]=O[2]+N|0,O[3]=O[3]+K|0,O[4]=O[4]+q|0},_doFinalize:function(){var A=this._data,k=A.words,O=this._nDataBytes*8,R=A.sigBytes*8;return k[R>>>5]|=128<<24-R%32,k[(R+64>>>9<<4)+14]=Math.floor(O/4294967296),k[(R+64>>>9<<4)+15]=O,A.sigBytes=k.length*4,this._process(),this._hash},clone:function(){var A=_.clone.call(this);return A._hash=this._hash.clone(),A}});o.SHA1=_._createHelper(C),o.HmacSHA1=_._createHmacHelper(C)}(),n.SHA1})}(aP)),aP.exports}var lP={exports:{}},s2;function NO(){return s2||(s2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){return function(o){var u=n,d=u.lib,_=d.WordArray,v=d.Hasher,a=u.algo,C=[],A=[];(function(){function R(q){for(var j=o.sqrt(q),H=2;H<=j;H++)if(!(q%H))return!1;return!0}function z(q){return(q-(q|0))*4294967296|0}for(var N=2,K=0;K<64;)R(N)&&(K<8&&(C[K]=z(o.pow(N,1/2))),A[K]=z(o.pow(N,1/3)),K++),N++})();var k=[],O=a.SHA256=v.extend({_doReset:function(){this._hash=new _.init(C.slice(0))},_doProcessBlock:function(R,z){for(var N=this._hash.words,K=N[0],q=N[1],j=N[2],H=N[3],Y=N[4],te=N[5],J=N[6],ae=N[7],de=0;de<64;de++){if(de<16)k[de]=R[z+de]|0;else{var Me=k[de-15],Ce=(Me<<25|Me>>>7)^(Me<<14|Me>>>18)^Me>>>3,Ae=k[de-2],Ne=(Ae<<15|Ae>>>17)^(Ae<<13|Ae>>>19)^Ae>>>10;k[de]=Ce+k[de-7]+Ne+k[de-16]}var Re=Y&te^~Y&J,Ye=K&q^K&j^q&j,ht=(K<<30|K>>>2)^(K<<19|K>>>13)^(K<<10|K>>>22),ft=(Y<<26|Y>>>6)^(Y<<21|Y>>>11)^(Y<<7|Y>>>25),et=ae+ft+Re+A[de]+k[de],Xe=ht+Ye;ae=J,J=te,te=Y,Y=H+et|0,H=j,j=q,q=K,K=et+Xe|0}N[0]=N[0]+K|0,N[1]=N[1]+q|0,N[2]=N[2]+j|0,N[3]=N[3]+H|0,N[4]=N[4]+Y|0,N[5]=N[5]+te|0,N[6]=N[6]+J|0,N[7]=N[7]+ae|0},_doFinalize:function(){var R=this._data,z=R.words,N=this._nDataBytes*8,K=R.sigBytes*8;return z[K>>>5]|=128<<24-K%32,z[(K+64>>>9<<4)+14]=o.floor(N/4294967296),z[(K+64>>>9<<4)+15]=N,R.sigBytes=z.length*4,this._process(),this._hash},clone:function(){var R=v.clone.call(this);return R._hash=this._hash.clone(),R}});u.SHA256=v._createHelper(O),u.HmacSHA256=v._createHmacHelper(O)}(Math),n.SHA256})}(lP)),lP.exports}var cP={exports:{}},a2;function Gfe(){return a2||(a2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),NO())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=o.algo,v=_.SHA256,a=_.SHA224=v.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var C=v._doFinalize.call(this);return C.sigBytes-=4,C}});o.SHA224=v._createHelper(a),o.HmacSHA224=v._createHmacHelper(a)}(),n.SHA224})}(cP)),cP.exports}var uP={exports:{}},l2;function FH(){return l2||(l2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),kA())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.Hasher,_=o.x64,v=_.Word,a=_.WordArray,C=o.algo;function A(){return v.create.apply(v,arguments)}var k=[A(1116352408,3609767458),A(1899447441,602891725),A(3049323471,3964484399),A(3921009573,2173295548),A(961987163,4081628472),A(1508970993,3053834265),A(2453635748,2937671579),A(2870763221,3664609560),A(3624381080,2734883394),A(310598401,1164996542),A(607225278,1323610764),A(1426881987,3590304994),A(1925078388,4068182383),A(2162078206,991336113),A(2614888103,633803317),A(3248222580,3479774868),A(3835390401,2666613458),A(4022224774,944711139),A(264347078,2341262773),A(604807628,2007800933),A(770255983,1495990901),A(1249150122,1856431235),A(1555081692,3175218132),A(1996064986,2198950837),A(2554220882,3999719339),A(2821834349,766784016),A(2952996808,2566594879),A(3210313671,3203337956),A(3336571891,1034457026),A(3584528711,2466948901),A(113926993,3758326383),A(338241895,168717936),A(666307205,1188179964),A(773529912,1546045734),A(1294757372,1522805485),A(1396182291,2643833823),A(1695183700,2343527390),A(1986661051,1014477480),A(2177026350,1206759142),A(2456956037,344077627),A(2730485921,1290863460),A(2820302411,3158454273),A(3259730800,3505952657),A(3345764771,106217008),A(3516065817,3606008344),A(3600352804,1432725776),A(4094571909,1467031594),A(275423344,851169720),A(430227734,3100823752),A(506948616,1363258195),A(659060556,3750685593),A(883997877,3785050280),A(958139571,3318307427),A(1322822218,3812723403),A(1537002063,2003034995),A(1747873779,3602036899),A(1955562222,1575990012),A(2024104815,1125592928),A(2227730452,2716904306),A(2361852424,442776044),A(2428436474,593698344),A(2756734187,3733110249),A(3204031479,2999351573),A(3329325298,3815920427),A(3391569614,3928383900),A(3515267271,566280711),A(3940187606,3454069534),A(4118630271,4000239992),A(116418474,1914138554),A(174292421,2731055270),A(289380356,3203993006),A(460393269,320620315),A(685471733,587496836),A(852142971,1086792851),A(1017036298,365543100),A(1126000580,2618297676),A(1288033470,3409855158),A(1501505948,4234509866),A(1607167915,987167468),A(1816402316,1246189591)],O=[];(function(){for(var z=0;z<80;z++)O[z]=A()})();var R=C.SHA512=d.extend({_doReset:function(){this._hash=new a.init([new v.init(1779033703,4089235720),new v.init(3144134277,2227873595),new v.init(1013904242,4271175723),new v.init(2773480762,1595750129),new v.init(1359893119,2917565137),new v.init(2600822924,725511199),new v.init(528734635,4215389547),new v.init(1541459225,327033209)])},_doProcessBlock:function(z,N){for(var K=this._hash.words,q=K[0],j=K[1],H=K[2],Y=K[3],te=K[4],J=K[5],ae=K[6],de=K[7],Me=q.high,Ce=q.low,Ae=j.high,Ne=j.low,Re=H.high,Ye=H.low,ht=Y.high,ft=Y.low,et=te.high,Xe=te.low,Mt=J.high,Lt=J.low,nt=ae.high,at=ae.low,it=de.high,tt=de.low,Jt=Me,$t=Ce,Lr=Ae,rr=Ne,Zt=Re,dn=Ye,dr=ht,Ur=ft,Tr=et,wr=Xe,Er=Mt,Zn=Lt,fn=nt,pn=at,li=it,or=tt,Yt=0;Yt<80;Yt++){var un,_n,rn=O[Yt];if(Yt<16)_n=rn.high=z[N+Yt*2]|0,un=rn.low=z[N+Yt*2+1]|0;else{var ri=O[Yt-15],Ln=ri.high,Vn=ri.low,Xr=(Ln>>>1|Vn<<31)^(Ln>>>8|Vn<<24)^Ln>>>7,yr=(Vn>>>1|Ln<<31)^(Vn>>>8|Ln<<24)^(Vn>>>7|Ln<<25),xi=O[Yt-2],Ei=xi.high,$i=xi.low,vr=(Ei>>>19|$i<<13)^(Ei<<3|$i>>>29)^Ei>>>6,nn=($i>>>19|Ei<<13)^($i<<3|Ei>>>29)^($i>>>6|Ei<<26),Hn=O[Yt-7],cr=Hn.high,Is=Hn.low,Mn=O[Yt-16],Xi=Mn.high,_o=Mn.low;un=yr+Is,_n=Xr+cr+(un>>>0<yr>>>0?1:0),un=un+nn,_n=_n+vr+(un>>>0<nn>>>0?1:0),un=un+_o,_n=_n+Xi+(un>>>0<_o>>>0?1:0),rn.high=_n,rn.low=un}var ci=Tr&Er^~Tr&fn,Bi=wr&Zn^~wr&pn,Ms=Jt&Lr^Jt&Zt^Lr&Zt,fs=$t&rr^$t&dn^rr&dn,Cr=(Jt>>>28|$t<<4)^(Jt<<30|$t>>>2)^(Jt<<25|$t>>>7),Je=($t>>>28|Jt<<4)^($t<<30|Jt>>>2)^($t<<25|Jt>>>7),Vt=(Tr>>>14|wr<<18)^(Tr>>>18|wr<<14)^(Tr<<23|wr>>>9),Ct=(wr>>>14|Tr<<18)^(wr>>>18|Tr<<14)^(wr<<23|Tr>>>9),Wt=k[Yt],ir=Wt.high,ur=Wt.low,Be=or+Ct,ze=li+Vt+(Be>>>0<or>>>0?1:0),Be=Be+Bi,ze=ze+ci+(Be>>>0<Bi>>>0?1:0),Be=Be+ur,ze=ze+ir+(Be>>>0<ur>>>0?1:0),Be=Be+un,ze=ze+_n+(Be>>>0<un>>>0?1:0),lt=Je+fs,mt=Cr+Ms+(lt>>>0<Je>>>0?1:0);li=fn,or=pn,fn=Er,pn=Zn,Er=Tr,Zn=wr,wr=Ur+Be|0,Tr=dr+ze+(wr>>>0<Ur>>>0?1:0)|0,dr=Zt,Ur=dn,Zt=Lr,dn=rr,Lr=Jt,rr=$t,$t=Be+lt|0,Jt=ze+mt+($t>>>0<Be>>>0?1:0)|0}Ce=q.low=Ce+$t,q.high=Me+Jt+(Ce>>>0<$t>>>0?1:0),Ne=j.low=Ne+rr,j.high=Ae+Lr+(Ne>>>0<rr>>>0?1:0),Ye=H.low=Ye+dn,H.high=Re+Zt+(Ye>>>0<dn>>>0?1:0),ft=Y.low=ft+Ur,Y.high=ht+dr+(ft>>>0<Ur>>>0?1:0),Xe=te.low=Xe+wr,te.high=et+Tr+(Xe>>>0<wr>>>0?1:0),Lt=J.low=Lt+Zn,J.high=Mt+Er+(Lt>>>0<Zn>>>0?1:0),at=ae.low=at+pn,ae.high=nt+fn+(at>>>0<pn>>>0?1:0),tt=de.low=tt+or,de.high=it+li+(tt>>>0<or>>>0?1:0)},_doFinalize:function(){var z=this._data,N=z.words,K=this._nDataBytes*8,q=z.sigBytes*8;N[q>>>5]|=128<<24-q%32,N[(q+128>>>10<<5)+30]=Math.floor(K/4294967296),N[(q+128>>>10<<5)+31]=K,z.sigBytes=N.length*4,this._process();var j=this._hash.toX32();return j},clone:function(){var z=d.clone.call(this);return z._hash=this._hash.clone(),z},blockSize:1024/32});o.SHA512=d._createHelper(R),o.HmacSHA512=d._createHmacHelper(R)}(),n.SHA512})}(uP)),uP.exports}var hP={exports:{}},c2;function Wfe(){return c2||(c2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),kA(),FH())})(Cn,function(n){return function(){var o=n,u=o.x64,d=u.Word,_=u.WordArray,v=o.algo,a=v.SHA512,C=v.SHA384=a.extend({_doReset:function(){this._hash=new _.init([new d.init(3418070365,3238371032),new d.init(1654270250,914150663),new d.init(2438529370,812702999),new d.init(355462360,4144912697),new d.init(1731405415,4290775857),new d.init(2394180231,1750603025),new d.init(3675008525,1694076839),new d.init(1203062813,3204075428)])},_doFinalize:function(){var A=a._doFinalize.call(this);return A.sigBytes-=16,A}});o.SHA384=a._createHelper(C),o.HmacSHA384=a._createHmacHelper(C)}(),n.SHA384})}(hP)),hP.exports}var dP={exports:{}},u2;function qfe(){return u2||(u2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),kA())})(Cn,function(n){return function(o){var u=n,d=u.lib,_=d.WordArray,v=d.Hasher,a=u.x64,C=a.Word,A=u.algo,k=[],O=[],R=[];(function(){for(var K=1,q=0,j=0;j<24;j++){k[K+5*q]=(j+1)*(j+2)/2%64;var H=q%5,Y=(2*K+3*q)%5;K=H,q=Y}for(var K=0;K<5;K++)for(var q=0;q<5;q++)O[K+5*q]=q+(2*K+3*q)%5*5;for(var te=1,J=0;J<24;J++){for(var ae=0,de=0,Me=0;Me<7;Me++){if(te&1){var Ce=(1<<Me)-1;Ce<32?de^=1<<Ce:ae^=1<<Ce-32}te&128?te=te<<1^113:te<<=1}R[J]=C.create(ae,de)}})();var z=[];(function(){for(var K=0;K<25;K++)z[K]=C.create()})();var N=A.SHA3=v.extend({cfg:v.cfg.extend({outputLength:512}),_doReset:function(){for(var K=this._state=[],q=0;q<25;q++)K[q]=new C.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(K,q){for(var j=this._state,H=this.blockSize/2,Y=0;Y<H;Y++){var te=K[q+2*Y],J=K[q+2*Y+1];te=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360,J=(J<<8|J>>>24)&16711935|(J<<24|J>>>8)&4278255360;var ae=j[Y];ae.high^=J,ae.low^=te}for(var de=0;de<24;de++){for(var Me=0;Me<5;Me++){for(var Ce=0,Ae=0,Ne=0;Ne<5;Ne++){var ae=j[Me+5*Ne];Ce^=ae.high,Ae^=ae.low}var Re=z[Me];Re.high=Ce,Re.low=Ae}for(var Me=0;Me<5;Me++)for(var Ye=z[(Me+4)%5],ht=z[(Me+1)%5],ft=ht.high,et=ht.low,Ce=Ye.high^(ft<<1|et>>>31),Ae=Ye.low^(et<<1|ft>>>31),Ne=0;Ne<5;Ne++){var ae=j[Me+5*Ne];ae.high^=Ce,ae.low^=Ae}for(var Xe=1;Xe<25;Xe++){var Ce,Ae,ae=j[Xe],Mt=ae.high,Lt=ae.low,nt=k[Xe];nt<32?(Ce=Mt<<nt|Lt>>>32-nt,Ae=Lt<<nt|Mt>>>32-nt):(Ce=Lt<<nt-32|Mt>>>64-nt,Ae=Mt<<nt-32|Lt>>>64-nt);var at=z[O[Xe]];at.high=Ce,at.low=Ae}var it=z[0],tt=j[0];it.high=tt.high,it.low=tt.low;for(var Me=0;Me<5;Me++)for(var Ne=0;Ne<5;Ne++){var Xe=Me+5*Ne,ae=j[Xe],Jt=z[Xe],$t=z[(Me+1)%5+5*Ne],Lr=z[(Me+2)%5+5*Ne];ae.high=Jt.high^~$t.high&Lr.high,ae.low=Jt.low^~$t.low&Lr.low}var ae=j[0],rr=R[de];ae.high^=rr.high,ae.low^=rr.low}},_doFinalize:function(){var K=this._data,q=K.words;this._nDataBytes*8;var j=K.sigBytes*8,H=this.blockSize*32;q[j>>>5]|=1<<24-j%32,q[(o.ceil((j+1)/H)*H>>>5)-1]|=128,K.sigBytes=q.length*4,this._process();for(var Y=this._state,te=this.cfg.outputLength/8,J=te/8,ae=[],de=0;de<J;de++){var Me=Y[de],Ce=Me.high,Ae=Me.low;Ce=(Ce<<8|Ce>>>24)&16711935|(Ce<<24|Ce>>>8)&4278255360,Ae=(Ae<<8|Ae>>>24)&16711935|(Ae<<24|Ae>>>8)&4278255360,ae.push(Ae),ae.push(Ce)}return new _.init(ae,te)},clone:function(){for(var K=v.clone.call(this),q=K._state=this._state.slice(0),j=0;j<25;j++)q[j]=q[j].clone();return K}});u.SHA3=v._createHelper(N),u.HmacSHA3=v._createHmacHelper(N)}(Math),n.SHA3})}(dP)),dP.exports}var fP={exports:{}},h2;function Kfe(){return h2||(h2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(o){var u=n,d=u.lib,_=d.WordArray,v=d.Hasher,a=u.algo,C=_.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),A=_.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),k=_.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),O=_.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),R=_.create([0,1518500249,1859775393,2400959708,2840853838]),z=_.create([1352829926,1548603684,1836072691,2053994217,0]),N=a.RIPEMD160=v.extend({_doReset:function(){this._hash=_.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(J,ae){for(var de=0;de<16;de++){var Me=ae+de,Ce=J[Me];J[Me]=(Ce<<8|Ce>>>24)&16711935|(Ce<<24|Ce>>>8)&4278255360}var Ae=this._hash.words,Ne=R.words,Re=z.words,Ye=C.words,ht=A.words,ft=k.words,et=O.words,Xe,Mt,Lt,nt,at,it,tt,Jt,$t,Lr;it=Xe=Ae[0],tt=Mt=Ae[1],Jt=Lt=Ae[2],$t=nt=Ae[3],Lr=at=Ae[4];for(var rr,de=0;de<80;de+=1)rr=Xe+J[ae+Ye[de]]|0,de<16?rr+=K(Mt,Lt,nt)+Ne[0]:de<32?rr+=q(Mt,Lt,nt)+Ne[1]:de<48?rr+=j(Mt,Lt,nt)+Ne[2]:de<64?rr+=H(Mt,Lt,nt)+Ne[3]:rr+=Y(Mt,Lt,nt)+Ne[4],rr=rr|0,rr=te(rr,ft[de]),rr=rr+at|0,Xe=at,at=nt,nt=te(Lt,10),Lt=Mt,Mt=rr,rr=it+J[ae+ht[de]]|0,de<16?rr+=Y(tt,Jt,$t)+Re[0]:de<32?rr+=H(tt,Jt,$t)+Re[1]:de<48?rr+=j(tt,Jt,$t)+Re[2]:de<64?rr+=q(tt,Jt,$t)+Re[3]:rr+=K(tt,Jt,$t)+Re[4],rr=rr|0,rr=te(rr,et[de]),rr=rr+Lr|0,it=Lr,Lr=$t,$t=te(Jt,10),Jt=tt,tt=rr;rr=Ae[1]+Lt+$t|0,Ae[1]=Ae[2]+nt+Lr|0,Ae[2]=Ae[3]+at+it|0,Ae[3]=Ae[4]+Xe+tt|0,Ae[4]=Ae[0]+Mt+Jt|0,Ae[0]=rr},_doFinalize:function(){var J=this._data,ae=J.words,de=this._nDataBytes*8,Me=J.sigBytes*8;ae[Me>>>5]|=128<<24-Me%32,ae[(Me+64>>>9<<4)+14]=(de<<8|de>>>24)&16711935|(de<<24|de>>>8)&4278255360,J.sigBytes=(ae.length+1)*4,this._process();for(var Ce=this._hash,Ae=Ce.words,Ne=0;Ne<5;Ne++){var Re=Ae[Ne];Ae[Ne]=(Re<<8|Re>>>24)&16711935|(Re<<24|Re>>>8)&4278255360}return Ce},clone:function(){var J=v.clone.call(this);return J._hash=this._hash.clone(),J}});function K(J,ae,de){return J^ae^de}function q(J,ae,de){return J&ae|~J&de}function j(J,ae,de){return(J|~ae)^de}function H(J,ae,de){return J&de|ae&~de}function Y(J,ae,de){return J^(ae|~de)}function te(J,ae){return J<<ae|J>>>32-ae}u.RIPEMD160=v._createHelper(N),u.HmacRIPEMD160=v._createHmacHelper(N)}(),n.RIPEMD160})}(fP)),fP.exports}var pP={exports:{}},d2;function UO(){return d2||(d2=1,function(t,e){(function(n,o){t.exports=o(Yn())})(Cn,function(n){(function(){var o=n,u=o.lib,d=u.Base,_=o.enc,v=_.Utf8,a=o.algo;a.HMAC=d.extend({init:function(C,A){C=this._hasher=new C.init,typeof A=="string"&&(A=v.parse(A));var k=C.blockSize,O=k*4;A.sigBytes>O&&(A=C.finalize(A)),A.clamp();for(var R=this._oKey=A.clone(),z=this._iKey=A.clone(),N=R.words,K=z.words,q=0;q<k;q++)N[q]^=1549556828,K[q]^=909522486;R.sigBytes=z.sigBytes=O,this.reset()},reset:function(){var C=this._hasher;C.reset(),C.update(this._iKey)},update:function(C){return this._hasher.update(C),this},finalize:function(C){var A=this._hasher,k=A.finalize(C);A.reset();var O=A.finalize(this._oKey.clone().concat(k));return O}})})()})}(pP)),pP.exports}var mP={exports:{}},f2;function Yfe(){return f2||(f2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),NO(),UO())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.Base,_=u.WordArray,v=o.algo,a=v.SHA256,C=v.HMAC,A=v.PBKDF2=d.extend({cfg:d.extend({keySize:128/32,hasher:a,iterations:25e4}),init:function(k){this.cfg=this.cfg.extend(k)},compute:function(k,O){for(var R=this.cfg,z=C.create(R.hasher,k),N=_.create(),K=_.create([1]),q=N.words,j=K.words,H=R.keySize,Y=R.iterations;q.length<H;){var te=z.update(O).finalize(K);z.reset();for(var J=te.words,ae=J.length,de=te,Me=1;Me<Y;Me++){de=z.finalize(de),z.reset();for(var Ce=de.words,Ae=0;Ae<ae;Ae++)J[Ae]^=Ce[Ae]}N.concat(te),j[0]++}return N.sigBytes=H*4,N}});o.PBKDF2=function(k,O,R){return A.create(R).compute(k,O)}}(),n.PBKDF2})}(mP)),mP.exports}var gP={exports:{}},p2;function mf(){return p2||(p2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),BH(),UO())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.Base,_=u.WordArray,v=o.algo,a=v.MD5,C=v.EvpKDF=d.extend({cfg:d.extend({keySize:128/32,hasher:a,iterations:1}),init:function(A){this.cfg=this.cfg.extend(A)},compute:function(A,k){for(var O,R=this.cfg,z=R.hasher.create(),N=_.create(),K=N.words,q=R.keySize,j=R.iterations;K.length<q;){O&&z.update(O),O=z.update(A).finalize(k),z.reset();for(var H=1;H<j;H++)O=z.finalize(O),z.reset();N.concat(O)}return N.sigBytes=q*4,N}});o.EvpKDF=function(A,k,O){return C.create(O).compute(A,k)}}(),n.EvpKDF})}(gP)),gP.exports}var _P={exports:{}},m2;function ds(){return m2||(m2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),mf())})(Cn,function(n){n.lib.Cipher||function(o){var u=n,d=u.lib,_=d.Base,v=d.WordArray,a=d.BufferedBlockAlgorithm,C=u.enc;C.Utf8;var A=C.Base64,k=u.algo,O=k.EvpKDF,R=d.Cipher=a.extend({cfg:_.extend(),createEncryptor:function(Ce,Ae){return this.create(this._ENC_XFORM_MODE,Ce,Ae)},createDecryptor:function(Ce,Ae){return this.create(this._DEC_XFORM_MODE,Ce,Ae)},init:function(Ce,Ae,Ne){this.cfg=this.cfg.extend(Ne),this._xformMode=Ce,this._key=Ae,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(Ce){return this._append(Ce),this._process()},finalize:function(Ce){Ce&&this._append(Ce);var Ae=this._doFinalize();return Ae},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Ce(Ae){return typeof Ae=="string"?Me:J}return function(Ae){return{encrypt:function(Ne,Re,Ye){return Ce(Re).encrypt(Ae,Ne,Re,Ye)},decrypt:function(Ne,Re,Ye){return Ce(Re).decrypt(Ae,Ne,Re,Ye)}}}}()});d.StreamCipher=R.extend({_doFinalize:function(){var Ce=this._process(!0);return Ce},blockSize:1});var z=u.mode={},N=d.BlockCipherMode=_.extend({createEncryptor:function(Ce,Ae){return this.Encryptor.create(Ce,Ae)},createDecryptor:function(Ce,Ae){return this.Decryptor.create(Ce,Ae)},init:function(Ce,Ae){this._cipher=Ce,this._iv=Ae}}),K=z.CBC=function(){var Ce=N.extend();Ce.Encryptor=Ce.extend({processBlock:function(Ne,Re){var Ye=this._cipher,ht=Ye.blockSize;Ae.call(this,Ne,Re,ht),Ye.encryptBlock(Ne,Re),this._prevBlock=Ne.slice(Re,Re+ht)}}),Ce.Decryptor=Ce.extend({processBlock:function(Ne,Re){var Ye=this._cipher,ht=Ye.blockSize,ft=Ne.slice(Re,Re+ht);Ye.decryptBlock(Ne,Re),Ae.call(this,Ne,Re,ht),this._prevBlock=ft}});function Ae(Ne,Re,Ye){var ht,ft=this._iv;ft?(ht=ft,this._iv=o):ht=this._prevBlock;for(var et=0;et<Ye;et++)Ne[Re+et]^=ht[et]}return Ce}(),q=u.pad={},j=q.Pkcs7={pad:function(Ce,Ae){for(var Ne=Ae*4,Re=Ne-Ce.sigBytes%Ne,Ye=Re<<24|Re<<16|Re<<8|Re,ht=[],ft=0;ft<Re;ft+=4)ht.push(Ye);var et=v.create(ht,Re);Ce.concat(et)},unpad:function(Ce){var Ae=Ce.words[Ce.sigBytes-1>>>2]&255;Ce.sigBytes-=Ae}};d.BlockCipher=R.extend({cfg:R.cfg.extend({mode:K,padding:j}),reset:function(){var Ce;R.reset.call(this);var Ae=this.cfg,Ne=Ae.iv,Re=Ae.mode;this._xformMode==this._ENC_XFORM_MODE?Ce=Re.createEncryptor:(Ce=Re.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Ce?this._mode.init(this,Ne&&Ne.words):(this._mode=Ce.call(Re,this,Ne&&Ne.words),this._mode.__creator=Ce)},_doProcessBlock:function(Ce,Ae){this._mode.processBlock(Ce,Ae)},_doFinalize:function(){var Ce,Ae=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Ae.pad(this._data,this.blockSize),Ce=this._process(!0)):(Ce=this._process(!0),Ae.unpad(Ce)),Ce},blockSize:128/32});var H=d.CipherParams=_.extend({init:function(Ce){this.mixIn(Ce)},toString:function(Ce){return(Ce||this.formatter).stringify(this)}}),Y=u.format={},te=Y.OpenSSL={stringify:function(Ce){var Ae,Ne=Ce.ciphertext,Re=Ce.salt;return Re?Ae=v.create([1398893684,1701076831]).concat(Re).concat(Ne):Ae=Ne,Ae.toString(A)},parse:function(Ce){var Ae,Ne=A.parse(Ce),Re=Ne.words;return Re[0]==1398893684&&Re[1]==1701076831&&(Ae=v.create(Re.slice(2,4)),Re.splice(0,4),Ne.sigBytes-=16),H.create({ciphertext:Ne,salt:Ae})}},J=d.SerializableCipher=_.extend({cfg:_.extend({format:te}),encrypt:function(Ce,Ae,Ne,Re){Re=this.cfg.extend(Re);var Ye=Ce.createEncryptor(Ne,Re),ht=Ye.finalize(Ae),ft=Ye.cfg;return H.create({ciphertext:ht,key:Ne,iv:ft.iv,algorithm:Ce,mode:ft.mode,padding:ft.padding,blockSize:Ce.blockSize,formatter:Re.format})},decrypt:function(Ce,Ae,Ne,Re){Re=this.cfg.extend(Re),Ae=this._parse(Ae,Re.format);var Ye=Ce.createDecryptor(Ne,Re).finalize(Ae.ciphertext);return Ye},_parse:function(Ce,Ae){return typeof Ce=="string"?Ae.parse(Ce,this):Ce}}),ae=u.kdf={},de=ae.OpenSSL={execute:function(Ce,Ae,Ne,Re,Ye){if(Re||(Re=v.random(64/8)),Ye)var ht=O.create({keySize:Ae+Ne,hasher:Ye}).compute(Ce,Re);else var ht=O.create({keySize:Ae+Ne}).compute(Ce,Re);var ft=v.create(ht.words.slice(Ae),Ne*4);return ht.sigBytes=Ae*4,H.create({key:ht,iv:ft,salt:Re})}},Me=d.PasswordBasedCipher=J.extend({cfg:J.cfg.extend({kdf:de}),encrypt:function(Ce,Ae,Ne,Re){Re=this.cfg.extend(Re);var Ye=Re.kdf.execute(Ne,Ce.keySize,Ce.ivSize,Re.salt,Re.hasher);Re.iv=Ye.iv;var ht=J.encrypt.call(this,Ce,Ae,Ye.key,Re);return ht.mixIn(Ye),ht},decrypt:function(Ce,Ae,Ne,Re){Re=this.cfg.extend(Re),Ae=this._parse(Ae,Re.format);var Ye=Re.kdf.execute(Ne,Ce.keySize,Ce.ivSize,Ae.salt,Re.hasher);Re.iv=Ye.iv;var ht=J.decrypt.call(this,Ce,Ae,Ye.key,Re);return ht}})}()})}(_P)),_P.exports}var yP={exports:{}},g2;function Zfe(){return g2||(g2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.mode.CFB=function(){var o=n.lib.BlockCipherMode.extend();o.Encryptor=o.extend({processBlock:function(d,_){var v=this._cipher,a=v.blockSize;u.call(this,d,_,a,v),this._prevBlock=d.slice(_,_+a)}}),o.Decryptor=o.extend({processBlock:function(d,_){var v=this._cipher,a=v.blockSize,C=d.slice(_,_+a);u.call(this,d,_,a,v),this._prevBlock=C}});function u(d,_,v,a){var C,A=this._iv;A?(C=A.slice(0),this._iv=void 0):C=this._prevBlock,a.encryptBlock(C,0);for(var k=0;k<v;k++)d[_+k]^=C[k]}return o}(),n.mode.CFB})}(yP)),yP.exports}var vP={exports:{}},_2;function Xfe(){return _2||(_2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.mode.CTR=function(){var o=n.lib.BlockCipherMode.extend(),u=o.Encryptor=o.extend({processBlock:function(d,_){var v=this._cipher,a=v.blockSize,C=this._iv,A=this._counter;C&&(A=this._counter=C.slice(0),this._iv=void 0);var k=A.slice(0);v.encryptBlock(k,0),A[a-1]=A[a-1]+1|0;for(var O=0;O<a;O++)d[_+O]^=k[O]}});return o.Decryptor=u,o}(),n.mode.CTR})}(vP)),vP.exports}var xP={exports:{}},y2;function Qfe(){return y2||(y2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var o=n.lib.BlockCipherMode.extend();function u(v){if((v>>24&255)===255){var a=v>>16&255,C=v>>8&255,A=v&255;a===255?(a=0,C===255?(C=0,A===255?A=0:++A):++C):++a,v=0,v+=a<<16,v+=C<<8,v+=A}else v+=1<<24;return v}function d(v){return(v[0]=u(v[0]))===0&&(v[1]=u(v[1])),v}var _=o.Encryptor=o.extend({processBlock:function(v,a){var C=this._cipher,A=C.blockSize,k=this._iv,O=this._counter;k&&(O=this._counter=k.slice(0),this._iv=void 0),d(O);var R=O.slice(0);C.encryptBlock(R,0);for(var z=0;z<A;z++)v[a+z]^=R[z]}});return o.Decryptor=_,o}(),n.mode.CTRGladman})}(xP)),xP.exports}var bP={exports:{}},v2;function Jfe(){return v2||(v2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.mode.OFB=function(){var o=n.lib.BlockCipherMode.extend(),u=o.Encryptor=o.extend({processBlock:function(d,_){var v=this._cipher,a=v.blockSize,C=this._iv,A=this._keystream;C&&(A=this._keystream=C.slice(0),this._iv=void 0),v.encryptBlock(A,0);for(var k=0;k<a;k++)d[_+k]^=A[k]}});return o.Decryptor=u,o}(),n.mode.OFB})}(bP)),bP.exports}var wP={exports:{}},x2;function epe(){return x2||(x2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.mode.ECB=function(){var o=n.lib.BlockCipherMode.extend();return o.Encryptor=o.extend({processBlock:function(u,d){this._cipher.encryptBlock(u,d)}}),o.Decryptor=o.extend({processBlock:function(u,d){this._cipher.decryptBlock(u,d)}}),o}(),n.mode.ECB})}(wP)),wP.exports}var CP={exports:{}},b2;function tpe(){return b2||(b2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.pad.AnsiX923={pad:function(o,u){var d=o.sigBytes,_=u*4,v=_-d%_,a=d+v-1;o.clamp(),o.words[a>>>2]|=v<<24-a%4*8,o.sigBytes+=v},unpad:function(o){var u=o.words[o.sigBytes-1>>>2]&255;o.sigBytes-=u}},n.pad.Ansix923})}(CP)),CP.exports}var EP={exports:{}},w2;function rpe(){return w2||(w2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.pad.Iso10126={pad:function(o,u){var d=u*4,_=d-o.sigBytes%d;o.concat(n.lib.WordArray.random(_-1)).concat(n.lib.WordArray.create([_<<24],1))},unpad:function(o){var u=o.words[o.sigBytes-1>>>2]&255;o.sigBytes-=u}},n.pad.Iso10126})}(EP)),EP.exports}var SP={exports:{}},C2;function npe(){return C2||(C2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.pad.Iso97971={pad:function(o,u){o.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(o,u)},unpad:function(o){n.pad.ZeroPadding.unpad(o),o.sigBytes--}},n.pad.Iso97971})}(SP)),SP.exports}var TP={exports:{}},E2;function ipe(){return E2||(E2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.pad.ZeroPadding={pad:function(o,u){var d=u*4;o.clamp(),o.sigBytes+=d-(o.sigBytes%d||d)},unpad:function(o){for(var u=o.words,d=o.sigBytes-1,d=o.sigBytes-1;d>=0;d--)if(u[d>>>2]>>>24-d%4*8&255){o.sigBytes=d+1;break}}},n.pad.ZeroPadding})}(TP)),TP.exports}var AP={exports:{}},S2;function ope(){return S2||(S2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(AP)),AP.exports}var IP={exports:{}},T2;function spe(){return T2||(T2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),ds())})(Cn,function(n){return function(o){var u=n,d=u.lib,_=d.CipherParams,v=u.enc,a=v.Hex,C=u.format;C.Hex={stringify:function(A){return A.ciphertext.toString(a)},parse:function(A){var k=a.parse(A);return _.create({ciphertext:k})}}}(),n.format.Hex})}(IP)),IP.exports}var MP={exports:{}},A2;function ape(){return A2||(A2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.BlockCipher,_=o.algo,v=[],a=[],C=[],A=[],k=[],O=[],R=[],z=[],N=[],K=[];(function(){for(var H=[],Y=0;Y<256;Y++)Y<128?H[Y]=Y<<1:H[Y]=Y<<1^283;for(var te=0,J=0,Y=0;Y<256;Y++){var ae=J^J<<1^J<<2^J<<3^J<<4;ae=ae>>>8^ae&255^99,v[te]=ae,a[ae]=te;var de=H[te],Me=H[de],Ce=H[Me],Ae=H[ae]*257^ae*16843008;C[te]=Ae<<24|Ae>>>8,A[te]=Ae<<16|Ae>>>16,k[te]=Ae<<8|Ae>>>24,O[te]=Ae;var Ae=Ce*16843009^Me*65537^de*257^te*16843008;R[ae]=Ae<<24|Ae>>>8,z[ae]=Ae<<16|Ae>>>16,N[ae]=Ae<<8|Ae>>>24,K[ae]=Ae,te?(te=de^H[H[H[Ce^de]]],J^=H[H[J]]):te=J=1}})();var q=[0,1,2,4,8,16,32,64,128,27,54],j=_.AES=d.extend({_doReset:function(){var H;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var Y=this._keyPriorReset=this._key,te=Y.words,J=Y.sigBytes/4,ae=this._nRounds=J+6,de=(ae+1)*4,Me=this._keySchedule=[],Ce=0;Ce<de;Ce++)Ce<J?Me[Ce]=te[Ce]:(H=Me[Ce-1],Ce%J?J>6&&Ce%J==4&&(H=v[H>>>24]<<24|v[H>>>16&255]<<16|v[H>>>8&255]<<8|v[H&255]):(H=H<<8|H>>>24,H=v[H>>>24]<<24|v[H>>>16&255]<<16|v[H>>>8&255]<<8|v[H&255],H^=q[Ce/J|0]<<24),Me[Ce]=Me[Ce-J]^H);for(var Ae=this._invKeySchedule=[],Ne=0;Ne<de;Ne++){var Ce=de-Ne;if(Ne%4)var H=Me[Ce];else var H=Me[Ce-4];Ne<4||Ce<=4?Ae[Ne]=H:Ae[Ne]=R[v[H>>>24]]^z[v[H>>>16&255]]^N[v[H>>>8&255]]^K[v[H&255]]}}},encryptBlock:function(H,Y){this._doCryptBlock(H,Y,this._keySchedule,C,A,k,O,v)},decryptBlock:function(H,Y){var te=H[Y+1];H[Y+1]=H[Y+3],H[Y+3]=te,this._doCryptBlock(H,Y,this._invKeySchedule,R,z,N,K,a);var te=H[Y+1];H[Y+1]=H[Y+3],H[Y+3]=te},_doCryptBlock:function(H,Y,te,J,ae,de,Me,Ce){for(var Ae=this._nRounds,Ne=H[Y]^te[0],Re=H[Y+1]^te[1],Ye=H[Y+2]^te[2],ht=H[Y+3]^te[3],ft=4,et=1;et<Ae;et++){var Xe=J[Ne>>>24]^ae[Re>>>16&255]^de[Ye>>>8&255]^Me[ht&255]^te[ft++],Mt=J[Re>>>24]^ae[Ye>>>16&255]^de[ht>>>8&255]^Me[Ne&255]^te[ft++],Lt=J[Ye>>>24]^ae[ht>>>16&255]^de[Ne>>>8&255]^Me[Re&255]^te[ft++],nt=J[ht>>>24]^ae[Ne>>>16&255]^de[Re>>>8&255]^Me[Ye&255]^te[ft++];Ne=Xe,Re=Mt,Ye=Lt,ht=nt}var Xe=(Ce[Ne>>>24]<<24|Ce[Re>>>16&255]<<16|Ce[Ye>>>8&255]<<8|Ce[ht&255])^te[ft++],Mt=(Ce[Re>>>24]<<24|Ce[Ye>>>16&255]<<16|Ce[ht>>>8&255]<<8|Ce[Ne&255])^te[ft++],Lt=(Ce[Ye>>>24]<<24|Ce[ht>>>16&255]<<16|Ce[Ne>>>8&255]<<8|Ce[Re&255])^te[ft++],nt=(Ce[ht>>>24]<<24|Ce[Ne>>>16&255]<<16|Ce[Re>>>8&255]<<8|Ce[Ye&255])^te[ft++];H[Y]=Xe,H[Y+1]=Mt,H[Y+2]=Lt,H[Y+3]=nt},keySize:256/32});o.AES=d._createHelper(j)}(),n.AES})}(MP)),MP.exports}var PP={exports:{}},I2;function lpe(){return I2||(I2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.WordArray,_=u.BlockCipher,v=o.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],C=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],A=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],k=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],O=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],R=v.DES=_.extend({_doReset:function(){for(var q=this._key,j=q.words,H=[],Y=0;Y<56;Y++){var te=a[Y]-1;H[Y]=j[te>>>5]>>>31-te%32&1}for(var J=this._subKeys=[],ae=0;ae<16;ae++){for(var de=J[ae]=[],Me=A[ae],Y=0;Y<24;Y++)de[Y/6|0]|=H[(C[Y]-1+Me)%28]<<31-Y%6,de[4+(Y/6|0)]|=H[28+(C[Y+24]-1+Me)%28]<<31-Y%6;de[0]=de[0]<<1|de[0]>>>31;for(var Y=1;Y<7;Y++)de[Y]=de[Y]>>>(Y-1)*4+3;de[7]=de[7]<<5|de[7]>>>27}for(var Ce=this._invSubKeys=[],Y=0;Y<16;Y++)Ce[Y]=J[15-Y]},encryptBlock:function(q,j){this._doCryptBlock(q,j,this._subKeys)},decryptBlock:function(q,j){this._doCryptBlock(q,j,this._invSubKeys)},_doCryptBlock:function(q,j,H){this._lBlock=q[j],this._rBlock=q[j+1],z.call(this,4,252645135),z.call(this,16,65535),N.call(this,2,858993459),N.call(this,8,16711935),z.call(this,1,1431655765);for(var Y=0;Y<16;Y++){for(var te=H[Y],J=this._lBlock,ae=this._rBlock,de=0,Me=0;Me<8;Me++)de|=k[Me][((ae^te[Me])&O[Me])>>>0];this._lBlock=ae,this._rBlock=J^de}var Ce=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Ce,z.call(this,1,1431655765),N.call(this,8,16711935),N.call(this,2,858993459),z.call(this,16,65535),z.call(this,4,252645135),q[j]=this._lBlock,q[j+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function z(q,j){var H=(this._lBlock>>>q^this._rBlock)&j;this._rBlock^=H,this._lBlock^=H<<q}function N(q,j){var H=(this._rBlock>>>q^this._lBlock)&j;this._lBlock^=H,this._rBlock^=H<<q}o.DES=_._createHelper(R);var K=v.TripleDES=_.extend({_doReset:function(){var q=this._key,j=q.words;if(j.length!==2&&j.length!==4&&j.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var H=j.slice(0,2),Y=j.length<4?j.slice(0,2):j.slice(2,4),te=j.length<6?j.slice(0,2):j.slice(4,6);this._des1=R.createEncryptor(d.create(H)),this._des2=R.createEncryptor(d.create(Y)),this._des3=R.createEncryptor(d.create(te))},encryptBlock:function(q,j){this._des1.encryptBlock(q,j),this._des2.decryptBlock(q,j),this._des3.encryptBlock(q,j)},decryptBlock:function(q,j){this._des3.decryptBlock(q,j),this._des2.encryptBlock(q,j),this._des1.decryptBlock(q,j)},keySize:192/32,ivSize:64/32,blockSize:64/32});o.TripleDES=_._createHelper(K)}(),n.TripleDES})}(PP)),PP.exports}var RP={exports:{}},M2;function cpe(){return M2||(M2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.StreamCipher,_=o.algo,v=_.RC4=d.extend({_doReset:function(){for(var A=this._key,k=A.words,O=A.sigBytes,R=this._S=[],z=0;z<256;z++)R[z]=z;for(var z=0,N=0;z<256;z++){var K=z%O,q=k[K>>>2]>>>24-K%4*8&255;N=(N+R[z]+q)%256;var j=R[z];R[z]=R[N],R[N]=j}this._i=this._j=0},_doProcessBlock:function(A,k){A[k]^=a.call(this)},keySize:256/32,ivSize:0});function a(){for(var A=this._S,k=this._i,O=this._j,R=0,z=0;z<4;z++){k=(k+1)%256,O=(O+A[k])%256;var N=A[k];A[k]=A[O],A[O]=N,R|=A[(A[k]+A[O])%256]<<24-z*8}return this._i=k,this._j=O,R}o.RC4=d._createHelper(v);var C=_.RC4Drop=v.extend({cfg:v.cfg.extend({drop:192}),_doReset:function(){v._doReset.call(this);for(var A=this.cfg.drop;A>0;A--)a.call(this)}});o.RC4Drop=d._createHelper(C)}(),n.RC4})}(RP)),RP.exports}var kP={exports:{}},P2;function upe(){return P2||(P2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.StreamCipher,_=o.algo,v=[],a=[],C=[],A=_.Rabbit=d.extend({_doReset:function(){for(var O=this._key.words,R=this.cfg.iv,z=0;z<4;z++)O[z]=(O[z]<<8|O[z]>>>24)&16711935|(O[z]<<24|O[z]>>>8)&4278255360;var N=this._X=[O[0],O[3]<<16|O[2]>>>16,O[1],O[0]<<16|O[3]>>>16,O[2],O[1]<<16|O[0]>>>16,O[3],O[2]<<16|O[1]>>>16],K=this._C=[O[2]<<16|O[2]>>>16,O[0]&4294901760|O[1]&65535,O[3]<<16|O[3]>>>16,O[1]&4294901760|O[2]&65535,O[0]<<16|O[0]>>>16,O[2]&4294901760|O[3]&65535,O[1]<<16|O[1]>>>16,O[3]&4294901760|O[0]&65535];this._b=0;for(var z=0;z<4;z++)k.call(this);for(var z=0;z<8;z++)K[z]^=N[z+4&7];if(R){var q=R.words,j=q[0],H=q[1],Y=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,te=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,J=Y>>>16|te&4294901760,ae=te<<16|Y&65535;K[0]^=Y,K[1]^=J,K[2]^=te,K[3]^=ae,K[4]^=Y,K[5]^=J,K[6]^=te,K[7]^=ae;for(var z=0;z<4;z++)k.call(this)}},_doProcessBlock:function(O,R){var z=this._X;k.call(this),v[0]=z[0]^z[5]>>>16^z[3]<<16,v[1]=z[2]^z[7]>>>16^z[5]<<16,v[2]=z[4]^z[1]>>>16^z[7]<<16,v[3]=z[6]^z[3]>>>16^z[1]<<16;for(var N=0;N<4;N++)v[N]=(v[N]<<8|v[N]>>>24)&16711935|(v[N]<<24|v[N]>>>8)&4278255360,O[R+N]^=v[N]},blockSize:128/32,ivSize:64/32});function k(){for(var O=this._X,R=this._C,z=0;z<8;z++)a[z]=R[z];R[0]=R[0]+1295307597+this._b|0,R[1]=R[1]+3545052371+(R[0]>>>0<a[0]>>>0?1:0)|0,R[2]=R[2]+886263092+(R[1]>>>0<a[1]>>>0?1:0)|0,R[3]=R[3]+1295307597+(R[2]>>>0<a[2]>>>0?1:0)|0,R[4]=R[4]+3545052371+(R[3]>>>0<a[3]>>>0?1:0)|0,R[5]=R[5]+886263092+(R[4]>>>0<a[4]>>>0?1:0)|0,R[6]=R[6]+1295307597+(R[5]>>>0<a[5]>>>0?1:0)|0,R[7]=R[7]+3545052371+(R[6]>>>0<a[6]>>>0?1:0)|0,this._b=R[7]>>>0<a[7]>>>0?1:0;for(var z=0;z<8;z++){var N=O[z]+R[z],K=N&65535,q=N>>>16,j=((K*K>>>17)+K*q>>>15)+q*q,H=((N&4294901760)*N|0)+((N&65535)*N|0);C[z]=j^H}O[0]=C[0]+(C[7]<<16|C[7]>>>16)+(C[6]<<16|C[6]>>>16)|0,O[1]=C[1]+(C[0]<<8|C[0]>>>24)+C[7]|0,O[2]=C[2]+(C[1]<<16|C[1]>>>16)+(C[0]<<16|C[0]>>>16)|0,O[3]=C[3]+(C[2]<<8|C[2]>>>24)+C[1]|0,O[4]=C[4]+(C[3]<<16|C[3]>>>16)+(C[2]<<16|C[2]>>>16)|0,O[5]=C[5]+(C[4]<<8|C[4]>>>24)+C[3]|0,O[6]=C[6]+(C[5]<<16|C[5]>>>16)+(C[4]<<16|C[4]>>>16)|0,O[7]=C[7]+(C[6]<<8|C[6]>>>24)+C[5]|0}o.Rabbit=d._createHelper(A)}(),n.Rabbit})}(kP)),kP.exports}var DP={exports:{}},R2;function hpe(){return R2||(R2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.StreamCipher,_=o.algo,v=[],a=[],C=[],A=_.RabbitLegacy=d.extend({_doReset:function(){var O=this._key.words,R=this.cfg.iv,z=this._X=[O[0],O[3]<<16|O[2]>>>16,O[1],O[0]<<16|O[3]>>>16,O[2],O[1]<<16|O[0]>>>16,O[3],O[2]<<16|O[1]>>>16],N=this._C=[O[2]<<16|O[2]>>>16,O[0]&4294901760|O[1]&65535,O[3]<<16|O[3]>>>16,O[1]&4294901760|O[2]&65535,O[0]<<16|O[0]>>>16,O[2]&4294901760|O[3]&65535,O[1]<<16|O[1]>>>16,O[3]&4294901760|O[0]&65535];this._b=0;for(var K=0;K<4;K++)k.call(this);for(var K=0;K<8;K++)N[K]^=z[K+4&7];if(R){var q=R.words,j=q[0],H=q[1],Y=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,te=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,J=Y>>>16|te&4294901760,ae=te<<16|Y&65535;N[0]^=Y,N[1]^=J,N[2]^=te,N[3]^=ae,N[4]^=Y,N[5]^=J,N[6]^=te,N[7]^=ae;for(var K=0;K<4;K++)k.call(this)}},_doProcessBlock:function(O,R){var z=this._X;k.call(this),v[0]=z[0]^z[5]>>>16^z[3]<<16,v[1]=z[2]^z[7]>>>16^z[5]<<16,v[2]=z[4]^z[1]>>>16^z[7]<<16,v[3]=z[6]^z[3]>>>16^z[1]<<16;for(var N=0;N<4;N++)v[N]=(v[N]<<8|v[N]>>>24)&16711935|(v[N]<<24|v[N]>>>8)&4278255360,O[R+N]^=v[N]},blockSize:128/32,ivSize:64/32});function k(){for(var O=this._X,R=this._C,z=0;z<8;z++)a[z]=R[z];R[0]=R[0]+1295307597+this._b|0,R[1]=R[1]+3545052371+(R[0]>>>0<a[0]>>>0?1:0)|0,R[2]=R[2]+886263092+(R[1]>>>0<a[1]>>>0?1:0)|0,R[3]=R[3]+1295307597+(R[2]>>>0<a[2]>>>0?1:0)|0,R[4]=R[4]+3545052371+(R[3]>>>0<a[3]>>>0?1:0)|0,R[5]=R[5]+886263092+(R[4]>>>0<a[4]>>>0?1:0)|0,R[6]=R[6]+1295307597+(R[5]>>>0<a[5]>>>0?1:0)|0,R[7]=R[7]+3545052371+(R[6]>>>0<a[6]>>>0?1:0)|0,this._b=R[7]>>>0<a[7]>>>0?1:0;for(var z=0;z<8;z++){var N=O[z]+R[z],K=N&65535,q=N>>>16,j=((K*K>>>17)+K*q>>>15)+q*q,H=((N&4294901760)*N|0)+((N&65535)*N|0);C[z]=j^H}O[0]=C[0]+(C[7]<<16|C[7]>>>16)+(C[6]<<16|C[6]>>>16)|0,O[1]=C[1]+(C[0]<<8|C[0]>>>24)+C[7]|0,O[2]=C[2]+(C[1]<<16|C[1]>>>16)+(C[0]<<16|C[0]>>>16)|0,O[3]=C[3]+(C[2]<<8|C[2]>>>24)+C[1]|0,O[4]=C[4]+(C[3]<<16|C[3]>>>16)+(C[2]<<16|C[2]>>>16)|0,O[5]=C[5]+(C[4]<<8|C[4]>>>24)+C[3]|0,O[6]=C[6]+(C[5]<<16|C[5]>>>16)+(C[4]<<16|C[4]>>>16)|0,O[7]=C[7]+(C[6]<<8|C[6]>>>24)+C[5]|0}o.RabbitLegacy=d._createHelper(A)}(),n.RabbitLegacy})}(DP)),DP.exports}var OP={exports:{}},k2;function dpe(){return k2||(k2=1,function(t,e){(function(n,o,u){t.exports=o(Yn(),vm(),xm(),mf(),ds())})(Cn,function(n){return function(){var o=n,u=o.lib,d=u.BlockCipher,_=o.algo;const v=16,a=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],C=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var A={pbox:[],sbox:[]};function k(K,q){let j=q>>24&255,H=q>>16&255,Y=q>>8&255,te=q&255,J=K.sbox[0][j]+K.sbox[1][H];return J=J^K.sbox[2][Y],J=J+K.sbox[3][te],J}function O(K,q,j){let H=q,Y=j,te;for(let J=0;J<v;++J)H=H^K.pbox[J],Y=k(K,H)^Y,te=H,H=Y,Y=te;return te=H,H=Y,Y=te,Y=Y^K.pbox[v],H=H^K.pbox[v+1],{left:H,right:Y}}function R(K,q,j){let H=q,Y=j,te;for(let J=v+1;J>1;--J)H=H^K.pbox[J],Y=k(K,H)^Y,te=H,H=Y,Y=te;return te=H,H=Y,Y=te,Y=Y^K.pbox[1],H=H^K.pbox[0],{left:H,right:Y}}function z(K,q,j){for(let ae=0;ae<4;ae++){K.sbox[ae]=[];for(let de=0;de<256;de++)K.sbox[ae][de]=C[ae][de]}let H=0;for(let ae=0;ae<v+2;ae++)K.pbox[ae]=a[ae]^q[H],H++,H>=j&&(H=0);let Y=0,te=0,J=0;for(let ae=0;ae<v+2;ae+=2)J=O(K,Y,te),Y=J.left,te=J.right,K.pbox[ae]=Y,K.pbox[ae+1]=te;for(let ae=0;ae<4;ae++)for(let de=0;de<256;de+=2)J=O(K,Y,te),Y=J.left,te=J.right,K.sbox[ae][de]=Y,K.sbox[ae][de+1]=te;return!0}var N=_.Blowfish=d.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var K=this._keyPriorReset=this._key,q=K.words,j=K.sigBytes/4;z(A,q,j)}},encryptBlock:function(K,q){var j=O(A,K[q],K[q+1]);K[q]=j.left,K[q+1]=j.right},decryptBlock:function(K,q){var j=R(A,K[q],K[q+1]);K[q]=j.left,K[q+1]=j.right},blockSize:64/32,keySize:128/32,ivSize:64/32});o.Blowfish=d._createHelper(N)}(),n.Blowfish})}(OP)),OP.exports}(function(t,e){(function(n,o,u){t.exports=o(Yn(),kA(),jfe(),Vfe(),vm(),Hfe(),xm(),BH(),NO(),Gfe(),FH(),Wfe(),qfe(),Kfe(),UO(),Yfe(),mf(),ds(),Zfe(),Xfe(),Qfe(),Jfe(),epe(),tpe(),rpe(),npe(),ipe(),ope(),spe(),ape(),lpe(),cpe(),upe(),hpe(),dpe())})(Cn,function(n){return n})})(OH);var fpe=OH.exports;const ppe="data:image/svg+xml,%3csvg%20width='26'%20height='14'%20viewBox='0%200%2026%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.0555%200.222864C22.1255%200.463797%2023.0337%201.75614%2023.3951%203.59125C23.503%204.1386%2023.5614%204.86415%2023.6115%205.48575C23.6378%205.81268%2023.6619%206.11086%2023.6896%206.33923C23.7183%206.57883%2023.5309%206.78965%2023.2893%206.78965H22.7988C20.8044%206.78965%2019.1881%208.40658%2019.1881%2010.4003V11.7676C19.1881%2012.1129%2018.9084%2012.3927%2018.563%2012.3927H12.9292H7.29535C6.95001%2012.3927%206.67026%2012.1129%206.67026%2011.7676V10.4003C6.67026%208.40591%205.05333%206.78965%203.0596%206.78965H2.56904C2.32743%206.78965%202.14004%206.57883%202.16882%206.33923C2.19609%206.11237%202.21983%205.8166%202.24587%205.4922C2.29587%204.86917%202.35436%204.1405%202.46262%203.59125C2.82402%201.75614%203.73154%200.464467%205.80223%200.222864C7.54632%200.0194085%208.98925%200%2012.9292%200C16.8691%200%2018.3114%200.0194085%2020.0555%200.222864ZM3.34901%209.24008L2.79285%209.79623C2.56798%2010.0211%202.56798%2010.3865%202.79285%2010.6114C3.01772%2010.8369%203.38314%2010.8369%203.60801%2010.6114L4.16417%2010.0552C4.38904%209.8297%204.38904%209.46495%204.16417%209.24008C3.9393%209.01521%203.57388%209.01521%203.34901%209.24008ZM0.724809%2011.863L0.168654%2012.4191C-0.0562179%2012.6447%20-0.0562179%2013.0094%200.168654%2013.2349C0.393525%2013.4598%200.758941%2013.4598%200.983813%2013.2349L1.53997%2012.6788C1.76551%2012.4532%201.76551%2012.0885%201.53997%2011.8636C1.3151%2011.6374%200.95035%2011.6374%200.724809%2011.863ZM0.168654%209.24058C0.393525%209.01504%200.758941%209.01504%200.983813%209.24058L1.53997%209.79674C1.76551%2010.0216%201.76551%2010.387%201.53997%2010.6119C1.3151%2010.8374%200.94968%2010.8374%200.724809%2010.6119L0.168654%2010.0557C-0.0562179%209.83087%20-0.0562179%209.46612%200.168654%209.24058ZM3.60801%2011.863C3.38314%2011.6375%203.01772%2011.6375%202.79285%2011.863C2.56798%2012.0879%202.56798%2012.4533%202.79285%2012.6782L3.34901%2013.2344C3.57388%2013.4592%203.9393%2013.4592%204.16417%2013.2344C4.38904%2013.0095%204.38904%2012.6441%204.16417%2012.4185L3.60801%2011.863ZM21.6954%2012.4191L22.2515%2011.863C22.4764%2011.6374%2022.8418%2011.6374%2023.0667%2011.8636C23.2922%2012.0885%2023.2922%2012.4532%2023.0667%2012.6788L22.5105%2013.2349C22.2857%2013.4598%2021.9202%2013.4598%2021.6954%2013.2349C21.4705%2013.0094%2021.4705%2012.6447%2021.6954%2012.4191ZM25.133%2010.6119L25.6891%2010.0557C25.914%209.8302%2025.914%209.46545%2025.6891%209.24058C25.4643%209.01504%2025.0989%209.01504%2024.874%209.24058L24.3178%209.79674C24.093%2010.0216%2024.093%2010.387%2024.3178%2010.6119C24.5427%2010.8374%2024.9081%2010.8374%2025.133%2010.6119ZM21.6954%209.24058C21.9202%209.01504%2022.2857%209.01504%2022.5105%209.24058L23.0667%209.79674C23.2922%2010.0216%2023.2922%2010.387%2023.0667%2010.6119C22.8418%2010.8374%2022.4764%2010.8374%2022.2515%2010.6119L21.6954%2010.0557C21.4705%209.83087%2021.4705%209.46612%2021.6954%209.24058ZM25.133%2011.863C24.9081%2011.6375%2024.5427%2011.6375%2024.3178%2011.863C24.093%2012.0879%2024.093%2012.4533%2024.3178%2012.6782L24.874%2013.2344C25.0989%2013.4592%2025.4643%2013.4592%2025.6891%2013.2344C25.914%2013.0095%2025.914%2012.6441%2025.6891%2012.4185L25.133%2011.863Z'%20fill='black'/%3e%3c/svg%3e",zH=fe.forwardRef((t,e)=>{const n=fe.useRef(null);return Ke.jsx(_A,{mode:"out-in",children:Ke.jsx(gA,{style:{height:"100%",width:"100%"},classNames:"fade",nodeRef:n,timeout:100,children:Ke.jsxs("div",{ref:n,children:[t.children," "]})},t.updateKey)})});function NH({}){fe.useRef(),fe.useRef(null);const[t,e]=fe.useState(""),[n,o]=fe.useState("Please type your password"),[u,d]=fe.useState(0),_=kO();function v(){fpe.HmacSHA256(t,"f899af2d8fb239d477fb0e61f2b00cf444b1b3a0").toString()==="752adf08b21b3f914dd05d9a37835a4acb9af1c22790a9375cdeba889d7b858f"?(o("Logging in..."),d(C=>C+1),setTimeout(()=>{_(Ffe(!0))},1e3)):(o("Wrong password, please try again..."),d(C=>C+1)),e("")}function a(C){C.code==="Enter"&&v()}return Ke.jsxs(kn,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",padding:6,gap:2},children:[Ke.jsx("img",{src:ppe,style:{width:"35vw",marginBottom:"5vh"}}),Ke.jsxs(nce,{direction:"row",gap:1,sx:{width:"100%"},children:[Ke.jsx(Rue,{sx:{width:"100%"},value:t,onChange:C=>e(C.target.value),name:"password",autoComplete:"off",type:"password",onKeyDown:a}),Ke.jsx(m1,{disabled:t==="",variant:"contained",onClick:v,children:"submit"})]}),Ke.jsx(zH,{updateKey:`message-${u}`,children:Ke.jsxs(kn,{sx:{typography:"h6"},children:[" ",n]})})]})}const mpe=Hr("div")(({theme:t})=>({height:"100%",width:"100%",position:"relative",boxSizing:"border-box","& .mapboxgl-control-container":{display:"none"}})),gpe=Hr("div")(t=>({pointerEvents:"none",position:"relative",width:t.width*.85,height:t.height*.85,border:"2px solid rgba(0,0,0,0.2)",boxSizing:"content-box",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",transition:"opacity .35s ease-out",opacity:t.visible?1:0,"&::after":{content:'""',display:"block",width:t.width*.05,height:t.width*.05,border:"2px solid rgba(0,0,0,0.2)",borderRadius:"100%"}}));var UH={exports:{}};(function(t,e){var n={};(function(o,u){t.exports=u()})(Cn,function(){var o,u,d;function _(a,C){if(!o)o=C;else if(!u)u=C;else{var A="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",k={};o(k),d=C(k),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}_(["exports"],function(a){var C="3.5.1";let A;const k={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(A==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{A=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):i}catch{A=i}}return A},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!k.API_URL)return null;try{const i=new URL(k.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function O(i){return k.API_URL_REGEX.test(i)}function R(i){return i.indexOf("mapbox:")===0}function z(i){return k.API_CDN_URL_REGEX.test(i)}function N(i){return k.API_SPRITE_REGEX.test(i)}function K(i){return k.API_STYLE_REGEX.test(i)&&!N(i)}const q={create:"create",load:"load",fullLoad:"fullLoad"},j={mark(i){performance.mark(i)},measure(i,r,s){performance.measure(i,r,s)}};function H(i){const r=i.name.split("?")[0];return z(r)&&r.includes("mapbox-gl.js")?"javascript":z(r)&&r.includes("mapbox-gl.css")?"css":function(s){return k.API_FONTS_REGEX.test(s)}(r)?"fontRange":N(r)?"sprite":K(r)?"style":function(s){return k.API_TILEJSON_REGEX.test(s)}(r)?"tilejson":"other"}function Y(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var te={},J={};Object.defineProperty(J,"__esModule",{value:!0}),J.setMatrixArrayType=function(i){J.ARRAY_TYPE=de=i},J.toRadian=function(i){return i*Ce},J.equals=function(i,r){return Math.abs(i-r)<=ae*Math.max(1,Math.abs(i),Math.abs(r))},J.RANDOM=J.ARRAY_TYPE=J.EPSILON=void 0;var ae=1e-6;J.EPSILON=ae;var de=typeof Float32Array<"u"?Float32Array:Array;J.ARRAY_TYPE=de;var Me=Math.random;J.RANDOM=Me;var Ce=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var i=0,r=arguments.length;r--;)i+=arguments[r]*arguments[r];return Math.sqrt(i)});var Ae={};function Ne(i){return Ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ne(i)}Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.create=function(){var i=new Re.ARRAY_TYPE(4);return Re.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},Ae.clone=function(i){var r=new Re.ARRAY_TYPE(4);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r},Ae.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i},Ae.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i},Ae.fromValues=function(i,r,s,c){var h=new Re.ARRAY_TYPE(4);return h[0]=i,h[1]=r,h[2]=s,h[3]=c,h},Ae.set=function(i,r,s,c,h){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i},Ae.transpose=function(i,r){if(i===r){var s=r[1];i[1]=r[2],i[2]=s}else i[0]=r[0],i[1]=r[2],i[2]=r[1],i[3]=r[3];return i},Ae.invert=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=s*p-h*c;return m?(i[0]=p*(m=1/m),i[1]=-c*m,i[2]=-h*m,i[3]=s*m,i):null},Ae.adjoint=function(i,r){var s=r[0];return i[0]=r[3],i[1]=-r[1],i[2]=-r[2],i[3]=s,i},Ae.determinant=function(i){return i[0]*i[3]-i[2]*i[1]},Ae.multiply=ht,Ae.rotate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=Math.sin(s),b=Math.cos(s);return i[0]=c*b+p*x,i[1]=h*b+m*x,i[2]=c*-x+p*b,i[3]=h*-x+m*b,i},Ae.scale=function(i,r,s){var c=r[1],h=r[2],p=r[3],m=s[0],x=s[1];return i[0]=r[0]*m,i[1]=c*m,i[2]=h*x,i[3]=p*x,i},Ae.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=-s,i[3]=c,i},Ae.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=r[1],i},Ae.str=function(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Ae.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},Ae.LDU=function(i,r,s,c){return i[2]=c[2]/c[0],s[0]=c[0],s[1]=c[1],s[3]=c[3]-i[2]*s[1],[i,r,s]},Ae.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i},Ae.subtract=ft,Ae.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]},Ae.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=r[0],x=r[1],b=r[2],S=r[3];return Math.abs(s-m)<=Re.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-x)<=Re.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(h-b)<=Re.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(p-S)<=Re.EPSILON*Math.max(1,Math.abs(p),Math.abs(S))},Ae.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i},Ae.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i},Ae.sub=Ae.mul=void 0;var Re=function(i,r){if(i&&i.__esModule)return i;if(i===null||Ne(i)!=="object"&&typeof i!="function")return{default:i};var s=Ye(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function Ye(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Ye=function(c){return c?s:r})(i)}function ht(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=s[0],b=s[1],S=s[2],I=s[3];return i[0]=c*x+p*b,i[1]=h*x+m*b,i[2]=c*S+p*I,i[3]=h*S+m*I,i}function ft(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i}Ae.mul=ht,Ae.sub=ft;var et={};function Xe(i){return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Xe(i)}Object.defineProperty(et,"__esModule",{value:!0}),et.create=function(){var i=new Mt.ARRAY_TYPE(6);return Mt.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[4]=0,i[5]=0),i[0]=1,i[3]=1,i},et.clone=function(i){var r=new Mt.ARRAY_TYPE(6);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r},et.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i},et.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i},et.fromValues=function(i,r,s,c,h,p){var m=new Mt.ARRAY_TYPE(6);return m[0]=i,m[1]=r,m[2]=s,m[3]=c,m[4]=h,m[5]=p,m},et.set=function(i,r,s,c,h,p,m){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i[4]=p,i[5]=m,i},et.invert=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=s*p-c*h;return b?(i[0]=p*(b=1/b),i[1]=-c*b,i[2]=-h*b,i[3]=s*b,i[4]=(h*x-p*m)*b,i[5]=(c*m-s*x)*b,i):null},et.determinant=function(i){return i[0]*i[3]-i[1]*i[2]},et.multiply=nt,et.rotate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=Math.sin(s),I=Math.cos(s);return i[0]=c*I+p*S,i[1]=h*I+m*S,i[2]=c*-S+p*I,i[3]=h*-S+m*I,i[4]=x,i[5]=b,i},et.scale=function(i,r,s){var c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=s[0],S=s[1];return i[0]=r[0]*b,i[1]=c*b,i[2]=h*S,i[3]=p*S,i[4]=m,i[5]=x,i},et.translate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=s[0],I=s[1];return i[0]=c,i[1]=h,i[2]=p,i[3]=m,i[4]=c*S+p*I+x,i[5]=h*S+m*I+b,i},et.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=-s,i[3]=c,i[4]=0,i[5]=0,i},et.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=r[1],i[4]=0,i[5]=0,i},et.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=r[0],i[5]=r[1],i},et.str=function(i){return"mat2d("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+")"},et.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],1)},et.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i},et.subtract=at,et.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i},et.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i},et.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]},et.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=i[4],x=i[5],b=r[0],S=r[1],I=r[2],P=r[3],D=r[4],F=r[5];return Math.abs(s-b)<=Mt.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-S)<=Mt.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-I)<=Mt.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(p-P)<=Mt.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(m-D)<=Mt.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(x-F)<=Mt.EPSILON*Math.max(1,Math.abs(x),Math.abs(F))},et.sub=et.mul=void 0;var Mt=function(i,r){if(i&&i.__esModule)return i;if(i===null||Xe(i)!=="object"&&typeof i!="function")return{default:i};var s=Lt(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function Lt(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Lt=function(c){return c?s:r})(i)}function nt(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=s[0],I=s[1],P=s[2],D=s[3],F=s[4],U=s[5];return i[0]=c*S+p*I,i[1]=h*S+m*I,i[2]=c*P+p*D,i[3]=h*P+m*D,i[4]=c*F+p*U+x,i[5]=h*F+m*U+b,i}function at(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i}et.mul=nt,et.sub=at;var it={};function tt(i){return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},tt(i)}Object.defineProperty(it,"__esModule",{value:!0}),it.create=function(){var i=new Jt.ARRAY_TYPE(9);return Jt.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},it.fromMat4=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[4],i[4]=r[5],i[5]=r[6],i[6]=r[8],i[7]=r[9],i[8]=r[10],i},it.clone=function(i){var r=new Jt.ARRAY_TYPE(9);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r},it.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i},it.fromValues=function(i,r,s,c,h,p,m,x,b){var S=new Jt.ARRAY_TYPE(9);return S[0]=i,S[1]=r,S[2]=s,S[3]=c,S[4]=h,S[5]=p,S[6]=m,S[7]=x,S[8]=b,S},it.set=function(i,r,s,c,h,p,m,x,b,S){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i[4]=p,i[5]=m,i[6]=x,i[7]=b,i[8]=S,i},it.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},it.transpose=function(i,r){if(i===r){var s=r[1],c=r[2],h=r[5];i[1]=r[3],i[2]=r[6],i[3]=s,i[5]=r[7],i[6]=c,i[7]=h}else i[0]=r[0],i[1]=r[3],i[2]=r[6],i[3]=r[1],i[4]=r[4],i[5]=r[7],i[6]=r[2],i[7]=r[5],i[8]=r[8];return i},it.invert=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=r[6],S=r[7],I=r[8],P=I*m-x*S,D=-I*p+x*b,F=S*p-m*b,U=s*P+c*D+h*F;return U?(i[0]=P*(U=1/U),i[1]=(-I*c+h*S)*U,i[2]=(x*c-h*m)*U,i[3]=D*U,i[4]=(I*s-h*b)*U,i[5]=(-x*s+h*p)*U,i[6]=F*U,i[7]=(-S*s+c*b)*U,i[8]=(m*s-c*p)*U,i):null},it.adjoint=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=r[6],S=r[7],I=r[8];return i[0]=m*I-x*S,i[1]=h*S-c*I,i[2]=c*x-h*m,i[3]=x*b-p*I,i[4]=s*I-h*b,i[5]=h*p-s*x,i[6]=p*S-m*b,i[7]=c*b-s*S,i[8]=s*m-c*p,i},it.determinant=function(i){var r=i[3],s=i[4],c=i[5],h=i[6],p=i[7],m=i[8];return i[0]*(m*s-c*p)+i[1]*(-m*r+c*h)+i[2]*(p*r-s*h)},it.multiply=Lr,it.translate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=r[8],D=s[0],F=s[1];return i[0]=c,i[1]=h,i[2]=p,i[3]=m,i[4]=x,i[5]=b,i[6]=D*c+F*m+S,i[7]=D*h+F*x+I,i[8]=D*p+F*b+P,i},it.rotate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=r[8],D=Math.sin(s),F=Math.cos(s);return i[0]=F*c+D*m,i[1]=F*h+D*x,i[2]=F*p+D*b,i[3]=F*m-D*c,i[4]=F*x-D*h,i[5]=F*b-D*p,i[6]=S,i[7]=I,i[8]=P,i},it.scale=function(i,r,s){var c=s[0],h=s[1];return i[0]=c*r[0],i[1]=c*r[1],i[2]=c*r[2],i[3]=h*r[3],i[4]=h*r[4],i[5]=h*r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i},it.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=r[0],i[7]=r[1],i[8]=1,i},it.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=0,i[3]=-s,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},it.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=r[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},it.fromMat2d=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=0,i[3]=r[2],i[4]=r[3],i[5]=0,i[6]=r[4],i[7]=r[5],i[8]=1,i},it.fromQuat=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=s+s,x=c+c,b=h+h,S=s*m,I=c*m,P=c*x,D=h*m,F=h*x,U=h*b,V=p*m,W=p*x,ee=p*b;return i[0]=1-P-U,i[3]=I-ee,i[6]=D+W,i[1]=I+ee,i[4]=1-S-U,i[7]=F-V,i[2]=D-W,i[5]=F+V,i[8]=1-S-P,i},it.normalFromMat4=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=r[6],S=r[7],I=r[8],P=r[9],D=r[10],F=r[11],U=r[12],V=r[13],W=r[14],ee=r[15],ce=s*x-c*m,ue=s*b-h*m,he=s*S-p*m,Se=c*b-h*x,be=c*S-p*x,ke=h*S-p*b,Le=I*V-P*U,je=I*W-D*U,ot=I*ee-F*U,Ze=P*W-D*V,dt=P*ee-F*V,At=D*ee-F*W,ct=ce*At-ue*dt+he*Ze+Se*ot-be*je+ke*Le;return ct?(i[0]=(x*At-b*dt+S*Ze)*(ct=1/ct),i[1]=(b*ot-m*At-S*je)*ct,i[2]=(m*dt-x*ot+S*Le)*ct,i[3]=(h*dt-c*At-p*Ze)*ct,i[4]=(s*At-h*ot+p*je)*ct,i[5]=(c*ot-s*dt-p*Le)*ct,i[6]=(V*ke-W*be+ee*Se)*ct,i[7]=(W*he-U*ke-ee*ue)*ct,i[8]=(U*be-V*he+ee*ce)*ct,i):null},it.projection=function(i,r,s){return i[0]=2/r,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/s,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i},it.str=function(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"},it.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},it.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i[8]=r[8]+s[8],i},it.subtract=rr,it.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i[8]=r[8]*s,i},it.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i[6]=r[6]+s[6]*c,i[7]=r[7]+s[7]*c,i[8]=r[8]+s[8]*c,i},it.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]},it.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=i[4],x=i[5],b=i[6],S=i[7],I=i[8],P=r[0],D=r[1],F=r[2],U=r[3],V=r[4],W=r[5],ee=r[6],ce=r[7],ue=r[8];return Math.abs(s-P)<=Jt.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(c-D)<=Jt.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(h-F)<=Jt.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(p-U)<=Jt.EPSILON*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(m-V)<=Jt.EPSILON*Math.max(1,Math.abs(m),Math.abs(V))&&Math.abs(x-W)<=Jt.EPSILON*Math.max(1,Math.abs(x),Math.abs(W))&&Math.abs(b-ee)<=Jt.EPSILON*Math.max(1,Math.abs(b),Math.abs(ee))&&Math.abs(S-ce)<=Jt.EPSILON*Math.max(1,Math.abs(S),Math.abs(ce))&&Math.abs(I-ue)<=Jt.EPSILON*Math.max(1,Math.abs(I),Math.abs(ue))},it.sub=it.mul=void 0;var Jt=function(i,r){if(i&&i.__esModule)return i;if(i===null||tt(i)!=="object"&&typeof i!="function")return{default:i};var s=$t(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function $t(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return($t=function(c){return c?s:r})(i)}function Lr(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=r[8],D=s[0],F=s[1],U=s[2],V=s[3],W=s[4],ee=s[5],ce=s[6],ue=s[7],he=s[8];return i[0]=D*c+F*m+U*S,i[1]=D*h+F*x+U*I,i[2]=D*p+F*b+U*P,i[3]=V*c+W*m+ee*S,i[4]=V*h+W*x+ee*I,i[5]=V*p+W*b+ee*P,i[6]=ce*c+ue*m+he*S,i[7]=ce*h+ue*x+he*I,i[8]=ce*p+ue*b+he*P,i}function rr(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i[6]=r[6]-s[6],i[7]=r[7]-s[7],i[8]=r[8]-s[8],i}it.mul=Lr,it.sub=rr;var Zt={};function dn(i){return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},dn(i)}Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.create=function(){var i=new dr.ARRAY_TYPE(16);return dr.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},Zt.clone=function(i){var r=new dr.ARRAY_TYPE(16);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},Zt.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},Zt.fromValues=function(i,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V){var W=new dr.ARRAY_TYPE(16);return W[0]=i,W[1]=r,W[2]=s,W[3]=c,W[4]=h,W[5]=p,W[6]=m,W[7]=x,W[8]=b,W[9]=S,W[10]=I,W[11]=P,W[12]=D,W[13]=F,W[14]=U,W[15]=V,W},Zt.set=function(i,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i[4]=p,i[5]=m,i[6]=x,i[7]=b,i[8]=S,i[9]=I,i[10]=P,i[11]=D,i[12]=F,i[13]=U,i[14]=V,i[15]=W,i},Zt.identity=Tr,Zt.transpose=function(i,r){if(i===r){var s=r[1],c=r[2],h=r[3],p=r[6],m=r[7],x=r[11];i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=s,i[6]=r[9],i[7]=r[13],i[8]=c,i[9]=p,i[11]=r[14],i[12]=h,i[13]=m,i[14]=x}else i[0]=r[0],i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=r[1],i[5]=r[5],i[6]=r[9],i[7]=r[13],i[8]=r[2],i[9]=r[6],i[10]=r[10],i[11]=r[14],i[12]=r[3],i[13]=r[7],i[14]=r[11],i[15]=r[15];return i},Zt.invert=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=r[6],S=r[7],I=r[8],P=r[9],D=r[10],F=r[11],U=r[12],V=r[13],W=r[14],ee=r[15],ce=s*x-c*m,ue=s*b-h*m,he=s*S-p*m,Se=c*b-h*x,be=c*S-p*x,ke=h*S-p*b,Le=I*V-P*U,je=I*W-D*U,ot=I*ee-F*U,Ze=P*W-D*V,dt=P*ee-F*V,At=D*ee-F*W,ct=ce*At-ue*dt+he*Ze+Se*ot-be*je+ke*Le;return ct?(i[0]=(x*At-b*dt+S*Ze)*(ct=1/ct),i[1]=(h*dt-c*At-p*Ze)*ct,i[2]=(V*ke-W*be+ee*Se)*ct,i[3]=(D*be-P*ke-F*Se)*ct,i[4]=(b*ot-m*At-S*je)*ct,i[5]=(s*At-h*ot+p*je)*ct,i[6]=(W*he-U*ke-ee*ue)*ct,i[7]=(I*ke-D*he+F*ue)*ct,i[8]=(m*dt-x*ot+S*Le)*ct,i[9]=(c*ot-s*dt-p*Le)*ct,i[10]=(U*be-V*he+ee*ce)*ct,i[11]=(P*he-I*be-F*ce)*ct,i[12]=(x*je-m*Ze-b*Le)*ct,i[13]=(s*Ze-c*je+h*Le)*ct,i[14]=(V*ue-U*Se-W*ce)*ct,i[15]=(I*Se-P*ue+D*ce)*ct,i):null},Zt.adjoint=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=r[4],x=r[5],b=r[6],S=r[7],I=r[8],P=r[9],D=r[10],F=r[11],U=r[12],V=r[13],W=r[14],ee=r[15];return i[0]=x*(D*ee-F*W)-P*(b*ee-S*W)+V*(b*F-S*D),i[1]=-(c*(D*ee-F*W)-P*(h*ee-p*W)+V*(h*F-p*D)),i[2]=c*(b*ee-S*W)-x*(h*ee-p*W)+V*(h*S-p*b),i[3]=-(c*(b*F-S*D)-x*(h*F-p*D)+P*(h*S-p*b)),i[4]=-(m*(D*ee-F*W)-I*(b*ee-S*W)+U*(b*F-S*D)),i[5]=s*(D*ee-F*W)-I*(h*ee-p*W)+U*(h*F-p*D),i[6]=-(s*(b*ee-S*W)-m*(h*ee-p*W)+U*(h*S-p*b)),i[7]=s*(b*F-S*D)-m*(h*F-p*D)+I*(h*S-p*b),i[8]=m*(P*ee-F*V)-I*(x*ee-S*V)+U*(x*F-S*P),i[9]=-(s*(P*ee-F*V)-I*(c*ee-p*V)+U*(c*F-p*P)),i[10]=s*(x*ee-S*V)-m*(c*ee-p*V)+U*(c*S-p*x),i[11]=-(s*(x*F-S*P)-m*(c*F-p*P)+I*(c*S-p*x)),i[12]=-(m*(P*W-D*V)-I*(x*W-b*V)+U*(x*D-b*P)),i[13]=s*(P*W-D*V)-I*(c*W-h*V)+U*(c*D-h*P),i[14]=-(s*(x*W-b*V)-m*(c*W-h*V)+U*(c*b-h*x)),i[15]=s*(x*D-b*P)-m*(c*D-h*P)+I*(c*b-h*x),i},Zt.determinant=function(i){var r=i[0],s=i[1],c=i[2],h=i[3],p=i[4],m=i[5],x=i[6],b=i[7],S=i[8],I=i[9],P=i[10],D=i[11],F=i[12],U=i[13],V=i[14],W=i[15];return(r*m-s*p)*(P*W-D*V)-(r*x-c*p)*(I*W-D*U)+(r*b-h*p)*(I*V-P*U)+(s*x-c*m)*(S*W-D*F)-(s*b-h*m)*(S*V-P*F)+(c*b-h*x)*(S*U-I*F)},Zt.multiply=wr,Zt.translate=function(i,r,s){var c,h,p,m,x,b,S,I,P,D,F,U,V=s[0],W=s[1],ee=s[2];return r===i?(i[12]=r[0]*V+r[4]*W+r[8]*ee+r[12],i[13]=r[1]*V+r[5]*W+r[9]*ee+r[13],i[14]=r[2]*V+r[6]*W+r[10]*ee+r[14],i[15]=r[3]*V+r[7]*W+r[11]*ee+r[15]):(h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=r[8],D=r[9],F=r[10],U=r[11],i[0]=c=r[0],i[1]=h,i[2]=p,i[3]=m,i[4]=x,i[5]=b,i[6]=S,i[7]=I,i[8]=P,i[9]=D,i[10]=F,i[11]=U,i[12]=c*V+x*W+P*ee+r[12],i[13]=h*V+b*W+D*ee+r[13],i[14]=p*V+S*W+F*ee+r[14],i[15]=m*V+I*W+U*ee+r[15]),i},Zt.scale=function(i,r,s){var c=s[0],h=s[1],p=s[2];return i[0]=r[0]*c,i[1]=r[1]*c,i[2]=r[2]*c,i[3]=r[3]*c,i[4]=r[4]*h,i[5]=r[5]*h,i[6]=r[6]*h,i[7]=r[7]*h,i[8]=r[8]*p,i[9]=r[9]*p,i[10]=r[10]*p,i[11]=r[11]*p,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},Zt.rotate=function(i,r,s,c){var h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se,be,ke,Le,je,ot,Ze,dt=c[0],At=c[1],ct=c[2],bt=Math.hypot(dt,At,ct);return bt<dr.EPSILON?null:(dt*=bt=1/bt,At*=bt,ct*=bt,h=Math.sin(s),p=Math.cos(s),b=r[1],S=r[2],I=r[3],D=r[5],F=r[6],U=r[7],W=r[9],ee=r[10],ce=r[11],ue=dt*dt*(m=1-p)+p,be=dt*At*m-ct*h,ke=At*At*m+p,Le=ct*At*m+dt*h,je=dt*ct*m+At*h,ot=At*ct*m-dt*h,Ze=ct*ct*m+p,i[0]=(x=r[0])*ue+(P=r[4])*(he=At*dt*m+ct*h)+(V=r[8])*(Se=ct*dt*m-At*h),i[1]=b*ue+D*he+W*Se,i[2]=S*ue+F*he+ee*Se,i[3]=I*ue+U*he+ce*Se,i[4]=x*be+P*ke+V*Le,i[5]=b*be+D*ke+W*Le,i[6]=S*be+F*ke+ee*Le,i[7]=I*be+U*ke+ce*Le,i[8]=x*je+P*ot+V*Ze,i[9]=b*je+D*ot+W*Ze,i[10]=S*je+F*ot+ee*Ze,i[11]=I*je+U*ot+ce*Ze,r!==i&&(i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i)},Zt.rotateX=function(i,r,s){var c=Math.sin(s),h=Math.cos(s),p=r[4],m=r[5],x=r[6],b=r[7],S=r[8],I=r[9],P=r[10],D=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=p*h+S*c,i[5]=m*h+I*c,i[6]=x*h+P*c,i[7]=b*h+D*c,i[8]=S*h-p*c,i[9]=I*h-m*c,i[10]=P*h-x*c,i[11]=D*h-b*c,i},Zt.rotateY=function(i,r,s){var c=Math.sin(s),h=Math.cos(s),p=r[0],m=r[1],x=r[2],b=r[3],S=r[8],I=r[9],P=r[10],D=r[11];return r!==i&&(i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=p*h-S*c,i[1]=m*h-I*c,i[2]=x*h-P*c,i[3]=b*h-D*c,i[8]=p*c+S*h,i[9]=m*c+I*h,i[10]=x*c+P*h,i[11]=b*c+D*h,i},Zt.rotateZ=function(i,r,s){var c=Math.sin(s),h=Math.cos(s),p=r[0],m=r[1],x=r[2],b=r[3],S=r[4],I=r[5],P=r[6],D=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=p*h+S*c,i[1]=m*h+I*c,i[2]=x*h+P*c,i[3]=b*h+D*c,i[4]=S*h-p*c,i[5]=I*h-m*c,i[6]=P*h-x*c,i[7]=D*h-b*c,i},Zt.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i},Zt.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Zt.fromRotation=function(i,r,s){var c,h,p,m=s[0],x=s[1],b=s[2],S=Math.hypot(m,x,b);return S<dr.EPSILON?null:(m*=S=1/S,x*=S,b*=S,c=Math.sin(r),h=Math.cos(r),i[0]=m*m*(p=1-h)+h,i[1]=x*m*p+b*c,i[2]=b*m*p-x*c,i[3]=0,i[4]=m*x*p-b*c,i[5]=x*x*p+h,i[6]=b*x*p+m*c,i[7]=0,i[8]=m*b*p+x*c,i[9]=x*b*p-m*c,i[10]=b*b*p+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)},Zt.fromXRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=c,i[6]=s,i[7]=0,i[8]=0,i[9]=-s,i[10]=c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Zt.fromYRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=0,i[2]=-s,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=s,i[9]=0,i[10]=c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Zt.fromZRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=0,i[3]=0,i[4]=-s,i[5]=c,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Zt.fromRotationTranslation=Er,Zt.fromQuat2=function(i,r){var s=new dr.ARRAY_TYPE(3),c=-r[0],h=-r[1],p=-r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=c*c+h*h+p*p+m*m;return P>0?(s[0]=2*(x*m+I*c+b*p-S*h)/P,s[1]=2*(b*m+I*h+S*c-x*p)/P,s[2]=2*(S*m+I*p+x*h-b*c)/P):(s[0]=2*(x*m+I*c+b*p-S*h),s[1]=2*(b*m+I*h+S*c-x*p),s[2]=2*(S*m+I*p+x*h-b*c)),Er(i,r,s),i},Zt.getTranslation=function(i,r){return i[0]=r[12],i[1]=r[13],i[2]=r[14],i},Zt.getScaling=Zn,Zt.getRotation=function(i,r){var s=new dr.ARRAY_TYPE(3);Zn(s,r);var c=1/s[0],h=1/s[1],p=1/s[2],m=r[0]*c,x=r[1]*h,b=r[2]*p,S=r[4]*c,I=r[5]*h,P=r[6]*p,D=r[8]*c,F=r[9]*h,U=r[10]*p,V=m+I+U,W=0;return V>0?(W=2*Math.sqrt(V+1),i[3]=.25*W,i[0]=(P-F)/W,i[1]=(D-b)/W,i[2]=(x-S)/W):m>I&&m>U?(W=2*Math.sqrt(1+m-I-U),i[3]=(P-F)/W,i[0]=.25*W,i[1]=(x+S)/W,i[2]=(D+b)/W):I>U?(W=2*Math.sqrt(1+I-m-U),i[3]=(D-b)/W,i[0]=(x+S)/W,i[1]=.25*W,i[2]=(P+F)/W):(W=2*Math.sqrt(1+U-m-I),i[3]=(x-S)/W,i[0]=(D+b)/W,i[1]=(P+F)/W,i[2]=.25*W),i},Zt.fromRotationTranslationScale=function(i,r,s,c){var h=r[0],p=r[1],m=r[2],x=r[3],b=h+h,S=p+p,I=m+m,P=h*b,D=h*S,F=h*I,U=p*S,V=p*I,W=m*I,ee=x*b,ce=x*S,ue=x*I,he=c[0],Se=c[1],be=c[2];return i[0]=(1-(U+W))*he,i[1]=(D+ue)*he,i[2]=(F-ce)*he,i[3]=0,i[4]=(D-ue)*Se,i[5]=(1-(P+W))*Se,i[6]=(V+ee)*Se,i[7]=0,i[8]=(F+ce)*be,i[9]=(V-ee)*be,i[10]=(1-(P+U))*be,i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i},Zt.fromRotationTranslationScaleOrigin=function(i,r,s,c,h){var p=r[0],m=r[1],x=r[2],b=r[3],S=p+p,I=m+m,P=x+x,D=p*S,F=p*I,U=p*P,V=m*I,W=m*P,ee=x*P,ce=b*S,ue=b*I,he=b*P,Se=c[0],be=c[1],ke=c[2],Le=h[0],je=h[1],ot=h[2],Ze=(1-(V+ee))*Se,dt=(F+he)*Se,At=(U-ue)*Se,ct=(F-he)*be,bt=(1-(D+ee))*be,st=(W+ce)*be,wt=(U+ue)*ke,Pt=(W-ce)*ke,Tt=(1-(D+V))*ke;return i[0]=Ze,i[1]=dt,i[2]=At,i[3]=0,i[4]=ct,i[5]=bt,i[6]=st,i[7]=0,i[8]=wt,i[9]=Pt,i[10]=Tt,i[11]=0,i[12]=s[0]+Le-(Ze*Le+ct*je+wt*ot),i[13]=s[1]+je-(dt*Le+bt*je+Pt*ot),i[14]=s[2]+ot-(At*Le+st*je+Tt*ot),i[15]=1,i},Zt.fromQuat=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=s+s,x=c+c,b=h+h,S=s*m,I=c*m,P=c*x,D=h*m,F=h*x,U=h*b,V=p*m,W=p*x,ee=p*b;return i[0]=1-P-U,i[1]=I+ee,i[2]=D-W,i[3]=0,i[4]=I-ee,i[5]=1-S-U,i[6]=F+V,i[7]=0,i[8]=D+W,i[9]=F-V,i[10]=1-S-P,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Zt.frustum=function(i,r,s,c,h,p,m){var x=1/(s-r),b=1/(h-c),S=1/(p-m);return i[0]=2*p*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*p*b,i[6]=0,i[7]=0,i[8]=(s+r)*x,i[9]=(h+c)*b,i[10]=(m+p)*S,i[11]=-1,i[12]=0,i[13]=0,i[14]=m*p*2*S,i[15]=0,i},Zt.perspectiveNO=fn,Zt.perspectiveZO=function(i,r,s,c,h){var p,m=1/Math.tan(r/2);return i[0]=m/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=h*(p=1/(c-h)),i[14]=h*c*p):(i[10]=-1,i[14]=-c),i},Zt.perspectiveFromFieldOfView=function(i,r,s,c){var h=Math.tan(r.upDegrees*Math.PI/180),p=Math.tan(r.downDegrees*Math.PI/180),m=Math.tan(r.leftDegrees*Math.PI/180),x=Math.tan(r.rightDegrees*Math.PI/180),b=2/(m+x),S=2/(h+p);return i[0]=b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=S,i[6]=0,i[7]=0,i[8]=-(m-x)*b*.5,i[9]=(h-p)*S*.5,i[10]=c/(s-c),i[11]=-1,i[12]=0,i[13]=0,i[14]=c*s/(s-c),i[15]=0,i},Zt.orthoNO=pn,Zt.orthoZO=function(i,r,s,c,h,p,m){var x=1/(r-s),b=1/(c-h),S=1/(p-m);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=S,i[11]=0,i[12]=(r+s)*x,i[13]=(h+c)*b,i[14]=p*S,i[15]=1,i},Zt.lookAt=function(i,r,s,c){var h,p,m,x,b,S,I,P,D,F,U=r[0],V=r[1],W=r[2],ee=c[0],ce=c[1],ue=c[2],he=s[0],Se=s[1],be=s[2];return Math.abs(U-he)<dr.EPSILON&&Math.abs(V-Se)<dr.EPSILON&&Math.abs(W-be)<dr.EPSILON?Tr(i):(I=U-he,P=V-Se,D=W-be,h=ce*(D*=F=1/Math.hypot(I,P,D))-ue*(P*=F),p=ue*(I*=F)-ee*D,m=ee*P-ce*I,(F=Math.hypot(h,p,m))?(h*=F=1/F,p*=F,m*=F):(h=0,p=0,m=0),x=P*m-D*p,b=D*h-I*m,S=I*p-P*h,(F=Math.hypot(x,b,S))?(x*=F=1/F,b*=F,S*=F):(x=0,b=0,S=0),i[0]=h,i[1]=x,i[2]=I,i[3]=0,i[4]=p,i[5]=b,i[6]=P,i[7]=0,i[8]=m,i[9]=S,i[10]=D,i[11]=0,i[12]=-(h*U+p*V+m*W),i[13]=-(x*U+b*V+S*W),i[14]=-(I*U+P*V+D*W),i[15]=1,i)},Zt.targetTo=function(i,r,s,c){var h=r[0],p=r[1],m=r[2],x=c[0],b=c[1],S=c[2],I=h-s[0],P=p-s[1],D=m-s[2],F=I*I+P*P+D*D;F>0&&(I*=F=1/Math.sqrt(F),P*=F,D*=F);var U=b*D-S*P,V=S*I-x*D,W=x*P-b*I;return(F=U*U+V*V+W*W)>0&&(U*=F=1/Math.sqrt(F),V*=F,W*=F),i[0]=U,i[1]=V,i[2]=W,i[3]=0,i[4]=P*W-D*V,i[5]=D*U-I*W,i[6]=I*V-P*U,i[7]=0,i[8]=I,i[9]=P,i[10]=D,i[11]=0,i[12]=h,i[13]=p,i[14]=m,i[15]=1,i},Zt.str=function(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"},Zt.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])},Zt.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i[8]=r[8]+s[8],i[9]=r[9]+s[9],i[10]=r[10]+s[10],i[11]=r[11]+s[11],i[12]=r[12]+s[12],i[13]=r[13]+s[13],i[14]=r[14]+s[14],i[15]=r[15]+s[15],i},Zt.subtract=li,Zt.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i[8]=r[8]*s,i[9]=r[9]*s,i[10]=r[10]*s,i[11]=r[11]*s,i[12]=r[12]*s,i[13]=r[13]*s,i[14]=r[14]*s,i[15]=r[15]*s,i},Zt.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i[6]=r[6]+s[6]*c,i[7]=r[7]+s[7]*c,i[8]=r[8]+s[8]*c,i[9]=r[9]+s[9]*c,i[10]=r[10]+s[10]*c,i[11]=r[11]+s[11]*c,i[12]=r[12]+s[12]*c,i[13]=r[13]+s[13]*c,i[14]=r[14]+s[14]*c,i[15]=r[15]+s[15]*c,i},Zt.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},Zt.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=i[4],x=i[5],b=i[6],S=i[7],I=i[8],P=i[9],D=i[10],F=i[11],U=i[12],V=i[13],W=i[14],ee=i[15],ce=r[0],ue=r[1],he=r[2],Se=r[3],be=r[4],ke=r[5],Le=r[6],je=r[7],ot=r[8],Ze=r[9],dt=r[10],At=r[11],ct=r[12],bt=r[13],st=r[14],wt=r[15];return Math.abs(s-ce)<=dr.EPSILON*Math.max(1,Math.abs(s),Math.abs(ce))&&Math.abs(c-ue)<=dr.EPSILON*Math.max(1,Math.abs(c),Math.abs(ue))&&Math.abs(h-he)<=dr.EPSILON*Math.max(1,Math.abs(h),Math.abs(he))&&Math.abs(p-Se)<=dr.EPSILON*Math.max(1,Math.abs(p),Math.abs(Se))&&Math.abs(m-be)<=dr.EPSILON*Math.max(1,Math.abs(m),Math.abs(be))&&Math.abs(x-ke)<=dr.EPSILON*Math.max(1,Math.abs(x),Math.abs(ke))&&Math.abs(b-Le)<=dr.EPSILON*Math.max(1,Math.abs(b),Math.abs(Le))&&Math.abs(S-je)<=dr.EPSILON*Math.max(1,Math.abs(S),Math.abs(je))&&Math.abs(I-ot)<=dr.EPSILON*Math.max(1,Math.abs(I),Math.abs(ot))&&Math.abs(P-Ze)<=dr.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ze))&&Math.abs(D-dt)<=dr.EPSILON*Math.max(1,Math.abs(D),Math.abs(dt))&&Math.abs(F-At)<=dr.EPSILON*Math.max(1,Math.abs(F),Math.abs(At))&&Math.abs(U-ct)<=dr.EPSILON*Math.max(1,Math.abs(U),Math.abs(ct))&&Math.abs(V-bt)<=dr.EPSILON*Math.max(1,Math.abs(V),Math.abs(bt))&&Math.abs(W-st)<=dr.EPSILON*Math.max(1,Math.abs(W),Math.abs(st))&&Math.abs(ee-wt)<=dr.EPSILON*Math.max(1,Math.abs(ee),Math.abs(wt))},Zt.sub=Zt.mul=Zt.ortho=Zt.perspective=void 0;var dr=function(i,r){if(i&&i.__esModule)return i;if(i===null||dn(i)!=="object"&&typeof i!="function")return{default:i};var s=Ur(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function Ur(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Ur=function(c){return c?s:r})(i)}function Tr(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function wr(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=r[8],D=r[9],F=r[10],U=r[11],V=r[12],W=r[13],ee=r[14],ce=r[15],ue=s[0],he=s[1],Se=s[2],be=s[3];return i[0]=ue*c+he*x+Se*P+be*V,i[1]=ue*h+he*b+Se*D+be*W,i[2]=ue*p+he*S+Se*F+be*ee,i[3]=ue*m+he*I+Se*U+be*ce,i[4]=(ue=s[4])*c+(he=s[5])*x+(Se=s[6])*P+(be=s[7])*V,i[5]=ue*h+he*b+Se*D+be*W,i[6]=ue*p+he*S+Se*F+be*ee,i[7]=ue*m+he*I+Se*U+be*ce,i[8]=(ue=s[8])*c+(he=s[9])*x+(Se=s[10])*P+(be=s[11])*V,i[9]=ue*h+he*b+Se*D+be*W,i[10]=ue*p+he*S+Se*F+be*ee,i[11]=ue*m+he*I+Se*U+be*ce,i[12]=(ue=s[12])*c+(he=s[13])*x+(Se=s[14])*P+(be=s[15])*V,i[13]=ue*h+he*b+Se*D+be*W,i[14]=ue*p+he*S+Se*F+be*ee,i[15]=ue*m+he*I+Se*U+be*ce,i}function Er(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=c+c,b=h+h,S=p+p,I=c*x,P=c*b,D=c*S,F=h*b,U=h*S,V=p*S,W=m*x,ee=m*b,ce=m*S;return i[0]=1-(F+V),i[1]=P+ce,i[2]=D-ee,i[3]=0,i[4]=P-ce,i[5]=1-(I+V),i[6]=U+W,i[7]=0,i[8]=D+ee,i[9]=U-W,i[10]=1-(I+F),i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i}function Zn(i,r){var s=r[4],c=r[5],h=r[6],p=r[8],m=r[9],x=r[10];return i[0]=Math.hypot(r[0],r[1],r[2]),i[1]=Math.hypot(s,c,h),i[2]=Math.hypot(p,m,x),i}function fn(i,r,s,c,h){var p,m=1/Math.tan(r/2);return i[0]=m/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+c)*(p=1/(c-h)),i[14]=2*h*c*p):(i[10]=-1,i[14]=-2*c),i}function pn(i,r,s,c,h,p,m){var x=1/(r-s),b=1/(c-h),S=1/(p-m);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*S,i[11]=0,i[12]=(r+s)*x,i[13]=(h+c)*b,i[14]=(m+p)*S,i[15]=1,i}function li(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i[6]=r[6]-s[6],i[7]=r[7]-s[7],i[8]=r[8]-s[8],i[9]=r[9]-s[9],i[10]=r[10]-s[10],i[11]=r[11]-s[11],i[12]=r[12]-s[12],i[13]=r[13]-s[13],i[14]=r[14]-s[14],i[15]=r[15]-s[15],i}Zt.perspective=fn,Zt.ortho=pn,Zt.mul=wr,Zt.sub=li;var or={},Yt={};function un(i){return un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},un(i)}Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.create=ri,Yt.clone=function(i){var r=new _n.ARRAY_TYPE(3);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r},Yt.length=Ln,Yt.fromValues=function(i,r,s){var c=new _n.ARRAY_TYPE(3);return c[0]=i,c[1]=r,c[2]=s,c},Yt.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i},Yt.set=function(i,r,s,c){return i[0]=r,i[1]=s,i[2]=c,i},Yt.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i},Yt.subtract=Vn,Yt.multiply=Xr,Yt.divide=yr,Yt.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i[2]=Math.ceil(r[2]),i},Yt.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i[2]=Math.floor(r[2]),i},Yt.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i[2]=Math.min(r[2],s[2]),i},Yt.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i[2]=Math.max(r[2],s[2]),i},Yt.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i[2]=Math.round(r[2]),i},Yt.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i},Yt.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i},Yt.distance=xi,Yt.squaredDistance=Ei,Yt.squaredLength=$i,Yt.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i},Yt.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i[2]=1/r[2],i},Yt.normalize=function(i,r){var s=r[0],c=r[1],h=r[2],p=s*s+c*c+h*h;return p>0&&(p=1/Math.sqrt(p)),i[0]=r[0]*p,i[1]=r[1]*p,i[2]=r[2]*p,i},Yt.dot=vr,Yt.cross=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=s[0],x=s[1],b=s[2];return i[0]=h*b-p*x,i[1]=p*m-c*b,i[2]=c*x-h*m,i},Yt.lerp=function(i,r,s,c){var h=r[0],p=r[1],m=r[2];return i[0]=h+c*(s[0]-h),i[1]=p+c*(s[1]-p),i[2]=m+c*(s[2]-m),i},Yt.hermite=function(i,r,s,c,h,p){var m=p*p,x=m*(2*p-3)+1,b=m*(p-2)+p,S=m*(p-1),I=m*(3-2*p);return i[0]=r[0]*x+s[0]*b+c[0]*S+h[0]*I,i[1]=r[1]*x+s[1]*b+c[1]*S+h[1]*I,i[2]=r[2]*x+s[2]*b+c[2]*S+h[2]*I,i},Yt.bezier=function(i,r,s,c,h,p){var m=1-p,x=m*m,b=p*p,S=x*m,I=3*p*x,P=3*b*m,D=b*p;return i[0]=r[0]*S+s[0]*I+c[0]*P+h[0]*D,i[1]=r[1]*S+s[1]*I+c[1]*P+h[1]*D,i[2]=r[2]*S+s[2]*I+c[2]*P+h[2]*D,i},Yt.random=function(i,r){r=r||1;var s=2*_n.RANDOM()*Math.PI,c=2*_n.RANDOM()-1,h=Math.sqrt(1-c*c)*r;return i[0]=Math.cos(s)*h,i[1]=Math.sin(s)*h,i[2]=c*r,i},Yt.transformMat4=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=s[3]*c+s[7]*h+s[11]*p+s[15];return i[0]=(s[0]*c+s[4]*h+s[8]*p+s[12])/(m=m||1),i[1]=(s[1]*c+s[5]*h+s[9]*p+s[13])/m,i[2]=(s[2]*c+s[6]*h+s[10]*p+s[14])/m,i},Yt.transformMat3=function(i,r,s){var c=r[0],h=r[1],p=r[2];return i[0]=c*s[0]+h*s[3]+p*s[6],i[1]=c*s[1]+h*s[4]+p*s[7],i[2]=c*s[2]+h*s[5]+p*s[8],i},Yt.transformQuat=function(i,r,s){var c=s[0],h=s[1],p=s[2],m=r[0],x=r[1],b=r[2],S=h*b-p*x,I=p*m-c*b,P=c*x-h*m,D=h*P-p*I,F=p*S-c*P,U=c*I-h*S,V=2*s[3];return I*=V,P*=V,F*=2,U*=2,i[0]=m+(S*=V)+(D*=2),i[1]=x+I+F,i[2]=b+P+U,i},Yt.rotateX=function(i,r,s,c){var h=[],p=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],p[0]=h[0],p[1]=h[1]*Math.cos(c)-h[2]*Math.sin(c),p[2]=h[1]*Math.sin(c)+h[2]*Math.cos(c),i[0]=p[0]+s[0],i[1]=p[1]+s[1],i[2]=p[2]+s[2],i},Yt.rotateY=function(i,r,s,c){var h=[],p=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],p[0]=h[2]*Math.sin(c)+h[0]*Math.cos(c),p[1]=h[1],p[2]=h[2]*Math.cos(c)-h[0]*Math.sin(c),i[0]=p[0]+s[0],i[1]=p[1]+s[1],i[2]=p[2]+s[2],i},Yt.rotateZ=function(i,r,s,c){var h=[],p=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],p[0]=h[0]*Math.cos(c)-h[1]*Math.sin(c),p[1]=h[0]*Math.sin(c)+h[1]*Math.cos(c),p[2]=h[2],i[0]=p[0]+s[0],i[1]=p[1]+s[1],i[2]=p[2]+s[2],i},Yt.angle=function(i,r){var s=i[0],c=i[1],h=i[2],p=r[0],m=r[1],x=r[2],b=Math.sqrt(s*s+c*c+h*h)*Math.sqrt(p*p+m*m+x*x),S=b&&vr(i,r)/b;return Math.acos(Math.min(Math.max(S,-1),1))},Yt.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i},Yt.str=function(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"},Yt.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]},Yt.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=r[0],m=r[1],x=r[2];return Math.abs(s-p)<=_n.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(c-m)<=_n.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(h-x)<=_n.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},Yt.forEach=Yt.sqrLen=Yt.len=Yt.sqrDist=Yt.dist=Yt.div=Yt.mul=Yt.sub=void 0;var _n=function(i,r){if(i&&i.__esModule)return i;if(i===null||un(i)!=="object"&&typeof i!="function")return{default:i};var s=rn(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function rn(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(rn=function(c){return c?s:r})(i)}function ri(){var i=new _n.ARRAY_TYPE(3);return _n.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Ln(i){return Math.hypot(i[0],i[1],i[2])}function Vn(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i}function Xr(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i[2]=r[2]*s[2],i}function yr(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i[2]=r[2]/s[2],i}function xi(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1],r[2]-i[2])}function Ei(i,r){var s=r[0]-i[0],c=r[1]-i[1],h=r[2]-i[2];return s*s+c*c+h*h}function $i(i){var r=i[0],s=i[1],c=i[2];return r*r+s*s+c*c}function vr(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]}Yt.sub=Vn,Yt.mul=Xr,Yt.div=yr,Yt.dist=xi,Yt.sqrDist=Ei,Yt.len=Ln,Yt.sqrLen=$i;var nn,Hn=(nn=ri(),function(i,r,s,c,h,p){var m,x;for(r||(r=3),s||(s=0),x=c?Math.min(c*r+s,i.length):i.length,m=s;m<x;m+=r)nn[0]=i[m],nn[1]=i[m+1],nn[2]=i[m+2],h(nn,nn,p),i[m]=nn[0],i[m+1]=nn[1],i[m+2]=nn[2];return i});Yt.forEach=Hn;var cr={};function Is(i){return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Is(i)}Object.defineProperty(cr,"__esModule",{value:!0}),cr.create=_o,cr.clone=function(i){var r=new Mn.ARRAY_TYPE(4);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r},cr.fromValues=function(i,r,s,c){var h=new Mn.ARRAY_TYPE(4);return h[0]=i,h[1]=r,h[2]=s,h[3]=c,h},cr.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i},cr.set=function(i,r,s,c,h){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i},cr.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i},cr.subtract=ci,cr.multiply=Bi,cr.divide=Ms,cr.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i[2]=Math.ceil(r[2]),i[3]=Math.ceil(r[3]),i},cr.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i[2]=Math.floor(r[2]),i[3]=Math.floor(r[3]),i},cr.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i[2]=Math.min(r[2],s[2]),i[3]=Math.min(r[3],s[3]),i},cr.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i[2]=Math.max(r[2],s[2]),i[3]=Math.max(r[3],s[3]),i},cr.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i[2]=Math.round(r[2]),i[3]=Math.round(r[3]),i},cr.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i},cr.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i},cr.distance=fs,cr.squaredDistance=Cr,cr.length=Je,cr.squaredLength=Vt,cr.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=-r[3],i},cr.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i[2]=1/r[2],i[3]=1/r[3],i},cr.normalize=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=s*s+c*c+h*h+p*p;return m>0&&(m=1/Math.sqrt(m)),i[0]=s*m,i[1]=c*m,i[2]=h*m,i[3]=p*m,i},cr.dot=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3]},cr.cross=function(i,r,s,c){var h=s[0]*c[1]-s[1]*c[0],p=s[0]*c[2]-s[2]*c[0],m=s[0]*c[3]-s[3]*c[0],x=s[1]*c[2]-s[2]*c[1],b=s[1]*c[3]-s[3]*c[1],S=s[2]*c[3]-s[3]*c[2],I=r[0],P=r[1],D=r[2],F=r[3];return i[0]=P*S-D*b+F*x,i[1]=-I*S+D*m-F*p,i[2]=I*b-P*m+F*h,i[3]=-I*x+P*p-D*h,i},cr.lerp=function(i,r,s,c){var h=r[0],p=r[1],m=r[2],x=r[3];return i[0]=h+c*(s[0]-h),i[1]=p+c*(s[1]-p),i[2]=m+c*(s[2]-m),i[3]=x+c*(s[3]-x),i},cr.random=function(i,r){var s,c,h,p,m,x;r=r||1;do m=(s=2*Mn.RANDOM()-1)*s+(c=2*Mn.RANDOM()-1)*c;while(m>=1);do x=(h=2*Mn.RANDOM()-1)*h+(p=2*Mn.RANDOM()-1)*p;while(x>=1);var b=Math.sqrt((1-m)/x);return i[0]=r*s,i[1]=r*c,i[2]=r*h*b,i[3]=r*p*b,i},cr.transformMat4=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3];return i[0]=s[0]*c+s[4]*h+s[8]*p+s[12]*m,i[1]=s[1]*c+s[5]*h+s[9]*p+s[13]*m,i[2]=s[2]*c+s[6]*h+s[10]*p+s[14]*m,i[3]=s[3]*c+s[7]*h+s[11]*p+s[15]*m,i},cr.transformQuat=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=s[0],x=s[1],b=s[2],S=s[3],I=S*c+x*p-b*h,P=S*h+b*c-m*p,D=S*p+m*h-x*c,F=-m*c-x*h-b*p;return i[0]=I*S+F*-m+P*-b-D*-x,i[1]=P*S+F*-x+D*-m-I*-b,i[2]=D*S+F*-b+I*-x-P*-m,i[3]=r[3],i},cr.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i},cr.str=function(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},cr.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]},cr.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=r[0],x=r[1],b=r[2],S=r[3];return Math.abs(s-m)<=Mn.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-x)<=Mn.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(h-b)<=Mn.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(p-S)<=Mn.EPSILON*Math.max(1,Math.abs(p),Math.abs(S))},cr.forEach=cr.sqrLen=cr.len=cr.sqrDist=cr.dist=cr.div=cr.mul=cr.sub=void 0;var Mn=function(i,r){if(i&&i.__esModule)return i;if(i===null||Is(i)!=="object"&&typeof i!="function")return{default:i};var s=Xi(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function Xi(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Xi=function(c){return c?s:r})(i)}function _o(){var i=new Mn.ARRAY_TYPE(4);return Mn.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function ci(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i}function Bi(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i[2]=r[2]*s[2],i[3]=r[3]*s[3],i}function Ms(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i[2]=r[2]/s[2],i[3]=r[3]/s[3],i}function fs(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1],r[2]-i[2],r[3]-i[3])}function Cr(i,r){var s=r[0]-i[0],c=r[1]-i[1],h=r[2]-i[2],p=r[3]-i[3];return s*s+c*c+h*h+p*p}function Je(i){return Math.hypot(i[0],i[1],i[2],i[3])}function Vt(i){var r=i[0],s=i[1],c=i[2],h=i[3];return r*r+s*s+c*c+h*h}cr.sub=ci,cr.mul=Bi,cr.div=Ms,cr.dist=fs,cr.sqrDist=Cr,cr.len=Je,cr.sqrLen=Vt;var Ct=function(){var i=_o();return function(r,s,c,h,p,m){var x,b;for(s||(s=4),c||(c=0),b=h?Math.min(h*s+c,r.length):r.length,x=c;x<b;x+=s)i[0]=r[x],i[1]=r[x+1],i[2]=r[x+2],i[3]=r[x+3],p(i,i,m),r[x]=i[0],r[x+1]=i[1],r[x+2]=i[2],r[x+3]=i[3];return r}}();function Wt(i){return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wt(i)}cr.forEach=Ct,Object.defineProperty(or,"__esModule",{value:!0}),or.create=qt,or.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i},or.setAxisAngle=ar,or.getAxisAngle=function(i,r){var s=2*Math.acos(r[3]),c=Math.sin(s/2);return c>ir.EPSILON?(i[0]=r[0]/c,i[1]=r[1]/c,i[2]=r[2]/c):(i[0]=1,i[1]=0,i[2]=0),s},or.getAngle=function(i,r){var s=Ie(i,r);return Math.acos(2*s*s-1)},or.multiply=gr,or.rotateX=function(i,r,s){s*=.5;var c=r[0],h=r[1],p=r[2],m=r[3],x=Math.sin(s),b=Math.cos(s);return i[0]=c*b+m*x,i[1]=h*b+p*x,i[2]=p*b-h*x,i[3]=m*b-c*x,i},or.rotateY=function(i,r,s){s*=.5;var c=r[0],h=r[1],p=r[2],m=r[3],x=Math.sin(s),b=Math.cos(s);return i[0]=c*b-p*x,i[1]=h*b+m*x,i[2]=p*b+c*x,i[3]=m*b-h*x,i},or.rotateZ=function(i,r,s){s*=.5;var c=r[0],h=r[1],p=r[2],m=r[3],x=Math.sin(s),b=Math.cos(s);return i[0]=c*b+h*x,i[1]=h*b-c*x,i[2]=p*b+m*x,i[3]=m*b-p*x,i},or.calculateW=function(i,r){var s=r[0],c=r[1],h=r[2];return i[0]=s,i[1]=c,i[2]=h,i[3]=Math.sqrt(Math.abs(1-s*s-c*c-h*h)),i},or.exp=xe,or.ln=X,or.pow=function(i,r,s){return X(i,r),we(i,i,s),xe(i,i),i},or.slerp=re,or.random=function(i){var r=ir.RANDOM(),s=ir.RANDOM(),c=ir.RANDOM(),h=Math.sqrt(1-r),p=Math.sqrt(r);return i[0]=h*Math.sin(2*Math.PI*s),i[1]=h*Math.cos(2*Math.PI*s),i[2]=p*Math.sin(2*Math.PI*c),i[3]=p*Math.cos(2*Math.PI*c),i},or.invert=function(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=s*s+c*c+h*h+p*p,x=m?1/m:0;return i[0]=-s*x,i[1]=-c*x,i[2]=-h*x,i[3]=p*x,i},or.conjugate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=r[3],i},or.fromMat3=le,or.fromEuler=function(i,r,s,c){var h=.5*Math.PI/180;r*=h,s*=h,c*=h;var p=Math.sin(r),m=Math.cos(r),x=Math.sin(s),b=Math.cos(s),S=Math.sin(c),I=Math.cos(c);return i[0]=p*b*I-m*x*S,i[1]=m*x*I+p*b*S,i[2]=m*b*S-p*x*I,i[3]=m*b*I+p*x*S,i},or.str=function(i){return"quat("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},or.setAxes=or.sqlerp=or.rotationTo=or.equals=or.exactEquals=or.normalize=or.sqrLen=or.squaredLength=or.len=or.length=or.lerp=or.dot=or.scale=or.mul=or.add=or.set=or.copy=or.fromValues=or.clone=void 0;var ir=mt(J),ur=mt(it),Be=mt(Yt),ze=mt(cr);function lt(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(lt=function(c){return c?s:r})(i)}function mt(i,r){if(i&&i.__esModule)return i;if(i===null||Wt(i)!=="object"&&typeof i!="function")return{default:i};var s=lt(r);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}function qt(){var i=new ir.ARRAY_TYPE(4);return ir.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function ar(i,r,s){s*=.5;var c=Math.sin(s);return i[0]=c*r[0],i[1]=c*r[1],i[2]=c*r[2],i[3]=Math.cos(s),i}function gr(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=s[0],b=s[1],S=s[2],I=s[3];return i[0]=c*I+m*x+h*S-p*b,i[1]=h*I+m*b+p*x-c*S,i[2]=p*I+m*S+c*b-h*x,i[3]=m*I-c*x-h*b-p*S,i}function xe(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=Math.sqrt(s*s+c*c+h*h),x=Math.exp(p),b=m>0?x*Math.sin(m)/m:0;return i[0]=s*b,i[1]=c*b,i[2]=h*b,i[3]=x*Math.cos(m),i}function X(i,r){var s=r[0],c=r[1],h=r[2],p=r[3],m=Math.sqrt(s*s+c*c+h*h),x=m>0?Math.atan2(m,p)/m:0;return i[0]=s*x,i[1]=c*x,i[2]=h*x,i[3]=.5*Math.log(s*s+c*c+h*h+p*p),i}function re(i,r,s,c){var h,p,m,x,b,S=r[0],I=r[1],P=r[2],D=r[3],F=s[0],U=s[1],V=s[2],W=s[3];return(p=S*F+I*U+P*V+D*W)<0&&(p=-p,F=-F,U=-U,V=-V,W=-W),1-p>ir.EPSILON?(h=Math.acos(p),m=Math.sin(h),x=Math.sin((1-c)*h)/m,b=Math.sin(c*h)/m):(x=1-c,b=c),i[0]=x*S+b*F,i[1]=x*I+b*U,i[2]=x*P+b*V,i[3]=x*D+b*W,i}function le(i,r){var s,c=r[0]+r[4]+r[8];if(c>0)s=Math.sqrt(c+1),i[3]=.5*s,i[0]=(r[5]-r[7])*(s=.5/s),i[1]=(r[6]-r[2])*s,i[2]=(r[1]-r[3])*s;else{var h=0;r[4]>r[0]&&(h=1),r[8]>r[3*h+h]&&(h=2);var p=(h+1)%3,m=(h+2)%3;s=Math.sqrt(r[3*h+h]-r[3*p+p]-r[3*m+m]+1),i[h]=.5*s,i[3]=(r[3*p+m]-r[3*m+p])*(s=.5/s),i[p]=(r[3*p+h]+r[3*h+p])*s,i[m]=(r[3*m+h]+r[3*h+m])*s}return i}or.clone=ze.clone,or.fromValues=ze.fromValues,or.copy=ze.copy,or.set=ze.set,or.add=ze.add,or.mul=gr;var we=ze.scale;or.scale=we;var Ie=ze.dot;or.dot=Ie,or.lerp=ze.lerp;var Oe=ze.length;or.length=Oe,or.len=Oe;var $e=ze.squaredLength;or.squaredLength=$e,or.sqrLen=$e;var Fe=ze.normalize;or.normalize=Fe,or.exactEquals=ze.exactEquals,or.equals=ze.equals;var qe,kt,Et,er=(qe=Be.create(),kt=Be.fromValues(1,0,0),Et=Be.fromValues(0,1,0),function(i,r,s){var c=Be.dot(r,s);return c<-.999999?(Be.cross(qe,kt,r),Be.len(qe)<1e-6&&Be.cross(qe,Et,r),Be.normalize(qe,qe),ar(i,qe,Math.PI),i):c>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Be.cross(qe,r,s),i[0]=qe[0],i[1]=qe[1],i[2]=qe[2],i[3]=1+c,Fe(i,i))});or.rotationTo=er;var pr,kr,Pr=(pr=qt(),kr=qt(),function(i,r,s,c,h,p){return re(pr,r,h,p),re(kr,s,c,p),re(i,pr,kr,2*p*(1-p)),i});or.sqlerp=Pr;var Ar,Yr=(Ar=ur.create(),function(i,r,s,c){return Ar[0]=s[0],Ar[3]=s[1],Ar[6]=s[2],Ar[1]=c[0],Ar[4]=c[1],Ar[7]=c[2],Ar[2]=-r[0],Ar[5]=-r[1],Ar[8]=-r[2],Fe(i,le(i,Ar))});or.setAxes=Yr;var Qt={};function xr(i){return xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xr(i)}Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.create=function(){var i=new Dr.ARRAY_TYPE(8);return Dr.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[4]=0,i[5]=0,i[6]=0,i[7]=0),i[3]=1,i},Qt.clone=function(i){var r=new Dr.ARRAY_TYPE(8);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r},Qt.fromValues=function(i,r,s,c,h,p,m,x){var b=new Dr.ARRAY_TYPE(8);return b[0]=i,b[1]=r,b[2]=s,b[3]=c,b[4]=h,b[5]=p,b[6]=m,b[7]=x,b},Qt.fromRotationTranslationValues=function(i,r,s,c,h,p,m){var x=new Dr.ARRAY_TYPE(8);x[0]=i,x[1]=r,x[2]=s,x[3]=c;var b=.5*h,S=.5*p,I=.5*m;return x[4]=b*c+S*s-I*r,x[5]=S*c+I*i-b*s,x[6]=I*c+b*r-S*i,x[7]=-b*i-S*r-I*s,x},Qt.fromRotationTranslation=yo,Qt.fromTranslation=function(i,r){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=.5*r[0],i[5]=.5*r[1],i[6]=.5*r[2],i[7]=0,i},Qt.fromRotation=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},Qt.fromMat4=function(i,r){var s=zr.create();Jr.getRotation(s,r);var c=new Dr.ARRAY_TYPE(3);return Jr.getTranslation(c,r),yo(i,s,c),i},Qt.copy=Uo,Qt.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},Qt.set=function(i,r,s,c,h,p,m,x,b){return i[0]=r,i[1]=s,i[2]=c,i[3]=h,i[4]=p,i[5]=m,i[6]=x,i[7]=b,i},Qt.getDual=function(i,r){return i[0]=r[4],i[1]=r[5],i[2]=r[6],i[3]=r[7],i},Qt.setDual=function(i,r){return i[4]=r[0],i[5]=r[1],i[6]=r[2],i[7]=r[3],i},Qt.getTranslation=function(i,r){var s=r[4],c=r[5],h=r[6],p=r[7],m=-r[0],x=-r[1],b=-r[2],S=r[3];return i[0]=2*(s*S+p*m+c*b-h*x),i[1]=2*(c*S+p*x+h*m-s*b),i[2]=2*(h*S+p*b+s*x-c*m),i},Qt.translate=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=.5*s[0],b=.5*s[1],S=.5*s[2],I=r[4],P=r[5],D=r[6],F=r[7];return i[0]=c,i[1]=h,i[2]=p,i[3]=m,i[4]=m*x+h*S-p*b+I,i[5]=m*b+p*x-c*S+P,i[6]=m*S+c*b-h*x+D,i[7]=-c*x-h*b-p*S+F,i},Qt.rotateX=function(i,r,s){var c=-r[0],h=-r[1],p=-r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=x*m+I*c+b*p-S*h,D=b*m+I*h+S*c-x*p,F=S*m+I*p+x*h-b*c,U=I*m-x*c-b*h-S*p;return zr.rotateX(i,r,s),i[4]=P*(m=i[3])+U*(c=i[0])+D*(p=i[2])-F*(h=i[1]),i[5]=D*m+U*h+F*c-P*p,i[6]=F*m+U*p+P*h-D*c,i[7]=U*m-P*c-D*h-F*p,i},Qt.rotateY=function(i,r,s){var c=-r[0],h=-r[1],p=-r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=x*m+I*c+b*p-S*h,D=b*m+I*h+S*c-x*p,F=S*m+I*p+x*h-b*c,U=I*m-x*c-b*h-S*p;return zr.rotateY(i,r,s),i[4]=P*(m=i[3])+U*(c=i[0])+D*(p=i[2])-F*(h=i[1]),i[5]=D*m+U*h+F*c-P*p,i[6]=F*m+U*p+P*h-D*c,i[7]=U*m-P*c-D*h-F*p,i},Qt.rotateZ=function(i,r,s){var c=-r[0],h=-r[1],p=-r[2],m=r[3],x=r[4],b=r[5],S=r[6],I=r[7],P=x*m+I*c+b*p-S*h,D=b*m+I*h+S*c-x*p,F=S*m+I*p+x*h-b*c,U=I*m-x*c-b*h-S*p;return zr.rotateZ(i,r,s),i[4]=P*(m=i[3])+U*(c=i[0])+D*(p=i[2])-F*(h=i[1]),i[5]=D*m+U*h+F*c-P*p,i[6]=F*m+U*p+P*h-D*c,i[7]=U*m-P*c-D*h-F*p,i},Qt.rotateByQuatAppend=function(i,r,s){var c=s[0],h=s[1],p=s[2],m=s[3],x=r[0],b=r[1],S=r[2],I=r[3];return i[0]=x*m+I*c+b*p-S*h,i[1]=b*m+I*h+S*c-x*p,i[2]=S*m+I*p+x*h-b*c,i[3]=I*m-x*c-b*h-S*p,i[4]=(x=r[4])*m+(I=r[7])*c+(b=r[5])*p-(S=r[6])*h,i[5]=b*m+I*h+S*c-x*p,i[6]=S*m+I*p+x*h-b*c,i[7]=I*m-x*c-b*h-S*p,i},Qt.rotateByQuatPrepend=function(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=s[0],b=s[1],S=s[2],I=s[3];return i[0]=c*I+m*x+h*S-p*b,i[1]=h*I+m*b+p*x-c*S,i[2]=p*I+m*S+c*b-h*x,i[3]=m*I-c*x-h*b-p*S,i[4]=c*(I=s[7])+m*(x=s[4])+h*(S=s[6])-p*(b=s[5]),i[5]=h*I+m*b+p*x-c*S,i[6]=p*I+m*S+c*b-h*x,i[7]=m*I-c*x-h*b-p*S,i},Qt.rotateAroundAxis=function(i,r,s,c){if(Math.abs(c)<Dr.EPSILON)return Uo(i,r);var h=Math.hypot(s[0],s[1],s[2]);c*=.5;var p=Math.sin(c),m=p*s[0]/h,x=p*s[1]/h,b=p*s[2]/h,S=Math.cos(c),I=r[0],P=r[1],D=r[2],F=r[3];i[0]=I*S+F*m+P*b-D*x,i[1]=P*S+F*x+D*m-I*b,i[2]=D*S+F*b+I*x-P*m,i[3]=F*S-I*m-P*x-D*b;var U=r[4],V=r[5],W=r[6],ee=r[7];return i[4]=U*S+ee*m+V*b-W*x,i[5]=V*S+ee*x+W*m-U*b,i[6]=W*S+ee*b+U*x-V*m,i[7]=ee*S-U*m-V*x-W*b,i},Qt.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i},Qt.multiply=vu,Qt.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i},Qt.lerp=function(i,r,s,c){var h=1-c;return $_(r,s)<0&&(c=-c),i[0]=r[0]*h+s[0]*c,i[1]=r[1]*h+s[1]*c,i[2]=r[2]*h+s[2]*c,i[3]=r[3]*h+s[3]*c,i[4]=r[4]*h+s[4]*c,i[5]=r[5]*h+s[5]*c,i[6]=r[6]*h+s[6]*c,i[7]=r[7]*h+s[7]*c,i},Qt.invert=function(i,r){var s=xf(r);return i[0]=-r[0]/s,i[1]=-r[1]/s,i[2]=-r[2]/s,i[3]=r[3]/s,i[4]=-r[4]/s,i[5]=-r[5]/s,i[6]=-r[6]/s,i[7]=r[7]/s,i},Qt.conjugate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=r[3],i[4]=-r[4],i[5]=-r[5],i[6]=-r[6],i[7]=r[7],i},Qt.normalize=function(i,r){var s=xf(r);if(s>0){s=Math.sqrt(s);var c=r[0]/s,h=r[1]/s,p=r[2]/s,m=r[3]/s,x=r[4],b=r[5],S=r[6],I=r[7],P=c*x+h*b+p*S+m*I;i[0]=c,i[1]=h,i[2]=p,i[3]=m,i[4]=(x-c*P)/s,i[5]=(b-h*P)/s,i[6]=(S-p*P)/s,i[7]=(I-m*P)/s}return i},Qt.str=function(i){return"quat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+")"},Qt.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]},Qt.equals=function(i,r){var s=i[0],c=i[1],h=i[2],p=i[3],m=i[4],x=i[5],b=i[6],S=i[7],I=r[0],P=r[1],D=r[2],F=r[3],U=r[4],V=r[5],W=r[6],ee=r[7];return Math.abs(s-I)<=Dr.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(c-P)<=Dr.EPSILON*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(h-D)<=Dr.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(p-F)<=Dr.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(m-U)<=Dr.EPSILON*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(x-V)<=Dr.EPSILON*Math.max(1,Math.abs(x),Math.abs(V))&&Math.abs(b-W)<=Dr.EPSILON*Math.max(1,Math.abs(b),Math.abs(W))&&Math.abs(S-ee)<=Dr.EPSILON*Math.max(1,Math.abs(S),Math.abs(ee))},Qt.sqrLen=Qt.squaredLength=Qt.len=Qt.length=Qt.dot=Qt.mul=Qt.setReal=Qt.getReal=void 0;var Dr=Si(J),zr=Si(or),Jr=Si(Zt);function An(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(An=function(c){return c?s:r})(i)}function Si(i,r){if(i&&i.__esModule)return i;if(i===null||xr(i)!=="object"&&typeof i!="function")return{default:i};var s=An(r);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}function yo(i,r,s){var c=.5*s[0],h=.5*s[1],p=.5*s[2],m=r[0],x=r[1],b=r[2],S=r[3];return i[0]=m,i[1]=x,i[2]=b,i[3]=S,i[4]=c*S+h*b-p*x,i[5]=h*S+p*m-c*b,i[6]=p*S+c*x-h*m,i[7]=-c*m-h*x-p*b,i}function Uo(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i}function vu(i,r,s){var c=r[0],h=r[1],p=r[2],m=r[3],x=s[4],b=s[5],S=s[6],I=s[7],P=r[4],D=r[5],F=r[6],U=r[7],V=s[0],W=s[1],ee=s[2],ce=s[3];return i[0]=c*ce+m*V+h*ee-p*W,i[1]=h*ce+m*W+p*V-c*ee,i[2]=p*ce+m*ee+c*W-h*V,i[3]=m*ce-c*V-h*W-p*ee,i[4]=c*I+m*x+h*S-p*b+P*ce+U*V+D*ee-F*W,i[5]=h*I+m*b+p*x-c*S+D*ce+U*W+F*V-P*ee,i[6]=p*I+m*S+c*b-h*x+F*ce+U*ee+P*W-D*V,i[7]=m*I-c*x-h*b-p*S+U*ce-P*V-D*W-F*ee,i}Qt.getReal=zr.copy,Qt.setReal=zr.copy,Qt.mul=vu;var $_=zr.dot;Qt.dot=$_;var rb=zr.length;Qt.length=rb,Qt.len=rb;var xf=zr.squaredLength;Qt.squaredLength=xf,Qt.sqrLen=xf;var Gr={};function j_(i){return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},j_(i)}Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.create=H_,Gr.clone=function(i){var r=new Ic.ARRAY_TYPE(2);return r[0]=i[0],r[1]=i[1],r},Gr.fromValues=function(i,r){var s=new Ic.ARRAY_TYPE(2);return s[0]=i,s[1]=r,s},Gr.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i},Gr.set=function(i,r,s){return i[0]=r,i[1]=s,i},Gr.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i},Gr.subtract=G_,Gr.multiply=W_,Gr.divide=q_,Gr.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i},Gr.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i},Gr.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i},Gr.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i},Gr.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i},Gr.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i},Gr.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i},Gr.distance=K_,Gr.squaredDistance=Y_,Gr.length=Z_,Gr.squaredLength=X_,Gr.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i},Gr.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i},Gr.normalize=function(i,r){var s=r[0],c=r[1],h=s*s+c*c;return h>0&&(h=1/Math.sqrt(h)),i[0]=r[0]*h,i[1]=r[1]*h,i},Gr.dot=function(i,r){return i[0]*r[0]+i[1]*r[1]},Gr.cross=function(i,r,s){var c=r[0]*s[1]-r[1]*s[0];return i[0]=i[1]=0,i[2]=c,i},Gr.lerp=function(i,r,s,c){var h=r[0],p=r[1];return i[0]=h+c*(s[0]-h),i[1]=p+c*(s[1]-p),i},Gr.random=function(i,r){r=r||1;var s=2*Ic.RANDOM()*Math.PI;return i[0]=Math.cos(s)*r,i[1]=Math.sin(s)*r,i},Gr.transformMat2=function(i,r,s){var c=r[0],h=r[1];return i[0]=s[0]*c+s[2]*h,i[1]=s[1]*c+s[3]*h,i},Gr.transformMat2d=function(i,r,s){var c=r[0],h=r[1];return i[0]=s[0]*c+s[2]*h+s[4],i[1]=s[1]*c+s[3]*h+s[5],i},Gr.transformMat3=function(i,r,s){var c=r[0],h=r[1];return i[0]=s[0]*c+s[3]*h+s[6],i[1]=s[1]*c+s[4]*h+s[7],i},Gr.transformMat4=function(i,r,s){var c=r[0],h=r[1];return i[0]=s[0]*c+s[4]*h+s[12],i[1]=s[1]*c+s[5]*h+s[13],i},Gr.rotate=function(i,r,s,c){var h=r[0]-s[0],p=r[1]-s[1],m=Math.sin(c),x=Math.cos(c);return i[0]=h*x-p*m+s[0],i[1]=h*m+p*x+s[1],i},Gr.angle=function(i,r){var s=i[0],c=i[1],h=r[0],p=r[1],m=Math.sqrt(s*s+c*c)*Math.sqrt(h*h+p*p);return Math.acos(Math.min(Math.max(m&&(s*h+c*p)/m,-1),1))},Gr.zero=function(i){return i[0]=0,i[1]=0,i},Gr.str=function(i){return"vec2("+i[0]+", "+i[1]+")"},Gr.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]},Gr.equals=function(i,r){var s=i[0],c=i[1],h=r[0],p=r[1];return Math.abs(s-h)<=Ic.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(c-p)<=Ic.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))},Gr.forEach=Gr.sqrLen=Gr.sqrDist=Gr.dist=Gr.div=Gr.mul=Gr.sub=Gr.len=void 0;var Ic=function(i,r){if(i&&i.__esModule)return i;if(i===null||j_(i)!=="object"&&typeof i!="function")return{default:i};var s=V_(void 0);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}(J);function V_(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(V_=function(c){return c?s:r})(i)}function H_(){var i=new Ic.ARRAY_TYPE(2);return Ic.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0),i}function G_(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i}function W_(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i}function q_(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i}function K_(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1])}function Y_(i,r){var s=r[0]-i[0],c=r[1]-i[1];return s*s+c*c}function Z_(i){return Math.hypot(i[0],i[1])}function X_(i){var r=i[0],s=i[1];return r*r+s*s}Gr.len=Z_,Gr.sub=G_,Gr.mul=W_,Gr.div=q_,Gr.dist=K_,Gr.sqrDist=Y_,Gr.sqrLen=X_;var nb=function(){var i=H_();return function(r,s,c,h,p,m){var x,b;for(s||(s=2),c||(c=0),b=h?Math.min(h*s+c,r.length):r.length,x=c;x<b;x+=s)i[0]=r[x],i[1]=r[x+1],p(i,i,m),r[x]=i[0],r[x+1]=i[1];return r}}();function Th(i){return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Th(i)}Gr.forEach=nb,Object.defineProperty(te,"__esModule",{value:!0}),a.aA=te.vec4=a._=te.vec3=te.vec2=te.quat2=a.av=te.quat=a.ad=te.mat4=a.bC=te.mat3=te.mat2d=a.aC=te.mat2=te.glMatrix=void 0;var Am=ol(J);te.glMatrix=Am;var Im=ol(Ae);a.aC=te.mat2=Im;var ib=ol(et);te.mat2d=ib;var ob=ol(it);a.bC=te.mat3=ob;var sb=ol(Zt);a.ad=te.mat4=sb;var Ah=ol(or);a.av=te.quat=Ah;var on=ol(Qt);te.quat2=on;var eI=ol(Gr);te.vec2=eI;var tI=ol(Yt);a._=te.vec3=tI;var rI=ol(cr);function Q_(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Q_=function(c){return c?s:r})(i)}function ol(i,r){if(i&&i.__esModule)return i;if(i===null||Th(i)!=="object"&&typeof i!="function")return{default:i};var s=Q_(r);if(s&&s.has(i))return s.get(i);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in i)if(p!=="default"&&Object.prototype.hasOwnProperty.call(i,p)){var m=h?Object.getOwnPropertyDescriptor(i,p):null;m&&(m.get||m.set)?Object.defineProperty(c,p,m):c[p]=i[p]}return c.default=i,s&&s.set(i,c),c}a.aA=te.vec4=rI;var J_=bf;function bf(i,r,s,c){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=s,this.p2y=c}bf.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,c=0;c<8;c++){var h=this.sampleCurveX(s)-i;if(Math.abs(h)<r)return s;var p=this.sampleCurveDerivativeX(s);if(Math.abs(p)<1e-6)break;s-=h/p}var m=0,x=1;for(s=i,c=0;c<20&&(h=this.sampleCurveX(s),!(Math.abs(h-i)<r));c++)i>h?m=s:x=s,s=.5*(x-m)+m;return s},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var wf=Y(J_),Mm=xu;function xu(i,r){this.x=i,this.y=r}xu.prototype={clone:function(){return new xu(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,r){return this.clone()._rotateAround(i,r)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var r=i.x-this.x,s=i.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,r){return Math.atan2(this.x*r-this.y*i,this.x*i+this.y*r)},_matMult:function(i){var r=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=r,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var r=Math.cos(i),s=Math.sin(i),c=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=c,this},_rotateAround:function(i,r){var s=Math.cos(i),c=Math.sin(i),h=r.y+c*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-c*(this.y-r.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},xu.convert=function(i){return i instanceof xu?i:Array.isArray(i)?new xu(i[0],i[1]):i};var Ut=Y(Mm);const ab=Math.PI/180,Cf=180/Math.PI;function an(i){return i*ab}function $o(i){return i*Cf}const lb=[[0,0],[1,0],[1,1],[0,1]];function ey(i){if(i<=0)return 0;if(i>=1)return 1;const r=i*i,s=r*i;return 4*(i<.5?s:3*(i-r)+s-.75)}function Ef(i,r,s,c){const h=new wf(i,r,s,c);return function(p){return h.solve(p)}}const Ih=Ef(.25,.1,.25,1);function Kr(i,r,s){return Math.min(s,Math.max(r,i))}function bu(i,r,s){return(s=Kr((s-i)/(r-i),0,1))*s*(3-2*s)}function wu(i,r,s){const c=s-r,h=((i-r)%c+c)%c+r;return h===r?s:h}function Mh(i,r,s){if(!i.length)return s(null,[]);let c=i.length;const h=new Array(i.length);let p=null;i.forEach((m,x)=>{r(m,(b,S)=>{b&&(p=b),h[x]=S,--c==0&&s(p,h)})})}function oa(i){const r=[];for(const s in i)r.push(i[s]);return r}function jo(i,...r){for(const s of r)for(const c in s)i[c]=s[c];return i}let nI=1;function Pm(){return nI++}function Rm(){return function i(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function ty(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function ry(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function km(i,r){i.forEach(s=>{r[s]&&(r[s]=r[s].bind(r))})}function Sf(i,r){return i.indexOf(r,i.length-r.length)!==-1}function Ph(i,r,s){const c={};for(const h in i)c[h]=r.call(this,i[h],h,i);return c}function Cu(i,r,s){const c={};for(const h in i)r.call(this,i[h],h,i)&&(c[h]=i[h]);return c}function sl(i){return Array.isArray(i)?i.map(sl):typeof i=="object"&&i?Ph(i,sl):i}const ny={};function Pi(i){ny[i]||(typeof console<"u"&&console.warn(i),ny[i]=!0)}function al(i,r,s){return(s.y-i.y)*(r.x-i.x)>(r.y-i.y)*(s.x-i.x)}function Xo(i){let r=0;for(let s,c,h=0,p=i.length,m=p-1;h<p;m=h++)s=i[h],c=i[m],r+=(c.x-s.x)*(s.y+c.y);return r}function jl([i,r,s]){const c=an(r+90),h=an(s);return{x:i*Math.cos(c)*Math.sin(h),y:i*Math.sin(c)*Math.sin(h),z:i*Math.cos(h),azimuthal:r,polar:s}}function Ao(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function iy(i){const r={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,h,p)=>{const m=h||p;return r[c]=!m||m.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}let oy,Dm,Rh,Tf,Vl,Af,Om=null;function Eu(i){try{const r=self[i];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function If(i,r){return[i[4*r],i[4*r+1],i[4*r+2],i[4*r+3]]}function sy(i,r,s,c){for(;r<s;){const h=r+s>>1;i[h]<c?r=h+1:s=h}return r}function cb(i,r,s,c){for(;r<s;){const h=r+s>>1;i[h]<=c?r=h+1:s=h}return r}function Lm(i){return i>0?1/(1.001-i):1+i}function Bm(i){return i>0?1-1/(1.001-i):-i}function kh(){return oy==null&&(oy=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),oy}const Io={now:()=>Tf!==void 0?Tf:performance.now(),setNow(i){Tf=i},restoreNow(){Tf=void 0},frame(i){const r=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(i,r=0){const{width:s,height:c}=i;Vl||(Vl=document.createElement("canvas"));const h=Vl.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(s>Vl.width||c>Vl.height)&&(Vl.width=s,Vl.height=c),h.clearRect(-r,-r,s+2*r,c+2*r),h.drawImage(i,0,0,s,c),h.getImageData(-r,-r,s+2*r,c+2*r)},resolveURL:i=>(Dm||(Dm=document.createElement("a")),Dm.href=i,Dm.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Rh==null&&(Rh=window.matchMedia("(prefers-reduced-motion: reduce)")),Rh.matches)},hasCanvasFingerprintNoise(){if(Af!==void 0)return Af;if(!kh())return Af=!1,!1;const i=new OffscreenCanvas(85,1),r=i.getContext("2d",{willReadFrequently:!0});let s=0;for(let h=0;h<i.width;++h)r.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,r.fillRect(h,0,1,1);const c=r.getImageData(0,0,i.width,i.height);s=0;for(let h=0;h<c.data.length;++h)if(h%4!=3&&s++!==c.data[h])return Af=!0,!0;return Af=!1,!1}};function Fm(i,r){const s=i.indexOf("?");if(s<0)return`${i}?${new URLSearchParams(r).toString()}`;const c=new URLSearchParams(i.slice(s));for(const h in r)c.set(h,r[h]);return`${i.slice(0,s)}?${c.toString()}`}function ay(i,r={persistentParams:[]}){const s=i.indexOf("?");if(s<0)return i;const c=new URLSearchParams,h=new URLSearchParams(i.slice(s));for(const m of r.persistentParams){const x=h.get(m);x&&c.set(m,x)}const p=c.toString();return`${i.slice(0,s)}${p.length>0?`?${p}`:""}`}const ub="mapbox-tiles";let ly=500,cy=50,Hl,zm;function hb(){try{return caches}catch{}}function Mf(){const i=hb();i&&!Hl&&(Hl=i.open(ub))}let Nm=1/0;const Um={supported:!1,testSupport:function(i){!uy&&Oh&&(hy?db(i):Dh=i)}};let Dh,Oh,uy=!1,hy=!1;const dy=typeof self<"u"?self:{};function db(i){const r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Oh),i.isContextLost())return;Um.supported=!0}catch{}i.deleteTexture(r),uy=!0}dy.document&&(Oh=dy.document.createElement("img"),Oh.onload=function(){Dh&&db(Dh),Dh=null,hy=!0},Oh.onerror=function(){uy=!0,Dh=null},Oh.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const $m={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze($m);class fy extends Error{constructor(r,s,c){s===401&&O(c)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const jm=Ao()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Pf=function(i,r){if(!(/^file:/.test(s=i.url)||/^file:/.test(jm())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,h){const p=new AbortController,m=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:jm(),referrerPolicy:c.referrerPolicy,signal:p.signal});let x=!1,b=!1;const S=(I=m.url).indexOf("sku=")>0&&O(I);var I;c.type==="json"&&m.headers.set("Accept","application/json");const P=(F,U,V)=>{if(b)return;if(F&&F.message!=="SecurityError"&&Pi(F.toString()),U&&V)return D(U);const W=Date.now();fetch(m).then(ee=>{if(ee.ok){const ce=S?ee.clone():null;return D(ee,ce,W)}return h(new fy(ee.statusText,ee.status,c.url))}).catch(ee=>{ee.name!=="AbortError"&&h(new Error(`${ee.message} ${c.url}`))})},D=(F,U,V)=>{(c.type==="arrayBuffer"?F.arrayBuffer():c.type==="json"?F.json():F.text()).then(W=>{b||(U&&V&&function(ee,ce,ue){if(Mf(),!Hl)return;const he=iy(ce.headers.get("Cache-Control")||"");if(he["no-store"])return;const Se={status:ce.status,statusText:ce.statusText,headers:new Headers};ce.headers.forEach((Le,je)=>Se.headers.set(je,Le)),he["max-age"]&&Se.headers.set("Expires",new Date(ue+1e3*he["max-age"]).toUTCString());const be=Se.headers.get("Expires");if(!be||new Date(be).getTime()-ue<42e4)return;let ke=ay(ee.url,{persistentParams:["language","worldview"]});if(ce.status===206){const Le=ee.headers.get("Range");if(!Le)return;Se.status=200,ke=Fm(ke,{range:Le})}(function(Le,je){if(zm===void 0)try{new Response(new ReadableStream),zm=!0}catch{zm=!1}zm?je(Le.body):Le.blob().then(je)})(ce,Le=>{const je=new Response((ot=ce.status)!==200&&ot!==404&&[101,103,204,205,304].includes(ot)?null:Le,Se);var ot;Mf(),Hl&&Hl.then(Ze=>Ze.put(ke,je)).catch(Ze=>Pi(Ze.message))})}(m,U,V),x=!0,h(null,W,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(W=>{b||h(new Error(W.message))})};return S?function(F,U){if(Mf(),!Hl)return U(null);Hl.then(V=>{let W=ay(F.url,{persistentParams:["language","worldview"]});const ee=F.headers.get("Range");ee&&(W=Fm(W,{range:ee})),V.match(W).then(ce=>{const ue=function(he){if(!he)return!1;const Se=new Date(he.headers.get("Expires")||0),be=iy(he.headers.get("Cache-Control")||"");return Se>Date.now()&&!be["no-cache"]}(ce);V.delete(W),ue&&V.put(W,ce.clone()),U(null,ce,ue)}).catch(U)}).catch(U)}(m,P):P(null,null),{cancel:()=>{b=!0,x||p.abort()}}}(i,r);if(Ao()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,r,void 0,!0)}var s;return function(c,h){const p=new XMLHttpRequest;p.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const m in c.headers)p.setRequestHeader(m,c.headers[m]);return c.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=c.credentials==="include",p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let m=p.response;if(c.type==="json")try{m=JSON.parse(p.response)}catch(x){return h(x)}h(null,m,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new fy(p.statusText,p.status,c.url))},p.send(c.body),{cancel:()=>p.abort()}}(i,r)},Su=function(i,r){return Pf(jo(i,{type:"arrayBuffer"}),r)};function fb(i){const r=document.createElement("a");return r.href=i,r.protocol===location.protocol&&r.host===location.host}const py="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Rf,kf;Rf=[],kf=0;const Mc=function(i,r){if(Um.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),kf>=k.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:i,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Rf.push(p),p}kf++;let s=!1;const c=()=>{if(!s)for(s=!0,kf--;Rf.length&&kf<k.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Rf.shift(),{requestParameters:m,callback:x,cancelled:b}=p;b||(p.cancel=Mc(m,x).cancel)}},h=Su(i,(p,m,x,b)=>{c(),p?r(p):m&&(self.createImageBitmap?function(S,I){const P=new Blob([new Uint8Array(S)],{type:"image/png"});createImageBitmap(P).then(D=>{I(null,D)}).catch(D=>{I(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(S,I)=>r(S,I,x,b)):function(S,I){const P=new Image;P.onload=()=>{I(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=py})},P.onerror=()=>I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(S)],{type:"image/png"});P.src=S.byteLength?URL.createObjectURL(D):py}(m,(S,I)=>r(S,I,x,b)))});return{cancel:()=>{h.cancel(),c()}}},my="01",gy="NO_ACCESS_TOKEN",iI=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ta(i){const r=i.match(iI);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Lh(i){const r=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${r}`}const Vm="mapbox.eventData";function pb(i){if(!i)return null;const r=i.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(r[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Df{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const s=pb(k.ACCESS_TOKEN);let c="";return c=s&&s.u?btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(+("0x"+p)))):k.ACCESS_TOKEN||"",r?`${Vm}.${r}:${c}`:`${Vm}:${c}`}fetchEventData(){const r=Eu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{const h=localStorage.getItem(s);h&&(this.eventData=JSON.parse(h));const p=localStorage.getItem(c);p&&(this.anonId=p)}catch{Pi("Unable to read from LocalStorage")}}saveEventData(){const r=Eu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid"),h=this.anonId;if(r&&h)try{localStorage.setItem(c,h),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Pi("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,s,c,h){if(!k.EVENTS_URL)return;const p=Ta(k.EVENTS_URL);p.params.push(`access_token=${h||k.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(r).toISOString()},x=s?jo(m,s):m,b={url:Lh(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};this.pendingRequest=function(S,I){return Pf(jo(S,{method:"POST"}),I)}(b,S=>{this.pendingRequest=null,c(S),this.saveEventData(),this.processRequests(h)})}queueRequest(r,s){this.queue.push(r),this.processRequests(s)}}const mb=new class extends Df{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,r){k.EVENTS_URL&&k.ACCESS_TOKEN&&Array.isArray(i)&&i.some(s=>R(s)||O(s))&&this.queueRequest(Date.now(),r)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=pb(k.ACCESS_TOKEN),s=r?r.u:k.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;ry(this.anonId)||(this.anonId=Rm(),c=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),m=new Date(h),x=(h-this.eventData.lastSuccess)/864e5;c=c||x>=1||x<-1||p.getDate()!==m.getDate()}else c=!0;c?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:my,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=s)},i):this.processRequests()}},_y=mb.postTurnstileEvent.bind(mb),Of=new class extends Df{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,r,s,c){this.skuToken=r,this.errorCb=c,k.EVENTS_URL&&(s||k.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(gy)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),ry(this.anonId)||(this.anonId=Rm()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:my,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},i))}remove(){this.errorCb=null}},gb=Of.postMapLoadEvent.bind(Of),_b=new class extends Df{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(i){let r=this.mapInstanceIdMap.get(i);return r||(r=Rm(),this.mapInstanceIdMap.set(i,r)),r}getEventId(i){const r=this.eventIdPerMapInstanceMap.get(i)||0;return this.eventIdPerMapInstanceMap.set(i,r+1),r}postStyleLoadEvent(i,r){const{map:s,style:c,importedStyles:h}=r;if(!k.EVENTS_URL||!i&&!k.ACCESS_TOKEN)return;const p=this.getMapInstanceId(s),m={mapInstanceId:p,eventId:this.getEventId(p),style:c};h.length&&(m.importedStyles=h),this.queueRequest({timestamp:Date.now(),payload:m},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:s}=this.queue.shift();this.postEvent(r,s,()=>{},i)}},oI=_b.postStyleLoadEvent.bind(_b),Hm=new class extends Df{constructor(){super("gljs.performance")}postPerformanceEvent(i,r){k.EVENTS_URL&&(i||k.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:s}=this.queue.shift(),c=function(h){const p=performance.getEntriesByType("resource"),m=performance.getEntriesByType("mark"),x=function(F){const U={};if(F){for(const V in F)if(V!=="other")for(const W of F[V]){const ee=`${V}ResolveRangeMin`,ce=`${V}ResolveRangeMax`,ue=`${V}RequestCount`,he=`${V}RequestCachedCount`;U[ee]=Math.min(U[ee]||1/0,W.startTime),U[ce]=Math.max(U[ce]||-1/0,W.responseEnd);const Se=be=>{U[be]===void 0&&(U[be]=0),++U[be]};W.transferSize!==void 0&&W.transferSize===0&&Se(he),Se(ue)}}return U}(function(F,U){const V={};if(F)for(const W of F){const ee=U(W);V[ee]===void 0&&(V[ee]=[]),V[ee].push(W)}return V}(p,H)),b=window.devicePixelRatio,S=navigator.connection||navigator.mozConnection||navigator.webkitConnection,I=S?S.effectiveType:void 0,P={counters:[],metadata:[],attributes:[]},D=(F,U,V)=>{V!=null&&F.push({name:U,value:V.toString()})};for(const F in x)D(P.counters,F,x[F]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(D(P.counters,"interactionRangeMin",h.interactionRange[0]),D(P.counters,"interactionRangeMax",h.interactionRange[1])),m)for(const F of Object.keys(q)){const U=q[F],V=m.find(W=>W.name===U);V&&D(P.counters,U,V.startTime)}return D(P.counters,"visibilityHidden",h.visibilityHidden),D(P.attributes,"style",function(F){if(F)for(const U of F){const V=U.name.split("?")[0];if(K(V)){const W=V.split("/").slice(-2);if(W.length===2)return`mapbox://styles/${W[0]}/${W[1]}`}}}(p)),D(P.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),D(P.attributes,"fogEnabled",h.fogEnabled?"true":"false"),D(P.attributes,"projection",h.projection),D(P.attributes,"zoom",h.zoom),D(P.metadata,"devicePixelRatio",b),D(P.metadata,"connectionEffectiveType",I),D(P.metadata,"navigatorUserAgent",navigator.userAgent),D(P.metadata,"screenWidth",window.screen.width),D(P.metadata,"screenHeight",window.screen.height),D(P.metadata,"windowWidth",window.innerWidth),D(P.metadata,"windowHeight",window.innerHeight),D(P.metadata,"mapWidth",h.width/b),D(P.metadata,"mapHeight",h.height/b),D(P.metadata,"webglRenderer",h.renderer),D(P.metadata,"webglVendor",h.vendor),D(P.metadata,"sdkVersion",C),D(P.metadata,"sdkIdentifier","mapbox-gl-js"),P}(s);for(const h of c.metadata);for(const h of c.counters);for(const h of c.attributes);this.postEvent(r,c,()=>{},i)}},sI=Hm.postPerformanceEvent.bind(Hm),Bh=new class extends Df{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,r,s,c){if(!k.API_URL||!k.SESSION_PATH)return;const h=Ta(k.API_URL+k.SESSION_PATH);h.params.push(`sku=${r||""}`),h.params.push(`access_token=${c||k.ACCESS_TOKEN||""}`);const p={url:Lh(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(m,x){return Pf(jo(m,{method:"GET"}),x)}(p,m=>{this.pendingRequest=null,s(m),this.saveEventData(),this.processRequests(c)})}getSessionAPI(i,r,s,c){this.skuToken=r,this.errorCb=c,k.SESSION_PATH&&k.API_URL&&(s||k.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(gy)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},i)}remove(){this.errorCb=null}},Gm=Bh.getSessionAPI.bind(Bh),Lf=new Set;var Tu={exports:{}},yb={exports:function(i,r){var s,c,h,p,m,x,b,S;for(c=i.length-(s=3&i.length),h=r,m=3432918353,x=461845907,S=0;S<c;)b=255&i.charCodeAt(S)|(255&i.charCodeAt(++S))<<8|(255&i.charCodeAt(++S))<<16|(255&i.charCodeAt(++S))<<24,++S,h=27492+(65535&(p=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*m+(((b>>>16)*m&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&i.charCodeAt(S+2))<<16;case 2:b^=(255&i.charCodeAt(S+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&i.charCodeAt(S)))*m+(((b>>>16)*m&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}},aI={exports:function(i,r){for(var s,c=i.length,h=r^c,p=0;c>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(p)|(255&i.charCodeAt(++p))<<8|(255&i.charCodeAt(++p))<<16|(255&i.charCodeAt(++p))<<24))+((1540483477*(s>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++p;switch(c){case 3:h^=(255&i.charCodeAt(p+2))<<16;case 2:h^=(255&i.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}},vb=yb.exports,yy=aI.exports;Tu.exports=vb,Tu.exports.murmur3=vb,Tu.exports.murmur2=yy;var Fh=Y(Tu.exports);function vy(i,r,s){s[i]&&s[i].indexOf(r)!==-1||(s[i]=s[i]||[],s[i].push(r))}function zh(i,r,s){if(s&&s[i]){const c=s[i].indexOf(r);c!==-1&&s[i].splice(c,1)}}class ps{constructor(r,s={}){jo(this,s),this.type=r}}class Wm extends ps{constructor(r,s={}){super("error",jo({error:r},s))}}class Au{on(r,s){return this._listeners=this._listeners||{},vy(r,s,this._listeners),this}off(r,s){return zh(r,s,this._listeners),zh(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},vy(r,s,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,s){typeof r=="string"&&(r=new ps(r,s||{}));const c=r.type;if(this.listens(c)){r.target=this;const h=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const x of h)x.call(this,r);const p=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const x of p)zh(c,x,this._oneTimeListeners),x.call(this,r);const m=this._eventedParent;m&&(jo(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(r))}else r instanceof Wm&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}a.F=void 0;var xb={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function qm(i){return(i=Math.round(i))<0?0:i>255?255:i}function xy(i){return qm(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Bf(i){return(r=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:r>1?1:r;var r}function Ff(i,r,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?i+(r-i)*s*6:2*s<1?r:3*s<2?i+(r-i)*(2/3-s)*6:i}try{a.F={}.parseCSSColor=function(i){var r,s=i.replace(/ /g,"").toLowerCase();if(s in xb)return xb[s].slice();if(s[0]==="#")return s.length===4?(r=parseInt(s.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:s.length===7&&(r=parseInt(s.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var c=s.indexOf("("),h=s.indexOf(")");if(c!==-1&&h+1===s.length){var p=s.substr(0,c),m=s.substr(c+1,h-(c+1)).split(","),x=1;switch(p){case"rgba":if(m.length!==4)return null;x=Bf(m.pop());case"rgb":return m.length!==3?null:[xy(m[0]),xy(m[1]),xy(m[2]),x];case"hsla":if(m.length!==4)return null;x=Bf(m.pop());case"hsl":if(m.length!==3)return null;var b=(parseFloat(m[0])%360+360)%360/360,S=Bf(m[1]),I=Bf(m[2]),P=I<=.5?I*(S+1):I+S-I*S,D=2*I-P;return[qm(255*Ff(D,P,b+1/3)),qm(255*Ff(D,P,b)),qm(255*Ff(D,P,b-1/3)),x];default:return null}}return null}}catch{}class yn{constructor(r,s,c,h=1){this.r=r,this.g=s,this.b=c,this.a=h}static parse(r){if(!r)return;if(r instanceof yn)return r;if(typeof r!="string")return;const s=a.F(r);return s?new yn(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[r,s,c,h]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(r)},${Math.round(s)},${Math.round(c)},${h})`}toRenderColor(r){const{r:s,g:c,b:h,a:p}=this;return new lI(r,s,c,h,p)}}class lI{constructor(r,s,c,h,p){if(r){const m=r.image.height,x=m*m;s=p===0?0:s/p*(m-1),c=p===0?0:c/p*(m-1),h=p===0?0:h/p*(m-1);const b=Math.floor(s),S=Math.floor(c),I=Math.floor(h),P=Math.ceil(s),D=Math.ceil(c),F=Math.ceil(h),U=s-b,V=c-S,W=h-I,ee=r.image.data,ce=4*(b+S*x+I*m),ue=4*(b+S*x+F*m),he=4*(b+D*x+I*m),Se=4*(b+D*x+F*m),be=4*(P+S*x+I*m),ke=4*(P+S*x+F*m),Le=4*(P+D*x+I*m),je=4*(P+D*x+F*m);if(ce<0||je>=ee.length)throw new Error("out of range");this.r=_r(_r(_r(ee[ce],ee[ue],W),_r(ee[he],ee[Se],W),V),_r(_r(ee[be],ee[ke],W),_r(ee[Le],ee[je],W),V),U)/255*p,this.g=_r(_r(_r(ee[ce+1],ee[ue+1],W),_r(ee[he+1],ee[Se+1],W),V),_r(_r(ee[be+1],ee[ke+1],W),_r(ee[Le+1],ee[je+1],W),V),U)/255*p,this.b=_r(_r(_r(ee[ce+2],ee[ue+2],W),_r(ee[he+2],ee[Se+2],W),V),_r(_r(ee[be+2],ee[ke+2],W),_r(ee[Le+2],ee[je+2],W),V),U)/255*p,this.a=p}else this.r=s,this.g=c,this.b=h,this.a=p}toArray(){const{r,g:s,b:c,a:h}=this;return h===0?[0,0,0,0]:[255*r/h,255*s/h,255*c/h,h]}toArray01(){const{r,g:s,b:c,a:h}=this;return h===0?[0,0,0,0]:[r/h,s/h,c/h,h]}toArray01Scaled(r){const{r:s,g:c,b:h,a:p}=this;return p===0?[0,0,0]:[s/p*r,c/p*r,h/p*r]}toArray01PremultipliedAlpha(){const{r,g:s,b:c,a:h}=this;return[r,s,c,h]}toArray01Linear(){const{r,g:s,b:c,a:h}=this;return h===0?[0,0,0,0]:[Math.pow(r/h,2.2),Math.pow(s/h,2.2),Math.pow(c/h,2.2),h]}}function _r(i,r,s){return i*(1-s)+r*s}function bb(i,r,s){return i.map((c,h)=>_r(c,r[h],s))}yn.black=new yn(0,0,0,1),yn.white=new yn(1,1,1,1),yn.transparent=new yn(0,0,0,0),yn.red=new yn(1,0,0,1),yn.blue=new yn(0,0,1,1);var Km=Object.freeze({__proto__:null,array:bb,color:function(i,r,s){return new yn(_r(i.r,r.r,s),_r(i.g,r.g,s),_r(i.b,r.b,s),_r(i.a,r.a,s))},number:_r});function by(i,...r){for(const s of r)for(const c in s)i[c]=s[c];return i}class ll extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class wy{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[c,h]of s)this.bindings[c]=h}concat(r){return new wy(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Nh={kind:"null"},Kt={kind:"number"},vn={kind:"string"},xn={kind:"boolean"},ms={kind:"color"},Uh={kind:"object"},mn={kind:"value"},Aa={kind:"collator"},$h={kind:"formatted"},cl={kind:"resolvedImage"};function Ps(i,r){return{kind:"array",itemType:i,N:r}}function Ri(i){if(i.kind==="array"){const r=Ri(i.itemType);return typeof i.N=="number"?`array<${r}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${r}>`}return i.kind}const cI=[Nh,Kt,vn,xn,ms,$h,Uh,Ps(mn),cl];function zf(i,r){if(r.kind==="error")return null;if(i.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!zf(i.itemType,r.itemType))&&(typeof i.N!="number"||i.N===r.N))return null}else{if(i.kind===r.kind)return null;if(i.kind==="value"){for(const s of cI)if(!zf(s,r))return null}}return`Expected ${Ri(i)} but found ${Ri(r)} instead.`}function Cy(i,r){return r.some(s=>s.kind===i.kind)}function jh(i,r){return r.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}class Nf{constructor(r,s,c){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Iu{constructor(r,s,c,h,p){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=c,this.fontStack=h,this.textColor=p}}class Vo{constructor(r){this.sections=r}static fromString(r){return new Vo([new Iu(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.namePrimary.length!==0)}static factory(r){return r instanceof Vo?r:Vo.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){r.push(["image",s.image.namePrimary]);continue}r.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),r.push(c)}return r}}class gs{constructor(r){this.namePrimary=r.namePrimary,r.nameSecondary&&(this.nameSecondary=r.nameSecondary),this.available=r.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(r,s){return r?new gs({namePrimary:r,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function wb(i,r,s,c){return typeof i=="number"&&i>=0&&i<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,r,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,r,s,c]:[i,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _s(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof yn||i instanceof Nf||i instanceof Vo||i instanceof gs)return!0;if(Array.isArray(i)){for(const r of i)if(!_s(r))return!1;return!0}if(typeof i=="object"){for(const r in i)if(!_s(i[r]))return!1;return!0}return!1}function ji(i){if(i===null)return Nh;if(typeof i=="string")return vn;if(typeof i=="boolean")return xn;if(typeof i=="number")return Kt;if(i instanceof yn)return ms;if(i instanceof Nf)return Aa;if(i instanceof Vo)return $h;if(i instanceof gs)return cl;if(Array.isArray(i)){const r=i.length;let s;for(const c of i){const h=ji(c);if(s){if(s===h)continue;s=mn;break}s=h}return Ps(s||mn,r)}return Uh}function sa(i){const r=typeof i;return i===null?"":r==="string"||r==="number"||r==="boolean"?String(i):i instanceof yn||i instanceof Vo||i instanceof gs?i.toString():JSON.stringify(i)}class Gl{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!_s(r[1]))return s.error("invalid value");const c=r[1];let h=ji(c);const p=s.expectedType;return h.kind!=="array"||h.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(h=p),new Gl(h,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof yn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Vo?this.value.serialize():this.value}}class lo{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Ey={string:vn,number:Kt,boolean:xn,object:Uh};class Ia{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let c,h=1;const p=r[0];if(p==="array"){let x,b;if(r.length>2){const S=r[1];if(typeof S!="string"||!(S in Ey)||S==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=Ey[S],h++}else x=mn;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);b=r[2],h++}c=Ps(x,b)}else c=Ey[p];const m=[];for(;h<r.length;h++){const x=s.parse(r[h],h,mn);if(!x)return null;m.push(x)}return new Ia(c,m)}evaluate(r){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(r);if(!zf(this.type,ji(c)))return c;if(s===this.args.length-1)throw new lo(`Expected value to be of type ${Ri(this.type)}, but found ${Ri(ji(c))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const c=r.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const h=r.N;(typeof h=="number"||this.args.length>1)&&s.push(h)}}return s.concat(this.args.map(c=>c.serialize()))}}class Uf{constructor(r){this.type=$h,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const h=[];let p=!1;for(let m=1;m<=r.length-1;++m){const x=r[m];if(p&&typeof x=="object"&&!Array.isArray(x)){p=!1;let b=null;if(x["font-scale"]&&(b=s.parse(x["font-scale"],1,Kt),!b))return null;let S=null;if(x["text-font"]&&(S=s.parse(x["text-font"],1,Ps(vn)),!S))return null;let I=null;if(x["text-color"]&&(I=s.parse(x["text-color"],1,ms),!I))return null;const P=h[h.length-1];P.scale=b,P.font=S,P.textColor=I}else{const b=s.parse(r[m],1,mn);if(!b)return null;const S=b.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:b,scale:null,font:null,textColor:null})}}return new Uf(h)}evaluate(r){return new Vo(this.sections.map(s=>{const c=s.content.evaluate(r);return ji(c)===cl?new Iu("",c,null,null,null):new Iu(sa(c),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),r.push(c)}return r}}class $f{constructor(r,s){this.type=cl,this.inputPrimary=r,this.inputSecondary=s}static parse(r,s){if(r.length<2)return s.error("Expected two or more arguments.");const c=s.parse(r[1],1,vn);if(!c)return s.error("No image name provided.");if(r.length===2)return new $f(c);const h=s.parse(r[2],1,vn);return h?new $f(c,h):s.error("Secondary image variant is not a string.")}evaluate(r){const s=gs.fromString(this.inputPrimary.evaluate(r),this.inputSecondary?this.inputSecondary.evaluate(r):void 0);return s&&r.availableImages&&(s.available=r.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&r.availableImages&&(s.available=r.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(r){r(this.inputPrimary),this.inputSecondary&&r(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Mu(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}const uI={"to-boolean":xn,"to-color":ms,"to-number":Kt,"to-string":vn};class Ma{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[0],h=[];let p=Nh;if(c==="to-array"){if(!Array.isArray(r[1]))return null;const m=r[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);p=Ps(s.expectedType.itemType,m)}else{if(!(m>0&&_s(r[1][0])))return null;p=Ps(ji(r[1][0]),m)}for(let x=0;x<m;x++){const b=r[1][x];let S;if(Mu(b)==="array")S=s.parse(b,void 0,p.itemType);else{const I=Mu(b);if(I!==p.itemType.kind)return s.error(`Expected ${p.itemType.kind} but found ${I}.`);S=s.registry.literal.parse(["literal",b===void 0?null:b],s)}if(!S)return null;h.push(S)}}else{if((c==="to-boolean"||c==="to-string")&&r.length!==2)return s.error("Expected one argument.");p=uI[c];for(let m=1;m<r.length;m++){const x=s.parse(r[m],m,mn);if(!x)return null;h.push(x)}}return new Ma(p,h)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let s,c;for(const h of this.args){if(s=h.evaluate(r),c=null,s instanceof yn)return s;if(typeof s=="string"){const p=r.parseColor(s);if(p)return p}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:wb(s[0],s[1],s[2],s[3]),!c))return new yn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new lo(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(r),s===null)return 0;const h=Number(s);if(!isNaN(h))return h}throw new lo(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Vo.fromString(sa(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?gs.fromString(sa(this.args[0].evaluate(r))):this.type.kind==="array"?this.args.map(s=>s.evaluate(r)):sa(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Uf([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $f(this.args[0]).serialize();const r=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{r.push(s.serialize())}),r}}const Cb=["Unknown","Point","LineString","Polygon"];class Eb{constructor(r,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cb[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-r[0])+this.featureDistanceData.bearing[1]*(h*s-r[1])}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=yn.parse(r)),s}getConfig(r){return this.options?this.options.get(r):null}}class Qo{constructor(r,s,c,h,p){this.name=r,this.type=s,this._evaluate=c,this.args=h,this._overloadIndex=p}evaluate(r){if(!this._evaluate){const s=Qo.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,s){const c=r[0],h=Qo.definitions[c];if(!h)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,m=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,x=[];let b=null,S=-1;for(const[I,P]of m){if(Array.isArray(I)&&I.length!==r.length-1)continue;x.push(I),S++,b=new Lb(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const D=[];let F=!1;for(let U=1;U<r.length;U++){const V=r[U],W=Array.isArray(I)?I[U-1]:I.type,ee=b.parse(V,1+D.length,W);if(!ee){F=!0;break}D.push(ee)}if(!F)if(Array.isArray(I)&&I.length!==D.length)b.error(`Expected ${I.length} arguments, but found ${D.length} instead.`);else{for(let U=0;U<D.length;U++){const V=Array.isArray(I)?I[U]:I.type,W=D[U];b.concat(U+1).checkSubtype(V,W.type)}if(b.errors.length===0)return new Qo(c,p,P,D,S)}}if(x.length===1)s.errors.push(...b.errors);else{const I=(x.length?x:m.map(([D])=>D)).map(Sy).join(" | "),P=[];for(let D=1;D<r.length;D++){const F=s.parse(r[D],1+P.length);if(!F)return null;P.push(Ri(F.type))}s.error(`Expected arguments of type ${I}, but found (${P.join(", ")}) instead.`)}return null}static register(r,s){Qo.definitions=s;for(const c in s)r[c]=Qo}}function Sy(i){return Array.isArray(i)?`(${i.map(Ri).join(", ")})`:`(${Ri(i.type)}...)`}class Pc{constructor(r,s,c){this.type=Aa,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const h=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,xn);if(!h)return null;const p=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,xn);if(!p)return null;let m=null;return c.locale&&(m=s.parse(c.locale,1,vn),!m)?null:new Pc(h,p,m)}evaluate(r){return new Nf(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}var Ty={exports:{}};Ty.exports=function(){function i(c,h,p,m,x){for(;m>p;){if(m-p>600){var b=m-p+1,S=h-p+1,I=Math.log(b),P=.5*Math.exp(2*I/3),D=.5*Math.sqrt(I*P*(b-P)/b)*(S-b/2<0?-1:1);i(c,h,Math.max(p,Math.floor(h-S*P/b+D)),Math.min(m,Math.floor(h+(b-S)*P/b+D)),x)}var F=c[h],U=p,V=m;for(r(c,p,h),x(c[m],F)>0&&r(c,p,m);U<V;){for(r(c,U,V),U++,V--;x(c[U],F)<0;)U++;for(;x(c[V],F)>0;)V--}x(c[p],F)===0?r(c,p,V):r(c,++V,m),V<=h&&(p=V+1),h<=V&&(m=V-1)}}function r(c,h,p){var m=c[h];c[h]=c[p],c[p]=m}function s(c,h){return c<h?-1:c>h?1:0}return function(c,h,p,m,x){i(c,h,p||0,m||c.length-1,x||s)}}();var hI=Y(Ty.exports);function dI(i){let r=0;for(let s,c,h=0,p=i.length,m=p-1;h<p;m=h++)s=i[h],c=i[m],r+=(c.x-s.x)*(s.y+c.y);return r}function jf(i,r){i[0]=Math.min(i[0],r[0]),i[1]=Math.min(i[1],r[1]),i[2]=Math.max(i[2],r[0]),i[3]=Math.max(i[3],r[1])}function Vh(i,r){return!(i[0]<=r[0]||i[2]>=r[2]||i[1]<=r[1]||i[3]>=r[3])}function fI(i,r,s){const c=i[0]-r[0],h=i[1]-r[1],p=i[0]-s[0],m=i[1]-s[1];return c*m-p*h==0&&c*p<=0&&h*m<=0}function Hh(i,r,s=!1){let c=!1;for(let x=0,b=r.length;x<b;x++){const S=r[x];for(let I=0,P=S.length,D=P-1;I<P;D=I++){const F=S[D],U=S[I];if(fI(i,F,U))return s;(p=F)[1]>(h=i)[1]!=(m=U)[1]>h[1]&&h[0]<(m[0]-p[0])*(h[1]-p[1])/(m[1]-p[1])+p[0]&&(c=!c)}}var h,p,m;return c}function Ay(i,r,s,c){const h=c[0]-s[0],p=c[1]-s[1],m=(i[0]-s[0])*p-h*(i[1]-s[1]),x=(r[0]-s[0])*p-h*(r[1]-s[1]);return m>0&&x<0||m<0&&x>0}function hn(i,r,s,c){return(h=[c[0]-s[0],c[1]-s[1]])[0]*(p=[r[0]-i[0],r[1]-i[1]])[1]-h[1]*p[0]!=0&&!(!Ay(i,r,s,c)||!Ay(s,c,i,r));var h,p}const Wl=8192;function Sb(i,r){const s=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,r.z);return[Math.round(s*h*Wl),Math.round(c*h*Wl)]}function pI(i,r){for(let s=0;s<r.length;s++)if(Hh(i,r[s]))return!0;return!1}function mI(i,r,s){for(const c of s)for(let h=0,p=c.length,m=p-1;h<p;m=h++)if(hn(i,r,c[m],c[h]))return!0;return!1}function Vf(i,r){for(let s=0;s<i.length;++s)if(!Hh(i[s],r))return!1;for(let s=0;s<i.length-1;++s)if(mI(i[s],i[s+1],r))return!1;return!0}function Ym(i,r){for(let s=0;s<r.length;s++)if(Vf(i,r[s]))return!0;return!1}function Gh(i,r,s){const c=[];for(let h=0;h<i.length;h++){const p=[];for(let m=0;m<i[h].length;m++){const x=Sb(i[h][m],s);jf(r,x),p.push(x)}c.push(p)}return c}function Tb(i,r,s){const c=[];for(let h=0;h<i.length;h++){const p=Gh(i[h],r,s);c.push(p)}return c}function Iy(i,r,s,c){if(i[0]<s[0]||i[0]>s[2]){const h=.5*c;let p=i[0]-s[0]>h?-c:s[0]-i[0]>h?c:0;p===0&&(p=i[0]-s[2]>h?-c:s[2]-i[0]>h?c:0),i[0]+=p}jf(r,i)}function Pa(i,r,s,c){const h=Math.pow(2,c.z)*Wl,p=[c.x*Wl,c.y*Wl],m=[];if(!i)return m;for(const x of i)for(const b of x){const S=[b.x+p[0],b.y+p[1]];Iy(S,r,s,h),m.push(S)}return m}function Ab(i,r,s,c){const h=Math.pow(2,c.z)*Wl,p=[c.x*Wl,c.y*Wl],m=[];if(!i)return m;for(const b of i){const S=[];for(const I of b){const P=[I.x+p[0],I.y+p[1]];jf(r,P),S.push(P)}m.push(S)}if(r[2]-r[0]<=h/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const b of m)for(const S of b)Iy(S,r,s,h)}var x;return m}class Rc{constructor(r,s){this.type=xn,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(_s(r[1])){const c=r[1];if(c.type==="FeatureCollection")for(let h=0;h<c.features.length;++h){const p=c.features[h].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Rc(c,c.features[h].geometry)}else if(c.type==="Feature"){const h=c.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Rc(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Rc(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,c){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=s.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const x=Gh(c.coordinates,p,m),b=Pa(s.geometry(),h,p,m);if(!Vh(h,p))return!1;for(const S of b)if(!Hh(S,x))return!1}if(c.type==="MultiPolygon"){const x=Tb(c.coordinates,p,m),b=Pa(s.geometry(),h,p,m);if(!Vh(h,p))return!1;for(const S of b)if(!pI(S,x))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,c){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=s.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const x=Gh(c.coordinates,p,m),b=Ab(s.geometry(),h,p,m);if(!Vh(h,p))return!1;for(const S of b)if(!Vf(S,x))return!1}if(c.type==="MultiPolygon"){const x=Tb(c.coordinates,p,m),b=Ab(s.geometry(),h,p,m);if(!Vh(h,p))return!1;for(const S of b)if(!Ym(S,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const kc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Zm=1/298.257223563,Ib=Zm*(2-Zm),Hf=Math.PI/180;class Gf{static fromTile(r,s,c){const h=Math.PI*(1-2*(r+.5)/Math.pow(2,s)),p=Math.atan(.5*(Math.exp(h)-Math.exp(-h)))/Hf;return new Gf(p,c)}static get units(){return kc}constructor(r,s){if(r===void 0)throw new Error("No latitude given.");if(s&&!kc[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(kc).join(", ")}`);const c=6378.137*Hf*(s?kc[s]:1),h=Math.cos(r*Hf),p=1/(1-Ib*(1-h*h)),m=Math.sqrt(p);this.kx=c*m*h,this.ky=c*m*p*(1-Ib)}distance(r,s){const c=aa(r[0]-s[0])*this.kx,h=(r[1]-s[1])*this.ky;return Math.sqrt(c*c+h*h)}bearing(r,s){const c=aa(s[0]-r[0])*this.kx;return Math.atan2(c,(s[1]-r[1])*this.ky)/Hf}destination(r,s,c){const h=c*Hf;return this.offset(r,Math.sin(h)*s,Math.cos(h)*s)}offset(r,s,c){return[r[0]+s/this.kx,r[1]+c/this.ky]}lineDistance(r){let s=0;for(let c=0;c<r.length-1;c++)s+=this.distance(r[c],r[c+1]);return s}area(r){let s=0;for(let c=0;c<r.length;c++){const h=r[c];for(let p=0,m=h.length,x=m-1;p<m;x=p++)s+=aa(h[p][0]-h[x][0])*(h[p][1]+h[x][1])*(c?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(r,s){let c=0;if(s<=0)return r[0];for(let h=0;h<r.length-1;h++){const p=r[h],m=r[h+1],x=this.distance(p,m);if(c+=x,c>s)return Wf(p,m,(s-(c-x))/x)}return r[r.length-1]}pointToSegmentDistance(r,s,c){let[h,p]=s,m=aa(c[0]-h)*this.kx,x=(c[1]-p)*this.ky;if(m!==0||x!==0){const b=(aa(r[0]-h)*this.kx*m+(r[1]-p)*this.ky*x)/(m*m+x*x);b>1?(h=c[0],p=c[1]):b>0&&(h+=m/this.kx*b,p+=x/this.ky*b)}return m=aa(r[0]-h)*this.kx,x=(r[1]-p)*this.ky,Math.sqrt(m*m+x*x)}pointOnLine(r,s){let c=1/0,h=r[0][0],p=r[0][1],m=0,x=0;for(let b=0;b<r.length-1;b++){let S=r[b][0],I=r[b][1],P=aa(r[b+1][0]-S)*this.kx,D=(r[b+1][1]-I)*this.ky,F=0;P===0&&D===0||(F=(aa(s[0]-S)*this.kx*P+(s[1]-I)*this.ky*D)/(P*P+D*D),F>1?(S=r[b+1][0],I=r[b+1][1]):F>0&&(S+=P/this.kx*F,I+=D/this.ky*F)),P=aa(s[0]-S)*this.kx,D=(s[1]-I)*this.ky;const U=P*P+D*D;U<c&&(c=U,h=S,p=I,m=b,x=F)}return{point:[h,p],index:m,t:Math.max(0,Math.min(1,x))}}lineSlice(r,s,c){let h=this.pointOnLine(c,r),p=this.pointOnLine(c,s);if(h.index>p.index||h.index===p.index&&h.t>p.t){const S=h;h=p,p=S}const m=[h.point],x=h.index+1,b=p.index;!My(c[x],m[0])&&x<=b&&m.push(c[x]);for(let S=x+1;S<=b;S++)m.push(c[S]);return My(c[b],p.point)||m.push(p.point),m}lineSliceAlong(r,s,c){let h=0;const p=[];for(let m=0;m<c.length-1;m++){const x=c[m],b=c[m+1],S=this.distance(x,b);if(h+=S,h>r&&p.length===0&&p.push(Wf(x,b,(r-(h-S))/S)),h>=s)return p.push(Wf(x,b,(s-(h-S))/S)),p;h>r&&p.push(b)}return p}bufferPoint(r,s){const c=s/this.ky,h=s/this.kx;return[r[0]-h,r[1]-c,r[0]+h,r[1]+c]}bufferBBox(r,s){const c=s/this.ky,h=s/this.kx;return[r[0]-h,r[1]-c,r[2]+h,r[3]+c]}insideBBox(r,s){return aa(r[0]-s[0])>=0&&aa(r[0]-s[2])<=0&&r[1]>=s[1]&&r[1]<=s[3]}}function My(i,r){return i[0]===r[0]&&i[1]===r[1]}function Wf(i,r,s){const c=aa(r[0]-i[0]);return[i[0]+c*s,i[1]+(r[1]-i[1])*s]}function aa(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}var qf={exports:{}};(function(i,r){i.exports=function(){var s=function(h,p){if(h===void 0&&(h=[]),p===void 0&&(p=c),this.data=h,this.length=this.data.length,this.compare=p,this.length>0)for(var m=(this.length>>1)-1;m>=0;m--)this._down(m)};function c(h,p){return h<p?-1:h>p?1:0}return s.prototype.push=function(h){this.data.push(h),this.length++,this._up(this.length-1)},s.prototype.pop=function(){if(this.length!==0){var h=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),h}},s.prototype.peek=function(){return this.data[0]},s.prototype._up=function(h){for(var p=this.data,m=this.compare,x=p[h];h>0;){var b=h-1>>1,S=p[b];if(m(x,S)>=0)break;p[h]=S,h=b}p[h]=x},s.prototype._down=function(h){for(var p=this.data,m=this.compare,x=this.length>>1,b=p[h];h<x;){var S=1+(h<<1),I=p[S],P=S+1;if(P<this.length&&m(p[P],I)<0&&(S=P,I=p[P]),m(I,b)>=0)break;p[h]=I,h=S}p[h]=b},s}()})(qf);var Py=Y(qf.exports),Bt=8192;function Mb(i,r){return r.dist-i.dist}const Ry=100,ky=50;function Pb(i){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1;return!0}function Xm(i){return i[1]-i[0]+1}function ul(i,r){const s=i[1]>=i[0]&&i[1]<r;return s||console.warn("Distance Expression: Index is out of range"),s}function Dc(i,r){if(i[0]>i[1])return[null,null];const s=Xm(i);if(r){if(s===2)return[i,null];const c=Math.floor(s/2);return[[i[0],i[0]+c],[i[0]+c,i[1]]]}{if(s===1)return[i,null];const c=Math.floor(s/2)-1;return[[i[0],i[0]+c],[i[0]+c+1,i[1]]]}}function Pu(i,r){const s=[1/0,1/0,-1/0,-1/0];if(!ul(r,i.length))return s;for(let c=r[0];c<=r[1];++c)jf(s,i[c]);return s}function Qm(i){const r=[1/0,1/0,-1/0,-1/0];for(let s=0;s<i.length;++s)for(let c=0;c<i[s].length;++c)jf(r,i[s][c]);return r}function Oc(i,r,s){if(Pb(i)||Pb(r))return NaN;let c=0,h=0;return i[2]<r[0]&&(c=r[0]-i[2]),i[0]>r[2]&&(c=i[0]-r[2]),i[1]>r[3]&&(h=i[1]-r[3]),i[3]<r[1]&&(h=r[1]-i[3]),s.distance([0,0],[c,h])}function gI(i){return 360*i-180}function _I(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Dy(i,r){const s=Math.pow(2,r.z),c=(i.y/Bt+r.y)/s;return[gI((i.x/Bt+r.x)/s),_I(c)]}function yI(i,r){const s=[];for(let c=0;c<i.length;++c)s.push(Dy(i[c],r));return s}function Rb(i,r,s){const c=s.pointOnLine(r,i).point;return s.distance(i,c)}function Lc(i,r,s,c,h){const p=s.slice(c[0],c[1]+1);let m=1/0;for(let x=r[0];x<=r[1];++x)if((m=Math.min(m,Rb(i[x],p,h)))===0)return 0;return m}function Oy(i,r,s,c,h){const p=Math.min(h.pointToSegmentDistance(i,s,c),h.pointToSegmentDistance(r,s,c)),m=Math.min(h.pointToSegmentDistance(s,i,r),h.pointToSegmentDistance(c,i,r));return Math.min(p,m)}function vI(i,r,s,c,h){if(!ul(r,i.length)||!ul(c,s.length))return NaN;let p=1/0;for(let m=r[0];m<r[1];++m)for(let x=c[0];x<c[1];++x){if(hn(i[m],i[m+1],s[x],s[x+1]))return 0;p=Math.min(p,Oy(i[m],i[m+1],s[x],s[x+1],h))}return p}function kb(i,r,s,c,h){if(!ul(r,i.length)||!ul(c,s.length))return NaN;let p=1/0;for(let m=r[0];m<=r[1];++m)for(let x=c[0];x<=c[1];++x)if((p=Math.min(p,h.distance(i[m],s[x])))===0)return p;return p}function Db(i,r,s){if(Hh(i,r,!0))return 0;let c=1/0;for(const h of r){const p=h.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(h[0]!==h[p-1]&&(c=Math.min(c,s.pointToSegmentDistance(i,h[p-1],h[0])))===0||(c=Math.min(c,Rb(i,h,s)))===0)return c}return c}function Ra(i,r,s,c){if(!ul(r,i.length))return NaN;for(let p=r[0];p<=r[1];++p)if(Hh(i[p],s,!0))return 0;let h=1/0;for(let p=r[0];p<r[1];++p)for(const m of s)for(let x=0,b=m.length,S=b-1;x<b;S=x++){if(hn(i[p],i[p+1],m[S],m[x]))return 0;h=Math.min(h,Oy(i[p],i[p+1],m[S],m[x],c))}return h}function Ly(i,r){for(const s of i)for(let c=0;c<=s.length-1;++c)if(Hh(s[c],r,!0))return!0;return!1}function xI(i,r,s,c=1/0){const h=Qm(i),p=Qm(r);if(c!==1/0&&Oc(h,p,s)>=c)return c;if(Vh(h,p)){if(Ly(i,r))return 0}else if(Ly(r,i))return 0;let m=c;for(const x of i)for(let b=0,S=x.length,I=S-1;b<S;I=b++)for(const P of r)for(let D=0,F=P.length,U=F-1;D<F;U=D++){if(hn(x[I],x[b],P[U],P[D]))return 0;m=Math.min(m,Oy(x[I],x[b],P[U],P[D],s))}return m}function Kf(i,r,s,c,h,p,m){if(p===null||m===null)return;const x=Oc(Pu(c,p),Pu(h,m),s);x<r&&i.push({dist:x,range1:p,range2:m})}function Jm(i,r,s,c,h=1/0){let p=Math.min(c.distance(i[0],s[0][0]),h);if(p===0)return p;const m=new Py([{dist:0,range1:[0,i.length-1],range2:[0,0]}],Mb),x=r?ky:Ry,b=Qm(s);for(;m.length;){const S=m.pop();if(S.dist>=p)continue;const I=S.range1;if(Xm(I)<=x){if(!ul(I,i.length))return NaN;if(r){const P=Ra(i,I,s,c);if((p=Math.min(p,P))===0)return p}else for(let P=I[0];P<=I[1];++P){const D=Db(i[P],s,c);if((p=Math.min(p,D))===0)return p}}else{const P=Dc(I,r);if(P[0]!==null){const D=Oc(Pu(i,P[0]),b,c);D<p&&m.push({dist:D,range1:P[0],range2:[0,0]})}if(P[1]!==null){const D=Oc(Pu(i,P[1]),b,c);D<p&&m.push({dist:D,range1:P[1],range2:[0,0]})}}}return p}function Ob(i,r,s,c,h,p=1/0){let m=Math.min(p,h.distance(i[0],s[0]));if(m===0)return m;const x=new Py([{dist:0,range1:[0,i.length-1],range2:[0,s.length-1]}],Mb),b=r?ky:Ry,S=c?ky:Ry;for(;x.length;){const I=x.pop();if(I.dist>=m)continue;const P=I.range1,D=I.range2;if(Xm(P)<=b&&Xm(D)<=S){if(!ul(P,i.length)||!ul(D,s.length))return NaN;if(r&&c?m=Math.min(m,vI(i,P,s,D,h)):r||c?r&&!c?m=Math.min(m,Lc(s,D,i,P,h)):!r&&c&&(m=Math.min(m,Lc(i,P,s,D,h))):m=Math.min(m,kb(i,P,s,D,h)),m===0)return m}else{const F=Dc(P,r),U=Dc(D,c);Kf(x,m,h,i,s,F[0],U[0]),Kf(x,m,h,i,s,F[0],U[1]),Kf(x,m,h,i,s,F[1],U[0]),Kf(x,m,h,i,s,F[1],U[1])}}return m}function By(i,r,s,c,h=1/0){let p=h;const m=Pu(i,[0,i.length-1]);for(const x of s)if(!(p!==1/0&&Oc(m,Pu(x,[0,x.length-1]),c)>=p)&&(p=Math.min(p,Ob(i,r,x,!0,c,p)),p===0))return p;return p}function e0(i,r,s,c,h=1/0){let p=h;const m=Pu(i,[0,i.length-1]);for(const x of s){if(p!==1/0&&Oc(m,Qm(x),c)>=p)continue;const b=Jm(i,r,x,c,p);if(isNaN(b))return b;if((p=Math.min(p,b))===0)return p}return p}function Fy(i){return i==="Point"||i==="MultiPoint"||i==="LineString"||i==="MultiLineString"||i==="Polygon"||i==="MultiPolygon"}class Ru{constructor(r,s){this.type=Kt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(_s(r[1])){const c=r[1];if(c.type==="FeatureCollection"){for(let h=0;h<c.features.length;++h)if(Fy(c.features[h].geometry.type))return new Ru(c,c.features[h].geometry)}else if(c.type==="Feature"){if(Fy(c.geometry.type))return new Ru(c,c.geometry)}else if(Fy(c.type))return new Ru(c,c)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const s=r.geometry(),c=r.canonicalID();if(s!=null&&c!=null){if(r.geometryType()==="Point")return function(h,p,m){const x=[];for(const S of h)for(const I of S)x.push(Dy(I,p));const b=new Gf(x[0][1],"meters");return m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString"?Ob(x,!1,m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",b):m.type==="MultiLineString"?By(x,!1,m.coordinates,b):m.type==="Polygon"||m.type==="MultiPolygon"?e0(x,!1,m.type==="Polygon"?[m.coordinates]:m.coordinates,b):null}(s,c,this.geometries);if(r.geometryType()==="LineString")return function(h,p,m){const x=[];for(const S of h){const I=[];for(const P of S)I.push(Dy(P,p));x.push(I)}const b=new Gf(x[0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return By(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",x,b);if(m.type==="MultiLineString"){let S=1/0;for(let I=0;I<m.coordinates.length;I++){const P=By(m.coordinates[I],!0,x,b,S);if(isNaN(P))return P;if((S=Math.min(S,P))===0)return S}return S}if(m.type==="Polygon"||m.type==="MultiPolygon"){let S=1/0;for(let I=0;I<x.length;I++){const P=e0(x[I],!0,m.type==="Polygon"?[m.coordinates]:m.coordinates,b,S);if(isNaN(P))return P;if((S=Math.min(S,P))===0)return S}return S}return null}(s,c,this.geometries);if(r.geometryType()==="Polygon")return function(h,p,m){const x=[];for(const S of function(I,P){const D=I.length;if(D<=1)return[I];const F=[];let U,V;for(let W=0;W<D;W++){const ee=dI(I[W]);ee!==0&&(I[W].area=Math.abs(ee),V===void 0&&(V=ee<0),V===ee<0?(U&&F.push(U),U=[I[W]]):U.push(I[W]))}return U&&F.push(U),F}(h)){const I=[];for(let P=0;P<S.length;++P)I.push(yI(S[P],p));x.push(I)}const b=new Gf(x[0][0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return e0(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",x,b);if(m.type==="MultiLineString"){let S=1/0;for(let I=0;I<m.coordinates.length;I++){const P=e0(m.coordinates[I],!0,x,b,S);if(isNaN(P))return P;if((S=Math.min(S,P))===0)return S}return S}return m.type==="Polygon"||m.type==="MultiPolygon"?function(S,I,P){let D=1/0;for(const F of S)for(const U of I){const V=xI(F,U,P,D);if(isNaN(V))return V;if((D=Math.min(D,V))===0)return D}return D}(m.type==="Polygon"?[m.coordinates]:m.coordinates,x,b):null}(s,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Wh(i,r){switch(i){case"string":return sa(r);case"number":return+r;case"boolean":return!!r;case"color":return yn.parse(r);case"formatted":return Vo.fromString(sa(r));case"resolvedImage":return gs.fromString(sa(r))}return r}function Yf(i,r,s,c){return c!==void 0&&(i=c*Math.round(i/c)),r!==void 0&&i<r&&(i=r),s!==void 0&&i>s&&(i=s),i}class Mo{constructor(r,s,c){this.type=r,this.key=s,this.scope=c}static parse(r,s){let c=s.expectedType;if(c==null&&(c=mn),r.length<2||r.length>3)return s.error("Invalid number of arguments for 'config' expression.");const h=s.parse(r[1],1);if(!(h instanceof Gl))return s.error("Key name of 'config' expression must be a string literal.");if(r.length>=3){const p=s.parse(r[2],2);return p instanceof Gl?new Mo(c,sa(h.value),sa(p.value)):s.error("Scope of 'config' expression must be a string literal.")}return new Mo(c,sa(h.value))}evaluate(r){const s=[this.key,this.scope,r.scope].filter(Boolean).join(""),c=r.getConfig(s);if(!c)return null;const{type:h,value:p,values:m,minValue:x,maxValue:b,stepValue:S}=c,I=c.default.evaluate(r);let P=I;if(p){const D=r.scope;r.scope=(D||"").split("").slice(1).join(""),P=p.evaluate(r),r.scope=D}return h&&(P=Wh(h,P)),P===void 0||x===void 0&&b===void 0&&S===void 0||(typeof P=="number"?P=Yf(P,x,b,S):Array.isArray(P)&&(P=P.map(D=>typeof D=="number"?Yf(D,x,b,S):D))),p!==void 0&&P!==void 0&&m&&!m.includes(P)&&(P=I,h&&(P=Wh(h,P))),(h&&h!==this.type||P!==void 0&&ji(P)!==this.type)&&(P=Wh(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.key),r}}function Bc(i){if(i instanceof Qo&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Rc||i instanceof Ru)return!1;let r=!0;return i.eachChild(s=>{r&&!Bc(s)&&(r=!1)}),r}function t0(i){if(i instanceof Qo&&i.name==="feature-state")return!1;let r=!0;return i.eachChild(s=>{r&&!t0(s)&&(r=!1)}),r}function zy(i){if(i instanceof Mo)return!1;let r=!0;return i.eachChild(s=>{r&&!zy(s)&&(r=!1)}),r}function Zf(i,r){if(i instanceof Qo&&r.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(c=>{s&&!Zf(c,r)&&(s=!1)}),s}class r0{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=r[1];return s.scope.has(c)?new r0(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Xf{constructor(r,s=[],c,h=new wy,p=[],m,x){this.registry=r,this.path=s,this.key=s.map(b=>`[${b}]`).join(""),this.scope=h,this.errors=p,this.expectedType=c,this._scope=m,this.options=x}parse(r,s,c,h,p={}){return s||c?this.concat(s,c,h)._parse(r,p):this._parse(r,p)}_parse(r,s){function c(h,p,m){return m==="assert"?new Ia(p,[h]):m==="coerce"?new Ma(p,[h]):h}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=typeof r[0]=="string"?this.registry[r[0]]:void 0;if(h){let p=h.parse(r,this);if(!p)return null;if(this.expectedType){const m=this.expectedType,x=p.type;if(m.kind!=="string"&&m.kind!=="number"&&m.kind!=="boolean"&&m.kind!=="object"&&m.kind!=="array"||x.kind!=="value")if(m.kind!=="color"&&m.kind!=="formatted"&&m.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(m,x))return null}else p=c(p,m,s.typeAnnotation||"coerce");else p=c(p,m,s.typeAnnotation||"assert")}if(!(p instanceof Gl)&&p.type.kind!=="resolvedImage"&&Qf(p)){const m=new Eb(this._scope,this.options);try{p=new Gl(p.type,p.evaluate(m))}catch(x){return this.error(x.message),null}}return p}return Ma.parse(["to-array",r],this)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,c){const h=typeof r=="number"?this.path.concat(r):this.path,p=c?this.scope.concat(c):this.scope;return new Xf(this.registry,h,s||null,p,this.errors,this._scope,this.options)}error(r,...s){const c=`${this.key}${s.map(h=>`[${h}]`).join("")}`;this.errors.push(new ll(c,r))}checkSubtype(r,s){const c=zf(r,s);return c&&this.error(c),c}}var Lb=Xf;function Qf(i){if(i instanceof r0)return Qf(i.boundExpression);if(i instanceof Qo&&i.name==="error"||i instanceof Pc||i instanceof Rc||i instanceof Ru||i instanceof Mo)return!1;const r=i instanceof Ma||i instanceof Ia;let s=!0;return i.eachChild(c=>{s=r?s&&Qf(c):s&&c instanceof Gl}),!!s&&Bc(i)&&Zf(i,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function n0(i,r){const s=i.length-1;let c,h,p=0,m=s,x=0;for(;p<=m;)if(x=Math.floor((p+m)/2),c=i[x],h=i[x+1],c<=r){if(x===s||r<h)return x;p=x+1}else{if(!(c>r))throw new lo("Input is not a number.");m=x-1}return 0}class Jf{constructor(r,s,c){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[h,p]of c)this.labels.push(h),this.outputs.push(p)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(r[1],1,Kt);if(!c)return null;const h=[];let p=null;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);for(let m=1;m<r.length;m+=2){const x=m===1?-1/0:r[m],b=r[m+1],S=m,I=m+1;if(typeof x!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(h.length&&h[h.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const P=s.parse(b,I,p);if(!P)return null;p=p||P.type,h.push([x,P])}return new Jf(p,c,h)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const h=this.input.evaluate(r);if(h<=s[0])return c[0].evaluate(r);const p=s.length;return h>=s[p-1]?c[p-1].evaluate(r):c[n0(s,h)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}const i0=.95047,Bb=1.08883,Ny=4/29,ku=6/29,Fb=3*ku*ku,Uy=ku*ku*ku,o0=Math.PI/180,zb=180/Math.PI;function $y(i){return i>Uy?Math.pow(i,1/3):i/Fb+Ny}function s0(i){return i>ku?i*i*i:Fb*(i-Ny)}function jy(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function ep(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Nb(i){const r=ep(i.r),s=ep(i.g),c=ep(i.b),h=$y((.4124564*r+.3575761*s+.1804375*c)/i0),p=$y((.2126729*r+.7151522*s+.072175*c)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-$y((.0193339*r+.119192*s+.9503041*c)/Bb)),alpha:i.a}}function Ub(i){let r=(i.l+16)/116,s=isNaN(i.a)?r:r+i.a/500,c=isNaN(i.b)?r:r-i.b/200;return r=1*s0(r),s=i0*s0(s),c=Bb*s0(c),new yn(jy(3.2404542*s-1.5371385*r-.4985314*c),jy(-.969266*s+1.8760108*r+.041556*c),jy(.0556434*s-.2040259*r+1.0572252*c),i.alpha)}function bI(i,r,s){const c=r-i;return i+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const tp={forward:Nb,reverse:Ub,interpolate:function(i,r,s){return{l:_r(i.l,r.l,s),a:_r(i.a,r.a,s),b:_r(i.b,r.b,s),alpha:_r(i.alpha,r.alpha,s)}}},qh={forward:function(i){const{l:r,a:s,b:c}=Nb(i),h=Math.atan2(c,s)*zb;return{h:h<0?h+360:h,c:Math.sqrt(s*s+c*c),l:r,alpha:i.a}},reverse:function(i){const r=i.h*o0,s=i.c;return Ub({l:i.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:i.alpha})},interpolate:function(i,r,s){return{h:bI(i.h,r.h,s),c:_r(i.c,r.c,s),l:_r(i.l,r.l,s),alpha:_r(i.alpha,r.alpha,s)}}};var $b=Object.freeze({__proto__:null,hcl:qh,lab:tp});class Ws{constructor(r,s,c,h,p){this.type=r,this.operator=s,this.interpolation=c,this.input=h,this.labels=[],this.outputs=[];for(const[m,x]of p)this.labels.push(m),this.outputs.push(x)}static interpolationFactor(r,s,c,h){let p=0;if(r.name==="exponential")p=Vy(s,r.base,c,h);else if(r.name==="linear")p=Vy(s,1,c,h);else if(r.name==="cubic-bezier"){const m=r.controlPoints;p=new wf(m[0],m[1],m[2],m[3]).solve(Vy(s,1,c,h))}return p}static parse(r,s){let[c,h,p,...m]=r;if(!Array.isArray(h)||h.length===0)return s.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const S=h[1];if(typeof S!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:S}}else{if(h[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const S=h.slice(1);if(S.length!==4||S.some(I=>typeof I!="number"||I<0||I>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:S}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(p=s.parse(p,2,Kt),!p)return null;const x=[];let b=null;c==="interpolate-hcl"||c==="interpolate-lab"?b=ms:s.expectedType&&s.expectedType.kind!=="value"&&(b=s.expectedType);for(let S=0;S<m.length;S+=2){const I=m[S],P=m[S+1],D=S+3,F=S+4;if(typeof I!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(x.length&&x[x.length-1][0]>=I)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const U=s.parse(P,F,b);if(!U)return null;b=b||U.type,x.push([I,U])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new Ws(b,c,h,p,x):s.error(`Type ${Ri(b)} is not interpolatable.`)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const h=this.input.evaluate(r);if(h<=s[0])return c[0].evaluate(r);const p=s.length;if(h>=s[p-1])return c[p-1].evaluate(r);const m=n0(s,h),x=Ws.interpolationFactor(this.interpolation,h,s[m],s[m+1]),b=c[m].evaluate(r),S=c[m+1].evaluate(r);return this.operator==="interpolate"?Km[this.type.kind.toLowerCase()](b,S,x):this.operator==="interpolate-hcl"?qh.reverse(qh.interpolate(qh.forward(b),qh.forward(S),x)):tp.reverse(tp.interpolate(tp.forward(b),tp.forward(S),x))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,r,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function Vy(i,r,s,c){const h=c-s,p=i-s;return h===0?0:r===1?p/h:(Math.pow(r,p)-1)/(Math.pow(r,h)-1)}class a0{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let c=null;const h=s.expectedType;h&&h.kind!=="value"&&(c=h);const p=[];for(const x of r.slice(1)){const b=s.parse(x,1+p.length,c,void 0,{typeAnnotation:"omit"});if(!b)return null;c=c||b.type,p.push(b)}const m=h&&p.some(x=>zf(h,x.type));return new a0(m?mn:c,p)}evaluate(r){let s,c=null,h=0;for(const p of this.args){if(h++,c=p.evaluate(r),c&&c instanceof gs&&!c.available&&(s||(s=c),c=null,h===this.args.length))return s;if(c!==null)break}return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class l0{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let p=1;p<r.length-1;p+=2){const m=r[p];if(typeof m!="string")return s.error(`Expected string, but found ${typeof m} instead.`,p);if(/[^a-zA-Z0-9_]/.test(m))return s.error("Variable names must contain only alphanumeric characters or '_'.",p);const x=s.parse(r[p+1],p+1);if(!x)return null;c.push([m,x])}const h=s.parse(r[r.length-1],r.length-1,s.expectedType,c);return h?new l0(c,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,c]of this.bindings)r.push(s,c.serialize());return r.push(this.result.serialize()),r}}class Hy{constructor(r,s,c){this.type=r,this.index=s,this.input=c}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Kt),h=s.parse(r[2],2,Ps(s.expectedType||mn));return c&&h?new Hy(h.type.itemType,c,h):null}evaluate(r){const s=this.index.evaluate(r),c=this.input.evaluate(r);if(s<0)throw new lo(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new lo(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new lo(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Gy{constructor(r,s){this.type=xn,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,mn),h=s.parse(r[2],2,mn);return c&&h?Cy(c.type,[xn,vn,Kt,Nh,mn])?new Gy(c,h):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ri(c.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(c==null)return!1;if(!jh(s,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${Ri(ji(s))} instead.`);if(!jh(c,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${Ri(ji(c))} instead.`);return c.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class c0{constructor(r,s,c){this.type=Kt,this.needle=r,this.haystack=s,this.fromIndex=c}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,mn),h=s.parse(r[2],2,mn);if(!c||!h)return null;if(!Cy(c.type,[xn,vn,Kt,Nh,mn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ri(c.type)} instead`);if(r.length===4){const p=s.parse(r[3],3,Kt);return p?new c0(c,h,p):null}return new c0(c,h)}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!jh(s,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${Ri(ji(s))} instead.`);if(!jh(c,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${Ri(ji(c))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(r);return c.indexOf(s,h)}return c.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Kh{constructor(r,s,c,h,p,m){this.inputType=r,this.type=s,this.input=c,this.cases=h,this.outputs=p,this.otherwise=m}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let c,h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const p={},m=[];for(let S=2;S<r.length-1;S+=2){let I=r[S];const P=r[S+1];Array.isArray(I)||(I=[I]);const D=s.concat(S);if(I.length===0)return D.error("Expected at least one branch label.");for(const U of I){if(typeof U!="number"&&typeof U!="string")return D.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof U=="number"&&Math.floor(U)!==U)return D.error("Numeric branch labels must be integer values.");if(c){if(D.checkSubtype(c,ji(U)))return null}else c=ji(U);if(p[String(U)]!==void 0)return D.error("Branch labels must be unique.");p[String(U)]=m.length}const F=s.parse(P,S,h);if(!F)return null;h=h||F.type,m.push(F)}const x=s.parse(r[1],1,mn);if(!x)return null;const b=s.parse(r[r.length-1],r.length-1,h);return b?x.type.kind!=="value"&&s.concat(1).checkSubtype(c,x.type)?null:new Kh(c,h,x,p,m,b):null}evaluate(r){const s=this.input.evaluate(r);return(ji(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],h={};for(const m of s){const x=h[this.cases[m]];x===void 0?(h[this.cases[m]]=c.length,c.push([this.cases[m],[m]])):c[x][1].push(m)}const p=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,x]of c)r.push(x.length===1?p(x[0]):x.map(p)),r.push(this.outputs[m].serialize());return r.push(this.otherwise.serialize()),r}}class Wy{constructor(r,s,c){this.type=r,this.branches=s,this.otherwise=c}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const h=[];for(let m=1;m<r.length-1;m+=2){const x=s.parse(r[m],m,xn);if(!x)return null;const b=s.parse(r[m+1],m+1,c);if(!b)return null;h.push([x,b]),c=c||b.type}const p=s.parse(r[r.length-1],r.length-1,c);return p?new Wy(c,h,p):null}evaluate(r){for(const[s,c]of this.branches)if(s.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,c]of this.branches)r(s),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class u0{constructor(r,s,c,h){this.type=r,this.input=s,this.beginIndex=c,this.endIndex=h}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,mn),h=s.parse(r[2],2,Kt);if(!c||!h)return null;if(!Cy(c.type,[Ps(mn),vn,mn]))return s.error(`Expected first argument to be of type array or string, but found ${Ri(c.type)} instead`);if(r.length===4){const p=s.parse(r[3],3,Kt);return p?new u0(c.type,c,h,p):null}return new u0(c.type,c,h)}evaluate(r){const s=this.input.evaluate(r),c=this.beginIndex.evaluate(r);if(!jh(s,["string","array"]))throw new lo(`Expected first argument to be of type array or string, but found ${Ri(ji(s))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(r);return s.slice(c,h)}return s.slice(c)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function rp(i,r){return i==="=="||i==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function jb(i,r,s,c){return c.compare(r,s)===0}function Du(i,r,s){const c=i!=="=="&&i!=="!=";return class $H{constructor(p,m,x){this.type=xn,this.lhs=p,this.rhs=m,this.collator=x,this.hasUntypedArgument=p.type.kind==="value"||m.type.kind==="value"}static parse(p,m){if(p.length!==3&&p.length!==4)return m.error("Expected two or three arguments.");const x=p[0];let b=m.parse(p[1],1,mn);if(!b)return null;if(!rp(x,b.type))return m.concat(1).error(`"${x}" comparisons are not supported for type '${Ri(b.type)}'.`);let S=m.parse(p[2],2,mn);if(!S)return null;if(!rp(x,S.type))return m.concat(2).error(`"${x}" comparisons are not supported for type '${Ri(S.type)}'.`);if(b.type.kind!==S.type.kind&&b.type.kind!=="value"&&S.type.kind!=="value")return m.error(`Cannot compare types '${Ri(b.type)}' and '${Ri(S.type)}'.`);c&&(b.type.kind==="value"&&S.type.kind!=="value"?b=new Ia(S.type,[b]):b.type.kind!=="value"&&S.type.kind==="value"&&(S=new Ia(b.type,[S])));let I=null;if(p.length===4){if(b.type.kind!=="string"&&S.type.kind!=="string"&&b.type.kind!=="value"&&S.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(I=m.parse(p[3],3,Aa),!I)return null}return new $H(b,S,I)}evaluate(p){const m=this.lhs.evaluate(p),x=this.rhs.evaluate(p);if(c&&this.hasUntypedArgument){const b=ji(m),S=ji(x);if(b.kind!==S.kind||b.kind!=="string"&&b.kind!=="number")throw new lo(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${S.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const b=ji(m),S=ji(x);if(b.kind!=="string"||S.kind!=="string")return r(p,m,x)}return this.collator?s(p,m,x,this.collator.evaluate(p)):r(p,m,x)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[i];return this.eachChild(m=>{p.push(m.serialize())}),p}}}const wI=Du("==",function(i,r,s){return r===s},jb),Vb=Du("!=",function(i,r,s){return r!==s},function(i,r,s,c){return!jb(0,r,s,c)}),Hb=Du("<",function(i,r,s){return r<s},function(i,r,s,c){return c.compare(r,s)<0}),Gb=Du(">",function(i,r,s){return r>s},function(i,r,s,c){return c.compare(r,s)>0}),Wb=Du("<=",function(i,r,s){return r<=s},function(i,r,s,c){return c.compare(r,s)<=0}),qy=Du(">=",function(i,r,s){return r>=s},function(i,r,s,c){return c.compare(r,s)>=0});class np{constructor(r,s,c,h,p,m){this.type=vn,this.number=r,this.locale=s,this.currency=c,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=m}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const c=s.parse(r[1],1,Kt);if(!c)return null;const h=r[2];if(typeof h!="object"||Array.isArray(h))return s.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=s.parse(h.locale,1,vn),!p))return null;let m=null;if(h.currency&&(m=s.parse(h.currency,1,vn),!m))return null;let x=null;if(h.unit&&(x=s.parse(h.unit,1,vn),!x))return null;let b=null;if(h["min-fraction-digits"]&&(b=s.parse(h["min-fraction-digits"],1,Kt),!b))return null;let S=null;return h["max-fraction-digits"]&&(S=s.parse(h["max-fraction-digits"],1,Kt),!S)?null:new np(c,p,m,x,b,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Ky{constructor(r){this.type=Kt,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=s.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Ri(c.type)} instead.`):new Ky(c):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string"||Array.isArray(s))return s.length;throw new lo(`Expected value to be of type string or array, but found ${Ri(ji(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(s=>{r.push(s.serialize())}),r}}function qb(i){return function(){i=1831565813+(i|=0)|0;let r=Math.imul(i^i>>>15,1|i);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const Ou={"==":wI,"!=":Vb,">":Gb,"<":Hb,">=":qy,"<=":Wb,array:Ia,at:Hy,boolean:Ia,case:Wy,coalesce:a0,collator:Pc,format:Uf,image:$f,in:Gy,"index-of":c0,interpolate:Ws,"interpolate-hcl":Ws,"interpolate-lab":Ws,length:Ky,let:l0,literal:Gl,match:Kh,number:Ia,"number-format":np,object:Ia,slice:u0,step:Jf,string:Ia,"to-boolean":Ma,"to-color":Ma,"to-number":Ma,"to-string":Ma,var:r0,within:Rc,distance:Ru,config:Mo};function Kb(i,[r,s,c,h]){r=r.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const p=h?h.evaluate(i):1,m=wb(r,s,c,p);if(m)throw new lo(m);return new yn(r/255*p,s/255*p,c/255*p,p)}function Yb(i,[r,s,c,h]){r=r.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const p=h?h.evaluate(i):1,m=function(S,I,P,D){return typeof S=="number"&&S>=0&&S<=360?typeof I=="number"&&I>=0&&I<=100&&typeof P=="number"&&P>=0&&P<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[S,I,P,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[S,I,P,D]:[S,I,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[S,I,P,D]:[S,I,P]).join(", ")}]: 'h' must be between 0 and 360.`}(r,s,c,p);if(m)throw new lo(m);const x=`hsla(${r}, ${s}%, ${c}%, ${p})`,b=yn.parse(x);if(!b)throw new lo(`Failed to parse HSLA color: ${x}`);return b}function Zb(i,r){return i in r}function Yy(i,r){const s=r[i];return s===void 0?null:s}function Lu(i){return{type:i}}function Xb(i){return{result:"success",value:i}}function Bu(i){return{result:"error",value:i}}function Qb(i,r){return!!i&&!!i.parameters&&i.parameters.indexOf(r)>-1}function h0(i){return i["property-type"]==="data-driven"}function CI(i){return Qb(i.expression,"measure-light")}function g(i){return Qb(i.expression,"zoom")}function l(i){return!!i.expression&&i.expression.interpolated}function f(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function y(i){return i}function w(i,r){const s=r.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",h=c||!(c||i.property!==void 0),p=i.type||(l(r)?"exponential":"interval");if(s&&((i=by({},i)).stops&&(i.stops=i.stops.map(S=>[S[0],yn.parse(S[1])])),i.default=yn.parse(i.default?i.default:r.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!$b[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let m,x,b;if(p==="exponential")m=L;else if(p==="interval")m=M;else if(p==="categorical"){m=T,x=Object.create(null);for(const S of i.stops)x[S[0]]=S[1];b=typeof i.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);m=B}if(c){const S={},I=[];for(let F=0;F<i.stops.length;F++){const U=i.stops[F],V=U[0].zoom;S[V]===void 0&&(S[V]={zoom:V,type:i.type,property:i.property,default:i.default,stops:[]},I.push(V)),S[V].stops.push([U[0].value,U[1]])}const P=[];for(const F of I)P.push([S[F].zoom,w(S[F],r)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:Ws.interpolationFactor.bind(void 0,D),zoomStops:P.map(F=>F[0]),evaluate:({zoom:F},U)=>L({stops:P,base:i.base},r,F).evaluate(F,U)}}if(h){const S=p==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:Ws.interpolationFactor.bind(void 0,S),zoomStops:i.stops.map(I=>I[0]),evaluate:({zoom:I})=>m(i,r,I,x,b)}}return{kind:"source",evaluate(S,I){const P=I&&I.properties?I.properties[i.property]:void 0;return P===void 0?E(i.default,r.default):m(i,r,P,x,b)}}}function E(i,r,s){return i!==void 0?i:r!==void 0?r:s!==void 0?s:void 0}function T(i,r,s,c,h){return E(typeof s===h?c[s]:void 0,i.default,r.default)}function M(i,r,s){if(Mu(s)!=="number")return E(i.default,r.default);const c=i.stops.length;if(c===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[c-1][0])return i.stops[c-1][1];const h=n0(i.stops.map(p=>p[0]),s);return i.stops[h][1]}function L(i,r,s){const c=i.base!==void 0?i.base:1;if(Mu(s)!=="number")return E(i.default,r.default);const h=i.stops.length;if(h===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[h-1][0])return i.stops[h-1][1];const p=n0(i.stops.map(I=>I[0]),s),m=function(I,P,D,F){const U=F-D,V=I-D;return U===0?0:P===1?V/U:(Math.pow(P,V)-1)/(Math.pow(P,U)-1)}(s,c,i.stops[p][0],i.stops[p+1][0]),x=i.stops[p][1],b=i.stops[p+1][1];let S=Km[r.type]||y;if(i.colorSpace&&i.colorSpace!=="rgb"){const I=$b[i.colorSpace];S=(P,D)=>I.reverse(I.interpolate(I.forward(P),I.forward(D),m))}return typeof x.evaluate=="function"?{evaluate(...I){const P=x.evaluate.apply(void 0,I),D=b.evaluate.apply(void 0,I);if(P!==void 0&&D!==void 0)return S(P,D,m)}}:S(x,b,m)}function B(i,r,s){return r.type==="color"?s=yn.parse(s):r.type==="formatted"?s=Vo.fromString(s.toString()):r.type==="resolvedImage"?s=gs.fromString(s.toString()):Mu(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0),E(s,i.default,r.default)}Qo.register(Ou,{error:[{kind:"error"},[vn],(i,[r])=>{throw new lo(r.evaluate(i))}],typeof:[vn,[mn],(i,[r])=>Ri(ji(r.evaluate(i)))],"to-rgba":[Ps(Kt,4),[ms],(i,[r])=>r.evaluate(i).toRenderColor(null).toArray()],rgb:[ms,[Kt,Kt,Kt],Kb],rgba:[ms,[Kt,Kt,Kt,Kt],Kb],hsl:[ms,[Kt,Kt,Kt],Yb],hsla:[ms,[Kt,Kt,Kt,Kt],Yb],has:{type:xn,overloads:[[[vn],(i,[r])=>Zb(r.evaluate(i),i.properties())],[[vn,Uh],(i,[r,s])=>Zb(r.evaluate(i),s.evaluate(i))]]},get:{type:mn,overloads:[[[vn],(i,[r])=>Yy(r.evaluate(i),i.properties())],[[vn,Uh],(i,[r,s])=>Yy(r.evaluate(i),s.evaluate(i))]]},"feature-state":[mn,[vn],(i,[r])=>Yy(r.evaluate(i),i.featureState||{})],properties:[Uh,[],i=>i.properties()],"geometry-type":[vn,[],i=>i.geometryType()],id:[mn,[],i=>i.id()],zoom:[Kt,[],i=>i.globals.zoom],pitch:[Kt,[],i=>i.globals.pitch||0],"distance-from-center":[Kt,[],i=>i.distanceFromCenter()],"measure-light":[Kt,[vn],(i,[r])=>i.measureLight(r.evaluate(i))],"heatmap-density":[Kt,[],i=>i.globals.heatmapDensity||0],"line-progress":[Kt,[],i=>i.globals.lineProgress||0],"raster-value":[Kt,[],i=>i.globals.rasterValue||0],"raster-particle-speed":[Kt,[],i=>i.globals.rasterParticleSpeed||0],"sky-radial-progress":[Kt,[],i=>i.globals.skyRadialProgress||0],accumulated:[mn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Kt,Lu(Kt),(i,r)=>{let s=0;for(const c of r)s+=c.evaluate(i);return s}],"*":[Kt,Lu(Kt),(i,r)=>{let s=1;for(const c of r)s*=c.evaluate(i);return s}],"-":{type:Kt,overloads:[[[Kt,Kt],(i,[r,s])=>r.evaluate(i)-s.evaluate(i)],[[Kt],(i,[r])=>-r.evaluate(i)]]},"/":[Kt,[Kt,Kt],(i,[r,s])=>r.evaluate(i)/s.evaluate(i)],"%":[Kt,[Kt,Kt],(i,[r,s])=>r.evaluate(i)%s.evaluate(i)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(i,[r,s])=>Math.pow(r.evaluate(i),s.evaluate(i))],sqrt:[Kt,[Kt],(i,[r])=>Math.sqrt(r.evaluate(i))],log10:[Kt,[Kt],(i,[r])=>Math.log(r.evaluate(i))/Math.LN10],ln:[Kt,[Kt],(i,[r])=>Math.log(r.evaluate(i))],log2:[Kt,[Kt],(i,[r])=>Math.log(r.evaluate(i))/Math.LN2],sin:[Kt,[Kt],(i,[r])=>Math.sin(r.evaluate(i))],cos:[Kt,[Kt],(i,[r])=>Math.cos(r.evaluate(i))],tan:[Kt,[Kt],(i,[r])=>Math.tan(r.evaluate(i))],asin:[Kt,[Kt],(i,[r])=>Math.asin(r.evaluate(i))],acos:[Kt,[Kt],(i,[r])=>Math.acos(r.evaluate(i))],atan:[Kt,[Kt],(i,[r])=>Math.atan(r.evaluate(i))],min:[Kt,Lu(Kt),(i,r)=>Math.min(...r.map(s=>s.evaluate(i)))],max:[Kt,Lu(Kt),(i,r)=>Math.max(...r.map(s=>s.evaluate(i)))],abs:[Kt,[Kt],(i,[r])=>Math.abs(r.evaluate(i))],round:[Kt,[Kt],(i,[r])=>{const s=r.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[Kt,[Kt],(i,[r])=>Math.floor(r.evaluate(i))],ceil:[Kt,[Kt],(i,[r])=>Math.ceil(r.evaluate(i))],"filter-==":[xn,[vn,mn],(i,[r,s])=>i.properties()[r.value]===s.value],"filter-id-==":[xn,[mn],(i,[r])=>i.id()===r.value],"filter-type-==":[xn,[vn],(i,[r])=>i.geometryType()===r.value],"filter-<":[xn,[vn,mn],(i,[r,s])=>{const c=i.properties()[r.value],h=s.value;return typeof c==typeof h&&c<h}],"filter-id-<":[xn,[mn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s<c}],"filter->":[xn,[vn,mn],(i,[r,s])=>{const c=i.properties()[r.value],h=s.value;return typeof c==typeof h&&c>h}],"filter-id->":[xn,[mn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s>c}],"filter-<=":[xn,[vn,mn],(i,[r,s])=>{const c=i.properties()[r.value],h=s.value;return typeof c==typeof h&&c<=h}],"filter-id-<=":[xn,[mn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s<=c}],"filter->=":[xn,[vn,mn],(i,[r,s])=>{const c=i.properties()[r.value],h=s.value;return typeof c==typeof h&&c>=h}],"filter-id->=":[xn,[mn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s>=c}],"filter-has":[xn,[mn],(i,[r])=>r.value in i.properties()],"filter-has-id":[xn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[xn,[Ps(vn)],(i,[r])=>r.value.indexOf(i.geometryType())>=0],"filter-id-in":[xn,[Ps(mn)],(i,[r])=>r.value.indexOf(i.id())>=0],"filter-in-small":[xn,[vn,Ps(mn)],(i,[r,s])=>s.value.indexOf(i.properties()[r.value])>=0],"filter-in-large":[xn,[vn,Ps(mn)],(i,[r,s])=>function(c,h,p,m){for(;p<=m;){const x=p+m>>1;if(h[x]===c)return!0;h[x]>c?m=x-1:p=x+1}return!1}(i.properties()[r.value],s.value,0,s.value.length-1)],all:{type:xn,overloads:[[[xn,xn],(i,[r,s])=>r.evaluate(i)&&s.evaluate(i)],[Lu(xn),(i,r)=>{for(const s of r)if(!s.evaluate(i))return!1;return!0}]]},any:{type:xn,overloads:[[[xn,xn],(i,[r,s])=>r.evaluate(i)||s.evaluate(i)],[Lu(xn),(i,r)=>{for(const s of r)if(s.evaluate(i))return!0;return!1}]]},"!":[xn,[xn],(i,[r])=>!r.evaluate(i)],"is-supported-script":[xn,[vn],(i,[r])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(r.evaluate(i))}],upcase:[vn,[vn],(i,[r])=>r.evaluate(i).toUpperCase()],downcase:[vn,[vn],(i,[r])=>r.evaluate(i).toLowerCase()],concat:[vn,Lu(mn),(i,r)=>r.map(s=>sa(s.evaluate(i))).join("")],"resolved-locale":[vn,[Aa],(i,[r])=>r.evaluate(i).resolvedLocale()],random:[Kt,[Kt,Kt,mn],(i,r)=>{const[s,c,h]=r.map(m=>m.evaluate(i));if(s>c||s===c)return s;let p;if(typeof h=="string")p=function(m){let x=0;if(m.length===0)return x;for(let b=0;b<m.length;b++)x=(x<<5)-x+m.charCodeAt(b),x|=0;return x}(h);else{if(typeof h!="number")throw new lo(`Invalid seed input: ${h}`);p=h}return s+qb(p)()*(c-s)}]});class ${constructor(r,s,c,h){this.expression=r,this._warningHistory={},this._evaluator=new Eb(c,h),this._defaultValue=s?function(p){return p.type==="color"&&(f(p.default)||Array.isArray(p.default))?new yn(0,0,0,0):p.type==="color"?yn.parse(p.default)||null:p.default===void 0?null:p.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,c,h,p,m,x,b){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,c,h,p,m,x,b){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=b||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new lo(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function G(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ou}function Z(i,r,s,c){const h=new Lb(Ou,[],r?function(m){const x={color:ms,string:vn,number:Kt,enum:vn,boolean:xn,formatted:$h,resolvedImage:cl};return m.type==="array"?Ps(x[m.value]||mn,m.length):x[m.type]}(r):void 0,void 0,void 0,s,c),p=h.parse(i,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Xb(new $(p,r,s,c)):Bu(h.errors)}class Q{constructor(r,s,c){this.kind=r,this._styleExpression=s,this.isLightConstant=c,this.isStateDependent=r!=="constant"&&!t0(s.expression),this.isConfigDependent=!zy(s.expression)}evaluateWithoutErrorHandling(r,s,c,h,p,m){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,h,p,m)}evaluate(r,s,c,h,p,m){return this._styleExpression.evaluate(r,s,c,h,p,m)}}class ne{constructor(r,s,c,h,p){this.kind=r,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!t0(s.expression),this.isLightConstant=p,this.isConfigDependent=!zy(s.expression),this.interpolationType=h}evaluateWithoutErrorHandling(r,s,c,h,p,m){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,h,p,m)}evaluate(r,s,c,h,p,m){return this._styleExpression.evaluate(r,s,c,h,p,m)}interpolationFactor(r,s,c){return this.interpolationType?Ws.interpolationFactor(this.interpolationType,r,s,c):0}}function ie(i,r,s,c){if((i=Z(i,r,s,c)).result==="error")return i;const h=i.value.expression,p=Bc(h);if(!p&&!h0(r))return Bu([new ll("","data expressions not supported")]);const m=Zf(h,["zoom","pitch","distance-from-center"]);if(!m&&!g(r))return Bu([new ll("","zoom expressions not supported")]);const x=Zf(h,["measure-light"]);if(!x&&!CI(r))return Bu([new ll("","measure-light expression not supported")]);const b=r.expression&&r.expression.relaxZoomRestriction,S=se(h);return S||m||b?S instanceof ll?Bu([S]):S instanceof Ws&&!l(r)?Bu([new ll("",'"interpolate" expressions cannot be used with this property')]):Xb(S?new ne(p?"camera":"composite",i.value,S.labels,S instanceof Ws?S.interpolation:void 0,x):new Q(p?"constant":"source",i.value,x)):Bu([new ll("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class oe{constructor(r,s){this._parameters=r,this._specification=s,by(this,w(this._parameters,this._specification))}static deserialize(r){return new oe(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function se(i){let r=null;if(i instanceof l0)r=se(i.result);else if(i instanceof a0){for(const s of i.args)if(r=se(s),r)break}else(i instanceof Jf||i instanceof Ws)&&i.input instanceof Qo&&i.input.name==="zoom"&&(r=i);return r instanceof ll||i.eachChild(s=>{const c=se(s);c instanceof ll?r=c:r&&c&&r!==c&&(r=new ll("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}var me=_e,ge=3;function _e(i,r,s){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var h=new Int32Array(this.arrayBuffer);i=h[0],this.d=(r=h[1])+2*(s=h[2]);for(var p=0;p<this.d*this.d;p++){var m=h[ge+p],x=h[ge+p+1];c.push(m===x?null:h.subarray(m,x))}var b=h[ge+c.length+1];this.keys=h.subarray(h[ge+c.length],b),this.bboxes=h.subarray(b),this.insert=this._insertReadonly}else{this.d=r+2*s;for(var S=0;S<this.d*this.d;S++)c.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=i,this.padding=s,this.scale=r/i,this.uid=0;var I=s/r*i;this.min=-I,this.max=i+I}_e.prototype.insert=function(i,r,s,c,h){this._forEachCell(r,s,c,h,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(h)},_e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_e.prototype._insertCell=function(i,r,s,c,h,p){this.cells[h].push(p)},_e.prototype.query=function(i,r,s,c,h){var p=this.min,m=this.max;if(i<=p&&r<=p&&m<=s&&m<=c&&!h)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(i,r,s,c,this._queryCell,x,{},h),x},_e.prototype._queryCell=function(i,r,s,c,h,p,m,x){var b=this.cells[h];if(b!==null)for(var S=this.keys,I=this.bboxes,P=0;P<b.length;P++){var D=b[P];if(m[D]===void 0){var F=4*D;(x?x(I[F+0],I[F+1],I[F+2],I[F+3]):i<=I[F+2]&&r<=I[F+3]&&s>=I[F+0]&&c>=I[F+1])?(m[D]=!0,p.push(S[D])):m[D]=!1}}},_e.prototype._forEachCell=function(i,r,s,c,h,p,m,x){for(var b=this._convertToCellCoord(i),S=this._convertToCellCoord(r),I=this._convertToCellCoord(s),P=this._convertToCellCoord(c),D=b;D<=I;D++)for(var F=S;F<=P;F++){var U=this.d*F+D;if((!x||x(this._convertFromCellCoord(D),this._convertFromCellCoord(F),this._convertFromCellCoord(D+1),this._convertFromCellCoord(F+1)))&&h.call(this,i,r,s,c,U,p,m,x))return}},_e.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},_e.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},_e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,r=ge+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var h=new Int32Array(r+s+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=r,m=0;m<i.length;m++){var x=i[m];h[ge+m]=p,h.set(x,p),p+=x.length}return h[ge+i.length]=p,h.set(this.keys,p),h[ge+i.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};var Pe=Y(me);const Te={};function pe(i,r,s={}){Object.defineProperty(i,"_classRegistryKey",{value:r,writable:!1}),Te[r]={klass:i,omit:s.omit||[]}}pe(Object,"Object"),Pe.serialize=function(i,r){const s=i.toArrayBuffer();return r&&r.add(s),{buffer:s}},Pe.deserialize=function(i){return new Pe(i.buffer)},Object.defineProperty(Pe,"name",{value:"Grid"}),pe(Pe,"Grid"),pe(yn,"Color"),pe(Error,"Error"),pe(Vo,"Formatted"),pe(Iu,"FormattedSection"),pe(fy,"AJAXError"),pe(gs,"ResolvedImage"),pe(oe,"StylePropertyFunction"),pe($,"StyleExpression",{omit:["_evaluator"]}),pe(ne,"ZoomDependentExpression"),pe(Q,"ZoomConstantExpression"),pe(Qo,"CompoundExpression",{omit:["_evaluate"]});for(const i in Ou)Te[Ou[i]._classRegistryKey]||pe(Ou[i],`Expression${i}`);function ye(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function ve(i){return self.ImageBitmap&&i instanceof ImageBitmap}function De(i,r){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(ye(i)||ve(i))return r&&r.add(i),i;if(ArrayBuffer.isView(i)){const s=i;return r&&r.add(s.buffer),s}if(i instanceof ImageData)return r&&r.add(i.data.buffer),i;if(Array.isArray(i)){const s=[];for(const c of i)s.push(De(c,r));return s}if(i instanceof Map){const s={$name:"Map"};for(const[c,h]of i.entries())s[c]=De(h);return s}if(typeof i=="object"){const s=i.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const h=s.serialize?s.serialize(i,r):{};if(!s.serialize){for(const p in i)i.hasOwnProperty(p)&&(Te[c].omit.indexOf(p)>=0||(h[p]=De(i[p],r)));i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(h.$name=c),h}throw new Error("can't serialize object of type "+typeof i)}function He(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||ye(i)||ve(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(He);if(typeof i=="object"){const r=i.$name||"Object";if(r==="Map"){const h=new Map;for(const p of Object.keys(i))p!=="$name"&&h.set(p,He(i[p]));return h}const{klass:s}=Te[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(i);const c=Object.create(s.prototype);for(const h of Object.keys(i))h!=="$name"&&(c[h]=He(i[h]));return c}throw new Error("can't deserialize object of type "+typeof i)}const Ee={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519,"CJK Unified Ideographs Extension B":i=>i>=131072&&i<=173791};function Ge(i){for(const r of i)if(xt(r.charCodeAt(0)))return!0;return!1}function Qe(i){for(const r of i)if(!_t(r.charCodeAt(0)))return!1;return!0}function _t(i){return!(Ee.Arabic(i)||Ee["Arabic Supplement"](i)||Ee["Arabic Extended-A"](i)||Ee["Arabic Presentation Forms-A"](i)||Ee["Arabic Presentation Forms-B"](i))}function xt(i){return!(i!==746&&i!==747&&(i<4352||!(Ee["Bopomofo Extended"](i)||Ee.Bopomofo(i)||Ee["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ee["CJK Compatibility Ideographs"](i)||Ee["CJK Compatibility"](i)||Ee["CJK Radicals Supplement"](i)||Ee["CJK Strokes"](i)||!(!Ee["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ee["CJK Unified Ideographs Extension A"](i)||Ee["CJK Unified Ideographs"](i)||Ee["Enclosed CJK Letters and Months"](i)||Ee["Hangul Compatibility Jamo"](i)||Ee["Hangul Jamo Extended-A"](i)||Ee["Hangul Jamo Extended-B"](i)||Ee["Hangul Jamo"](i)||Ee["Hangul Syllables"](i)||Ee.Hiragana(i)||Ee["Ideographic Description Characters"](i)||Ee.Kanbun(i)||Ee["Kangxi Radicals"](i)||Ee["Katakana Phonetic Extensions"](i)||Ee.Katakana(i)&&i!==12540||!(!Ee["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ee["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ee["Unified Canadian Aboriginal Syllabics"](i)||Ee["Unified Canadian Aboriginal Syllabics Extended"](i)||Ee["Vertical Forms"](i)||Ee["Yijing Hexagram Symbols"](i)||Ee["Yi Syllables"](i)||Ee["Yi Radicals"](i))))}function gt(i){return!(xt(i)||function(r){return!!(Ee["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Ee["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Ee["Letterlike Symbols"](r)||Ee["Number Forms"](r)||Ee["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Ee["Control Pictures"](r)&&r!==9251||Ee["Optical Character Recognition"](r)||Ee["Enclosed Alphanumerics"](r)||Ee["Geometric Shapes"](r)||Ee["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Ee["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ee["CJK Symbols and Punctuation"](r)||Ee.Katakana(r)||Ee["Private Use Area"](r)||Ee["CJK Compatibility Forms"](r)||Ee["Small Form Variants"](r)||Ee["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(i))}function Ue(i){return i>=1424&&i<=2303||Ee["Arabic Presentation Forms-A"](i)||Ee["Arabic Presentation Forms-B"](i)}function rt(i,r){return!(!r&&Ue(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ee.Khmer(i))}function pt(i){for(const r of i)if(Ue(r.charCodeAt(0)))return!0;return!1}const Ft="deferred",zt="loading",Gt="loaded";let Nt=null,St="unavailable",ut=null;const tr=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(St="error"),Nt&&Nt(i)};function $r(){Rr.fire(new ps("pluginStateChange",{pluginStatus:St,pluginURL:ut}))}const Rr=new Au,Zr=function(){return St},ln=function(){if(St!==Ft||!ut)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");St=zt,$r(),ut&&Su({url:ut},i=>{i?tr(i):(St=Gt,$r())})},Pn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>St===Gt||Pn.applyArabicShaping!=null,isLoading:()=>St===zt,setState(i){St=i.pluginStatus,ut=i.pluginURL},isParsed:()=>Pn.applyArabicShaping!=null&&Pn.processBidirectionalText!=null&&Pn.processStyledBidirectionalText!=null,getPluginURL:()=>ut};class Mr{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return function(s,c){for(const h of s)if(!rt(h.charCodeAt(0),c))return!1;return!0}(r,Pn.isLoaded())}}class En{constructor(r,s,c,h){this.property=r,this.value=s,this.expression=function(p,m,x,b){if(f(p))return new oe(p,m);if(G(p)||Array.isArray(p)&&p.length>0){const S=ie(p,m,x,b);if(S.result==="error")throw new Error(S.value.map(I=>`${I.key}: ${I.message}`).join(", "));return S.value}{let S=p;return typeof p=="string"&&m.type==="color"&&(S=yn.parse(p)),{kind:"constant",isConfigDependent:!1,evaluate:()=>S}}}(s===void 0?r.specification.default:s,r.specification,c,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,c){return this.property.possiblyEvaluate(this,r,s,c)}}class Un{constructor(r,s,c){this.property=r,this.value=new En(r,void 0,s,c)}transitioned(r,s){return new en(this.property,this.value,s,jo({},r.transition,this.transition),r.now)}untransitioned(){return new en(this.property,this.value,null,{},0)}}class In{constructor(r,s,c){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=s,this._options=c,this.isConfigDependent=!1}getValue(r){return sl(this._values[r].value.value)}setValue(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Un(this._values[r].property,this._scope,this._options)),this._values[r].value=new En(this._values[r].property,s===null?void 0:sl(s),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].value.expression.isConfigDependent}setTransitionOrValue(r,s){s&&(this._options=s);const c=this._properties.properties;if(r)for(const h in r){const p=r[h];if(Sf(h,"-transition")){const m=h.slice(0,-11);c[m]&&this.setTransition(m,p)}else c.hasOwnProperty(h)&&this.setValue(h,p)}}getTransition(r){return sl(this._values[r].transition)}setTransition(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Un(this._values[r].property)),this._values[r].transition=sl(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c);const h=this.getTransition(s);h!==void 0&&(r[`${s}-transition`]=h)}return r}transitioned(r,s){const c=new Br(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].transitioned(r,s._values[h]);return c}untransitioned(){const r=new Br(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class en{constructor(r,s,c,h,p){const m=h.delay||0,x=h.duration||0;p=p||0,this.property=r,this.value=s,this.begin=p+m,this.end=this.begin+x,r.specification.transition&&(h.delay||h.duration)&&(this.prior=c)}possiblyEvaluate(r,s,c){const h=r.now||0,p=this.value.possiblyEvaluate(r,s,c),m=this.prior;if(m){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return m.possiblyEvaluate(r,s,c);{const x=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(r,s,c),p,ey(x))}}return p}}class Br{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,c){const h=new Dn(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(r,s,c);return h}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Xn{constructor(r,s,c){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=s,this._options=c,this.isConfigDependent=!1}getValue(r){return sl(this._values[r].value)}setValue(r,s){this._values[r]=new En(this._values[r].property,s===null?void 0:sl(s),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].expression.isConfigDependent}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c)}return r}possiblyEvaluate(r,s,c){const h=new Dn(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(r,s,c);return h}}class Jn{constructor(r,s,c){this.property=r,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,c,h){return this.property.evaluate(this.value,this.parameters,r,s,c,h)}}class Dn{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class yt{constructor(r){this.specification=r}possiblyEvaluate(r,s){return r.expression.evaluate(s)}interpolate(r,s,c){const h=Km[this.specification.type];return h?h(r,s,c):r}}class jt{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,c,h){return new Jn(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},c,h)}:r.expression,s)}interpolate(r,s,c){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new Jn(this,{kind:"constant",value:void 0},r.parameters);const h=Km[this.specification.type];return h?new Jn(this,{kind:"constant",value:h(r.value.value,s.value.value,c)},r.parameters):r}evaluate(r,s,c,h,p,m){return r.kind==="constant"?r.value:r.evaluate(s,c,h,p,m)}}class ui{constructor(r){this.specification=r}possiblyEvaluate(r,s,c,h){return!!r.expression.evaluate(s,null,{},c,h)}interpolate(){return!1}}class Sn{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Mr(0,{});for(const c in r){const h=r[c];h.specification.overridable&&this.overridableProperties.push(c);const p=this.defaultPropertyValues[c]=new En(h,void 0),m=this.defaultTransitionablePropertyValues[c]=new Un(h);this.defaultTransitioningPropertyValues[c]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=p.possiblyEvaluate(s)}}}pe(jt,"DataDrivenProperty"),pe(yt,"DataConstantProperty"),pe(ui,"ColorRampProperty");var Ve=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function qs(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Po(i){if(Array.isArray(i))return i.map(Po);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const r={};for(const s in i)r[s]=Po(i[s]);return r}return qs(i)}function Jo(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const r of i.slice(1))if(!Jo(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function co(i,r="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Jo(i)||(i=hl(i));const s=i;let c=!0;try{c=function(S){if(!Ks(S))return S;let I=Po(S);return ka(I),I=ys(I),I}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const h=Ve[`filter_${r}`],p=Z(c,h);let m=null;if(p.result==="error")throw new Error(p.value.map(S=>`${S.key}: ${S.message}`).join(", "));m=(S,I,P)=>p.value.evaluate(S,I,{},P);let x=null,b=null;if(c!==s){const S=Z(s,h);if(S.result==="error")throw new Error(S.value.map(I=>`${I.key}: ${I.message}`).join(", "));x=(I,P,D,F,U)=>S.value.evaluate(I,P,{},D,void 0,void 0,F,U),b=!Bc(S.value.expression)}return{filter:m,dynamicFilter:x||void 0,needGeometry:ql(c),needFeature:!!b}}function ys(i){if(!Array.isArray(i))return i;const r=function(s){if(Fc.has(s[0])){for(let c=1;c<s.length;c++)if(Ks(s[c]))return!0}return s}(i);return r===!0?r:r.map(s=>ys(s))}function ka(i){let r=!1;const s=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)r=r||Ks(i[c]),s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="match"){r=r||Ks(i[1]);for(let c=2;c<i.length-1;c+=2)s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="step"){r=r||Ks(i[1]);for(let c=1;c<i.length-1;c+=2)s.push(i[c+1])}r&&(i.length=0,i.push("any",...s));for(let c=1;c<i.length;c++)ka(i[c])}function Ks(i){if(!Array.isArray(i))return!1;if((r=i[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let s=1;s<i.length;s++)if(Ks(i[s]))return!0;return!1}const Fc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function zc(i,r){return i<r?-1:i>r?1:0}function ql(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let r=1;r<i.length;r++)if(ql(i[r]))return!0;return!1}function hl(i){if(!i)return!0;const r=i[0];return i.length<=1?r!=="any":r==="=="?Kl(i[1],i[2],"=="):r==="!="?Fu(Kl(i[1],i[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Kl(i[1],i[2],r):r==="any"?(s=i.slice(1),["any"].concat(s.map(hl))):r==="all"?["all"].concat(i.slice(1).map(hl)):r==="none"?["all"].concat(i.slice(1).map(hl).map(Fu)):r==="in"?Yh(i[1],i.slice(2)):r==="!in"?Fu(Yh(i[1],i.slice(2))):r==="has"?Zh(i[1]):r!=="!has"||Fu(Zh(i[1]));var s}function Kl(i,r,s){switch(i){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,i,r]}}function Yh(i,r){if(r.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",i,["literal",r.sort(zc)]]:["filter-in-small",i,["literal",r]]}}function Zh(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Fu(i){return["!",i]}const Xh="";function d0(i,r){return r?`${i}${Xh}${r}`:i}const f0="-transition",Zy=new Set(["fill","line","background","hillshade","raster"]);class Qi extends Au{constructor(r,s,c,h,p){if(super(),this.id=r.id,this.fqid=d0(this.id,c),this.type=r.type,this.scope=c,this.lut=h,this.options=p,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&r.type!=="sky"&&r.type!=="slot"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),r.slot&&(this.slot=r.slot),s.layout&&(this._unevaluatedLayout=new Xn(s.layout,this.scope,p),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),s.paint)){this._transitionablePaint=new In(s.paint,this.scope,p);for(const m in r.paint)this.setPaintProperty(m,r.paint[m]);for(const m in r.layout)this.setLayoutProperty(m,r.layout[m]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Dn(s.paint)}}onAdd(r){}onRemove(r){}isDraped(r){return Zy.has(this.type)}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s){if(this.type==="custom"&&r==="visibility")return void(this.visibility=s);const c=this._unevaluatedLayout;c._properties.properties[r]&&(c.setValue(r,s),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,r==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(r){return Sf(r,f0)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s){const c=this._transitionablePaint,h=c._properties.properties;if(Sf(r,f0)){const P=r.slice(0,-11);return h[P]&&c.setTransition(P,s||void 0),!1}if(!h[r])return!1;const p=c._values[r],m=p.value.isDataDriven(),x=p.value;c.setValue(r,s),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(r);const b=c._values[r].value,S=b.isDataDriven(),I=Sf(r,"pattern")||r==="line-dasharray";return S||m||I||this._handleOverridablePaintPropertyUpdate(r,x,b)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,s,c){return null}_handleOverridablePaintPropertyUpdate(r,s,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){return Cu({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(r,s)=>!(r===void 0||s==="layout"&&!Object.keys(r).length||s==="paint"&&!Object.keys(r).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof Jn&&h0(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=co(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&(r.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(r){}queryIntersectsFeature(r,s,c,h,p,m,x,b,S){}queryIntersectsMatchingFeature(r,s,c,h){}}const Xy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Qh{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ni{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.add(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Tn(i,r=1){let s=0,c=0;return{members:i.map(h=>{const p=Xy[h.type].BYTES_PER_ELEMENT,m=s=PL(s,Math.max(r,p)),x=h.components||1;return c=Math.max(c,p),s+=p*x,{name:h.name,type:h.type,components:x,offset:m}}),size:PL(s,Math.max(c,r)),alignment:r}}function PL(i,r){return Math.ceil(i/r)*r}class Yl extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const h=2*r;return this.int16[h+0]=s,this.int16[h+1]=c,r}}Yl.prototype.bytesPerElement=4,pe(Yl,"StructArrayLayout2i4");class Jb extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,c)}emplace(r,s,c,h){const p=3*r;return this.int16[p+0]=s,this.int16[p+1]=c,this.int16[p+2]=h,r}}Jb.prototype.bytesPerElement=6,pe(Jb,"StructArrayLayout3i6");class Jh extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,c,h)}emplace(r,s,c,h,p){const m=4*r;return this.int16[m+0]=s,this.int16[m+1]=c,this.int16[m+2]=h,this.int16[m+3]=p,r}}Jh.prototype.bytesPerElement=8,pe(Jh,"StructArrayLayout4i8");class EI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,h,p)}emplace(r,s,c,h,p,m){const x=5*r;return this.int16[x+0]=s,this.int16[x+1]=c,this.int16[x+2]=h,this.int16[x+3]=p,this.int16[x+4]=m,r}}EI.prototype.bytesPerElement=10,pe(EI,"StructArrayLayout5i10");class SI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,c,h,p,m,x)}emplace(r,s,c,h,p,m,x,b){const S=6*r,I=12*r,P=3*r;return this.int16[S+0]=s,this.int16[S+1]=c,this.uint8[I+4]=h,this.uint8[I+5]=p,this.uint8[I+6]=m,this.uint8[I+7]=x,this.float32[P+2]=b,r}}SI.prototype.bytesPerElement=12,pe(SI,"StructArrayLayout2i4ub1f12");class ed extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,c,h)}emplace(r,s,c,h,p){const m=4*r;return this.float32[m+0]=s,this.float32[m+1]=c,this.float32[m+2]=h,this.float32[m+3]=p,r}}ed.prototype.bytesPerElement=16,pe(ed,"StructArrayLayout4f16");class td extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,c)}emplace(r,s,c,h){const p=3*r;return this.float32[p+0]=s,this.float32[p+1]=c,this.float32[p+2]=h,r}}td.prototype.bytesPerElement=12,pe(td,"StructArrayLayout3f12");class rd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,h,p)}emplace(r,s,c,h,p,m){const x=6*r,b=3*r;return this.uint16[x+0]=s,this.uint16[x+1]=c,this.uint16[x+2]=h,this.uint16[x+3]=p,this.float32[b+2]=m,r}}rd.prototype.bytesPerElement=12,pe(rd,"StructArrayLayout4ui1f12");class ew extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,c,h)}emplace(r,s,c,h,p){const m=4*r;return this.uint16[m+0]=s,this.uint16[m+1]=c,this.uint16[m+2]=h,this.uint16[m+3]=p,r}}ew.prototype.bytesPerElement=8,pe(ew,"StructArrayLayout4ui8");class tw extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,c,h,p,m)}emplace(r,s,c,h,p,m,x){const b=6*r;return this.int16[b+0]=s,this.int16[b+1]=c,this.int16[b+2]=h,this.int16[b+3]=p,this.int16[b+4]=m,this.int16[b+5]=x,r}}tw.prototype.bytesPerElement=12,pe(tw,"StructArrayLayout6i12");class TI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x,b,S,I,P,D){const F=this.length;return this.resize(F+1),this.emplace(F,r,s,c,h,p,m,x,b,S,I,P,D)}emplace(r,s,c,h,p,m,x,b,S,I,P,D,F){const U=12*r;return this.int16[U+0]=s,this.int16[U+1]=c,this.int16[U+2]=h,this.int16[U+3]=p,this.uint16[U+4]=m,this.uint16[U+5]=x,this.uint16[U+6]=b,this.uint16[U+7]=S,this.int16[U+8]=I,this.int16[U+9]=P,this.int16[U+10]=D,this.int16[U+11]=F,r}}TI.prototype.bytesPerElement=24,pe(TI,"StructArrayLayout4i4ui4i24");class AI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,c,h,p,m)}emplace(r,s,c,h,p,m,x){const b=10*r,S=5*r;return this.int16[b+0]=s,this.int16[b+1]=c,this.int16[b+2]=h,this.float32[S+2]=p,this.float32[S+3]=m,this.float32[S+4]=x,r}}AI.prototype.bytesPerElement=20,pe(AI,"StructArrayLayout3i3f20");class II extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}II.prototype.bytesPerElement=4,pe(II,"StructArrayLayout1ul4");class ip extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}ip.prototype.bytesPerElement=4,pe(ip,"StructArrayLayout1f4");class nd extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const h=2*r;return this.uint16[h+0]=s,this.uint16[h+1]=c,r}}nd.prototype.bytesPerElement=4,pe(nd,"StructArrayLayout2ui4");class MI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x,b,S,I,P,D,F){const U=this.length;return this.resize(U+1),this.emplace(U,r,s,c,h,p,m,x,b,S,I,P,D,F)}emplace(r,s,c,h,p,m,x,b,S,I,P,D,F,U){const V=20*r,W=10*r;return this.int16[V+0]=s,this.int16[V+1]=c,this.int16[V+2]=h,this.int16[V+3]=p,this.int16[V+4]=m,this.float32[W+3]=x,this.float32[W+4]=b,this.float32[W+5]=S,this.float32[W+6]=I,this.int16[V+14]=P,this.uint32[W+8]=D,this.uint16[V+18]=F,this.uint16[V+19]=U,r}}MI.prototype.bytesPerElement=40,pe(MI,"StructArrayLayout5i4f1i1ul2ui40");class rw extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,c,h,p,m,x)}emplace(r,s,c,h,p,m,x,b){const S=8*r;return this.int16[S+0]=s,this.int16[S+1]=c,this.int16[S+2]=h,this.int16[S+4]=p,this.int16[S+5]=m,this.int16[S+6]=x,this.int16[S+7]=b,r}}rw.prototype.bytesPerElement=16,pe(rw,"StructArrayLayout3i2i2i16");class PI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,h,p)}emplace(r,s,c,h,p,m){const x=4*r,b=8*r;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=h,this.int16[b+6]=p,this.int16[b+7]=m,r}}PI.prototype.bytesPerElement=16,pe(PI,"StructArrayLayout2f1f2i16");class RI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,c,h)}emplace(r,s,c,h,p){const m=12*r,x=3*r;return this.uint8[m+0]=s,this.uint8[m+1]=c,this.float32[x+1]=h,this.float32[x+2]=p,r}}RI.prototype.bytesPerElement=12,pe(RI,"StructArrayLayout2ub2f12");class vo extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,c)}emplace(r,s,c,h){const p=3*r;return this.uint16[p+0]=s,this.uint16[p+1]=c,this.uint16[p+2]=h,r}}vo.prototype.bytesPerElement=6,pe(vo,"StructArrayLayout3ui6");class kI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se){const be=this.length;return this.resize(be+1),this.emplace(be,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se)}emplace(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se,be){const ke=30*r,Le=15*r,je=60*r;return this.int16[ke+0]=s,this.int16[ke+1]=c,this.int16[ke+2]=h,this.float32[Le+2]=p,this.float32[Le+3]=m,this.uint16[ke+8]=x,this.uint16[ke+9]=b,this.uint32[Le+5]=S,this.uint32[Le+6]=I,this.uint32[Le+7]=P,this.uint16[ke+16]=D,this.uint16[ke+17]=F,this.uint16[ke+18]=U,this.float32[Le+10]=V,this.float32[Le+11]=W,this.uint8[je+48]=ee,this.uint8[je+49]=ce,this.uint8[je+50]=ue,this.uint32[Le+13]=he,this.int16[ke+28]=Se,this.uint8[je+58]=be,r}}kI.prototype.bytesPerElement=60,pe(kI,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class DI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se,be,ke,Le,je,ot,Ze,dt,At,ct,bt,st,wt,Pt){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se,be,ke,Le,je,ot,Ze,dt,At,ct,bt,st,wt,Pt)}emplace(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee,ce,ue,he,Se,be,ke,Le,je,ot,Ze,dt,At,ct,bt,st,wt,Pt,Tt){const Ht=22*r,It=44*r,Dt=88*r;return this.float32[Ht+0]=s,this.float32[Ht+1]=c,this.int16[It+4]=h,this.int16[It+5]=p,this.int16[It+6]=m,this.int16[It+7]=x,this.int16[It+8]=b,this.int16[It+9]=S,this.int16[It+10]=I,this.int16[It+11]=P,this.int16[It+12]=D,this.uint16[It+13]=F,this.uint16[It+14]=U,this.uint16[It+15]=V,this.uint16[It+16]=W,this.uint16[It+17]=ee,this.uint16[It+18]=ce,this.uint16[It+19]=ue,this.uint16[It+20]=he,this.uint16[It+21]=Se,this.uint16[It+22]=be,this.uint16[It+23]=ke,this.uint16[It+24]=Le,this.uint16[It+25]=je,this.uint16[It+26]=ot,this.uint16[It+27]=Ze,this.uint32[Ht+14]=dt,this.float32[Ht+15]=At,this.float32[Ht+16]=ct,this.float32[Ht+17]=bt,this.float32[Ht+18]=st,this.float32[Ht+19]=wt,this.float32[Ht+20]=Pt,this.uint8[Dt+84]=Tt,r}}DI.prototype.bytesPerElement=88,pe(DI,"StructArrayLayout2f9i15ui1ul6f1ub88");class op extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,h,p)}emplace(r,s,c,h,p,m){const x=5*r;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=h,this.float32[x+3]=p,this.float32[x+4]=m,r}}op.prototype.bytesPerElement=20,pe(op,"StructArrayLayout5f20");class OI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,c,h,p,m,x)}emplace(r,s,c,h,p,m,x,b){const S=7*r;return this.float32[S+0]=s,this.float32[S+1]=c,this.float32[S+2]=h,this.float32[S+3]=p,this.float32[S+4]=m,this.float32[S+5]=x,this.float32[S+6]=b,r}}OI.prototype.bytesPerElement=28,pe(OI,"StructArrayLayout7f28");class p0 extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const h=2*r;return this.float32[h+0]=s,this.float32[h+1]=c,r}}p0.prototype.bytesPerElement=8,pe(p0,"StructArrayLayout2f8");class LI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,c,h)}emplace(r,s,c,h,p){const m=6*r;return this.uint32[3*r+0]=s,this.uint16[m+2]=c,this.uint16[m+3]=h,this.uint16[m+4]=p,r}}LI.prototype.bytesPerElement=12,pe(LI,"StructArrayLayout1ul3ui12");class Qy extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}Qy.prototype.bytesPerElement=2,pe(Qy,"StructArrayLayout1ui2");class BI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W){const ee=this.length;return this.resize(ee+1),this.emplace(ee,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W)}emplace(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee){const ce=16*r;return this.float32[ce+0]=s,this.float32[ce+1]=c,this.float32[ce+2]=h,this.float32[ce+3]=p,this.float32[ce+4]=m,this.float32[ce+5]=x,this.float32[ce+6]=b,this.float32[ce+7]=S,this.float32[ce+8]=I,this.float32[ce+9]=P,this.float32[ce+10]=D,this.float32[ce+11]=F,this.float32[ce+12]=U,this.float32[ce+13]=V,this.float32[ce+14]=W,this.float32[ce+15]=ee,r}}BI.prototype.bytesPerElement=64,pe(BI,"StructArrayLayout16f64");class nw extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,h,p,m,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,c,h,p,m,x)}emplace(r,s,c,h,p,m,x,b){const S=10*r,I=5*r;return this.uint16[S+0]=s,this.uint16[S+1]=c,this.uint16[S+2]=h,this.uint16[S+3]=p,this.float32[I+2]=m,this.float32[I+3]=x,this.float32[I+4]=b,r}}nw.prototype.bytesPerElement=20,pe(nw,"StructArrayLayout4ui3f20");class FI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.int16[1*r+0]=s,r}}FI.prototype.bytesPerElement=2,pe(FI,"StructArrayLayout1i2");class zI extends ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint8[1*r+0]=s,r}}zI.prototype.bytesPerElement=1,pe(zI,"StructArrayLayout1ub1");class RL extends Qh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}RL.prototype.size=40;class NI extends MI{get(r){return new RL(this,r)}}pe(NI,"CollisionBoxArray");class kL extends Qh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}kL.prototype.size=60;class DL extends kI{get(r){return new kL(this,r)}}pe(DL,"PlacedSymbolArray");class OL extends Qh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get occlusionState(){return this._structArray.float32[this._pos4+19]}set occlusionState(r){this._structArray.float32[this._pos4+19]=r}get occlusionOpacity(){return this._structArray.float32[this._pos4+20]}set occlusionOpacity(r){this._structArray.float32[this._pos4+20]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+84]}}OL.prototype.size=88;class LL extends DI{get(r){return new OL(this,r)}}pe(LL,"SymbolInstanceArray");class BL extends ip{getoffsetX(r){return this.float32[1*r+0]}}pe(BL,"GlyphOffsetArray");class FL extends Yl{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}pe(FL,"SymbolLineVertexArray");class zL extends Qh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}zL.prototype.size=12;class NL extends LI{get(r){return new zL(this,r)}}pe(NL,"FeatureIndexArray");class UL extends nd{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}pe(UL,"FillExtrusionCentroidArray");const cZ=Tn([{name:"a_pos",components:2,type:"Int16"}],4),uZ=Tn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class hi{constructor(r=[]){this.segments=r}_prepareSegment(r,s,c,h){let p=this.segments[this.segments.length-1];return r>hi.MAX_VERTEX_ARRAY_LENGTH&&Pi(`Max vertices per segment is ${hi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!p||p.vertexLength+r>hi.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:s,primitiveOffset:c,vertexLength:0,primitiveLength:0},h!==void 0&&(p.sortKey=h),this.segments.push(p)),p}prepareSegment(r,s,c,h){return this._prepareSegment(r,s.length,c.length,h)}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,c,h){return new hi([{vertexOffset:r,primitiveOffset:s,vertexLength:c,primitiveLength:h,vaos:{},sortKey:0}])}}function $L(i,r){return 256*(i=Kr(Math.floor(i),0,255))+Kr(Math.floor(r),0,255)}hi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pe(hi,"SegmentVector");const hZ=Tn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),dZ=Tn([{name:"a_dash",components:4,type:"Uint16"}]);class Jy{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,s,c,h){this.ids.push(jL(r)),this.positions.push(s,c,h)}eachPosition(r,s){const c=jL(r);let h=0,p=this.ids.length-1;for(;h<p;){const m=h+p>>1;this.ids[m]>=c?p=m:h=m+1}for(;this.ids[h]===c;)s(this.positions[3*h],this.positions[3*h+1],this.positions[3*h+2]),h++}static serialize(r,s){const c=new Float64Array(r.ids),h=new Uint32Array(r.positions);return UI(c,h,0,c.length-1),s&&(s.add(c.buffer),s.add(h.buffer)),{ids:c,positions:h}}static deserialize(r){const s=new Jy;let c;s.ids=r.ids,s.positions=r.positions;for(const h of s.ids)h!==c&&s.uniqueIds.push(h),c=h;return s.indexed=!0,s}}function jL(i){const r=+i;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Fh(String(i))}function UI(i,r,s,c){for(;s<c;){const h=i[s+c>>1];let p=s-1,m=c+1;for(;;){do p++;while(i[p]<h);do m--;while(i[m]>h);if(p>=m)break;iw(i,p,m),iw(r,3*p,3*m),iw(r,3*p+1,3*m+1),iw(r,3*p+2,3*m+2)}m-s<c-m?(UI(i,r,s,m),s=m+1):(UI(i,r,m+1,c),c=m)}}function iw(i,r,s){const c=i[r];i[r]=i[s],i[s]=c}pe(Jy,"FeaturePositionMap");class zu{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,s),this.initialized=!0),!!this.location}set(r,s,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ow extends zu{constructor(r){super(r),this.current=0}set(r,s,c){this.fetchUniformLocation(r,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class Rs extends zu{constructor(r){super(r),this.current=0}set(r,s,c){this.fetchUniformLocation(r,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Nu extends zu{constructor(r){super(r),this.current=[0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class $I extends zu{constructor(r){super(r),this.current=[0,0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class jI extends zu{constructor(r){super(r),this.current=[0,0,0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class VL extends zu{constructor(r){super(r),this.current=yn.transparent.toRenderColor(null)}set(r,s,c){this.fetchUniformLocation(r,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const fZ=new Float32Array(16);class ev extends zu{constructor(r){super(r),this.current=fZ}set(r,s,c){if(this.fetchUniformLocation(r,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let h=1;h<16;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const pZ=new Float32Array(9),mZ=new Float32Array(4);class VI extends zu{constructor(r){super(r),this.current=mZ}set(r,s,c){if(this.fetchUniformLocation(r,s)){for(let h=0;h<4;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function HI(i){return[$L(255*i.r,255*i.g),$L(255*i.b,255*i.a)]}class tv{constructor(r,s,c,h){this.value=r,this.uniformNames=s.map(p=>`u_${p}`),this.type=c,this.context=h}setUniform(r,s,c,h,p){const m=h.constantOr(this.value);s.set(r,p,m instanceof yn?m.toRenderColor(this.context.lut):m)}getBinding(r,s){return this.type==="color"?new VL(r):new Rs(r)}}class m0{constructor(r,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,s,c,h,p){const m=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;m&&s.set(r,p,m)}getBinding(r,s){return s==="u_pattern"||s==="u_dash"?new jI(r):new Rs(r)}}class Uu{constructor(r,s,c,h){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(p=>({name:`a_${p}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(r,s,c,h,p,m,x){const b=this.paintVertexArray.length,S=this.expression.evaluate(new Mr(0,{brightness:m}),s,{},p,h,x);this.paintVertexArray.resize(r),this._setPaintValue(b,r,S,this.context)}updatePaintArray(r,s,c,h,p,m,x){const b=this.expression.evaluate({zoom:0,brightness:x},c,h,void 0,p);this._setPaintValue(r,s,b,this.context)}_setPaintValue(r,s,c,h){if(this.type==="color"){const p=HI(c.toRenderColor(h.lut));for(let m=r;m<s;m++)this.paintVertexArray.emplace(m,p[0],p[1])}else{for(let p=r;p<s;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zl{constructor(r,s,c,h,p,m){this.expression=r,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=c,this.useIntegerZoom=h,this.context=p,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(r,s,c,h,p,m,x){const b=this.expression.evaluate(new Mr(this.context.zoom,{brightness:m}),s,{},p,h,x),S=this.expression.evaluate(new Mr(this.context.zoom+1,{brightness:m}),s,{},p,h,x),I=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(I,r,b,S,this.context)}updatePaintArray(r,s,c,h,p,m,x){const b=this.expression.evaluate({zoom:this.context.zoom,brightness:x},c,h,void 0,p),S=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x},c,h,void 0,p);this._setPaintValue(r,s,b,S,this.context)}_setPaintValue(r,s,c,h,p){if(this.type==="color"){const m=HI(c.toRenderColor(p.lut)),x=HI(c.toRenderColor(p.lut));for(let b=r;b<s;b++)this.paintVertexArray.emplace(b,m[0],m[1],x[0],x[1])}else{for(let m=r;m<s;m++)this.paintVertexArray.emplace(m,c,h);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s,c,h,p){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=Kr(this.expression.interpolationFactor(m,this.context.zoom,this.context.zoom+1),0,1);s.set(r,p,x)}getBinding(r,s){return new Rs(r)}}class id{constructor(r,s,c,h,p){this.expression=r,this.layerId=p,this.paintVertexAttributes=(c==="array"?dZ:hZ).members;for(let m=0;m<s.length;++m);this.paintVertexArray=new h}populatePaintArray(r,s,c,h){const p=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(p,r,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(r,s,c,h,p,m,x){this._setPaintValues(r,s,c.patterns&&c.patterns[this.layerId],m)}_setPaintValues(r,s,c,h){if(!h||!c)return;const p=h[c];if(!p)return;const{tl:m,br:x,pixelRatio:b}=p;for(let S=r;S<s;S++)this.paintVertexArray.emplace(S,m[0],m[1],x[0],x[1],b)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sp{constructor(r,s,c=()=>!0){this.binders={},this._buffers=[],this.context=s;const h=[];for(const p in r.paint._values){const m=r.paint.get(p);if(!c(p)||!(m instanceof Jn&&h0(m.property.specification)))continue;const x=_Z(p,r.type),b=m.value,S=m.property.specification.type,I=!!m.property.useIntegerZoom,P=p==="line-dasharray"||p.endsWith("pattern"),D=p==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||D)if(b.kind==="source"||D||P){const F=HL(p,S,"source");this.binders[p]=P?new id(b,x,S,F,r.id):new Uu(b,x,S,F),h.push(`/a_${p}`)}else{const F=HL(p,S,"composite");this.binders[p]=new Zl(b,x,S,I,s,F),h.push(`/z_${p}`)}else this.binders[p]=P?new m0(b.value,x):new tv(b.value,x,S,s),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof Uu||s instanceof Zl?s.maxValue:0}populatePaintArrays(r,s,c,h,p,m,x){for(const b in this.binders){const S=this.binders[b];S.context=this.context,(S instanceof Uu||S instanceof Zl||S instanceof id)&&S.populatePaintArray(r,s,c,h,p,m,x)}}setConstantPatternPositions(r){for(const s in this.binders){const c=this.binders[s];c instanceof m0&&c.setConstantPatternPositions(r)}}updatePaintArrays(r,s,c,h,p,m,x,b){let S=!1;const I=Object.keys(r),P=I.length!==0,D=P?I:s.uniqueIds;this.context.lut=p.lut;for(const F in this.binders){const U=this.binders[F];if(U.context=this.context,(U instanceof Uu||U instanceof Zl||U instanceof id)&&(U.expression.isStateDependent===!0||U.expression.isLightConstant===!1)){const V=p.paint.get(F);U.expression=V.value;for(const W of D){const ee=r[W.toString()];s.eachPosition(W,(ce,ue,he)=>{const Se=h.feature(ce);U.updatePaintArray(ue,he,Se,ee,m,x,b)})}if(!P)for(const W of c.uniqueIds){const ee=r[W.toString()];c.eachPosition(W,(ce,ue,he)=>{const Se=h.feature(ce);U.updatePaintArray(ue,he,Se,ee,m,x,b)})}S=!0}}return S}defines(){const r=[];for(const s in this.binders){const c=this.binders[s];(c instanceof tv||c instanceof m0)&&r.push(...c.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Uu||c instanceof Zl||c instanceof id)for(let h=0;h<c.paintVertexAttributes.length;h++)r.push(c.paintVertexAttributes[h].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof tv||c instanceof m0||c instanceof Zl)for(const h of c.uniformNames)r.push(h)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof tv||h instanceof m0||h instanceof Zl)for(const p of h.uniformNames)s.push({name:p,property:c,binding:h.getBinding(r,p)})}return s}setUniforms(r,s,c,h,p){for(const{name:m,property:x,binding:b}of c)this.binders[x].setUniform(r,b,p,h.get(x),m)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Uu||s instanceof Zl||s instanceof id)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(r){for(const s in this.binders){const c=this.binders[s];(c instanceof Uu||c instanceof Zl||c instanceof id)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof Uu||s instanceof Zl||s instanceof id)&&s.destroy()}}}class od{constructor(r,s,c=()=>!0){this.programConfigurations={};for(const h of r)this.programConfigurations[h.id]=new sp(h,s,c);this.needsUpload=!1,this._featureMap=new Jy,this._featureMapWithoutIds=new Jy,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,s,c,h,p,m,x,b){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(r,s,h,p,m,x,b);s.id!==void 0?this._featureMap.add(s.id,c,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,c,h,p,m){for(const x of c)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,s,x,h,p,m||0)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const gZ={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function _Z(i,r){return gZ[i]||[i.replace(`${r}-`,"").replace(/-/g,"_")]}const yZ={"line-pattern":{source:rd,composite:rd},"fill-pattern":{source:rd,composite:rd},"fill-extrusion-pattern":{source:rd,composite:rd},"line-dasharray":{source:ew,composite:ew}},vZ={color:{source:p0,composite:ed},number:{source:ip,composite:p0}};function HL(i,r,s){const c=yZ[i];return c&&c[s]||vZ[r][s]}pe(tv,"ConstantBinder"),pe(m0,"PatternConstantBinder"),pe(Uu,"SourceExpressionBinder"),pe(id,"PatternCompositeBinder"),pe(Zl,"CompositeExpressionBinder"),pe(sp,"ProgramConfiguration",{omit:["_buffers"]}),pe(od,"ProgramConfigurationSet");const ks=Bt/Math.PI/2,GI=5,GL=6,xZ=16383,g0=64,WI=[g0,32,16],dl=-ks,fl=ks;function _0(i,r,s,c=ks){return s=an(s),[i*Math.sin(s)*c,-r*c,i*Math.cos(s)*c]}function ap(i,r,s){return _0(Math.cos(an(i)),Math.sin(an(i)),r,s)}const y0=63710088e-1,qI=2*Math.PI*y0;class gn{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new gn(wu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,c=this.lat*s,h=r.lat*s,p=Math.sin(c)*Math.sin(h)+Math.cos(c)*Math.cos(h)*Math.cos((r.lng-this.lng)*s);return y0*Math.acos(Math.min(p,1))}toBounds(r=0){const s=360*r/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new sd({lng:this.lng-c,lat:this.lat-s},{lng:this.lng+c,lat:this.lat+s})}toEcef(r){return ap(this.lat,this.lng,ks+r*ks/y0)}static convert(r){if(r instanceof gn)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new gn(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new gn(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class sd{constructor(r,s){if(r)if(s)this.setSouthWest(r).setNorthEast(s);else if(r.length===4){const c=r;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=r;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(r){return this._ne=r instanceof gn?new gn(r.lng,r.lat):gn.convert(r),this}setSouthWest(r){return this._sw=r instanceof gn?new gn(r.lng,r.lat):gn.convert(r),this}extend(r){const s=this._sw,c=this._ne;let h,p;if(r instanceof gn)h=r,p=r;else{if(!(r instanceof sd))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(sd.convert(r)):this.extend(gn.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(gn.convert(r)):this;if(h=r._sw,p=r._ne,!h||!p)return this}return s||c?(s.lng=Math.min(h.lng,s.lng),s.lat=Math.min(h.lat,s.lat),c.lng=Math.max(p.lng,c.lng),c.lat=Math.max(p.lat,c.lat)):(this._sw=new gn(h.lng,h.lat),this._ne=new gn(p.lng,p.lat)),this}getCenter(){return new gn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new gn(this.getWest(),this.getNorth())}getSouthEast(){return new gn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:c}=gn.convert(r);let h=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(r){return!r||r instanceof sd?r:new sd(r)}}var WL={};(function(i,r){(function(s){function c(p,m,x){var b=h(256*p,256*(m=Math.pow(2,x)-m-1),x),S=h(256*(p+1),256*(m+1),x);return b[0]+","+b[1]+","+S[0]+","+S[1]}function h(p,m,x){var b=2*Math.PI*6378137/256/Math.pow(2,x);return[p*b-2*Math.PI*6378137/2,m*b-2*Math.PI*6378137/2]}s.getURL=function(p,m,x,b,S,I){return I=I||{},p+"?"+["bbox="+c(x,b,S),"format="+(I.format||"image/png"),"service="+(I.service||"WMS"),"version="+(I.version||"1.1.1"),"request="+(I.request||"GetMap"),"srs="+(I.srs||"EPSG:3857"),"width="+(I.width||256),"height="+(I.height||256),"layers="+m].join("&")},s.getTileBBox=c,s.getMercCoords=h,Object.defineProperty(s,"__esModule",{value:!0})})(r)})(0,WL);var bZ=WL;class lp{constructor(r,s,c){this.z=r,this.x=s,this.y=c,this.key=rv(0,r,r,s,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s){const c=bZ.getTileBBox(this.x,this.y,this.z),h=function(p,m,x){let b,S="";for(let I=p;I>0;I--)b=1<<I-1,S+=(m&b?1:0)+(x&b?2:0);return S}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qL{constructor(r,s){this.wrap=r,this.canonical=s,this.key=rv(r,s.z,s.z,s.x,s.y)}}class Ji{constructor(r,s,c,h,p){this.overscaledZ=r,this.wrap=s,this.canonical=new lp(c,+h,+p),this.key=s===0&&r===c?this.canonical.key:rv(s,r,c,h,p)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const s=this.canonical.z-r;return r>this.canonical.z?new Ji(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ji(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s=!0){if(this.overscaledZ===r&&s)return this.key;if(r>this.canonical.z)return rv(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-r;return rv(this.wrap*+s,r,r,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ji(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,h=2*this.canonical.y;return[new Ji(s,this.wrap,s,c,h),new Ji(s,this.wrap,s,c+1,h),new Ji(s,this.wrap,s,c,h+1),new Ji(s,this.wrap,s,c+1,h+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ji(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ji(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qL(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function rv(i,r,s,c,h){const p=1<<Math.min(s,22);let m=p*(h%p)+c%p;return i&&s<22&&(m+=p*p*((i<0?-2*i-1:2*i)%(1<<2*(22-s)))),16*(32*m+s)+(r-s)}const wZ=[i=>{let r=i.canonical.x-1,s=i.wrap;return r<0&&(r=(1<<i.canonical.z)-1,s--),new Ji(i.overscaledZ,s,i.canonical.z,r,i.canonical.y)},i=>{let r=i.canonical.x+1,s=i.wrap;return r===1<<i.canonical.z&&(r=0,s++),new Ji(i.overscaledZ,s,i.canonical.z,r,i.canonical.y)},i=>new Ji(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,(i.canonical.y===0?1<<i.canonical.z:i.canonical.y)-1),i=>new Ji(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y===(1<<i.canonical.z)-1?0:i.canonical.y+1)];pe(lp,"CanonicalTileID"),pe(Ji,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const CZ=0,EZ=25.5;function KI(i){return qI*Math.cos(i*Math.PI/180)}function Nc(i){return(180+i)/360}function Uc(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Ds(i,r){return i/KI(r)}function Ys(i){return 360*i-180}function Ro(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function KL(i,r){return i*KI(Ro(r))}const ki=85.051129;function YL(i){return Math.cos(an(Kr(i,-ki,ki)))}function cp(i,r){const s=Kr(r,CZ,EZ),c=Math.pow(2,s);return YL(i)*qI/(512*c)}function ZL(i){return 1/Math.cos(i*Math.PI/180)}function sw(i,r=0){const s=Math.exp(Math.PI*(1-(i.y+r/Bt)/(1<<i.z)*2));return 80150034*s/(s*s+1)/Bt/(1<<i.z)}class es{constructor(r,s,c=0){this.x=+r,this.y=+s,this.z=+c}static fromLngLat(r,s=0){const c=gn.convert(r);return new es(Nc(c.lng),Uc(c.lat),Ds(s,c.lat))}toLngLat(){return new gn(Ys(this.x),Ro(this.y))}toAltitude(){return KL(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/qI*ZL(Ro(this.y))}}function YI(i,r,s,c,h,p,m,x,b){const S=(r+c)/2,I=(s+h)/2,P=new Ut(S,I);x(P),function(D,F,U,V,W,ee){const ce=U-W,ue=V-ee;return Math.abs((V-F)*ce-(U-D)*ue)/Math.hypot(ce,ue)}(P.x,P.y,p.x,p.y,m.x,m.y)>=b?(YI(i,r,s,S,I,p,P,x,b),YI(i,S,I,c,h,P,m,x,b)):i.push(m)}function XL(i,r,s){let c=i[0],h=c.x,p=c.y;r(c);const m=[c];for(let x=1;x<i.length;x++){const b=i[x],{x:S,y:I}=b;r(b),YI(m,h,p,S,I,c,b,r,s),h=S,p=I,c=b}return m}function ZI(i,r,s,c){if(c(r,s)){const h=r.add(s)._mult(.5);ZI(i,r,h,c),ZI(i,h,s,c)}else i.push(s)}function SZ(i,r){let s=i[0];const c=[s];for(let h=1;h<i.length;h++){const p=i[h];ZI(c,s,p,r),s=p}return c}const XI=Math.pow(2,14)-1,QL=-XI-1;function TZ(i,r){const s=Math.round(i.x*r),c=Math.round(i.y*r);return i.x=Kr(s,QL,XI),i.y=Kr(c,QL,XI),(s<i.x||s>i.x+1||c<i.y||c>i.y+1)&&Pi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Xl(i,r,s){const c=i.loadGeometry(),h=i.extent,p=Bt/h;if(r&&s&&s.projection.isReprojectedInTileSpace){const m=1<<r.z,{scale:x,x:b,y:S,projection:I}=s,P=D=>{const F=Ys((r.x+D.x/h)/m),U=Ro((r.y+D.y/h)/m),V=I.project(F,U);D.x=(V.x*x-b)*h,D.y=(V.y*x-S)*h};for(let D=0;D<c.length;D++)if(i.type!==1)c[D]=XL(c[D],P,1);else{const F=[];for(const U of c[D])U.x<0||U.x>=h||U.y<0||U.y>=h||(P(U),F.push(U));c[D]=F}}for(const m of c)for(const x of m)TZ(x,p);return c}function $u(i,r){return{type:i.type,id:i.id,properties:i.properties,geometry:r?Xl(i):[]}}function aw(i,r,s,c,h){i.emplaceBack(2*r+(c+1)/2,2*s+(h+1)/2)}function lw(i,r,s){i.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class QI{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Yl,this.indexArray=new vo,this.segments=new hi,this.programConfigurations=new od(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(r,s){}populate(r,s,c,h){const p=this.layers[0],m=[];let x=null;p.type==="circle"&&(x=p.layout.get("circle-sort-key"));for(const{feature:S,id:I,index:P,sourceLayerIndex:D}of r){const F=this.layers[0]._featureFilter.needGeometry,U=$u(S,F);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),U,c))continue;const V=x?x.evaluate(U,{},c):void 0,W={id:I,properties:S.properties,type:S.type,sourceLayerIndex:D,index:P,geometry:F?U.geometry:Xl(S,c,h),patterns:{},sortKey:V};m.push(W)}x&&m.sort((S,I)=>S.sortKey-I.sortKey);let b=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new tw,b=h.projection);for(const S of m){const{geometry:I,index:P,sourceLayerIndex:D}=S,F=r[P].feature;this.addFeature(S,I,P,s.availableImages,c,b,s.brightness),s.featureIndex.insert(F,I,P,D,this.index)}}update(r,s,c,h,p){const m=Object.keys(r).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,m?this.stateDependentLayers:this.layers,c,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,cZ.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,uZ.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,s,c,h,p,m,x){for(const b of s)for(const S of b){const I=S.x,P=S.y;if(I<0||I>=Bt||P<0||P>=Bt)continue;if(m){const U=m.projectTilePoint(I,P,p),V=m.upVector(p,I,P),W=this.globeExtVertexArray;lw(W,U,V),lw(W,U,V),lw(W,U,V),lw(W,U,V)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),F=D.vertexLength;aw(this.layoutVertexArray,I,P,-1,-1),aw(this.layoutVertexArray,I,P,1,-1),aw(this.layoutVertexArray,I,P,1,1),aw(this.layoutVertexArray,I,P,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+2,F+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},h,p,x)}}function JI(i,r){for(let s=0;s<i.length;s++)if(ad(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(ad(i,r[s]))return!0;return!!e3(i,r)}function AZ(i,r,s){return!!ad(i,r)||!!t3(r,i,s)}function JL(i,r){if(i.length===1)return tB(r,i[0]);for(let s=0;s<r.length;s++){const c=r[s];for(let h=0;h<c.length;h++)if(ad(i,c[h]))return!0}for(let s=0;s<i.length;s++)if(tB(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(e3(i,r[s]))return!0;return!1}function IZ(i,r,s){if(i.length>1){if(e3(i,r))return!0;for(let c=0;c<r.length;c++)if(t3(r[c],i,s))return!0}for(let c=0;c<i.length;c++)if(t3(i[c],r,s))return!0;return!1}function e3(i,r){if(i.length===0||r.length===0)return!1;for(let s=0;s<i.length-1;s++){const c=i[s],h=i[s+1];for(let p=0;p<r.length-1;p++)if(MZ(c,h,r[p],r[p+1]))return!0}return!1}function MZ(i,r,s,c){return al(i,s,c)!==al(r,s,c)&&al(i,r,s)!==al(i,r,c)}function t3(i,r,s){const c=s*s;if(r.length===1)return i.distSqr(r[0])<c;for(let h=1;h<r.length;h++)if(eB(i,r[h-1],r[h])<c)return!0;return!1}function eB(i,r,s){const c=r.distSqr(s);if(c===0)return i.distSqr(r);const h=((i.x-r.x)*(s.x-r.x)+(i.y-r.y)*(s.y-r.y))/c;return i.distSqr(h<0?r:h>1?s:s.sub(r)._mult(h)._add(r))}function tB(i,r){let s,c,h,p=!1;for(let m=0;m<i.length;m++){s=i[m];for(let x=0,b=s.length-1;x<s.length;b=x++)c=s[x],h=s[b],c.y>r.y!=h.y>r.y&&r.x<(h.x-c.x)*(r.y-c.y)/(h.y-c.y)+c.x&&(p=!p)}return p}function ad(i,r){let s=!1;for(let c=0,h=i.length-1;c<i.length;h=c++){const p=i[c],m=i[h];p.y>r.y!=m.y>r.y&&r.x<(m.x-p.x)*(r.y-p.y)/(m.y-p.y)+p.x&&(s=!s)}return s}function rB(i,r,s,c,h){for(const m of i)if(r<=m.x&&s<=m.y&&c>=m.x&&h>=m.y)return!0;const p=[new Ut(r,s),new Ut(r,h),new Ut(c,h),new Ut(c,s)];if(i.length>2){for(const m of p)if(ad(i,m))return!0}for(let m=0;m<i.length-1;m++)if(PZ(i[m],i[m+1],p))return!0;return!1}function PZ(i,r,s){const c=s[0],h=s[2];if(i.x<c.x&&r.x<c.x||i.x>h.x&&r.x>h.x||i.y<c.y&&r.y<c.y||i.y>h.y&&r.y>h.y)return!1;const p=al(i,r,s[0]);return p!==al(i,r,s[1])||p!==al(i,r,s[2])||p!==al(i,r,s[3])}function v0(i,r,s,c,h,p){let m=r.y-i.y,x=i.x-r.x;if(p=p||0){const b=m*m+x*x;if(b===0)return!0;const S=Math.sqrt(b);m/=S,x/=S}return!((s.x-i.x)*m+(s.y-i.y)*x-p<0||(c.x-i.x)*m+(c.y-i.y)*x-p<0||(h.x-i.x)*m+(h.y-i.y)*x-p<0)}function r3(i,r,s,c,h,p,m){return!(v0(i,r,c,h,p,m)||v0(r,s,c,h,p,m)||v0(s,i,c,h,p,m)||v0(c,h,i,r,s,m)||v0(h,p,i,r,s,m)||v0(p,c,i,r,s,m))}function x0(i,r,s){const c=r.paint.get(i).value;return c.kind==="constant"?c.value:s.programConfigurations.get(r.id).getMaxValue(i)}function cw(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function nB(i,r,s,c,h){if(!r[0]&&!r[1])return i;const p=Ut.convert(r)._mult(h);s==="viewport"&&p._rotate(-c);const m=[];for(let x=0;x<i.length;x++)m.push(i[x].sub(p));return m}function iB(i,r,s,c){const h=Ut.convert(i)._mult(c);return r==="viewport"&&h._rotate(-s),h}pe(QI,"CircleBucket",{omit:["layers"]});const RZ=new Sn({"circle-sort-key":new jt(Ve.layout_circle["circle-sort-key"]),visibility:new yt(Ve.layout_circle.visibility)});var kZ={paint:new Sn({"circle-radius":new jt(Ve.paint_circle["circle-radius"]),"circle-color":new jt(Ve.paint_circle["circle-color"]),"circle-blur":new jt(Ve.paint_circle["circle-blur"]),"circle-opacity":new jt(Ve.paint_circle["circle-opacity"]),"circle-translate":new yt(Ve.paint_circle["circle-translate"]),"circle-translate-anchor":new yt(Ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yt(Ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yt(Ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jt(Ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jt(Ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jt(Ve.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new yt(Ve.paint_circle["circle-emissive-strength"])}),layout:RZ};class n3{constructor(r,s){this.pos=r,this.dir=s}intersectsPlane(r,s,c){const h=a._.dot(s,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((r[0]-this.pos[0])*s[0]+(r[1]-this.pos[1])*s[1]+(r[2]-this.pos[2])*s[2])/h;return c[0]=this.pos[0]+this.dir[0]*p,c[1]=this.pos[1]+this.dir[1]*p,c[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(r,s,c){if(a._.equals(this.pos,r)||s===0)return c[0]=c[1]=c[2]=0,!1;const[h,p,m]=this.dir,x=this.pos[0]-r[0],b=this.pos[1]-r[1],S=this.pos[2]-r[2],I=h*h+p*p+m*m,P=2*(x*h+b*p+S*m),D=P*P-4*I*(x*x+b*b+S*S-s*s);if(D<0){const F=Math.max(-P/2,0),U=x+h*F,V=b+p*F,W=S+m*F,ee=Math.hypot(U,V,W);return c[0]=U*s/ee,c[1]=V*s/ee,c[2]=W*s/ee,!1}{const F=(-P-Math.sqrt(D))/(2*I);if(F<0){const U=Math.hypot(x,b,S);return c[0]=x*s/U,c[1]=b*s/U,c[2]=S*s/U,!1}return c[0]=x+h*F,c[1]=b+p*F,c[2]=S+m*F,!0}}}class i3{constructor(r,s,c,h,p){this.TL=r,this.TR=s,this.BR=c,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(r,s,c){const h=[-1,1,1],p=[1,1,1],m=[1,-1,1],x=[-1,-1,1],b=a._.transformMat4(h,h,r),S=a._.transformMat4(p,p,r),I=a._.transformMat4(m,m,r),P=a._.transformMat4(x,x,r);return new i3(b,S,I,P,s/c)}}function nv(i,r,s){let c=1/0,h=-1/0;const p=[];for(const m of i){a._.sub(p,m,r);const x=a._.dot(p,s);c=Math.min(c,x),h=Math.max(h,x)}return[c,h]}function oB(i,r){let s=!0;for(let c=0;c<i.planes.length;c++){const h=i.planes[c];let p=0;for(let m=0;m<r.length;m++)p+=a._.dot(h,r[m])+h[3]>=0;if(p===0)return 0;p!==r.length&&(s=!1)}return s?2:1}function sB(i,r){for(const s of i.projections){const c=nv(r,i.points[0],s.axis);if(s.projection[1]<c[0]||s.projection[0]>c[1])return 0}return 1}function aB(i,r){let s=0;const c=[0,0,0,0];for(let h=0;h<i.length;h++)c[0]=i[h][0],c[1]=i[h][1],c[2]=i[h][2],c[3]=1,a.aA.dot(c,r)>=0&&s++;return s}class o3{constructor(r,s){this.points=r||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=di.fromPoints(this.points),this.projections=[],this.frustumEdges=[a._.sub([],this.points[2],this.points[3]),a._.sub([],this.points[0],this.points[3]),a._.sub([],this.points[4],this.points[0]),a._.sub([],this.points[5],this.points[1]),a._.sub([],this.points[6],this.points[2]),a._.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const h=[0,-c[2],c[1]],p=[c[2],0,-c[0]];this.projections.push({axis:h,projection:nv(this.points,this.points[0],h)}),this.projections.push({axis:p,projection:nv(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(r,s,c,h){const p=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const I=a.aA.transformMat4([],S,r),P=1/I[3]/s*p;return a.aA.mul(I,I,[P,P,h?1/I[3]:P,P])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const I=a._.sub([],m[S[0]],m[S[1]]),P=a._.sub([],m[S[2]],m[S[1]]),D=a._.normalize([],a._.cross([],I,P)),F=-a._.dot(D,m[S[1]]);return D.concat(F)}),b=[];for(let S=0;S<m.length;S++)b.push([m[S][0],m[S][1],m[S][2]]);return new o3(b,x)}intersectsPrecise(r,s,c){for(let h=0;h<s.length;h++)if(!aB(r,s[h]))return 0;for(let h=0;h<this.planes.length;h++)if(!aB(r,this.planes[h]))return 0;for(const h of c)for(const p of this.frustumEdges){const m=a._.cross([],h,p),x=a._.length(m);if(x===0)continue;a._.scale(m,m,1/x);const b=nv(this.points,this.points[0],m),S=nv(r,this.points[0],m);if(b[0]>S[1]||S[0]>b[1])return 0}return 1}}class di{static fromPoints(r){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const h of r)a._.min(s,s,h),a._.max(c,c,h);return new di(s,c)}static fromTileIdAndHeight(r,s,c){const h=1<<r.canonical.z,p=r.canonical.x,m=r.canonical.y;return new di([p/h,m/h,s],[(p+1)/h,(m+1)/h,c])}static applyTransform(r,s){const c=r.getCorners();for(let h=0;h<c.length;++h)a._.transformMat4(c[h],c[h],s);return di.fromPoints(c)}static projectAabbCorners(r,s){const c=r.getCorners();for(let h=0;h<c.length;++h)a._.transformMat4(c[h],c[h],s);return c}constructor(r,s){this.min=r,this.max=s,this.center=a._.scale([],a._.add([],this.min,this.max),.5)}quadrant(r){const s=[r%2==0,r<2],c=a._.clone(this.min),h=a._.clone(this.max);for(let p=0;p<s.length;p++)c[p]=s[p]?this.min[p]:this.center[p],h[p]=s[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new di(c,h)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,s=this.max;return[[r[0],r[1],r[2]],[s[0],r[1],r[2]],[s[0],s[1],r[2]],[r[0],s[1],r[2]],[r[0],r[1],s[2]],[s[0],r[1],s[2]],[s[0],s[1],s[2]],[r[0],s[1],s[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?oB(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?oB(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,s){return s||this.intersects(r)?sB(r,this.getCorners()):0}intersectsPreciseFlat(r,s){return s||this.intersectsFlat(r)?sB(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let s=0;s<3;++s)if(this.min[s]>r.max[s]||r.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r.min[s]),this.max[s]=Math.max(this.max[s],r.max[s])}encapsulatePoint(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r[s]),this.max[s]=Math.max(this.max[s],r[s])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}pe(di,"Aabb");const DZ=Tn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:uw}=DZ,lB=Tn([{name:"a_pos_3",components:3,type:"Int16"}]);var iv=Tn([{name:"a_pos",type:"Int16",components:2}]);function hw(i){return i*ks/y0}const OZ=[new di([dl,dl,dl],[fl,fl,fl]),new di([dl,dl,dl],[0,0,fl]),new di([0,dl,dl],[fl,0,fl]),new di([dl,0,dl],[0,fl,fl]),new di([0,0,dl],[fl,fl,fl])];function cB(i,r,s,c=!0){const h=a._.scale([],i._camera.position,i.worldSize),p=[r,s,1,1];a.aA.transformMat4(p,p,i.pixelMatrixInverse),a.aA.scale(p,p,1/p[3]);const m=a._.sub([],p,h),x=a._.normalize([],m),b=i.globeMatrix,S=[b[12],b[13],b[14]],I=a._.sub([],S,h),P=a._.length(I),D=a._.normalize([],I),F=i.worldSize/(2*Math.PI),U=a._.dot(D,x),V=Math.asin(F/P);if(V<Math.acos(U)){if(!c)return null;const Ze=[],dt=[];a._.scale(Ze,x,P/U),a._.normalize(dt,a._.sub(dt,Ze,I)),a._.normalize(x,a._.add(x,I,a._.scale(x,dt,Math.tan(V)*P)))}const W=[];new n3(h,x).closestPointOnSphere(S,F,W);const ee=a._.normalize([],If(b,0)),ce=a._.normalize([],If(b,1)),ue=a._.normalize([],If(b,2)),he=a._.dot(ee,W),Se=a._.dot(ce,W),be=a._.dot(ue,W),ke=$o(Math.asin(-Se/F));let Le=$o(Math.atan2(he,be));Le=i.center.lng+function(Ze,dt){const At=(dt-Ze+180)%360-180;return At<-180?At+360:At}(i.center.lng,Le);const je=Nc(Le),ot=Kr(Uc(ke),0,1);return new es(je,ot)}class LZ{constructor(r,s,c){this.a=a._.sub([],r,c),this.b=a._.sub([],s,c),this.center=c;const h=a._.normalize([],this.a),p=a._.normalize([],this.b);this.angle=Math.acos(a._.dot(h,p))}}function s3(i,r){if(i.angle===0)return null;let s;return s=i.a[r]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[r]/i.a[r]/Math.sin(i.angle)-1/Math.tan(i.angle)),s<0||s>1?null:function(c,h,p,m){const x=Math.sin(p);return c*(Math.sin((1-m)*p)/x)+h*(Math.sin(m*p)/x)}(i.a[r],i.b[r],i.angle,Kr(s,0,1))+i.center[r]}function $c(i){if(i.z<=1)return OZ[i.z+2*i.y+i.x];const r=a3(dw(i));return di.fromPoints(r)}function ju(i,r,s){return a._.scale(i,i,1-s),a._.scaleAndAdd(i,i,r,s)}function uB(i,r){const s=Vu(r.zoom);if(s===0)return $c(i);const c=dw(i),h=a3(c),p=Nc(c.getWest())*r.worldSize,m=Nc(c.getEast())*r.worldSize,x=Uc(c.getNorth())*r.worldSize,b=Uc(c.getSouth())*r.worldSize,S=[p,x,0],I=[m,x,0],P=[p,b,0],D=[m,b,0],F=a.ad.invert([],r.globeMatrix);return a._.transformMat4(S,S,F),a._.transformMat4(I,I,F),a._.transformMat4(P,P,F),a._.transformMat4(D,D,F),h[0]=ju(h[0],P,s),h[1]=ju(h[1],D,s),h[2]=ju(h[2],I,s),h[3]=ju(h[3],S,s),di.fromPoints(h)}function hB(i,r,s){for(const c of i)a._.transformMat4(c,c,r),a._.scale(c,c,s)}function dB(i,r,s,c){const h=r/i.worldSize,p=i.globeMatrix;if(s.z<=1){const je=$c(s).getCorners();return hB(je,p,h),di.fromPoints(je)}const m=dw(s,c),x=a3(m,ks+hw(i._tileCoverLift));hB(x,p,h);const b=Number.MAX_VALUE,S=[-b,-b,-b],I=[b,b,b];if(m.contains(i.center)){for(const Ze of x)a._.min(I,I,Ze),a._.max(S,S,Ze);S[2]=0;const je=i.point,ot=[je.x*h,je.y*h,0];return a._.min(I,I,ot),a._.max(S,S,ot),new di(I,S)}if(i._tileCoverLift>0){for(const je of x)a._.min(I,I,je),a._.max(S,S,je);return new di(I,S)}const P=[p[12]*h,p[13]*h,p[14]*h],D=m.getCenter(),F=Kr(i.center.lat,-ki,ki),U=Kr(D.lat,-ki,ki),V=Nc(i.center.lng),W=Uc(F);let ee=V-Nc(D.lng);const ce=W-Uc(U);ee>.5?ee-=1:ee<-.5&&(ee+=1);let ue=0;if(Math.abs(ee)>Math.abs(ce))ue=ee>=0?1:3;else{ue=ce>=0?0:2;const je=[p[4]*h,p[5]*h,p[6]*h],ot=-Math.sin(an(ce>=0?m.getSouth():m.getNorth()))*ks;a._.scaleAndAdd(P,P,je,ot)}const he=x[ue],Se=x[(ue+1)%4],be=new LZ(he,Se,P),ke=[s3(be,0)||he[0],s3(be,1)||he[1],s3(be,2)||he[2]],Le=Vu(i.zoom);if(Le>0){const je=function({x:Ze,y:dt,z:At},ct,bt,st,wt){const Pt=1/(1<<At);let Tt=Ze*Pt,Ht=Tt+Pt,It=dt*Pt,Dt=It+Pt,fr=0;const lr=(Tt+Ht)/2-st;return lr>.5?fr=-1:lr<-.5&&(fr=1),Tt=((Tt+fr)*ct-(st*=ct))*bt+st,Ht=((Ht+fr)*ct-st)*bt+st,It=(It*ct-(wt*=ct))*bt+wt,Dt=(Dt*ct-wt)*bt+wt,[[Tt,Dt,0],[Ht,Dt,0],[Ht,It,0],[Tt,It,0]]}(s,r,i._pixelsPerMercatorPixel,V,W);for(let Ze=0;Ze<x.length;Ze++)ju(x[Ze],je[Ze],Le);const ot=a._.add([],je[ue],je[(ue+1)%4]);a._.scale(ot,ot,.5),ju(ke,ot,Le)}for(const je of x)a._.min(I,I,je),a._.max(S,S,je);return I[2]=Math.min(he[2],Se[2]),a._.min(I,I,ke),a._.max(S,S,ke),new di(I,S)}function dw({x:i,y:r,z:s},c=!1){const h=1/(1<<s),p=new gn(Ys(i*h),r===(1<<s)-1&&c?-90:Ro((r+1)*h)),m=new gn(Ys((i+1)*h),r===0&&c?90:Ro(r*h));return new sd(p,m)}function a3(i,r=ks){const s=an(i.getNorth()),c=an(i.getSouth()),h=Math.cos(s),p=Math.cos(c),m=Math.sin(s),x=Math.sin(c),b=i.getWest(),S=i.getEast();return[_0(p,x,b,r),_0(p,x,S,r),_0(h,m,S,r),_0(h,m,b,r)]}function ov(i,r,s,c){const h=1<<s.z,p=(i/Bt+s.x)/h;return ap(Ro((r/Bt+s.y)/h),Ys(p),c)}function fw({min:i,max:r}){return xZ/Math.max(r[0]-i[0],r[1]-i[1],r[2]-i[2])}const fB=new Float64Array(16);function sv(i){const r=fw(i),s=a.ad.fromScaling(fB,[r,r,r]);return a.ad.translate(s,s,a._.negate([],i.min))}function l3(i){const r=a.ad.fromTranslation(fB,i.min),s=1/fw(i);return a.ad.scale(r,r,[s,s,s])}function c3(i){const r=Bt/(2*Math.PI);return i/(2*Math.PI)/r}function pB(i,r){return Bt/(512*Math.pow(2,i))*fw($c(r))}function mB(i,r,s,c,h){const p=c3(s),m=[i,r,-s/(2*Math.PI)],x=a.ad.identity(new Float64Array(16));return a.ad.translate(x,x,m),a.ad.scale(x,x,[p,p,p]),a.ad.rotateX(x,x,an(-h)),a.ad.rotateY(x,x,an(-c)),x}function Vu(i){return bu(GI,GL,i)}function gB(i,r){const s=ap(r.lat,r.lng),c=function(p){const m=ap(p._center.lat,p._center.lng),x=a._.fromValues(0,1,0);let b=a._.cross([],x,m);const S=a.ad.fromRotation([],-p.angle,m);b=a._.transformMat4(b,b,S),a.ad.fromRotation(S,-p._pitch,b);const I=a._.normalize([],m);return a._.scale(I,I,hw(p.cameraToCenterDistance/p.pixelsPerMeter)),a._.transformMat4(I,I,S),a._.add([],m,I)}(i),h=a._.subtract([],c,s);return a._.angle(h,s)}function u3(i,r){return gB(i,r)>Math.PI/2*1.01}const _B=an(85),BZ=Math.cos(_B),FZ=Math.sin(_B),zZ=a.ad.create(),yB=i=>{const r=[];return i.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),i.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r};function vB(i,r,s,c,h,p,m,x,b){if(p&&i.queryGeometry.isAboveHorizon)return!1;p&&(b*=i.pixelToTileUnitsFactor);const S=i.tileID.canonical,I=s.projection.upVectorScale(S,s.center.lat,s.worldSize).metersToTile;for(const P of r)for(const D of P){const F=D.add(x),U=h&&s.elevation?s.elevation.exaggeration()*h.getElevationAt(F.x,F.y,!0):0,V=s.projection.projectTilePoint(F.x,F.y,S);if(U>0){const ue=s.projection.upVector(S,F.x,F.y);V.x+=ue[0]*I*U,V.y+=ue[1]*I*U,V.z+=ue[2]*I*U}const W=p?F:NZ(V.x,V.y,V.z,c),ee=p?i.tilespaceRays.map(ue=>$Z(ue,U)):i.queryGeometry.screenGeometry,ce=a.aA.transformMat4([],[V.x,V.y,V.z,1],c);if(!m&&p?b*=ce[3]/s.cameraToCenterDistance:m&&!p&&(b*=s.cameraToCenterDistance/ce[3]),p){const ue=Ro((D.y/Bt+S.y)/(1<<S.z));b/=s.projection.pixelsPerMeter(ue,1)/Ds(1,ue)}if(AZ(ee,W,b))return!0}return!1}function NZ(i,r,s,c){const h=a.aA.transformMat4([],[i,r,s,1],c);return new Ut(h[0]/h[3],h[1]/h[3])}const xB=a._.fromValues(0,0,0),UZ=a._.fromValues(0,0,1);function $Z(i,r){const s=a._.create();return xB[2]=r,i.intersectsPlane(xB,UZ,s),new Ut(s[0],s[1])}class bB extends QI{}function wB(i,{width:r,height:s},c,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==r*s*c)throw new RangeError("mismatched image size")}else h=new Uint8Array(r*s*c);return i.width=r,i.height=s,i.data=h,i}function CB(i,r,s){const{width:c,height:h}=r;c===i.width&&h===i.height||(h3(i,r,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,h)},s,null),i.width=c,i.height=h,i.data=r.data)}function h3(i,r,s,c,h,p,m,x){if(h.width===0||h.height===0)return r;if(h.width>i.width||h.height>i.height||s.x>i.width-h.width||s.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>r.width||h.height>r.height||c.x>r.width-h.width||c.y>r.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const b=i.data,S=r.data,I=p===4&&x;for(let P=0;P<h.height;P++){const D=((s.y+P)*i.width+s.x)*p,F=((c.y+P)*r.width+c.x)*p;if(I)for(let U=0;U<h.width;U++){const V=D+U*p+3,W=F+U*p;S[W+0]=255,S[W+1]=255,S[W+2]=255,S[W+3]=b[V]}else if(m)for(let U=0;U<h.width;U++){const V=D+U*p,W=F+U*p,ee=b[V+3],ce=new yn(b[V+0]/255*ee,b[V+1]/255*ee,b[V+2]/255*ee,ee).toRenderColor(m).toArray();S[W+0]=ce[0],S[W+1]=ce[1],S[W+2]=ce[2],S[W+3]=ce[3]}else for(let U=0;U<h.width*p;U++)S[F+U]=b[D+U]}return r}pe(bB,"HeatmapBucket",{omit:["layers"]});class ld{constructor(r,s){wB(this,r,1,s)}resize(r){CB(this,new ld(r),1)}clone(){return new ld({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,h,p){h3(r,s,c,h,p,1,null)}}class Da{constructor(r,s){wB(this,r,4,s)}resize(r){CB(this,new Da(r),4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Da({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,h,p,m,x){h3(r,s,c,h,p,4,m,x)}}class EB{constructor(r,s){this.width=r.width,this.height=r.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}pe(ld,"AlphaImage"),pe(Da,"RGBAImage");const jZ=new Sn({visibility:new yt(Ve.layout_heatmap.visibility)});var VZ={paint:new Sn({"heatmap-radius":new jt(Ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jt(Ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yt(Ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ui(Ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yt(Ve.paint_heatmap["heatmap-opacity"])}),layout:jZ};function av(i){const r={},s=i.resolution||256,c=i.clips?i.clips.length:1,h=i.image||new Da({width:s,height:c}),p=(m,x,b)=>{r[i.evaluationKey]=b;const S=i.expression.evaluate(r);S&&(h.data[m+x+0]=Math.floor(255*S.r/S.a),h.data[m+x+1]=Math.floor(255*S.g/S.a),h.data[m+x+2]=Math.floor(255*S.b/S.a),h.data[m+x+3]=Math.floor(255*S.a))};if(i.clips)for(let m=0,x=0;m<c;++m,x+=4*s)for(let b=0,S=0;b<s;b++,S+=4){const I=b/(s-1),{start:P,end:D}=i.clips[m];p(x,S,P*(1-I)+D*I)}else for(let m=0,x=0;m<s;m++,x+=4)p(0,x,m/(s-1));return h}const HZ=new Sn({visibility:new yt(Ve.layout_hillshade.visibility)});var GZ={paint:new Sn({"hillshade-illumination-direction":new yt(Ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yt(Ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yt(Ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yt(Ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yt(Ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yt(Ve.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new yt(Ve.paint_hillshade["hillshade-emissive-strength"])}),layout:HZ};const WZ=Tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:qZ}=WZ;function lv(i,r,s=2){const c=r&&r.length,h=c?r[0]*s:i.length;let p=SB(i,0,h,s,!0);const m=[];if(!p||p.next===p.prev)return m;let x,b,S;if(c&&(p=function(I,P,D,F){const U=[];for(let V=0,W=P.length;V<W;V++){const ee=SB(I,P[V]*F,V<W-1?P[V+1]*F:I.length,F,!1);ee===ee.next&&(ee.steiner=!0),U.push(tX(ee))}U.sort(QZ);for(let V=0;V<U.length;V++)D=JZ(U[V],D);return D}(i,r,p,s)),i.length>80*s){x=1/0,b=1/0;let I=-1/0,P=-1/0;for(let D=s;D<h;D+=s){const F=i[D],U=i[D+1];F<x&&(x=F),U<b&&(b=U),F>I&&(I=F),U>P&&(P=U)}S=Math.max(I-x,P-b),S=S!==0?32767/S:0}return cv(p,m,s,x,b,S,0),m}function SB(i,r,s,c,h){let p;if(h===function(m,x,b,S){let I=0;for(let P=x,D=b-S;P<b;P+=S)I+=(m[D]-m[P])*(m[P+1]+m[D+1]),D=P;return I}(i,r,s,c)>0)for(let m=r;m<s;m+=c)p=IB(m/c|0,i[m],i[m+1],p);else for(let m=s-c;m>=r;m-=c)p=IB(m/c|0,i[m],i[m+1],p);return p&&pw(p,p.next)&&(hv(p),p=p.next),p}function up(i,r){if(!i)return i;r||(r=i);let s,c=i;do if(s=!1,c.steiner||!pw(c,c.next)&&eo(c.prev,c,c.next)!==0)c=c.next;else{if(hv(c),c=r=c.prev,c===c.next)break;s=!0}while(s||c!==r);return r}function cv(i,r,s,c,h,p,m){if(!i)return;!m&&p&&function(b,S,I,P){let D=b;do D.z===0&&(D.z=d3(D.x,D.y,S,I,P)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==b);D.prevZ.nextZ=null,D.prevZ=null,function(F){let U,V=1;do{let W,ee=F;F=null;let ce=null;for(U=0;ee;){U++;let ue=ee,he=0;for(let be=0;be<V&&(he++,ue=ue.nextZ,ue);be++);let Se=V;for(;he>0||Se>0&&ue;)he!==0&&(Se===0||!ue||ee.z<=ue.z)?(W=ee,ee=ee.nextZ,he--):(W=ue,ue=ue.nextZ,Se--),ce?ce.nextZ=W:F=W,W.prevZ=ce,ce=W;ee=ue}ce.nextZ=null,V*=2}while(U>1)}(D)}(i,c,h,p);let x=i;for(;i.prev!==i.next;){const b=i.prev,S=i.next;if(p?YZ(i,c,h,p):KZ(i))r.push(b.i,i.i,S.i),hv(i),i=S.next,x=S.next;else if((i=S)===x){m?m===1?cv(i=ZZ(up(i),r),r,s,c,h,p,2):m===2&&XZ(i,r,s,c,h,p):cv(up(i),r,s,c,h,p,1);break}}}function KZ(i){const r=i.prev,s=i,c=i.next;if(eo(r,s,c)>=0)return!1;const h=r.x,p=s.x,m=c.x,x=r.y,b=s.y,S=c.y,I=h<p?h<m?h:m:p<m?p:m,P=x<b?x<S?x:S:b<S?b:S,D=h>p?h>m?h:m:p>m?p:m,F=x>b?x>S?x:S:b>S?b:S;let U=c.next;for(;U!==r;){if(U.x>=I&&U.x<=D&&U.y>=P&&U.y<=F&&b0(h,x,p,b,m,S,U.x,U.y)&&eo(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function YZ(i,r,s,c){const h=i.prev,p=i,m=i.next;if(eo(h,p,m)>=0)return!1;const x=h.x,b=p.x,S=m.x,I=h.y,P=p.y,D=m.y,F=x<b?x<S?x:S:b<S?b:S,U=I<P?I<D?I:D:P<D?P:D,V=x>b?x>S?x:S:b>S?b:S,W=I>P?I>D?I:D:P>D?P:D,ee=d3(F,U,r,s,c),ce=d3(V,W,r,s,c);let ue=i.prevZ,he=i.nextZ;for(;ue&&ue.z>=ee&&he&&he.z<=ce;){if(ue.x>=F&&ue.x<=V&&ue.y>=U&&ue.y<=W&&ue!==h&&ue!==m&&b0(x,I,b,P,S,D,ue.x,ue.y)&&eo(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,he.x>=F&&he.x<=V&&he.y>=U&&he.y<=W&&he!==h&&he!==m&&b0(x,I,b,P,S,D,he.x,he.y)&&eo(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;ue&&ue.z>=ee;){if(ue.x>=F&&ue.x<=V&&ue.y>=U&&ue.y<=W&&ue!==h&&ue!==m&&b0(x,I,b,P,S,D,ue.x,ue.y)&&eo(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;he&&he.z<=ce;){if(he.x>=F&&he.x<=V&&he.y>=U&&he.y<=W&&he!==h&&he!==m&&b0(x,I,b,P,S,D,he.x,he.y)&&eo(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function ZZ(i,r){let s=i;do{const c=s.prev,h=s.next.next;!pw(c,h)&&TB(c,s,s.next,h)&&uv(c,h)&&uv(h,c)&&(r.push(c.i,s.i,h.i),hv(s),hv(s.next),s=i=h),s=s.next}while(s!==i);return up(s)}function XZ(i,r,s,c,h,p){let m=i;do{let x=m.next.next;for(;x!==m.prev;){if(m.i!==x.i&&rX(m,x)){let b=AB(m,x);return m=up(m,m.next),b=up(b,b.next),cv(m,r,s,c,h,p,0),void cv(b,r,s,c,h,p,0)}x=x.next}m=m.next}while(m!==i)}function QZ(i,r){return i.x-r.x}function JZ(i,r){const s=function(h,p){let m=p;const x=h.x,b=h.y;let S,I=-1/0;do{if(b<=m.y&&b>=m.next.y&&m.next.y!==m.y){const V=m.x+(b-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(V<=x&&V>I&&(I=V,S=m.x<m.next.x?m:m.next,V===x))return S}m=m.next}while(m!==p);if(!S)return null;const P=S,D=S.x,F=S.y;let U=1/0;m=S;do{if(x>=m.x&&m.x>=D&&x!==m.x&&b0(b<F?x:I,b,D,F,b<F?I:x,b,m.x,m.y)){const V=Math.abs(b-m.y)/(x-m.x);uv(m,h)&&(V<U||V===U&&(m.x>S.x||m.x===S.x&&eX(S,m)))&&(S=m,U=V)}m=m.next}while(m!==P);return S}(i,r);if(!s)return r;const c=AB(s,i);return up(c,c.next),up(s,s.next)}function eX(i,r){return eo(i.prev,i,r.prev)<0&&eo(r.next,i,i.next)<0}function d3(i,r,s,c,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function tX(i){let r=i,s=i;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==i);return s}function b0(i,r,s,c,h,p,m,x){return(h-m)*(r-x)>=(i-m)*(p-x)&&(i-m)*(c-x)>=(s-m)*(r-x)&&(s-m)*(p-x)>=(h-m)*(c-x)}function rX(i,r){return i.next.i!==r.i&&i.prev.i!==r.i&&!function(s,c){let h=s;do{if(h.i!==s.i&&h.next.i!==s.i&&h.i!==c.i&&h.next.i!==c.i&&TB(h,h.next,s,c))return!0;h=h.next}while(h!==s);return!1}(i,r)&&(uv(i,r)&&uv(r,i)&&function(s,c){let h=s,p=!1;const m=(s.x+c.x)/2,x=(s.y+c.y)/2;do h.y>x!=h.next.y>x&&h.next.y!==h.y&&m<(h.next.x-h.x)*(x-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next;while(h!==s);return p}(i,r)&&(eo(i.prev,i,r.prev)||eo(i,r.prev,r))||pw(i,r)&&eo(i.prev,i,i.next)>0&&eo(r.prev,r,r.next)>0)}function eo(i,r,s){return(r.y-i.y)*(s.x-r.x)-(r.x-i.x)*(s.y-r.y)}function pw(i,r){return i.x===r.x&&i.y===r.y}function TB(i,r,s,c){const h=gw(eo(i,r,s)),p=gw(eo(i,r,c)),m=gw(eo(s,c,i)),x=gw(eo(s,c,r));return h!==p&&m!==x||!(h!==0||!mw(i,s,r))||!(p!==0||!mw(i,c,r))||!(m!==0||!mw(s,i,c))||!(x!==0||!mw(s,r,c))}function mw(i,r,s){return r.x<=Math.max(i.x,s.x)&&r.x>=Math.min(i.x,s.x)&&r.y<=Math.max(i.y,s.y)&&r.y>=Math.min(i.y,s.y)}function gw(i){return i>0?1:i<0?-1:0}function uv(i,r){return eo(i.prev,i,i.next)<0?eo(i,r,i.next)>=0&&eo(i,i.prev,r)>=0:eo(i,r,i.prev)<0||eo(i,i.next,r)<0}function AB(i,r){const s=f3(i.i,i.x,i.y),c=f3(r.i,r.x,r.y),h=i.next,p=r.prev;return i.next=r,r.prev=i,s.next=h,h.prev=s,c.next=s,s.prev=c,p.next=c,c.prev=p,c}function IB(i,r,s,c){const h=f3(i,r,s);return c?(h.next=c.next,h.prev=c,c.next.prev=h,c.next=h):(h.prev=h,h.next=h),h}function hv(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function f3(i,r,s){return{i,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function _w(i,r){const s=i.length;if(s<=1)return[i];const c=[];let h,p;for(let m=0;m<s;m++){const x=Xo(i[m]);x!==0&&(i[m].area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(h&&c.push(h),h=[i[m]]):h.push(i[m]))}if(h&&c.push(h),r>1)for(let m=0;m<c.length;m++)c[m].length<=r||(hI(c[m],r,1,c[m].length-1,nX),c[m]=c[m].slice(0,r));return c}function nX(i,r){return r.area-i.area}function p3(i,r,s){const c=s.patternDependencies;let h=!1;for(const p of r){const m=p.paint.get(`${i}-pattern`);m.isConstant()||(h=!0);const x=m.constantOr(null);x&&(h=!0,c[x]=!0)}return h}function m3(i,r,s,c,h){const p=h.patternDependencies;for(const m of r){const x=m.paint.get(`${i}-pattern`).value;if(x.kind!=="constant"){let b=x.evaluate({zoom:c},s,{},h.availableImages);b=b&&b.name?b.name:b,p[b]=!0,s.patterns[m.id]=b}}return s}class yw{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yl,this.indexArray=new vo,this.indexArray2=new nd,this.programConfigurations=new od(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new hi,this.segments2=new hi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=r.projection}updateFootprints(r,s){}populate(r,s,c,h){this.hasPattern=p3("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:x,id:b,index:S,sourceLayerIndex:I}of r){const P=this.layers[0]._featureFilter.needGeometry,D=$u(x,P);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),D,c))continue;const F=p?p.evaluate(D,{},c,s.availableImages):void 0,U={id:b,properties:x.properties,type:x.type,sourceLayerIndex:I,index:S,geometry:P?D.geometry:Xl(x,c,h),patterns:{},sortKey:F};m.push(U)}p&&m.sort((x,b)=>x.sortKey-b.sortKey);for(const x of m){const{geometry:b,index:S,sourceLayerIndex:I}=x;if(this.hasPattern){const P=m3("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(P)}else this.addFeature(x,b,S,c,{},s.availableImages,s.brightness);s.featureIndex.insert(r[S].feature,b,S,I,this.index)}}update(r,s,c,h,p){const m=Object.keys(r).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,m?this.stateDependentLayers:this.layers,c,h,p)}addFeatures(r,s,c,h,p,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,qZ),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,c,h,p,m=[],x){for(const b of _w(s,500)){let S=0;for(const V of b)S+=V.length;const I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),P=I.vertexLength,D=[],F=[];for(const V of b){if(V.length===0)continue;V!==b[0]&&F.push(D.length/2);const W=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),ee=W.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(ee+V.length-1,ee),D.push(V[0].x),D.push(V[0].y);for(let ce=1;ce<V.length;ce++)this.layoutVertexArray.emplaceBack(V[ce].x,V[ce].y),this.indexArray2.emplaceBack(ee+ce-1,ee+ce),D.push(V[ce].x),D.push(V[ce].y);W.vertexLength+=V.length,W.primitiveLength+=V.length}const U=lv(D,F);for(let V=0;V<U.length;V+=3)this.indexArray.emplaceBack(P+U[V],P+U[V+1],P+U[V+2]);I.vertexLength+=S,I.primitiveLength+=U.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,p,m,h,x)}}pe(yw,"FillBucket",{omit:["layers","patternFeatures"]});const iX=new Sn({"fill-sort-key":new jt(Ve.layout_fill["fill-sort-key"]),visibility:new yt(Ve.layout_fill.visibility)});var oX={paint:new Sn({"fill-antialias":new yt(Ve.paint_fill["fill-antialias"]),"fill-opacity":new jt(Ve.paint_fill["fill-opacity"]),"fill-color":new jt(Ve.paint_fill["fill-color"]),"fill-outline-color":new jt(Ve.paint_fill["fill-outline-color"]),"fill-translate":new yt(Ve.paint_fill["fill-translate"]),"fill-translate-anchor":new yt(Ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new jt(Ve.paint_fill["fill-pattern"]),"fill-emissive-strength":new yt(Ve.paint_fill["fill-emissive-strength"])}),layout:iX};class g3{constructor(r,s,c,h){if(this.triangleCount=s.length/3,this.min=new Ut(0,0),this.max=new Ut(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||r.length===0)return;const[p,m]=[r[0].clone(),r[0].clone()];for(let P=1;P<r.length;++P){const D=r[P];p.x=Math.min(p.x,D.x),p.y=Math.min(p.y,D.y),m.x=Math.max(m.x,D.x),m.y=Math.max(m.y,D.y)}if(h){const P=Math.ceil(Math.max(m.x-p.x,m.y-p.y)/h);c=Math.max(c,P)}if(c===0)return;this.min=p,this.max=m;const x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);const b=Math.max(x.x,x.y)/c;this.cellsX=Math.max(1,Math.ceil(x.x/b)),this.cellsY=Math.max(1,Math.ceil(x.y/b)),this.xScale=1/b,this.yScale=1/b;const S=[];for(let P=0;P<this.triangleCount;P++){const D=r[s[3*P+0]].sub(this.min),F=r[s[3*P+1]].sub(this.min),U=r[s[3*P+2]].sub(this.min),V=jc(Math.floor(Math.min(D.x,F.x,U.x)),this.xScale,this.cellsX),W=jc(Math.floor(Math.max(D.x,F.x,U.x)),this.xScale,this.cellsX),ee=jc(Math.floor(Math.min(D.y,F.y,U.y)),this.yScale,this.cellsY),ce=jc(Math.floor(Math.max(D.y,F.y,U.y)),this.yScale,this.cellsY),ue=new Ut(0,0),he=new Ut(0,0),Se=new Ut(0,0),be=new Ut(0,0);for(let ke=ee;ke<=ce;++ke){ue.y=he.y=ke*b,Se.y=be.y=(ke+1)*b;for(let Le=V;Le<=W;++Le)ue.x=Se.x=Le*b,he.x=be.x=(Le+1)*b,(r3(D,F,U,ue,he,be)||r3(D,F,U,ue,be,Se))&&S.push({cellIdx:ke*this.cellsX+Le,triIdx:P})}}if(S.length===0)return;S.sort((P,D)=>P.cellIdx-D.cellIdx||P.triIdx-D.triIdx);let I=0;for(;I<S.length;){const P=S[I].cellIdx,D={start:this.payload.length,len:0};for(;I<S.length&&S[I].cellIdx===P;)++D.len,this.payload.push(S[I++].triIdx);this.cells[P]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(r,s){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>r.x||r.y>this.max.y||this.min.y>r.y)return;const c=jc(r.x-this.min.x,this.xScale,this.cellsX),h=jc(r.y-this.min.y,this.yScale,this.cellsY),p=this.cells[h*this.cellsX+c];if(p){this._lazyInitLookup();for(let m=0;m<p.len;m++){const x=this.payload[p.start+m],b=Math.floor(x/8),S=1<<x%8;if(!(this.lookup[b]&S)&&(this.lookup[b]|=S,s.push(x),s.length===this.triangleCount))return}}}query(r,s,c){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>s.x||r.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const h=jc(r.x-this.min.x,this.xScale,this.cellsX),p=jc(s.x-this.min.x,this.xScale,this.cellsX),m=jc(r.y-this.min.y,this.yScale,this.cellsY),x=jc(s.y-this.min.y,this.yScale,this.cellsY);for(let b=m;b<=x;b++)for(let S=h;S<=p;S++){const I=this.cells[b*this.cellsX+S];if(I)for(let P=0;P<I.len;P++){const D=this.payload[I.start+P],F=Math.floor(D/8),U=1<<D%8;if(!(this.lookup[F]&U)&&(this.lookup[F]|=U,c.push(D),c.length===this.triangleCount))return}}}}function jc(i,r,s){return Math.max(0,Math.min(s-1,Math.floor(i*r)))}pe(g3,"TriangleGridIndex");class MB{constructor(r){this.zoom=r.zoom,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(r,s){for(const c of this.footprints)s.push({footprint:c,id:r})}populate(r,s,c,h){const p=[];for(const{feature:m,id:x,index:b,sourceLayerIndex:S}of r){const I=this.layers[0]._featureFilter.needGeometry,P=$u(m,I);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),P,c))continue;const D={id:x,properties:m.properties,type:m.type,sourceLayerIndex:S,index:b,geometry:I?P.geometry:Xl(m,c,h),patterns:{}};p.push(D)}for(const m of p){const{geometry:x,index:b,sourceLayerIndex:S}=m;this.addFeature(m,x,b,c,{},s.availableImages,s.brightness),s.featureIndex.insert(r[b].feature,x,b,S,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(r){}update(r,s,c,h,p){}destroy(){}addFeature(r,s,c,h,p,m=[],x){for(const b of _w(s,2)){const S=[],I=[],P=[],D=new Ut(1/0,1/0),F=new Ut(-1/0,-1/0);for(const W of b)if(W.length!==0){W!==b[0]&&P.push(I.length/2);for(let ee=0;ee<W.length;ee++)I.push(W[ee].x),I.push(W[ee].y),S.push(W[ee]),D.x=Math.min(D.x,W[ee].x),D.y=Math.min(D.y,W[ee].y),F.x=Math.max(F.x,W[ee].x),F.y=Math.max(F.y,W[ee].y)}const U=lv(I,P),V=new g3(S,U,8,256);this.footprints.push({vertices:S,indices:U,grid:V,min:D,max:F})}}}pe(MB,"ClipBucket",{omit:["layers"]});const sX=new Sn({"clip-layer-types":new yt(Ve.layout_clip["clip-layer-types"])});var aX={paint:new Sn({}),layout:sX};const lX=Tn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),cX=Tn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),uX=Tn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),hX=Tn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),dX=Tn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:fX}=lX;var vw={},pX=Mm,PB=w0;function w0(i,r,s,c,h){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=h,i.readFields(mX,this,r)}function mX(i,r,s){i==1?r.id=s.readVarint():i==2?function(c,h){for(var p=c.readVarint()+c.pos;c.pos<p;){var m=h._keys[c.readVarint()],x=h._values[c.readVarint()];h.properties[m]=x}}(s,r):i==3?r.type=s.readVarint():i==4&&(r._geometry=s.pos)}function gX(i){for(var r,s,c=0,h=0,p=i.length,m=p-1;h<p;m=h++)c+=((s=i[m]).x-(r=i[h]).x)*(r.y+s.y);return c}w0.types=["Unknown","Point","LineString","Polygon"],w0.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var r,s=i.readVarint()+i.pos,c=1,h=0,p=0,m=0,x=[];i.pos<s;){if(h<=0){var b=i.readVarint();c=7&b,h=b>>3}if(h--,c===1||c===2)p+=i.readSVarint(),m+=i.readSVarint(),c===1&&(r&&x.push(r),r=[]),r.push(new pX(p,m));else{if(c!==7)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&x.push(r),x},w0.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var r=i.readVarint()+i.pos,s=1,c=0,h=0,p=0,m=1/0,x=-1/0,b=1/0,S=-1/0;i.pos<r;){if(c<=0){var I=i.readVarint();s=7&I,c=I>>3}if(c--,s===1||s===2)(h+=i.readSVarint())<m&&(m=h),h>x&&(x=h),(p+=i.readSVarint())<b&&(b=p),p>S&&(S=p);else if(s!==7)throw new Error("unknown command "+s)}return[m,b,x,S]},w0.prototype.toGeoJSON=function(i,r,s){var c,h,p=this.extent*Math.pow(2,s),m=this.extent*i,x=this.extent*r,b=this.loadGeometry(),S=w0.types[this.type];function I(F){for(var U=0;U<F.length;U++){var V=F[U];F[U]=[360*(V.x+m)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+x)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(c=0;c<b.length;c++)P[c]=b[c][0];I(b=P);break;case 2:for(c=0;c<b.length;c++)I(b[c]);break;case 3:for(b=function(F){var U=F.length;if(U<=1)return[F];for(var V,W,ee=[],ce=0;ce<U;ce++){var ue=gX(F[ce]);ue!==0&&(W===void 0&&(W=ue<0),W===ue<0?(V&&ee.push(V),V=[F[ce]]):V.push(F[ce]))}return V&&ee.push(V),ee}(b),c=0;c<b.length;c++)for(h=0;h<b[c].length;h++)I(b[c][h])}b.length===1?b=b[0]:S="Multi"+S;var D={type:"Feature",geometry:{type:S,coordinates:b},properties:this.properties};return"id"in this&&(D.id=this.id),D};var _X=PB,RB=kB;function kB(i,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(yX,this,r),this.length=this._features.length}function yX(i,r,s){i===15?r.version=s.readVarint():i===1?r.name=s.readString():i===5?r.extent=s.readVarint():i===2?r._features.push(s.pos):i===3?r._keys.push(s.readString()):i===4&&r._values.push(function(c){for(var h=null,p=c.readVarint()+c.pos;c.pos<p;){var m=c.readVarint()>>3;h=m===1?c.readString():m===2?c.readFloat():m===3?c.readDouble():m===4?c.readVarint64():m===5?c.readVarint():m===6?c.readSVarint():m===7?c.readBoolean():null}return h}(s))}kB.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var r=this._pbf.readVarint()+this._pbf.pos;return new _X(this._pbf,r,this.extent,this._keys,this._values)};var vX=RB;function xX(i,r,s){if(i===3){var c=new vX(s,s.readVarint()+s.pos);c.length&&(r[c.name]=c)}}var _3=vw.VectorTile=function(i,r){this.layers=i.readFields(xX,{},r)},xw=vw.VectorTileFeature=PB;vw.VectorTileLayer=RB;class hp extends Ut{constructor(r,s,c){super(r,s),this.z=c}}class DB extends hp{constructor(r,s,c,h){super(r,s,c),this.w=h}}function bw(i,r,s,c){const h=[],p=c===0?(m,x,b,S,I,P)=>{m.push(new Ut(P,b+(P-x)/(S-x)*(I-b)))}:(m,x,b,S,I,P)=>{m.push(new Ut(x+(P-b)/(I-b)*(S-x),P))};for(const m of i){const x=[];for(const b of m){if(b.length<=2)continue;const S=[];for(let D=0;D<b.length-1;D++){const F=b[D].x,U=b[D].y,V=b[D+1].x,W=b[D+1].y,ee=c===0?F:U,ce=c===0?V:W;ee<r?ce>r&&p(S,F,U,V,W,r):ee>s?ce<s&&p(S,F,U,V,W,s):S.push(b[D]),ce<r&&ee>=r&&p(S,F,U,V,W,r),ce>s&&ee<=s&&p(S,F,U,V,W,s)}let I=b[b.length-1];const P=c===0?I.x:I.y;P>=r&&P<=s&&S.push(I),S.length&&(I=S[S.length-1],S[0].x===I.x&&S[0].y===I.y||S.push(S[0]),x.push(S))}x.length&&h.push(x)}return h}function OB(i,r,s,c){const h=s==="x"?"y":"x",p=(c-i[s])/(r[s]-i[s]);i[h]=i[h]+(r[h]-i[h])*p,i[s]=c,i.hasOwnProperty("z")&&(i.z=_r(i.z,r.z,p)),i.hasOwnProperty("w")&&(i.w=_r(i.w,r.w,p))}function LB(i,r,s,c){const h=s,p=c;for(const m of["x","y"]){let x=i,b=r;x[m]>=b[m]&&(x=r,b=i),x[m]<h&&b[m]>h&&OB(x,b,m,h),x[m]<p&&b[m]>p&&OB(b,x,m,p)}}function ww(i,r){return i.x-r.x||i.y-r.y}function BB(i,r){return ww(i.min,r.min)===0&&ww(i.max,r.max)===0}function y3(i,r){return!(i.min.x>r.max.x||i.max.x<r.min.x||i.min.y>r.max.y||i.max.y<r.min.y)}function v3(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;s++)if(i[s].sourceId!==r[s].sourceId||!BB(i[s],r[s])||i[s].order!==r[s].order||i[s].clipMask!==r[s].clipMask)return!1;return!0}function FB(i,r,s){const c=1/Bt,h=1/(1<<s.canonical.z),p=(r.x*c+s.canonical.x)*h+s.wrap,m=(r.y*c+s.canonical.y)*h;return{min:new Ut((i.x*c+s.canonical.x)*h+s.wrap,(i.y*c+s.canonical.y)*h),max:new Ut(p,m)}}function bX(i,r,s){const c=1<<s.canonical.z,h=((r.x-s.wrap)*c-s.canonical.x)*Bt,p=(r.y*c-s.canonical.y)*Bt;return{min:new Ut(((i.x-s.wrap)*c-s.canonical.x)*Bt,(i.y*c-s.canonical.y)*Bt),max:new Ut(h,p)}}function zB(i,r,s,c,h,p,m){const x=i.indices,b=i.vertices,S=[];for(let I=c;I<c+h;I+=3){const P=r[s[I+0]+p],D=r[s[I+1]+p],F=r[s[I+2]+p],U=Math.min(P.x,D.x,F.x),V=Math.max(P.x,D.x,F.x),W=Math.min(P.y,D.y,F.y),ee=Math.max(P.y,D.y,F.y);S.length=0,i.grid.query(new Ut(U,W),new Ut(V,ee),S);for(let ce=0;ce<S.length;ce++){const ue=S[ce];if(r3(b[x[3*ue+0]],b[x[3*ue+1]],b[x[3*ue+2]],P,D,F,m))return!0}}return!1}function NB(i,r,s,c){if(!i||!s)return!1;let h=i.vertices;if(!r.canonical.equals(c.canonical)||r.wrap!==c.wrap){if(s.vertices.length<i.vertices.length)return NB(s,c,i,r);const p=r.canonical,m=c.canonical,x=Math.pow(2,m.z-p.z);h=i.vertices.map(b=>new Ut((b.x+p.x*Bt)*x-m.x*Bt,(b.y+p.y*Bt)*x-m.y*Bt))}return zB(s,h,i.indices,0,i.indices.length,0,0)}function UB(i,r,s,c){const h=Math.pow(2,c.z-s.z);return new Ut((i+s.x*Bt)*h-c.x*Bt,(r+s.y*Bt)*h-c.y*Bt)}function $B(i,r){const s=[];r.footprint.grid.queryPoint(i,s);const c=r.footprint.indices,h=r.footprint.vertices;for(let p=0;p<s.length;p++){const m=s[p];if(ad([h[c[3*m+0]],h[c[3*m+1]],h[c[3*m+2]]],i))return!0}return!1}class jB{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,s){const c=this.toIdx(r,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(r,s){return this.leaves[this.toIdx(r,s)]}toIdx(r,s){return s*this.size+r}}function VB(i,r,s,c){let h=0,p=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(c[m])<1e-15){if(s[m]<i[m]||s[m]>r[m])return null}else{const x=1/c[m];let b=(i[m]-s[m])*x,S=(r[m]-s[m])*x;if(b>S){const I=b;b=S,S=I}if(b>h&&(h=b),S<p&&(p=S),h>p)return null}return h}function HB(i,r,s,c,h,p,m,x,b,S,I){const P=c-i,D=h-r,F=p-s,U=m-i,V=x-r,W=b-s,ee=I[1]*W-I[2]*V,ce=I[2]*U-I[0]*W,ue=I[0]*V-I[1]*U,he=P*ee+D*ce+F*ue;if(Math.abs(he)<1e-15)return null;const Se=1/he,be=S[0]-i,ke=S[1]-r,Le=S[2]-s,je=(be*ee+ke*ce+Le*ue)*Se;if(je<0||je>1)return null;const ot=ke*F-Le*D,Ze=Le*P-be*F,dt=be*D-ke*P,At=(I[0]*ot+I[1]*Ze+I[2]*dt)*Se;return At<0||je+At>1?null:(U*ot+V*Ze+W*dt)*Se}function GB(i,r,s){return(i-r)/(s-r)}function WB(i,r,s,c,h,p,m,x,b){const S=1<<s,I=p-c,P=m-h,D=(i+1)/S*I+c,F=(r+0)/S*P+h,U=(r+1)/S*P+h;x[0]=(i+0)/S*I+c,x[1]=F,b[0]=D,b[1]=U}class qB{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(p){const m=Math.ceil(Math.log2(p.dim/8)),x=[];let b=Math.ceil(Math.pow(2,m));const S=1/b,I=(F,U,V,W,ee)=>{const ce=W?1:0,ue=(F+1)*V-ce,he=U*V,Se=(U+1)*V-ce;ee[0]=F*V,ee[1]=he,ee[2]=ue,ee[3]=Se};let P=new jB(b);const D=[];for(let F=0;F<b*b;F++){I(F%b,Math.floor(F/b),S,!1,D);const U=cd(D[0],D[1],p),V=cd(D[2],D[1],p),W=cd(D[2],D[3],p),ee=cd(D[0],D[3],p);P.minimums.push(Math.min(U,V,W,ee)),P.maximums.push(Math.max(U,V,W,ee)),P.leaves.push(1)}for(x.push(P),b/=2;b>=1;b/=2){const F=x[x.length-1];P=new jB(b);for(let U=0;U<b*b;U++){I(U%b,Math.floor(U/b),2,!0,D);const V=F.getElevation(D[0],D[1]),W=F.getElevation(D[2],D[1]),ee=F.getElevation(D[2],D[3]),ce=F.getElevation(D[0],D[3]),ue=F.isLeaf(D[0],D[1]),he=F.isLeaf(D[2],D[1]),Se=F.isLeaf(D[2],D[3]),be=F.isLeaf(D[0],D[3]),ke=Math.min(V.min,W.min,ee.min,ce.min),Le=Math.max(V.max,W.max,ee.max,ce.max),je=ue&&he&&Se&&be;P.maximums.push(Le),P.minimums.push(ke),P.leaves.push(Le-ke<=5&&je?1:0)}x.push(P)}return x}(this.dem),c=s.length-1,h=s[c];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(r,s,c,h,p,m,x=1){return VB([r,s,-100],[c,h,this.maximums[0]*x],p,m)}raycast(r,s,c,h,p,m,x=1){if(!this.nodeCount)return null;const b=this.raycastRoot(r,s,c,h,p,m,x);if(b==null)return null;const S=[],I=[],P=[],D=[],F=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:U,t:V,nodex:W,nodey:ee,depth:ce}=F.pop();if(this.leaves[U]){WB(W,ee,ce,r,s,c,h,P,D);const he=1<<ce,Se=(W+0)/he,be=(W+1)/he,ke=(ee+0)/he,Le=(ee+1)/he,je=cd(Se,ke,this.dem)*x,ot=cd(be,ke,this.dem)*x,Ze=cd(be,Le,this.dem)*x,dt=cd(Se,Le,this.dem)*x,At=HB(P[0],P[1],je,D[0],P[1],ot,D[0],D[1],Ze,p,m),ct=HB(D[0],D[1],Ze,P[0],D[1],dt,P[0],P[1],je,p,m),bt=Math.min(At!==null?At:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(bt!==Number.MAX_VALUE)return bt;{const st=a._.scaleAndAdd([],p,m,V);if(KB(je,ot,dt,Ze,GB(st[0],P[0],D[0]),GB(st[1],P[1],D[1]))>=st[2])return V}continue}let ue=0;for(let he=0;he<this._siblingOffset.length;he++){WB((W<<1)+this._siblingOffset[he][0],(ee<<1)+this._siblingOffset[he][1],ce+1,r,s,c,h,P,D),P[2]=-100,D[2]=this.maximums[this.childOffsets[U]+he]*x;const Se=VB(P,D,p,m);if(Se!=null){const be=Se;S[he]=be;let ke=!1;for(let Le=0;Le<ue&&!ke;Le++)be>=S[I[Le]]&&(I.splice(Le,0,he),ke=!0);ke||(I[ue]=he),ue++}}for(let he=0;he<ue;he++){const Se=I[he];F.push({idx:this.childOffsets[U]+Se,t:S[Se],nodex:(W<<1)+this._siblingOffset[Se][0],nodey:(ee<<1)+this._siblingOffset[Se][1],depth:ce+1})}}return null}_addNode(r,s,c){return this.minimums.push(r),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(r,s,c,h,p){if(r[h].isLeaf(s,c)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const m=h-1,x=r[m];let b=0,S=0;for(let I=0;I<this._siblingOffset.length;I++){const P=2*s+this._siblingOffset[I][0],D=2*c+this._siblingOffset[I][1],F=x.getElevation(P,D),U=x.isLeaf(P,D),V=this._addNode(F.min,F.max,U);U&&(b|=1<<I),S||(S=V)}for(let I=0;I<this._siblingOffset.length;I++)b&1<<I||this._construct(r,2*s+this._siblingOffset[I][0],2*c+this._siblingOffset[I][1],m,S+I)}}function KB(i,r,s,c,h,p){return _r(_r(i,s,p),_r(r,c,p),h)}function cd(i,r,s){const c=s.dim,h=Kr(i*c-.5,0,c-1),p=Kr(r*c-.5,0,c-1),m=Math.floor(h),x=Math.floor(p),b=Math.min(m+1,c-1),S=Math.min(x+1,c-1);return KB(s.get(m,x),s.get(b,x),s.get(m,S),s.get(b,S),h-m,p-x)}const wX={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function CX(i,r,s){return(256*i*256+256*r+s)/10-1e4}function EX(i,r,s){return 256*i+r+s/256-32768}class Cw{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,s,c,h=!1){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Pi(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const p=this.dim=s.height-2,m=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=h,this._modifiedForSources={},!h){for(let b=0;b<p;b++)m[this._idx(-1,b)]=m[this._idx(0,b)],m[this._idx(p,b)]=m[this._idx(p-1,b)],m[this._idx(b,-1)]=m[this._idx(b,0)],m[this._idx(b,p)]=m[this._idx(b,p-1)];m[this._idx(-1,-1)]=m[this._idx(0,0)],m[this._idx(p,-1)]=m[this._idx(p-1,0)],m[this._idx(-1,p)]=m[this._idx(0,p-1)],m[this._idx(p,p)]=m[this._idx(p-1,p-1)]}const x=c==="terrarium"?EX:CX;for(let b=0;b<m.length;++b){const S=4*b;this.floatView[b]=x(this.pixels[S],this.pixels[S+1],this.pixels[S+2])}this._timestamp=Io.now()}_buildQuadTree(){this._tree=new qB(this)}get(r,s,c=!1){c&&(r=Kr(r,-1,this.dim),s=Kr(s,-1,this.dim));const h=this._idx(r,s);return this.floatView[h]}set(r,s,c){const h=this._idx(r,s),p=this.floatView[h];return this.floatView[h]=c,c-p}static getUnpackVector(r){return wX[r]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}static pack(r,s){const c=[0,0,0,0],h=Cw.getUnpackVector(s);let p=Math.floor((r+h[3])/h[2]);return c[2]=p%256,p=Math.floor(p/256),c[1]=p%256,p=Math.floor(p/256),c[0]=p,c}getPixels(){return new EB({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,s,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let h=s*this.dim,p=s*this.dim+this.dim,m=c*this.dim,x=c*this.dim+this.dim;switch(s){case-1:h=p-1;break;case 1:p=h+1}switch(c){case-1:m=x-1;break;case 1:x=m+1}const b=-s*this.dim,S=-c*this.dim;for(let I=m;I<x;I++)for(let P=h;P<p;P++){const D=4*this._idx(P,I),F=4*this._idx(P+b,I+S);this.pixels[D+0]=r.pixels[F+0],this.pixels[D+1]=r.pixels[F+1],this.pixels[D+2]=r.pixels[F+2],this.pixels[D+3]=r.pixels[F+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}pe(Cw,"DEMData"),pe(qB,"DemMinMaxQuadTree",{omit:["dem"]});class C0{constructor(r,s,c){this._demTile=r,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(r,s,c){const h=c||r.findDEMTileFor(s);if(!h||!h.dem)return;const p=h.dem,m=h.tileID,x=1<<s.canonical.z-m.canonical.z;return new C0(h,p.dim/Bt/x,[(s.canonical.x/x-m.canonical.x)*p.dim,(s.canonical.y/x-m.canonical.y)*p.dim])}tileCoordToPixel(r,s){const c=s*this._scale+this._offset[1],h=Math.floor(r*this._scale+this._offset[0]),p=Math.floor(c);return new Ut(h,p)}getElevationAt(r,s,c,h){const p=r*this._scale+this._offset[0],m=s*this._scale+this._offset[1],x=Math.floor(p),b=Math.floor(m),S=this._dem;return h=!!h,c?_r(_r(S.get(x,b,h),S.get(x,b+1,h),m-b),_r(S.get(x+1,b,h),S.get(x+1,b+1,h),m-b),p-x):S.get(x,b,h)}getElevationAtPixel(r,s,c){return this._dem.get(r,s,!!c)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*Ds(1,r)*this._dem.stride}}const YB={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},SX=xw.types,TX=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],AX=["fill-extrusion-flood-light-ground-radius"],IX=Math.pow(2,13),MX=Math.pow(2,15)-1,ZB=new Ut(0,1),ud=2147483648;function dv(i,r,s,c,h,p,m,x){i.emplaceBack((r<<1)+m,(s<<1)+p,(Math.floor(c*IX)<<1)+h,Math.round(x))}function Ew(i,r,s,c,h,p){i.emplaceBack(r.x,r.y,(s.x<<1)+c,(s.y<<1)+h,p)}function fv(i,r,s){i.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class XB{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class QB{constructor(){this.centroidXY=new Ut(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ut(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ut(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ut(this.max.x-this.min.x,this.max.y-this.min.y)}}class JB{constructor(){this.acc=new Ut(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,s){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=s.x,r.min.y=r.max.y=s.y)}appendEdge(r,s,c){this.accCount++,this.acc._add(s);let h=!!this.borders;s.x<r.min.x?(r.min.x=s.x,h=!0):s.x>r.max.x&&(r.max.x=s.x,h=!0),s.y<r.min.y?(r.min.y=s.y,h=!0):s.y>r.max.y&&(r.max.y=s.y,h=!0),((s.x===0||s.x===Bt)&&s.x===c.x)!=((s.y===0||s.y===Bt)&&s.y===c.y)&&this.processBorderOverlap(s,c),h&&this.checkBorderIntersection(s,c)}checkBorderIntersection(r,s){s.x<0!=r.x<0&&this.addBorderIntersection(0,_r(s.y,r.y,(0-s.x)/(r.x-s.x))),s.x>Bt!=r.x>Bt&&this.addBorderIntersection(1,_r(s.y,r.y,(Bt-s.x)/(r.x-s.x))),s.y<0!=r.y<0&&this.addBorderIntersection(2,_r(s.x,r.x,(0-s.y)/(r.y-s.y))),s.y>Bt!=r.y>Bt&&this.addBorderIntersection(3,_r(s.x,r.x,(Bt-s.y)/(r.y-s.y)))}addBorderIntersection(r,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[r];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(r,s){if(r.x===s.x){if(r.y===s.y)return;const c=r.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,r.y)}else{const c=r.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,r.x)}}centroid(){return this.accCount===0?new Ut(0,0):new Ut(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((r,s)=>r+ +(s[0]!==Number.MAX_VALUE),0):0}}function eF(i,r){const s=i.add(r)._unit(),c=Kr(i.x*s.x+i.y*s.y,-1,1);var h,p,m;return h=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(h)))/4*MX*((p=i).x*(m=r).y-p.y*m.x<0?-1:1)}const PX=[i=>i.x<0,i=>i.x>Bt,i=>i.y<0,i=>i.y>Bt];function RX(i,r,s,c){const h=[4];if(c===0)return h;s._mult(c);const p=i.sub(s),m=r.sub(s),x=[i,r,p,m];for(let b=0;b<4;b++)for(const S of x)if(PX[b](S)){h.push(b);break}return h}class tF{constructor(r){this.vertexArray=new EI,this.indexArray=new vo,this.programConfigurations=new od(r.layers,{zoom:r.zoom,lut:r.lut},s=>AX.includes(s)),this._segments=new hi,this.hiddenByLandmarkVertexArray=new zI,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new hi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(r,s,c,h=!1){const p=r.length;if(p>2){let m=Math.max(0,this._segments.get().length-1);const x=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[m].length);let b;m!==this._segments.get().length-1&&(m++,this._segmentToGroundQuads[m]=[],this._segmentToRegionTriCounts[m]=[0,0,0,0,0]);{const S=r[0],I=r[1];b=eF(S.sub(r[p-1])._perp()._unit(),I.sub(S)._perp()._unit())}for(let S=0;S<p;S++){const I=S===p-1?0:S+1,P=r[S],D=r[I],F=r[I===p-1?0:I+1],U=D.sub(P)._perp()._unit(),V=eF(U,F.sub(D)._perp()._unit()),W=b,ee=V;if(x3(P,D,s)||h&&iF(P,s)&&iF(D,s)){b=V;continue}const ce=x.vertexLength;Ew(this.vertexArray,P,D,1,1,W),Ew(this.vertexArray,P,D,1,0,W),Ew(this.vertexArray,P,D,0,1,ee),Ew(this.vertexArray,P,D,0,0,ee),x.vertexLength+=4;const ue=RX(P,D,U,c);for(const he of ue)this._segmentToGroundQuads[m].push({id:ce,region:he}),this._segmentToRegionTriCounts[m][he]+=2,x.primitiveLength+=2;b=V}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),s=r.length;for(let c=0;c<s;c++)this._segmentToGroundQuads[c].sort((h,p)=>h.region-p.region);for(let c=0;c<s;c++){const h=this._segmentToGroundQuads[c],p=r[c],m=this._segmentToRegionTriCounts[c];m.reduce((b,S)=>b+S,0);let x=0;for(let b=0;b<=4;b++){const S=m[b];if(S!==0){let I=this.regionSegments[b];I||(I=this.regionSegments[b]=new hi);const P={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+x,vertexLength:p.vertexLength,primitiveLength:S};I.get().push(P)}x+=S}for(let b=0;b<h.length;b++){const S=h[b].id;this.indexArray.emplaceBack(S,S+1,S+3),this.indexArray.emplaceBack(S,S+3,S+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,s,c,h,p,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,s,c,h,p,m)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,cX.members),this.indexBuffer=r.createIndexBuffer(this.indexArray))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,s,c,h,p,m){this.hasData()&&this.programConfigurations.updatePaintArrays(r,s,c,h,p,m)}updateHiddenByLandmark(r){if(!this.hasData())return;const s=r.groundVertexCount+r.groundVertexArrayOffset;if(r.groundVertexCount===0)return;const c=r.flags&ud?1:0;for(let h=r.groundVertexArrayOffset;h<s;++h)this.hiddenByLandmarkVertexArray.emplace(h,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,hX.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const s=this.regionSegments[r];s&&s.destroy()}}}}class Sw{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new vo,this.footprintVertices=new Yl,this.footprintSegments=[],this.layoutVertexArray=new Jh,this.centroidVertexArray=new UL,this.indexArray=new vo,this.programConfigurations=new od(r.layers,{zoom:r.zoom,lut:r.lut},s=>TX.includes(s)),this.segments=new hi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new tF(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(r,s){}populate(r,s,c,h){this.features=[],this.hasPattern=p3("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=sw(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:m,index:x,sourceLayerIndex:b}of r){const S=this.layers[0]._featureFilter.needGeometry,I=$u(p,S);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),I,c))continue;const P={id:m,sourceLayerIndex:b,index:x,geometry:S?I.geometry:Xl(p,c,h),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(m3("fill-extrusion",this.layers,P,this.zoom,s)):this.addFeature(P,P.geometry,x,c,{},s.availableImages,h,s.brightness),s.featureIndex.insert(p,P.geometry,x,b,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,s,c,h,p,m){for(const x of this.features){const{geometry:b}=x;this.addFeature(x,b,x.index,s,c,h,p,m)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(r,s,c,h,p){const m=Object.keys(r).length!==0;if(m&&!this.stateDependentLayers.length)return;const x=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(r,s,x,c,h,p),this.groundEffect.update(r,s,x,c,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,fX),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,dX.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,uX.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,c,h,p,m,x,b){const S=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(r,{})/this.tileToMeter,I=[new Ut(0,0),new Ut(Bt,Bt)],P=x.projection,D=P.name==="globe",F=SX[r.type]==="Polygon",U=new JB;U.centroidDataIndex=this.centroidData.length;const V=new QB,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(r,{},h)<=0,ee=this.layers[0].paint.get("fill-extrusion-height").evaluate(r,{},h);V.height=ee,V.vertexArrayOffset=this.layoutVertexArray.length,V.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new tw);const ce=_w(s,500);for(let Le=ce.length-1;Le>=0;Le--){const je=ce[Le];(je.length===0||(ue=je[0]).every(ot=>ot.x<=0)||ue.every(ot=>ot.x>=Bt)||ue.every(ot=>ot.y<=0)||ue.every(ot=>ot.y>=Bt))&&ce.splice(Le,1)}var ue;let he;if(D)he=lF(ce,I,h);else{he=[];for(const Le of ce)he.push({polygon:Le,bounds:I})}const Se=F?this.edgeRadius:0,be=Se>0&&this.zoom<17,ke=(Le,je)=>{if(Le.length===0)return!1;const ot=Le[Le.length-1];return je.x===ot.x&&je.y===ot.y};for(const{polygon:Le,bounds:je}of he){let ot=0,Ze=0;for(const bt of Le)F&&!bt[0].equals(bt[bt.length-1])&&bt.push(bt[0]),Ze+=F?bt.length-1:bt.length;const dt=this.segments.prepareSegment((F?5:4)*Ze,this.layoutVertexArray,this.indexArray);V.footprintSegIdx<0&&(V.footprintSegIdx=this.footprintSegments.length),V.polygonSegIdx<0&&(V.polygonSegIdx=this.polygonSegments.length);const At={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ct=new XB;if(ct.vertexOffset=this.footprintVertices.length,ct.indexOffset=3*this.footprintIndices.length,ct.ringIndices=[],F){const bt=[],st=[];ot=dt.vertexLength;for(let Pt=0;Pt<Le.length;Pt++){const Tt=Le[Pt];Tt.length&&Pt!==0&&st.push(bt.length/2);const Ht=[];let It,Dt;It=Tt[1].sub(Tt[0])._perp()._unit(),ct.ringIndices.push(Tt.length-1);for(let fr=1;fr<Tt.length;fr++){const lr=Tt[fr],sr=Tt[fr===Tt.length-1?1:fr+1],Rt=lr.clone();if(Se){Dt=sr.sub(lr)._perp()._unit();const mr=It.add(Dt)._unit(),jr=Se*Math.min(4,1/(It.x*mr.x+It.y*mr.y));Rt.x+=jr*mr.x,Rt.y+=jr*mr.y,Rt.x=Math.round(Rt.x),Rt.y=Math.round(Rt.y),It=Dt}!W||Se!==0&&!be||ke(Ht,Rt)||Ht.push(Rt),dv(this.layoutVertexArray,Rt.x,Rt.y,0,0,1,1,0),dt.vertexLength++,this.footprintVertices.emplaceBack(lr.x,lr.y),bt.push(lr.x,lr.y),D&&fv(this.layoutVertexExtArray,P.projectTilePoint(Rt.x,Rt.y,h),P.upVector(h,Rt.x,Rt.y))}W&&(Se===0||be)&&(Ht.length!==0&&ke(Ht,Ht[0])&&Ht.pop(),this.groundEffect.addData(Ht,je,S))}const wt=lv(bt,st);for(let Pt=0;Pt<wt.length;Pt+=3)this.footprintIndices.emplaceBack(ct.vertexOffset+wt[Pt+0],ct.vertexOffset+wt[Pt+1],ct.vertexOffset+wt[Pt+2]),this.indexArray.emplaceBack(ot+wt[Pt],ot+wt[Pt+2],ot+wt[Pt+1]),dt.primitiveLength++;ct.indexCount+=wt.length,ct.vertexCount+=this.footprintVertices.length-ct.vertexOffset}for(let bt=0;bt<Le.length;bt++){const st=Le[bt];U.startRing(V,st[0]);let wt=st.length>4&&oF(st[st.length-2],st[0],st[1]),Pt=Se?kX(st[st.length-2],st[0],st[1],Se):0;const Tt=[];let Ht,It,Dt;It=st[1].sub(st[0])._perp()._unit();let fr=!0;for(let lr=1,sr=0;lr<st.length;lr++){let Rt=st[lr-1],mr=st[lr];const jr=st[lr===st.length-1?1:lr+1];if(U.appendEdge(V,mr,Rt),x3(mr,Rt,je)){Se&&(It=jr.sub(mr)._perp()._unit(),fr=!fr);continue}const Sr=mr.sub(Rt)._perp(),Wr=Sr.x/(Math.abs(Sr.x)+Math.abs(Sr.y)),Vr=Sr.y>0?1:0,Qr=Rt.dist(mr);if(sr+Qr>32768&&(sr=0),Se){Dt=jr.sub(mr)._perp()._unit();let bn=nF(Rt,mr,jr,rF(It,Dt),Se);isNaN(bn)&&(bn=0);const cn=mr.sub(Rt)._unit();Rt=Rt.add(cn.mult(Pt))._round(),mr=mr.add(cn.mult(-bn))._round(),Pt=bn,It=Dt,W&&this.zoom>=17&&(ke(Tt,Rt)||Tt.push(Rt),ke(Tt,mr)||Tt.push(mr))}const br=dt.vertexLength,Bn=st.length>4&&oF(Rt,mr,jr);let On=sF(sr,wt,fr);if(dv(this.layoutVertexArray,Rt.x,Rt.y,Wr,Vr,0,0,On),dv(this.layoutVertexArray,Rt.x,Rt.y,Wr,Vr,0,1,On),sr+=Qr,On=sF(sr,Bn,!fr),wt=Bn,dv(this.layoutVertexArray,mr.x,mr.y,Wr,Vr,0,0,On),dv(this.layoutVertexArray,mr.x,mr.y,Wr,Vr,0,1,On),dt.vertexLength+=4,this.indexArray.emplaceBack(br+0,br+1,br+2),this.indexArray.emplaceBack(br+1,br+3,br+2),dt.primitiveLength+=2,Se){const bn=ot+(lr===1?st.length-2:lr-2),cn=lr===1?ot:bn+1;if(this.indexArray.emplaceBack(br+1,bn,br+3),this.indexArray.emplaceBack(bn,cn,br+3),dt.primitiveLength+=2,Ht===void 0&&(Ht=br),!x3(jr,st[lr],je)){const wn=lr===st.length-1?Ht:dt.vertexLength;this.indexArray.emplaceBack(br+2,br+3,wn),this.indexArray.emplaceBack(br+3,wn+1,wn),this.indexArray.emplaceBack(br+3,cn,wn+1),dt.primitiveLength+=3}fr=!fr}if(D){const bn=this.layoutVertexExtArray,cn=P.projectTilePoint(Rt.x,Rt.y,h),wn=P.projectTilePoint(mr.x,mr.y,h),Qn=P.upVector(h,Rt.x,Rt.y),$n=P.upVector(h,mr.x,mr.y);fv(bn,cn,Qn),fv(bn,cn,Qn),fv(bn,wn,$n),fv(bn,wn,$n)}}F&&(ot+=st.length-1),W&&Se&&this.zoom>=17&&(Tt.length!==0&&ke(Tt,Tt[0])&&Tt.pop(),this.groundEffect.addData(Tt,je,S,Se>0))}this.footprintSegments.push(ct),At.triangleCount=this.indexArray.length-At.triangleArrayOffset,this.polygonSegments.push(At),++V.footprintSegLen,++V.polygonSegLen}if(V.vertexCount=this.layoutVertexArray.length-V.vertexArrayOffset,V.groundVertexCount=this.groundEffect.vertexArray.length-V.groundVertexArrayOffset,V.vertexCount!==0){if(V.centroidXY=U.borders?ZB:this.encodeCentroid(U,V),this.centroidData.push(V),U.borders){this.featuresOnBorder.push(U);const Le=this.featuresOnBorder.length-1;for(let je=0;je<U.borders.length;je++)U.borders[je][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[je].push(Le)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,p,m,h,b),this.groundEffect.addPaintPropertiesData(r,c,p,m,h,b),this.maxHeight=Math.max(this.maxHeight,ee)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort((s,c)=>this.featuresOnBorder[s].borders[r][0]-this.featuresOnBorder[c].borders[r][0])}splitToSubtiles(){const r=[];for(let x=0;x<this.centroidData.length;x++){const b=this.centroidData[x],S=+(b.min.y+b.max.y>Bt),I=2*S+(+(b.min.x+b.max.x>Bt)^S);for(let P=0;P<b.polygonSegLen;P++){const D=b.polygonSegIdx+P;r.push({centroidIdx:x,subtile:I,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const s=new vo;r.sort((x,b)=>x.triangleSegmentIdx===b.triangleSegmentIdx?x.subtile-b.subtile:x.triangleSegmentIdx-b.triangleSegmentIdx);let c=0,h=0,p=0;for(const x of r){if(x.triangleSegmentIdx!==c)break;p++}const m=r.length;for(;h!==r.length;){c=r[h].triangleSegmentIdx;let x=0,b=h,S=h;for(let I=b;I<p&&r[I].subtile===x;I++)S++;for(;b!==p;){const I=r[b];x=I.subtile;const P=this.centroidData[I.centroidIdx].min.clone(),D=this.centroidData[I.centroidIdx].max.clone(),F={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let U=b;U<S;U++){const V=r[U],W=this.polygonSegments[V.polygonSegmentIdx],ee=this.centroidData[V.centroidIdx].min,ce=this.centroidData[V.centroidIdx].max,ue=this.indexArray.uint16;for(let he=W.triangleArrayOffset;he<W.triangleArrayOffset+W.triangleCount;he++)s.emplaceBack(ue[3*he],ue[3*he+1],ue[3*he+2]);F.primitiveLength+=W.triangleCount,P.x=Math.min(P.x,ee.x),P.y=Math.min(P.y,ee.y),D.x=Math.max(D.x,ce.x),D.y=Math.max(D.y,ce.y)}F.primitiveLength>0&&this.triangleSubSegments.push({segment:F,min:P,max:D}),b=S;for(let U=b;U<p&&r[U].subtile===r[b].subtile;U++)S++}h=p;for(let I=h;I<m&&r[I].triangleSegmentIdx===r[h].triangleSegmentIdx;I++)p++}s._trim(),this.indexArray=s}getVisibleSegments(r,s,c){let h=0,p=0;const m=1<<r.canonical.z;if(s){const V=s.getMinMaxForTile(r);V&&(h=V.min,p=V.max)}p+=this.maxHeight;const x=r.toUnwrapped();let b;const S=[x.canonical.x/m+x.wrap,x.canonical.y/m],I=[(x.canonical.x+1)/m+x.wrap,(x.canonical.y+1)/m],P=new hi,D=(V,W,ee)=>[V[0]*(1-ee[0])+W[0]*ee[0],V[1]*(1-ee[1])+W[1]*ee[1]],F=[],U=[];for(const V of this.triangleSubSegments){F[0]=V.min.x/Bt,F[1]=V.min.y/Bt,U[0]=V.max.x/Bt,U[1]=V.max.y/Bt;const W=D(S,I,F),ee=D(S,I,U);if(new di([W[0],W[1],h],[ee[0],ee[1],p]).intersectsPrecise(c)===0){b&&(P.segments.push(b),b=void 0);continue}const ce=V.segment;b&&b.vertexOffset!==ce.vertexOffset&&(P.segments.push(b),b=void 0),b?(b.vertexLength+=ce.vertexLength,b.primitiveLength+=ce.primitiveLength):b={vertexOffset:ce.vertexOffset,primitiveLength:ce.primitiveLength,vertexLength:ce.vertexLength,primitiveOffset:ce.primitiveOffset,sortKey:void 0,vaos:{}}}return b&&P.segments.push(b),P}encodeCentroid(r,s){const c=r.centroid(),h=s.span(),p=Math.min(7,Math.round(h.x*this.tileToMeter/10)),m=Math.min(7,Math.round(h.y*this.tileToMeter/10));return new Ut(Kr(c.x,1,Bt-1)<<3|p,Kr(c.y,1,Bt-1)<<3|m)}encodeBorderCentroid(r){if(!r.borders)return new Ut(0,0);const s=r.borders,c=Number.MAX_VALUE;if(s[0][0]!==c||s[1][0]!==c){const h=s[0][0]!==c?0:1;return new Ut(6|(s[0][0]!==c?0:65528),(s[h][0]+s[h][1])/2<<3|6)}{const h=s[2][0]!==c?2:3;return new Ut((s[h][0]+s[h][1])/2<<3|6,6|(s[2][0]!==c?0:65528))}}showCentroid(r){const s=this.centroidData[r.centroidDataIndex];s.flags&=ud,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const s=r.vertexArrayOffset,c=r.vertexCount+r.vertexArrayOffset,h=r.flags&ud?ZB:r.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==h.y||p!==h.x){for(let m=s;m<c;++m)this.centroidVertexArray.emplace(m,h.x,h.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,s,c){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(r.toUnwrapped());if(v3(this.activeReplacements,h))return;if(this.activeReplacements=h,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const m of this.centroidData)m.flags&=2147483647;const p=[];for(const m of this.activeReplacements){if(m.order<c)continue;const x=Math.pow(2,m.footprintTileId.canonical.z-r.canonical.z);for(const b of this.centroidData)if(!(b.flags&ud||m.min.x>b.max.x||b.min.x>m.max.x||m.min.y>b.max.y||b.min.y>m.max.y))for(let S=0;S<b.footprintSegLen;S++){const I=this.footprintSegments[b.footprintSegIdx+S];if(p.length=0,DX(this.footprintVertices,I.vertexOffset,I.vertexCount,m.footprintTileId.canonical,r.canonical,p),zB(m.footprint,p,this.footprintIndices.uint16,I.indexOffset,I.indexCount,-I.vertexOffset,-x)){b.flags|=ud;break}}}for(const m of this.centroidData)this.writeCentroidToBuffer(m);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,s,c){let h=!1;for(let p=0;p<c.footprintSegLen;p++){const m=this.footprintSegments[c.footprintSegIdx+p];let x=0;for(const b of m.ringIndices){for(let S=x,I=b+x-1;S<b+x;I=S++){const P=this.footprintVertices.int16[2*(S+m.vertexOffset)+0],D=this.footprintVertices.int16[2*(S+m.vertexOffset)+1],F=this.footprintVertices.int16[2*(I+m.vertexOffset)+1];D>s!=F>s&&r<(this.footprintVertices.int16[2*(I+m.vertexOffset)+0]-P)*(s-D)/(F-D)+P&&(h=!h)}x=b}}return h}getHeightAtTileCoord(r,s){let c=Number.NEGATIVE_INFINITY,h=!0;const p=4*(r+Bt)*Bt+(s+Bt);if(this.partLookup.hasOwnProperty(p)){const m=this.partLookup[p];return m?{height:m.height,hidden:!!(m.flags&ud)}:void 0}for(const m of this.centroidData)r>m.max.x||m.min.x>r||s>m.max.y||m.min.y>s||this.footprintContainsPoint(r,s,m)&&m&&m.height>c&&(c=m.height,this.partLookup[p]=m,h=!!(m.flags&ud));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:h};this.partLookup[p]=void 0}}function rF(i,r){const s=i.add(r)._unit();return i.x*s.x+i.y*s.y}function kX(i,r,s,c){const h=r.sub(i)._perp()._unit(),p=s.sub(r)._perp()._unit();return nF(i,r,s,rF(h,p),c)}function nF(i,r,s,c,h){const p=Math.sqrt(1-c*c);return Math.min(i.dist(r)/3,r.dist(s)/3,h*p/c)}function x3(i,r,s){return i.x<s[0].x&&r.x<s[0].x||i.x>s[1].x&&r.x>s[1].x||i.y<s[0].y&&r.y<s[0].y||i.y>s[1].y&&r.y>s[1].y}function iF(i,r){return i.x<r[0].x||i.x>r[1].x||i.y<r[0].y||i.y>r[1].y}function oF(i,r,s){if(i.x<0||i.x>=Bt||r.x<0||r.x>=Bt||s.x<0||s.x>=Bt)return!1;const c=s.sub(r),h=c.perp(),p=i.sub(r);return(c.x*p.x+c.y*p.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function sF(i,r,s){const c=r?2|i:-3&i;return s?1|c:-2&c}function aF(){const i=Math.PI/32,r=Math.tan(i),s=y0;return s*Math.sqrt(1+2*r*r)-s}function lF(i,r,s){const c=1<<s.z,h=Ys(s.x/c),p=Ys((s.x+1)/c),m=Ro(s.y/c),x=Ro((s.y+1)/c);return function(b,S,I,P,D=0,F){const U=[];if(!b.length||!I||!P)return U;const V=(be,ke)=>{for(const Le of be)U.push({polygon:Le,bounds:ke})},W=Math.ceil(Math.log2(I)),ee=Math.ceil(Math.log2(P)),ce=W-ee,ue=[];for(let be=0;be<Math.abs(ce);be++)ue.push(ce>0?0:1);for(let be=0;be<Math.min(W,ee);be++)ue.push(0),ue.push(1);let he=b;if(he=bw(he,S[0].y-D,S[1].y+D,1),he=bw(he,S[0].x-D,S[1].x+D,0),!he.length)return U;const Se=[];for(ue.length?Se.push({polygons:he,bounds:S,depth:0}):V(he,S);Se.length;){const be=Se.pop(),ke=be.depth,Le=ue[ke],je=be.bounds[0],ot=be.bounds[1],Ze=Le===0?je.x:je.y,dt=Le===0?ot.x:ot.y,At=F?F(Le,Ze,dt):.5*(Ze+dt),ct=bw(be.polygons,Ze-D,At+D,Le),bt=bw(be.polygons,At-D,dt+D,Le);if(ct.length){const st=[je,new Ut(Le===0?At:ot.x,Le===1?At:ot.y)];ue.length>ke+1?Se.push({polygons:ct,bounds:st,depth:ke+1}):V(ct,st)}if(bt.length){const st=[new Ut(Le===0?At:je.x,Le===1?At:je.y),ot];ue.length>ke+1?Se.push({polygons:bt,bounds:st,depth:ke+1}):V(bt,st)}}return U}(i,r,Math.ceil((p-h)/11.25),Math.ceil((m-x)/11.25),1,(b,S,I)=>{if(b===0)return .5*(S+I);{const P=Ro((s.y+S/Bt)/c);return(Uc(.5*(Ro((s.y+I/Bt)/c)+P))*c-s.y)*Bt}})}function DX(i,r,s,c,h,p){const m=Math.pow(2,c.z-h.z);for(let x=0;x<s;x++){let b=i.int16[2*(x+r)+0],S=i.int16[2*(x+r)+1];b=(b+h.x*Bt)*m-c.x*Bt,S=(S+h.y*Bt)*m-c.y*Bt,p.push(new Ut(b,S))}}pe(Sw,"FillExtrusionBucket",{omit:["layers","features"]}),pe(QB,"PartData"),pe(XB,"FootprintSegment"),pe(JB,"BorderCentroidData"),pe(tF,"GroundEffect");const OX=new Sn({visibility:new yt(Ve["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new yt(Ve["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var LX={paint:new Sn({"fill-extrusion-opacity":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new jt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new yt(Ve["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:OX};function pv(i,r){return i.x*r.x+i.y*r.y}function cF(i,r){if(i.length===1){let s=0;const c=r[s++];let h;for(;!h||c.equals(h);)if(h=r[s++],!h)return 1/0;for(;s<r.length;s++){const p=r[s],m=i[0],x=h.sub(c),b=p.sub(c),S=m.sub(c),I=pv(x,x),P=pv(x,b),D=pv(b,b),F=pv(S,x),U=pv(S,b),V=I*D-P*P,W=(D*F-P*U)/V,ee=(I*U-P*F)/V,ce=c.z*(1-W-ee)+h.z*W+p.z*ee;if(isFinite(ce))return ce}return 1/0}{let s=1/0;for(const c of r)s=Math.min(s,c.z);return s}}function uF(i,r,s,c,h,p,m,x){const b=m*h.getElevationAt(i,r,!0,!0),S=p[0]!==0,I=S?p[1]===0?m*(p[0]/7-450):m*function(P,D,F){const U=Math.floor(D[0]/8),V=Math.floor(D[1]/8),W=10*(D[0]-8*U),ee=10*(D[1]-8*V),ce=P.getElevationAt(U,V,!0,!0),ue=P.getMeterToDEM(F),he=Math.floor(.5*(W*ue-1)),Se=Math.floor(.5*(ee*ue-1)),be=P.tileCoordToPixel(U,V),ke=2*he+1,Le=2*Se+1,je=function(bt,st,wt,Pt,Tt){return[bt.getElevationAtPixel(st,wt,!0),bt.getElevationAtPixel(st+Tt,wt,!0),bt.getElevationAtPixel(st,wt+Tt,!0),bt.getElevationAtPixel(st+Pt,wt+Tt,!0)]}(P,be.x-he,be.y-Se,ke,Le),ot=Math.abs(je[0]-je[1]),Ze=Math.abs(je[2]-je[3]),dt=Math.abs(je[0]-je[2])+Math.abs(je[1]-je[3]),At=Math.min(.25,.5*ue*(ot+Ze)/ke),ct=Math.min(.25,.5*ue*dt/Le);return ce+Math.max(At*W,ct*ee)}(h,p,x):b;return{base:b+(s===0)?-1:s,top:S?Math.max(I+c,b+s+2):b+c}}const BX=Tn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:FX}=BX,zX=Tn([{name:"a_packed",components:4,type:"Float32"}]),{members:NX}=zX,UX=Tn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:$X}=UX,jX=Tn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),VX=Tn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),HX=Tn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Tn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const b3=Tn([{name:"a_occlusion_query_opacity",components:1,type:"Float32"}],4),hF=Tn([{name:"a_z_offset",components:1,type:"Float32"}],4),GX=Tn([{name:"a_texb",components:2,type:"Uint16"}]),WX=Tn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),qX=Tn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Tn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const dF=Tn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),KX=Tn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Tn([{name:"triangle",components:3,type:"Uint16"}]),Tn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Tn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Float32",name:"occlusionState"},{type:"Float32",name:"occlusionOpacity"},{type:"Uint8",name:"hasIconTextFit"}]),Tn([{type:"Float32",name:"offsetX"}]),Tn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class fF{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.image=new ld({width:r,height:s}),this.positions={},this.uploaded=!1}getDash(r,s){const c=this.getKey(r,s);return this.positions[c]}trim(){const r=this.width,s=this.height=ty(this.nextRow);this.image.resize({width:r,height:s})}getKey(r,s){return r.join(",")+s}getDashRanges(r,s,c){const h=[];let p=r.length%2==1?-r[r.length-1]*c:0,m=r[0]*c,x=!0;h.push({left:p,right:m,isDash:x,zeroLength:r[0]===0});let b=r[0];for(let S=1;S<r.length;S++){x=!x;const I=r[S];p=b*c,b+=I,m=b*c,h.push({left:p,right:m,isDash:x,zeroLength:I===0})}return h}addRoundDash(r,s,c){const h=s/2;for(let p=-c;p<=c;p++){const m=this.width*(this.nextRow+c+p);let x=0,b=r[x];for(let S=0;S<this.width;S++){S/b.right>1&&(b=r[++x]);const I=Math.abs(S-b.left),P=Math.abs(S-b.right),D=Math.min(I,P);let F;const U=p/c*(h+1);if(b.isDash){const V=h-Math.abs(U);F=Math.sqrt(D*D+V*V)}else F=h-Math.sqrt(D*D+U*U);this.image.data[m+S]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(r,s){for(let b=r.length-1;b>=0;--b){const S=r[b],I=r[b+1];S.zeroLength?r.splice(b,1):I&&I.isDash===S.isDash&&(I.left=S.left,r.splice(b,1))}const c=r[0],h=r[r.length-1];c.isDash===h.isDash&&(c.left=h.left-this.width,h.right=c.right+this.width);const p=this.width*this.nextRow;let m=0,x=r[m];for(let b=0;b<this.width;b++){b/x.right>1&&(x=r[++m]);const S=Math.abs(b-x.left),I=Math.abs(b-x.right),P=Math.min(S,I);this.image.data[p+b]=Math.max(0,Math.min(255,(x.isDash?P:-P)+s+128))}}addDash(r,s){const c=this.getKey(r,s);if(this.positions[c])return this.positions[c];const h=s==="round",p=h?7:0,m=2*p+1;if(this.nextRow+m>this.height)return Pi("LineAtlas out of space"),null;r.length===0&&r.push(1);let x=0;for(let I=0;I<r.length;I++)r[I]<0&&(Pi("Negative value is found in line dasharray, replacing values with 0"),r[I]=0),x+=r[I];if(x!==0){const I=this.width/x,P=this.getDashRanges(r,this.width,I);h?this.addRoundDash(P,I,p):this.addRegularDash(P,s==="square"?.5*I:0)}const b=this.nextRow+p;this.nextRow+=m;const S={tl:[b,p],br:[x,0]};return this.positions[c]=S,S}}pe(fF,"LineAtlas");const YX=xw.types,ZX=Math.cos(Math.PI/180*37.5),XX=Math.cos(Math.PI/180*5);class Tw{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new SI,this.layoutVertexArray2=new ed,this.patternVertexArray=new td,this.indexArray=new vo,this.programConfigurations=new od(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new hi,this.maxLineLength=0,this.zOffsetVertexArray=new ip,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=r.tessellationStep?r.tessellationStep:Bt/64}updateFootprints(r,s){}populate(r,s,c,h){this.hasPattern=p3("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),m=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!m.isConstant()||!!m.constantOr(0);const x=[];for(const{feature:P,id:D,index:F,sourceLayerIndex:U}of r){const V=this.layers[0]._featureFilter.needGeometry,W=$u(P,V);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),W,c))continue;const ee=p?p.evaluate(W,{},c):void 0,ce={id:D,properties:P.properties,type:P.type,sourceLayerIndex:U,index:F,geometry:V?W.geometry:Xl(P,c,h),patterns:{},sortKey:ee};x.push(ce)}p&&x.sort((P,D)=>P.sortKey-D.sortKey);const{lineAtlas:b,featureIndex:S}=s,I=this.addConstantDashes(b);for(const P of x){const{geometry:D,index:F,sourceLayerIndex:U}=P;if(I&&this.addFeatureDashes(P,b),this.hasPattern){const V=m3("line",this.layers,P,this.zoom,s);this.patternFeatures.push(V)}else this.addFeature(P,D,F,c,b.positions,s.availableImages,s.brightness);S.insert(r[F].feature,D,F,U,this.index)}}addConstantDashes(r){let s=!1;for(const c of this.layers){const h=c.paint.get("line-dasharray").value,p=c.layout.get("line-cap").value;if(h.kind!=="constant"||p.kind!=="constant")s=!0;else{const m=p.value,x=h.value;if(!x)continue;r.addDash(x,m)}}return s}addFeatureDashes(r,s){const c=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,m=h.layout.get("line-cap").value;if(p.kind==="constant"&&m.kind==="constant")continue;let x,b;if(p.kind==="constant"){if(x=p.value,!x)continue}else x=p.evaluate({zoom:c},r);b=m.kind==="constant"?m.value:m.evaluate({zoom:c},r),s.addDash(x,b),r.patterns[h.id]=s.getKey(x,b)}}update(r,s,c,h,p){const m=Object.keys(r).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,m?this.stateDependentLayers:this.layers,c,h,p)}addFeatures(r,s,c,h,p,m){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,NX)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=r.createVertexBuffer(this.patternVertexArray,$X)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,hF.members,!0)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,FX),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,c,h,p,m,x){const b=this.layers[0].layout,S=b.get("line-join").evaluate(r,{}),I=b.get("line-cap").evaluate(r,{}),P=b.get("line-miter-limit"),D=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const F of s)this.addLine(F,r,h,S,I,P,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,p,m,h,x)}addLine(r,s,c,h,p,m,x){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const b={zoom:this.zoom,lineProgress:void 0},S=this.layers[0].layout,I=h==="none";if(this.patternJoinNone=this.hasPattern&&I,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let be=0;be<r.length-1;be++)this.totalDistance+=r[be].dist(r[be+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=YX[s.type]==="Polygon";let D=r.length;for(;D>=2&&r[D-1].equals(r[D-2]);)D--;let F=0;for(;F<D-1&&r[F].equals(r[F+1]);)F++;if(D<(P?3:2))return;h==="bevel"&&(m=1.05);const U=this.overscaling<=16?15*Bt/(512*this.overscaling):0,V=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let W,ee,ce,ue,he,Se;this.e1=this.e2=-1,P&&(W=r[D-2],he=r[F].sub(W)._unit()._perp());for(let be=F;be<D;be++){if(ce=be===D-1?P?r[F+1]:void 0:r[be+1],ce&&r[be].equals(ce))continue;if(he&&(ue=he),W&&(ee=W),W=r[be],this.hasZOffset){const st=S.get("line-z-offset").value;if(st.kind==="constant")Se=st.value;else{if(this.lineClips){const wt=this.totalDistance/(this.lineClips.end-this.lineClips.start);b.lineProgress=(wt*this.lineClips.start+this.distance+(ee?ee.dist(W):0))/wt}else Pi(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),b.lineProgress=0;Se=st.evaluate(b,s)}Se=Se||0}he=ce?ce.sub(W)._unit()._perp():ue,ue=ue||he;const ke=ee&&ce;let Le=ke?h:P||I?"butt":p;const je=ue.x*he.x+ue.y*he.y;if(I){const st=function(wt){if(wt.patternJoinNone){const Pt=wt.segmentPoints.length/2,Tt=wt.lineSoFar-wt.segmentStart;for(let Ht=0;Ht<Pt;++Ht){const It=wt.segmentPoints[2*Ht+1],Dt=Math.round(wt.segmentPoints[2*Ht])+.5+.25*It;wt.patternVertexArray.emplaceBack(Dt,Tt,wt.segmentStart),wt.patternVertexArray.emplaceBack(Dt,Tt,wt.segmentStart)}wt.segmentPoints.length=0}wt.e1=wt.e2=-1};if(ke&&je<XX){this.updateDistance(ee,W),this.addCurrentVertex(W,ue,1,1,V,Se),st(this),this.addCurrentVertex(W,he,-1,-1,V,Se);continue}if(ee){if(!ce){this.updateDistance(ee,W),this.addCurrentVertex(W,ue,1,1,V,Se),st(this);continue}Le="miter"}}let ot=ue.add(he);ot.x===0&&ot.y===0||ot._unit();const Ze=ot.x*he.x+ot.y*he.y,dt=Ze!==0?1/Ze:1/0,At=2*Math.sqrt(2-2*Ze),ct=Ze<ZX&&ee&&ce,bt=ue.x*he.y-ue.y*he.x>0;if(ct&&be>F){const st=W.dist(ee);if(st>2*U){const wt=W.sub(W.sub(ee)._mult(U/st)._round());this.updateDistance(ee,wt),this.addCurrentVertex(wt,ue,0,0,V,Se),ee=wt}}if(ke&&Le==="round"&&(dt<x?Le="miter":dt<=2&&(Le="fakeround")),Le==="miter"&&dt>m&&(Le="bevel"),Le==="bevel"&&(dt>2&&(Le="flipbevel"),dt<m&&(Le="miter")),ee&&this.updateDistance(ee,W),Le==="miter")ot._mult(dt),this.addCurrentVertex(W,ot,0,0,V,Se);else if(Le==="flipbevel"){if(dt>100)ot=he.mult(-1);else{const st=dt*ue.add(he).mag()/ue.sub(he).mag();ot._perp()._mult(st*(bt?-1:1))}this.addCurrentVertex(W,ot,0,0,V,Se),this.addCurrentVertex(W,ot.mult(-1),0,0,V,Se)}else if(Le==="bevel"||Le==="fakeround"){const st=-Math.sqrt(dt*dt-1),wt=bt?st:0,Pt=bt?0:st;if(ee&&this.addCurrentVertex(W,ue,wt,Pt,V,Se),Le==="fakeround"){const Tt=Math.round(180*At/Math.PI/20);for(let Ht=1;Ht<Tt;Ht++){let It=Ht/Tt;if(It!==.5){const fr=It-.5;It+=It*fr*(It-1)*((1.0904+je*(je*(3.55645-1.43519*je)-3.2452))*fr*fr+(.848013+je*(.215638*je-1.06021)))}const Dt=he.sub(ue)._mult(It)._add(ue)._unit()._mult(bt?-1:1);this.addHalfVertex(W,Dt.x,Dt.y,!1,bt,0,V,Se)}}ce&&this.addCurrentVertex(W,he,-wt,-Pt,V,Se)}else Le==="butt"?this.addCurrentVertex(W,ot,0,0,V,Se):Le==="square"?(ee||this.addCurrentVertex(W,ot,-1,-1,V,Se),this.addCurrentVertex(W,ot,0,0,V,Se),ee&&this.addCurrentVertex(W,ot,1,1,V,Se)):Le==="round"&&(ee&&(this.addCurrentVertex(W,ue,0,0,V,Se),this.addCurrentVertex(W,ue,1,1,V,Se,!0)),ce&&(this.addCurrentVertex(W,he,-1,-1,V,Se,!0),this.addCurrentVertex(W,he,0,0,V,Se)));if(ct&&be<D-1){const st=W.dist(ce);if(st>2*U){const wt=W.add(ce.sub(W)._mult(U/st)._round());this.updateDistance(W,wt),this.addCurrentVertex(wt,he,0,0,V,Se),W=wt}}}}addVerticesTo(r,s,c,h,p,m,x,b,S,I){const P=(s.w-r.w)/this.tessellationStep|0;if(P>1){this.lineSoFar=r.w;const D=(s.x-r.x)/P,F=(s.y-r.y)/P,U=(s.z-r.z)/P,V=(s.w-r.w)/P;for(let W=1;W<P;++W)r.x+=D,r.y+=F,r.z+=U,this.lineSoFar+=V,this.addHalfVertex(r,c,h,I,!1,x,S,r.z),this.addHalfVertex(r,p,m,I,!0,-b,S,r.z)}this.lineSoFar=s.w,this.addHalfVertex(s,c,h,I,!1,x,S,s.z),this.addHalfVertex(s,p,m,I,!0,-b,S,s.z)}addCurrentVertex(r,s,c,h,p,m,x=!1){const b=s.x+s.y*c,S=s.y-s.x*c,I=s.y*h-s.x,P=-s.y-s.x*h;if(m!=null){const F=Bt+10,U=m,V=new DB(r.x,r.y,U,this.lineSoFar),W=pF(r,-10,F),ee=this.lineSoFar;if(this.currentVertex)if(W){const ce=this.currentVertexIsOutside,ue=this.currentVertex,he=new DB(r.x,r.y,U,this.lineSoFar);LB(ue,he,-10,F),pF(he,-10,F)||(ce&&(this.e1=this.e2=-1,this.lineSoFar=ue.w,this.addHalfVertex(ue,b,S,x,!1,c,p,ue.z),this.addHalfVertex(ue,I,P,x,!0,-h,p,ue.z)),this.addVerticesTo(ue,he,b,S,I,P,c,h,p,x))}else{const ce=this.currentVertex;this.currentVertexIsOutside&&(LB(ce,V,-10,F),this.e1=this.e2=-1,this.lineSoFar=ce.w,this.addHalfVertex(ce,b,S,x,!1,c,p,ce.z),this.addHalfVertex(ce,I,P,x,!0,-h,p,ce.z)),this.addVerticesTo(ce,V,b,S,I,P,c,h,p,x)}else W||(this.addHalfVertex(r,b,S,x,!1,c,p,m),this.addHalfVertex(r,I,P,x,!0,-h,p,m));this.currentVertex=V,this.currentVertexIsOutside=W,this.lineSoFar=ee}else this.addHalfVertex(r,b,S,x,!1,c,p,m),this.addHalfVertex(r,I,P,x,!0,-h,p,m)}addHalfVertex({x:r,y:s},c,h,p,m,x,b,S){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),m||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((r<<1)+(p?1:0),(s<<1)+(m?1:0),Math.round(63*c)+128,Math.round(63*h)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const I=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),b.primitiveLength++),m?this.e2=I:this.e1=I,S!=null&&this.zOffsetVertexArray.emplaceBack(S)}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}function pF(i,r,s){return i.x<r||i.x>s||i.y<r||i.y>s}pe(Tw,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const QX=new Sn({"line-cap":new jt(Ve.layout_line["line-cap"]),"line-join":new jt(Ve.layout_line["line-join"]),"line-miter-limit":new yt(Ve.layout_line["line-miter-limit"]),"line-round-limit":new yt(Ve.layout_line["line-round-limit"]),"line-sort-key":new jt(Ve.layout_line["line-sort-key"]),"line-z-offset":new jt(Ve.layout_line["line-z-offset"]),visibility:new yt(Ve.layout_line.visibility)});var Aw={paint:new Sn({"line-opacity":new jt(Ve.paint_line["line-opacity"]),"line-color":new jt(Ve.paint_line["line-color"]),"line-translate":new yt(Ve.paint_line["line-translate"]),"line-translate-anchor":new yt(Ve.paint_line["line-translate-anchor"]),"line-width":new jt(Ve.paint_line["line-width"]),"line-gap-width":new jt(Ve.paint_line["line-gap-width"]),"line-offset":new jt(Ve.paint_line["line-offset"]),"line-blur":new jt(Ve.paint_line["line-blur"]),"line-dasharray":new jt(Ve.paint_line["line-dasharray"]),"line-pattern":new jt(Ve.paint_line["line-pattern"]),"line-gradient":new ui(Ve.paint_line["line-gradient"]),"line-trim-offset":new yt(Ve.paint_line["line-trim-offset"]),"line-trim-fade-range":new yt(Ve.paint_line["line-trim-fade-range"]),"line-trim-color":new yt(Ve.paint_line["line-trim-color"]),"line-emissive-strength":new yt(Ve.paint_line["line-emissive-strength"]),"line-border-width":new jt(Ve.paint_line["line-border-width"]),"line-border-color":new jt(Ve.paint_line["line-border-color"]),"line-occlusion-opacity":new yt(Ve.paint_line["line-occlusion-opacity"])}),layout:QX};function mF(i,r,s){return r*(Bt/(i.tileSize*Math.pow(2,s-i.tileID.overscaledZ)))}function gF(i,r){return 1/mF(i,1,r.tileZoom)}function _F(i,r,s,c){return i.translatePosMatrix(c||r.tileID.projMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const yF=i=>{const r=[];vF(i)&&r.push("RENDER_LINE_DASH"),i.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const s=i.paint.get("line-trim-offset");s[0]===0&&s[1]===0||r.push("RENDER_LINE_TRIM_OFFSET"),i.paint.get("line-border-width").constantOr(1)!==0&&r.push("RENDER_LINE_BORDER");const c=i.layout.get("line-join").constantOr("miter")==="none",h=!!i.paint.get("line-pattern").constantOr(1);return c&&h&&r.push("LINE_JOIN_NONE"),r};function vF(i){const r=i.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}class xF{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const c=r[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}var JX={read:function(i,r,s,c,h){var p,m,x=8*h-c-1,b=(1<<x)-1,S=b>>1,I=-7,P=s?h-1:0,D=s?-1:1,F=i[r+P];for(P+=D,p=F&(1<<-I)-1,F>>=-I,I+=x;I>0;p=256*p+i[r+P],P+=D,I-=8);for(m=p&(1<<-I)-1,p>>=-I,I+=c;I>0;m=256*m+i[r+P],P+=D,I-=8);if(p===0)p=1-S;else{if(p===b)return m?NaN:1/0*(F?-1:1);m+=Math.pow(2,c),p-=S}return(F?-1:1)*m*Math.pow(2,p-c)},write:function(i,r,s,c,h,p){var m,x,b,S=8*p-h-1,I=(1<<S)-1,P=I>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=c?0:p-1,U=c?1:-1,V=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,m=I):(m=Math.floor(Math.log(r)/Math.LN2),r*(b=Math.pow(2,-m))<1&&(m--,b*=2),(r+=m+P>=1?D/b:D*Math.pow(2,1-P))*b>=2&&(m++,b/=2),m+P>=I?(x=0,m=I):m+P>=1?(x=(r*b-1)*Math.pow(2,h),m+=P):(x=r*Math.pow(2,P-1)*Math.pow(2,h),m=0));h>=8;i[s+F]=255&x,F+=U,x/=256,h-=8);for(m=m<<h|x,S+=h;S>0;i[s+F]=255&m,F+=U,m/=256,S-=8);i[s+F-U]|=128*V}},bF=ii,Iw=JX;function ii(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}ii.Varint=0,ii.Fixed64=1,ii.Bytes=2,ii.Fixed32=5;var w3=4294967296,wF=1/w3,CF=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Hu(i){return i.type===ii.Bytes?i.readVarint()+i.pos:i.pos+1}function E0(i,r,s){return s?4294967296*r+(i>>>0):4294967296*(r>>>0)+(i>>>0)}function EF(i,r,s){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(c);for(var h=s.pos-1;h>=i;h--)s.buf[h+c]=s.buf[h]}function eQ(i,r){for(var s=0;s<i.length;s++)r.writeVarint(i[s])}function tQ(i,r){for(var s=0;s<i.length;s++)r.writeSVarint(i[s])}function rQ(i,r){for(var s=0;s<i.length;s++)r.writeFloat(i[s])}function nQ(i,r){for(var s=0;s<i.length;s++)r.writeDouble(i[s])}function iQ(i,r){for(var s=0;s<i.length;s++)r.writeBoolean(i[s])}function oQ(i,r){for(var s=0;s<i.length;s++)r.writeFixed32(i[s])}function sQ(i,r){for(var s=0;s<i.length;s++)r.writeSFixed32(i[s])}function aQ(i,r){for(var s=0;s<i.length;s++)r.writeFixed64(i[s])}function lQ(i,r){for(var s=0;s<i.length;s++)r.writeSFixed64(i[s])}function Mw(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+16777216*i[r+3]}function S0(i,r,s){i[s]=r,i[s+1]=r>>>8,i[s+2]=r>>>16,i[s+3]=r>>>24}function SF(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+(i[r+3]<<24)}ii.prototype={destroy:function(){this.buf=null},readFields:function(i,r,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),h=c>>3,p=this.pos;this.type=7&c,i(h,r,this),this.pos===p&&this.skip(c)}return r},readMessage:function(i,r){return this.readFields(i,r,this.readVarint()+this.pos)},readFixed32:function(){var i=Mw(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=SF(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Mw(this.buf,this.pos)+Mw(this.buf,this.pos+4)*w3;return this.pos+=8,i},readSFixed64:function(){var i=Mw(this.buf,this.pos)+SF(this.buf,this.pos+4)*w3;return this.pos+=8,i},readFloat:function(){var i=Iw.read(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Iw.read(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var r,s,c=this.buf;return r=127&(s=c[this.pos++]),s<128?r:(r|=(127&(s=c[this.pos++]))<<7,s<128?r:(r|=(127&(s=c[this.pos++]))<<14,s<128?r:(r|=(127&(s=c[this.pos++]))<<21,s<128?r:function(h,p,m){var x,b,S=m.buf;if(x=(112&(b=S[m.pos++]))>>4,b<128||(x|=(127&(b=S[m.pos++]))<<3,b<128)||(x|=(127&(b=S[m.pos++]))<<10,b<128)||(x|=(127&(b=S[m.pos++]))<<17,b<128)||(x|=(127&(b=S[m.pos++]))<<24,b<128)||(x|=(1&(b=S[m.pos++]))<<31,b<128))return E0(h,x,p);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,r=this.pos;return this.pos=i,i-r>=12&&CF?function(s,c,h){return CF.decode(s.subarray(c,h))}(this.buf,r,i):function(s,c,h){for(var p="",m=c;m<h;){var x,b,S,I=s[m],P=null,D=I>239?4:I>223?3:I>191?2:1;if(m+D>h)break;D===1?I<128&&(P=I):D===2?(192&(x=s[m+1]))==128&&(P=(31&I)<<6|63&x)<=127&&(P=null):D===3?(b=s[m+2],(192&(x=s[m+1]))==128&&(192&b)==128&&((P=(15&I)<<12|(63&x)<<6|63&b)<=2047||P>=55296&&P<=57343)&&(P=null)):D===4&&(b=s[m+2],S=s[m+3],(192&(x=s[m+1]))==128&&(192&b)==128&&(192&S)==128&&((P=(15&I)<<18|(63&x)<<12|(63&b)<<6|63&S)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,D=1):P>65535&&(P-=65536,p+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),p+=String.fromCharCode(P),m+=D}return p}(this.buf,r,i)},readBytes:function(){var i=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,i);return this.pos=i,r},readPackedVarint:function(i,r){if(this.type!==ii.Bytes)return i.push(this.readVarint(r));var s=Hu(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(r));return i},readPackedSVarint:function(i){if(this.type!==ii.Bytes)return i.push(this.readSVarint());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==ii.Bytes)return i.push(this.readBoolean());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==ii.Bytes)return i.push(this.readFloat());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==ii.Bytes)return i.push(this.readDouble());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==ii.Bytes)return i.push(this.readFixed32());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==ii.Bytes)return i.push(this.readSFixed32());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==ii.Bytes)return i.push(this.readFixed64());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==ii.Bytes)return i.push(this.readSFixed64());var r=Hu(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed64());return i},skip:function(i){var r=7&i;if(r===ii.Varint)for(;this.buf[this.pos++]>127;);else if(r===ii.Bytes)this.pos=this.readVarint()+this.pos;else if(r===ii.Fixed32)this.pos+=4;else{if(r!==ii.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(i,r){this.writeVarint(i<<3|r)},realloc:function(i){for(var r=this.length||16;r<this.pos+i;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),S0(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),S0(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),S0(this.buf,-1&i,this.pos),S0(this.buf,Math.floor(i*wF),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),S0(this.buf,-1&i,this.pos),S0(this.buf,Math.floor(i*wF),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(r,s){var c,h;if(r>=0?(c=r%4294967296|0,h=r/4294967296|0):(h=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,h=h+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(p,m,x){x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,x.buf[x.pos]=127&(p>>>=7)}(c,0,s),function(p,m){var x=(7&p)<<4;m.buf[m.pos++]|=x|((p>>>=3)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p)))))}(h,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var r=this.pos;this.pos=function(c,h,p){for(var m,x,b=0;b<h.length;b++){if((m=h.charCodeAt(b))>55295&&m<57344){if(!x){m>56319||b+1===h.length?(c[p++]=239,c[p++]=191,c[p++]=189):x=m;continue}if(m<56320){c[p++]=239,c[p++]=191,c[p++]=189,x=m;continue}m=x-55296<<10|m-56320|65536,x=null}else x&&(c[p++]=239,c[p++]=191,c[p++]=189,x=null);m<128?c[p++]=m:(m<2048?c[p++]=m>>6|192:(m<65536?c[p++]=m>>12|224:(c[p++]=m>>18|240,c[p++]=m>>12&63|128),c[p++]=m>>6&63|128),c[p++]=63&m|128)}return p}(this.buf,i,this.pos);var s=this.pos-r;s>=128&&EF(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),Iw.write(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Iw.write(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var r=i.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,r){this.pos++;var s=this.pos;i(r,this);var c=this.pos-s;c>=128&&EF(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,r,s){this.writeTag(i,ii.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(i,r){r.length&&this.writeMessage(i,eQ,r)},writePackedSVarint:function(i,r){r.length&&this.writeMessage(i,tQ,r)},writePackedBoolean:function(i,r){r.length&&this.writeMessage(i,iQ,r)},writePackedFloat:function(i,r){r.length&&this.writeMessage(i,rQ,r)},writePackedDouble:function(i,r){r.length&&this.writeMessage(i,nQ,r)},writePackedFixed32:function(i,r){r.length&&this.writeMessage(i,oQ,r)},writePackedSFixed32:function(i,r){r.length&&this.writeMessage(i,sQ,r)},writePackedFixed64:function(i,r){r.length&&this.writeMessage(i,aQ,r)},writePackedSFixed64:function(i,r){r.length&&this.writeMessage(i,lQ,r)},writeBytesField:function(i,r){this.writeTag(i,ii.Bytes),this.writeBytes(r)},writeFixed32Field:function(i,r){this.writeTag(i,ii.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(i,r){this.writeTag(i,ii.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(i,r){this.writeTag(i,ii.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(i,r){this.writeTag(i,ii.Fixed64),this.writeSFixed64(r)},writeVarintField:function(i,r){this.writeTag(i,ii.Varint),this.writeVarint(r)},writeSVarintField:function(i,r){this.writeTag(i,ii.Varint),this.writeSVarint(r)},writeStringField:function(i,r){this.writeTag(i,ii.Bytes),this.writeString(r)},writeFloatField:function(i,r){this.writeTag(i,ii.Fixed32),this.writeFloat(r)},writeDoubleField:function(i,r){this.writeTag(i,ii.Fixed64),this.writeDouble(r)},writeBooleanField:function(i,r){this.writeVarintField(i,!!r)}};var T0=Y(bF);const cQ=["id","tile","layer","source","sourceLayer","state"];class TF{constructor(r,s,c,h,p){this.type="Feature",this._vectorTileFeature=r,this._z=s,this._x=c,this._y=h,this.properties=r.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of cQ)this[s]!==void 0&&(r[s]=this[s]);return r}}class uQ{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,c){const h=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][h]=this.stateChanges[r][h]||{},jo(this.stateChanges[r][h],c),this.deletedStates[r]===null){this.deletedStates[r]={};for(const p in this.state[r])p!==h&&(this.deletedStates[r][p]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][h]===null){this.deletedStates[r][h]={};for(const p in this.state[r][h])c[p]||(this.deletedStates[r][h][p]=null)}else for(const p in c)this.deletedStates[r]&&this.deletedStates[r][h]&&this.deletedStates[r][h][p]===null&&delete this.deletedStates[r][h][p]}removeFeatureState(r,s,c){if(this.deletedStates[r]===null)return;const h=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&s!==void 0)this.deletedStates[r][h]!==null&&(this.deletedStates[r][h]=this.deletedStates[r][h]||{},this.deletedStates[r][h][c]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][h])for(c in this.deletedStates[r][h]={},this.stateChanges[r][h])this.deletedStates[r][h][c]=null;else this.deletedStates[r][h]=null;else this.deletedStates[r]=null}getState(r,s){const c=String(s),h=jo({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const p=this.deletedStates[r][s];if(p===null)return{};for(const m in p)delete h[m]}return h}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const m in this.stateChanges[h])this.state[h][m]||(this.state[h][m]={}),jo(this.state[h][m],this.stateChanges[h][m]),p[m]=this.state[h][m];c[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(this.deletedStates[h]===null)for(const m in this.state[h])p[m]={},this.state[h][m]={};else for(const m in this.deletedStates[h]){if(this.deletedStates[h][m]===null)this.state[h][m]={};else if(this.state[h][m])for(const x of Object.keys(this.deletedStates[h][m]))delete this.state[h][m][x];p[m]=this.state[h][m]}c[h]=c[h]||{},jo(c[h],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const h in r)r[h].setFeatureState(c,s)}}class AF{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Pe(Bt,16,0),this.featureIndexArray=new NL,this.promoteId=s,this.is3DTile=!1}insert(r,s,c,h,p,m=0,x=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,h,p,m);const S=this.grid;for(let I=0;I<s.length;I++){const P=s[I],D=[1/0,1/0,-1/0,-1/0];for(let F=0;F<P.length;F++){const U=P[F];D[0]=Math.min(D[0],U.x),D[1]=Math.min(D[1],U.y),D[2]=Math.max(D[2],U.x),D[3]=Math.max(D[3],U.y)}x!==0&&(D[0]-=x,D[1]-=x,D[2]+=x,D[3]+=x),D[0]<Bt&&D[1]<Bt&&D[2]>=0&&D[3]>=0&&S.insert(b,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new _3(new T0(this.rawTileData)).layers,this.sourceLayerCoder=new xF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,s,c,h){this.loadVTLayers();const p=r.params||{},m=co(p.filter),x=r.tileResult,b=r.transform,S=x.bufferedTilespaceBounds,I=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,(U,V,W,ee)=>rB(x.bufferedTilespaceGeometry,U,V,W,ee));I.sort(hQ);let P=null;b.elevation&&I.length>0&&(P=C0.create(b.elevation,this.tileID));const D={};let F;for(let U=0;U<I.length;U++){const V=I[U];if(V===F)continue;F=V;const W=this.featureIndexArray.get(V);let ee=null;if(this.is3DTile){const ce=this.bucketLayerIDs[0][0],ue=s[ce];if(ue.type!=="model")continue;const{queryFeature:he,intersectionZ:Se}=ue.queryIntersectsMatchingFeature(x,W.featureIndex,m,b);he&&this.appendToResult(D,ce,W.featureIndex,he,Se)}else this.loadMatchingFeature(D,W,m,p.layers,p.availableImages,s,c,h,(ce,ue,he,Se=0)=>(ee||(ee=Xl(ce,this.tileID.canonical,r.tileTransform)),ue.queryIntersectsFeature(x,ce,he,ee,this.z,r.transform,r.pixelPosMatrix,P,Se)))}return D}loadMatchingFeature(r,s,c,h,p,m,x,b,S){const{featureIndex:I,bucketIndex:P,sourceLayerIndex:D,layoutVertexArrayOffset:F}=s,U=this.bucketLayerIDs[P];if(h&&!function(ce,ue){for(let he=0;he<ce.length;he++)if(ue.indexOf(ce[he])>=0)return!0;return!1}(h,U))return;const V=this.sourceLayerCoder.decode(D),W=this.vtLayers[V].feature(I);if(c.needGeometry){const ce=$u(W,!0);if(!c.filter(new Mr(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!c.filter(new Mr(this.tileID.overscaledZ),W))return;const ee=this.getId(W,V);for(let ce=0;ce<U.length;ce++){const ue=U[ce];if(h&&h.indexOf(ue)<0)continue;const he=m[ue];if(!he)continue;let Se={};ee!==void 0&&b&&(Se=b.getState(he.sourceLayer||"_geojsonTileLayer",ee));const be=!S||S(W,he,Se,F);if(!be)continue;const ke=new TF(W,this.z,this.x,this.y,ee),Le=jo({},x[ue]);Le.paint=IF(Le.paint,he.paint,W,Se,p),Le.layout=IF(Le.layout,he.layout,W,Se,p),ke.layer=Le,this.appendToResult(r,ue,I,ke,be)}}appendToResult(r,s,c,h,p){let m=r[s];m===void 0&&(m=r[s]=[]),m.push({featureIndex:c,feature:h,intersectionZ:p})}lookupSymbolFeatures(r,s,c,h,p,m,x,b){const S={};this.loadVTLayers();const I=co(p);for(const P of r)this.loadMatchingFeature(S,{bucketIndex:c,sourceLayerIndex:h,featureIndex:P,layoutVertexArrayOffset:0},I,m,x,b,s);return S}loadFeature(r){const{featureIndex:s,sourceLayerIndex:c}=r;this.loadVTLayers();const h=this.sourceLayerCoder.decode(c),p=this.vtFeatures[h];if(p[s])return p[s];const m=this.vtLayers[h].feature(s);return p[s]=m,m}hasLayer(r){for(const s of this.bucketLayerIDs)for(const c of s)if(r===c)return!0;return!1}getId(r,s){let c=r.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];h!=null&&(c=r.properties[h]),typeof c=="boolean"&&(c=Number(c))}return c}}function IF(i,r,s,c,h){return Ph(i,(p,m)=>{const x=r instanceof Dn?r.get(m):null;return x&&x.evaluate?x.evaluate(s,c,h):x})}function hQ(i,r){return r-i}pe(AF,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var Ho=24;const Ql=128;function C3(i,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Mr(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:h}=s;let p=0;for(;p<c.length&&c[p]<=i;)p++;p=Math.max(0,p-1);let m=p;for(;m<c.length&&c[m]<i+1;)m++;m=Math.min(c.length-1,m);const x=c[p],b=c[m];return s.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:x,maxZoom:b,minSize:s.evaluate(new Mr(x)),maxSize:s.evaluate(new Mr(b)),interpolationType:h}}}function Pw(i,{uSize:r,uSizeT:s},{lowerSize:c,upperSize:h}){return i.kind==="source"?c/Ql:i.kind==="composite"?_r(c/Ql,h/Ql,s):r}function A0(i,r){let s=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:p,maxZoom:m}=i,x=h?Kr(Ws.interpolationFactor(h,r,p,m),0,1):0;i.kind==="camera"?c=_r(i.minSize,i.maxSize,x):s=x}return{uSizeT:s,uSize:c}}var dQ=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ql,evaluateSizeForFeature:Pw,evaluateSizeForZoom:A0,getSizeData:C3});function fQ(i,r,s){return i.sections.forEach(c=>{c.text=function(h,p,m){const x=p.layout.get("text-transform").evaluate(m,{});return x==="uppercase"?h=h.toLocaleUpperCase():x==="lowercase"&&(h=h.toLocaleLowerCase()),Pn.applyArabicShaping&&(h=Pn.applyArabicShaping(h)),h}(c.text,r,s)}),i}const mv={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function pQ(i){return i==="︶"||i==="﹈"||i==="︸"||i==="﹄"||i==="﹂"||i==="︾"||i==="︼"||i==="︺"||i==="︘"||i==="﹀"||i==="︐"||i==="︓"||i==="︔"||i==="｀"||i==="￣"||i==="︑"||i==="︒"}function mQ(i){return i==="︵"||i==="﹇"||i==="︷"||i==="﹃"||i==="﹁"||i==="︽"||i==="︻"||i==="︹"||i==="︗"||i==="︿"}const E3=3;function gQ(i,r,s){r.glyphs=[],i===1&&s.readMessage(_Q,r)}function _Q(i,r,s){if(i===3){const{id:c,bitmap:h,width:p,height:m,left:x,top:b,advance:S}=s.readMessage(yQ,{});r.glyphs.push({id:c,bitmap:new ld({width:p+2*E3,height:m+2*E3},h),metrics:{width:p,height:m,left:x,top:b,advance:S}})}else i===4?r.ascender=s.readSVarint():i===5&&(r.descender=s.readSVarint())}function yQ(i,r,s){i===1?r.id=s.readVarint():i===2?r.bitmap=s.readBytes():i===3?r.width=s.readVarint():i===4?r.height=s.readVarint():i===5?r.left=s.readSVarint():i===6?r.top=s.readSVarint():i===7&&(r.advance=s.readVarint())}const MF=E3,Oa={horizontal:1,vertical:2,horizontalOnly:3};class gv{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,s){const c=new gv;return c.scale=r||1,c.fontStack=s,c}static forImage(r){const s=new gv;return s.imageName=r,s}}class I0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const c=new I0;for(let h=0;h<r.sections.length;h++){const p=r.sections[h];p.image?c.addImageSection(p):c.addTextSection(p,s)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=function(s,c){let h="";for(let p=0;p<s.length;p++){const m=s.charCodeAt(p+1)||null,x=s.charCodeAt(p-1)||null;h+=!c&&(m&&gt(m)&&!mv[s[p+1]]||x&&gt(x)&&!mv[s[p-1]])||!mv[s[p]]?s[p]:mv[s[p]]}return h}(this.text,r)}trim(){let r=0;for(let c=0;c<this.text.length&&Rw[this.text.charCodeAt(c)];c++)r++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&Rw[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const c=new I0;return c.text=this.text.substring(r,s),c.sectionIndex=this.sectionIndex.slice(r,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}addTextSection(r,s){this.text+=r.text,this.sections.push(gv.forText(r.scale,r.fontStack||s));const c=this.sections.length-1;for(let h=0;h<r.text.length;++h)this.sectionIndex.push(c)}addImageSection(r){const s=r.image?r.image.namePrimary:"";if(s.length===0)return void Pi("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(gv.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Pi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function S3(i,r,s,c,h,p,m,x,b,S,I,P,D,F,U){const V=I0.fromFeature(i,h);P===Oa.vertical&&V.verticalizePunctuation(D);let W=[];const ee=function(be,ke,Le,je,ot,Ze){if(!be)return[];const dt=[],At=function(wt,Pt,Tt,Ht,It,Dt){let fr=0;for(let lr=0;lr<wt.length();lr++){const sr=wt.getSection(lr);fr+=PF(wt.getCodePoint(lr),sr,Ht,It,Pt,Dt)}return fr/Math.max(1,Math.ceil(fr/Tt))}(be,ke,Le,je,ot,Ze),ct=be.text.indexOf("​")>=0;let bt=0;for(let wt=0;wt<be.length();wt++){const Pt=be.getSection(wt),Tt=be.getCodePoint(wt);if(Rw[Tt]||(bt+=PF(Tt,Pt,je,ot,ke,Ze)),wt<be.length()-1){const Ht=!((st=Tt)<11904||!(Ee["Bopomofo Extended"](st)||Ee.Bopomofo(st)||Ee["CJK Compatibility Forms"](st)||Ee["CJK Compatibility Ideographs"](st)||Ee["CJK Compatibility"](st)||Ee["CJK Radicals Supplement"](st)||Ee["CJK Strokes"](st)||Ee["CJK Symbols and Punctuation"](st)||Ee["CJK Unified Ideographs Extension A"](st)||Ee["CJK Unified Ideographs"](st)||Ee["Enclosed CJK Letters and Months"](st)||Ee["Halfwidth and Fullwidth Forms"](st)||Ee.Hiragana(st)||Ee["Ideographic Description Characters"](st)||Ee["Kangxi Radicals"](st)||Ee["Katakana Phonetic Extensions"](st)||Ee.Katakana(st)||Ee["Vertical Forms"](st)||Ee["Yi Radicals"](st)||Ee["Yi Syllables"](st)));(vQ[Tt]||Ht||Pt.imageName)&&dt.push(kF(wt+1,bt,At,dt,xQ(Tt,be.getCodePoint(wt+1),Ht&&ct),!1))}}var st;return DF(kF(be.length(),bt,At,dt,0,!0))}(V,S,p,r,c,F),{processBidirectionalText:ce,processStyledBidirectionalText:ue}=Pn;if(ce&&V.sections.length===1){const be=ce(V.toString(),ee);for(const ke of be){const Le=new I0;Le.text=ke,Le.sections=V.sections;for(let je=0;je<ke.length;je++)Le.sectionIndex.push(0);W.push(Le)}}else if(ue){const be=ue(V.text,V.sectionIndex,ee);for(const ke of be){const Le=new I0;Le.text=ke[0],Le.sectionIndex=ke[1],Le.sections=V.sections,W.push(Le)}}else W=function(be,ke){const Le=[],je=be.text;let ot=0;for(const Ze of ke)Le.push(be.substring(ot,Ze)),ot=Ze;return ot<je.length&&Le.push(be.substring(ot,je.length)),Le}(V,ee);const he=[],Se={positionedLines:he,text:V.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(be,ke,Le,je,ot,Ze,dt,At,ct,bt,st,wt){let Pt=0,Tt=0,Ht=0;const It=At==="right"?1:At==="left"?0:.5;let Dt=!1;for(const jr of ot){const Sr=jr.getSections();for(const Wr of Sr){if(Wr.imageName)continue;const Vr=ke[Wr.fontStack];if(Vr&&(Dt=Vr.ascender!==void 0&&Vr.descender!==void 0,!Dt))break}if(!Dt)break}let fr=0;for(const jr of ot){jr.trim();const Sr=jr.getMaxScale(),Wr=(Sr-1)*Ho,Vr={positionedGlyphs:[],lineOffset:0};be.positionedLines[fr]=Vr;const Qr=Vr.positionedGlyphs;let br=0;if(!jr.length()){Tt+=Ze,++fr;continue}let Bn=0,On=0;for(let cn=0;cn<jr.length();cn++){const wn=jr.getSection(cn),Qn=jr.getSectionIndex(cn),$n=jr.getCodePoint(cn);let pi=wn.scale,fi=null,ts=null,Ti=null,oi=Ho,Vi=0;const ko=!(ct===Oa.horizontal||!st&&!xt($n)||st&&(Rw[$n]||(lr=$n,Ee.Arabic(lr)||Ee["Arabic Supplement"](lr)||Ee["Arabic Extended-A"](lr)||Ee["Arabic Presentation Forms-A"](lr)||Ee["Arabic Presentation Forms-B"](lr))));if(wn.imageName){const Do=je[wn.imageName];if(!Do)continue;Ti=wn.imageName,be.iconsInText=be.iconsInText||!0,ts=Do.paddedRect;const Gn=Do.displaySize;pi=pi*Ho/wt,fi={width:Gn[0],height:Gn[1],left:0,top:-MF,advance:ko?Gn[1]:Gn[0],localGlyph:!1},Vi=Dt?-fi.height*pi:Sr*Ho-17-Gn[1]*pi,oi=fi.advance;const Os=(ko?Gn[0]:Gn[1])*pi-Ho*Sr;Os>0&&Os>br&&(br=Os)}else{const Do=Le[wn.fontStack];if(!Do)continue;Do[$n]&&(ts=Do[$n]);const Gn=ke[wn.fontStack];if(!Gn)continue;const Os=Gn.glyphs[$n];if(!Os)continue;if(fi=Os.metrics,oi=$n!==8203?Ho:0,Dt){const Wu=Gn.ascender!==void 0?Math.abs(Gn.ascender):0,gl=Gn.descender!==void 0?Math.abs(Gn.descender):0,oc=(Wu+gl)*pi;Bn<oc&&(Bn=oc,On=(Wu-gl)/2*pi),Vi=-Wu*pi}else Vi=(Sr-pi)*Ho-17}ko?(be.verticalizable=!0,Qr.push({glyph:$n,imageName:Ti,x:Pt,y:Tt+Vi,vertical:ko,scale:pi,localGlyph:fi.localGlyph,fontStack:wn.fontStack,sectionIndex:Qn,metrics:fi,rect:ts}),Pt+=oi*pi+bt):(Qr.push({glyph:$n,imageName:Ti,x:Pt,y:Tt+Vi,vertical:ko,scale:pi,localGlyph:fi.localGlyph,fontStack:wn.fontStack,sectionIndex:Qn,metrics:fi,rect:ts}),Pt+=fi.advance*pi+bt)}Qr.length!==0&&(Ht=Math.max(Pt-bt,Ht),Dt?OF(Qr,It,br,On,Ze*Sr/2):OF(Qr,It,br,0,Ze/2)),Pt=0;const bn=Ze*Sr+br;Vr.lineOffset=Math.max(br,Wr),Tt+=bn,++fr}var lr;const sr=Tt,{horizontalAlign:Rt,verticalAlign:mr}=T3(dt);(function(jr,Sr,Wr,Vr,Qr,br){const Bn=(Sr-Wr)*Qr,On=-br*Vr;for(const bn of jr)for(const cn of bn.positionedGlyphs)cn.x+=Bn,cn.y+=On})(be.positionedLines,It,Rt,mr,Ht,sr),be.top+=-mr*sr,be.bottom=be.top+sr,be.left+=-Rt*Ht,be.right=be.left+Ht,be.hasBaseline=Dt}(Se,r,s,c,W,m,x,b,P,S,D,U),!function(be){for(const ke of be)if(ke.positionedGlyphs.length!==0)return!1;return!0}(he)&&Se}const Rw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},vQ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function PF(i,r,s,c,h,p){if(r.imageName){const m=c[r.imageName];return m?m.displaySize[0]*r.scale*Ho/p+h:0}{const m=s[r.fontStack],x=m&&m.glyphs[i];return x?x.metrics.advance*r.scale+h:0}}function RF(i,r,s,c){const h=Math.pow(i-r,2);return c?i<r?h/2:2*h:h+Math.abs(s)*s}function xQ(i,r,s){let c=0;return i===10&&(c-=1e4),s&&(c+=150),i!==40&&i!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function kF(i,r,s,c,h,p){let m=null,x=RF(r,s,h,p);for(const b of c){const S=RF(r-b.x,s,h,p)+b.badness;S<=x&&(m=b,x=S)}return{index:i,x:r,priorBreak:m,badness:x}}function DF(i){return i?DF(i.priorBreak).concat(i.index):[]}function T3(i){let r=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function OF(i,r,s,c,h){if(!(r||s||c||h))return;const p=i.length-1,m=i[p],x=(m.x+m.metrics.advance*m.scale)*r;for(let b=0;b<=p;b++)i[b].x-=x,i[b].y+=s+c+h}function bQ(i,r,s,c){const{horizontalAlign:h,verticalAlign:p}=T3(c),m=s[0]-i.displaySize[0]*h,x=s[1]-i.displaySize[1]*p;return{imagePrimary:i,imageSecondary:r,top:x,bottom:x+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function LF(i,r,s,c,h,p){const m=i.imagePrimary;let x;if(m.content){const W=m.content,ee=m.pixelRatio||1;x=[W[0]/ee,W[1]/ee,m.displaySize[0]-W[2]/ee,m.displaySize[1]-W[3]/ee]}const b=r.left*p,S=r.right*p;let I,P,D,F;s==="width"||s==="both"?(F=h[0]+b-c[3],P=h[0]+S+c[1]):(F=h[0]+(b+S-m.displaySize[0])/2,P=F+m.displaySize[0]);const U=r.top*p,V=r.bottom*p;return s==="height"||s==="both"?(I=h[1]+U-c[0],D=h[1]+V+c[2]):(I=h[1]+(U+V-m.displaySize[1])/2,D=I+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:I,right:P,bottom:D,left:F,collisionPadding:x}}class Gu extends Ut{constructor(r,s,c,h,p){super(r,s),this.angle=h,this.z=c,p!==void 0&&(this.segment=p)}clone(){return new Gu(this.x,this.y,this.z,this.angle,this.segment)}}function BF(i,r,s,c,h){if(r.segment===void 0)return!0;let p=r,m=r.segment+1,x=0;for(;x>-s/2;){if(m--,m<0)return!1;x-=i[m].dist(p),p=i[m]}x+=i[m].dist(i[m+1]),m++;const b=[];let S=0;for(;x<s/2;){const I=i[m],P=i[m+1];if(!P)return!1;let D=i[m-1].angleTo(I)-I.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:x,angleDelta:D}),S+=D;x-b[0].distance>c;)S-=b.shift().angleDelta;if(S>h)return!1;m++,x+=I.dist(P)}return!0}function FF(i){let r=0;for(let s=0;s<i.length-1;s++)r+=i[s].dist(i[s+1]);return r}function zF(i,r,s){return i?.6*r*s:0}function NF(i,r){return Math.max(i?i.right-i.left:0,r?r.right-r.left:0)}function wQ(i,r,s,c,h,p){const m=zF(s,h,p),x=NF(s,c)*p;let b=0;const S=FF(i)/2;for(let I=0;I<i.length-1;I++){const P=i[I],D=i[I+1],F=P.dist(D);if(b+F>S){const U=(S-b)/F,V=_r(P.x,D.x,U),W=_r(P.y,D.y,U),ee=new Gu(V,W,0,D.angleTo(P),I);return!m||BF(i,ee,x,m,r)?ee:void 0}b+=F}}function CQ(i,r,s,c,h,p,m,x,b){const S=zF(c,p,m),I=NF(c,h),P=I*m,D=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return r-P<r/4&&(r=P+r/4),UF(i,D?r/2*x%r:(I/2+2*p)*m*x%r,r,S,s,P,D,!1,b)}function UF(i,r,s,c,h,p,m,x,b){const S=p/2,I=FF(i);let P=0,D=r-s,F=[];for(let U=0;U<i.length-1;U++){const V=i[U],W=i[U+1],ee=V.dist(W),ce=W.angleTo(V);for(;D+s<P+ee;){D+=s;const ue=(D-P)/ee,he=_r(V.x,W.x,ue),Se=_r(V.y,W.y,ue);if(he>=0&&he<b&&Se>=0&&Se<b&&D-S>=0&&D+S<=I){const be=new Gu(he,Se,0,ce,U);c&&!BF(i,be,p,c,h)||F.push(be)}}P+=ee}return x||F.length||m||(F=UF(i,P/2,s,c,h,p,m,!0,b)),F}function $F(i,r,s,c,h){const p=[];for(let m=0;m<i.length;m++){const x=i[m];let b;for(let S=0;S<x.length-1;S++){let I=x[S],P=x[S+1];I.x<r&&P.x<r||(I.x<r?I=new Ut(r,I.y+(r-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x<r&&(P=new Ut(r,I.y+(r-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y<s&&P.y<s||(I.y<s?I=new Ut(I.x+(s-I.y)/(P.y-I.y)*(P.x-I.x),s)._round():P.y<s&&(P=new Ut(I.x+(s-I.y)/(P.y-I.y)*(P.x-I.x),s)._round()),I.x>=c&&P.x>=c||(I.x>=c?I=new Ut(c,I.y+(c-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x>=c&&(P=new Ut(c,I.y+(c-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y>=h&&P.y>=h||(I.y>=h?I=new Ut(I.x+(h-I.y)/(P.y-I.y)*(P.x-I.x),h)._round():P.y>=h&&(P=new Ut(I.x+(h-I.y)/(P.y-I.y)*(P.x-I.x),h)._round()),b&&I.equals(b[b.length-1])||(b=[I],p.push(b)),b.push(P)))))}}return p}function jF(i){let r=0,s=0;for(const m of i)r+=m.w*m.h,s=Math.max(s,m.w);i.sort((m,x)=>x.h-m.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let h=0,p=0;for(const m of i)for(let x=c.length-1;x>=0;x--){const b=c[x];if(!(m.w>b.w||m.h>b.h)){if(m.x=b.x,m.y=b.y,p=Math.max(p,m.y+m.h),h=Math.max(h,m.x+m.w),m.w===b.w&&m.h===b.h){const S=c.pop();x<c.length&&(c[x]=S)}else m.h===b.h?(b.x+=m.w,b.w-=m.w):m.w===b.w?(b.y+=m.h,b.h-=m.h):(c.push({x:b.x+m.w,y:b.y,w:b.w-m.w,h:m.h}),b.y+=m.h,b.h-=m.h);break}}return{w:h,h:p,fill:r/(h*p)||0}}pe(Gu,"Anchor");const la=1;class A3{constructor(r,{pixelRatio:s,version:c,stretchX:h,stretchY:p,content:m}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=h,this.stretchY=p,this.content=m,this.version=c}get tl(){return[this.paddedRect.x+la,this.paddedRect.y+la]}get br(){return[this.paddedRect.x+this.paddedRect.w-la,this.paddedRect.y+this.paddedRect.h-la]}get displaySize(){return[(this.paddedRect.w-2*la)/this.pixelRatio,(this.paddedRect.h-2*la)/this.pixelRatio]}}class VF{constructor(r,s,c){const h={},p={};this.haveRenderCallbacks=[];const m=[];this.addImages(r,h,m),this.addImages(s,p,m);const{w:x,h:b}=jF(m),S=new Da({width:x||1,height:b||1});for(const I in r){const P=r[I],D=h[I].paddedRect;Da.copy(P.data,S,{x:0,y:0},{x:D.x+la,y:D.y+la},P.data,c,P.sdf)}for(const I in s){const P=s[I],D=p[I].paddedRect,F=D.x+la,U=D.y+la,V=P.data.width,W=P.data.height;Da.copy(P.data,S,{x:0,y:0},{x:F,y:U},P.data,c),Da.copy(P.data,S,{x:0,y:W-1},{x:F,y:U-1},{width:V,height:1},c),Da.copy(P.data,S,{x:0,y:0},{x:F,y:U+W},{width:V,height:1},c),Da.copy(P.data,S,{x:V-1,y:0},{x:F-1,y:U},{width:1,height:W},c),Da.copy(P.data,S,{x:0,y:0},{x:F+V,y:U},{width:1,height:W},c)}this.image=S,this.iconPositions=h,this.patternPositions=p}addImages(r,s,c){for(const h in r){const p=r[h],m={x:0,y:0,w:p.data.width+2*la,h:p.data.height+2*la};c.push(m),s[h]=new A3(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(r,s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>r.hasImage(h,c)),r.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const h in r.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[h],r.getImage(h,c),s),this.patchUpdatedImage(this.patternPositions[h],r.getImage(h,c),s)}patchUpdatedImage(r,s,c){if(!r||!s||r.version===s.version)return;r.version=s.version;const[h,p]=r.tl,m=!!Object.keys(this.patternPositions).length;c.update(s.data,{useMipmap:m},{x:h,y:p})}}pe(A3,"ImagePosition"),pe(VF,"ImageAtlas");const _v=1e20;function HF(i,r,s,c,h,p,m,x,b){for(let S=r;S<r+c;S++)GF(i,s*p+S,p,h,m,x,b);for(let S=s;S<s+h;S++)GF(i,S*p+r,1,c,m,x,b)}function GF(i,r,s,c,h,p,m){p[0]=0,m[0]=-_v,m[1]=_v,h[0]=i[r];for(let x=1,b=0,S=0;x<c;x++){h[x]=i[r+x*s];const I=x*x;do{const P=p[b];S=(h[x]-h[P]+I-P*P)/(x-P)/2}while(S<=m[b]&&--b>-1);b++,p[b]=x,m[b]=S,m[b+1]=_v}for(let x=0,b=0;x<c;x++){for(;m[b+1]<x;)b++;const S=p[b],I=x-S;i[r+x*s]=h[S]+I*I}}const Jl=2,I3={none:0,ideographs:1,all:2};class M0{constructor(r,s,c){this.requestManager=r,this.localGlyphMode=s,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r,s){this.urls[s]=r}getGlyphs(r,s,c){const h=[],p=this.urls[s]||k.GLYPHS_URL;for(const m in r)for(const x of r[m])h.push({stack:m,id:x});Mh(h,({stack:m,id:x},b)=>{let S=this.entries[m];S||(S=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=S.glyphs[x];if(I!==void 0)return void b(null,{stack:m,id:x,glyph:I});if(I=this._tinySDF(S,m,x),I)return S.glyphs[x]=I,void b(null,{stack:m,id:x,glyph:I});const P=Math.floor(x/256);if(256*P>65535)return void b(new Error("glyphs > 65535 not supported"));if(S.ranges[P])return void b(null,{stack:m,id:x,glyph:I});let D=S.requests[P];D||(D=S.requests[P]=[],M0.loadGlyphRange(m,P,p,this.requestManager,(F,U)=>{if(U){S.ascender=U.ascender,S.descender=U.descender;for(const V in U.glyphs)this._doesCharSupportLocalGlyph(+V)||(S.glyphs[+V]=U.glyphs[+V]);S.ranges[P]=!0}for(const V of D)V(F,U);delete S.requests[P]})),D.push((F,U)=>{F?b(F):U&&b(null,{stack:m,id:x,glyph:U.glyphs[x]||null})})},(m,x)=>{if(m)c(m);else if(x){const b={};for(const{stack:S,id:I,glyph:P}of x)b[S]===void 0&&(b[S]={}),b[S].glyphs===void 0&&(b[S].glyphs={}),b[S].glyphs[I]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},b[S].ascender=this.entries[S].ascender,b[S].descender=this.entries[S].descender;c(null,b)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==I3.none&&(this.localGlyphMode===I3.all?!!this.localFontFamily:!!this.localFontFamily&&(Ee["CJK Unified Ideographs"](r)||Ee["Hangul Syllables"](r)||Ee.Hiragana(r)||Ee.Katakana(r)||Ee["CJK Symbols and Punctuation"](r)||Ee["CJK Unified Ideographs Extension A"](r)||Ee["CJK Unified Ideographs Extension B"](r)))}_tinySDF(r,s,c){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let p=r.tinySDF;if(!p){let V="400";/bold/i.test(s)?V="900":/medium/i.test(s)?V="500":/light/i.test(s)&&(V="200"),p=r.tinySDF=new M0.TinySDF({fontFamily:h,fontWeight:V,fontSize:24*Jl,buffer:3*Jl,radius:8*Jl}),p.fontWeight=V}if(this.localGlyphs[p.fontWeight][c])return this.localGlyphs[p.fontWeight][c];const m=String.fromCodePoint(c),{data:x,width:b,height:S,glyphWidth:I,glyphHeight:P,glyphLeft:D,glyphTop:F,glyphAdvance:U}=p.draw(m);return this.localGlyphs[p.fontWeight][c]={id:c,bitmap:new ld({width:b,height:S},x),metrics:{width:I/Jl,height:P/Jl,left:D/Jl,top:F/Jl-27,advance:U/Jl,localGlyph:!0}}}}M0.loadGlyphRange=function(i,r,s,c,h){const p=256*r,m=p+255,x=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",i).replace("{range}",`${p}-${m}`),$m.Glyphs);Su(x,(b,S)=>{if(b)h(b);else if(S){const I={},P=function(D){return new T0(D).readFields(gQ,{})}(S);for(const D of P.glyphs)I[D.id]=D;h(null,{glyphs:I,ascender:P.ascender,descender:P.descender})}})},M0.TinySDF=class{constructor({fontSize:i=24,buffer:r=3,radius:s=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:m="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=s;const x=this.size=i+4*r,b=this._createCanvas(x),S=this.ctx=b.getContext("2d",{willReadFrequently:!0});S.font=`${m} ${p} ${i}px ${h}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(i){const r=document.createElement("canvas");return r.width=r.height=i,r}draw(i){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(i),m=Math.ceil(s),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),b=Math.min(this.size-this.buffer,m+Math.ceil(c)),S=x+2*this.buffer,I=b+2*this.buffer,P=Math.max(S*I,0),D=new Uint8ClampedArray(P),F={data:D,width:S,height:I,glyphWidth:x,glyphHeight:b,glyphTop:m,glyphLeft:0,glyphAdvance:r};if(x===0||b===0)return F;const{ctx:U,buffer:V,gridInner:W,gridOuter:ee}=this;U.clearRect(V,V,x,b),U.fillText(i,V,V+m);const ce=U.getImageData(V,V,x,b);ee.fill(_v,0,P),W.fill(0,0,P);for(let ue=0;ue<b;ue++)for(let he=0;he<x;he++){const Se=ce.data[4*(ue*x+he)+3]/255;if(Se===0)continue;const be=(ue+V)*S+he+V;if(Se===1)ee[be]=0,W[be]=_v;else{const ke=.5-Se;ee[be]=ke>0?ke*ke:0,W[be]=ke<0?ke*ke:0}}HF(ee,0,0,S,I,S,this.f,this.v,this.z),HF(W,V,V,x,b,S,this.f,this.v,this.z);for(let ue=0;ue<P;ue++){const he=Math.sqrt(ee[ue])-Math.sqrt(W[ue]);D[ue]=Math.round(255-255*(he/this.radius+this.cutoff))}return F}};const hd=la;function WF(i,r,s,c){const h=[],p=i.imagePrimary,m=p.pixelRatio,x=p.paddedRect.w-2*hd,b=p.paddedRect.h-2*hd,S=i.right-i.left,I=i.bottom-i.top,P=p.stretchX||[[0,x]],D=p.stretchY||[[0,b]],F=(Ze,dt)=>Ze+dt[1]-dt[0],U=P.reduce(F,0),V=D.reduce(F,0),W=x-U,ee=b-V;let ce=0,ue=U,he=0,Se=V,be=0,ke=W,Le=0,je=ee;if(p.content&&c){const Ze=p.content;ce=kw(P,0,Ze[0]),he=kw(D,0,Ze[1]),ue=kw(P,Ze[0],Ze[2]),Se=kw(D,Ze[1],Ze[3]),be=Ze[0]-ce,Le=Ze[1]-he,ke=Ze[2]-Ze[0]-ue,je=Ze[3]-Ze[1]-Se}const ot=(Ze,dt,At,ct)=>{const bt=Dw(Ze.stretch-ce,ue,S,i.left),st=Ow(Ze.fixed-be,ke,Ze.stretch,U),wt=Dw(dt.stretch-he,Se,I,i.top),Pt=Ow(dt.fixed-Le,je,dt.stretch,V),Tt=Dw(At.stretch-ce,ue,S,i.left),Ht=Ow(At.fixed-be,ke,At.stretch,U),It=Dw(ct.stretch-he,Se,I,i.top),Dt=Ow(ct.fixed-Le,je,ct.stretch,V),fr=new Ut(bt,wt),lr=new Ut(Tt,wt),sr=new Ut(Tt,It),Rt=new Ut(bt,It),mr=new Ut(st/m,Pt/m),jr=new Ut(Ht/m,Dt/m),Sr=r*Math.PI/180;if(Sr){const On=Math.sin(Sr),bn=Math.cos(Sr),cn=[bn,-On,On,bn];fr._matMult(cn),lr._matMult(cn),Rt._matMult(cn),sr._matMult(cn)}const Wr=Ze.stretch+Ze.fixed,Vr=At.stretch+At.fixed,Qr=dt.stretch+dt.fixed,br=ct.stretch+ct.fixed,Bn=i.imageSecondary;return{tl:fr,tr:lr,bl:Rt,br:sr,texPrimary:{x:p.paddedRect.x+hd+Wr,y:p.paddedRect.y+hd+Qr,w:Vr-Wr,h:br-Qr},texSecondary:Bn?{x:Bn.paddedRect.x+hd+Wr,y:Bn.paddedRect.y+hd+Qr,w:Vr-Wr,h:br-Qr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mr,pixelOffsetBR:jr,minFontScaleX:ke/m/S,minFontScaleY:je/m/I,isSDF:s}};if(c&&(p.stretchX||p.stretchY)){const Ze=qF(P,W,U),dt=qF(D,ee,V);for(let At=0;At<Ze.length-1;At++){const ct=Ze[At],bt=Ze[At+1];for(let st=0;st<dt.length-1;st++)h.push(ot(ct,dt[st],bt,dt[st+1]))}}else h.push(ot({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:b+1}));return h}function kw(i,r,s){let c=0;for(const h of i)c+=Math.max(r,Math.min(s,h[1]))-Math.max(r,Math.min(s,h[0]));return c}function qF(i,r,s){const c=[{fixed:-hd,stretch:0}];for(const[h,p]of i){const m=c[c.length-1];c.push({fixed:h-m.stretch,stretch:m.stretch}),c.push({fixed:h-m.stretch,stretch:m.stretch+(p-h)})}return c.push({fixed:r+hd,stretch:s}),c}function Dw(i,r,s,c){return i/r*s+c}function Ow(i,r,s,c){return i-r*s/c}function EQ(i,r,s,c){const h=r+i.positionedLines[c].lineOffset;return c===0?s+h/2:s+(h+(r+i.positionedLines[c-1].lineOffset))/2}function SQ(i,r=1,s=!1){let c=1/0,h=1/0,p=-1/0,m=-1/0;const x=i[0];for(let F=0;F<x.length;F++){const U=x[F];(!F||U.x<c)&&(c=U.x),(!F||U.y<h)&&(h=U.y),(!F||U.x>p)&&(p=U.x),(!F||U.y>m)&&(m=U.y)}const b=Math.min(p-c,m-h);let S=b/2;const I=new Py([],TQ);if(b===0)return new Ut(c,h);for(let F=c;F<p;F+=b)for(let U=h;U<m;U+=b)I.push(new P0(F+S,U+S,S,i));let P=function(F){let U=0,V=0,W=0;const ee=F[0];for(let ce=0,ue=ee.length,he=ue-1;ce<ue;he=ce++){const Se=ee[ce],be=ee[he],ke=Se.x*be.y-be.x*Se.y;V+=(Se.x+be.x)*ke,W+=(Se.y+be.y)*ke,U+=3*ke}return new P0(V/U,W/U,0,F)}(i),D=I.length;for(;I.length;){const F=I.pop();(F.d>P.d||!P.d)&&(P=F,s&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,D)),F.max-P.d<=r||(S=F.h/2,I.push(new P0(F.p.x-S,F.p.y-S,S,i)),I.push(new P0(F.p.x+S,F.p.y-S,S,i)),I.push(new P0(F.p.x-S,F.p.y+S,S,i)),I.push(new P0(F.p.x+S,F.p.y+S,S,i)),D+=4)}return s&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function TQ(i,r){return r.max-i.max}class P0{constructor(r,s,c,h){this.p=new Ut(r,s),this.h=c,this.d=function(p,m){let x=!1,b=1/0;for(let S=0;S<m.length;S++){const I=m[S];for(let P=0,D=I.length,F=D-1;P<D;F=P++){const U=I[P],V=I[F];U.y>p.y!=V.y>p.y&&p.x<(V.x-U.x)*(p.y-U.y)/(V.y-U.y)+U.x&&(x=!x),b=Math.min(b,eB(p,U,V))}}return(x?1:-1)*Math.sqrt(b)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const M3=Number.POSITIVE_INFINITY,AQ=Math.sqrt(2);function KF(i,[r,s]){let c=0,h=0;if(s===M3){r<0&&(r=0);const p=r/AQ;switch(i){case"top-right":case"top-left":h=p-7;break;case"bottom-right":case"bottom-left":h=7-p;break;case"bottom":h=7-r;break;case"top":h=r-7}switch(i){case"top-right":case"bottom-right":c=-p;break;case"top-left":case"bottom-left":c=p;break;case"left":c=r;break;case"right":c=-r}}else{switch(r=Math.abs(r),s=Math.abs(s),i){case"top-right":case"top-left":case"top":h=s-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-s}switch(i){case"top-right":case"bottom-right":case"right":c=-r;break;case"top-left":case"bottom-left":case"left":c=r}}return[c,h]}function P3(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function IQ(i,r,s,c,h,p,m,x,b,S,I,P,D,F,U){let V=p.textMaxSize.evaluate(r,{},P);V===void 0&&(V=m);const W=i.layers[0].layout,ee=W.get("icon-offset").evaluate(r,{},P),ce=ZF(s.horizontal)||s.vertical,ue=D.name==="globe",he=Ho,Se=m/he,be=i.tilePixelRatio*V/he,ke=(bt=i.overscaling,i.zoom>18&&bt>2&&(bt>>=1),Math.max(Bt/(512*bt),1)*W.get("symbol-spacing")),Le=W.get("text-padding")*i.tilePixelRatio,je=W.get("icon-padding")*i.tilePixelRatio,ot=an(W.get("text-max-angle")),Ze=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",dt=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",At=W.get("symbol-placement"),ct=ke/2;var bt;const st=W.get("icon-text-fit").evaluate(r,{},P),wt=W.get("icon-text-fit-padding").evaluate(r,{},P),Pt=st!=="none";let Tt;i.hasAnyIconTextFit===!1&&Pt&&(i.hasAnyIconTextFit=!0),c&&Pt&&(i.allowVerticalPlacement&&s.vertical&&(Tt=LF(c,s.vertical,st,wt,ee,Se)),ce&&(c=LF(c,ce,st,wt,ee,Se)));const Ht=(It,Dt,fr)=>{if(Dt.x<0||Dt.x>=Bt||Dt.y<0||Dt.y>=Bt)return;let lr=null;if(ue){const{x:sr,y:Rt,z:mr}=D.projectTilePoint(Dt.x,Dt.y,fr);lr={anchor:new Gu(sr,Rt,mr,0,void 0),up:D.upVector(fr,Dt.x,Dt.y)}}(function(sr,Rt,mr,jr,Sr,Wr,Vr,Qr,br,Bn,On,bn,cn,wn,Qn,$n,pi,fi,ts,Ti,oi,Vi,ko,Do,Gn,Os,Wu){const gl=sr.addToLineVertexArray(Rt,jr);let oc,yd,vd,yp,Qz,Jz,e6,t6=0,r6=0,n6=0,i6=0,nM=-1,iM=-1;const Gc={};let o6=Fh("");const vp=mr?mr.anchor:Rt,oM=br.layout.get("icon-text-fit").evaluate(oi,{},Gn)!=="none";let sM=0,aM=0;if(br._unevaluatedLayout.getValue("text-radial-offset")===void 0?[sM,aM]=br.layout.get("text-offset").evaluate(oi,{},Gn).map(ua=>ua*Ho):(sM=br.layout.get("text-radial-offset").evaluate(oi,{},Gn)*Ho,aM=M3),sr.allowVerticalPlacement&&Sr.vertical){const ua=Sr.vertical;if(Qn)Jz=R3(ua),Qr&&(e6=R3(Qr));else{const ha=br.layout.get("text-rotate").evaluate(oi,{},Gn)+90;vd=Lw(Bn,vp,Rt,On,bn,cn,ua,wn,ha,$n),Qr&&(yp=Lw(Bn,vp,Rt,On,bn,cn,Qr,fi,ha))}}if(Wr){const ua=br.layout.get("icon-rotate").evaluate(oi,{},Gn),ha=WF(Wr,ua,ko,oM),N0=Qr?WF(Qr,ua,ko,oM):void 0;yd=Lw(Bn,vp,Rt,On,bn,cn,Wr,fi,ua),t6=4*ha.length;const s6=sr.iconSizeData;let xp=null;s6.kind==="source"?(xp=[Ql*br.layout.get("icon-size").evaluate(oi,{},Gn)],xp[0]>dd&&Pi(`${sr.layerIds[0]}: Value for "icon-size" is >= ${yv}. Reduce your "icon-size".`)):s6.kind==="composite"&&(xp=[Ql*Vi.compositeIconSizes[0].evaluate(oi,{},Gn),Ql*Vi.compositeIconSizes[1].evaluate(oi,{},Gn)],(xp[0]>dd||xp[1]>dd)&&Pi(`${sr.layerIds[0]}: Value for "icon-size" is >= ${yv}. Reduce your "icon-size".`)),sr.addSymbols(sr.icon,ha,xp,Ti,ts,oi,!1,mr,Rt,gl.lineStartIndex,gl.lineLength,-1,Do,Gn,Os,Wu),nM=sr.icon.placedSymbolArray.length-1,N0&&(r6=4*N0.length,sr.addSymbols(sr.icon,N0,xp,Ti,ts,oi,Oa.vertical,mr,Rt,gl.lineStartIndex,gl.lineLength,-1,Do,Gn,Os,Wu),iM=sr.icon.placedSymbolArray.length-1)}for(const ua in Sr.horizontal){const ha=Sr.horizontal[ua];oc||(o6=Fh(ha.text),Qn?Qz=R3(ha):oc=Lw(Bn,vp,Rt,On,bn,cn,ha,wn,br.layout.get("text-rotate").evaluate(oi,{},Gn),$n));const N0=ha.positionedLines.length===1;if(n6+=YF(sr,mr,Rt,ha,Vr,br,Qn,oi,$n,gl,Sr.vertical?Oa.horizontal:Oa.horizontalOnly,N0?Object.keys(Sr.horizontal):[ua],Gc,nM,Vi,Do,Gn,Os),N0)break}Sr.vertical&&(i6+=YF(sr,mr,Rt,Sr.vertical,Vr,br,Qn,oi,$n,gl,Oa.vertical,["vertical"],Gc,iM,Vi,Do,Gn,Os));let xd=-1;const lM=(ua,ha)=>ua?Math.max(ua,ha):ha;xd=lM(Qz,xd),xd=lM(Jz,xd),xd=lM(e6,xd);const WJ=xd>-1?1:0;sr.glyphOffsetArray.length>=65535&&Pi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),oi.sortKey!==void 0&&sr.addToSortKeyRanges(sr.symbolInstances.length,oi.sortKey),sr.symbolInstances.emplaceBack(Rt.x,Rt.y,vp.x,vp.y,vp.z,Gc.right>=0?Gc.right:-1,Gc.center>=0?Gc.center:-1,Gc.left>=0?Gc.left:-1,Gc.vertical>=0?Gc.vertical:-1,nM,iM,o6,oc!==void 0?oc:sr.collisionBoxArray.length,oc!==void 0?oc+1:sr.collisionBoxArray.length,vd!==void 0?vd:sr.collisionBoxArray.length,vd!==void 0?vd+1:sr.collisionBoxArray.length,yd!==void 0?yd:sr.collisionBoxArray.length,yd!==void 0?yd+1:sr.collisionBoxArray.length,yp||sr.collisionBoxArray.length,yp?yp+1:sr.collisionBoxArray.length,On,n6,i6,t6,r6,WJ,0,sM,aM,xd,0,1,1,oM?1:0)})(i,Dt,lr,It,s,c,h,Tt,i.layers[0],i.collisionBoxArray,r.index,r.sourceLayerIndex,i.index,Le,Ze,b,0,je,dt,ee,r,p,S,I,P,F,U)};if(At==="line")for(const It of $F(r.geometry,0,0,Bt,Bt)){const Dt=CQ(It,ke,ot,s.vertical||ce,c,he,be,i.overscaling,Bt);for(const fr of Dt)ce&&MQ(i,ce.text,ct,fr)||Ht(It,fr,P)}else if(At==="line-center"){for(const It of r.geometry)if(It.length>1){const Dt=wQ(It,ot,s.vertical||ce,c,he,be);Dt&&Ht(It,Dt,P)}}else if(r.type==="Polygon")for(const It of _w(r.geometry,0)){const Dt=SQ(It,16);Ht(It[0],new Gu(Dt.x,Dt.y,0,0,void 0),P)}else if(r.type==="LineString")for(const It of r.geometry)Ht(It,new Gu(It[0].x,It[0].y,0,0,void 0),P);else if(r.type==="Point")for(const It of r.geometry)for(const Dt of It)Ht([Dt],new Gu(Dt.x,Dt.y,0,0,void 0),P)}const yv=255,dd=yv*Ql;function YF(i,r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W,ee){const ce=function(Se,be,ke,Le,je,ot,Ze,dt){const At=[];if(be.positionedLines.length===0)return At;const ct=Le.layout.get("text-rotate").evaluate(ot,{})*Math.PI/180,bt=function(Ht){const It=Ht[0],Dt=Ht[1],fr=It*Dt;return fr>0?[It,-Dt]:fr<0?[-It,Dt]:It===0?[Dt,It]:[Dt,-It]}(ke);let st=Math.abs(be.top-be.bottom);for(const Ht of be.positionedLines)st-=Ht.lineOffset;const wt=be.positionedLines.length,Pt=st/wt;let Tt=be.top-ke[1];for(let Ht=0;Ht<wt;++Ht){const It=be.positionedLines[Ht];Tt=EQ(be,Pt,Tt,Ht);for(const Dt of It.positionedGlyphs){if(!Dt.rect)continue;const fr=Dt.rect||{};let lr=MF+1,sr=!0,Rt=1,mr=0;if(Dt.imageName){const Ti=Ze[Dt.imageName];if(!Ti)continue;if(Ti.sdf){Pi("SDF images are not supported in formatted text and will be ignored.");continue}sr=!1,Rt=Ti.pixelRatio,lr=la/Rt}const jr=(je||dt)&&Dt.vertical,Sr=Dt.metrics.advance*Dt.scale/2,Wr=Dt.metrics,Vr=Dt.rect;if(Vr===null)continue;dt&&be.verticalizable&&(mr=Dt.imageName?Sr-Dt.metrics.width*Dt.scale/2:0);const Qr=je?[Dt.x+Sr,Dt.y]:[0,0];let br=[0,0],Bn=[0,0],On=!1;je||(jr?(Bn=[Dt.x+Sr+bt[0],Dt.y+bt[1]-mr],On=!0):br=[Dt.x+Sr+ke[0],Dt.y+ke[1]-mr]);const bn=Vr.w*Dt.scale/(Rt*(Dt.localGlyph?Jl:1)),cn=Vr.h*Dt.scale/(Rt*(Dt.localGlyph?Jl:1));let wn,Qn,$n,pi;if(jr){const Ti=Dt.y-Tt,oi=new Ut(-Sr,Sr-Ti),Vi=-Math.PI/2,ko=new Ut(...Bn);wn=new Ut(-Sr+br[0],br[1]),wn._rotateAround(Vi,oi)._add(ko),wn.x+=-Ti+Sr,wn.y-=(Wr.left-lr)*Dt.scale;const Do=Dt.imageName?Wr.advance*Dt.scale:Ho*Dt.scale,Gn=String.fromCodePoint(Dt.glyph);pQ(Gn)?wn.x+=(1-lr)*Dt.scale:mQ(Gn)?wn.x+=Do-Wr.height*Dt.scale+(-lr-1)*Dt.scale:wn.x+=Dt.imageName||Wr.width+2*lr===Vr.w&&Wr.height+2*lr===Vr.h?(Do-cn)/2:(Do-(Wr.height+2*lr)*Dt.scale)/2,Qn=new Ut(wn.x,wn.y-bn),$n=new Ut(wn.x+cn,wn.y),pi=new Ut(wn.x+cn,wn.y-bn)}else{const Ti=(Wr.left-lr)*Dt.scale-Sr+br[0],oi=(-Wr.top-lr)*Dt.scale+br[1],Vi=Ti+bn,ko=oi+cn;wn=new Ut(Ti,oi),Qn=new Ut(Vi,oi),$n=new Ut(Ti,ko),pi=new Ut(Vi,ko)}if(ct){let Ti;Ti=je?new Ut(0,0):On?new Ut(bt[0],bt[1]):new Ut(ke[0],ke[1]),wn._rotateAround(ct,Ti),Qn._rotateAround(ct,Ti),$n._rotateAround(ct,Ti),pi._rotateAround(ct,Ti)}const fi=new Ut(0,0),ts=new Ut(0,0);At.push({tl:wn,tr:Qn,bl:$n,br:pi,texPrimary:fr,texSecondary:void 0,writingMode:be.writingMode,glyphOffset:Qr,sectionIndex:Dt.sectionIndex,isSDF:sr,pixelOffsetTL:fi,pixelOffsetBR:ts,minFontScaleX:0,minFontScaleY:0})}}return At}(0,c,b,p,m,x,h,i.allowVerticalPlacement),ue=i.textSizeData;let he=null;ue.kind==="source"?(he=[Ql*p.layout.get("text-size").evaluate(x,{},W)],he[0]>dd&&Pi(`${i.layerIds[0]}: Value for "text-size" is >= ${yv}. Reduce your "text-size".`)):ue.kind==="composite"&&(he=[Ql*U.compositeTextSizes[0].evaluate(x,{},W),Ql*U.compositeTextSizes[1].evaluate(x,{},W)],(he[0]>dd||he[1]>dd)&&Pi(`${i.layerIds[0]}: Value for "text-size" is >= ${yv}. Reduce your "text-size".`)),i.addSymbols(i.text,ce,he,b,m,x,I,r,s,S.lineStartIndex,S.lineLength,F,V,W,ee,!1);for(const Se of P)D[Se]=i.text.placedSymbolArray.length-1;return 4*ce.length}function ZF(i){for(const r in i)return i[r];return null}function Lw(i,r,s,c,h,p,m,x,b,S){let I=m.top,P=m.bottom,D=m.left,F=m.right;const U=m.collisionPadding;if(U&&(D-=U[0],I-=U[1],F+=U[2],P+=U[3]),b){const V=new Ut(D,I),W=new Ut(F,I),ee=new Ut(D,P),ce=new Ut(F,P),ue=an(b);let he=new Ut(0,0);S&&(he=new Ut(S[0],S[1])),V._rotateAround(ue,he),W._rotateAround(ue,he),ee._rotateAround(ue,he),ce._rotateAround(ue,he),D=Math.min(V.x,W.x,ee.x,ce.x),F=Math.max(V.x,W.x,ee.x,ce.x),I=Math.min(V.y,W.y,ee.y,ce.y),P=Math.max(V.y,W.y,ee.y,ce.y)}return i.emplaceBack(r.x,r.y,r.z,s.x,s.y,D,I,F,P,x,c,h,p),i.length-1}function R3(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const r=i.bottom-i.top;return r>0?Math.max(10,r):null}function MQ(i,r,s,c){const h=i.compareText;if(r in h){const p=h[r];for(let m=p.length-1;m>=0;m--)if(c.dist(p[m])<s)return!0}else h[r]=[];return h[r].push(c),!1}function XF(i,r){const s=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*r:0,h=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),p=Math.sin(s)*h/Math.sin(Math.max(Math.PI/2-i._pitch-s,.01)),m=Math.sin(i._pitch)*p+h;return Math.min(1.01*m,h*(1/i._horizonShift))}function dp(i,r){if(!r.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:r};const s=Math.pow(2,-i.z),c=i.x*s,h=(i.x+1)*s,p=i.y*s,m=(i.y+1)*s,x=Ys(c),b=Ys(h),S=Ro(p),I=Ro(m),P=r.project(x,S),D=r.project(b,S),F=r.project(b,I),U=r.project(x,I);let V=Math.min(P.x,D.x,F.x,U.x),W=Math.min(P.y,D.y,F.y,U.y),ee=Math.max(P.x,D.x,F.x,U.x),ce=Math.max(P.y,D.y,F.y,U.y);const ue=s/16;function he(be,ke,Le,je,ot,Ze){const dt=(Le+ot)/2,At=(je+Ze)/2,ct=r.project(Ys(dt),Ro(At)),bt=Math.max(0,V-ct.x,W-ct.y,ct.x-ee,ct.y-ce);V=Math.min(V,ct.x),ee=Math.max(ee,ct.x),W=Math.min(W,ct.y),ce=Math.max(ce,ct.y),bt>ue&&(he(be,ct,Le,je,dt,At),he(ct,ke,dt,At,ot,Ze))}he(P,D,c,p,h,p),he(D,F,h,p,h,m),he(F,U,h,m,c,m),he(U,P,c,m,c,p),V-=ue,W-=ue,ee+=ue,ce+=ue;const Se=1/Math.max(ee-V,ce-W);return{scale:Se,x:V*Se,y:W*Se,x2:ee*Se,y2:ce*Se,projection:r}}function QF(i,{x:r,y:s},c=0){return new Ut(((r-c)*i.scale-i.x)*Bt,(s*i.scale-i.y)*Bt)}const PQ=a.ad.identity(new Float32Array(16));class fd{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,s){return{x:0,y:0,z:0}}unproject(r,s){return new gn(0,0)}projectTilePoint(r,s,c){return{x:r,y:s,z:0}}locationPoint(r,s,c=!0){return r._coordinatePoint(r.locationCoordinate(s),c)}pixelsPerMeter(r,s){return Ds(1,r)*s}pixelSpaceConversion(r,s,c){return 1}farthestPixelDistance(r){return XF(r,r.pixelsPerMeter)}pointCoordinate(r,s,c,h){const p=r.horizonLineFromTop(!1),m=new Ut(s,Math.max(p,c));return r.rayIntersectionCoordinate(r.pointRayIntersection(m,h))}pointCoordinate3D(r,s,c){const h=new Ut(s,c);if(r.elevation)return r.elevation.pointCoordinate(h);{const p=this.pointCoordinate(r,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(r,s){if(r.elevation&&r.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(r,s.x,s.y);const c=r.horizonLineFromTop();return s.y<c}createInversionMatrix(r,s){return PQ}createTileMatrix(r,s,c){let h,p,m;const x=c.canonical,b=a.ad.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=dp(x,this);h=1,p=S.x+c.wrap*S.scale,m=S.y,a.ad.scale(b,b,[h/S.scale,h/S.scale,r.pixelsPerMeter/s])}else h=s/r.zoomScale(x.z),p=(x.x+Math.pow(2,x.z)*c.wrap)*h,m=x.y*h;return a.ad.translate(b,b,[p,m,0]),a.ad.scale(b,b,[h/Bt,h/Bt,1]),b}upVector(r,s,c){return[0,0,1]}upVectorScale(r,s,c){return{metersToTile:1}}}class RQ extends fd{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[s,c]=this.parallels=r.parallels||[29.5,45.5],h=Math.sin(an(s));this.n=(h+Math.sin(an(c)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(r,s){const{n:c,c:h,r0:p}=this,m=an(r-this.center[0]),x=an(s),b=Math.sqrt(h-2*c*Math.sin(x))/c;return{x:b*Math.sin(m*c),y:b*Math.cos(m*c)-p,z:0}}unproject(r,s){const{n:c,c:h,r0:p}=this,m=p+s;let x=Math.atan2(r,Math.abs(m))*Math.sign(m);m*c<0&&(x-=Math.PI*Math.sign(r)*Math.sign(m));const b=an(this.center[0])*c;x=wu(x,-Math.PI-b,Math.PI-b);const S=Kr($o(x/c)+this.center[0],-180,180),I=Math.asin(Kr((h-(r*r+m*m)*c*c)/(2*c),-1,1)),P=Kr($o(I),-ki,ki);return new gn(S,P)}}const vv=1.340264,xv=-.081106,bv=893e-6,wv=.003796,Bw=Math.sqrt(3)/2;class kQ extends fd{project(r,s){s=s/180*Math.PI,r=r/180*Math.PI;const c=Math.asin(Bw*Math.sin(s)),h=c*c,p=h*h*h;return{x:.5*(r*Math.cos(c)/(Bw*(vv+3*xv*h+p*(7*bv+9*wv*h)))/Math.PI+.5),y:1-.5*(c*(vv+xv*h+p*(bv+wv*h))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,h=c*c,p=h*h*h;for(let I,P,D,F=0;F<12&&(P=c*(vv+xv*h+p*(bv+wv*h))-s,D=vv+3*xv*h+p*(7*bv+9*wv*h),I=P/D,c=Kr(c-I,-Math.PI/3,Math.PI/3),h=c*c,p=h*h*h,!(Math.abs(I)<1e-12));++F);const m=Bw*r*(vv+3*xv*h+p*(7*bv+9*wv*h))/Math.cos(c),x=Math.asin(Math.sin(c)/Bw),b=Kr(180*m/Math.PI,-180,180),S=Kr(180*x/Math.PI,-ki,ki);return new gn(b,S)}}class DQ extends fd{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){return{x:.5+r/360,y:.5-s/360,z:0}}unproject(r,s){const c=360*(r-.5),h=Kr(360*(.5-s),-ki,ki);return new gn(c,h)}}const R0=Math.PI/2;function Fw(i){return Math.tan((R0+i)/2)}class OQ extends fd{constructor(r){super(r),this.center=r.center||[0,30];const[s,c]=this.parallels=r.parallels||[30,30];let h=an(s),p=an(c);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const m=Math.cos(h),x=Fw(h);this.n=h===p?Math.sin(h):Math.log(m/Math.cos(p))/Math.log(Fw(p)/x),this.f=m*Math.pow(Fw(h),this.n)/this.n}project(r,s){s=an(s),this.southernCenter&&(s=-s),r=an(r-this.center[0]);const c=1e-6,{n:h,f:p}=this;p>0?s<-R0+c&&(s=-R0+c):s>R0-c&&(s=R0-c);const m=p/Math.pow(Fw(s),h);let x=m*Math.sin(h*r),b=p-m*Math.cos(h*r);return x=.5*(x/Math.PI+.5),b=.5*(b/Math.PI+.5),{x,y:this.southernCenter?b:1-b,z:0}}unproject(r,s){r=(2*r-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:h}=this,p=h-s,m=Math.sign(p),x=Math.sign(c)*Math.sqrt(r*r+p*p);let b=Math.atan2(r,Math.abs(p))*m;p*c<0&&(b-=Math.PI*Math.sign(r)*m);const S=Kr($o(b/c)+this.center[0],-180,180),I=Kr($o(2*Math.atan(Math.pow(h/x,1/c))-R0),-ki,ki);return new gn(S,this.southernCenter?-I:I)}}class JF extends fd{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,s){return{x:Nc(r),y:Uc(s),z:0}}unproject(r,s){const c=Ys(r),h=Ro(s);return new gn(c,h)}}const ez=an(ki);class LQ extends fd{project(r,s){const c=(s=an(s))*s,h=c*c;return{x:.5*((r=an(r))*(.8707-.131979*c+h*(h*(.003971*c-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+h*(.028874*c-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,h=25,p=0,m=c*c;do{m=c*c;const S=m*m;p=(c*(1.007226+m*(.015085+S*(.028874*m-.044475-.005916*S)))-s)/(1.007226+m*(.045255+S*(.259866*m-.311325-.005916*11*S))),c=Kr(c-p,-ez,ez)}while(Math.abs(p)>1e-6&&--h>0);m=c*c;const x=Kr($o(r/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),b=$o(c);return new gn(x,b)}}const tz=an(ki);class BQ extends fd{project(r,s){s=an(s),r=an(r);const c=Math.cos(s),h=2/Math.PI,p=Math.acos(c*Math.cos(r/2)),m=Math.sin(p)/p,x=.5*(r*h+2*c*Math.sin(r/2)/m)||0,b=.5*(s+Math.sin(s)/m)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}}unproject(r,s){let c=r=(2*r-.5)*Math.PI,h=s=(2*(1-s)-1)*Math.PI,p=25;const m=1e-6;let x=0,b=0;do{const S=Math.cos(h),I=Math.sin(h),P=2*I*S,D=I*I,F=S*S,U=Math.cos(c/2),V=Math.sin(c/2),W=2*U*V,ee=V*V,ce=1-F*U*U,ue=ce?1/ce:0,he=ce?Math.acos(S*U)*Math.sqrt(1/ce):0,Se=.5*(2*he*S*V+2*c/Math.PI)-r,be=.5*(he*I+h)-s,ke=.5*ue*(F*ee+he*S*U*D)+1/Math.PI,Le=ue*(W*P/4-he*I*V),je=.125*ue*(P*V-he*I*F*W),ot=.5*ue*(D*U+he*ee*S)+.5,Ze=Le*je-ot*ke;x=(be*Le-Se*ot)/Ze,b=(Se*je-be*ke)/Ze,c=Kr(c-x,-Math.PI,Math.PI),h=Kr(h-b,-tz,tz)}while((Math.abs(x)>m||Math.abs(b)>m)&&--p>0);return new gn($o(c),$o(h))}}class rz extends fd{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(an(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){const{scale:c,cosPhi:h}=this;return{x:an(r)*h*c+.5,y:-Math.sin(an(s))/h*c+.5,z:0}}unproject(r,s){const{scale:c,cosPhi:h}=this,p=-(s-.5)/c,m=Kr($o((r-.5)/c)/h,-180,180),x=Math.asin(Kr(p*h,-1,1)),b=Kr($o(x),-ki,ki);return new gn(m,b)}}class FQ extends JF{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,s,c){const h=ov(r,s,c),p=sv($c(c));return a._.transformMat4(h,h,p),{x:h[0],y:h[1],z:h[2]}}locationPoint(r,s){const c=ap(s.lat,s.lng),h=a._.normalize([],c),p=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(s),r._centerAltitude):r._centerAltitude,m=Ds(1,0)*Bt*p;a._.scaleAndAdd(c,c,h,m);const x=a.ad.identity(new Float64Array(16));return a.ad.multiply(x,r.pixelMatrix,r.globeMatrix),a._.transformMat4(c,c,x),new Ut(c[0],c[1])}pixelsPerMeter(r,s){return Ds(1,0)*s}pixelSpaceConversion(r,s,c){const h=Ds(1,r)*s,p=_r(Ds(1,45)*s,h,c);return this.pixelsPerMeter(r,s)/p}createTileMatrix(r,s,c){const h=l3($c(c.canonical));return a.ad.multiply(new Float64Array(16),r.globeMatrix,h)}createInversionMatrix(r,s){const{center:c}=r,h=sv($c(s));return a.ad.rotateY(h,h,an(c.lng)),a.ad.rotateX(h,h,an(c.lat)),a.ad.scale(h,h,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(r,s,c,h){return cB(r,s,c,!0)||new es(0,0)}pointCoordinate3D(r,s,c){const h=this.pointCoordinate(r,s,c,0);return[h.x,h.y,h.z]}isPointAboveHorizon(r,s){return!cB(r,s.x,s.y,!1)}farthestPixelDistance(r){const s=function(h,p){const m=h.cameraToCenterDistance,x=h._centerAltitude*p,b=h._camera,S=h._camera.forward(),I=a._.add([],a._.scale([],S,-m),[0,0,x]),P=h.worldSize/(2*Math.PI),D=[0,0,-P],F=h.width/h.height,U=Math.tan(h.fovAboveCenter),V=a._.scale([],b.up(),U),W=a._.scale([],b.right(),U*F),ee=a._.normalize([],a._.add([],a._.add([],S,V),W)),ce=[];let ue;if(new n3(I,ee).closestPointOnSphere(D,P,ce)){const he=a._.add([],ce,D),Se=a._.sub([],he,I);ue=Math.cos(h.fovAboveCenter)*a._.length(Se)}else{const he=a._.sub([],I,D),Se=a._.sub([],D,I);a._.normalize(Se,Se);const be=a._.length(he)-P;ue=Math.sqrt(be*(be+2*P));const ke=Math.acos(ue/(P+be))-Math.acos(a._.dot(S,Se));ue*=Math.cos(ke)}return 1.01*ue}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),c=Vu(r.zoom);if(c>0){const h=XF(r,Ds(1,r.center.lat)*r.worldSize),p=r.worldSize/(2*Math.PI),m=Math.max(r.width,r.height)/r.worldSize*Math.PI;return _r(s,h+p*(1-Math.cos(m)),Math.pow(c,10))}return s}upVector(r,s,c){return ov(s,c,r,1)}upVectorScale(r){return{metersToTile:hw(fw($c(r)))}}}function nz(i){const r=i.parallels,s=!!r&&Math.abs(r[0]+r[1])<.01;switch(i.name){case"mercator":return new JF(i);case"equirectangular":return new DQ(i);case"naturalEarth":return new LQ(i);case"equalEarth":return new kQ(i);case"winkelTripel":return new BQ(i);case"albers":return s?new rz(i):new RQ(i);case"lambertConformalConic":return s?new rz(i):new OQ(i);case"globe":return new FQ(i)}throw new Error(`Invalid projection name: ${i.name}`)}class fp{constructor(r,s,c,h){this.id=fp.uniqueIdxCounter,fp.uniqueIdxCounter++,this.context=r;const p=r.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||h||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=fp.uniqueIdxCounter,fp.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}fp.uniqueIdxCounter=0;class k0{constructor(r,s,c){this.func=r,this.mask=s,this.range=c}}k0.ReadOnly=!1,k0.ReadWrite=!0,k0.disabled=new k0(519,k0.ReadOnly,[0,1]);const k3=7680;class D3{constructor(r,s,c,h,p,m){this.test=r,this.ref=s,this.mask=c,this.fail=h,this.depthFail=p,this.pass=m}}D3.disabled=new D3({func:519,mask:0},0,0,k3,k3,k3);const Cv=771;class ca{constructor(r,s,c,h){this.blendFunction=r,this.blendColor=s,this.mask=c,this.blendEquation=h}}ca.Replace=[1,0,1,0],ca.disabled=new ca(ca.Replace,yn.transparent,[!1,!1,!1,!1]),ca.unblended=new ca(ca.Replace,yn.transparent,[!0,!0,!0,!0]),ca.alphaBlended=new ca([1,Cv,1,Cv],yn.transparent,[!0,!0,!0,!0]),ca.alphaBlendedNonPremultiplied=new ca([770,Cv,770,Cv],yn.transparent,[!0,!0,!0,!0]),ca.multiply=new ca([774,0,774,0],yn.transparent,[!0,!0,!0,!0]);const O3=1029,L3=2305;class ec{constructor(r,s,c){this.enable=r,this.mode=s,this.frontFace=c}}ec.disabled=new ec(!1,O3,L3),ec.backCCW=new ec(!0,O3,L3),ec.backCW=new ec(!0,O3,2304),ec.frontCW=new ec(!0,1028,2304),ec.frontCCW=new ec(!0,1028,L3);const zQ=xw.types,NQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zw(i,r,s,c,h,p,m,x,b,S,I,P,D){const F=x?Math.min(dd,Math.round(x[0])):0,U=x?Math.min(dd,Math.round(x[1])):0;i.emplaceBack(r,s,Math.round(32*c),Math.round(32*h),p,m,(F<<1)+(b?1:0),U,16*S,16*I,256*P,256*D)}function Nw(i,r,s){i.emplaceBack(r,s)}function Uw(i,r,s,c,h,p,m){i.emplaceBack(r,s,c,h,p,m)}function $w(i,r,s,c,h){i.emplaceBack(r,s,c,h),i.emplaceBack(r,s,c,h),i.emplaceBack(r,s,c,h),i.emplaceBack(r,s,c,h)}function UQ(i){for(const r of i.sections)if(pt(r.text))return!0;return!1}class B3{constructor(r){this.layoutVertexArray=new TI,this.indexArray=new vo,this.programConfigurations=r,this.segments=new hi,this.dynamicLayoutVertexArray=new ed,this.opacityVertexArray=new II,this.occlusionQueryOpacityVertexArray=new ip,this.placedSymbolArray=new DL,this.iconTransitioningVertexArray=new nd,this.globeExtVertexArray=new AI,this.zOffsetVertexArray=new ip}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(r,s,c,h,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,jX.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,HX.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,NQ,!0),this.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(this.occlusionQueryOpacityVertexArray,b3.members,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,GX.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,VX.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,hF.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||h)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.occlusionQueryOpacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}pe(B3,"SymbolBuffers");class F3{constructor(r,s,c){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new c,this.segments=new hi,this.collisionVertexArray=new RI,this.collisionVertexArrayExt=new ed}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,WX.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,qX.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}pe(F3,"CollisionBuffers");class D0{constructor(r){this.queries=new Map,this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.lut=r.lut,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=a.ad.identity([]),this.placementViewportMatrix=a.ad.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=C3(this.zoom,s["text-size"]),this.iconSizeData=C3(this.zoom,s["icon-size"]);const c=this.layers[0].layout,h=c.get("symbol-sort-key"),p=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(m=>Oa[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new B3(new od(this.layers,{zoom:this.zoom,lut:this.lut},r=>/^text/.test(r))),this.icon=new B3(new od(this.layers,{zoom:this.zoom,lut:this.lut},r=>/^icon/.test(r))),this.glyphOffsetArray=new BL,this.lineVertexArray=new FL,this.symbolInstances=new LL}calculateGlyphDependencies(r,s,c,h,p){for(let m=0;m<r.length;m++){const x=r.codePointAt(m);if(x===void 0)break;if(s[x]=!0,h&&p&&x<=65535){const b=mv[r.charAt(m)];b&&(s[b.charCodeAt(0)]=!0)}}}updateFootprints(r,s){}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);return!v3(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(r,s,c,h){const p=this.layers[0],m=p.layout,x=this.projection.name==="globe",b=m.get("text-font"),S=m.get("text-field"),I=m.get("icon-image"),P=(S.value.kind!=="constant"||S.value.value instanceof Vo&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),D=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,F=m.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const U=s.iconDependencies,V=s.glyphDependencies,W=s.availableImages,ee=new Mr(this.zoom);for(const{feature:ce,id:ue,index:he,sourceLayerIndex:Se}of r){const be=p._featureFilter.needGeometry,ke=$u(ce,be);if(!p._featureFilter.filter(ee,ke,c))continue;if(be||(ke.geometry=Xl(ce,c,h)),x&&ce.type!==1&&c.z<=5){const Ze=ke.geometry,dt=.98078528056,At=(ct,bt)=>{const st=ov(ct.x,ct.y,c,1),wt=ov(bt.x,bt.y,c,1);return a._.dot(st,wt)<dt};for(let ct=0;ct<Ze.length;ct++)Ze[ct]=SZ(Ze[ct],At)}let Le,je;if(P){const Ze=p.getValueAndResolveTokens("text-field",ke,c,W),dt=Vo.factory(Ze);UQ(dt)&&(this.hasRTLText=!0),(!this.hasRTLText||Zr()==="unavailable"||this.hasRTLText&&Pn.isParsed())&&(Le=fQ(dt,p,ke))}if(D){const Ze=p.getValueAndResolveTokens("icon-image",ke,c,W);je=Ze instanceof gs?Ze:gs.fromString(Ze)}if(!Le&&!je)continue;const ot=this.sortFeaturesByKey?F.evaluate(ke,{},c):void 0;if(this.features.push({id:ue,text:Le,icon:je,index:he,sourceLayerIndex:Se,geometry:ke.geometry,properties:ce.properties,type:zQ[ce.type],sortKey:ot}),je&&(U[je.namePrimary]=!0,je.nameSecondary&&(U[je.nameSecondary]=!0)),Le){const Ze=b.evaluate(ke,{},c).join(","),dt=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Oa.vertical)>=0;for(const At of Le.sections)if(At.image)U[At.image.namePrimary]=!0;else{const ct=Ge(Le.toString()),bt=At.fontStack||Ze,st=V[bt]=V[bt]||{};this.calculateGlyphDependencies(At.text,st,dt,this.allowVerticalPlacement,ct)}}}m.get("symbol-placement")==="line"&&(this.features=function(ce){const ue={},he={},Se=[];let be=0;function ke(Ze){Se.push(ce[Ze]),be++}function Le(Ze,dt,At){const ct=he[Ze];return delete he[Ze],he[dt]=ct,Se[ct].geometry[0].pop(),Se[ct].geometry[0]=Se[ct].geometry[0].concat(At[0]),ct}function je(Ze,dt,At){const ct=ue[dt];return delete ue[dt],ue[Ze]=ct,Se[ct].geometry[0].shift(),Se[ct].geometry[0]=At[0].concat(Se[ct].geometry[0]),ct}function ot(Ze,dt,At){const ct=At?dt[0][dt[0].length-1]:dt[0][0];return`${Ze}:${ct.x}:${ct.y}`}for(let Ze=0;Ze<ce.length;Ze++){const dt=ce[Ze],At=dt.geometry,ct=dt.text?dt.text.toString():null;if(!ct){ke(Ze);continue}const bt=ot(ct,At),st=ot(ct,At,!0);if(bt in he&&st in ue&&he[bt]!==ue[st]){const wt=je(bt,st,At),Pt=Le(bt,st,Se[wt].geometry);delete ue[bt],delete he[st],he[ot(ct,Se[Pt].geometry,!0)]=Pt,Se[wt].geometry=null}else bt in he?Le(bt,st,At):st in ue?je(bt,st,At):(ke(Ze),ue[bt]=be-1,he[st]=be-1)}return Se.filter(Ze=>Ze.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,ue)=>ce.sortKey-ue.sortKey)}update(r,s,c,h,p){const m=Object.keys(r).length!==0;if(m&&!this.stateDependentLayers.length)return;const x=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(r,s,x,c,h,p),this.icon.programConfigurations.updatePaintArrays(r,s,x,c,h,p)}updateOcclusionOpacities(r,s,c){if(!s.useOcclusionQueries)return!1;const h=this;if(h.projection.name==="globe")return!1;let p=!1;h.hasTextData()&&(p=p||h.text.occlusionQueryOpacityVertexArray.length!==0),h.hasIconData()&&(p=p||h.icon.occlusionQueryOpacityVertexArray.length!==0);const m=h.layers[0].paint,x=m.get("icon-occlusion-opacity").constantOr(0),b=m.get("text-occlusion-opacity").constantOr(0);if(!h.layers[0].hasInitialOcclusionOpacityProperties||x===1&&b===1)return!1;let S=!p;for(let F=0;F<h.symbolInstances.length;F++){const U=h.symbolInstances.get(F),V=U.occlusionOpacity;U.occlusionOpacity+=(U.occlusionState>.5?1:-1)*s.fadeSpeed*c*.001,U.occlusionOpacity=Kr(U.occlusionOpacity,0,1),S=S||U.occlusionOpacity!==V}if(!S)return!1;let I=0,P=0;const D=(F,U,V,W)=>{let ee=0,ce=0;V?(ee=P,P+=W,ce=P):(ee=I,I+=W,ce=I),ce>U.occlusionQueryOpacityVertexArray.length&&U.occlusionQueryOpacityVertexArray.resize(ce);const ue=F.occlusionOpacity;for(let he=0;he<W;he++)U.occlusionQueryOpacityVertexArray.emplace(he+ee,ue)};for(let F=0;F<h.symbolInstances.length;F++){const U=h.symbolInstances.get(F),{numHorizontalGlyphVertices:V,numVerticalGlyphVertices:W,numIconVertices:ee}=U,ce=ee>0;if((V>0||W>0)&&(D(U,h.text,!1,V),D(U,h.text,!1,W)),ce){const{placedIconSymbolIndex:ue,verticalPlacedIconSymbolIndex:he}=U;ue>=0&&D(U,h.icon,!0,ee),he>=0&&D(U,h.icon,!0,U.numVerticalIconVertices)}}return h.hasTextData()&&h.text.occlusionQueryOpacityVertexBuffer&&(h.text.occlusionQueryOpacityVertexBuffer.length<h.text.occlusionQueryOpacityVertexArray.length?h.text.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(h.text.occlusionQueryOpacityVertexArray,b3.members,!0):h.text.occlusionQueryOpacityVertexBuffer.updateData(h.text.occlusionQueryOpacityVertexArray)),h.hasIconData()&&h.icon.occlusionQueryOpacityVertexBuffer&&(h.icon.occlusionQueryOpacityVertexBuffer.length<h.icon.occlusionQueryOpacityVertexArray.length?h.icon.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(h.icon.occlusionQueryOpacityVertexArray,b3.members,!0):h.icon.occlusionQueryOpacityVertexBuffer.updateData(h.icon.occlusionQueryOpacityVertexArray)),!0}updateZOffset(){const r=(p,m,x)=>{c+=m,c>p.length&&p.resize(c);for(let b=-m;b<0;b++)p.emplace(b+c,x)},s=(p,m,x)=>{h+=m,h>p.length&&p.resize(h);for(let b=-m;b<0;b++)p.emplace(b+h,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,h=0;for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:b,numIconVertices:S}=m,I=m.zOffset,P=S>0;if((x>0||b>0)&&(r(this.text.zOffsetVertexArray,x,I),r(this.text.zOffsetVertexArray,b,I)),P){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:F}=m;D>=0&&s(this.icon.zOffsetVertexArray,S,I),F>=0&&s(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,I)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=nz(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();for(const r of this.queries.values())r.destroy()}addToLineVertexArray(r,s){const c=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:h,y:p}of s)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,s,c,h,p,m,x,b,S,I,P,D,F,U,V,W){const ee=r.indexArray,ce=r.layoutVertexArray,ue=r.globeExtVertexArray,he=r.segments.prepareSegment(4*s.length,ce,ee,this.canOverlap?m.sortKey:void 0),Se=this.glyphOffsetArray.length,be=he.vertexLength,ke=this.allowVerticalPlacement&&x===Oa.vertical?Math.PI/2:0,Le=m.text&&m.text.sections;for(let ot=0;ot<s.length;ot++){const{tl:Ze,tr:dt,bl:At,br:ct,texPrimary:bt,texSecondary:st,pixelOffsetTL:wt,pixelOffsetBR:Pt,minFontScaleX:Tt,minFontScaleY:Ht,glyphOffset:It,isSDF:Dt,sectionIndex:fr}=s[ot],lr=he.vertexLength,sr=It[1];if(zw(ce,S.x,S.y,Ze.x,sr+Ze.y,bt.x,bt.y,c,Dt,wt.x,wt.y,Tt,Ht),zw(ce,S.x,S.y,dt.x,sr+dt.y,bt.x+bt.w,bt.y,c,Dt,Pt.x,wt.y,Tt,Ht),zw(ce,S.x,S.y,At.x,sr+At.y,bt.x,bt.y+bt.h,c,Dt,wt.x,Pt.y,Tt,Ht),zw(ce,S.x,S.y,ct.x,sr+ct.y,bt.x+bt.w,bt.y+bt.h,c,Dt,Pt.x,Pt.y,Tt,Ht),b){const{x:Rt,y:mr,z:jr}=b.anchor,[Sr,Wr,Vr]=b.up;Uw(ue,Rt,mr,jr,Sr,Wr,Vr),Uw(ue,Rt,mr,jr,Sr,Wr,Vr),Uw(ue,Rt,mr,jr,Sr,Wr,Vr),Uw(ue,Rt,mr,jr,Sr,Wr,Vr),$w(r.dynamicLayoutVertexArray,Rt,mr,jr,ke)}else $w(r.dynamicLayoutVertexArray,S.x,S.y,S.z,ke);if(W){const Rt=st||bt;Nw(r.iconTransitioningVertexArray,Rt.x,Rt.y),Nw(r.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y),Nw(r.iconTransitioningVertexArray,Rt.x,Rt.y+Rt.h),Nw(r.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y+Rt.h)}ee.emplaceBack(lr,lr+1,lr+2),ee.emplaceBack(lr+1,lr+2,lr+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(It[0]),ot!==s.length-1&&fr===s[ot+1].sectionIndex||r.programConfigurations.populatePaintArrays(ce.length,m,m.index,{},F,U,V,Le&&Le[fr])}const je=b?b.anchor:S;r.placedSymbolArray.emplaceBack(je.x,je.y,je.z,S.x,S.y,Se,this.glyphOffsetArray.length-Se,be,I,P,S.segment,c?c[0]:0,c?c[1]:0,h[0],h[1],x,0,!1,0,D,0)}_commitLayoutVertex(r,s,c,h,p,m,x){r.emplaceBack(s,c,h,p,m,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(r,s,c,h,p,m,x){const b=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),S=b.vertexLength,I=x.tileAnchorX,P=x.tileAnchorY;for(let F=0;F<4;F++)c.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,s,r.padding,x.zOffset),this._commitLayoutVertex(c.layoutVertexArray,h,p,m,I,P,new Ut(r.x1,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,p,m,I,P,new Ut(r.x2,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,p,m,I,P,new Ut(r.x2,r.y2)),this._commitLayoutVertex(c.layoutVertexArray,h,p,m,I,P,new Ut(r.x1,r.y2)),b.vertexLength+=4;const D=c.indexArray;D.emplaceBack(S,S+1),D.emplaceBack(S+1,S+2),D.emplaceBack(S+2,S+3),D.emplaceBack(S+3,S),b.primitiveLength+=4}_addTextDebugCollisionBoxes(r,s,c,h,p,m){for(let x=h;x<p;x++){const b=c.get(x),S=this.getSymbolInstanceTextSize(r,m,s,x);this._addCollisionDebugVertices(b,S,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(r,s,c,h,p,m){for(let x=h;x<p;x++){const b=c.get(x),S=this.getSymbolInstanceIconSize(r,s,m.placedIconSymbolIndex);this._addCollisionDebugVertices(b,S,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}generateCollisionDebugBuffers(r,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new F3(rw,dF.members,nd),this.iconCollisionBox=new F3(rw,dF.members,nd);const c=A0(this.iconSizeData,r),h=A0(this.textSizeData,r);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,r,s,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(h,r,s,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,r,s,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,r,s,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(r,s,c,h){const p=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:h),m=Pw(this.textSizeData,r,p)/Ho;return this.tilePixelRatio*m}getSymbolInstanceIconSize(r,s,c){const h=this.icon.placedSymbolArray.get(c),p=Pw(this.iconSizeData,r,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(r,s,c,h){r.emplaceBack(s,-c,-c,h),r.emplaceBack(s,c,-c,h),r.emplaceBack(s,c,c,h),r.emplaceBack(s,-c,c,h)}_updateTextDebugCollisionBoxes(r,s,c,h,p,m){for(let x=h;x<p;x++){const b=c.get(x),S=this.getSymbolInstanceTextSize(r,m,s,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,b.padding,m.zOffset)}}_updateIconDebugCollisionBoxes(r,s,c,h,p,m){for(let x=h;x<p;x++){const b=c.get(x),S=this.getSymbolInstanceIconSize(r,s,m.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,b.padding,m.zOffset)}}updateCollisionDebugBuffers(r,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=A0(this.iconSizeData,r),h=A0(this.textSizeData,r);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,r,s,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(h,r,s,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,r,s,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,r,s,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,s,c,h,p,m,x,b,S){const I={};if(s<c){const{x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he,featureIndex:Se}=r.get(s);I.textBox={x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he},I.textFeatureIndex=Se}if(h<p){const{x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he,featureIndex:Se}=r.get(h);I.verticalTextBox={x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he},I.verticalTextFeatureIndex=Se}if(m<x){const{x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he,featureIndex:Se}=r.get(m);I.iconBox={x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he},I.iconFeatureIndex=Se}if(b<S){const{x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he,featureIndex:Se}=r.get(b);I.verticalIconBox={x1:P,y1:D,x2:F,y2:U,padding:V,projectedAnchorX:W,projectedAnchorY:ee,projectedAnchorZ:ce,tileAnchorX:ue,tileAnchorY:he},I.verticalIconFeatureIndex=Se}return I}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,s){const c=r.placedSymbolArray.get(s),h=c.vertexStartIndex+4*c.numGlyphs;for(let p=c.vertexStartIndex;p<h;p+=4)r.indexArray.emplaceBack(p,p+1,p+2),r.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),c=Math.cos(r),h=[],p=[],m=[];for(let x=0;x<this.symbolInstances.length;++x){m.push(x);const b=this.symbolInstances.get(x);h.push(0|Math.round(s*b.tileAnchorX+c*b.tileAnchorY)),p.push(b.featureIndex)}return m.sort((x,b)=>h[x]-h[b]||p[b]-p[x]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((r,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(r).zOffset)}addToSortKeyRanges(r,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:b,verticalPlacedIconSymbolIndex:S}=c;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),m>=0&&m!==p&&m!==h&&this.addIndicesForPlacedSymbol(this.text,m),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}pe(D0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),D0.addDynamicAttributes=$w;class pl{constructor(r,s,c,h){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(s,h)}update(r,s,c){const{width:h,height:p}=r,{context:m}=this,{gl:x}=m;if(x.bindTexture(x.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===h&&this.size[1]===p){const{x:b,y:S}=c||{x:0,y:0};if(r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap)x.texSubImage2D(x.TEXTURE_2D,0,b,S,x.RGBA,x.UNSIGNED_BYTE,r);else{let I=this.format,P=x.UNSIGNED_BYTE;this.format===x.R32F&&(I=x.RED,P=x.FLOAT),x.texSubImage2D(x.TEXTURE_2D,0,b,S,h,p,I,P,r.data)}}else if(this.size=[h,p],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap){let b=this.format;this.format===x.R8&&(b=x.RED),x.texImage2D(x.TEXTURE_2D,0,this.format,b,x.UNSIGNED_BYTE,r)}else{let b=this.format,S=this.format,I=x.UNSIGNED_BYTE;this.format===x.DEPTH_COMPONENT&&(b=x.DEPTH_COMPONENT16,I=x.UNSIGNED_SHORT),this.format===x.R8&&(S=x.RED),this.format===x.R32F&&(I=x.FLOAT,S=x.RED),x.texImage2D(x.TEXTURE_2D,0,b,h,p,0,S,I,r.data)}this.useMipmap=!!(s&&s.useMipmap),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,s,c=!1){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!c?r===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(r,s,c,h){const{context:p}=this,{gl:m}=p;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),this.magFilter=s),r!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?r===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),this.wrapS=c),h!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,h),this.wrapT=h)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class jw{constructor(r,s){this.context=r,this.texture=s}bind(r,s){const{context:c}=this,{gl:h}=c;h.bindTexture(h.TEXTURE_2D,this.texture),r!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,r),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,r),this.minFilter=r),s!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,s),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,s),this.wrapS=s)}}const ml=32,Vc=33,pd=new Uint16Array(8184);for(let i=0;i<2046;i++){let r=i+2,s=0,c=0,h=0,p=0,m=0,x=0;for(1&r?h=p=m=ml:s=c=x=ml;(r>>=1)>1;){const S=s+h>>1,I=c+p>>1;1&r?(h=s,p=c,s=m,c=x):(s=h,c=p,h=m,p=x),m=S,x=I}const b=4*i;pd[b+0]=s,pd[b+1]=c,pd[b+2]=h,pd[b+3]=p}const Hc=new Uint16Array(2178),md=new Uint8Array(1089),Vw=new Uint16Array(1089);function iz(i){return i===0?-.03125:i===32?.03125:0}var Hw=Tn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),$Q=Tn([{name:"a_index",type:"Int16",components:1}]);const oz={type:2,extent:Bt,loadGeometry:()=>[[new Ut(0,0),new Ut(Bt+1,0),new Ut(Bt+1,Bt+1),new Ut(0,Bt+1),new Ut(0,0)]]};class Gw{constructor(r,s,c,h,p){this.tileID=r,this.uid=Pm(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,h&&h.style&&(this._lastUpdatedBrightness=h.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(r){const s=r+this.timeAdded;s<Io.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=dp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,s,c){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(h,p){const m={};if(!p)return m;for(const x of h){const b=x.layerIds.map(S=>p.getLayer(S)).filter(Boolean);if(b.length!==0){x.layers=b,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(S=>b.filter(I=>I.id===S)[0]));for(const S of b)m[S.fqid]=x}}return m}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof D0){if(this.hasSymbolBuckets=!0,!c)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof D0&&p.hasRTLText){this.hasRTLText=!0,Pn.isLoading()||Pn.isLoaded()||Zr()!=="deferred"||ln();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h],m=s.style.getOwnLayer(h);if(!m)continue;const x=m.queryRadius(p);this.queryPadding=Math.max(this.queryPadding,x)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new NI}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const h in this.buckets){const p=this.buckets[h];p.uploadPending()&&p.upload(r)}const s=r.gl,c=this.imageAtlas;if(c&&!c.uploaded){const h=!!Object.keys(c.patternPositions).length;this.imageAtlasTexture=new pl(r,c.image,s.RGBA,{useMipmap:h}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new pl(r,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new pl(r,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(r,s,c){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,c),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const h=s.style.getBrightness();(this._lastUpdatedBrightness||h)&&(this._lastUpdatedBrightness&&h&&Math.abs(this._lastUpdatedBrightness-h)<.001||(this._lastUpdatedBrightness=h,this.updateBuckets(void 0,s)))}queryRenderedFeatures(r,s,c,h,p,m,x,b){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:x,transform:m,params:p,tileTransform:this.tileTransform},r,s,c):{}}querySourceFeatures(r,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),p=s?s.sourceLayer:"",m=h._geojsonTileLayer||h[p];if(!m)return;const x=co(s&&s.filter),{z:b,x:S,y:I}=this.tileID.canonical,P={z:b,x:S,y:I};for(let D=0;D<m.length;D++){const F=m.feature(D);if(x.needGeometry){const W=$u(F,!0);if(!x.filter(new Mr(this.tileID.overscaledZ),W,this.tileID.canonical))continue}else if(!x.filter(new Mr(this.tileID.overscaledZ),F))continue;const U=c.getId(F,p),V=new TF(F,b,S,I,U);V.tile=P,r.push(V)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const r in this.buckets)if(this.buckets[r].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const c=iy(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(s)if(this.expirationTime<s)h=!0;else{const p=this.expirationTime-s;p?this.expirationTime=c+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(r).length!==0&&s&&this.updateBuckets(r,s)}updateBuckets(r,s){if(!this.latestFeatureIndex)return;const c=this.latestFeatureIndex.loadVTLayers(),h=s.style.listImages(),p=s.style.getBrightness();for(const m in this.buckets){if(!s.style.hasLayer(m))continue;const x=this.buckets[m],b=x.layers[0].sourceLayer||"_geojsonTileLayer",S=c[b];let I={};if(r&&(I=r[b],!S||!I||Object.keys(I).length===0))continue;if(x.update(I,S,h,this.imageAtlas&&this.imageAtlas.patternPositions||{},p),x instanceof Tw||x instanceof yw){const D=s.style.getOwnSourceCache(x.layers[0].source);s._terrain&&s._terrain.enabled&&D&&x.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(D.id,this.tileID)}const P=s&&s.style&&s.style.getOwnLayer(m);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Io.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=Io.now()+r}setTexture(r,s){const c=s.context,h=c.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof pl?this.texture.update(r,{useMipmap:!0}):(this.texture=new pl(c,r,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(r,s){const c={};for(const h of s)c[h]=!0;this.dependencies[r]=c}hasDependency(r,s){for(const c of r){const h=this.dependencies[c];if(h){for(const p of s)if(h[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=Xl(oz,this.tileID.canonical,this.tileTransform)[0],h=new Yl,p=new Qy;for(let m=0;m<c.length;m++){const{x,y:b}=c[m];h.emplaceBack(x,b),p.emplaceBack(m)}p.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(p),this._tileDebugBuffer=r.createVertexBuffer(h,iv.members),this._tileDebugSegments=hi.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(r,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=Xl(oz,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const m=function(x,b){const S=dp(x,b),I=Math.pow(2,x.z);for(let W=0;W<Vc;W++)for(let ee=0;ee<Vc;ee++){const ce=Ys((x.x+(ee+iz(ee))/ml)/I),ue=Ro((x.y+(W+iz(W))/ml)/I),he=b.project(ce,ue),Se=W*Vc+ee;Hc[2*Se+0]=Math.round((he.x*S.scale-S.x)*Bt),Hc[2*Se+1]=Math.round((he.y*S.scale-S.y)*Bt)}md.fill(0),Vw.fill(0);for(let W=2045;W>=0;W--){const ee=4*W,ce=pd[ee+0],ue=pd[ee+1],he=pd[ee+2],Se=pd[ee+3],be=ce+he>>1,ke=ue+Se>>1,Le=be+ke-ue,je=ke+ce-be,ot=ue*Vc+ce,Ze=Se*Vc+he,dt=ke*Vc+be,At=Math.hypot((Hc[2*ot+0]+Hc[2*Ze+0])/2-Hc[2*dt+0],(Hc[2*ot+1]+Hc[2*Ze+1])/2-Hc[2*dt+1])>=16;md[dt]=md[dt]||(At?1:0),W<1022&&(md[dt]=md[dt]||md[(ue+je>>1)*Vc+(ce+Le>>1)]||md[(Se+je>>1)*Vc+(he+Le>>1)])}const P=new Jh,D=new vo;let F=0;function U(W,ee){const ce=ee*Vc+W;return Vw[ce]===0&&(P.emplaceBack(Hc[2*ce+0],Hc[2*ce+1],W*Bt/ml,ee*Bt/ml),Vw[ce]=++F),Vw[ce]-1}function V(W,ee,ce,ue,he,Se){const be=W+ce>>1,ke=ee+ue>>1;if(Math.abs(W-he)+Math.abs(ee-Se)>1&&md[ke*Vc+be])V(he,Se,W,ee,be,ke),V(ce,ue,he,Se,be,ke);else{const Le=U(W,ee),je=U(ce,ue),ot=U(he,Se);D.emplaceBack(Le,je,ot)}}return V(0,0,ml,ml,ml,0),V(ml,ml,0,0,0,ml),{vertices:P,indices:D}}(this.tileID.canonical,s);h=m.vertices,p=m.indices}else{h=new Jh,p=new vo;for(const{x,y:b}of c)h.emplaceBack(x,b,0,0);const m=lv(h.int16,void 0,4);for(let x=0;x<m.length;x+=3)p.emplaceBack(m[x],m[x+1],m[x+2])}this._tileBoundsBuffer=r.createVertexBuffer(h,Hw.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(p),this._tileBoundsSegments=hi.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(r,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const h=this.tileID.canonical,p=sv(uB(h,s)),m=Vu(s.zoom);let x;m>0&&(x=a.ad.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,h,s,p,x,m),this._makeGlobeTileDebugTextBuffer(r,h,s,p,x,m)}_globePoint(r,s,c,h,p,m,x){let b=ov(r,s,c);if(m){const S=1<<c.z,I=Nc(h.center.lng),P=Uc(h.center.lat),D=(c.x+.5)/S-I;let F=0;D>.5?F=-1:D<-.5&&(F=1);let U=(r/Bt+c.x)/S+F,V=(s/Bt+c.y)/S;U=(U-I)*h._pixelsPerMercatorPixel+I,V=(V-P)*h._pixelsPerMercatorPixel+P;const W=[U*h.worldSize,V*h.worldSize,0];a._.transformMat4(W,W,m),b=ju(b,W,x)}return a._.transformMat4(b,b,p)}_makeGlobeTileDebugBorderBuffer(r,s,c,h,p,m){const x=new Yl,b=new Qy,S=new Jb,I=(D,F,U,V,W)=>{const ee=(U-D)/(W-1),ce=(V-F)/(W-1),ue=x.length;for(let he=0;he<W;he++){const Se=D+he*ee,be=F+he*ce;x.emplaceBack(Se,be);const ke=this._globePoint(Se,be,s,c,h,p,m);S.emplaceBack(ke[0],ke[1],ke[2]),b.emplaceBack(ue+he)}},P=Bt;I(0,0,P,0,16),I(P,0,P,P,16),I(P,P,0,P,16),I(0,P,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(b),this._tileDebugBuffer=r.createVertexBuffer(x,iv.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(S,lB.members),this._tileDebugSegments=hi.simpleSegment(0,0,x.length,b.length)}_makeGlobeTileDebugTextBuffer(r,s,c,h,p,m){const x=Bt/4,b=new Yl,S=new vo,I=new Jb,P=25;S.reserve(32),b.reserve(P),I.reserve(P);const D=(F,U)=>P*F+U;for(let F=0;F<P;F++){const U=F*x;for(let V=0;V<P;V++){const W=V*x;b.emplaceBack(W,U);const ee=this._globePoint(W,U,s,c,h,p,m);I.emplaceBack(ee[0],ee[1],ee[2])}}for(let F=0;F<4;F++)for(let U=0;U<4;U++){const V=D(F,U),W=D(F,U+1),ee=D(F+1,U),ce=D(F+1,U+1);S.emplaceBack(V,W,ee),S.emplaceBack(ee,W,ce)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(S),this._tileDebugTextBuffer=r.createVertexBuffer(b,iv.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(I,lB.members),this._tileDebugTextSegments=hi.simpleSegment(0,0,P,32)}destroy(r=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof pl&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const Nr={read:function(i,r){return i.readFields(Nr._readField,{header_length:0,x:0,y:0,z:0,layers:[]},r)},_readField:function(i,r,s){i===1?r.header_length=s.readFixed32():i===2?r.x=s.readVarint():i===3?r.y=s.readVarint():i===4?r.z=s.readVarint():i===5&&r.layers.push(Nr.Layer.read(s,s.readVarint()+s.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Nr.Filter.read=function(i,r){return i.readFields(Nr.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},r)},Nr.Filter._readField=function(i,r,s){i===1?(r.delta_filter=Nr.Filter.Delta.read(s,s.readVarint()+s.pos),r.filter="delta_filter"):i===2?(r.zigzag_filter=Nr.Filter.Zigzag.read(s,s.readVarint()+s.pos),r.filter="zigzag_filter"):i===3?(r.bitshuffle_filter=Nr.Filter.BitShuffle.read(s,s.readVarint()+s.pos),r.filter="bitshuffle_filter"):i===4&&(r.byteshuffle_filter=Nr.Filter.ByteShuffle.read(s,s.readVarint()+s.pos),r.filter="byteshuffle_filter")},Nr.Filter.Delta={},Nr.Filter.Delta.read=function(i,r){return i.readFields(Nr.Filter.Delta._readField,{block_size:0},r)},Nr.Filter.Delta._readField=function(i,r,s){i===1&&(r.block_size=s.readVarint())},Nr.Filter.Zigzag={},Nr.Filter.Zigzag.read=function(i,r){return i.readFields(Nr.Filter.Zigzag._readField,{},r)},Nr.Filter.Zigzag._readField=function(i,r,s){},Nr.Filter.BitShuffle={},Nr.Filter.BitShuffle.read=function(i,r){return i.readFields(Nr.Filter.BitShuffle._readField,{},r)},Nr.Filter.BitShuffle._readField=function(i,r,s){},Nr.Filter.ByteShuffle={},Nr.Filter.ByteShuffle.read=function(i,r){return i.readFields(Nr.Filter.ByteShuffle._readField,{},r)},Nr.Filter.ByteShuffle._readField=function(i,r,s){},Nr.Codec={},Nr.Codec.read=function(i,r){return i.readFields(Nr.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},r)},Nr.Codec._readField=function(i,r,s){i===1?(r.gzip_data=Nr.Codec.GzipData.read(s,s.readVarint()+s.pos),r.codec="gzip_data"):i===2?(r.jpeg_image=Nr.Codec.JpegImage.read(s,s.readVarint()+s.pos),r.codec="jpeg_image"):i===3?(r.webp_image=Nr.Codec.WebpImage.read(s,s.readVarint()+s.pos),r.codec="webp_image"):i===4&&(r.png_image=Nr.Codec.PngImage.read(s,s.readVarint()+s.pos),r.codec="png_image")},Nr.Codec.GzipData={},Nr.Codec.GzipData.read=function(i,r){return i.readFields(Nr.Codec.GzipData._readField,{},r)},Nr.Codec.GzipData._readField=function(i,r,s){},Nr.Codec.JpegImage={},Nr.Codec.JpegImage.read=function(i,r){return i.readFields(Nr.Codec.JpegImage._readField,{},r)},Nr.Codec.JpegImage._readField=function(i,r,s){},Nr.Codec.WebpImage={},Nr.Codec.WebpImage.read=function(i,r){return i.readFields(Nr.Codec.WebpImage._readField,{},r)},Nr.Codec.WebpImage._readField=function(i,r,s){},Nr.Codec.PngImage={},Nr.Codec.PngImage.read=function(i,r){return i.readFields(Nr.Codec.PngImage._readField,{},r)},Nr.Codec.PngImage._readField=function(i,r,s){},Nr.DataIndexEntry={},Nr.DataIndexEntry.read=function(i,r){return i.readFields(Nr.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},r)},Nr.DataIndexEntry._readField=function(i,r,s){i===1?r.first_byte=s.readFixed64():i===2?r.last_byte=s.readFixed64():i===3?r.filters.push(Nr.Filter.read(s,s.readVarint()+s.pos)):i===4?r.codec=Nr.Codec.read(s,s.readVarint()+s.pos):i===5?r.offset=s.readFloat():i===6?r.scale=s.readFloat():i===7&&r.bands.push(s.readString())},Nr.Layer={},Nr.Layer.read=function(i,r){return i.readFields(Nr.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},r)},Nr.Layer._readField=function(i,r,s){i===1?r.version=s.readVarint():i===2?r.name=s.readString():i===3?r.units=s.readString():i===4?r.tilesize=s.readVarint():i===5?r.buffer=s.readVarint():i===6?r.pixel_format=s.readVarint():i===7&&r.data_index.push(Nr.DataIndexEntry.read(s,s.readVarint()+s.pos))};const tc={read:function(i,r){return i.readFields(tc._readField,{uint32_values:null,values:null,fixed32_values:null},r)},_readField:function(i,r,s){i===2?(r.uint32_values=tc.Uint32Values.read(s,s.readVarint()+s.pos),r.values="uint32_values"):i===3&&(r.fixed32_values=tc.Fixed32Values.read(s,s.readVarint()+s.pos),r.values="fixed32_values")},Uint32Values:{}};tc.Uint32Values.read=function(i,r){return i.readFields(tc.Uint32Values._readField,{values:[]},r)},tc.Uint32Values._readField=function(i,r,s){i===1&&(r.readValuesInto=function(c){if(c.type!==2)throw new Error(`Unsupported pbf type "${c.type}"`);const h=function(m){return m.type===2?m.readVarint()+m.pos:m.pos+1}(c),p=c.pos;return c.pos=h,function(m){c.pos=p;let x=0;for(;c.pos<h;){const b=c.readVarint();m[x++]=b}return m}}(s))},tc.Fixed32Values={},tc.Fixed32Values.read=function(i,r){return i.readFields(tc.Fixed32Values._readField,{values:[]},r)},tc.Fixed32Values._readField=function(i,r,s){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2024 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.6
 */class jQ{constructor(r=0,s=0,c=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=r,this.resetTtl=c,this.size=0,this.ttl=s}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(r){if(this.has(r)){const s=this.items[r];delete this.items[r],this.size--,s.prev!==null&&(s.prev.next=s.next),s.next!==null&&(s.next.prev=s.prev),this.first===s&&(this.first=s.next),this.last===s&&(this.last=s.prev)}return this}entries(r=this.keys()){return r.map(s=>[s,this.get(s)])}evict(r=!1){if(r||this.size>0){const s=this.first;delete this.items[s.key],--this.size==0?(this.first=null,this.last=null):(this.first=s.next,this.first.prev=null)}return this}expiresAt(r){let s;return this.has(r)&&(s=this.items[r].expiry),s}get(r){let s;if(this.has(r)){const c=this.items[r];this.ttl>0&&c.expiry<=Date.now()?this.delete(r):(s=c.value,this.set(r,s,!0))}return s}has(r){return r in this.items}keys(){const r=[];let s=this.first;for(;s!==null;)r.push(s.key),s=s.next;return r}set(r,s,c=!1,h=this.resetTtl){let p;if(c||this.has(r)){if(p=this.items[r],p.value=s,c===!1&&h&&(p.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==p){const m=this.last,x=p.next,b=p.prev;this.first===p&&(this.first=p.next),p.next=null,p.prev=this.last,m.next=p,b!==null&&(b.next=x),x!==null&&(x.prev=b)}}else this.max>0&&this.size===this.max&&this.evict(!0),p=this.items[r]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:r,prev:this.last,next:null,value:s},++this.size==1?this.first=p:this.last.next=p;return this.last=p,this}values(r=this.keys()){return r.map(s=>this.get(s))}}function VQ(i,r){if(r.length!==4)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let s=r[3];for(let c=2;c>=1;c--){const h=c===1?1:0,p=c===2?1:0;for(let m=0;m<r[0];m++){const x=r[1]*m;for(let b=h;b<r[1];b++){const S=r[2]*(b+x);for(let I=p;I<r[2];I++){const P=r[3]*(I+S);for(let D=0;D<r[3];D++){const F=P+D;i[F]+=i[F-s]}}}}s*=r[c]}return i}function HQ(i){for(let r=0,s=i.length;r<s;r++)i[r]=i[r]>>>1^-(1&i[r]);return i}function GQ(i,r){switch(r){case"uint32":return i;case"uint16":for(let s=0;s<i.length;s+=2){const c=i[s],h=i[s+1];i[s]=(240&c)>>4|(61440&c)>>8|(240&h)<<4|61440&h,i[s+1]=15&c|(3840&c)>>4|(15&h)<<8|(3840&h)<<4}return i;case"uint8":for(let s=0;s<i.length;s+=4){const c=i[s],h=i[s+1],p=i[s+2],m=i[s+3];i[s+0]=(192&c)>>6|(192&h)>>4|(192&p)>>2|192&m,i[s+1]=(48&c)>>4|(48&h)>>2|48&p|(48&m)<<2,i[s+2]=(12&c)>>2|12&h|(12&p)<<2|(12&m)<<4,i[s+3]=3&c|(3&h)<<2|(3&p)<<4|(3&m)<<6}return i;default:throw new Error(`Invalid pixel format, "${r}"`)}}class gd extends Error{constructor(r){super(r),this.name="MRTError"}}var La=Uint8Array,Ev=Uint16Array,WQ=Int32Array,sz=new La([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),az=new La([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),qQ=new La([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lz=function(i,r){for(var s=new Ev(31),c=0;c<31;++c)s[c]=r+=1<<i[c-1];var h=new WQ(s[30]);for(c=1;c<30;++c)for(var p=s[c];p<s[c+1];++p)h[p]=p-s[c]<<5|c;return{b:s,r:h}},cz=lz(sz,2),uz=cz.b,KQ=cz.r;uz[28]=258,KQ[258]=28;for(var YQ=lz(az,0).b,hz=new Ev(32768),Fi=0;Fi<32768;++Fi){var O0=(43690&Fi)>>1|(21845&Fi)<<1;hz[Fi]=((65280&(O0=(61680&(O0=(52428&O0)>>2|(13107&O0)<<2))>>4|(3855&O0)<<4))>>8|(255&O0)<<8)>>1}var Sv=function(i,r,s){for(var c=i.length,h=0,p=new Ev(r);h<c;++h)i[h]&&++p[i[h]-1];var m,x=new Ev(r);for(h=1;h<r;++h)x[h]=x[h-1]+p[h-1]<<1;{m=new Ev(1<<r);var b=15-r;for(h=0;h<c;++h)if(i[h])for(var S=h<<4|i[h],I=r-i[h],P=x[i[h]-1]++<<I,D=P|(1<<I)-1;P<=D;++P)m[hz[P]>>b]=S}return m},Tv=new La(288);for(Fi=0;Fi<144;++Fi)Tv[Fi]=8;for(Fi=144;Fi<256;++Fi)Tv[Fi]=9;for(Fi=256;Fi<280;++Fi)Tv[Fi]=7;for(Fi=280;Fi<288;++Fi)Tv[Fi]=8;var dz=new La(32);for(Fi=0;Fi<32;++Fi)dz[Fi]=5;var ZQ=Sv(Tv,9),XQ=Sv(dz,5),z3=function(i){for(var r=i[0],s=1;s<i.length;++s)i[s]>r&&(r=i[s]);return r},rc=function(i,r,s){var c=r/8|0;return(i[c]|i[c+1]<<8)>>(7&r)&s},N3=function(i,r){var s=r/8|0;return(i[s]|i[s+1]<<8|i[s+2]<<16)>>(7&r)},QQ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],nc=function(i,r,s){var c=new Error(r||QQ[i]);if(c.code=i,Error.captureStackTrace&&Error.captureStackTrace(c,nc),!s)throw c;return c},JQ=new La(0),eJ=typeof TextDecoder<"u"&&new TextDecoder;try{eJ.decode(JQ,{stream:!0})}catch{}const tJ={gzip_data:"gzip"},rJ={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},nJ={uint32:1,uint16:2,uint8:4},iJ={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class U3{constructor(r=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){return this.layers[r]}getHeaderLength(r){const s=new Uint8Array(r),c=new DataView(r);if(s[0]!==13)throw new gd("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(r){const s=new Uint8Array(r),c=this.getHeaderLength(r);if(s.length<c)throw new gd(`Expected header with length >= ${c} but got buffer of length ${s.length}`);const h=new T0(s.subarray(0,c)),p=Nr.read(h);if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new gd(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const m of p.layers)this.layers[m.name]=new oJ(m,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const s=[],c=this.getLayer(r.layerName);for(let h=0;h<c.dataIndex.length;h++){const p=c.dataIndex[h],m=p.first_byte-r.firstByte,x=p.last_byte+1-r.firstByte;if(h<r.firstBlock||h>r.lastBlock||c._blocksInProgress.has(h))continue;const b={layerName:c.name,firstByte:m,lastByte:x,pixelFormat:c.pixelFormat,blockIndex:h,blockShape:[p.bands.length].concat(c.bandShape),buffer:c.buffer,codec:p.codec.codec,filters:p.filters.map(S=>S.filter)};c._blocksInProgress.add(h),s.push(b)}return new fz(s,()=>{s.forEach(h=>c._blocksInProgress.delete(h.blockIndex))},(h,p)=>{if(s.forEach(m=>c._blocksInProgress.delete(m.blockIndex)),h)throw h;p.forEach(m=>{this.getLayer(m.layerName).processDecodedData(m)})})}}class oJ{constructor({version:r,name:s,units:c,tilesize:h,pixel_format:p,buffer:m,data_index:x},b){if(this.version=r,this.version!==1)throw new gd(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=s,this.units=c,this.tileSize=h,this.buffer=m,this.pixelFormat=rJ[p],this.dataIndex=x,this.bandShape=[h+2*m,h+2*m,nJ[this.pixelFormat]],this._decodedBlocks=function(S=1e3,I=0,P=!1){if(isNaN(S)||S<0)throw new TypeError("Invalid max value");if(isNaN(I)||I<0)throw new TypeError("Invalid ttl value");if(typeof P!="boolean")throw new TypeError("Invalid resetTtl value");return new jQ(S,I,P)}(b?b.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(r){const s=r.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.set(s,r.data)}getBlockForBand(r){let s=0;switch(typeof r){case"string":for(const[c,h]of this.dataIndex.entries()){for(const[p,m]of h.bands.entries())if(m===r)return{bandIndex:s+p,blockIndex:c,blockBandIndex:p};s+=h.bands.length}break;case"number":for(const[c,h]of this.dataIndex.entries()){if(r>=s&&r<s+h.bands.length)return{bandIndex:r,blockIndex:c,blockBandIndex:r-s};s+=h.bands.length}break;default:throw new gd(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}throw new gd(`Band not found: ${JSON.stringify(r)}`)}getDataRange(r){let s=1/0,c=-1/0,h=1/0,p=-1/0;for(const m of r){const{blockIndex:x}=this.getBlockForBand(m);if(x<0)throw new gd(`Invalid band: ${JSON.stringify(m)}`);const b=this.dataIndex[x];h=Math.min(h,x),p=Math.max(p,x),s=Math.min(s,b.first_byte),c=Math.max(c,b.last_byte)}return{layerName:this.name,firstByte:s,lastByte:c,firstBlock:h,lastBlock:p}}hasBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0}hasDataForBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(r){const{blockIndex:s,blockBandIndex:c}=this.getBlockForBand(r),h=this._decodedBlocks.get(s.toString());if(!h)throw new gd(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const p=this.dataIndex[s],m=this.bandShape.reduce((S,I)=>S*I,1),x=c*m,b=h.subarray(x,x+m);return{data:b,bytes:new Uint8Array(b.buffer).subarray(b.byteOffset,b.byteOffset+b.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:p.offset,scale:p.scale}}}class fz{constructor(r,s,c){this.tasks=r,this._onCancel=s,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,s){this._finalized||(this._onComplete(r,s),this._finalized=!0)}}U3.performDecoding=function(i,r){return Promise.all(r.tasks.map(s=>{const{layerName:c,firstByte:h,lastByte:p,pixelFormat:m,blockShape:x,blockIndex:b,filters:S,codec:I}=s,P=new Uint8Array(i).subarray(h,p+1),D=new Uint32Array(x[0]*x[1]*x[2]);let F;if(I!=="gzip_data")throw new Error(`Unhandled codec: ${I}`);return F=function(U,V){if(!globalThis.DecompressionStream&&V==="gzip_data")return Promise.resolve(((ue=function(be){be[0]==31&&be[1]==139&&be[2]==8||nc(6,"invalid gzip data");var ke=be[3],Le=10;4&ke&&(Le+=2+(be[10]|be[11]<<8));for(var je=(ke>>3&1)+(ke>>4&1);je>0;je-=!be[Le++]);return Le+(2&ke)}(ce=U))+8>ce.length&&nc(6,"invalid gzip data"),function(be,ke,Le,je){var ot=be.length;if(!ot||ke.f&&!ke.l)return Le||new La(0);var Ze=!Le,dt=Ze||ke.i!=2,At=ke.i;Ze&&(Le=new La(3*ot));var ct,bt,st=function(yd){var vd=Le.length;if(yd>vd){var yp=new La(Math.max(2*vd,yd));yp.set(Le),Le=yp}},wt=ke.f||0,Pt=ke.p||0,Tt=ke.b||0,Ht=ke.l,It=ke.d,Dt=ke.m,fr=ke.n,lr=8*ot;do{if(!Ht){wt=rc(be,Pt,1);var sr=rc(be,Pt+1,3);if(Pt+=3,!sr){var Rt=be[(cn=4+((Pt+7)/8|0))-4]|be[cn-3]<<8,mr=cn+Rt;if(mr>ot){At&&nc(0);break}dt&&st(Tt+Rt),Le.set(be.subarray(cn,mr),Tt),ke.b=Tt+=Rt,ke.p=Pt=8*mr,ke.f=wt;continue}if(sr==1)Ht=ZQ,It=XQ,Dt=9,fr=5;else if(sr==2){var jr=rc(be,Pt,31)+257,Sr=rc(be,Pt+10,15)+4,Wr=jr+rc(be,Pt+5,31)+1;Pt+=14;for(var Vr=new La(Wr),Qr=new La(19),br=0;br<Sr;++br)Qr[qQ[br]]=rc(be,Pt+3*br,7);Pt+=3*Sr;var Bn=z3(Qr),On=(1<<Bn)-1,bn=Sv(Qr,Bn);for(br=0;br<Wr;){var cn,wn=bn[rc(be,Pt,On)];if(Pt+=15&wn,(cn=wn>>4)<16)Vr[br++]=cn;else{var Qn=0,$n=0;for(cn==16?($n=3+rc(be,Pt,3),Pt+=2,Qn=Vr[br-1]):cn==17?($n=3+rc(be,Pt,7),Pt+=3):cn==18&&($n=11+rc(be,Pt,127),Pt+=7);$n--;)Vr[br++]=Qn}}var pi=Vr.subarray(0,jr),fi=Vr.subarray(jr);Dt=z3(pi),fr=z3(fi),Ht=Sv(pi,Dt),It=Sv(fi,fr)}else nc(1);if(Pt>lr){At&&nc(0);break}}dt&&st(Tt+131072);for(var ts=(1<<Dt)-1,Ti=(1<<fr)-1,oi=Pt;;oi=Pt){var Vi=(Qn=Ht[N3(be,Pt)&ts])>>4;if((Pt+=15&Qn)>lr){At&&nc(0);break}if(Qn||nc(2),Vi<256)Le[Tt++]=Vi;else{if(Vi==256){oi=Pt,Ht=null;break}var ko=Vi-254;Vi>264&&(ko=rc(be,Pt,(1<<(Os=sz[br=Vi-257]))-1)+uz[br],Pt+=Os);var Do=It[N3(be,Pt)&Ti],Gn=Do>>4;if(Do||nc(3),Pt+=15&Do,fi=YQ[Gn],Gn>3){var Os=az[Gn];fi+=N3(be,Pt)&(1<<Os)-1,Pt+=Os}if(Pt>lr){At&&nc(0);break}dt&&st(Tt+131072);var Wu=Tt+ko;if(Tt<fi){var gl=0-fi,oc=Math.min(fi,Wu);for(gl+Tt<0&&nc(3);Tt<oc;++Tt)Le[Tt]=(void 0)[gl+Tt]}for(;Tt<Wu;++Tt)Le[Tt]=Le[Tt-fi]}}ke.l=Ht,ke.p=oi,ke.b=Tt,ke.f=wt,Ht&&(wt=1,ke.m=Dt,ke.d=It,ke.n=fr)}while(!wt);return Tt!=Le.length&&Ze?(ct=Le,((bt=Tt)==null||bt>ct.length)&&(bt=ct.length),new La(ct.subarray(0,bt))):Le.subarray(0,Tt)}(ce.subarray(ue,-8),{i:2},new La(((W=ce)[(ee=W.length)-4]|W[ee-3]<<8|W[ee-2]<<16|W[ee-1]<<24)>>>0))));var W,ee,ce,ue;const he=tJ[V];if(!he)throw new Error(`Unhandled codec: ${V}`);const Se=new globalThis.DecompressionStream(he);return new Response(new Blob([U]).stream().pipeThrough(Se)).arrayBuffer().then(be=>new Uint8Array(be))}(P,I).then(U=>{const V=tc.read(new T0(U));if(V.values==="uint32_values")return V.uint32_values.readValuesInto(D),new iJ[m](D.buffer);throw new Error(`Unhandled numeric data "${V.values}"`)}),F.then(U=>{for(let V=S.length-1;V>=0;V--)switch(S[V]){case"delta_filter":VQ(U,x);break;case"zigzag_filter":HQ(U);break;case"bitshuffle_filter":GQ(U,m);break;default:throw new Error(`Unhandled filter "${S[V]}"`)}return{layerName:c,blockIndex:b,data:U}}).catch(U=>{throw U})}))};class pz extends Gw{constructor(r,s,c,h,p){super(r,s,c,h,p),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,s){const c=s.context,h=c.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof pl?this.texture.update(r,{useMipmap:!1,premultiply:!1}):this.texture=new pl(c,r,h.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,s){const c=this._mrt=new U3(30),h=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=Su(h,(p,m,x,b)=>{if(p)s(p);else try{const S=c.getHeaderLength(m);if(S>r)return void(this.request=this.fetchHeader(S,s));c.parseHeader(m),this._isHeaderLoaded=!0;let I=0;for(const P of Object.values(c.layers))I=Math.max(I,P.dataIndex[P.dataIndex.length-1].last_byte);m.byteLength>=I&&(this.entireBuffer=m),s(null,this.entireBuffer||m,x,b)}catch(S){s(S)}}),this.request}fetchBand(r,s,c){const h=this._mrt;if(!this._isHeaderLoaded||!h)return void c(new Error("Tile header is not ready"));const p=this.actor;if(!p)return void c(new Error("Can't fetch tile band without an actor"));let m;const x=(P,D)=>{m.complete(P,D),P?c(P):(this.updateTextureDescriptor(r,s),c(null,this.textureDescriptor&&this.textureDescriptor.img))},b=(P,D)=>{if(P)return c(P);const F=p.send("decodeRasterArray",{buffer:D,task:m},x,void 0,!0);this._workQueue.push(()=>{F&&F.cancel(),m.cancel()})},S=h.getLayer(r);if(!S)return void c(new Error(`Unknown sourceLayer "${r}"`));if(S.hasDataForBand(s))return this.updateTextureDescriptor(r,s),void c(null,this.textureDescriptor?this.textureDescriptor.img:null);const I=S.getDataRange([s]);if(m=h.createDecodingTask(I),!m||m.tasks.length)if(this.flushQueues(),this.entireBuffer)b(null,this.entireBuffer.slice(I.firstByte,I.lastByte+1));else{const P=Object.assign({},this.requestParams,{headers:{Range:`bytes=${I.firstByte}-${I.lastByte}`}}),D=Su(P,b);this._fetchQueue.push(()=>{D.cancel(),m.cancel()})}else c(null)}updateNeeded(r,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,s){if(!this._mrt)return;const c=this._mrt.getLayer(r);if(!c||!c.hasBand(s)||!c.hasDataForBand(s))return;const{bytes:h,tileSize:p,buffer:m,offset:x,scale:b}=c.getBandView(s),S=p+2*m,I={data:h,width:S,height:S},P=this.texture;P&&P instanceof pl&&P.update(I,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:r,band:s,img:I,buffer:m,offset:x,tileSize:p,format:c.pixelFormat,mix:[b,256*b,65536*b,16777216*b]}}}class sJ{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,c){const h=r.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const p={value:s,timeout:void 0};if(c!==void 0&&(p.timeout=setTimeout(()=>{this.remove(r,p)},c)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const c=r.wrapped().key,h=s===void 0?0:this.data[c].indexOf(s),p=this.data[c][h];return this.data[c].splice(h,1),p.timeout&&clearTimeout(p.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(p.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const c in this.data)for(const h of this.data[c])r(h.value)||s.push(h);for(const c of s)this.remove(c.value.tileID,c)}}class pp extends Au{constructor(r,s,c){super(),this.id=r,this._onlySymbols=c,s.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new sJ(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new uQ,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="errored"&&(s.state!=="loaded"||!s.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,s){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(r),c.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return oa(this._tiles).map(r=>r.tileID).sort(mz).map(r=>r.key)}getRenderableIds(r,s){const c=[];for(const h in this._tiles)this._isIdRenderable(+h,r,s)&&c.push(this._tiles[h]);return r?c.sort((h,p)=>{const m=h.tileID,x=p.tileID,b=new Ut(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),S=new Ut(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(h=>h.tileID.key):c.map(h=>h.tileID).sort(mz).map(h=>h.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s,c){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())&&(c||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,s){const c=this._tiles[r];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,r,s)))}_tileLoaded(r,s,c,h){if(h)if(r.state="errored",h.status!==404)this._source.fire(new Wm(h,{tile:r}));else{if(!(r.tileID.key in this._loadedParentTiles))return void this._source.fire(new ps("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=Io.now(),c==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new ps("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const s=this.getRenderableIds();for(let h=0;h<s.length;h++){const p=s[h];if(r.neighboringTiles&&r.neighboringTiles[p]){const m=this.getTileByID(p);c(r,m),c(m,r)}}function c(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let m=p.tileID.canonical.x-h.tileID.canonical.x;const x=p.tileID.canonical.y-h.tileID.canonical.y,b=Math.pow(2,h.tileID.canonical.z),S=p.tileID.key;m===0&&x===0||Math.abs(x)>1||(Math.abs(m)>1&&(Math.abs(m+b)===1?m+=b:Math.abs(m-b)===1&&(m-=b)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,m,x),h.neighboringTiles&&h.neighboringTiles[S]&&(h.neighboringTiles[S].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,c,h){for(const p in this._tiles){let m=this._tiles[p];if(h[p]||!m.hasData()||m.tileID.overscaledZ<=s||m.tileID.overscaledZ>c)continue;let x=m.tileID;for(;m&&m.tileID.overscaledZ>s+1;){const S=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[S.key],m&&m.hasData()&&(x=S)}let b=x;for(;b.overscaledZ>s;)if(b=b.scaledTo(b.overscaledZ-1),r[b.key]){h[x.key]=x;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=r.overscaledZ-1;c>=s;c--){const h=r.scaledTo(c),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,s){s=s||this._source.tileSize;const c=Math.ceil(r.width/s)+1,h=Math.ceil(r.height/s)+1,p=Math.floor(c*h*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(x)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const c={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+s),c[p.tileID.key]=p}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(r,s,c,h){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let p;if(this.updateCacheSize(r,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain){if(this._source.tileID)p=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Ji(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y));else if(this.tileCoverLift!==0){const b=r.clone();b.tileCoverLift=this.tileCoverLift,p=b.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&r.projection.name==="globe"&&(p.push(new Ji(1,0,1,0,0)),p.push(new Ji(1,0,1,1,0)),p.push(new Ji(1,0,1,0,1)),p.push(new Ji(1,0,1,1,1)))}else if(p=r.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile){const b=this._source.hasTile.bind(this._source);p=p.filter(S=>b(S))}}else p=[];if(p.length>0&&this.castsShadows&&h&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!$3(this._source.type)){const b=r.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!c}),S=Math.min(b,this._source.maxzoom),I=r.extendTileCoverForShadows(p,h,S);for(const P of I)this._shadowCasterTiles[P.key]=!0,p.push(P)}const m=this._updateRetainedTiles(p);if($3(this._source.type)&&p.length!==0){const b={},S={},I=Object.keys(m);for(const D of I){const F=m[D],U=this._tiles[D];if(!U||U.fadeEndTime&&U.fadeEndTime<=Io.now())continue;const V=this.findLoadedParent(F,Math.max(F.overscaledZ-pp.maxOverzooming,this._source.minzoom));V&&(this._addTile(V.tileID),b[V.tileID.key]=V.tileID),S[D]=F}const P=p[p.length-1].overscaledZ;for(const D in this._tiles){const F=this._tiles[D];if(m[D]||!F.hasData())continue;let U=F.tileID;for(;U.overscaledZ>P;){U=U.scaledTo(U.overscaledZ-1);const V=this._tiles[U.key];if(V&&V.hasData()&&S[U.key]){m[D]=F.tileID;break}}}for(const D in b)m[D]||(this._coveredTiles[D]=!0,m[D]=b[D])}for(const b in m)this._tiles[b].clearFadeHold();const x=function(b,S){const I=[];for(const P in b)P in S||I.push(P);return I}(this._tiles,m);for(const b of x){const S=this._tiles[b];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const s={};if(r.length===0)return s;const c={},h=r.reduce((S,I)=>Math.min(S,I.overscaledZ),1/0),p=r[0].overscaledZ,m=Math.max(p-pp.maxOverzooming,this._source.minzoom),x=Math.max(p+pp.maxUnderzooming,this._source.minzoom),b={};for(const S of r){const I=this._addTile(S);s[S.key]=S,I.hasData()||h<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,h,x,s);for(const S of r){let I=this._tiles[S.key];if(I.hasData())continue;if(S.canonical.z>=this._source.maxzoom){const D=S.children(this._source.maxzoom)[0],F=this.getTile(D);if(F&&F.hasData()){s[D.key]=D;continue}}else{const D=S.children(this._source.maxzoom);if(s[D[0].key]&&s[D[1].key]&&s[D[2].key]&&s[D[3].key])continue}let P=I.wasRequested();for(let D=S.overscaledZ-1;D>=m;--D){const F=S.scaledTo(D);if(c[F.key]||(c[F.key]=!0,I=this.getTile(F),!I&&P&&(I=this._addTile(F)),I&&(s[F.key]=F,P=I.wasRequested(),I.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let c,h=this._tiles[r].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}s.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(p),c)break;h=p}for(const p of s)this._loadedParentTiles[p]=c}}_addTile(r){let s=this._tiles[r.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const c=!!s;if(!c){const h=this.map?this.map.painter:null,p=this._source.tileSize*r.overscaleFactor();s=this._source.type==="raster-array"?new pz(r,p,this.transform.tileZoom,h,this._isRaster):new Gw(r,p,this.transform.tileZoom,h,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))}return s?(s.uses++,this._tiles[r.key]=s,c||this._source.fire(new ps("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=s.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,s,c){const h=[],p=this.transform;if(!p)return h;const m=p.projection.name==="globe",x=Nc(p.center.lng);for(const b in this._tiles){const S=this._tiles[b];if(c&&S.clearQueryDebugViz(),S.holdingForFade())continue;let I;if(m){const P=S.tileID.canonical;if(P.z===0){const D=[Math.abs(Kr(x,...Av(P,-1))-x),Math.abs(Kr(x,...Av(P,1))-x)];I=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(Kr(x,...Av(P,-1))-x),Math.abs(Kr(x,...Av(P,0))-x),Math.abs(Kr(x,...Av(P,1))-x)];I=[D.indexOf(Math.min(...D))-1]}}else I=[0];for(const P of I){const D=r.containsTile(S,p,s,P);D&&h.push(D)}}return h}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,s){const c=this.getRenderableIds(r,s).map(p=>this._tiles[p].tileID),h=this.transform.projection.name==="globe";for(const p of c)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped()),p.expandedProjMatrix=h?this.transform.calculateProjMatrix(p.toUnwrapped(),!1,!0):p.projMatrix;return c}sortCoordinatesByDistance(r){const s=r.slice(),c=this.transform._camera.position,h=this.transform._camera.forward(),p={};for(const m of s){const x=1/(1<<m.canonical.z);p[m.key]=((m.canonical.x+.5)*x+m.wrap-c[0])*h[0]+((m.canonical.y+.5)*x-c[1])*h[1]-c[2]*h[2]}return s.sort((m,x)=>p[m.key]-p[x.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if($3(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=Io.now())return!0}return!1}setFeatureState(r,s,c){this._state.updateState(r=r||"_geojsonTileLayer",s,c)}removeFeatureState(r,s,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,c)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,c){const h=this._tiles[r];h&&h.setDependencies(s,c)}reloadTilesForDependencies(r,s){for(const c in this._tiles)this._tiles[c].hasDependency(r,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(r,s))}_preloadTiles(r,s){if(!this._sourceLoaded){const x=()=>{this._sourceLoaded&&(this._source.off("data",x),this._preloadTiles(r,s))};return void this._source.on("data",x)}const c=new Map,h=Array.isArray(r)?r:[r],p=this.map.painter.terrain,m=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const x of h){const b=x.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const S of b)c.set(S.key,S);this.usedForTerrain&&x.updateElevation(!1)}Mh(Array.from(c.values()),(x,b)=>{const S=new Gw(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(S,I=>{this._source.type==="raster-dem"&&S.dem&&this._backfillDEM(S),b(I,S)})},s)}}function mz(i,r){const s=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return i.overscaledZ-r.overscaledZ||c-s||r.canonical.y-i.canonical.y||r.canonical.x-i.canonical.x}function $3(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function Av(i,r){const s=1<<i.z;return[i.x/s+r,(i.x+1)/s+r]}pp.maxOverzooming=10,pp.maxUnderzooming=3;const gz=new class extends jt{possiblyEvaluate(i,r){return r=new Mr(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(i,r)}evaluate(i,r,s,c){return r=jo({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(i,r,s,c)}}(Aw.paint.properties["line-width"].specification);function _z(i,r){return r>0?r+2*i:i}gz.useIntegerZoom=!0;const aJ=new Sn({"symbol-placement":new yt(Ve.layout_symbol["symbol-placement"]),"symbol-spacing":new yt(Ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yt(Ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jt(Ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yt(Ve.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new yt(Ve.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new yt(Ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new yt(Ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new yt(Ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yt(Ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new jt(Ve.layout_symbol["icon-size"]),"icon-text-fit":new jt(Ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt(Ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new jt(Ve.layout_symbol["icon-image"]),"icon-rotate":new jt(Ve.layout_symbol["icon-rotate"]),"icon-padding":new yt(Ve.layout_symbol["icon-padding"]),"icon-keep-upright":new yt(Ve.layout_symbol["icon-keep-upright"]),"icon-offset":new jt(Ve.layout_symbol["icon-offset"]),"icon-anchor":new jt(Ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yt(Ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yt(Ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yt(Ve.layout_symbol["text-rotation-alignment"]),"text-field":new jt(Ve.layout_symbol["text-field"]),"text-font":new jt(Ve.layout_symbol["text-font"]),"text-size":new jt(Ve.layout_symbol["text-size"]),"text-max-width":new jt(Ve.layout_symbol["text-max-width"]),"text-line-height":new jt(Ve.layout_symbol["text-line-height"]),"text-letter-spacing":new jt(Ve.layout_symbol["text-letter-spacing"]),"text-justify":new jt(Ve.layout_symbol["text-justify"]),"text-radial-offset":new jt(Ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yt(Ve.layout_symbol["text-variable-anchor"]),"text-anchor":new jt(Ve.layout_symbol["text-anchor"]),"text-max-angle":new yt(Ve.layout_symbol["text-max-angle"]),"text-writing-mode":new yt(Ve.layout_symbol["text-writing-mode"]),"text-rotate":new jt(Ve.layout_symbol["text-rotate"]),"text-padding":new yt(Ve.layout_symbol["text-padding"]),"text-keep-upright":new yt(Ve.layout_symbol["text-keep-upright"]),"text-transform":new jt(Ve.layout_symbol["text-transform"]),"text-offset":new jt(Ve.layout_symbol["text-offset"]),"text-allow-overlap":new yt(Ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new yt(Ve.layout_symbol["text-ignore-placement"]),"text-optional":new yt(Ve.layout_symbol["text-optional"]),visibility:new yt(Ve.layout_symbol.visibility)});var j3={paint:new Sn({"icon-opacity":new jt(Ve.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new jt(Ve.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new jt(Ve.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new jt(Ve.paint_symbol["text-emissive-strength"]),"icon-color":new jt(Ve.paint_symbol["icon-color"]),"icon-halo-color":new jt(Ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new jt(Ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jt(Ve.paint_symbol["icon-halo-blur"]),"icon-translate":new yt(Ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new yt(Ve.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new jt(Ve.paint_symbol["icon-image-cross-fade"]),"text-opacity":new jt(Ve.paint_symbol["text-opacity"]),"text-occlusion-opacity":new jt(Ve.paint_symbol["text-occlusion-opacity"]),"text-color":new jt(Ve.paint_symbol["text-color"],{runtimeType:ms,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new jt(Ve.paint_symbol["text-halo-color"]),"text-halo-width":new jt(Ve.paint_symbol["text-halo-width"]),"text-halo-blur":new jt(Ve.paint_symbol["text-halo-blur"]),"text-translate":new yt(Ve.paint_symbol["text-translate"]),"text-translate-anchor":new yt(Ve.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new yt(Ve.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new yt(Ve.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new yt(Ve.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new yt(Ve.paint_symbol["icon-color-brightness-max"])}),layout:aJ};class yz{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Nh,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}pe(yz,"FormatSectionOverride",{omit:["defaultValue"]});class Ww extends Qi{constructor(r,s,c,h){super(r,j3,s,c,h),this._colorAdjustmentMatrix=a.ad.identity([]),this.hasInitialOcclusionOpacityProperties=r.paint!==void 0&&("icon-occlusion-opacity"in r.paint||"text-occlusion-opacity"in r.paint)}recalculate(r,s){super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const h=[];for(const p of c)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(r,s,c,h){return this._saturation===r&&this._contrast===s&&this._brightnessMin===c&&this._brightnessMax===h||(this._colorAdjustmentMatrix=function(p,m,x,b){p=Bm(p),m=Lm(m);const S=a.ad.create(),I=p/3,P=1-2*I,D=[P,I,I,0,I,P,I,0,I,I,P,0,0,0,0,1],F=.5-.5*m,U=b-x;return a.ad.multiply(S,[U,0,0,0,0,U,0,0,0,0,U,0,x,x,x,1],[m,0,0,0,0,m,0,0,0,0,m,0,F,F,F,1]),a.ad.multiply(S,S,D),S}(r,s,c,h),this._saturation=r,this._contrast=s,this._brightnessMin=c,this._brightnessMax=h),this._colorAdjustmentMatrix}getValueAndResolveTokens(r,s,c,h){const p=this.layout.get(r).evaluate(s,{},c,h),m=this._unevaluatedLayout._values[r];return m.isDataDriven()||G(m.value)||!p?p:function(x,b){return b.replace(/{([^{}]+)}/g,(S,I)=>I in x?String(x[I]):"")}(s.properties,p)}createBucket(r){return new D0(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of j3.paint.overridableProperties){if(!Ww.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),c=new yz(s),h=new $(c,s.property.specification,this.scope,this.options);let p=null;p=s.value.kind==="constant"||s.value.kind==="source"?new Q("source",h):new ne("composite",h,s.value.zoomStops,s.value._interpolationType),this.paint._values[r]=new Jn(s.property,p,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Ww.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const c=r.get("text-field"),h=j3.paint.properties[s];let p=!1;const m=x=>{for(const b of x)if(h.overrides&&h.overrides.hasOverride(b))return void(p=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Vo)m(c.value.value.sections);else if(c.value.kind==="source"){const x=S=>{p||(S instanceof Gl&&ji(S.value)===$h?m(S.value.sections):S instanceof Uf?m(S.sections):S.eachChild(x))},b=c.value;b._styleExpression&&x(b._styleExpression.expression)}return p}getProgramIds(){const r=this.paint.get("icon-opacity").constantOr(1)!==0,s=this.paint.get("text-opacity").constantOr(1)!==0,c=[];return r&&c.push("symbolIcon"),s&&c.push("symbolSDF"),c}getDefaultProgramParams(r,s,c){return{config:new sp(this,{zoom:s,lut:c}),overrideFog:!1}}}const lJ=new Sn({visibility:new yt(Ve.layout_background.visibility)});var cJ={paint:new Sn({"background-color":new yt(Ve.paint_background["background-color"]),"background-pattern":new yt(Ve.paint_background["background-pattern"]),"background-opacity":new yt(Ve.paint_background["background-opacity"]),"background-emissive-strength":new yt(Ve.paint_background["background-emissive-strength"])}),layout:lJ};const uJ=new Sn({visibility:new yt(Ve.layout_raster.visibility)});var hJ={paint:new Sn({"raster-opacity":new yt(Ve.paint_raster["raster-opacity"]),"raster-color":new ui(Ve.paint_raster["raster-color"]),"raster-color-mix":new yt(Ve.paint_raster["raster-color-mix"]),"raster-color-range":new yt(Ve.paint_raster["raster-color-range"]),"raster-hue-rotate":new yt(Ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yt(Ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yt(Ve.paint_raster["raster-brightness-max"]),"raster-saturation":new yt(Ve.paint_raster["raster-saturation"]),"raster-contrast":new yt(Ve.paint_raster["raster-contrast"]),"raster-resampling":new yt(Ve.paint_raster["raster-resampling"]),"raster-fade-duration":new yt(Ve.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new yt(Ve.paint_raster["raster-emissive-strength"]),"raster-array-band":new yt(Ve.paint_raster["raster-array-band"]),"raster-elevation":new yt(Ve.paint_raster["raster-elevation"])}),layout:uJ};function qw(i,r,s,c,h,p,m,x){const b=[i,r,1,s,c,1,h,p,1],S=[m,x,1],I=a.bC.adjoint([],b),[P,D,F]=a._.transformMat3(S,S,I);return a.bC.multiply(b,b,[P,0,0,0,D,0,0,0,F])}function vz(i,r,s,c,h,p,m,x){const b=function(S,I,P,D,F,U,V,W){const ee=qw(0,0,1,0,1,1,0,1),ce=qw(S,I,P,D,F,U,V,W),ue=a.bC.adjoint([],ee);return a.bC.multiply(ce,ce,ue)}(i,r,s,c,h,p,m,x);return[b[2]/b[8]/Bt,b[5]/b[8]/Bt]}function Kw(i){return[i[0],Math.min(Math.max(i[1],-ki),ki)]}class xz extends Au{constructor(r,s,c,h){super(),this.id=r,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(h),this.options=s,this._dirty=!1}load(r,s){if(this._loaded=s||!1,this.fire(new ps("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=Mc(this.map._requestManager.transformRequest(this.url,$m.Image),(c,h)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new Wm(c)):h&&(this.image=h instanceof HTMLImageElement?Io.getImageData(h):h,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new jw(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ps("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(r){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof jw||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=r[0][1],c=r[0][1];for(const p of r)p[1]>c&&(c=p[1]),p[1]<s&&(s=p[1]);const h=(c+s)/2;if(h>ki?this.onNorthPole=!0:h<-ki&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=r.map(es.fromLngLat);this.tileID=function(m){let x=1/0,b=1/0,S=-1/0,I=-1/0;for(const V of m)x=Math.min(x,V.x),b=Math.min(b,V.y),S=Math.max(S,V.x),I=Math.max(I,V.y);const P=Math.max(S-x,I-b),D=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),F=Math.pow(2,D);let U=Math.floor((x+S)/2*F);return U>1&&(U-=1),new lp(D,U,Math.floor((b+I)/2*F))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new ps("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const W in this.tiles){const ee=this.tiles[W];ee.state!=="loaded"&&(ee.state="loaded",ee.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=dp(new lp(0,0,0),this.map.transform.projection),c=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(W){const ee=W[1].x-W[0].x,ce=W[1].y-W[0].y,ue=W[2].x-W[1].x,he=W[2].y-W[1].y,Se=W[3].x-W[2].x,be=W[3].y-W[2].y,ke=W[0].x-W[3].x,Le=W[0].y-W[3].y,je=ee*he-ue*ce,ot=ue*be-Se*he,Ze=Se*Le-ke*be,dt=ke*ce-ee*Le;return je>0&&ot>0&&Ze>0&&dt>0||je<0&&ot<0&&Ze<0&&dt<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const h=dp(this.tileID,this.map.transform.projection),[p,m,x,b]=this.coordinates.map(W=>{const ee=h.projection.project(W[0],W[1]);return QF(h,ee)._round()});this.perspectiveTransform=vz(p.x,p.y,m.x,m.y,x.x,x.y,b.x,b.y);const S=this._boundsArray=new Jh;S.emplaceBack(p.x,p.y,0,0),S.emplaceBack(m.x,m.y,Bt,0),S.emplaceBack(b.x,b.y,0,Bt),S.emplaceBack(x.x,x.y,Bt,Bt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(S,Hw.members),this.boundsSegments=hi.simpleSegment(0,0,4,2);const I=[],P=function(W){return[Kw(W[0]),Kw(W[1]),Kw(W[2]),Kw(W[3])]}(this.coordinates),[D,F,U,V]=function(W){let ee=W[0][0],ce=ee,ue=W[0][1],he=ue;for(let Se=1;Se<W.length;Se++)W[Se][0]<ee?ee=W[Se][0]:W[Se][0]>ce&&(ce=W[Se][0]),W[Se][1]<ue?ue=W[Se][1]:W[Se][1]>he&&(he=W[Se][1]);return[ee,ue,ce-ee,he-ue]}(P);{const W=new Jh,[ee,ce,ue,he]=function(st){let wt=st[0].x,Pt=wt,Tt=st[0].y,Ht=Tt;for(let It=1;It<st.length;It++)st[It].x<wt?wt=st[It].x:st[It].x>Pt&&(Pt=st[It].x),st[It].y<Tt?Tt=st[It].y:st[It].y>Ht&&(Ht=st[It].y);return[wt,Tt,Pt-wt,Ht-Tt]}(c),Se=st=>[(st.x-ee)/ue,(st.y-ce)/he],[be,ke,Le,je]=c.map(Se),ot=function(st,wt,Pt,Tt,Ht,It,Dt,fr){const lr=qw(0,0,1,0,1,1,0,1),sr=qw(st,wt,Pt,Tt,Ht,It,Dt,fr),Rt=a.bC.adjoint([],sr);return a.bC.multiply(lr,lr,Rt)}(be[0],be[1],ke[0],ke[1],Le[0],Le[1],je[0],je[1]);this.elevatedGlobePerspectiveTransform=vz(be[0],be[1],ke[0],ke[1],Le[0],Le[1],je[0],je[1]);const Ze=(st,wt)=>{I.push(st.lng);const Pt=Math.round((st.lng-D)/U*Bt),Tt=Math.round((st.lat-F)/V*Bt),Ht=Se(wt),It=a._.transformMat3([],[Ht[0],Ht[1],1],ot),Dt=Math.round(It[0]/It[2]*Bt),fr=Math.round(It[1]/It[2]*Bt);W.emplaceBack(Pt,Tt,Dt,fr)},dt=c[3].x-c[0].x,At=c[3].y-c[0].y,ct=c[2].x-c[1].x,bt=c[2].y-c[1].y;for(let st=0;st<65;st++){const wt=st/64,Pt=[c[0].x+wt*dt,c[0].y+wt*At],Tt=[c[1].x+wt*ct,c[1].y+wt*bt],Ht=Tt[0]-Pt[0],It=Tt[1]-Pt[1];for(let Dt=0;Dt<65;Dt++){const fr=Dt/64,lr={x:Pt[0]+Ht*fr,y:Pt[1]+It*fr,z:0};Ze(s.projection.unproject(lr.x,lr.y),lr)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(W,Hw.members)}{this.maxLongitudeTriangleSize=0;let W=[],ee=new vo;const ce=(ue,he,Se)=>{ee.emplaceBack(ue,he,Se);const be=I[ue],ke=I[he],Le=I[Se],je=Math.min(Math.min(be,ke),Le),ot=Math.max(Math.max(be,ke),Le)-je;ot>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ot),W.push(je+ot/2)};for(let ue=0;ue<64;ue++)for(let he=0;he<64;he++){const Se=65*ue+he,be=Se+1,ke=Se+65,Le=ke+1;ce(Se,ke,be),ce(be,ke,Le)}[W,ee]=function(ue,he){const Se=Array.from({length:ue.length},(Le,je)=>je);Se.sort((Le,je)=>ue[Le]-ue[je]);const be=[],ke=new vo;for(let Le=0;Le<Se.length;Le++){const je=Se[Le];be.push(ue[je]);const ot=3*je,Ze=ot+1;ke.emplaceBack(he.uint16[ot],he.uint16[Ze],he.uint16[Ze+1])}return[be,ke]}(W,ee),this.elevatedGlobeTrianglesCenterLongitudes=W,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(ee)}this.elevatedGlobeSegments=hi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,U/Bt,0,V/Bt,0,0,F,D,0])}prepare(){const r=Object.keys(this.tiles).length!==0;if(this.tileID&&!r)return;const s=this.map.painter.context,c=s.gl;!this._dirty||this.texture instanceof jw||(this.texture?this.texture.update(this.image):(this.texture=new pl(s,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(s)}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let h=(p=r+180)+360*Math.round((c[0]-p)/360);var p;const m=new hi,x=(P,D)=>{m.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:s.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},b=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-h)<=b){const P=cb(c,0,c.length,h+b);return P===c.length||x(P,sy(c,P+1,c.length,h+360-b)-P),m}h<c[0]&&(h+=360);const S=sy(c,0,c.length,h-b);if(S===c.length)return x(0,c.length),m;x(0,S-0);const I=cb(c,S+1,c.length,h+b);return I!==c.length&&x(I,c.length-I),m}}const dJ=(Math.pow(256,2)-1)/16907520;class bz extends Qi{constructor(r,s,c,h){super(r,hJ,s,c,h),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(r){return!(r&&r._source instanceof xz&&(r._source.onNorthPole||r._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[c,h]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(h)||c===this._curRampRange[0]&&h===this._curRampRange[1]||(this.colorRamp=av({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:h}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,h])}}const fJ=new Sn({visibility:new yt(Ve["layout_raster-particle"].visibility)});var pJ={paint:new Sn({"raster-particle-array-band":new yt(Ve["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new yt(Ve["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ui(Ve["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new yt(Ve["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new yt(Ve["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new yt(Ve["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new yt(Ve["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:fJ};class wz extends Qi{constructor(r,s,c,h){super(r,pJ,s,c,h),this._updateColorRamp(),this.lastInvalidatedAt=Io.now()}onRemove(r){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){r!=="raster-particle-color"&&r!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),r==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=av({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Io.now()}}class mJ extends Qi{constructor(r,s){super(r,{},s,null),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(r){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}const gJ=new Sn({visibility:new yt(Ve.layout_sky.visibility)});var _J={paint:new Sn({"sky-type":new yt(Ve.paint_sky["sky-type"]),"sky-atmosphere-sun":new yt(Ve.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new yt(Ve.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new yt(Ve.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new yt(Ve.paint_sky["sky-gradient-radius"]),"sky-gradient":new ui(Ve.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new yt(Ve.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new yt(Ve.paint_sky["sky-atmosphere-color"]),"sky-opacity":new yt(Ve.paint_sky["sky-opacity"])}),layout:gJ};function V3(i,r,s){const c=[0,0,1],h=a.av.identity([]);return a.av.rotateY(h,h,s?-an(i)+Math.PI:an(i)),a.av.rotateX(h,h,-an(r)),a._.transformQuat(c,c,h),a._.normalize(c,c)}var yJ={paint:new Sn({})};function Cz(i,r){const s=Yw(i.projection,i.zoom,i.width,i.height),c=function(p,m,x,b,S){const I=new gn(x.lng-180*_d,x.lat),P=new gn(x.lng+180*_d,x.lat),D=p.project(I.lng,I.lat),F=p.project(P.lng,P.lat),U=-Math.atan2(F.y-D.y,F.x-D.x),V=es.fromLngLat(x);V.y=Kr(V.y,-1+_d,1-_d);const W=V.toLngLat(),ee=p.project(W.lng,W.lat),ce=es.fromLngLat(W);ce.x+=_d;const ue=ce.toLngLat(),he=p.project(ue.lng,ue.lat),Se=Tz(he.x-ee.x,he.y-ee.y,U),be=es.fromLngLat(W);be.y+=_d;const ke=be.toLngLat(),Le=p.project(ke.lng,ke.lat),je=Tz(Le.x-ee.x,Le.y-ee.y,U),ot=Math.abs(Se.x)/Math.abs(je.y),Ze=a.ad.identity([]);a.ad.rotateZ(Ze,Ze,-U*(1-(S?0:b)));const dt=a.ad.identity([]);return a.ad.scale(dt,dt,[1,1-(1-ot)*b,1]),dt[4]=-je.x/je.y*b,a.ad.rotateZ(dt,dt,U),a.ad.multiply(dt,Ze,dt),dt}(i.projection,0,i.center,s,r),h=Ez(i);return a.ad.scale(c,c,[h,h,1]),c}function Ez(i){const r=i.projection,s=Yw(i.projection,i.zoom,i.width,i.height),c=Sz(r,i.center),h=Sz(r,gn.convert(r.center));return Math.pow(2,c*s+(1-s)*h)}function Yw(i,r,s,c,h=1/0){const p=i.range;if(!p)return 0;const m=Math.min(h,Math.max(s,c)),x=Math.log(m/1024)/Math.LN2;return bu(p[0]+x,p[1]+x,r)}const _d=1/4e4;function Sz(i,r){const s=Kr(r.lat,-ki,ki),c=new gn(r.lng-180*_d,s),h=new gn(r.lng+180*_d,s),p=i.project(c.lng,s),m=i.project(h.lng,s),x=es.fromLngLat(c),b=es.fromLngLat(h),S=m.x-p.x,I=m.y-p.y,P=b.x-x.x,D=b.y-x.y,F=Math.sqrt((P*P+D*D)/(S*S+I*I));return Math.log(F)/Math.LN2}function Tz(i,r,s){const c=Math.cos(s),h=Math.sin(s);return{x:i*c-r*h,y:i*h+r*c}}function Az(i,r,s){a.ad.identity(i),a.ad.rotateZ(i,i,an(r[2])),a.ad.rotateX(i,i,an(r[0])),a.ad.rotateY(i,i,an(r[1])),a.ad.scale(i,i,s),a.ad.multiply(i,i,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Zw(i,r,s,c,h,p,m,x){const b=[s[0]-r[0],s[1]-r[1],0],S=[c[0]-r[0],c[1]-r[1],0];if(a._.length(b)<1e-12||a._.length(S)<1e-12)return a.av.identity(i);const I=a._.cross([],b,S);a._.normalize(I,I),a._.subtract(S,c,r),b[2]=(p-h)*x,S[2]=(m-h)*x;const P=b;return a._.cross(P,b,S),a._.normalize(P,P),a.av.rotationTo(i,I,P)}function H3(i,r,s=!1){const c=Vu(r.zoom),h=function(p,m,x){const b=m.worldSize,S=[p[12],p[13],p[14]],I=Ro(S[1]/b),P=Ys(S[0]/b),D=a.ad.identity([]),F=Ds(1,I)*b,U=Ds(1,0)*b*cp(I,m.zoom),V=1/c3(b);let W=U*V;if(x){const he=Yw(m.projection,m.zoom,m.width,m.height,1024);W=V*m.projection.pixelSpaceConversion(m.center.lat,b,he)}const ee=ap(I,P);a._.add(ee,ee,a._.scale([],a._.normalize([],ee),F*W*S[2]));const ce=function(he){const Se=[he[0],he[1],he[2]];let be=[0,1,0];const ke=a._.cross([],be,Se);return a._.cross(be,Se,ke),a._.squaredLength(be)===0&&(be=[0,1,0],a._.cross(ke,Se,be)),a._.normalize(ke,ke),a._.normalize(be,be),a._.normalize(Se,Se),[ke[0],ke[1],ke[2],0,be[0],be[1],be[2],0,Se[0],Se[1],Se[2],0,he[0],he[1],he[2],1]}(ee);a.ad.scale(D,D,[W,W,W*F]),a.ad.translate(D,D,[-S[0],-S[1],-S[2]]);const ue=a.ad.multiply([],m.globeMatrix,ce);return a.ad.multiply(ue,ue,D),a.ad.multiply(ue,ue,p),ue}(i,r,s);if(c>0){const p=function(m,x){const b=x.worldSize,S=Ds(1,0)*b*cp(x.center.lat,x.zoom)/c3(b),I=Ds(1,x.center.lat)*b,P=a.ad.identity([]);return a.ad.rotateY(P,P,an(x.center.lng)),a.ad.rotateX(P,P,an(x.center.lat)),a.ad.translate(P,P,[0,0,ks]),a.ad.scale(P,P,[S,S,S*I]),a.ad.translate(P,P,[x.point.x-.5*b,x.point.y-.5*b,0]),a.ad.multiply(P,P,m),a.ad.multiply(P,x.globeMatrix,P)}(i,r);return function(m,x,b){const S=(U,V,W)=>{const ee=a._.length(U),ce=a._.length(V),ue=ju(U,V,W);return a._.scale(ue,ue,1/a._.length(ue)*_r(ee,ce,W))},I=S([m[0],m[1],m[2]],[x[0],x[1],x[2]],b),P=S([m[4],m[5],m[6]],[x[4],x[5],x[6]],b),D=S([m[8],m[9],m[10]],[x[8],x[9],x[10]],b),F=ju([m[12],m[13],m[14]],[x[12],x[13],x[14]],b);return[I[0],I[1],I[2],0,P[0],P[1],P[2],0,D[0],D[1],D[2],0,F[0],F[1],F[2],1]}(h,p,c)}return h}function Iz(i,r,s,c){const h=di.projectAabbCorners(c,s);let p=Number.MAX_VALUE,m=-1;for(let S=0;S<h.length;++S){const I=h[S];I[0]=(.5*I[0]+.5)*r.width,I[1]=(.5-.5*I[1])*r.height,I[2]<p&&(m=S,p=I[2])}const x=S=>new Ut(h[S][0],h[S][1]);let b;switch(m){case 0:case 6:b=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:b=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:b=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:b=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(JI(i,b))return p}const vJ=Tn([{name:"a_pos_3f",components:3,type:"Float32"}]),xJ=Tn([{name:"a_color_3f",components:3,type:"Float32"}]),bJ=Tn([{name:"a_color_4f",components:4,type:"Float32"}]),wJ=Tn([{name:"a_uv_2f",components:2,type:"Float32"}]),CJ=Tn([{name:"a_normal_3f",components:3,type:"Float32"}]),EJ=Tn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),SJ=Tn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class Xw{constructor(r,s,c,h){this.message=(r?`${r}: `:"")+c,h&&(this.identifier=h),s!=null&&s.__line__&&(this.line=s.__line__)}}function Mz(i,r){const s=i.indexOf("://")===-1;try{return new URL(i,s&&r?"http://example.com":void 0),!0}catch{return!1}}class Pz{constructor(r,s){this.feature=r,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Rz{constructor(){this.instancedDataArray=new BI,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class G3{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=r.projection,this.index=r.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(r,s){}populate(r,s,c,h){this.tileToMeter=sw(c);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:x,index:b,sourceLayerIndex:S}of r){const I=x??(m.properties&&m.properties.hasOwnProperty("id")?m.properties.id:void 0),P=$u(m,p);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),P,c))continue;const D={id:I,sourceLayerIndex:S,index:b,geometry:p?P.geometry:Xl(m,c,h),properties:m.properties,type:m.type,patterns:{}},F=this.addFeature(D,D.geometry,P);F&&s.featureIndex.insert(m,D.geometry,b,S,this.index,this.instancesPerModel[F].instancedDataArray.length,Bt/32)}this.lookup=null}update(r,s,c,h){for(const p in this.instancesPerModel){const m=this.instancesPerModel[p];for(const x in r)m.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(m.features[m.idToFeaturesIndex[x]],r[x],m,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];for(const h of c.features){const p=this.layers[0],m=h.feature,x=this.canonical,b=p.paint.get("model-rotation").evaluate(m,{},x),S=p.paint.get("model-scale").evaluate(m,{},x),I=p.paint.get("model-translation").evaluate(m,{},x);a._.exactEquals(h.rotation,b)&&a._.exactEquals(h.scale,S)&&a._.exactEquals(h.translation,I)||(this.evaluate(h,h.featureStates,c,!0),r=!0)}}return r}updateReplacement(r,s,c){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);if(v3(this.activeReplacements,h))return!1;this.activeReplacements=h;let p=!1;for(const m in this.instancesPerModel){const x=this.instancesPerModel[m],b=x.instancedDataArray;for(const S of x.features){const I=S.instancedDataOffset,P=S.instancedDataCount;for(let D=0;D<P;D++){const F=16*(D+I);let U=b.float32[F+0];U=U>Bt?U-Bt:U;const V=Math.floor(U),W=b.float32[F+1];let ee=!1;for(const ce of this.activeReplacements)if(!(ce.order<c||ce.order===1/0)&&ce.clipMask&YB.Model&&!(ce.min.x>V||V>ce.max.x||ce.min.y>W||W>ce.max.y)&&(ee=$B(UB(V,W,r.canonical,ce.footprintTileId.canonical),ce),ee))break;b.float32[F]=ee?U+Bt:U,p=p||ee}}}return p}isEmpty(){for(const r in this.instancesPerModel)if(this.instancesPerModel[r].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=r.createVertexBuffer(c.instancedDataArray,EJ.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const r=this.layers[0].modelManager;if(r&&this.modelUris)for(const s of this.modelUris)r.removeModel(s,"")}addFeature(r,s,c){const h=this.layers[0],p=h.layout.get("model-id").evaluate(c,{},this.canonical);if(!p)return Pi(`modelId is not evaluated for layer ${h.id} and it is not going to get rendered.`),p;Mz(p,!1)&&(this.modelUris.includes(p)||this.modelUris.push(p)),this.instancesPerModel[p]||(this.instancesPerModel[p]=new Rz);const m=this.instancesPerModel[p],x=m.instancedDataArray,b=new Pz(c,x.length);for(const S of s)for(const I of S){if(I.x<0||I.x>=Bt||I.y<0||I.y>=Bt)continue;const P=(this.lookupDim-1)/Bt,D=this.lookupDim*(I.y*P|0)+I.x*P|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const F=x.length;x.resize(F+1),m.instancesEvaluatedElevation.push(0),x.float32[16*F]=I.x,x.float32[16*F+1]=I.y}return b.instancedDataCount=m.instancedDataArray.length-b.instancedDataOffset,b.instancedDataCount>0&&(r.id&&(m.idToFeaturesIndex[r.id]=m.features.length),m.features.push(b),this.evaluate(b,{},m,!1)),p}getModelUris(){return this.modelUris}evaluate(r,s,c,h){const p=this.layers[0],m=r.feature,x=this.canonical,b=r.rotation=p.paint.get("model-rotation").evaluate(m,s,x),S=r.scale=p.paint.get("model-scale").evaluate(m,s,x),I=r.translation=p.paint.get("model-translation").evaluate(m,s,x),P=p.paint.get("model-color").evaluate(m,s,x);P.a=p.paint.get("model-color-mix-intensity").evaluate(m,s,x);const D=[];this.maxVerticalOffset<I[2]&&(this.maxVerticalOffset=I[2]),this.maxScale=Math.max(Math.max(this.maxScale,S[0]),Math.max(S[1],S[2])),Az(D,b,S);const F=Math.round(100*P.a)+P.b/1.05;for(let U=0;U<r.instancedDataCount;++U){const V=r.instancedDataOffset+U,W=16*V,ee=c.instancedDataArray.float32;let ce=0;h&&(ce=ee[W+6]-c.instancesEvaluatedElevation[V]);const ue=0|ee[W+1];ee[W]=(0|ee[W])+P.r/1.05,ee[W+1]=ue+P.g/1.05,ee[W+2]=F,ee[W+3]=1/(x.z>10?this.tileToMeter:sw(x,ue)),ee[W+4]=I[0],ee[W+5]=I[1],ee[W+6]=I[2]+ce,ee[W+7]=D[0],ee[W+8]=D[1],ee[W+9]=D[2],ee[W+10]=D[4],ee[W+11]=D[5],ee[W+12]=D[6],ee[W+13]=D[8],ee[W+14]=D[9],ee[W+15]=D[10],c.instancesEvaluatedElevation[V]=I[2]}}}pe(G3,"ModelBucket",{omit:["layers"]}),pe(Rz,"PerModelAttributes"),pe(Pz,"ModelFeature");const TJ=new Sn({visibility:new yt(Ve.layout_model.visibility),"model-id":new jt(Ve.layout_model["model-id"])});var AJ={paint:new Sn({"model-opacity":new yt(Ve.paint_model["model-opacity"]),"model-rotation":new jt(Ve.paint_model["model-rotation"]),"model-scale":new jt(Ve.paint_model["model-scale"]),"model-translation":new jt(Ve.paint_model["model-translation"]),"model-color":new jt(Ve.paint_model["model-color"]),"model-color-mix-intensity":new jt(Ve.paint_model["model-color-mix-intensity"]),"model-type":new yt(Ve.paint_model["model-type"]),"model-cast-shadows":new yt(Ve.paint_model["model-cast-shadows"]),"model-receive-shadows":new yt(Ve.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new yt(Ve.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new jt(Ve.paint_model["model-emissive-strength"]),"model-roughness":new jt(Ve.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new jt(Ve.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new yt(Ve.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new yt(Ve.paint_model["model-front-cutoff"])}),layout:TJ};const mp=64,L0={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function kz(i,r,s,c,h,p,m,x,b,S=!1){const I=s.zoom,P=s.project(c),D=cp(c.lat,I),F=1/D;a.ad.identity(i),a.ad.translate(i,i,[P.x+m[0]*F,P.y+m[1]*F,m[2]]);let U=1,V=1;const W=s.worldSize;if(S){if(s.projection.name==="mercator"){let he=0;s.elevation&&(he=s.elevation.getAtPointOrZero(new es(P.x/W,P.y/W),0));const Se=a.aA.transformMat4([],[P.x,P.y,he,1],s.projMatrix)[3]/s.cameraToCenterDistance;U=Se,V=Se*cp(s.center.lat,I)}else if(s.projection.name==="globe"){const he=H3(i,s),Se=a.ad.multiply([],s.projMatrix,he),be=[0,0,0,1];a.aA.transformMat4(be,be,Se);const ke=be[3]/s.cameraToCenterDistance,Le=Vu(I),je=s.projection.pixelsPerMeter(c.lat,W)*cp(c.lat,I),ot=s.projection.pixelsPerMeter(s.center.lat,W)*cp(s.center.lat,I);U=ke/_r(je,YL(s.center.lat),Le),V=ke*D/je,U*=ot,V*=ot}}else U=F;a.ad.scale(i,i,[U,U,V]);const ee=[...i],ce=r.orientation,ue=[];if(Az(ue,[ce[0]+h[0],ce[1]+h[1],ce[2]+h[2]],p),a.ad.multiply(i,ee,ue),x&&s.elevation){let he=0;const Se=[];if(b&&s.elevation){he=function(Le,je,ot,Ze,dt){const At=je.elevation;if(!At)return 0;const ct=di.projectAabbCorners(ot,Ze),bt=Ds(1,dt.lat)*je.worldSize,st=function(mr,jr){const Sr=[0,0,1],Wr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Vr of Wr){const Qr=mr[Vr.corners[0]],br=mr[Vr.corners[1]],Bn=mr[Vr.corners[2]],On=[br[0]-Qr[0],br[1]-Qr[1],jr*(br[2]-Qr[2])],bn=a._.cross(On,On,[Bn[0]-Qr[0],Bn[1]-Qr[1],jr*(Bn[2]-Qr[2])]);a._.normalize(bn,bn),Vr.dotProductWithUp=a._.dot(bn,Sr)}return Wr.sort((Vr,Qr)=>Vr.dotProductWithUp-Qr.dotProductWithUp),Wr[0].corners}(ct,bt),wt=ct[st[0]],Pt=ct[st[1]],Tt=ct[st[2]],Ht=ct[st[3]],It=At.getAtPointOrZero(new es(wt[0]/je.worldSize,wt[1]/je.worldSize),0),Dt=At.getAtPointOrZero(new es(Pt[0]/je.worldSize,Pt[1]/je.worldSize),0),fr=At.getAtPointOrZero(new es(Tt[0]/je.worldSize,Tt[1]/je.worldSize),0),lr=At.getAtPointOrZero(new es(Ht[0]/je.worldSize,Ht[1]/je.worldSize),0),sr=(It+lr)/2,Rt=(Dt+fr)/2;return sr>Rt?Dt<fr?Zw(Le,Pt,Ht,wt,Dt,lr,It,bt):Zw(Le,Tt,wt,Ht,fr,It,lr,bt):It<lr?Zw(Le,wt,Pt,Tt,It,Dt,fr,bt):Zw(Le,Ht,Tt,Pt,lr,fr,Dt,bt),Math.max(sr,Rt)}(Se,s,r.aabb,i,c);const be=a.ad.fromQuat([],Se),ke=a.ad.multiply([],be,ue);a.ad.multiply(i,ee,ke)}else he=s.elevation.getAtPointOrZero(new es(P.x/W,P.y/W),0);he!==0&&(i[14]+=he)}}function Iv(i,r,s=!1){i.uploaded||(i.gfxTexture=new pl(r,i.image,s?r.gl.R8:r.gl.RGBA,{useMipmap:i.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),i.uploaded=!0,i.image=null)}function IJ(i,r,s){i.indexBuffer=r.createIndexBuffer(i.indexArray,!1,!0),i.vertexBuffer=r.createVertexBuffer(i.vertexArray,vJ.members,!1,!0),i.normalArray&&(i.normalBuffer=r.createVertexBuffer(i.normalArray,CJ.members,!1,!0)),i.texcoordArray&&(i.texcoordBuffer=r.createVertexBuffer(i.texcoordArray,wJ.members,!1,!0)),i.colorArray&&(i.colorBuffer=r.createVertexBuffer(i.colorArray,(i.colorArray.bytesPerElement===12?xJ:bJ).members,!1,!0)),i.featureArray&&(i.pbrBuffer=r.createVertexBuffer(i.featureArray,SJ.members,!0)),i.segments=hi.simpleSegment(0,0,i.vertexArray.length,i.indexArray.length);const c=i.material;c.pbrMetallicRoughness.baseColorTexture&&Iv(c.pbrMetallicRoughness.baseColorTexture,r),c.pbrMetallicRoughness.metallicRoughnessTexture&&Iv(c.pbrMetallicRoughness.metallicRoughnessTexture,r),c.normalTexture&&Iv(c.normalTexture,r),c.occlusionTexture&&Iv(c.occlusionTexture,r,s),c.emissionTexture&&Iv(c.emissionTexture,r)}function W3(i,r,s){if(i.meshes)for(const c of i.meshes)IJ(c,r,s);if(i.children)for(const c of i.children)W3(c,r,s)}function Qw(i){if(i.meshes)for(const r of i.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(i.children)for(const r of i.children)Qw(r)}function q3(i){if(i.meshes)for(const s of i.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((r=s.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(i.children)for(const s of i.children)q3(s)}class MJ{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class PJ{constructor(){this.tasks={},this.taskQueue=[],km(["process"],this),this.invoker=new MJ(this.process),this.nextId=0}add(r,s){const c=this.nextId++,h=function({type:p,isSymbolTile:m,zoom:x}){return x=x||0,p==="message"?0:p!=="maybePrepare"||m?p!=="parseTile"||m?p==="parseTile"&&m?300-x:p==="maybePrepare"&&m?400-x:500:200-x:100-x}(s);if(h===0){try{r()}finally{}return null}return this.tasks[c]={fn:r,metadata:s,priority:h,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const s=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let r=null,s=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<s&&(s=p.priority,r=h)}if(r===null)return null;const c=this.taskQueue[r];return this.taskQueue.splice(r,1),c}remove(){this.invoker.remove()}}class Dz{constructor(r,s,c){this.target=r,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},km(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new PJ}send(r,s,c,h,p=!1,m){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=m,this.callbacks[x]=c);const b=new Set;return this.target.postMessage({id:x,type:r,hasCallback:!!c,targetMapId:h,mustQueue:p,sourceMapId:this.mapId,data:De(s,b)},b),{cancel:()=>{c&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(r){const s=r.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h.cancel()}else if(s.mustQueue||Ao()){const h=this.callbacks[c],p=this.scheduler.add(()=>this.processTask(c,s),h&&h.metadata||{type:"message"});p&&(this.cancelCallbacks[c]=p)}else this.processTask(c,s)}processTask(r,s){if(delete this.cancelCallbacks[r],s.type==="<response>"){const c=this.callbacks[r];delete this.callbacks[r],c&&(s.error?c(He(s.error)):c(null,He(s.data)))}else{const c=new Set,h=s.hasCallback?(m,x)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:m?De(m):null,data:De(x,c)},c)}:m=>{},p=He(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,p,h);else if(this.parent.getWorkerSource){const m=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,m[0],p.source,p.scope)[m[1]](p,h)}else h(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class B0{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=Pm();const c=this.workerPool.acquire(this.id);for(let h=0;h<c.length;h++){const p=new B0.Actor(c[h],s,this.id);p.name=`Worker ${h}`,this.actors.push(p)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,c){Mh(this.actors,(h,p)=>{h.send(r,s,p)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}B0.Actor=Dz;var Mv={workerUrl:"",workerClass:null,workerParams:void 0};function RJ(){return Mv.workerClass!=null?new Mv.workerClass:new self.Worker(Mv.workerUrl,Mv.workerParams)}const K3="mapboxgl_preloaded_worker_pool";class Pv{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Pv.workerCount;)this.workers.push(new RJ);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[K3]}numActive(){return Object.keys(this.active).length}}let Rv;function Jw(){return Rv||(Rv=new Pv),Rv}Pv.workerCount=2;let eC,Y3,ic,F0,Z3,z0=null;function Oz(){return Ao()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Y3||k.DRACO_URL}function Lz(){if(Ao()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(F0)return F0;const i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return F0=WebAssembly.validate(i)?k.MESHOPT_SIMD_URL:k.MESHOPT_URL,F0}const tC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kJ={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},kv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Bz(i,r,s){const c=s.json.bufferViews.length,h=s.buffers.length;r.bufferView=c,s.json.bufferViews[c]={buffer:h,byteLength:i.byteLength},s.buffers[h]=i}const X3="KHR_draco_mesh_compression";function DJ(i,r){const s=i.extensions&&i.extensions[X3];if(!s)return;const c=new ic.Decoder,h=Uz(r,s.bufferView),p=new ic.Mesh;if(!c.DecodeArrayToMesh(h,h.byteLength,p))throw new Error("Failed to decode Draco mesh");const m=r.json.accessors[i.indices],x=tC[m.componentType],b=m.count*x.BYTES_PER_ELEMENT,S=ic._malloc(b);x===Uint16Array?c.GetTrianglesUInt16Array(p,b,S):c.GetTrianglesUInt32Array(p,b,S),Bz(ic.memory.buffer.slice(S,S+b),m,r),ic._free(S);for(const I of Object.keys(s.attributes)){const P=c.GetAttributeByUniqueId(p,s.attributes[I]),D=r.json.accessors[i.attributes[I]],F=kJ[D.componentType],U=D.count*kv[D.type]*tC[D.componentType].BYTES_PER_ELEMENT,V=ic._malloc(U);c.GetAttributeDataArrayForAllPoints(p,P,ic[F],U,V),Bz(ic.memory.buffer.slice(V,V+U),D,r),ic._free(V)}c.destroy(),p.destroy(),delete i.extensions[X3]}const rC="EXT_meshopt_compression";function OJ(i,r){if(!i.extensions||!i.extensions[rC])return;const s=i.extensions[rC],c=new Uint8Array(r.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),h=new Uint8Array(s.count*s.byteStride);Z3.decodeGltfBuffer(h,s.count,s.byteStride,c,s.mode,s.filter),i.buffer=r.buffers.length,i.byteOffset=0,r.buffers[i.buffer]=h.buffer,delete i.extensions[rC]}const Fz=1179937895,zz=new TextDecoder("utf8");function Nz(i,r){return new URL(i,r).href}function LJ(i,r,s,c){return fetch(Nz(i.uri,c)).then(h=>h.arrayBuffer()).then(h=>{r.buffers[s]=h})}function Uz(i,r){const s=i.json.bufferViews[r];return new Uint8Array(i.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function BJ(i,r,s,c){if(i.uri){const h=Nz(i.uri,c);return fetch(h).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{r.images[s]=p})}if(i.bufferView!==void 0){const h=Uz(r,i.bufferView),p=new Blob([h],{type:i.mimeType});return createImageBitmap(p).then(m=>{r.images[s]=m})}}function $z(i,r=0,s){const c={json:null,images:[],buffers:[]};if(new Uint32Array(i,r,1)[0]===Fz){const I=new Uint32Array(i,r);let P=2;const D=(I[P++]>>2)-3,F=I[P++]>>2;if(P++,c.json=JSON.parse(zz.decode(I.subarray(P,P+F))),P+=F,P<D){const U=I[P++];P++;const V=r+(P<<2);c.buffers[0]=i.slice(V,V+U)}}else c.json=JSON.parse(zz.decode(new Uint8Array(i,r)));const{buffers:h,images:p,meshes:m,extensionsUsed:x,bufferViews:b}=c.json;let S=Promise.resolve();if(h){const I=[];for(let P=0;P<h.length;P++){const D=h[P];D.uri?I.push(LJ(D,c,P,s)):c.buffers[P]||(c.buffers[P]=null)}S=Promise.all(I)}return S.then(()=>{const I=[],P=x&&x.includes(X3),D=x&&x.includes(rC);if(P&&I.push(function(){if(!ic)return eC||(eC=function(F){let U,V=null;function W(){U=new Uint8Array(V.buffer)}function ee(){throw new Error("Unexpected Draco error.")}const ce={a:{a:ee,d:function(ue,he,Se){return U.copyWithin(ue,he,he+Se)},c:function(ue){const he=U.length,Se=Math.max(ue>>>0,Math.ceil(1.2*he)),be=Math.ceil((Se-he)/65536);try{return V.grow(be),W(),!0}catch{return!1}},b:ee}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(F,ce):F.then(ue=>ue.arrayBuffer()).then(ue=>WebAssembly.instantiate(ue,ce))).then(ue=>{const{Rb:he,Qb:Se,P:be,T:ke,X:Le,Ja:je,La:ot,Qa:Ze,Va:dt,Wa:At,eb:ct,jb:bt,f:st,e:wt,yb:Pt,zb:Tt,Ab:Ht,Bb:It,Db:Dt,Gb:fr}=ue.instance.exports;V=wt;const lr=(()=>{let sr=0,Rt=0,mr=0,jr=0;return Sr=>{mr&&(he(jr),he(sr),Rt+=mr,mr=sr=0),sr||(Rt+=128,sr=Se(Rt));const Wr=Sr.length+7&-8;let Vr=sr;Wr>=Rt&&(mr=Wr,Vr=jr=Se(Wr));for(let Qr=0;Qr<Sr.length;Qr++)U[Vr+Qr]=Sr[Qr];return Vr}})();return W(),st(),{memory:wt,_free:he,_malloc:Se,Mesh:class{constructor(){this.ptr=be()}destroy(){ke(this.ptr)}},Decoder:class{constructor(){this.ptr=je()}destroy(){bt(this.ptr)}DecodeArrayToMesh(sr,Rt,mr){const jr=lr(sr),Sr=ot(this.ptr,jr,Rt,mr.ptr);return!!Le(Sr)}GetAttributeByUniqueId(sr,Rt){return{ptr:Ze(this.ptr,sr.ptr,Rt)}}GetTrianglesUInt16Array(sr,Rt,mr){dt(this.ptr,sr.ptr,Rt,mr)}GetTrianglesUInt32Array(sr,Rt,mr){At(this.ptr,sr.ptr,Rt,mr)}GetAttributeDataArrayForAllPoints(sr,Rt,mr,jr,Sr){ct(this.ptr,sr.ptr,Rt.ptr,mr,jr,Sr)}},DT_INT8:Pt(),DT_UINT8:Tt(),DT_INT16:Ht(),DT_UINT16:It(),DT_UINT32:Dt(),DT_FLOAT32:fr()}})}(fetch(Oz())),eC.then(F=>{ic=F,eC=void 0}))}()),D&&I.push(function(){if(Z3)return;const F=function(U){let V;const W=WebAssembly.instantiateStreaming(U,{}).then(ue=>{V=ue.instance,V.exports.__wasm_call_ctors()}),ee={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ce={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(ue,he,Se,be,ke,Le){(function(je,ot,Ze,dt,At,ct,bt){const st=je.exports.sbrk,wt=dt+3&-4,Pt=st(wt*At),Tt=st(ct.length),Ht=new Uint8Array(je.exports.memory.buffer);Ht.set(ct,Tt);const It=ot(Pt,dt,At,Tt,ct.length);if(It===0&&bt&&bt(Pt,wt,At),Ze.set(Ht.subarray(Pt,Pt+dt*At)),st(Pt-st(0)),It!==0)throw new Error(`Malformed buffer data: ${It}`)})(V,V.exports[ce[ke]],ue,he,Se,be,V.exports[ee[Le]])}}}(fetch(Lz()));return F.ready.then(()=>{Z3=F})}()),p)for(let F=0;F<p.length;F++)I.push(BJ(p[F],c,F,s));return(I.length?Promise.all(I):Promise.resolve()).then(()=>{if(P&&m)for(const{primitives:F}of m)for(const U of F)DJ(U,c);if(D&&m&&b)for(const F of b)OJ(F,c);return c})})}function gp(i,r){const s=i.json.bufferViews[r.bufferView],c=tC[r.componentType];return new c(i.buffers[s.buffer],(r.byteOffset||0)+(s.byteOffset||0),r.count*(s.byteStride&&s.byteStride!==kv[r.type]*c.BYTES_PER_ELEMENT?s.byteStride/c.BYTES_PER_ELEMENT:kv[r.type]))}function Q3(i,r,s,c){const h=tC[r.componentType],p=function(I){switch(I){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(h),m=i.json.bufferViews[r.bufferView],x=m.byteStride?m.byteStride/h.BYTES_PER_ELEMENT:kv[r.type],b=s.float32,S=b.length/s.capacity;for(let I=0,P=0;I<r.count*x;I+=x,P+=S)for(let D=0;D<S;D++)b[P+D]=c[I+D]*p;s._trim()}function FJ(i,r,s){const c=i.indices,h=i.attributes,p={};p.indexArray=new vo;const m=r.json.accessors[c],x=m.count/3;p.indexArray.reserve(x);const b=gp(r,m);for(let D=0;D<x;D++)p.indexArray.emplaceBack(b[3*D],b[3*D+1],b[3*D+2]);p.indexArray._trim(),p.vertexArray=new td;const S=r.json.accessors[h.POSITION];p.vertexArray.reserve(S.count);const I=gp(r,S);for(let D=0;D<S.count;D++)p.vertexArray.emplaceBack(I[3*D],I[3*D+1],I[3*D+2]);if(p.vertexArray._trim(),p.aabb=new di(S.min,S.max),p.centroid=function(D,F){const U=[0,0,0],V=D.length;if(V>0){for(let W=0;W<V;W++){const ee=3*D[W];U[0]+=F[ee],U[1]+=F[ee+1],U[2]+=F[ee+2]}U[0]/=V,U[1]/=V,U[2]/=V}return U}(b,I),h.COLOR_0!==void 0){const D=r.json.accessors[h.COLOR_0],F=kv[D.type],U=gp(r,D);p.colorArray=F===3?new td:new ed,p.colorArray.resize(D.count),Q3(r,D,p.colorArray,U)}if(h.NORMAL!==void 0){p.normalArray=new td;const D=r.json.accessors[h.NORMAL];p.normalArray.resize(D.count);const F=gp(r,D);Q3(r,D,p.normalArray,F)}if(h.TEXCOORD_0!==void 0&&s.length>0){p.texcoordArray=new p0;const D=r.json.accessors[h.TEXCOORD_0];p.texcoordArray.resize(D.count);const F=gp(r,D);Q3(r,D,p.texcoordArray,F)}if(h._FEATURE_ID_RGBA4444!==void 0){const D=r.json.accessors[h._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(p.featureData=gp(r,D))}h._FEATURE_RGBA4444!==void 0&&(p.featureData=new Uint32Array(gp(r,r.json.accessors[h._FEATURE_RGBA4444]).buffer));const P=i.material;return p.material=function(D,F){const{emissiveFactor:U=[0,0,0],alphaMode:V="OPAQUE",alphaCutoff:W=.5,normalTexture:ee,occlusionTexture:ce,emissiveTexture:ue,doubleSided:he}=D,{baseColorFactor:Se=[1,1,1,1],metallicFactor:be=1,roughnessFactor:ke=1,baseColorTexture:Le,metallicRoughnessTexture:je}=D.pbrMetallicRoughness||{},ot=ce?F[ce.index]:void 0;if(ce&&ce.extensions&&ce.extensions.KHR_texture_transform&&ot){const Ze=ce.extensions.KHR_texture_transform;ot.offsetScale=[Ze.offset[0],Ze.offset[1],Ze.scale[0],Ze.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new yn(...Se),metallicFactor:be,roughnessFactor:ke,baseColorTexture:Le?F[Le.index]:void 0,metallicRoughnessTexture:je?F[je.index]:void 0},doubleSided:he,emissiveFactor:U,alphaMode:V,alphaCutoff:W,normalTexture:ee?F[ee.index]:void 0,occlusionTexture:ot,emissionTexture:ue?F[ue.index]:void 0,defined:D.defined===void 0}}(P!==void 0?r.json.materials[P]:{defined:!1},s),p}function jz(i,r,s){const{matrix:c,rotation:h,translation:p,scale:m,mesh:x,extras:b,children:S}=i,I={};if(I.matrix=c||a.ad.fromRotationTranslationScale([],h||[0,0,0,1],p||[0,0,0],m||[1,1,1]),x!==void 0){I.meshes=s[x];const P=I.anchor=[0,0];for(const D of I.meshes){const{min:F,max:U}=D.aabb;P[0]+=F[0]+U[0],P[1]+=F[1]+U[1]}P[0]=Math.floor(P[0]/I.meshes.length/2),P[1]=Math.floor(P[1]/I.meshes.length/2)}if(b&&(b.id&&(I.id=b.id),b.lights&&(I.lights=function(P){if(!P.length)return[];const D=function(ee){const ce=atob(ee),ue=new Uint8Array(ce.length);for(let he=0;he<ce.length;he++)ue[he]=ce.codePointAt(he);return ue}(P),F=[],U=D.length/24,V=new Uint16Array(D.buffer),W=new Float32Array(D.buffer);for(let ee=0;ee<U;ee++){const ce=V[2*ee*6]/30,ue=V[2*ee*6+1]/30,he=V[2*ee*6+10]/100,Se=W[6*ee+1],be=W[6*ee+2],ke=W[6*ee+3],Le=W[6*ee+4],je=ke-Se,ot=Le-be,Ze=Math.hypot(je,ot);F.push({pos:[Se+.5*je,be+.5*ot,ue],normal:[ot/Ze,-je/Ze,0],width:Ze,height:ce,depth:he,points:[Se,be,ke,Le]})}return F}(b.lights))),S){const P=[];for(const D of S)P.push(jz(r.json.nodes[D],r,s));I.children=P}return I}function zJ(i){if(i.vertices.length===0||i.indices.length===0)return null;const r=new g3(i.vertices,i.indices,8,256),[s,c]=[r.min.clone(),r.max.clone()];return{vertices:i.vertices,indices:i.indices,grid:r,min:s,max:c}}function NJ(i){if(!i.extras||!i.extras.ground)return null;const r=i.extras.ground;if(!r||!Array.isArray(r)||r.length===0)return null;const s=r[0];if(!s||!Array.isArray(s)||s.length===0)return null;const c=[];for(const m of s){if(!Array.isArray(m)||m.length!==2)continue;const x=m[0],b=m[1];typeof x=="number"&&typeof b=="number"&&c.push(new Ut(x,b))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let h=0;for(let m=0;m<c.length;m++){const x=c[m],b=c[(m+1)%c.length],S=c[(m+2)%c.length];h+=(x.x-b.x)*(S.y-b.y)-(S.x-b.x)*(x.y-b.y)}h>0&&c.reverse();const p=lv(c.flatMap(m=>[m.x,m.y]),[]);return p.length===0?null:{vertices:c,indices:p}}function UJ(i,r){const s=[],c=[];let h=0;const p=[];for(const m of i){h=s.length;const x=m.vertexArray.float32,b=m.indexArray.uint16;for(let S=0;S<m.vertexArray.length;S++)p[0]=x[3*S+0],p[1]=x[3*S+1],p[2]=x[3*S+2],a._.transformMat4(p,p,r),s.push(new Ut(p[0],p[1]));for(let S=0;S<3*m.indexArray.length;S++)c.push(b[S]+h)}if(c.length%3!=0)return null;for(let m=0;m<c.length;m+=3){const x=s[c[m+0]],b=s[c[m+1]],S=s[c[m+2]];(x.x-b.x)*(S.y-b.y)-(S.x-b.x)*(x.y-b.y)>0&&([c[m+1],c[m+2]]=[c[m+2],c[m+1]])}return{vertices:s,indices:c}}function Vz(i){const r=function(b,S){const I=[],P=WebGL2RenderingContext;if(b.json.textures)for(const D of b.json.textures){const F={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};D.sampler!==void 0&&Object.assign(F,b.json.samplers[D.sampler]),I.push({image:S[D.source],sampler:F,uploaded:!1})}return I}(i,i.images),s=function(b,S){const I=[];for(const P of b.json.meshes){const D=[];for(const F of P.primitives)D.push(FJ(F,b,S));I.push(D)}return I}(i,r),{scenes:c,scene:h,nodes:p}=i.json,m=c?c[h||0].nodes:p,x=[];for(const b of m)x.push(jz(p[b],i,s));return function(b,S,I){const P={},D=new Set;for(let F=0;F<b.length;F++){const U=I[S[F]];if(!U.extras)continue;const V=U.extras["mapbox:footprint:version"],W=U.extras["mapbox:footprint:id"];(V||W)&&D.add(F),V==="1.0.0"&&W&&(P[W]=F)}for(let F=0;F<b.length;F++){if(D.has(F))continue;const U=b[F],V=I[S[F]];if(!V.extras)continue;let W=null;U.id in P&&(W=UJ(b[P[U.id]].meshes,U.matrix)),W||(W=NJ(V)),W&&(U.footprint=zJ(W))}if(D.size>0){const F=Array.from(D.values()).sort((U,V)=>U-V);for(let U=F.length-1;U>=0;U--)b.splice(F[U],1)}}(x,m,i.json.nodes),x}function $J(i){i.heightmap=new Float32Array(4096),i.heightmap.fill(-1);const r=i.vertexArray.float32,s=i.aabb.min[0]-1,c=i.aabb.min[1]-1,h=mp/(i.aabb.max[0]-s+2),p=mp/(i.aabb.max[1]-c+2);for(let m=0;m<r.length;m+=3){const x=r[m+2],b=(r[m+0]-s)*h|0,S=(r[m+1]-c)*p|0;x>i.heightmap[S*mp+b]&&(i.heightmap[S*mp+b]=x)}}function jJ(i,r){const s={};s.indexArray=new vo,s.indexArray.reserve(4*i.length),s.vertexArray=new td,s.vertexArray.reserve(10*i.length),s.colorArray=new ed,s.vertexArray.reserve(10*i.length);let c=0;for(const m of i){const x=Math.min(10,Math.max(4,1.3*m.height))*r,b=[-m.normal[1],m.normal[0],0],S=Math.min(.29,.1*m.width/m.depth),I=m.width-2*m.depth*r*(S+.01),P=a._.scaleAndAdd([],m.pos,b,I/2),D=a._.scaleAndAdd([],m.pos,b,-I/2),F=[P[0],P[1],P[2]+m.height],U=[D[0],D[1],D[2]+m.height],V=a._.scaleAndAdd([],m.normal,b,S);a._.scale(V,V,x);const W=a._.scaleAndAdd([],m.normal,b,-S);a._.scale(W,W,x),a._.add(V,P,V),a._.add(W,D,W),P[2]+=.1,D[2]+=.1,s.vertexArray.emplaceBack(V[0],V[1],V[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(F[0],F[1],F[2]),s.vertexArray.emplaceBack(U[0],U[1],U[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(V[0],V[1],V[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]);const ee=I/x/2;s.colorArray.emplaceBack(-ee-S,-1,ee,.8),s.colorArray.emplaceBack(ee+S,-1,ee,.8),s.colorArray.emplaceBack(-ee,0,ee,1.3),s.colorArray.emplaceBack(ee,0,ee,1.3),s.colorArray.emplaceBack(ee+S,-.8,ee,.7),s.colorArray.emplaceBack(ee+S,-.8,ee,.7),s.colorArray.emplaceBack(0,0,ee,1.3),s.colorArray.emplaceBack(0,0,ee,1.3),s.colorArray.emplaceBack(ee+S,-1.2,ee,.8),s.colorArray.emplaceBack(ee+S,-1.2,ee,.8),s.indexArray.emplaceBack(6+c,4+c,8+c),s.indexArray.emplaceBack(7+c,9+c,5+c),s.indexArray.emplaceBack(0+c,1+c,2+c),s.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const h={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=yn.white,h.pbrMetallicRoughness=p,s.material=h,s.aabb=new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}const J3=new Float32Array(262144),_p=new Uint8Array(262144);function Hz(i){let r=0;if(i.meshes)for(const s of i.meshes)r=Math.max(r,s.aabb.max[2]);if(i.children)for(const s of i.children)r=Math.max(r,Hz(s));return r}function Gz(i,r,s){if(i.meshes)for(const c of i.meshes)c.aabb.min[0]!==1/0&&s.insert(r,c.aabb.min[0],c.aabb.min[1],c.aabb.max[0],c.aabb.max[1]);if(i.children)for(const c of i.children)Gz(c,r,s)}const Wz=["","wall","door","roof","window","lamp","logo"];class qz{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:r.id,geometry:[],properties:{height:Hz(r)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const s=new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==r&&(c.transformedAabb=di.applyTransform(c.aabb,this.node.matrix),s.encapsulate(c.transformedAabb)),r++;this.aabb=s}return this.aabb}}class nC{constructor(r,s,c,h,p,m){this.id=s,this.modelTraits|=L0.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=L0.HasMapboxMeshFeatures),h&&(this.modelTraits|=L0.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=p,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const x of r)this.nodesInfo.push(new qz(x)),Gz(x,m.featureIndexArray.length,m.grid),m.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,m.bucketLayerIDs.length-1,0)}updateFootprints(r,s){for(const c of this.getNodesInfo()){const h=c.node;h.footprint&&s.push({footprint:h.footprint,id:r})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const c of s){const h=c.node;this.uploaded?this.updatePbrBuffer(h):W3(h,r,!0)}for(const c of s)Qw(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let s=!1;if(!r.meshes)return s;for(const c of r.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),s=!0);return s}needsReEvaluation(r,s,c){const h=r.transform.projectionOptions,p=r.style.getBrightness(),m=this.brightness!==p;return!!(!this.uploaded||this.dirty||h.name!==this.projection.name||Dv(c.paint.get("model-color").value,m)||Dv(c.paint.get("model-color-mix-intensity").value,m)||Dv(c.paint.get("model-roughness").value,m)||Dv(c.paint.get("model-emissive-strength").value,m)||Dv(c.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=h,this.brightness=p,!0)}evaluateScale(r,s){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const c=this.getNodesInfo(),h=this.id.canonical;for(const p of c){const m=p.feature;p.evaluatedScale=s.paint.get("model-scale").evaluate(m,{},h)}}evaluate(r){const s=this.getNodesInfo();for(const c of s){if(!c.node.meshes)continue;const h=c.feature,p=c.node.meshes&&c.node.meshes[0].featureData,m=c.evaluatedColor[2],x=c.evaluatedRMEA[2],b=this.id.canonical;if(c.hasTranslucentParts=!1,p){for(let S=0;S<Wz.length;S++){const I=Wz[S];I.length&&(h.properties.part=I);const P=r.paint.get("model-color").evaluate(h,{},b).toRenderColor(null),D=r.paint.get("model-color-mix-intensity").evaluate(h,{},b);c.evaluatedColor[S]=[P.r,P.g,P.b,D],c.evaluatedRMEA[S][0]=r.paint.get("model-roughness").evaluate(h,{},b),c.evaluatedRMEA[S][2]=r.paint.get("model-emissive-strength").evaluate(h,{},b),c.evaluatedRMEA[S][3]=P.a,c.emissionHeightBasedParams[S]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,{},b),!c.hasTranslucentParts&&P.a<1&&(c.hasTranslucentParts=!0)}delete h.properties.part,HJ(c,m!==c.evaluatedColor[2]||x!==c.evaluatedRMEA[2],this.modelTraits)}else c.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(h,{},b);c.evaluatedScale=r.paint.get("model-scale").evaluate(h,{},b),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,s,c,h){const p=r.findDEMTileFor(c);if(p&&(p.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const m=C0.create(r,c,p);if(!m)return;this.modelTraits&L0.HasMapboxMeshFeatures&&this.updateDEM(r,m,c,h);for(const x of this.getNodesInfo()){const b=x.node;if(!b.footprint||!b.footprint.vertices||!b.footprint.vertices.length)continue;const S=b.footprint.vertices;let I=m.getElevationAt(S[0].x,S[0].y,!0,!0);for(let P=1;P<S.length;P++)I=Math.min(I,m.getElevationAt(S[P].x,S[P].y,!0,!0));b.elevation=I}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=s}}updateDEM(r,s,c,h){let p=s._dem._modifiedForSources[h];if(p===void 0&&(s._dem._modifiedForSources[h]=[],p=s._dem._modifiedForSources[h]),p.includes(c.canonical))return;const m=s._dem.dim;p.push(c.canonical);let x=!1;for(const b of this.getNodesInfo()){const S=b.node;if(!S.footprint||!S.footprint.grid)continue;const I=S.footprint.grid,P=s.tileCoordToPixel(I.min.x,I.min.y),D=s.tileCoordToPixel(I.max.x,I.max.y),F=Math.min(Math.min(m-D.y,P.x),Math.min(P.y,m-D.x));if(F<0)continue;const U=Kr(F,2,5);let V=Math.max(0,P.x-U),W=Math.max(0,P.y-U),ee=Math.min(D.x+U,m-1),ce=Math.min(D.y+U,m-1);for(let be=W;be<=ce;++be)for(let ke=V;ke<=ee;++ke)_p[be*m+ke]=255;let ue=0,he=0;for(let be=0;be<I.cellsY;++be)for(let ke=0;ke<I.cellsX;++ke){if(!I.cells[be*I.cellsX+ke])continue;const Le=s.tileCoordToPixel(I.min.x+ke/I.xScale,I.min.y+be/I.yScale),je=s.tileCoordToPixel(I.min.x+(ke+1)/I.xScale,I.min.y+(be+1)/I.yScale);for(let ot=Le.y;ot<=Math.min(je.y+1,m-1);++ot)for(let Ze=Le.x;Ze<=Math.min(je.x+1,m-1);++Ze)_p[ot*m+Ze]===255&&(_p[ot*m+Ze]=0,ue+=s.getElevationAtPixel(Ze,ot),he++)}const Se=ue/he;V=Math.max(1,P.x-U),W=Math.max(1,P.y-U),ee=Math.min(D.x+U,m-2),ce=Math.min(D.y+U,m-2),x=!0;for(let be=W;be<=ce;++be)for(let ke=V;ke<=ee;++ke)_p[be*m+ke]===0&&(J3[be*m+ke]=s._dem.set(ke,be,Se));for(let be=1;be<U;++be){V=Math.max(1,P.x-be),W=Math.max(1,P.y-be),ee=Math.min(D.x+be,m-2),ce=Math.min(D.y+be,m-2);for(let ke=W;ke<=ce;++ke)for(let Le=V;Le<=ee;++Le){const je=ke*m+Le;if(_p[je]===255){let ot=0,Ze=0,dt=-1,At=-1;for(let ct=-1;ct<=1;++ct)for(let bt=-1;bt<=1;++bt){const st=(ke+ct)*m+Le+bt;if(_p[st]>=be)continue;const wt=J3[st],Pt=Math.abs(wt);Pt>Ze&&(ot=wt,Ze=Pt,dt=bt,At=ct)}if(Ze>.1){const ct=1-(be+.5*Math.abs(dt*At))/U;let bt=s._dem.get(Le,ke)+ot*ct;const st=s._dem.get(Le+dt,ke+At),wt=s._dem.get(Le-dt,ke-At,!0);(bt-st)*(bt-wt)>0&&(bt=(st+wt)/2),J3[je]=s._dem.set(Le,ke,bt),_p[je]=be}}}}}x&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Io.now())}getNodesInfo(){return this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const s of r)Qw(s.node),q3(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(r.toUnwrapped()),h=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const m=h[p].node;h[p].hiddenByReplacement=!!m.footprint&&!c.find(x=>x.footprint===m.footprint)}}getHeightAtTileCoord(r,s){const c=this.getNodesInfo(),h=[],p=[0,0,0],m=a.ad.identity([]);for(let x=0;x<this.nodesInfo.length;x++){const b=c[x],S=b.node.meshes[0],I=S.transformedAabb;if(r<I.min[0]||s<I.min[1]||r>I.max[0]||s>I.max[1])continue;if(b.node.hidden===!0)return{height:0,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};a.ad.invert(m,b.node.matrix),p[0]=r,p[1]=s,a._.transformMat4(p,p,m);const P=(p[0]-S.aabb.min[0])/(S.aabb.max[0]-S.aabb.min[0])*mp|0,D=Math.min(63,(p[1]-S.aabb.min[1])/(S.aabb.max[1]-S.aabb.min[1])*mp|0)*mp+Math.min(63,P),F=S.heightmap[D];if(!(F<0&&b.node.footprint))return b.hiddenByReplacement?void 0:{height:F,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};if(b.node.footprint.grid.query(new Ut(r,s),new Ut(r,s),h),h.length>0)return{height:void 0,maxHeight:b.feature.properties.height,hidden:b.hiddenByReplacement,verticalScale:b.evaluatedScale[2]}}}}function Dv(i,r){return!i.isLightConstant&&r}function VJ(i,r,s,c,h,p,m,x){let b=(61440&r|(61440&r)>>4)>>8,S=(3840&r|(3840&r)>>4)>>4,I=240&r|(240&r)>>4;s[3]>0&&(b=_r(b,255*s[0],s[3]),S=_r(S,255*s[1],s[3]),I=_r(I,255*s[2],s[3]));const P=b<<8|S,D=I<<8|Math.floor(255*c[3]),F=function(be){const ke=Kr(be,0,2);return Math.min(Math.round(.5*ke*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],U=Kr(h[0],0,1),V=Kr(h[1],0,1),W=Kr(h[2],0,1),ee=Kr(h[3],0,1);let ce,ue,he,Se;if(U!==V&&m!==p&&V!==U){const be=m-p;ue=1/(be*(V-U)),he=-(p+be*U)/(be*(V-U));const ke=Kr(h[4],-1,1);Se=Math.pow(10,ke),ce=255*W<<8|255*ee}else ce=65535,ue=0,he=1,Se=1;if(i.emplaceBack(P,D,F,ce,ue,he,Se),x){const be=x.length;x.clear();for(let ke=0;ke<be;ke++)x.emplaceBack(P,D,F,ce,ue,he,Se)}}function HJ(i,r,s){const c=i.node;let h=0;const p=s&L0.HasMeshoptCompression;for(const m of c.meshes){if(c.lights&&c.lightMeshIndex===h||!m.featureData)continue;m.featureArray=new nw,m.featureArray.reserve(m.featureData.length);let x=r;for(const b of m.featureData){const S=p?65535&b:b>>16&65535,I=p?b>>16&65535:65535&b,P=(15&I)<8?15&I:0,D=i.evaluatedRMEA[P],F=i.evaluatedColor[P],U=i.emissionHeightBasedParams[P];let V;if(x&&P===2&&c.lights&&(V=new nw,V.resize(10*c.lights.length)),VJ(m.featureArray,S,F,D,U,m.aabb.min[2],m.aabb.max[2],V),V&&x){x=!1;const W=c.meshes[c.lightMeshIndex];W.featureArray=V,W.featureArray._trim()}}m.featureArray._trim(),h++}}function Kz(i,r,s,c){const h=1<<i.z;r.lat=Ro((c/Bt+i.y)/h),r.lng=Ys((s/Bt+i.x)/h)}pe(nC,"Tiled3dModelBucket",{omit:["layers"]}),pe(qz,"Tiled3dModelFeature");const GJ={circle:class extends Qi{constructor(i,r,s,c){super(i,kZ,r,s,c)}createBucket(i){return new QI(i)}queryRadius(i){const r=i;return x0("circle-radius",this,r)+x0("circle-stroke-width",this,r)+cw(this.paint.get("circle-translate"))}queryIntersectsFeature(i,r,s,c,h,p,m,x){const b=iB(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s);return vB(i,c,p,m,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,S)}getProgramIds(){return["circle"]}getDefaultProgramParams(i,r,s){const c=yB(this);return{config:new sp(this,{zoom:r,lut:s}),defines:c,overrideFog:!1}}},heatmap:class extends Qi{createBucket(i){return new bB(i)}constructor(i,r,s,c){super(i,VZ,r,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=av({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return x0("heatmap-radius",this,i)}queryIntersectsFeature(i,r,s,c,h,p,m,x){const b=this.paint.get("heatmap-radius").evaluate(r,s);return vB(i,c,p,m,x,!0,!0,new Ut(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(i,r,s){return i==="heatmap"?{config:new sp(this,{zoom:r,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Qi{constructor(i,r,s,c){super(i,GZ,r,s,c)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(i,r,s){return{overrideFog:!1}}},fill:class extends Qi{constructor(i,r,s,c){super(i,oX,r,s,c)}getProgramIds(){const i=this.paint.get("fill-pattern"),r=i&&i.constantOr(1),s=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(i,r,s){return{config:new sp(this,{zoom:r,lut:s}),overrideFog:!1}}recalculate(i,r){super.recalculate(i,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new yw(i)}queryRadius(){return cw(this.paint.get("fill-translate"))}queryIntersectsFeature(i,r,s,c,h,p){return!i.queryGeometry.isAboveHorizon&&JL(nB(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Qi{constructor(i,r,s,c){super(i,LX,r,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new Sw(i)}queryRadius(){return cw(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(i,r,s,c,h,p,m,x,b){const S=iB(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),I=this.paint.get("fill-extrusion-height").evaluate(r,s),P=this.paint.get("fill-extrusion-base").evaluate(r,s),D=[0,0],F=x&&p.elevation,U=p.elevation?p.elevation.exaggeration():1,V=i.tile.getBucket(this);if(F&&V instanceof Sw){const he=V.centroidVertexArray,Se=b+1;Se<he.length&&(D[0]=he.geta_centroid_pos0(Se),D[1]=he.geta_centroid_pos1(Se))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(c=lF([c],[new Ut(0,0),new Ut(Bt,Bt)],i.tileID.canonical).map(he=>he.polygon).flat());const W=F?x:null,[ee,ce]=function(he,Se,be,ke,Le,je,ot,Ze,dt,At,ct){return he.projection.name==="globe"?function(bt,st,wt,Pt,Tt,Ht,It,Dt,fr,lr,sr){const Rt=[],mr=[],jr=bt.projection.upVectorScale(sr,bt.center.lat,bt.worldSize).metersToTile,Sr=[0,0,0,1],Wr=[0,0,0,1],Vr=(br,Bn,On,bn)=>{br[0]=Bn,br[1]=On,br[2]=bn,br[3]=1},Qr=aF();wt>0&&(wt+=Qr),Pt+=Qr;for(const br of st){const Bn=[],On=[];for(const bn of br){const cn=bn.x+Tt.x,wn=bn.y+Tt.y,Qn=bt.projection.projectTilePoint(cn,wn,sr),$n=bt.projection.upVector(sr,bn.x,bn.y);let pi=wt,fi=Pt;if(It){const ts=uF(cn,wn,wt,Pt,It,Dt,fr,lr);pi+=ts.base,fi+=ts.top}wt!==0?Vr(Sr,Qn.x+$n[0]*jr*pi,Qn.y+$n[1]*jr*pi,Qn.z+$n[2]*jr*pi):Vr(Sr,Qn.x,Qn.y,Qn.z),Vr(Wr,Qn.x+$n[0]*jr*fi,Qn.y+$n[1]*jr*fi,Qn.z+$n[2]*jr*fi),a._.transformMat4(Sr,Sr,Ht),a._.transformMat4(Wr,Wr,Ht),Bn.push(new hp(Sr[0],Sr[1],Sr[2])),On.push(new hp(Wr[0],Wr[1],Wr[2]))}Rt.push(Bn),mr.push(On)}return[Rt,mr]}(he,Se,be,ke,Le,je,ot,Ze,dt,At,ct):ot?function(bt,st,wt,Pt,Tt,Ht,It,Dt,fr){const lr=[],sr=[],Rt=[0,0,0,1];for(const mr of bt){const jr=[],Sr=[];for(const Wr of mr){const Vr=Wr.x+Pt.x,Qr=Wr.y+Pt.y,br=uF(Vr,Qr,st,wt,Ht,It,Dt,fr);Rt[0]=Vr,Rt[1]=Qr,Rt[2]=br.base,Rt[3]=1,a.aA.transformMat4(Rt,Rt,Tt),Rt[3]=Math.max(Rt[3],1e-5);const Bn=new hp(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=Vr,Rt[1]=Qr,Rt[2]=br.top,Rt[3]=1,a.aA.transformMat4(Rt,Rt,Tt),Rt[3]=Math.max(Rt[3],1e-5);const On=new hp(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);jr.push(Bn),Sr.push(On)}lr.push(jr),sr.push(Sr)}return[lr,sr]}(Se,be,ke,Le,je,ot,Ze,dt,At):function(bt,st,wt,Pt,Tt){const Ht=[],It=[],Dt=Tt[8]*st,fr=Tt[9]*st,lr=Tt[10]*st,sr=Tt[11]*st,Rt=Tt[8]*wt,mr=Tt[9]*wt,jr=Tt[10]*wt,Sr=Tt[11]*wt;for(const Wr of bt){const Vr=[],Qr=[];for(const br of Wr){const Bn=br.x+Pt.x,On=br.y+Pt.y,bn=Tt[0]*Bn+Tt[4]*On+Tt[12],cn=Tt[1]*Bn+Tt[5]*On+Tt[13],wn=Tt[2]*Bn+Tt[6]*On+Tt[14],Qn=Tt[3]*Bn+Tt[7]*On+Tt[15],$n=bn+Dt,pi=cn+fr,fi=wn+lr,ts=Math.max(Qn+sr,1e-5),Ti=bn+Rt,oi=cn+mr,Vi=wn+jr,ko=Math.max(Qn+Sr,1e-5);Vr.push(new hp($n/ts,pi/ts,fi/ts)),Qr.push(new hp(Ti/ko,oi/ko,Vi/ko))}Ht.push(Vr),It.push(Qr)}return[Ht,It]}(Se,be,ke,Le,je)}(p,c,P,I,S,m,W,D,U,p.center.lat,i.tileID.canonical),ue=i.queryGeometry;return function(he,Se,be){let ke=1/0;JL(be,Se)&&(ke=cF(be,Se[0]));for(let Le=0;Le<Se.length;Le++){const je=Se[Le],ot=he[Le];for(let Ze=0;Ze<je.length-1;Ze++){const dt=je[Ze],At=[dt,je[Ze+1],ot[Ze+1],ot[Ze],dt];JI(be,At)&&(ke=Math.min(ke,cF(be,At)))}}return ke!==1/0&&ke}(ee,ce,ue.isPointQuery()?ue.screenBounds:ue.screenGeometry)}},line:class extends Qi{constructor(i,r,s,c){super(i,Aw,r,s,c),Aw.layout&&(this.layout=new Dn(Aw.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Jf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,r){super.recalculate(i,r),this.paint._values["line-floorwidth"]=gz.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Tw(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(i,r,s){const c=yF(this);return{config:new sp(this,{zoom:r,lut:s}),defines:c,overrideFog:!1}}queryRadius(i){const r=i,s=_z(x0("line-width",this,r),x0("line-gap-width",this,r)),c=x0("line-offset",this,r);return s/2+Math.abs(c)+cw(this.paint.get("line-translate"))}queryIntersectsFeature(i,r,s,c,h,p){if(i.queryGeometry.isAboveHorizon)return!1;const m=nB(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),x=i.pixelToTileUnitsFactor/2*_z(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),b=this.paint.get("line-offset").evaluate(r,s);return b&&(c=function(S,I){const P=[],D=new Ut(0,0);for(let F=0;F<S.length;F++){const U=S[F],V=[];for(let W=0;W<U.length;W++){const ee=U[W],ce=U[W+1],ue=W===0?D:ee.sub(U[W-1])._unit()._perp(),he=W===U.length-1?D:ce.sub(ee)._unit()._perp(),Se=ue._add(he)._unit();Se._mult(1/(Se.x*he.x+Se.y*he.y)),V.push(Se._mult(I)._add(ee))}P.push(V)}return P}(c,b*i.pixelToTileUnitsFactor)),function(S,I,P){for(let D=0;D<I.length;D++){const F=I[D];if(S.length>=3){for(let U=0;U<F.length;U++)if(ad(S,F[U]))return!0}if(IZ(S,F,P))return!0}return!1}(m,c,x)}isTileClipped(){return!0}isDraped(i){const r=this.layout.get("line-z-offset");return r.isConstant()&&!r.constantOr(0)}},symbol:Ww,background:class extends Qi{constructor(i,r,s,c){super(i,cJ,r,s,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(i,r,s){return{overrideFog:!1}}},raster:bz,"raster-particle":wz,sky:class extends Qi{constructor(i,r,s,c){super(i,_J,r,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=av({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(i,r){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),h=!c,p=i.style.light,m=p.properties.get("position");return h&&p.properties.get("anchor")==="viewport"&&Pi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?V3(m.azimuthal,90-m.polar,r):V3(c[0],90-c[1],r)}const s=this.paint.get("sky-gradient-center");return V3(s[0],90-s[1],r)}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}},slot:class extends Qi{constructor(i,r,s,c){super(i,yJ,r,null)}},model:class extends Qi{constructor(i,r,s,c){super(i,AJ,r,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new G3(i)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(i){return i instanceof nC?Bt-1:0}queryIntersectsFeature(i,r,s,c,h,p){if(!this.modelManager)return!1;const m=this.modelManager,x=i.tile.getBucket(this);if(!(x&&x instanceof G3))return!1;const b=x;for(const S in b.instancesPerModel){const I=b.instancesPerModel[S],P=r.id!==void 0?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(I.idToFeaturesIndex.hasOwnProperty(P)){const D=I.features[I.idToFeaturesIndex[P]],F=m.getModel(S,this.scope);if(!F)return!1;let U=a.ad.create();const V=new gn(0,0),W=b.canonical;let ee=Number.MAX_VALUE;for(let ce=0;ce<D.instancedDataCount;++ce){const ue=16*(D.instancedDataOffset+ce),he=I.instancedDataArray.float32,Se=[he[ue+4],he[ue+5],he[ue+6]];Kz(W,V,he[ue],0|he[ue+1]),kz(U,F,p,V,D.rotation,D.scale,Se,!1,!1,!1),p.projection.name==="globe"&&(U=H3(U,p));const be=a.ad.multiply([],p.projMatrix,U),ke=i.queryGeometry,Le=Iz(ke.isPointQuery()?ke.screenBounds:ke.screenGeometry,p,be,F.aabb);Le!=null&&(ee=Math.min(Le,ee))}return ee!==Number.MAX_VALUE&&ee}}return!1}_handleOverridablePaintPropertyUpdate(i,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven()||i!=="model-color"&&i!=="model-color-mix-intensity"&&i!=="model-rotation"&&i!=="model-scale"&&i!=="model-translation"&&i!=="model-emissive-strength")}_isPropertyZoomDependent(i){const r=this._transitionablePaint._values[i];return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof ne}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(i,r,s,c){const h=i.tile,p=h.getBucket(this);let m=null,x=Number.MAX_VALUE;if(!(p&&p instanceof nC))return{queryFeature:m,intersectionZ:x};const b=p.getNodesInfo()[r];if(b.hiddenByReplacement||!b.node.meshes||!s.filter(new Mr(h.tileID.overscaledZ),b.feature,h.tileID.canonical))return{queryFeature:m,intersectionZ:x};const S=b.node,I=c.calculatePosMatrix(h.tileID.toUnwrapped(),c.worldSize),P=b.evaluatedScale;let D=0;c.elevation&&S.elevation&&(D=S.elevation*c.elevation.exaggeration()),a.ad.translate(I,I,[(S.anchor?S.anchor[0]:0)*(P[0]-1),(S.anchor?S.anchor[1]:0)*(P[1]-1),D]),a.ad.scale(I,I,P),a.ad.multiply(I,I,S.matrix);const F=i.queryGeometry,U=F.isPointQuery()?F.screenBounds:F.screenGeometry,V=function(ee){const ce=a.ad.multiply([],I,ee.matrix),ue=a.ad.multiply(ce,c.expandedFarZProjMatrix,ce);for(let he=0;he<ee.meshes.length;++he){const Se=ee.meshes[he];if(he===ee.lightMeshIndex)continue;const be=Iz(U,c,ue,Se.aabb);be!=null&&(x=Math.min(be,x))}if(ee.children)for(const he of ee.children)V(he)};if(V(S),x===Number.MAX_VALUE)return{queryFeature:m,intersectionZ:x};const W=new gn(0,0);return Kz(h.tileID.canonical,W,b.node.anchor[0],b.node.anchor[1]),m={type:"Feature",geometry:{type:"Point",coordinates:[W.lng,W.lat]},properties:b.feature.properties,id:b.feature.id,state:{},layer:this.serialize()},{queryFeature:m,intersectionZ:x}}},clip:class extends Qi{constructor(i,r,s,c){super(i,aX,r,s,c)}recalculate(i,r){super.recalculate(i,r)}createBucket(i){return new MB(i)}isTileClipped(){return!0}is3D(){return!0}}};pe(fz,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const Yz=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class eM{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=c>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const p=Yz[15&c];if(!p)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(r,2,1),[x]=new Uint32Array(r,4,1);return new eM(x,m,p,r)}constructor(r,s=64,c=Float64Array,h){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const p=Yz.indexOf(this.ArrayType),m=2*r*this.ArrayType.BYTES_PER_ELEMENT,x=r*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-x%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${c}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+b,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+m+x+b),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+b,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=s,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return tM(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:m,nodeSize:x}=this,b=[0,p.length-1,0],S=[];for(;b.length;){const I=b.pop()||0,P=b.pop()||0,D=b.pop()||0;if(P-D<=x){for(let W=D;W<=P;W++){const ee=m[2*W],ce=m[2*W+1];ee>=r&&ee<=c&&ce>=s&&ce<=h&&S.push(p[W])}continue}const F=D+P>>1,U=m[2*F],V=m[2*F+1];U>=r&&U<=c&&V>=s&&V<=h&&S.push(p[F]),(I===0?r<=U:s<=V)&&(b.push(D),b.push(F-1),b.push(1-I)),(I===0?c>=U:h>=V)&&(b.push(F+1),b.push(P),b.push(1-I))}return S}within(r,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:p,nodeSize:m}=this,x=[0,h.length-1,0],b=[],S=c*c;for(;x.length;){const I=x.pop()||0,P=x.pop()||0,D=x.pop()||0;if(P-D<=m){for(let W=D;W<=P;W++)Xz(p[2*W],p[2*W+1],r,s)<=S&&b.push(h[W]);continue}const F=D+P>>1,U=p[2*F],V=p[2*F+1];Xz(U,V,r,s)<=S&&b.push(h[F]),(I===0?r-c<=U:s-c<=V)&&(x.push(D),x.push(F-1),x.push(1-I)),(I===0?r+c>=U:s+c>=V)&&(x.push(F+1),x.push(P),x.push(1-I))}return b}}function tM(i,r,s,c,h,p){if(h-c<=s)return;const m=c+h>>1;Zz(i,r,m,c,h,p),tM(i,r,s,c,m-1,1-p),tM(i,r,s,m+1,h,1-p)}function Zz(i,r,s,c,h,p){for(;h>c;){if(h-c>600){const S=h-c+1,I=s-c+1,P=Math.log(S),D=.5*Math.exp(2*P/3),F=.5*Math.sqrt(P*D*(S-D)/S)*(I-S/2<0?-1:1);Zz(i,r,s,Math.max(c,Math.floor(s-I*D/S+F)),Math.min(h,Math.floor(s+(S-I)*D/S+F)),p)}const m=r[2*s+p];let x=c,b=h;for(Ov(i,r,c,s),r[2*h+p]>m&&Ov(i,r,c,h);x<b;){for(Ov(i,r,x,b),x++,b--;r[2*x+p]<m;)x++;for(;r[2*b+p]>m;)b--}r[2*c+p]===m?Ov(i,r,c,b):(b++,Ov(i,r,b,h)),b<=s&&(c=b+1),s<=b&&(h=b-1)}}function Ov(i,r,s,c){rM(i,s,c),rM(r,2*s,2*c),rM(r,2*s+1,2*c+1)}function rM(i,r,s){const c=i[r];i[r]=i[s],i[s]=c}function Xz(i,r,s,c){const h=i-s,p=r-c;return h*h+p*p}a.$=bu,a.A=Zf,a.B=Bc,a.C=yn,a.D=Qo,a.E=Au,a.G=Jo,a.H=f,a.I=fp,a.J=CI,a.K=function(i){const r=i.value;let s=[];if(!r)return s;const c=Mu(r);return c!=="string"?(s=s.concat([new Xw(i.key,r,`string expected, "${c}" found`)]),s):(Mz(r,!0)||(s=s.concat([new Xw(i.key,r,`invalid url "${r}"`)])),s)},a.L=Ve,a.M=class{constructor(i,r,s,c){this.id=i,this.position=r!=null?new gn(r[0],r[1]):new gn(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(i,r){if(a.ad.multiply(i.matrix,r,i.matrix),i.meshes)for(const s of i.meshes){const c=di.applyTransform(s.aabb,i.matrix);this.aabb.encapsulate(c)}if(i.children)for(const s of i.children)this._applyTransformations(s,i.matrix)}computeBoundsAndApplyParent(){const i=a.ad.identity([]);for(const r of this.nodes)this._applyTransformations(r,i)}computeModelMatrix(i,r,s,c,h,p,m=!1){kz(this.matrix,this,i.transform,this.position,r,s,c,h,p,m)}upload(i){if(!this.uploaded){for(const r of this.nodes)W3(r,i);for(const r of this.nodes)Qw(r);this.uploaded=!0}}destroy(){for(const i of this.nodes)q3(i)}},a.N=Sn,a.O=yt,a.P=Ut,a.Q=class{constructor(i){this.specification=i}possiblyEvaluate(i,r){return jl(i.expression.evaluate(r))}interpolate(i,r,s){return{x:_r(i.x,r.x,s),y:_r(i.y,r.y,s),z:_r(i.z,r.z,s),azimuthal:_r(i.azimuthal,r.azimuthal,s),polar:_r(i.polar,r.polar,s)}}},a.R=$m,a.S=FI,a.T=pl,a.U=In,a.V=Xw,a.W=jo,a.X=Mr,a.Y=es,a.Z=ne,a.a=ca,a.a$=function(i){const{x:r,y:s}=i.point,{lng:c,lat:h}=i._center;return mB(r,s,i.worldSize,c,h)},a.a0=Dn,a.a1=Vu,a.a2=_r,a.a3=Bt,a.a4=bb,a.a5=class{constructor(i){this.specification=i}possiblyEvaluate(i,r){return function([s,c]){const h=jl([1,s,c]);return{x:h.x,y:h.y,z:h.z}}(i.expression.evaluate(r))}interpolate(i,r,s){return{x:_r(i.x,r.x,s),y:_r(i.y,r.y,s),z:_r(i.z,r.z,s)}}},a.a6=ev,a.a7=ow,a.a8=Nu,a.a9=VL,a.aB=function(i,r){const{x:s,y:c}=i.point,h=mB(s,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return a.ad.multiply(h,h,l3($c(r)))},a.aD=A0,a.aE=Oa,a.aF=Pw,a.aG=function(i,r,s,c,h){const p=5*r+2;i.float32[p+0]=s,i.float32[p+1]=c,i.float32[p+2]=h},a.aH=$w,a.aI=gn,a.aJ=nz,a.aK=qL,a.aL=Ji,a.aM=o3,a.aN=Ez,a.aO=lp,a.aP=dB,a.aQ=function(i,r,s,c,h,p,m,x,b){if(b.name==="globe")return dB(i,r,new lp(s,c,h),!1);const S=dp({z:s,x:c,y:h},b);return new di([(p+S.x/S.scale)*r,r*(S.y/S.scale),m],[(p+S.x2/S.scale)*r,r*(S.y2/S.scale),x])},a.aR=function(i,r,s){let c=0;for(let h=0;h<2;++h)i[h]>0&&(c+=(i[h]-0)*(i[h]-0)),r[h]<0&&(c+=(0-r[h])*(0-r[h]));return c},a.aS=ki,a.aT=n3,a.aU=GL,a.aV=function(i){const r=a.ad.identity(new Float64Array(16));a.ad.multiply(r,i.pixelMatrix,i.globeMatrix);const s=[0,dl,0],c=[0,fl,0];return a._.transformMat4(s,s,r),a._.transformMat4(c,c,r),[s[0]>0&&s[0]<=i.width&&s[1]>0&&s[1]<=i.height&&!u3(i,new gn(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!u3(i,new gn(i.center.lat,-90))]},a.aW=function(i,r){const{scale:s}=i.tileTransform,c=s*Bt/(i.tileSize*Math.pow(2,r.zoom-i.tileID.overscaledZ+i.tileID.canonical.z));return a.aC.scale(new Float32Array(4),r.inverseAdjustmentMatrix,[c,c])},a.aX=Yw,a.aY=Cz,a.aZ=function(i){const r=Cz(i,!0);return a.aC.invert([],[r[0],r[1],r[4],r[5]])},a.a_=i3,a.aa=Rs,a.ab=an,a.ac=function(i,r,s){const c=Math.sqrt(i*i+r*r+s*s),h=c>0?Math.acos(s/c)*Cf:0;let p=i!==0||r!==0?Math.atan2(-r,-i)*Cf+90:0;return p<0&&(p+=360),[c,p,h]},a.ae=k0,a.af=ec,a.ag=D3,a.ah=function(i,r){const s={};for(let c=0;c<r.length;c++){const h=r[c];h in i&&(s[h]=i[h])}return s},a.ai=sd,a.aj=Nc,a.ak=Uc,a.al=d0,a.am=function(i){Nm++,Nm>cy&&(i.getActor().send("enforceCacheSizeLimit",ly),Nm=0)},a.an=_y,a.ao=class{constructor(i){this.entries={},this.scheduler=i}request(i,r,s,c){const h=this.entries[i]=this.entries[i]||{callbacks:[]};if(h.result){const[p,m]=h.result;return this.scheduler?this.scheduler.add(()=>{c(p,m)},r):c(p,m),()=>{}}return h.callbacks.push(c),h.cancel||(h.cancel=s((p,m)=>{h.result=[p,m];for(const x of h.callbacks)this.scheduler?this.scheduler.add(()=>{x(p,m)},r):x(p,m);setTimeout(()=>delete this.entries[i],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(p=>p!==c),h.callbacks.length||(h.cancel(),delete this.entries[i]))}}},a.ap=function(i,r,s){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},h=>{const p=Su(i.request,(m,x,b,S)=>{m?h(m):x&&h(null,{vectorTile:s?void 0:new _3(new T0(x)),rawData:x,cacheControl:b,expires:S})});return()=>{p.cancel(),h()}},r)},a.aq=$I,a.ar=class extends zu{constructor(i){super(i),this.current=pZ}set(i,r,s){if(this.fetchUniformLocation(i,r)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.as=jI,a.at=Kr,a.au=wu,a.aw=If,a.ax=Ds,a.ay=Ro,a.az=function(i,r,s){i[4*r+0]=s[0],i[4*r+1]=s[1],i[4*r+2]=s[2],i[4*r+3]=s[3]},a.b=hi,a.b$=ud,a.b0=$o,a.b1=GI,a.b2=function(i){const r=Math.round((i+45+360)%360/90)%4;return lb[r]},a.b3=45,a.b4=KI,a.b5=sw,a.b6=di,a.b7=jl,a.b8=function(i){return[Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)]},a.b9=ey,a.bA=function(i,r){return[Math.pow(i[0],2.2)*r,Math.pow(i[1],2.2)*r,Math.pow(i[2],2.2)*r]},a.bB=mF,a.bD=pB,a.bE=Bm,a.bF=Lm,a.bG=256,a.bH=function(i,r){const s=[0,0,0],c=sv($c(r.canonical));return a._.transformMat4(s,s,c),a._.transformMat4(s,s,i),s},a.bI=i=>({u_camera_to_center_distance:new Rs(i),u_extrude_scale:new VI(i),u_device_pixel_ratio:new Rs(i),u_matrix:new ev(i),u_inv_rot_matrix:new ev(i),u_merc_center:new Nu(i),u_tile_id:new $I(i),u_zoom_transition:new Rs(i),u_up_dir:new $I(i),u_emissive_strength:new Rs(i)}),a.bJ=i=>({u_matrix:new ev(i),u_pixels_to_tile_units:new VI(i),u_device_pixel_ratio:new Rs(i),u_units_to_pixels:new Nu(i),u_dash_image:new ow(i),u_gradient_image:new ow(i),u_image_height:new Rs(i),u_texsize:new Nu(i),u_tile_units_to_pixels:new Rs(i),u_alpha_discard_threshold:new Rs(i),u_trim_offset:new Nu(i),u_trim_fade_range:new Nu(i),u_trim_color:new jI(i),u_emissive_strength:new Rs(i)}),a.bK=i=>({u_matrix:new ev(i),u_texsize:new Nu(i),u_pixels_to_tile_units:new VI(i),u_device_pixel_ratio:new Rs(i),u_image:new ow(i),u_units_to_pixels:new Nu(i),u_tile_units_to_pixels:new Rs(i),u_alpha_discard_threshold:new Rs(i),u_trim_offset:new Nu(i)}),a.bL=PI,a.bM=KX,a.bN=Ho,a.bO=dQ,a.bP=KF,a.bQ=T3,a.bR=yB,a.bS=(i,r,s,c,h,p)=>{const m=i.transform,x=m.projection.name==="globe";let b;if(p.paint.get("circle-pitch-alignment")==="map")if(x){const I=pB(m.zoom,r.canonical)*m._pixelsPerMercatorPixel;b=Float32Array.from([I,0,0,I])}else b=m.calculatePixelsToTileUnitsMatrix(s);else b=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const S={u_camera_to_center_distance:i.transform.getCameraToCenterDistance(m.projection),u_matrix:i.translatePosMatrix(r.projMatrix,s,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Io.devicePixelRatio,u_extrude_scale:b,u_inv_rot_matrix:zZ,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(x){S.u_inv_rot_matrix=c,S.u_merc_center=h,S.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],S.u_zoom_transition=Vu(m.zoom);const I=h[0]*Bt,P=h[1]*Bt;S.u_up_dir=m.projection.upVector(new lp(0,0,0),I,P)}return S},a.bT=yF,a.bU=(i,r,s,c,h,p)=>{const m=i.transform;return{u_matrix:_F(i,r,s,c),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:m.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:h,u_image:0,u_tile_units_to_pixels:gF(r,m),u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:p}},a.bV=(i,r,s,c,h,p,m)=>{const x=i.transform,b=x.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:_F(i,r,s,c),u_pixels_to_tile_units:b,u_device_pixel_ratio:p,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:h,u_texsize:vF(s)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:gF(r,i.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength")}},a.bW=ty,a.bX=av,a.bY=aF,a.bZ=wZ,a.b_=Sw,a.ba=function(i,r,s){const c=Vu(s.zoom),h=i.style.map._antialias,p=r.options.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!h&&!p},a.bb=function(i){const r=i.pixelsPerMeter,s=r/Ds(1,i.center.lat),c=a.ad.identity(new Float64Array(16));return a.ad.translate(c,c,[i.point.x,i.point.y,0]),a.ad.scale(c,c,[s,s,r]),Float32Array.from(c)},a.bc=dw,a.bd=function(i){const r=ki-5;i=Kr(i,-r,r)/r*90;const s=Math.pow(Math.abs(Math.sin(an(i))),3);return Math.round(s*(WI.length-1))},a.be=function(i,r,s,c){const h=r.getNorth(),p=r.getSouth(),m=r.getWest(),x=r.getEast(),b=1<<i.z,S=x-m,I=h-p,P=S/g0,D=-I/WI[s],F=[0,P,0,D,0,0,h,m,0];if(i.z>0){const U=180/c;a.bC.multiply(F,F,[U/S+1,0,0,0,U/I+1,0,-.5*U/P,.5*U/D,1])}return F[2]=b,F[5]=i.x,F[8]=i.y,F},a.bf=sv,a.bg=$c,a.bh=function(i,r,s){const c=a.ad.identity(new Float64Array(16)),h=(r/(1<<i)-.5)*Math.PI*2;return a.ad.rotateY(c,s.globeMatrix,h),Float32Array.from(c)},a.bi=kh,a.bj=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.bk=bz,a.bl=wz,a.bm=xz,a.bn=function(i,r){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let c=0;c<i.length;c++){const h=document.createElement("source");fb(i[c])||(s.crossOrigin="Anonymous"),h.src=i[c],s.appendChild(h)}return{cancel:()=>{}}},a.bo=jw,a.bp=km,a.bq=class{isDataAvailableAtPoint(i){const r=this._source();if(this.isUsingMockSource()||!r||i.y<0||i.y>1)return!1;const s=r.getSource().maxzoom,c=1<<s,h=Math.floor(i.x),p=Math.floor((i.x-h)*c),m=Math.floor(i.y*c),x=this.findDEMTileFor(new Ji(s,h,s,p,m));return!(!x||!x.dem)}getAtPointOrZero(i,r=0){return this.getAtPoint(i,r)||0}getAtPoint(i,r,s=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const c=this._source();if(!c||i.y<0||i.y>1)return r;const h=c.getSource().maxzoom,p=1<<h,m=Math.floor(i.x),x=i.x-m,b=new Ji(h,m,h,Math.floor(x*p),Math.floor(i.y*p)),S=this.findDEMTileFor(b);if(!S||!S.dem)return r;const I=S.dem,P=1<<S.tileID.canonical.z,D=(x*P-S.tileID.canonical.x)*I.dim,F=(i.y*P-S.tileID.canonical.y)*I.dim,U=Math.floor(D),V=Math.floor(F);return(s?this.exaggeration():1)*_r(_r(I.get(U,V),I.get(U,V+1),F-V),_r(I.get(U+1,V),I.get(U+1,V+1),F-V),D-U)}getAtTileOffset(i,r,s){const c=1<<i.canonical.z;return this.getAtPointOrZero(new es(i.wrap+(i.canonical.x+r/Bt)/c,(i.canonical.y+s/Bt)/c))}getAtTileOffsetFunc(i,r,s,c){return h=>{const p=this.getAtTileOffset(i,h.x,h.y),m=c.upVector(i.canonical,h.x,h.y),x=c.upVectorScale(i.canonical,r,s).metersToTile;return a._.scale(m,m,p*x),m}}getForTilePoints(i,r,s,c){if(this.isUsingMockSource())return!1;const h=C0.create(this,i,c);return!!h&&(r.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],s)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(i);if(!r||!r.dem)return null;const s=r.dem.tree,c=r.tileID,h=1<<i.canonical.z-c.canonical.z;let p=i.canonical.x/h-c.canonical.x,m=i.canonical.y/h-c.canonical.y,x=0;for(let b=0;b<i.canonical.z-c.canonical.z&&!s.leaves[x];b++){p*=2,m*=2;const S=2*Math.floor(m)+Math.floor(p);x=s.childOffsets[x]+S,p%=1,m%=1}return{min:this.exaggeration()*s.minimums[x],max:this.exaggeration()*s.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const i=this.visibleDemTiles;if(i.length===0)return null;let r=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const h of i){const p=this.getMinMaxForTile(h.tileID);p&&(s=Math.min(s,p.min),c=Math.max(c,p.max),r=!0)}return r?{min:s,max:c}:null}},a.br=iv,a.bs=hw,a.bt=Yl,a.bu=vo,a.bv=pp,a.bw=B0,a.bx=Jw,a.by=Gw,a.bz=EB,a.c=Vz,a.c$=Pf,a.c0=450,a.c1=7,a.c2=dJ,a.c3=pz,a.c4=256,a.c5=uB,a.c6=l3,a.c7=Tn,a.c8=td,a.c9=op,a.cA=function(i){let r=1/0,s=1/0,c=-1/0,h=-1/0;for(const p of i)r=Math.min(r,p.x),s=Math.min(s,p.y),c=Math.max(c,p.x),h=Math.max(h,p.y);return{min:new Ut(r,s),max:new Ut(c,h)}},a.cB=ad,a.cC=XL,a.cD=ks,a.cE=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.cF=$F,a.cG=JI,a.cH=UB,a.cI=$B,a.cJ=P3,a.cK=eM,a.cL=function(i){return i({pluginStatus:St,pluginURL:ut}),Rr.on("pluginStateChange",i),i},a.cM=M0,a.cN=I3,a.cO=jm,a.cP=tr,a.cQ=R,a.cR=ay,a.cS=Fh,a.cT=sl,a.cU=function(i){const r=i.indexOf(Xh);return r>=0?i.slice(0,r):i},a.cV=function(i){return i.indexOf(Xh)>=0},a.cW=function(i){const r=i.indexOf(Xh);return r>=0?i.slice(r+1):""},a.cX=function(i){const r=[],s=i.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},a.cY=function(i,r,s,c){return i.type==="custom"?new mJ(i,r):new GJ[i.type](i,r,s,c)},a.cZ=Cu,a.c_=Rr,a.ca=1,a.cb=Cv,a.cc=0,a.cd=OI,a.ce=function(i,r,s,c,h){return Kr((i-r)/(s-r)*(h-c)+c,c,h)},a.cf=qb,a.cg=cp,a.ch=class{constructor(i,r,s,c){this.context=i,this.format=c,this.size=s,this.texture=i.gl.createTexture();const[h,p,m]=this.size,{gl:x}=i;x.bindTexture(x.TEXTURE_3D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(!1);let b=this.format,S=x.UNSIGNED_BYTE;this.format===x.DEPTH_COMPONENT&&(b=x.DEPTH_COMPONENT16,S=x.UNSIGNED_SHORT),this.format===x.R8&&(c=x.RED),this.format===x.R32F&&(S=x.FLOAT,c=x.RED),x.texImage3D(x.TEXTURE_3D,0,b,h,p,m,0,c,S,r.data)}bind(i,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_3D,this.texture),i!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,i),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,i),this.minFilter=i),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}},a.ci=H3,a.cj=[1,1,1],a.ck=C0,a.cl=L0,a.cm=nd,a.cn=p0,a.co=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Ut(1/0,1/0),max:new Ut(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(i,r=!1){const s=FB(new Ut(0,0),new Ut(Bt,Bt),i),c=[];if(r&&!y3(s,this._globalClipBounds))return c;for(const h of this._activeRegions){if(h.hiddenByOverlap||!y3(s,h))continue;const p=bX(h.min,h.max,i);c.push({min:p.min,max:p.max,sourceId:this._sourceIds[h.priority],footprint:h.footprint,footprintTileId:h.tileId,order:h.order,clipMask:h.clipMask})}return c}setSources(i){this._setSources(i.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const s=[];for(const c of r.cache.getVisibleCoordinates()){const h=r.cache.getTile(c).buckets[r.layer];h&&h.updateFootprints(c.toUnwrapped(),s)}return s},getOrder:()=>r.order,getClipMask:()=>r.clipMask})))}_addSource(i){const r=i.getFootprints();if(r.length===0)return;const s=i.getOrder(),c=i.getClipMask();for(const h of r){if(!h.footprint)continue;const p=FB(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:p.min,max:p.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:s,clipMask:c})}this._sourceIds.push(i.getSourceId())}_computeReplacement(){this._activeRegions.sort((r,s)=>r.priority-s.priority||ww(r.min,s.min)||ww(r.max,s.max));let i=this._activeRegions.length!==this._prevRegions.length;if(!i){let r=0;for(;!i&&r!==this._activeRegions.length;){const s=this._activeRegions[r],c=this._prevRegions[r];i=s.priority!==c.priority||!BB(s,c)||s.order!==c.order||s.clipMask!==c.clipMask,++r}}if(i){++this._updateTime;for(const s of this._activeRegions)s.order!==1/0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const r=s=>{const c=this._activeRegions;if(s>=c.length)return s;const h=c[s].priority;for(;s<c.length&&c[s].priority===h;)++s;return s};if(this._sourceIds.length>1){let s=0,c=r(s);for(;s!==c;){let h=s;const p=s;for(;h!==c;){const m=this._activeRegions[h];m.hiddenByOverlap=!1;for(let x=0;x<p;x++){const b=this._activeRegions[x];if(!b.hiddenByOverlap&&m.order===1/0&&y3(m,b)&&(m.hiddenByOverlap=NB(m.footprint,m.tileId,b.footprint,b.tileId),m.hiddenByOverlap))break}++h}s=c,c=r(s)}}}}_setSources(i){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=i.length-1;r>=0;r--)this._addSource(i[r]);this._computeReplacement()}},a.cp=Jh,a.cq=Hw,a.cr=Qy,a.cs=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy()}_fillGridMeshWithLods(i,r){const s=new Yl,c=new vo,h=[],p=i+1+2,m=r[0]+1,x=r[0]+1+(1+r.length),b=(S,I,P)=>{let D=S===p-1?S-2:S===0?S:S-1;return D+=P?24575:0,[D,I]};for(let S=0;S<p;++S)s.emplaceBack(...b(S,0,!0));for(let S=0;S<m;++S)for(let I=0;I<p;++I)s.emplaceBack(...b(I,S,(I===0||I===p-1)&&!0));for(let S=0;S<r.length;++S){const I=r[S];for(let P=0;P<p;++P)s.emplaceBack(...b(P,I,!0))}for(let S=0;S<r.length;++S){const I=c.length,P=r[S]+1+2,D=new vo;for(let V=0;V<P-1;V++){const W=V===P-2,ee=W?p*(x-r.length+S-V):p;for(let ce=0;ce<p-1;ce++){const ue=V*p+ce;V===0||W||ce===0||ce===p-2?(D.emplaceBack(ue+1,ue,ue+ee),D.emplaceBack(ue+ee,ue+ee+1,ue+1)):(c.emplaceBack(ue+1,ue,ue+ee),c.emplaceBack(ue+ee,ue+ee+1,ue+1))}}const F=hi.simpleSegment(0,I,s.length,c.length-I);for(let V=0;V<D.uint16.length;V+=3)c.emplaceBack(D.uint16[V],D.uint16[V+1],D.uint16[V+2]);const U=hi.simpleSegment(0,I,s.length,c.length-I);h.push({withoutSkirts:F,withSkirts:U})}return{vertices:s,indices:c,segments:h}}_createGrid(i){const r=this._fillGridMeshWithLods(g0,WI);this._gridSegments=r.segments,this._gridBuffer=i.createVertexBuffer(r.vertices,iv.members),this._gridIndexBuffer=i.createIndexBuffer(r.indices,!0)}_createPoles(i){const r=new vo;for(let m=0;m<=g0;m++)r.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=i.createIndexBuffer(r,!0);const s=new op,c=new op,h=new op,p=new op;this._poleSegments=[];for(let m=0,x=0;m<GI;m++){const b=360/(1<<m);s.emplaceBack(0,-ks,0,.5,0),c.emplaceBack(0,-ks,0,.5,1),h.emplaceBack(0,-ks,0,.5,.5),p.emplaceBack(0,-ks,0,.5,.5);for(let S=0;S<=g0;S++){let I=S/g0,P=0;const D=_r(0,b,I),[F,U,V]=_0(BZ,FZ,D,ks);s.emplaceBack(F,U,V,I,P),c.emplaceBack(F,U,V,I,1-P);const W=an(D);I=.5+.5*Math.sin(W),P=.5+.5*Math.cos(W),h.emplaceBack(F,U,V,I,P),p.emplaceBack(F,U,V,I,1-P)}this._poleSegments.push(hi.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(s,uw,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,uw,!1),this._texturedPoleNorthVertexBuffer=i.createVertexBuffer(h,uw,!1),this._texturedPoleSouthVertexBuffer=i.createVertexBuffer(p,uw,!1)}getGridBuffers(i,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}},a.ct=function(i){return Lf.has(i)},a.cu=YB,a.cv=function(i,r,s=0,c=!0){const h=new Ut(s,s),p=i.sub(h),m=r.add(h),x=[p,new Ut(m.x,p.y),m,new Ut(p.x,m.y)];return c&&x.push(p.clone()),x},a.cw=function(i,r){const s=[];for(let c=0;c<i.length;c++){const h=wu(c-1,-1,i.length-1),p=wu(c+1,-1,i.length-1),m=i[c],x=i[p],b=i[h].sub(m).unit(),S=x.sub(m).unit(),I=S.angleWithSep(b.x,b.y),P=b.add(S).unit().mult(-1*r/Math.sin(I/2));s.push(m.add(P))}return s},a.cx=QF,a.cy=rB,a.cz=function(i,r,s=0){return a._.fromValues(((r.x-s)*i.scale-i.x)*Bt,(r.y*i.scale-i.y)*Bt,KL(r.z,r.y))},a.d=Wm,a.d$=Mm,a.d0=Ef,a.d1=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.d2=Ih,a.d3=ZL,a.d4=ap,a.d5=function([i,r,s]){const c=Math.hypot(i,r,s),h=Math.atan2(i,s),p=.5*Math.PI-Math.acos(-r/c);return new gn($o(h),$o(p))},a.d6=Ys,a.d7=y0,a.d8=k,a.d9=u3,a.dA=function(i){const r=hb();if(!r)return;const s=r.delete(ub);i&&s.catch(i).then(()=>i())},a.dB=Mv,a.dC=Oz,a.dD=function(i){Y3=Io.resolveURL(i),z0||(z0=new B0(Jw(),new Au)),z0.broadcast("setDracoUrl",Y3)},a.dE=Lz,a.dF=function(i){F0=Io.resolveURL(i),z0||(z0=new B0(Jw(),new Au)),z0.broadcast("setMeshoptUrl",F0)},a.dG=oa,a.dH=pe,a.dI=ld,a.dJ=Jl,a.dK=dp,a.dL=NI,a.dM=xF,a.dN=AF,a.dO=fF,a.dP=Ph,a.dQ=VF,a.dR=D0,a.dS=function(i,r,s,c,h,p,m,x,b,S,I){i.createArrays(),i.tilePixelRatio=Bt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const P=i.layers[0].layout,D=i.layers[0]._unevaluatedLayout._values,F={};if(i.textSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=i.textSizeData;F.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Mr(ee),x),D["text-size"].possiblyEvaluate(new Mr(ce),x)]}if(i.iconSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=i.iconSizeData;F.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Mr(ee),x),D["icon-size"].possiblyEvaluate(new Mr(ce),x)]}F.layoutTextSize=D["text-size"].possiblyEvaluate(new Mr(b+1),x),F.layoutIconSize=D["icon-size"].possiblyEvaluate(new Mr(b+1),x),F.textMaxSize=D["text-size"].possiblyEvaluate(new Mr(18),x);const U=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",V=P.get("text-size");let W=!1;for(const ee of i.features)if(ee.icon&&ee.icon.nameSecondary){W=!0;break}for(const ee of i.features){const ce=P.get("text-font").evaluate(ee,{},x).join(","),ue=V.evaluate(ee,{},x),he=F.layoutTextSize.evaluate(ee,{},x),Se=(F.layoutIconSize.evaluate(ee,{},x),{horizontal:{},vertical:void 0}),be=ee.text;let ke,Le=[0,0];if(be){const Ze=be.toString(),dt=P.get("text-letter-spacing").evaluate(ee,{},x)*Ho,At=P.get("text-line-height").evaluate(ee,{},x)*Ho,ct=Qe(Ze)?dt:0,bt=P.get("text-anchor").evaluate(ee,{},x),st=P.get("text-variable-anchor");if(!st){const It=P.get("text-radial-offset").evaluate(ee,{},x);Le=It?KF(bt,[It*Ho,M3]):P.get("text-offset").evaluate(ee,{},x).map(Dt=>Dt*Ho)}let wt=U?"center":P.get("text-justify").evaluate(ee,{},x);const Pt=P.get("symbol-placement")==="point",Tt=Pt?P.get("text-max-width").evaluate(ee,{},x)*Ho:1/0,Ht=It=>{i.allowVerticalPlacement&&Ge(Ze)&&(Se.vertical=S3(be,r,s,h,ce,Tt,At,bt,It,ct,Le,Oa.vertical,!0,he,ue))};if(!U&&st){const It=wt==="auto"?st.map(fr=>P3(fr)):[wt];let Dt=!1;for(let fr=0;fr<It.length;fr++){const lr=It[fr];if(!Se.horizontal[lr])if(Dt)Se.horizontal[lr]=Se.horizontal[0];else{const sr=S3(be,r,s,h,ce,Tt,At,"center",lr,ct,Le,Oa.horizontal,!1,he,ue);sr&&(Se.horizontal[lr]=sr,Dt=sr.positionedLines.length===1)}}Ht("left")}else{if(wt==="auto"&&(wt=P3(bt)),Pt||P.get("text-writing-mode").indexOf("horizontal")>=0||!Ge(Ze)){const It=S3(be,r,s,h,ce,Tt,At,bt,wt,ct,Le,Oa.horizontal,!1,he,ue);It&&(Se.horizontal[wt]=It)}Ht(Pt?"left":wt)}}let je=!1;if(ee.icon&&ee.icon.namePrimary){const Ze=c[ee.icon.namePrimary];Ze&&(ke=bQ(h[ee.icon.namePrimary],ee.icon.nameSecondary?h[ee.icon.nameSecondary]:void 0,P.get("icon-offset").evaluate(ee,{},x),P.get("icon-anchor").evaluate(ee,{},x)),je=Ze.sdf,i.sdfIcons===void 0?i.sdfIcons=Ze.sdf:i.sdfIcons!==Ze.sdf&&Pi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==i.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const ot=ZF(Se.horizontal)||Se.vertical;i.iconsInText||(i.iconsInText=!!ot&&ot.iconsInText),(ot||ke)&&IQ(i,ee,Se,ke,c,F,he,0,Le,je,m,x,S,I,W)}p&&i.generateCollisionDebugBuffers(b,i.collisionBoxArray)},a.dT=Tw,a.dU=yw,a.dV=_3,a.dW=T0,a.dX=Cw,a.dY=U3,a.dZ=xw,a.d_=vw,a.da=gB,a.db=function(i){const r=[0,0,0],s=a.ad.identity(new Float64Array(16));return a.ad.multiply(s,i.pixelMatrix,i.globeMatrix),a._.transformMat4(r,r,s),new Ut(r[0],r[1])},a.dc=j,a.dd=q,a.de=function(i){const r=i.navigator?i.navigator.userAgent:null;return!!function(s){if(Om==null){const c=s.navigator?s.navigator.userAgent:null;Om=!!s.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Om}(i)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.df=Pm,a.dg=class{constructor(i,r,s){this._transformRequestFn=i,this._customAccessToken=r,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const i=function(){let r="";for(let s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",my,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,r){return this._transformRequestFn&&this._transformRequestFn(i,r)||{url:i}}normalizeStyleURL(i,r){if(!R(i))return i;const s=Ta(i);return s.params.push(`sdk=js-${C}`),s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeGlyphsURL(i,r){if(!R(i))return i;const s=Ta(i);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeModelURL(i,r){if(!R(i))return i;const s=Ta(i);return s.path=`/models/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeSourceURL(i,r,s,c){if(!R(i))return i;const h=Ta(i);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),s&&h.params.push(`language=${s}`),c&&h.params.push(`worldview=${c}`),this._makeAPIURL(h,this._customAccessToken||r)}normalizeSpriteURL(i,r,s,c){const h=Ta(i);return R(i)?(h.path=`/styles/v1${h.path}/sprite${r}${s}`,this._makeAPIURL(h,this._customAccessToken||c)):(h.path+=`${r}${s}`,Lh(h))}normalizeTileURL(i,r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!R(i))return i;const c=Ta(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||s&&c.authority!=="raster"&&s===512?"@2x":""}${Um.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${k.RASTER_URL_PREFIX}${c.path}`:c.authority==="rasterarrays"?c.path=`/${k.RASTERARRAYS_URL_PREFIX}${c.path}`:c.authority==="3dtiles"?c.path=`/${k.TILES3D_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${k.TILE_URL_VERSION}${c.path}`);const h=this._customAccessToken||function(p){for(const m of p){const x=m.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(c.params)||k.ACCESS_TOKEN;return k.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,h)}canonicalizeTileURL(i,r){const s=Ta(i);if(!s.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!s.path.match(/\.[\w]+$/))return i;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${k.RASTER_URL_PREFIX}/`,"")}`:s.path.match(/^\/rasterarrays\/v1\//)?c+=`rasterarrays/${s.path.replace(`/${k.RASTERARRAYS_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${k.TILE_URL_VERSION}/`,"")}`;let h=s.params;return r&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(c+=`?${h.join("&")}`),c}canonicalizeTileset(i,r){const s=!!r&&R(r),c=[];for(const h of i.tiles||[])O(h)?c.push(this.canonicalizeTileURL(h,s)):c.push(h);return c}_makeAPIURL(i,r){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Ta(k.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const h=i.params.indexOf("secure");h>=0&&i.params.splice(h,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!k.REQUIRE_ACCESS_TOKEN)return Lh(i);if(r=r||k.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return i.params=i.params.filter(h=>h.indexOf("access_token")===-1),i.params.push(`access_token=${r||""}`),Lh(i)}},a.dh=function(i,r){r?Lf.add(i):Lf.delete(i)},a.di=Um,a.dj=sI,a.dk=Gm,a.dl=gy,a.dm=gb,a.dn=oI,a.dp=function(i){Lf.delete(i)},a.dq=Bh,a.dr=Of,a.ds=Mh,a.dt=C,a.du=function(i,r){ly=i,cy=r},a.dv=function(i,r,s=!1){if(St===Ft||St===zt||St===Gt)throw new Error("setRTLTextPlugin cannot be called multiple times.");ut=Io.resolveURL(i),St=Ft,Nt=r,$r(),s||ln()},a.dw=Zr,a.dx=function(){Jw().acquire(K3)},a.dy=function(){const i=Rv;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(K3),Rv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dz=Pv,a.e=Io,a.e0=bF,a.e1=Y,a.e2=Su,a.e3=function(i){let r=0;if(new Uint32Array(i,0,1)[0]!==Fz){const s=new Uint32Array(i,0,7),[,,c,h,p,m]=s;r=s.byteLength+h+p+m+p,(c!==i.byteLength||r>=i.byteLength)&&Pi("Invalid b3dm header information.")}return $z(i,r)},a.e4=function(i,r){const s=Vz(i);for(const c of s){for(const h of c.meshes)$J(h);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(jJ(c.lights,r)))}return s},a.e5=nC,a.e6=Dz,a.e7=Pn,a.e8=function(i){Mf(),Hl&&Hl.then(r=>{r.keys().then(s=>{for(let c=0;c<s.length-i;c++)r.delete(s[c])})})},a.f=ps,a.g=function(i,r){return Pf(jo(i,{type:"json"}),r)},a.h=Mc,a.i=Da,a.j=jF,a.k=A3,a.l=function(i){return fetch(i).then(r=>r.arrayBuffer()).then(r=>$z(r,0,i))},a.m=class extends Xw{},a.n=Mu,a.o=by,a.p=$Q,a.q=h0,a.r=g,a.s=l,a.t=G,a.u=qs,a.v=Po,a.w=Pi,a.x=ie,a.y=Z,a.z=t0}),_(["./shared"],function(a){function C(xe){const X=xe?xe.url.toString():void 0;return X?performance.getEntriesByName(X):[]}function A(xe){if(typeof xe=="number"||typeof xe=="boolean"||typeof xe=="string"||xe==null)return JSON.stringify(xe);if(Array.isArray(xe)){let re="[";for(const le of xe)re+=`${A(le)},`;return`${re}]`}let X="{";for(const re of Object.keys(xe).sort())X+=`${re}:${A(xe[re])},`;return`${X}}`}function k(xe){let X="";for(const re of a.cE)X+=`/${A(xe[re])}`;return X}class O{constructor(X){this.keyCache={},this._layers={},this._layerConfigs={},X&&this.replace(X)}replace(X,re){this._layerConfigs={},this._layers={},this.update(X,[],re)}update(X,re,le){this._options=le;for(const Ie of X)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=a.cY(Ie,this.scope,null,this._options)).compileFilter(),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(const Ie of re)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};const we=function(Ie,Oe){const $e={};for(let qe=0;qe<Ie.length;qe++){const kt=Oe&&Oe[Ie[qe].id]||k(Ie[qe]);Oe&&(Oe[Ie[qe].id]=kt);let Et=$e[kt];Et||(Et=$e[kt]=[]),Et.push(Ie[qe])}const Fe=[];for(const qe in $e)Fe.push($e[qe]);return Fe}(a.dG(this._layerConfigs),this.keyCache);for(const Ie of we){const Oe=Ie.map(er=>this._layers[er.id]),$e=Oe[0];if($e.visibility==="none")continue;const Fe=$e.source||"";let qe=this.familiesBySource[Fe];qe||(qe=this.familiesBySource[Fe]={});const kt=$e.sourceLayer||"_geojsonTileLayer";let Et=qe[kt];Et||(Et=qe[kt]=[]),Et.push(Oe)}}}const R=1*a.dJ;class z{constructor(X){const re={},le=[];for(const $e in X){const Fe=X[$e],qe=re[$e]={};for(const kt in Fe.glyphs){const Et=Fe.glyphs[+kt];if(!Et||Et.bitmap.width===0||Et.bitmap.height===0)continue;const er=Et.metrics.localGlyph?R:1,pr={x:0,y:0,w:Et.bitmap.width+2*er,h:Et.bitmap.height+2*er};le.push(pr),qe[kt]=pr}}const{w:we,h:Ie}=a.j(le),Oe=new a.dI({width:we||1,height:Ie||1});for(const $e in X){const Fe=X[$e];for(const qe in Fe.glyphs){const kt=Fe.glyphs[+qe];if(!kt||kt.bitmap.width===0||kt.bitmap.height===0)continue;const Et=re[$e][qe],er=kt.metrics.localGlyph?R:1;a.dI.copy(kt.bitmap,Oe,{x:0,y:0},{x:Et.x+er,y:Et.y+er},kt.bitmap)}}this.image=Oe,this.positions=re}}a.dH(z,"GlyphAtlas");class N{constructor(X){this.tileID=new a.aL(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.tileZoom=X.tileZoom,this.uid=X.uid,this.zoom=X.zoom,this.lut=X.lut,this.canonical=X.tileID.canonical,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.scope=X.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=X.showCollisionBoxes,this.collectResourceTiming=!!X.collectResourceTiming,this.promoteId=X.promoteId,this.isSymbolTile=X.isSymbolTile,this.tileTransform=a.dK(X.tileID.canonical,X.projection),this.projection=X.projection,this.brightness=X.brightness,this.extraShadowCaster=!!X.extraShadowCaster,this.tessellationStep=X.tessellationStep}parse(X,re,le,we,Ie){this.status="parsing",this.data=X,this.collisionBoxArray=new a.dL;const Oe=new a.dM(Object.keys(X.layers).sort()),$e=new a.dN(this.tileID,this.promoteId);$e.bucketLayerIDs=[];const Fe={},qe=new a.dO(256,256),kt={featureIndex:$e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:qe,availableImages:le,brightness:this.brightness},Et=re.familiesBySource[this.source];for(const Qt in Et){const xr=X.layers[Qt];if(!xr)continue;let Dr=!1,zr=!1,Jr=!1;for(const yo of Et[Qt])yo[0].type==="symbol"?Dr=!0:zr=!0,yo[0].is3D()&&yo[0].type!=="model"&&(Jr=!0);if(this.extraShadowCaster&&!Jr||this.isSymbolTile===!0&&!Dr||this.isSymbolTile===!1&&!zr)continue;xr.version===1&&a.w(`Vector tile source "${this.source}" layer "${Qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const An=Oe.encode(Qt),Si=[];for(let yo=0;yo<xr.length;yo++){const Uo=xr.feature(yo),vu=$e.getId(Uo,Qt);Si.push({feature:Uo,id:vu,index:yo,sourceLayerIndex:An})}for(const yo of Et[Qt]){const Uo=yo[0];(!this.extraShadowCaster||Uo.is3D()&&Uo.type!=="model")&&(this.isSymbolTile!==void 0&&Uo.type==="symbol"!==this.isSymbolTile||Uo.minzoom&&this.zoom<Math.floor(Uo.minzoom)||Uo.maxzoom&&this.zoom>=Uo.maxzoom||Uo.visibility!=="none"&&(K(yo,this.zoom,kt.brightness,le),(Fe[Uo.id]=Uo.createBucket({index:$e.bucketLayerIDs.length,layers:yo,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:An,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Si,kt,this.tileID.canonical,this.tileTransform),$e.bucketLayerIDs.push(yo.map(vu=>vu.id))))}}let er,pr,kr,Pr;qe.trim();const Ar={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Yr=()=>{if(er)return this.status="done",Ie(er);if(this.extraShadowCaster)this.status="done",Ie(null,{buckets:a.dG(Fe).filter(Qt=>!Qt.isEmpty()),featureIndex:$e,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:kt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(pr&&kr&&Pr){const Qt=new z(pr),xr=new a.dQ(kr,Pr,this.lut);for(const Dr in Fe){const zr=Fe[Dr];zr instanceof a.dR?(K(zr.layers,this.zoom,kt.brightness,le),a.dS(zr,pr,Qt.positions,kr,xr.iconPositions,this.showCollisionBoxes,le,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):zr.hasPattern&&(zr instanceof a.dT||zr instanceof a.dU||zr instanceof a.b_)&&(K(zr.layers,this.zoom,kt.brightness,le),zr.addFeatures(kt,this.tileID.canonical,xr.patternPositions,le,this.tileTransform,this.brightness))}this.status="done",Ie(null,{buckets:a.dG(Fe).filter(Dr=>!Dr.isEmpty()),featureIndex:$e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,lineAtlas:qe,imageAtlas:xr,brightness:kt.brightness})}};if(!this.extraShadowCaster){const Qt=a.dP(kt.glyphDependencies,zr=>Object.keys(zr).map(Number));Object.keys(Qt).length?we.send("getGlyphs",{uid:this.uid,stacks:Qt,scope:this.scope},(zr,Jr)=>{er||(er=zr,pr=Jr,Yr())},void 0,!1,Ar):pr={};const xr=Object.keys(kt.iconDependencies);xr.length?we.send("getImages",{icons:xr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(zr,Jr)=>{er||(er=zr,kr=Jr,Yr())},void 0,!1,Ar):kr={};const Dr=Object.keys(kt.patternDependencies);Dr.length?we.send("getImages",{icons:Dr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(zr,Jr)=>{er||(er=zr,Pr=Jr,Yr())},void 0,!1,Ar):Pr={}}Yr()}}function K(xe,X,re,le){const we=new a.X(X,{brightness:re});for(const Ie of xe)Ie.recalculate(we,le)}class q extends a.E{constructor(X,re,le,we,Ie,Oe){super(),this.actor=X,this.layerIndex=re,this.availableImages=le,this.loadVectorData=Ie||a.ap,this.loading={},this.loaded={},this.deduped=new a.ao(X.scheduler),this.isSpriteLoaded=we,this.scheduler=X.scheduler,this.brightness=Oe}loadTile(X,re){const le=X.uid,we=X&&X.request,Ie=we&&we.collectResourceTiming,Oe=this.loading[le]=new N(X);Oe.abort=this.loadVectorData(X,($e,Fe)=>{const qe=!this.loading[le];if(delete this.loading[le],qe||$e||!Fe)return Oe.status="done",qe||(this.loaded[le]=Oe),re($e);const kt=Fe.rawData,Et={};Fe.expires&&(Et.expires=Fe.expires),Fe.cacheControl&&(Et.cacheControl=Fe.cacheControl),Oe.vectorTile=Fe.vectorTile||new a.dV(new a.dW(kt));const er=()=>{Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,(pr,kr)=>{if(pr||!kr)return re(pr);const Pr={};if(Ie){const Ar=C(we);Ar.length>0&&(Pr.resourceTiming=JSON.parse(JSON.stringify(Ar)))}re(null,a.W({rawTileData:kt.slice(0)},kr,Et,Pr))})};this.isSpriteLoaded?er():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(er,{type:"parseTile",isSymbolTile:X.isSymbolTile,zoom:X.tileZoom}):er()}),this.loaded=this.loaded||{},this.loaded[le]=Oe})}reloadTile(X,re){const le=this.loaded,we=X.uid;if(le&&le[we]){const Ie=le[we];Ie.showCollisionBoxes=X.showCollisionBoxes,Ie.projection=X.projection,Ie.brightness=X.brightness,Ie.tileTransform=a.dK(X.tileID.canonical,X.projection),Ie.extraShadowCaster=X.extraShadowCaster,Ie.lut=X.lut;const Oe=($e,Fe)=>{const qe=Ie.reloadCallback;qe&&(delete Ie.reloadCallback,Ie.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,qe)),re($e,Fe)};Ie.status==="parsing"?Ie.reloadCallback=Oe:Ie.status==="done"&&(Ie.vectorTile?Ie.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Oe):Oe())}else re(null,void 0)}abortTile(X,re){const le=X.uid,we=this.loading[le];we&&(we.abort&&we.abort(),delete this.loading[le]),re()}removeTile(X,re){const le=this.loaded,we=X.uid;le&&le[we]&&delete le[we],re()}}class j{loadTile(X,re){const{uid:le,encoding:we,rawImageData:Ie,padding:Oe}=X,$e=ImageBitmap&&Ie instanceof ImageBitmap?this.getImageData(Ie,Oe):Ie;re(null,new a.dX(le,$e,we,Oe<1))}getImageData(X,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(X.width,X.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=X.width,this.offscreenCanvas.height=X.height,this.offscreenCanvasContext.drawImage(X,0,0,X.width,X.height);const le=this.offscreenCanvasContext.getImageData(-re,-re,X.width+2*re,X.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),le}}class H{decodeRasterArray({task:X,buffer:re},le){a.dY.performDecoding(re,X).then(we=>{le(null,we)},we=>{le(we)})}}const Y=a.dZ.prototype.toGeoJSON;let te=class{constructor(xe){this._feature=xe,this.extent=a.a3,this.type=xe.type,this.properties=xe.tags,"id"in xe&&!isNaN(xe.id)&&(this.id=parseInt(xe.id,10))}loadGeometry(){if(this._feature.type===1){const xe=[];for(const X of this._feature.geometry)xe.push([new a.P(X[0],X[1])]);return xe}{const xe=[];for(const X of this._feature.geometry){const re=[];for(const le of X)re.push(new a.P(le[0],le[1]));xe.push(re)}return xe}}toGeoJSON(xe,X,re){return Y.call(this,xe,X,re)}},J=class{constructor(xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.a3,this.length=xe.length,this._features=xe}feature(xe){return new te(this._features[xe])}};const ae=64/4096;class de{constructor(){this.features=new Map}clear(){this.features.clear()}load(X=[],re){for(const le of X){const we=le.id;if(we==null)continue;let Ie=this.features.get(we);Ie&&this.updateCache(Ie,re),le.geometry?(Ie=Ce(le),this.updateCache(Ie,re),this.features.set(we,Ie)):this.features.delete(we),this.updateCache(Ie,re)}}updateCache(X,re){for(const{canonical:le,uid:we}of Object.values(re)){const{z:Ie,x:Oe,y:$e}=le;Me(X,Math.pow(2,Ie),Oe,$e)&&delete re[we]}}getTile(X,re,le){const we=Math.pow(2,X),Ie=[];for(const Oe of this.features.values())Me(Oe,we,re,le)&&Ie.push(Ye(Oe,we,re,le));return{features:Ie}}getFeatures(){return[...this.features.values()]}}function Me({minX:xe,minY:X,maxX:re,maxY:le},we,Ie,Oe){return xe<(Ie+1+ae)/we&&X<(Oe+1+ae)/we&&re>(Ie-ae)/we&&le>(Oe-ae)/we}function Ce(xe){const{id:X,geometry:re,properties:le}=xe;if(!re)return;if(re.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:we,coordinates:Ie}=re,Oe={id:X,type:1,geometry:[],tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},$e=Oe.geometry;if(we==="Point")Ae(Ie,$e,Oe);else if(we==="MultiPoint")for(const Fe of Ie)Ae(Fe,$e,Oe);else if(we==="LineString")Oe.type=2,Ne(Ie,$e,Oe);else if(we==="MultiLineString")Oe.type=2,Re(Ie,$e,Oe);else if(we==="Polygon")Oe.type=3,Re(Ie,$e,Oe,!0);else{if(we!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Oe.type=3;for(const Fe of Ie)Re(Fe,$e,Oe,!0)}return Oe}function Ae([xe,X],re,le){const we=a.aj(xe);let Ie=a.ak(X);Ie=Ie<0?0:Ie>1?1:Ie,re.push(we,Ie),le.minX=Math.min(le.minX,we),le.minY=Math.min(le.minY,Ie),le.maxX=Math.max(le.maxX,we),le.maxY=Math.max(le.maxY,Ie)}function Ne(xe,X,re,le=!1,we=!1){const Ie=[];for(const Oe of xe)Ae(Oe,Ie,re);X.push(Ie),le&&function(Oe,$e){let Fe=0;for(let qe=0,kt=Oe.length,Et=kt-2;qe<kt;Et=qe,qe+=2)Fe+=(Oe[qe]-Oe[Et])*(Oe[qe+1]+Oe[Et+1]);if(Fe>0===$e)for(let qe=0,kt=Oe.length;qe<kt/2;qe+=2){const Et=Oe[qe],er=Oe[qe+1];Oe[qe]=Oe[kt-2-qe],Oe[qe+1]=Oe[kt-1-qe],Oe[kt-2-qe]=Et,Oe[kt-1-qe]=er}}(Ie,we)}function Re(xe,X,re,le=!1){for(let we=0;we<xe.length;we++)Ne(xe[we],X,re,le,we===0)}function Ye(xe,X,re,le){const{id:we,type:Ie,geometry:Oe,tags:$e}=xe,Fe=[];if(Ie===1)ht(Oe,X,re,le,Fe);else for(const qe of Oe)Fe.push(ht(qe,X,re,le));return{id:we,type:Ie,geometry:Fe,tags:$e}}function ht(xe,X,re,le,we=[]){for(let Ie=0;Ie<xe.length;Ie+=2)we.push(ft(xe[Ie],xe[Ie+1],X,re,le));return we}function ft(xe,X,re,le,we){return[Math.round(a.a3*(xe*re-le)),Math.round(a.a3*(X*re-we))]}var et={exports:{}},Xe=a.d$,Mt=a.d_.VectorTileFeature,Lt=nt;function nt(xe,X){this.options=X||{},this.features=xe,this.length=xe.length}function at(xe,X){this.id=typeof xe.id=="number"?xe.id:void 0,this.type=xe.type,this.rawGeometry=xe.type===1?[xe.geometry]:xe.geometry,this.properties=xe.tags,this.extent=X||4096}nt.prototype.feature=function(xe){return new at(this.features[xe],this.options.extent)},at.prototype.loadGeometry=function(){var xe=this.rawGeometry;this.geometry=[];for(var X=0;X<xe.length;X++){for(var re=xe[X],le=[],we=0;we<re.length;we++)le.push(new Xe(re[we][0],re[we][1]));this.geometry.push(le)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var xe=this.geometry,X=1/0,re=-1/0,le=1/0,we=-1/0,Ie=0;Ie<xe.length;Ie++)for(var Oe=xe[Ie],$e=0;$e<Oe.length;$e++){var Fe=Oe[$e];X=Math.min(X,Fe.x),re=Math.max(re,Fe.x),le=Math.min(le,Fe.y),we=Math.max(we,Fe.y)}return[X,le,re,we]},at.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var it=a.e0,tt=Lt;function Jt(xe){var X=new it;return function(re,le){for(var we in re.layers)le.writeMessage(3,$t,re.layers[we])}(xe,X),X.finish()}function $t(xe,X){var re;X.writeVarintField(15,xe.version||1),X.writeStringField(1,xe.name||""),X.writeVarintField(5,xe.extent||4096);var le={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<xe.length;re++)le.feature=xe.feature(re),X.writeMessage(2,Lr,le);var we=le.keys;for(re=0;re<we.length;re++)X.writeStringField(3,we[re]);var Ie=le.values;for(re=0;re<Ie.length;re++)X.writeMessage(4,Ur,Ie[re])}function Lr(xe,X){var re=xe.feature;re.id!==void 0&&X.writeVarintField(1,re.id),X.writeMessage(2,rr,xe),X.writeVarintField(3,re.type),X.writeMessage(4,dr,re)}function rr(xe,X){var re=xe.feature,le=xe.keys,we=xe.values,Ie=xe.keycache,Oe=xe.valuecache;for(var $e in re.properties){var Fe=re.properties[$e],qe=Ie[$e];if(Fe!==null){qe===void 0&&(le.push($e),Ie[$e]=qe=le.length-1),X.writeVarint(qe);var kt=typeof Fe;kt!=="string"&&kt!=="boolean"&&kt!=="number"&&(Fe=JSON.stringify(Fe));var Et=kt+":"+Fe,er=Oe[Et];er===void 0&&(we.push(Fe),Oe[Et]=er=we.length-1),X.writeVarint(er)}}}function Zt(xe,X){return(X<<3)+(7&xe)}function dn(xe){return xe<<1^xe>>31}function dr(xe,X){for(var re=xe.loadGeometry(),le=xe.type,we=0,Ie=0,Oe=re.length,$e=0;$e<Oe;$e++){var Fe=re[$e],qe=1;le===1&&(qe=Fe.length),X.writeVarint(Zt(1,qe));for(var kt=le===3?Fe.length-1:Fe.length,Et=0;Et<kt;Et++){Et===1&&le!==1&&X.writeVarint(Zt(2,kt-1));var er=Fe[Et].x-we,pr=Fe[Et].y-Ie;X.writeVarint(dn(er)),X.writeVarint(dn(pr)),we+=er,Ie+=pr}le===3&&X.writeVarint(Zt(7,1))}}function Ur(xe,X){var re=typeof xe;re==="string"?X.writeStringField(1,xe):re==="boolean"?X.writeBooleanField(7,xe):re==="number"&&(xe%1!=0?X.writeDoubleField(3,xe):xe<0?X.writeSVarintField(6,xe):X.writeVarintField(5,xe))}et.exports=Jt,et.exports.fromVectorTileJs=Jt,et.exports.fromGeojsonVt=function(xe,X){X=X||{};var re={};for(var le in xe)re[le]=new tt(xe[le].features,X),re[le].name=le,re[le].version=X.version,re[le].extent=X.extent;return Jt({layers:re})},et.exports.GeoJSONWrapper=tt;var Tr=a.e1(et.exports);const wr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},Er=Math.fround||(Zn=new Float32Array(1),xe=>(Zn[0]=+xe,Zn[0]));var Zn;const fn=3,pn=5,li=6;class or{constructor(X){this.options=Object.assign(Object.create(wr),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:re,minZoom:le,maxZoom:we}=this.options;re&&console.time("total time");const Ie=`prepare ${X.length} points`;re&&console.time(Ie),this.points=X;const Oe=[];for(let Fe=0;Fe<X.length;Fe++){const qe=X[Fe];if(!qe.geometry)continue;const[kt,Et]=qe.geometry.coordinates,er=Er(_n(kt)),pr=Er(rn(Et));Oe.push(er,pr,1/0,Fe,-1,1),this.options.reduce&&Oe.push(0)}let $e=this.trees[we+1]=this._createTree(Oe);re&&console.timeEnd(Ie);for(let Fe=we;Fe>=le;Fe--){const qe=+Date.now();$e=this.trees[Fe]=this._createTree(this._cluster($e,Fe)),re&&console.log("z%d: %d clusters in %dms",Fe,$e.numItems,+Date.now()-qe)}return re&&console.timeEnd("total time"),this}getClusters(X,re){let le=((X[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,X[1]));let Ie=X[2]===180?180:((X[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)le=-180,Ie=180;else if(le>Ie){const Et=this.getClusters([le,we,180,Oe],re),er=this.getClusters([-180,we,Ie,Oe],re);return Et.concat(er)}const $e=this.trees[this._limitZoom(re)],Fe=$e.range(_n(le),rn(Oe),_n(Ie),rn(we)),qe=$e.data,kt=[];for(const Et of Fe){const er=this.stride*Et;kt.push(qe[er+pn]>1?Yt(qe,er,this.clusterProps):this.points[qe[er+fn]])}return kt}getChildren(X){const re=this._getOriginId(X),le=this._getOriginZoom(X),we="No cluster with the specified id.",Ie=this.trees[le];if(!Ie)throw new Error(we);const Oe=Ie.data;if(re*this.stride>=Oe.length)throw new Error(we);const $e=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Fe=Ie.within(Oe[re*this.stride],Oe[re*this.stride+1],$e),qe=[];for(const kt of Fe){const Et=kt*this.stride;Oe[Et+4]===X&&qe.push(Oe[Et+pn]>1?Yt(Oe,Et,this.clusterProps):this.points[Oe[Et+fn]])}if(qe.length===0)throw new Error(we);return qe}getLeaves(X,re,le){const we=[];return this._appendLeaves(we,X,re=re||10,le=le||0,0),we}getTile(X,re,le){const we=this.trees[this._limitZoom(X)],Ie=Math.pow(2,X),{extent:Oe,radius:$e}=this.options,Fe=$e/Oe,qe=(le-Fe)/Ie,kt=(le+1+Fe)/Ie,Et={features:[]};return this._addTileFeatures(we.range((re-Fe)/Ie,qe,(re+1+Fe)/Ie,kt),we.data,re,le,Ie,Et),re===0&&this._addTileFeatures(we.range(1-Fe/Ie,qe,1,kt),we.data,Ie,le,Ie,Et),re===Ie-1&&this._addTileFeatures(we.range(0,qe,Fe/Ie,kt),we.data,-1,le,Ie,Et),Et.features.length?Et:null}getClusterExpansionZoom(X){let re=this._getOriginZoom(X)-1;for(;re<=this.options.maxZoom;){const le=this.getChildren(X);if(re++,le.length!==1)break;X=le[0].properties.cluster_id}return re}_appendLeaves(X,re,le,we,Ie){const Oe=this.getChildren(re);for(const $e of Oe){const Fe=$e.properties;if(Fe&&Fe.cluster?Ie+Fe.point_count<=we?Ie+=Fe.point_count:Ie=this._appendLeaves(X,Fe.cluster_id,le,we,Ie):Ie<we?Ie++:X.push($e),X.length===le)break}return Ie}_createTree(X){const re=new a.cK(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<X.length;le+=this.stride)re.add(X[le],X[le+1]);return re.finish(),re.data=X,re}_addTileFeatures(X,re,le,we,Ie,Oe){for(const $e of X){const Fe=$e*this.stride,qe=re[Fe+pn]>1;let kt,Et,er;if(qe)kt=un(re,Fe,this.clusterProps),Et=re[Fe],er=re[Fe+1];else{const Pr=this.points[re[Fe+fn]];kt=Pr.properties;const[Ar,Yr]=Pr.geometry.coordinates;Et=_n(Ar),er=rn(Yr)}const pr={type:1,geometry:[[Math.round(this.options.extent*(Et*Ie-le)),Math.round(this.options.extent*(er*Ie-we))]],tags:kt};let kr;kr=qe||this.options.generateId?re[Fe+fn]:this.points[re[Fe+fn]].id,kr!==void 0&&(pr.id=kr),Oe.features.push(pr)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,re){const{radius:le,extent:we,reduce:Ie,minPoints:Oe}=this.options,$e=le/(we*Math.pow(2,re)),Fe=X.data,qe=[],kt=this.stride;for(let Et=0;Et<Fe.length;Et+=kt){if(Fe[Et+2]<=re)continue;Fe[Et+2]=re;const er=Fe[Et],pr=Fe[Et+1],kr=X.within(Fe[Et],Fe[Et+1],$e),Pr=Fe[Et+pn];let Ar=Pr;for(const Yr of kr){const Qt=Yr*kt;Fe[Qt+2]>re&&(Ar+=Fe[Qt+pn])}if(Ar>Pr&&Ar>=Oe){let Yr,Qt=er*Pr,xr=pr*Pr,Dr=-1;const zr=(Et/kt<<5)+(re+1)+this.points.length;for(const Jr of kr){const An=Jr*kt;if(Fe[An+2]<=re)continue;Fe[An+2]=re;const Si=Fe[An+pn];Qt+=Fe[An]*Si,xr+=Fe[An+1]*Si,Fe[An+4]=zr,Ie&&(Yr||(Yr=this._map(Fe,Et,!0),Dr=this.clusterProps.length,this.clusterProps.push(Yr)),Ie(Yr,this._map(Fe,An)))}Fe[Et+4]=zr,qe.push(Qt/Ar,xr/Ar,1/0,zr,-1,Ar),Ie&&qe.push(Dr)}else{for(let Yr=0;Yr<kt;Yr++)qe.push(Fe[Et+Yr]);if(Ar>1)for(const Yr of kr){const Qt=Yr*kt;if(!(Fe[Qt+2]<=re)){Fe[Qt+2]=re;for(let xr=0;xr<kt;xr++)qe.push(Fe[Qt+xr])}}}}return qe}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,re,le){if(X[re+pn]>1){const Oe=this.clusterProps[X[re+li]];return le?Object.assign({},Oe):Oe}const we=this.points[X[re+fn]].properties,Ie=this.options.map(we);return le&&Ie===we?Object.assign({},Ie):Ie}}function Yt(xe,X,re){return{type:"Feature",id:xe[X+fn],properties:un(xe,X,re),geometry:{type:"Point",coordinates:[(le=xe[X],360*(le-.5)),ri(xe[X+1])]}};var le}function un(xe,X,re){const le=xe[X+pn],we=le>=1e4?`${Math.round(le/1e3)}k`:le>=1e3?Math.round(le/100)/10+"k":le,Ie=xe[X+li],Oe=Ie===-1?{}:Object.assign({},re[Ie]);return Object.assign(Oe,{cluster:!0,cluster_id:xe[X+fn],point_count:le,point_count_abbreviated:we})}function _n(xe){return xe/360+.5}function rn(xe){const X=Math.sin(xe*Math.PI/180),re=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return re<0?0:re>1?1:re}function ri(xe){const X=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function Ln(xe,X,re,le){let we=le;const Ie=X+(re-X>>1);let Oe,$e=re-X;const Fe=xe[X],qe=xe[X+1],kt=xe[re],Et=xe[re+1];for(let er=X+3;er<re;er+=3){const pr=Vn(xe[er],xe[er+1],Fe,qe,kt,Et);if(pr>we)Oe=er,we=pr;else if(pr===we){const kr=Math.abs(er-Ie);kr<$e&&(Oe=er,$e=kr)}}we>le&&(Oe-X>3&&Ln(xe,X,Oe,le),xe[Oe+2]=we,re-Oe>3&&Ln(xe,Oe,re,le))}function Vn(xe,X,re,le,we,Ie){let Oe=we-re,$e=Ie-le;if(Oe!==0||$e!==0){const Fe=((xe-re)*Oe+(X-le)*$e)/(Oe*Oe+$e*$e);Fe>1?(re=we,le=Ie):Fe>0&&(re+=Oe*Fe,le+=$e*Fe)}return Oe=xe-re,$e=X-le,Oe*Oe+$e*$e}function Xr(xe,X,re,le){const we={id:xe??null,type:X,geometry:re,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(X==="Point"||X==="MultiPoint"||X==="LineString")yr(we,re);else if(X==="Polygon")yr(we,re[0]);else if(X==="MultiLineString")for(const Ie of re)yr(we,Ie);else if(X==="MultiPolygon")for(const Ie of re)yr(we,Ie[0]);return we}function yr(xe,X){for(let re=0;re<X.length;re+=3)xe.minX=Math.min(xe.minX,X[re]),xe.minY=Math.min(xe.minY,X[re+1]),xe.maxX=Math.max(xe.maxX,X[re]),xe.maxY=Math.max(xe.maxY,X[re+1])}function xi(xe,X,re,le){if(!X.geometry)return;const we=X.geometry.coordinates;if(we&&we.length===0)return;const Ie=X.geometry.type,Oe=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let $e=[],Fe=X.id;if(re.promoteId?Fe=X.properties[re.promoteId]:re.generateId&&(Fe=le||0),Ie==="Point")Ei(we,$e);else if(Ie==="MultiPoint")for(const qe of we)Ei(qe,$e);else if(Ie==="LineString")$i(we,$e,Oe,!1);else if(Ie==="MultiLineString"){if(re.lineMetrics){for(const qe of we)$e=[],$i(qe,$e,Oe,!1),xe.push(Xr(Fe,"LineString",$e,X.properties));return}vr(we,$e,Oe,!1)}else if(Ie==="Polygon")vr(we,$e,Oe,!0);else{if(Ie!=="MultiPolygon"){if(Ie==="GeometryCollection"){for(const qe of X.geometry.geometries)xi(xe,{id:Fe,geometry:qe,properties:X.properties},re,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const qe of we){const kt=[];vr(qe,kt,Oe,!0),$e.push(kt)}}xe.push(Xr(Fe,Ie,$e,X.properties))}function Ei(xe,X){X.push(nn(xe[0]),Hn(xe[1]),0)}function $i(xe,X,re,le){let we,Ie,Oe=0;for(let Fe=0;Fe<xe.length;Fe++){const qe=nn(xe[Fe][0]),kt=Hn(xe[Fe][1]);X.push(qe,kt,0),Fe>0&&(Oe+=le?(we*kt-qe*Ie)/2:Math.sqrt(Math.pow(qe-we,2)+Math.pow(kt-Ie,2))),we=qe,Ie=kt}const $e=X.length-3;X[2]=1,Ln(X,0,$e,re),X[$e+2]=1,X.size=Math.abs(Oe),X.start=0,X.end=X.size}function vr(xe,X,re,le){for(let we=0;we<xe.length;we++){const Ie=[];$i(xe[we],Ie,re,le),X.push(Ie)}}function nn(xe){return xe/360+.5}function Hn(xe){const X=Math.sin(xe*Math.PI/180),re=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return re<0?0:re>1?1:re}function cr(xe,X,re,le,we,Ie,Oe,$e){if(le/=X,Ie>=(re/=X)&&Oe<le)return xe;if(Oe<re||Ie>=le)return null;const Fe=[];for(const qe of xe){const kt=qe.geometry;let Et=qe.type;const er=we===0?qe.minX:qe.minY,pr=we===0?qe.maxX:qe.maxY;if(er>=re&&pr<le){Fe.push(qe);continue}if(pr<re||er>=le)continue;let kr=[];if(Et==="Point"||Et==="MultiPoint")Is(kt,kr,re,le,we);else if(Et==="LineString")Mn(kt,kr,re,le,we,!1,$e.lineMetrics);else if(Et==="MultiLineString")_o(kt,kr,re,le,we,!1);else if(Et==="Polygon")_o(kt,kr,re,le,we,!0);else if(Et==="MultiPolygon")for(const Pr of kt){const Ar=[];_o(Pr,Ar,re,le,we,!0),Ar.length&&kr.push(Ar)}if(kr.length){if($e.lineMetrics&&Et==="LineString"){for(const Pr of kr)Fe.push(Xr(qe.id,Et,Pr,qe.tags));continue}Et!=="LineString"&&Et!=="MultiLineString"||(kr.length===1?(Et="LineString",kr=kr[0]):Et="MultiLineString"),Et!=="Point"&&Et!=="MultiPoint"||(Et=kr.length===3?"Point":"MultiPoint"),Fe.push(Xr(qe.id,Et,kr,qe.tags))}}return Fe.length?Fe:null}function Is(xe,X,re,le,we){for(let Ie=0;Ie<xe.length;Ie+=3){const Oe=xe[Ie+we];Oe>=re&&Oe<=le&&ci(X,xe[Ie],xe[Ie+1],xe[Ie+2])}}function Mn(xe,X,re,le,we,Ie,Oe){let $e=Xi(xe);const Fe=we===0?Bi:Ms;let qe,kt,Et=xe.start;for(let Ar=0;Ar<xe.length-3;Ar+=3){const Yr=xe[Ar],Qt=xe[Ar+1],xr=xe[Ar+2],Dr=xe[Ar+3],zr=xe[Ar+4],Jr=we===0?Yr:Qt,An=we===0?Dr:zr;let Si=!1;Oe&&(qe=Math.sqrt(Math.pow(Yr-Dr,2)+Math.pow(Qt-zr,2))),Jr<re?An>re&&(kt=Fe($e,Yr,Qt,Dr,zr,re),Oe&&($e.start=Et+qe*kt)):Jr>le?An<le&&(kt=Fe($e,Yr,Qt,Dr,zr,le),Oe&&($e.start=Et+qe*kt)):ci($e,Yr,Qt,xr),An<re&&Jr>=re&&(kt=Fe($e,Yr,Qt,Dr,zr,re),Si=!0),An>le&&Jr<=le&&(kt=Fe($e,Yr,Qt,Dr,zr,le),Si=!0),!Ie&&Si&&(Oe&&($e.end=Et+qe*kt),X.push($e),$e=Xi(xe)),Oe&&(Et+=qe)}let er=xe.length-3;const pr=xe[er],kr=xe[er+1],Pr=we===0?pr:kr;Pr>=re&&Pr<=le&&ci($e,pr,kr,xe[er+2]),er=$e.length-3,Ie&&er>=3&&($e[er]!==$e[0]||$e[er+1]!==$e[1])&&ci($e,$e[0],$e[1],$e[2]),$e.length&&X.push($e)}function Xi(xe){const X=[];return X.size=xe.size,X.start=xe.start,X.end=xe.end,X}function _o(xe,X,re,le,we,Ie){for(const Oe of xe)Mn(Oe,X,re,le,we,Ie,!1)}function ci(xe,X,re,le){xe.push(X,re,le)}function Bi(xe,X,re,le,we,Ie){const Oe=(Ie-X)/(le-X);return ci(xe,Ie,re+(we-re)*Oe,1),Oe}function Ms(xe,X,re,le,we,Ie){const Oe=(Ie-re)/(we-re);return ci(xe,X+(le-X)*Oe,Ie,1),Oe}function fs(xe,X){const re=[];for(let le=0;le<xe.length;le++){const we=xe[le],Ie=we.type;let Oe;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")Oe=Cr(we.geometry,X);else if(Ie==="MultiLineString"||Ie==="Polygon"){Oe=[];for(const $e of we.geometry)Oe.push(Cr($e,X))}else if(Ie==="MultiPolygon"){Oe=[];for(const $e of we.geometry){const Fe=[];for(const qe of $e)Fe.push(Cr(qe,X));Oe.push(Fe)}}re.push(Xr(we.id,Ie,Oe,we.tags))}return re}function Cr(xe,X){const re=[];re.size=xe.size,xe.start!==void 0&&(re.start=xe.start,re.end=xe.end);for(let le=0;le<xe.length;le+=3)re.push(xe[le]+X,xe[le+1],xe[le+2]);return re}function Je(xe,X){if(xe.transformed)return xe;const re=1<<xe.z,le=xe.x,we=xe.y;for(const Ie of xe.features){const Oe=Ie.geometry,$e=Ie.type;if(Ie.geometry=[],$e===1)for(let Fe=0;Fe<Oe.length;Fe+=2)Ie.geometry.push(Vt(Oe[Fe],Oe[Fe+1],X,re,le,we));else for(let Fe=0;Fe<Oe.length;Fe++){const qe=[];for(let kt=0;kt<Oe[Fe].length;kt+=2)qe.push(Vt(Oe[Fe][kt],Oe[Fe][kt+1],X,re,le,we));Ie.geometry.push(qe)}}return xe.transformed=!0,xe}function Vt(xe,X,re,le,we,Ie){return[Math.round(re*(xe*le-we)),Math.round(re*(X*le-Ie))]}function Ct(xe,X,re,le,we){const Ie=X===we.maxZoom?0:we.tolerance/((1<<X)*we.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:re,y:le,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const $e of xe)Wt(Oe,$e,Ie,we);return Oe}function Wt(xe,X,re,le){const we=X.geometry,Ie=X.type,Oe=[];if(xe.minX=Math.min(xe.minX,X.minX),xe.minY=Math.min(xe.minY,X.minY),xe.maxX=Math.max(xe.maxX,X.maxX),xe.maxY=Math.max(xe.maxY,X.maxY),Ie==="Point"||Ie==="MultiPoint")for(let $e=0;$e<we.length;$e+=3)Oe.push(we[$e],we[$e+1]),xe.numPoints++,xe.numSimplified++;else if(Ie==="LineString")ir(Oe,we,xe,re,!1,!1);else if(Ie==="MultiLineString"||Ie==="Polygon")for(let $e=0;$e<we.length;$e++)ir(Oe,we[$e],xe,re,Ie==="Polygon",$e===0);else if(Ie==="MultiPolygon")for(let $e=0;$e<we.length;$e++){const Fe=we[$e];for(let qe=0;qe<Fe.length;qe++)ir(Oe,Fe[qe],xe,re,!0,qe===0)}if(Oe.length){let $e=X.tags||null;if(Ie==="LineString"&&le.lineMetrics){$e={};for(const qe in X.tags)$e[qe]=X.tags[qe];$e.mapbox_clip_start=we.start/we.size,$e.mapbox_clip_end=we.end/we.size}const Fe={geometry:Oe,type:Ie==="Polygon"||Ie==="MultiPolygon"?3:Ie==="LineString"||Ie==="MultiLineString"?2:1,tags:$e};X.id!==null&&(Fe.id=X.id),xe.features.push(Fe)}}function ir(xe,X,re,le,we,Ie){const Oe=le*le;if(le>0&&X.size<(we?Oe:le))return void(re.numPoints+=X.length/3);const $e=[];for(let Fe=0;Fe<X.length;Fe+=3)(le===0||X[Fe+2]>Oe)&&(re.numSimplified++,$e.push(X[Fe],X[Fe+1])),re.numPoints++;we&&function(Fe,qe){let kt=0;for(let Et=0,er=Fe.length,pr=er-2;Et<er;pr=Et,Et+=2)kt+=(Fe[Et]-Fe[pr])*(Fe[Et+1]+Fe[pr+1]);if(kt>0===qe)for(let Et=0,er=Fe.length;Et<er/2;Et+=2){const pr=Fe[Et],kr=Fe[Et+1];Fe[Et]=Fe[er-2-Et],Fe[Et+1]=Fe[er-1-Et],Fe[er-2-Et]=pr,Fe[er-1-Et]=kr}}($e,Ie),xe.push($e)}const ur={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Be{constructor(X,re){const le=(re=this.options=function(Ie,Oe){for(const $e in Oe)Ie[$e]=Oe[$e];return Ie}(Object.create(ur),re)).debug;if(le&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=function(Ie,Oe){const $e=[];if(Ie.type==="FeatureCollection")for(let Fe=0;Fe<Ie.features.length;Fe++)xi($e,Ie.features[Fe],Oe,Fe);else xi($e,Ie.type==="Feature"?Ie:{geometry:Ie},Oe);return $e}(X,re);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=function(Ie,Oe){const $e=Oe.buffer/Oe.extent;let Fe=Ie;const qe=cr(Ie,1,-1-$e,$e,0,-1,2,Oe),kt=cr(Ie,1,1-$e,2+$e,0,-1,2,Oe);return(qe||kt)&&(Fe=cr(Ie,1,-$e,1+$e,0,-1,2,Oe)||[],qe&&(Fe=fs(qe,1).concat(Fe)),kt&&(Fe=Fe.concat(fs(kt,-1)))),Fe}(we,re),we.length&&this.splitTile(we,0,0,0),le&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(X,re,le,we,Ie,Oe,$e){const Fe=[X,re,le,we],qe=this.options,kt=qe.debug;for(;Fe.length;){we=Fe.pop(),le=Fe.pop(),re=Fe.pop(),X=Fe.pop();const Et=1<<re,er=ze(re,le,we);let pr=this.tiles[er];if(!pr&&(kt>1&&console.time("creation"),pr=this.tiles[er]=Ct(X,re,le,we,qe),this.tileCoords.push({z:re,x:le,y:we}),kt)){kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,le,we,pr.numFeatures,pr.numPoints,pr.numSimplified),console.timeEnd("creation"));const Si=`z${re}`;this.stats[Si]=(this.stats[Si]||0)+1,this.total++}if(pr.source=X,Ie==null){if(re===qe.indexMaxZoom||pr.numPoints<=qe.indexMaxPoints)continue}else{if(re===qe.maxZoom||re===Ie)continue;if(Ie!=null){const Si=Ie-re;if(le!==Oe>>Si||we!==$e>>Si)continue}}if(pr.source=null,X.length===0)continue;kt>1&&console.time("clipping");const kr=.5*qe.buffer/qe.extent,Pr=.5-kr,Ar=.5+kr,Yr=1+kr;let Qt=null,xr=null,Dr=null,zr=null,Jr=cr(X,Et,le-kr,le+Ar,0,pr.minX,pr.maxX,qe),An=cr(X,Et,le+Pr,le+Yr,0,pr.minX,pr.maxX,qe);X=null,Jr&&(Qt=cr(Jr,Et,we-kr,we+Ar,1,pr.minY,pr.maxY,qe),xr=cr(Jr,Et,we+Pr,we+Yr,1,pr.minY,pr.maxY,qe),Jr=null),An&&(Dr=cr(An,Et,we-kr,we+Ar,1,pr.minY,pr.maxY,qe),zr=cr(An,Et,we+Pr,we+Yr,1,pr.minY,pr.maxY,qe),An=null),kt>1&&console.timeEnd("clipping"),Fe.push(Qt||[],re+1,2*le,2*we),Fe.push(xr||[],re+1,2*le,2*we+1),Fe.push(Dr||[],re+1,2*le+1,2*we),Fe.push(zr||[],re+1,2*le+1,2*we+1)}}getTile(X,re,le){X=+X,re=+re,le=+le;const we=this.options,{extent:Ie,debug:Oe}=we;if(X<0||X>24)return null;const $e=1<<X,Fe=ze(X,re=re+$e&$e-1,le);if(this.tiles[Fe])return Je(this.tiles[Fe],Ie);Oe>1&&console.log("drilling down to z%d-%d-%d",X,re,le);let qe,kt=X,Et=re,er=le;for(;!qe&&kt>0;)kt--,Et>>=1,er>>=1,qe=this.tiles[ze(kt,Et,er)];return qe&&qe.source?(Oe>1&&(console.log("found parent tile z%d-%d-%d",kt,Et,er),console.time("drilling down")),this.splitTile(qe.source,kt,Et,er,X,re,le),Oe>1&&console.timeEnd("drilling down"),this.tiles[Fe]?Je(this.tiles[Fe],Ie):null):null}}function ze(xe,X,re){return 32*((1<<xe)*re+X)+xe}function lt(xe,X){const re=xe.tileID.canonical;if(!this._geoJSONIndex)return X(null,null);const le=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!le)return X(null,null);const we=new J(le.features);let Ie=Tr(we);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),X(null,{vectorTile:we,rawData:Ie.buffer})}class mt extends q{constructor(X,re,le,we,Ie,Oe){super(X,re,le,we,lt,Oe),Ie&&(this.loadGeoJSON=Ie),this._dynamicIndex=new de}loadData(X,re){const le=X&&X.request,we=le&&le.collectResourceTiming;this.loadGeoJSON(X,(Ie,Oe)=>{if(Ie||!Oe)return re(Ie);if(typeof Oe!="object")return re(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{try{if(X.filter){const Fe=a.y(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Fe.result==="error")throw new Error(Fe.value.map(qe=>`${qe.key}: ${qe.message}`).join(", "));Oe.features=Oe.features.filter(qe=>Fe.value.evaluate({zoom:0},qe))}X.dynamic?(Oe.type==="Feature"&&(Oe={type:"FeatureCollection",features:[Oe]}),X.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Oe.features,this.loaded),X.cluster&&(Oe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=X.cluster?new or(function({superclusterOptions:Fe,clusterProperties:qe}){if(!qe||!Fe)return Fe;const kt={},Et={},er={accumulated:null,zoom:0},pr={properties:null},kr=Object.keys(qe);for(const Pr of kr){const[Ar,Yr]=qe[Pr],Qt=a.y(Yr),xr=a.y(typeof Ar=="string"?[Ar,["accumulated"],["get",Pr]]:Ar);kt[Pr]=Qt.value,Et[Pr]=xr.value}return Fe.map=Pr=>{pr.properties=Pr;const Ar={};for(const Yr of kr)Ar[Yr]=kt[Yr].evaluate(er,pr);return Ar},Fe.reduce=(Pr,Ar)=>{pr.properties=Ar;for(const Yr of kr)er.accumulated=Pr[Yr],Pr[Yr]=Et[Yr].evaluate(er,pr)},Fe}(X)).load(Oe.features):X.dynamic?this._dynamicIndex:function(Fe,qe){return new Be(Fe,qe)}(Oe,X.geojsonVtOptions)}catch(Fe){return re(Fe)}const $e={};if(we){const Fe=C(le);Fe&&($e.resourceTiming={},$e.resourceTiming[X.source]=JSON.parse(JSON.stringify(Fe)))}re(null,$e)}})}reloadTile(X,re){const le=this.loaded;return le&&le[X.uid]?X.partial?re(null,void 0):super.reloadTile(X,re):this.loadTile(X,re)}loadGeoJSON(X,re){if(X.request)a.g(X.request,re);else{if(typeof X.data!="string")return re(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(X.data))}catch{return re(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(X,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(X.clusterId))}catch(le){re(le)}}getClusterChildren(X,re){try{re(null,this._geoJSONIndex.getChildren(X.clusterId))}catch(le){re(le)}}getClusterLeaves(X,re){try{re(null,this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset))}catch(le){re(le)}}}class qt{constructor(X,re){this.tileID=new a.aL(X.tileID.overscaledZ,X.tileID.wrap,X.tileID.canonical.z,X.tileID.canonical.x,X.tileID.canonical.y),this.tileZoom=X.tileZoom,this.uid=X.uid,this.zoom=X.zoom,this.canonical=X.tileID.canonical,this.pixelRatio=X.pixelRatio,this.tileSize=X.tileSize,this.source=X.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=X.projection,this.brightness=re}parse(X,re,le,we){this.status="parsing";const Ie=new a.aL(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),Oe={},$e=re.familiesBySource[le.source],Fe=new a.dN(Ie,le.promoteId);return Fe.bucketLayerIDs=[],Fe.is3DTile=!0,a.e3(X).then(qe=>{if(!qe)return we(new Error("Could not parse tile"));const kt=a.e4(qe,1/a.b5(le.tileID.canonical)),Et=qe.json.extensionsUsed&&qe.json.extensionsUsed.includes("MAPBOX_mesh_features")||qe.json.asset.extras&&qe.json.asset.extras.MAPBOX_mesh_features,er=qe.json.extensionsUsed&&qe.json.extensionsUsed.includes("EXT_meshopt_compression"),pr=new a.X(this.zoom,{brightness:this.brightness});for(const kr in $e)for(const Pr of $e[kr]){const Ar=Pr[0];Fe.bucketLayerIDs.push(Pr.map(Qt=>Qt.id)),Ar.recalculate(pr,[]);const Yr=new a.e5(kt,Ie,Et,er,this.brightness,Fe);Et||(Yr.needsUpload=!0),Oe[Ar.fqid]=Yr,Yr.evaluate(Ar)}this.status="done",we(null,{buckets:Oe,featureIndex:Fe})}).catch(qe=>we(new Error(qe.message)))}}class ar{constructor(X,re,le,we,Ie,Oe){this.actor=X,this.layerIndex=re,this.brightness=Oe,this.loading={},this.loaded={}}loadTile(X,re){const le=X.uid,we=this.loading[le]=new qt(X,this.brightness);a.e2(X.request,(Ie,Oe)=>{const $e=!this.loading[le];return delete this.loading[le],$e||Ie?(we.status="done",$e||(this.loaded[le]=we),re(Ie)):Oe&&Oe.byteLength!==0?void we.parse(Oe,this.layerIndex,X,(Fe,qe)=>{we.status="done",this.loaded=this.loaded||{},this.loaded[le]=we,Fe||!qe?re(Fe):re(null,qe)}):(we.status="done",this.loaded[le]=we,re())})}reloadTile(X,re){const le=this.loaded,we=X.uid;if(le&&le[we]){const Ie=le[we];Ie.projection=X.projection,Ie.brightness=X.brightness;const Oe=($e,Fe)=>{Ie.reloadCallback&&(delete Ie.reloadCallback,this.loadTile(X,re)),re($e,Fe)};Ie.status==="parsing"?Ie.reloadCallback=Oe:Ie.status==="done"&&this.loadTile(X,re)}}abortTile(X,re){const le=X.uid;this.loading[le]&&delete this.loading[le],re()}removeTile(X,re){const le=this.loaded,we=X.uid;le&&le[we]&&delete le[we],re()}}class gr{constructor(X){this.self=X,this.actor=new a.e6(X,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.aJ({name:"mercator"}),this.workerSourceTypes={vector:q,geojson:mt,"batched-model":ar},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,le)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=le},this.self.registerRTLTextPlugin=re=>{if(a.e7.isParsed())throw new Error("RTL text plugin already registered.");a.e7.applyArabicShaping=re.applyArabicShaping,a.e7.processBidirectionalText=re.processBidirectionalText,a.e7.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(X,re,le){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X],delete this.rasterArrayWorkerSource,le()}checkIfReady(X,re,le){le()}setReferrer(X,re){this.referrer=re}spriteLoaded(X,{scope:re,isLoaded:le}){if(this.isSpriteLoaded[X]||(this.isSpriteLoaded[X]={}),this.isSpriteLoaded[X][re]=le,this.workerSources[X]&&this.workerSources[X][re])for(const we in this.workerSources[X][re]){const Ie=this.workerSources[X][re][we];for(const Oe in Ie){const $e=Ie[Oe];$e instanceof q&&($e.isSpriteLoaded=le,$e.fire(new a.f("isSpriteLoaded")))}}}setImages(X,{scope:re,images:le},we){if(this.availableImages[X]||(this.availableImages[X]={}),this.availableImages[X][re]=le,this.workerSources[X]&&this.workerSources[X][re]){for(const Ie in this.workerSources[X][re]){const Oe=this.workerSources[X][re][Ie];for(const $e in Oe)Oe[$e].availableImages=le}we()}else we()}setProjection(X,re){this.projections[X]=a.aJ(re)}setBrightness(X,re,le){this.brightness=re,le()}setLayers(X,re,le){this.getLayerIndex(X,re.scope).replace(re.layers,re.options),le()}updateLayers(X,re,le){this.getLayerIndex(X,re.scope).update(re.layers,re.removedIds,re.options),le()}loadTile(X,re,le){re.projection=this.projections[X]||this.defaultProjection,this.getWorkerSource(X,re.type,re.source,re.scope).loadTile(re,le)}loadDEMTile(X,re,le){this.getDEMWorkerSource(X,re.source,re.scope).loadTile(re,le)}decodeRasterArray(X,re,le){this.getRasterArrayWorkerSource().decodeRasterArray(re,le)}reloadTile(X,re,le){re.projection=this.projections[X]||this.defaultProjection,this.getWorkerSource(X,re.type,re.source,re.scope).reloadTile(re,le)}abortTile(X,re,le){this.getWorkerSource(X,re.type,re.source,re.scope).abortTile(re,le)}removeTile(X,re,le){this.getWorkerSource(X,re.type,re.source,re.scope).removeTile(re,le)}removeSource(X,re,le){if(!(this.workerSources[X]&&this.workerSources[X][re.scope]&&this.workerSources[X][re.scope][re.type]&&this.workerSources[X][re.scope][re.type][re.source]))return;const we=this.workerSources[X][re.scope][re.type][re.source];delete this.workerSources[X][re.scope][re.type][re.source],we.removeSource!==void 0?we.removeSource(re,le):le()}loadWorkerSource(X,re,le){try{this.self.importScripts(re.url),le()}catch(we){le(we.toString())}}syncRTLPluginState(X,re,le){try{a.e7.setState(re);const we=a.e7.getPluginURL();if(a.e7.isLoaded()&&!a.e7.isParsed()&&we!=null){this.self.importScripts(we);const Ie=a.e7.isParsed();le(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),Ie)}}catch(we){le(we.toString())}}setDracoUrl(X,re){this.dracoUrl=re}getAvailableImages(X,re){this.availableImages[X]||(this.availableImages[X]={});let le=this.availableImages[X][re];return le||(le=[]),le}getLayerIndex(X,re){this.layerIndexes[X]||(this.layerIndexes[X]={});let le=this.layerIndexes[X][re];return le||(le=this.layerIndexes[X][re]=new O,le.scope=re),le}getWorkerSource(X,re,le,we){return this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][we]||(this.workerSources[X][we]={}),this.workerSources[X][we][re]||(this.workerSources[X][we][re]={}),this.isSpriteLoaded[X]||(this.isSpriteLoaded[X]={}),this.workerSources[X][we][re][le]||(this.workerSources[X][we][re][le]=new this.workerSourceTypes[re]({send:(Ie,Oe,$e,Fe,qe,kt)=>{this.actor.send(Ie,Oe,$e,X,qe,kt)},scheduler:this.actor.scheduler},this.getLayerIndex(X,we),this.getAvailableImages(X,we),this.isSpriteLoaded[X][we],void 0,this.brightness)),this.workerSources[X][we][re][le]}getDEMWorkerSource(X,re,le){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][le]||(this.demWorkerSources[X][le]={}),this.demWorkerSources[X][le][re]||(this.demWorkerSources[X][le][re]=new j),this.demWorkerSources[X][le][re]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new H),this.rasterArrayWorkerSource}enforceCacheSizeLimit(X,re){a.e8(re)}getWorkerPerformanceMetrics(X,re,le){le(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new gr(self)),gr}),_(["./shared"],function(a){function C(g,l){if(Array.isArray(g)){if(!Array.isArray(l)||g.length!==l.length)return!1;for(let f=0;f<g.length;f++)if(!C(g[f],l[f]))return!1;return!0}if(typeof g=="object"&&g!==null&&l!==null){if(typeof l!="object"||Object.keys(g).length!==Object.keys(l).length)return!1;for(const f in g)if(!C(g[f],l[f]))return!1;return!0}return g===l}var A=k;function k(g){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,E=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(E);try{w=new Worker(T),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(T),y}()?function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var E=w.getImageData(0,0,1,1);return E&&E.width===y.width}()?(O[f=l&&l.failIfMajorPerformanceCaveat]===void 0&&(O[f]=function(y){var w,E=function(T){var M=document.createElement("canvas"),L=Object.create(k.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=T,M.getContext("webgl2",L)}(y);if(!E)return!1;try{w=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!w||E.isContextLost())&&(E.shaderSource(w,"void main() {}"),E.compileShader(w),E.getShaderParameter(w,E.COMPILE_STATUS)===!0)}(f)),O[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var f}(g)}var O={};function R(g,l,f){const y=document.createElement(g);return l!=null&&(y.className=l),f&&f.appendChild(y),y}function z(g,l,f){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const w of Object.keys(l))y.setAttributeNS(null,w,String(l[w]));return f&&f.appendChild(y),y}k.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const N=typeof document<"u"?document.documentElement&&document.documentElement.style:null,K=N&&N.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;function j(){N&&K&&(q=N[K],N[K]="none")}function H(){N&&K&&(N[K]=q)}function Y(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",Y,!0)}function te(){window.addEventListener("click",Y,!0),window.setTimeout(()=>{window.removeEventListener("click",Y,!0)},0)}function J(g,l){const f=g.getBoundingClientRect();return Me(g,f,l)}function ae(g,l){const f=g.getBoundingClientRect(),y=[];for(let w=0;w<l.length;w++)y.push(Me(g,f,l[w]));return y}function de(g){return window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function Me(g,l,f){const y=g.offsetWidth===l.width?1:g.offsetWidth/l.width;return new a.P((f.clientX-l.left)*y,(f.clientY-l.top)*y)}class Ce{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(l,f){this._updatedSourceCaches[l]=f,this.setDirty()}discardSourceCacheUpdate(l){delete this._updatedSourceCaches[l]}updateLayer(l){const f=l.scope;this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._updatedLayers[f].add(l.id),this.setDirty()}removeLayer(l){const f=l.scope;this._removedLayers[f]=this._removedLayers[f]||{},this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._removedLayers[f][l.id]=l,this._updatedLayers[f].delete(l.id),this._updatedPaintProps.delete(l.fqid),this.setDirty()}getRemovedLayer(l){return this._removedLayers[l.scope]?this._removedLayers[l.scope][l.id]:null}discardLayerRemoval(l){this._removedLayers[l.scope]&&delete this._removedLayers[l.scope][l.id]}getLayerUpdatesByScope(){const l={};for(const f in this._updatedLayers)l[f]=l[f]||{},l[f].updatedIds=Array.from(this._updatedLayers[f].values());for(const f in this._removedLayers)l[f]=l[f]||{},l[f].removedIds=Object.keys(this._removedLayers[f]);return l}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(l){this._updatedPaintProps.add(l.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(l){this._updatedImages.add(l),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const Ae={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ne{constructor(l,f,y,w,E,T){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.instanceCount=T,this.context=l;const M=l.gl;this.buffer=M.createBuffer(),l.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||E||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,f){for(let y=0;y<this.attributes.length;y++){const w=f.attributes[this.attributes[y].name];w!==void 0&&l.enableVertexAttribArray(w)}}setVertexAttribPointers(l,f,y){for(let w=0;w<this.attributes.length;w++){const E=this.attributes[w],T=f.attributes[E.name];T!==void 0&&l.vertexAttribPointer(T,E.components,l[Ae[E.type]],!1,this.itemSize,E.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(l,f,y){for(let w=0;w<this.attributes.length;w++){const E=f.attributes[this.attributes[w].name];E!==void 0&&this.instanceCount&&this.instanceCount>0&&l.vertexAttribDivisor(E,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Re{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ye extends Re{getDefault(){return a.C.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ht extends Re{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ft extends Re{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class et extends Re{getDefault(){return[!0,!0,!0,!0]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Xe extends Re{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Mt extends Re{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Lt extends Re{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const f=this.current;(l.func!==f.func||l.ref!==f.ref||l.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class nt extends Re{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class at extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=l,this.dirty=!1}}class it extends Re{getDefault(){return[0,1]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class tt extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=l,this.dirty=!1}}class Jt extends Re{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class $t extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.BLEND):f.disable(f.BLEND),this.current=l,this.dirty=!1}}class Lr extends Re{getDefault(){const l=this.gl;return[l.ONE,l.ZERO,l.ONE,l.ZERO]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.blendFuncSeparate(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class rr extends Re{getDefault(){return a.C.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Zt extends Re{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(l,l),this.current=l,this.dirty=!1)}}class dn extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=l,this.dirty=!1}}class dr extends Re{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Ur extends Re{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let Tr=class extends Re{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class wr extends Re{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Er extends Re{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Zn extends Re{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class fn extends Re{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class pn extends Re{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class li extends Re{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class or extends Re{getDefault(){return null}set(l){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Yt extends Re{getDefault(){return null}set(l){this.gl&&(l!==this.current||this.dirty)&&(this.gl.bindVertexArray(l),this.current=l,this.dirty=!1)}}class un extends Re{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class _n extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class rn extends Re{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class ri extends Re{constructor(l,f){super(l),this.context=l,this.parent=f}getDefault(){return null}}class Ln extends ri{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Vn extends ri{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Xr extends ri{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,this.attachment(),f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class yr extends Vn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xi{constructor(l,f,y,w,E){this.context=l,this.width=f,this.height=y;const T=this.framebuffer=l.gl.createFramebuffer();w&&(this.colorAttachment=new Ln(l,T)),E&&(this.depthAttachmentType=E,this.depthAttachment=E==="renderbuffer"?new Vn(l,T):new Xr(l,T))}destroy(){const l=this.context.gl;if(this.colorAttachment){const f=this.colorAttachment.get();f&&l.deleteTexture(f)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const f=this.depthAttachment.get();f&&l.deleteRenderbuffer(f)}else{const f=this.depthAttachment.get();f&&l.deleteTexture(f)}l.deleteFramebuffer(this.framebuffer)}}class Ei{constructor(l,f){this.gl=l,this.clearColor=new Ye(this),this.clearDepth=new ht(this),this.clearStencil=new ft(this),this.colorMask=new et(this),this.depthMask=new Xe(this),this.stencilMask=new Mt(this),this.stencilFunc=new Lt(this),this.stencilOp=new nt(this),this.stencilTest=new at(this),this.depthRange=new it(this),this.depthTest=new tt(this),this.depthFunc=new Jt(this),this.blend=new $t(this),this.blendFunc=new Lr(this),this.blendColor=new rr(this),this.blendEquation=new Zt(this),this.cullFace=new dn(this),this.cullFaceSide=new dr(this),this.frontFace=new Ur(this),this.program=new Tr(this),this.activeTexture=new wr(this),this.viewport=new Er(this),this.bindFramebuffer=new Zn(this),this.bindRenderbuffer=new fn(this),this.bindTexture=new pn(this),this.bindVertexBuffer=new li(this),this.bindElementBuffer=new or(this),this.bindVertexArrayOES=new Yt(this),this.pixelStoreUnpack=new un(this),this.pixelStoreUnpackPremultiplyAlpha=new _n(this),this.pixelStoreUnpackFlipY=new rn(this),this.options=f?{...f}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=l.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),this.maxPointSize=l.getParameter(l.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,f,y){return new a.I(this,l,f,y)}createVertexBuffer(l,f,y,w,E){return new Ne(this,l,f,y,w,E)}createRenderbuffer(l,f,y){const w=this.gl,E=w.createRenderbuffer();return this.bindRenderbuffer.set(E),w.renderbufferStorage(w.RENDERBUFFER,l,f,y),this.bindRenderbuffer.set(null),E}createFramebuffer(l,f,y,w){return new xi(this,l,f,y,w)}clear({color:l,depth:f,stencil:y,colorMask:w}){const E=this.gl;let T=0;l&&(T|=E.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set(w||[!0,!0,!0,!0])),f!==void 0&&(T|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(T|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),E.clear(T)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){C(l.blendFunction,a.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor),l.blendEquation?this.blendEquation.set(l.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(l.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class $i{constructor(l){this._gl=l.gl,this._query=this._gl.createQuery(),this._isFree=!0}begin(){this._gl.beginQuery(this._gl.ANY_SAMPLES_PASSED,this._query),this._isFree=!1}end(){this._gl.endQuery(this._gl.ANY_SAMPLES_PASSED)}isResultAvailable(){return this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE)}consumeResult(){const l=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT);return this._isFree=!0,l}isFree(){return this._isFree}destroy(){this._gl.deleteQuery(this._query)}}class vr{constructor(l){this.useOcclusionQueries=!0,this.visualizeOcclusions="none",this.occlusionQueryFrameWindow=5,this.occluderSize=32,this.fadeSpeed=7,this.depthOffset=-1e-4,l.registerParameter(this,["Symbols"],"useOcclusionQueries"),l.registerParameter(this,["Symbols"],"visualizeOcclusions",{options:{none:"none",zPass:"zPass",zTest:"zTest"}}),l.registerParameter(this,["Symbols"],"occlusionQueryFrameWindow",{min:1,max:30,step:1}),l.registerParameter(this,["Symbols"],"occluderSize",{min:1,max:100,step:1}),l.registerParameter(this,["Symbols"],"fadeSpeed",{min:.1,max:50,step:.1}),l.registerParameter(this,["Symbols"],"depthOffset",{min:-.001,max:0,step:1e-4})}}class nn{constructor(l,f,y,w){const E={width:y[0],height:y[1],data:null},T=l.gl;this.targetColorTexture=new a.T(l,E,T.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new a.T(l,E,T.RGBA,{useMipmap:!1}),this.context=l,this.updateParticleTexture(f,w),this.lastInvalidatedAt=0}updateParticleTexture(l,f){if(this.particleTextureDimension===f.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,w=f.width*f.height;this.particleTexture0=new a.T(this.context,f,y.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,f,y.RGBA,{premultiply:!1,useMipmap:!1});const E=new a.S;E.reserve(w);for(let T=0;T<w;T++)E.emplaceBack(T);this.particleIndexBuffer=this.context.createVertexBuffer(E,a.p.members,!0),this.particleSegment=a.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=f.width}update(l){return!(this.lastInvalidatedAt<l&&(this.lastInvalidatedAt=a.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class Hn extends a.E{constructor(l){super(),this.requestManager=l,this.models={"":{}},this.numModelsLoading={}}loadModel(l,f){return a.l(this.requestManager.transformRequest(f,a.R.Model).url).then(y=>{if(!y)return;const w=a.c(y),E=new a.M(l,void 0,void 0,w);return E.computeBoundsAndApplyParent(),E}).catch(y=>{if(y&&y.status===404)return null;this.fire(new a.d(new Error(`Could not load model ${l} from ${f}: ${y.message}`)))})}load(l,f){this.models[f]||(this.models[f]={});const y=Object.keys(l);this.numModelsLoading[f]=(this.numModelsLoading[f]||0)+y.length;const w=[];for(const E of y)w.push(this.loadModel(E,l[E]));Promise.allSettled(w).then(E=>{for(let T=0;T<E.length;T++){const{status:M,value:L}=E[T];M==="fulfilled"&&L&&(this.models[f][y[T]]={model:L,numReferences:1})}this.numModelsLoading[f]-=y.length,this.fire(new a.f("data",{dataType:"style"}))}).catch(E=>{this.fire(new a.d(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const l in this.numModelsLoading)if(this.numModelsLoading[l]>0)return!1;return!0}hasModel(l,f){return!!this.getModel(l,f)}getModel(l,f){return this.models[f]||(this.models[f]={}),this.models[f][l]?this.models[f][l].model:void 0}addModel(l,f,y){this.models[y]||(this.models[y]={}),this.hasModel(l,y)&&this.models[y][l].numReferences++,this.load({[l]:this.requestManager.normalizeModelURL(f)},y)}addModels(l,f){this.models[f]||(this.models[f]={});const y={};for(const w in l)this.models[f][w]={},y[w]=this.requestManager.normalizeModelURL(l[w]);this.load(y,f)}addModelsFromBucket(l,f){this.models[f]||(this.models[f]={});const y={};for(const w of l)this.hasModel(w,f)?this.models[f][w].numReferences++:y[w]=this.requestManager.normalizeModelURL(w);this.load(y,f)}removeModel(l,f){if(this.models[f]&&this.models[f][l]&&(this.models[f][l].numReferences--,this.models[f][l].numReferences===0)){const y=this.models[f][l].model;delete this.models[f][l],y.destroy()}}listModels(l){return this.models[l]||(this.models[l]={}),Object.keys(this.models[l])}upload(l,f){this.models[f]||(this.models[f]={});for(const y in this.models[f])this.models[f][y].model&&this.models[f][y].model.upload(l.context)}}function cr(g){const{userImage:l}=g;return!!(l&&l.render&&l.render())&&(g.data.replace(new Uint8Array(l.data.buffer)),!0)}class Is extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(l){this.images[l]={},this.loaded[l]=!1,this.updatedImages[l]={},this.patterns[l]={},this.callbackDispatchedThisFrame[l]={},this.atlasImage[l]=new a.i({width:1,height:1})}isLoaded(){for(const l in this.loaded)if(!this.loaded[l])return!1;return!0}setLoaded(l,f){if(this.loaded[f]!==l&&(this.loaded[f]=l,l)){for(const{ids:y,callback:w}of this.requestors)this._notify(y,f,w);this.requestors=[]}}hasImage(l,f){return!!this.getImage(l,f)}getImage(l,f){return this.images[f][l]}addImage(l,f,y){this._validate(l,y)&&(this.images[f][l]=y)}_validate(l,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "content" value`))),y=!1),y}_validateStretch(l,f){if(!l)return!0;let y=0;for(const w of l){if(w[0]<y||w[1]<w[0]||f<w[1])return!1;y=w[1]}return!0}_validateContent(l,f){return!(l&&(l.length!==4||l[0]<0||f.data.width<l[0]||l[1]<0||f.data.height<l[1]||l[2]<0||f.data.width<l[2]||l[3]<0||f.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,f,y){y.version=this.images[f][l].version+1,this.images[f][l]=y,this.updatedImages[f][l]=!0}removeImage(l,f){const y=this.images[f][l];delete this.images[f][l],delete this.patterns[f][l],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(l){return Object.keys(this.images[l])}getImages(l,f,y){let w=!0;const E=!!this.loaded[f];if(!E)for(const T of l)this.images[f][T]||(w=!1);E||w?this._notify(l,f,y):this.requestors.push({ids:l,scope:f,callback:y})}getUpdatedImages(l){return this.updatedImages[l]}_notify(l,f,y){const w={};for(const E of l){this.images[f][E]||this.fire(new a.f("styleimagemissing",{id:E}));const T=this.images[f][E];T?w[E]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:a.w(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,w)}getPixelSize(l){const{width:f,height:y}=this.atlasImage[l];return{width:f,height:y}}getPattern(l,f,y){const w=this.patterns[f][l],E=this.getImage(l,f);if(!E)return null;if(w&&w.position.version===E.version)return w.position;if(w)w.position.version=E.version;else{const T={w:E.data.width+2,h:E.data.height+2,x:0,y:0},M=new a.k(T,E);this.patterns[f][l]={bin:T,position:M}}return this._updatePatternAtlas(f,y),this.patterns[f][l].position}bind(l,f){const y=l.gl;let w=this.atlasTexture[f];w?this.dirty&&(w.update(this.atlasImage[f]),this.dirty=!1):(w=new a.T(l,this.atlasImage[f],y.RGBA),this.atlasTexture[f]=w),w.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(l,f){const y=[];for(const M in this.patterns[l])y.push(this.patterns[l][M].bin);const{w,h:E}=a.j(y),T=this.atlasImage[l];T.resize({width:w||1,height:E||1});for(const M in this.patterns[l]){const{bin:L}=this.patterns[l][M],B=L.x+1,$=L.y+1,G=this.images[l][M].data,Z=G.width,Q=G.height;a.i.copy(G,T,{x:0,y:0},{x:B,y:$},{width:Z,height:Q},f),a.i.copy(G,T,{x:0,y:Q-1},{x:B,y:$-1},{width:Z,height:1},f),a.i.copy(G,T,{x:0,y:0},{x:B,y:$+Q},{width:Z,height:1},f),a.i.copy(G,T,{x:Z-1,y:0},{x:B-1,y:$},{width:1,height:Q},f),a.i.copy(G,T,{x:0,y:0},{x:B+Z,y:$},{width:1,height:Q},f)}this.dirty=!0}beginFrame(){for(const l in this.images)this.callbackDispatchedThisFrame[l]={}}dispatchRenderCallbacks(l,f){for(const y of l){if(this.callbackDispatchedThisFrame[f][y])continue;this.callbackDispatchedThisFrame[f][y]=!0;const w=this.images[f][y];cr(w)&&this.updateImage(y,f,w)}}}function Mn(g){const l=g.key,f=g.value,y=g.valueSpec||{},w=g.objectElementValidators||{},E=g.style,T=g.styleSpec;let M=[];const L=a.n(f);if(L!=="object")return[new a.V(l,f,`object expected, ${L} found`)];for(const B in f){const $=B.split(".")[0];let G;w[$]?G=w[$]:y[$]?G=X:w["*"]?G=w["*"]:y["*"]&&(G=X),G?M=M.concat(G({key:(l&&`${l}.`)+B,value:f[B],valueSpec:y[$]||y["*"],style:E,styleSpec:T,object:f,objectKey:B},f)):M.push(new a.m(l,f[B],`unknown property "${B}"`))}for(const B in y)w[B]||y[B].required&&y[B].default===void 0&&f[B]===void 0&&M.push(new a.V(l,f,`missing required property "${B}"`));return M}function Xi(g){const l=g.value,f=g.valueSpec,y=g.style,w=g.styleSpec,E=g.key,T=g.arrayElementValidator||X;if(a.n(l)!=="array")return[new a.V(E,l,`array expected, ${a.n(l)} found`)];if(f.length&&l.length!==f.length)return[new a.V(E,l,`array length ${f.length} expected, length ${l.length} found`)];if(f["min-length"]&&l.length<f["min-length"])return[new a.V(E,l,`array length at least ${f["min-length"]} expected, length ${l.length} found`)];let M={type:f.value,values:f.values,minimum:f.minimum,maximum:f.maximum,function:void 0};w.$version<7&&(M.function=f.function),a.n(f.value)==="object"&&(M=f.value);let L=[];for(let B=0;B<l.length;B++)L=L.concat(T({array:l,arrayIndex:B,value:l[B],valueSpec:M,style:y,styleSpec:w,key:`${E}[${B}]`},!0));return L}function _o(g){const l=g.key,f=g.value,y=g.valueSpec;let w=a.n(f);if(w==="number"&&f!=f&&(w="NaN"),w!=="number")return[new a.V(l,f,`number expected, ${w} found`)];if("minimum"in y){let E=y.minimum;if(a.n(y.minimum)==="array"&&(E=y.minimum[g.arrayIndex]),f<E)return[new a.V(l,f,`${f} is less than the minimum value ${E}`)]}if("maximum"in y){let E=y.maximum;if(a.n(y.maximum)==="array"&&(E=y.maximum[g.arrayIndex]),f>E)return[new a.V(l,f,`${f} is greater than the maximum value ${E}`)]}return[]}function ci(g){const l=g.valueSpec,f=a.u(g.value.type);let y,w,E,T={};const M=f!=="categorical"&&g.value.property===void 0,L=!M,B=a.n(g.value.stops)==="array"&&a.n(g.value.stops[0])==="array"&&a.n(g.value.stops[0][0])==="object",$=Mn({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(Q){if(f==="identity")return[new a.V(Q.key,Q.value,'identity function may not have a "stops" property')];let ne=[];const ie=Q.value;return ne=ne.concat(Xi({key:Q.key,value:ie,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:G})),a.n(ie)==="array"&&ie.length===0&&ne.push(new a.V(Q.key,ie,"array must have at least one stop")),ne},default:function(Q){return X({key:Q.key,value:Q.value,valueSpec:l,style:Q.style,styleSpec:Q.styleSpec})}}});return f==="identity"&&M&&$.push(new a.V(g.key,g.value,'missing required property "property"')),f==="identity"||g.value.stops||$.push(new a.V(g.key,g.value,'missing required property "stops"')),f==="exponential"&&g.valueSpec.expression&&!a.s(g.valueSpec)&&$.push(new a.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(L&&!a.q(g.valueSpec)?$.push(new a.V(g.key,g.value,"property functions not supported")):M&&!a.r(g.valueSpec)&&$.push(new a.V(g.key,g.value,"zoom functions not supported"))),f!=="categorical"&&!B||g.value.property!==void 0||$.push(new a.V(g.key,g.value,'"property" property is required')),$;function G(Q){let ne=[];const ie=Q.value,oe=Q.key;if(a.n(ie)!=="array")return[new a.V(oe,ie,`array expected, ${a.n(ie)} found`)];if(ie.length!==2)return[new a.V(oe,ie,`array length 2 expected, length ${ie.length} found`)];if(B){if(a.n(ie[0])!=="object")return[new a.V(oe,ie,`object expected, ${a.n(ie[0])} found`)];if(ie[0].zoom===void 0)return[new a.V(oe,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new a.V(oe,ie,"object stop key must have value")];const se=a.u(ie[0].zoom);if(typeof se!="number")return[new a.V(oe,ie[0].zoom,"stop zoom values must be numbers")];if(E&&E>se)return[new a.V(oe,ie[0].zoom,"stop zoom values must appear in ascending order")];se!==E&&(E=se,w=void 0,T={}),ne=ne.concat(Mn({key:`${oe}[0]`,value:ie[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:_o,value:Z}}))}else ne=ne.concat(Z({key:`${oe}[0]`,value:ie[0],valueSpec:{},style:Q.style,styleSpec:Q.styleSpec},ie));return a.t(a.v(ie[1]))?ne.concat([new a.V(`${oe}[1]`,ie[1],"expressions are not allowed in function stops.")]):ne.concat(X({key:`${oe}[1]`,value:ie[1],valueSpec:l,style:Q.style,styleSpec:Q.styleSpec}))}function Z(Q,ne){const ie=a.n(Q.value),oe=a.u(Q.value),se=Q.value!==null?Q.value:ne;if(y){if(ie!==y)return[new a.V(Q.key,se,`${ie} stop domain type must match previous stop domain type ${y}`)]}else y=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new a.V(Q.key,se,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&f!=="categorical"){let me=`number expected, ${ie} found`;return a.q(l)&&f===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(Q.key,se,me)]}return f!=="categorical"||ie!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?f!=="categorical"&&ie==="number"&&typeof oe=="number"&&typeof w=="number"&&w!==void 0&&oe<w?[new a.V(Q.key,se,"stop domain values must appear in ascending order")]:(w=oe,f==="categorical"&&oe in T?[new a.V(Q.key,se,"stop domain values must be unique")]:(T[oe]=!0,[])):[new a.V(Q.key,se,`integer expected, found ${String(oe)}`)]}}function Bi(g){const l=(g.expressionContext==="property"?a.x:a.y)(a.v(g.value),g.valueSpec);if(l.result==="error")return l.value.map(y=>new a.V(`${g.key}${y.key}`,g.value,y.message));const f=l.value.expression||l.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!f.outputDefined())return[new a.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!a.z(f))return[new a.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return Ms(f,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!a.A(f,["zoom","feature-state"]))return[new a.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!a.B(f))return[new a.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ms(g,l){const f=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const w of l.valueSpec.expression.parameters)f.delete(w);if(f.size===0)return[];const y=[];return g instanceof a.D&&f.has(g.name)?[new a.V(l.key,l.value,`["${g.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(g.eachChild(w=>{y.push(...Ms(w,l))}),y)}function fs(g){const l=g.key,f=g.value,y=g.valueSpec,w=[];return Array.isArray(y.values)?y.values.indexOf(a.u(f))===-1&&w.push(new a.V(l,f,`expected one of [${y.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(y.values).indexOf(a.u(f))===-1&&w.push(new a.V(l,f,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(f)} found`)),w}function Cr(g){return a.G(a.v(g.value))?Bi(a.o({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):Je(g)}function Je(g){const l=g.value,f=g.key;if(a.n(l)!=="array")return[new a.V(f,l,`array expected, ${a.n(l)} found`)];const y=g.styleSpec;let w,E=[];if(l.length<1)return[new a.V(f,l,"filter array must have at least 1 element")];switch(E=E.concat(fs({key:`${f}[0]`,value:l[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),a.u(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&a.u(l[1])==="$type"&&E.push(new a.V(f,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&E.push(new a.V(f,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(w=a.n(l[1]),w!=="string"&&E.push(new a.V(`${f}[1]`,l[1],`string expected, ${w} found`)));for(let T=2;T<l.length;T++)w=a.n(l[T]),a.u(l[1])==="$type"?E=E.concat(fs({key:`${f}[${T}]`,value:l[T],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&E.push(new a.V(`${f}[${T}]`,l[T],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let T=1;T<l.length;T++)E=E.concat(Je({key:`${f}[${T}]`,value:l[T],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":w=a.n(l[1]),l.length!==2?E.push(new a.V(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):w!=="string"&&E.push(new a.V(`${f}[1]`,l[1],`string expected, ${w} found`))}return E}function Vt(g,l){const f=g.key,y=g.style,w=g.layer,E=g.styleSpec,T=g.value,M=g.objectKey,L=E[`${l}_${g.layerType}`];if(!L)return[];const B=M.match(/^(.*)-transition$/);if(l==="paint"&&B&&L[B[1]]&&L[B[1]].transition)return X({key:f,value:T,valueSpec:E.transition,style:y,styleSpec:E});const $=g.valueSpec||L[M];if(!$)return[new a.m(f,T,`unknown property "${M}"`)];let G;if(a.n(T)==="string"&&a.q($)&&!$.tokens&&(G=/^{([^}]+)}$/.exec(T))){const Q=`\`{ "type": "identity", "property": ${G?JSON.stringify(G[1]):'"_"'} }\``;return[new a.V(f,T,`"${M}" does not support interpolation syntax
Use an identity property function instead: ${Q}.`)]}const Z=[];if(g.layerType==="symbol")M!=="text-field"||!y||y.glyphs||y.imports||Z.push(new a.V(f,T,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&a.H(a.v(T))&&a.u(T.type)==="identity"&&Z.push(new a.V(f,T,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&l==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&a.q($)&&(a.J($)||a.r($))){const Q=a.x(a.v(T),$),ne=Q.value.expression||Q.value._styleExpression.expression;ne&&!a.A(ne,["measure-light"])&&(M==="model-emissive-strength"&&a.B(ne)&&a.z(ne)||Z.push(new a.V(f,T,`${M} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Z.concat(X({key:g.key,value:T,valueSpec:$,style:y,styleSpec:E,expressionContext:"property",propertyType:l,propertyKey:M}))}function Ct(g){return Vt(g,"paint")}function Wt(g){return Vt(g,"layout")}function ir(g){let l=[];const f=g.value,y=g.key,w=g.style,E=g.styleSpec;f.type||f.ref||l.push(new a.V(y,f,'either "type" or "ref" is required'));let T=a.u(f.type);const M=a.u(f.ref);if(f.id){const L=a.u(f.id);for(let B=0;B<g.arrayIndex;B++){const $=w.layers[B];a.u($.id)===L&&l.push(new a.V(y,f.id,`duplicate layer id "${f.id}", previously used at line ${$.id.__line__}`))}}if("ref"in f){let L;["type","source","source-layer","filter","layout"].forEach(B=>{B in f&&l.push(new a.V(y,f[B],`"${B}" is prohibited for ref layers`))}),w.layers.forEach(B=>{a.u(B.id)===M&&(L=B)}),L?L.ref?l.push(new a.V(y,f.ref,"ref cannot reference another ref layer")):T=a.u(L.type):typeof M=="string"&&l.push(new a.V(y,f.ref,`ref layer "${M}" not found`))}else if(T!=="background"&&T!=="sky"&&T!=="slot")if(f.source){const L=w.sources&&w.sources[f.source],B=L&&a.u(L.type);L?B==="vector"&&T==="raster"?l.push(new a.V(y,f.source,`layer "${f.id}" requires a raster source`)):B==="raster"&&T!=="raster"?l.push(new a.V(y,f.source,`layer "${f.id}" requires a vector source`)):B!=="vector"||f["source-layer"]?B==="raster-dem"&&T!=="hillshade"?l.push(new a.V(y,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="raster-array"||["raster","raster-particle"].includes(T)?T!=="line"||!f.paint||!f.paint["line-gradient"]&&!f.paint["line-trim-offset"]||B==="geojson"&&L.lineMetrics?T==="raster-particle"&&B!=="raster-array"&&l.push(new a.V(y,f.source,`layer "${f.id}" requires a 'raster-array' source.`)):l.push(new a.V(y,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new a.V(y,f.source,"raster-array source can only be used with layer type 'raster'.")):l.push(new a.V(y,f,`layer "${f.id}" must specify a "source-layer"`)):l.push(new a.V(y,f.source,`source "${f.source}" not found`))}else l.push(new a.V(y,f,'missing required property "source"'));return l=l.concat(Mn({key:y,value:f,valueSpec:E.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>X({key:`${y}.type`,value:f.type,valueSpec:E.layer.type,style:g.style,styleSpec:g.styleSpec,object:f,objectKey:"type"}),filter:L=>Cr(a.o({layerType:T},L)),layout:L=>Mn({layer:f,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":B=>Wt(a.o({layerType:T},B))}}),paint:L=>Mn({layer:f,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":B=>Ct(a.o({layerType:T,layer:f},B))}})}})),l}function ur(g){const l=g.value,f=g.key,y=a.n(l);return y!=="string"?[new a.V(f,l,`string expected, ${y} found`)]:[]}const Be={promoteId:function({key:g,value:l}){if(a.n(l)==="string")return ur({key:g,value:l});{const f=[];for(const y in l)f.push(...ur({key:`${g}.${y}`,value:l[y]}));return f}}};function ze(g){const l=g.value,f=g.key,y=g.styleSpec,w=g.style;if(!l.type)return[new a.V(f,l,'"type" is required')];const E=a.u(l.type);let T=[];switch(["vector","raster","raster-dem","raster-array"].includes(E)&&(l.url||l.tiles||T.push(new a.m(f,l,'Either "url" or "tiles" is required.'))),E){case"vector":case"raster":case"raster-dem":case"raster-array":return T=T.concat(Mn({key:f,value:l,valueSpec:y[`source_${E.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:Be})),T;case"geojson":if(T=Mn({key:f,value:l,valueSpec:y.source_geojson,style:w,styleSpec:y,objectElementValidators:Be}),l.cluster)for(const M in l.clusterProperties){const[L,B]=l.clusterProperties[M],$=typeof L=="string"?[L,["accumulated"],["get",M]]:L;T.push(...Bi({key:`${f}.${M}.map`,value:B,expressionContext:"cluster-map"})),T.push(...Bi({key:`${f}.${M}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return T;case"video":return Mn({key:f,value:l,valueSpec:y.source_video,style:w,styleSpec:y});case"image":return Mn({key:f,value:l,valueSpec:y.source_image,style:w,styleSpec:y});case"canvas":return[new a.V(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fs({key:`${f}.type`,value:l.type,valueSpec:{values:lt(y)},style:w,styleSpec:y})}}function lt(g){return g.source.reduce((l,f)=>{const y=g[f];return y.type.type==="enum"&&(l=l.concat(Object.keys(y.type.values))),l},[])}function mt(g){const l=g.value,f=g.styleSpec,y=f.light,w=g.style;let E=[];const T=a.n(l);if(l===void 0)return E;if(T!=="object")return E=E.concat([new a.V("light",l,`object expected, ${T} found`)]),E;for(const M in l){const L=M.match(/^(.*)-transition$/);E=E.concat(L&&y[L[1]]&&y[L[1]].transition?X({key:M,value:l[M],valueSpec:f.transition,style:w,styleSpec:f}):y[M]?X({key:M,value:l[M],valueSpec:y[M],style:w,styleSpec:f}):[new a.V(M,l[M],`unknown property "${M}"`)])}return E}function qt(g){const l=g.value;let f=[];if(!l)return f;const y=a.n(l);if(y!=="object")return f=f.concat([new a.V("light-3d",l,`object expected, ${y} found`)]),f;const w=g.styleSpec,E=w["light-3d"],T=g.key,M=g.style,L=g.style.lights;for(const G of["type","id"])if(!(G in l))return f=f.concat([new a.V("light-3d",l,`missing property ${G} on light`)]),f;if(l.type&&L)for(let G=0;G<g.arrayIndex;G++){const Z=a.u(l.type),Q=L[G];a.u(Q.type)===Z&&f.push(new a.V(T,l.id,`duplicate light type "${l.type}", previously defined at line ${Q.id.__line__}`))}const B=`properties_light_${l.type}`;if(!(B in w))return f=f.concat([new a.V("light-3d",l,`Invalid light type ${l.type}`)]),f;const $=w[B];for(const G in l)if(G==="properties"){const Z=l[G],Q=a.n(Z);if(Q!=="object")return f=f.concat([new a.V("properties",Z,`object expected, ${Q} found`)]),f;for(const ne in Z)f=f.concat($[ne]?X({key:ne,value:Z[ne],valueSpec:$[ne],style:M,styleSpec:w}):[new a.m(g.key,Z[ne],`unknown property "${ne}"`)])}else{const Z=G.match(/^(.*)-transition$/);f=f.concat(Z&&E[Z[1]]&&E[Z[1]].transition?X({key:G,value:l[G],valueSpec:w.transition,style:M,styleSpec:w}):E[G]?X({key:G,value:l[G],valueSpec:E[G],style:M,styleSpec:w}):[new a.m(G,l[G],`unknown property "${G}"`)])}return f}function ar(g){const l=g.value,f=g.key,y=g.style,w=g.styleSpec,E=w.terrain;let T=[];const M=a.n(l);if(l===void 0||M==="null")return T;if(M!=="object")return T=T.concat([new a.V("terrain",l,`object expected, ${M} found`)]),T;for(const L in l){const B=L.match(/^(.*)-transition$/);T=T.concat(B&&E[B[1]]&&E[B[1]].transition?X({key:L,value:l[L],valueSpec:w.transition,style:y,styleSpec:w}):E[L]?X({key:L,value:l[L],valueSpec:E[L],style:y,styleSpec:w}):[new a.m(L,l[L],`unknown property "${L}"`)])}if(l.source){const L=y.sources&&y.sources[l.source],B=L&&a.u(L.type);L?B!=="raster-dem"&&T.push(new a.V(f,l.source,`terrain cannot be used with a source of type ${String(B)}, it only be used with a "raster-dem" source type`)):T.push(new a.V(f,l.source,`source "${l.source}" not found`))}else T.push(new a.V(f,l,'terrain is missing required property "source"'));return T}function gr(g){const l=g.value,f=g.style,y=g.styleSpec,w=y.fog;let E=[];const T=a.n(l);if(l===void 0)return E;if(T!=="object")return E=E.concat([new a.V("fog",l,`object expected, ${T} found`)]),E;for(const M in l){const L=M.match(/^(.*)-transition$/);E=E.concat(L&&w[L[1]]&&w[L[1]].transition?X({key:M,value:l[M],valueSpec:y.transition,style:f,styleSpec:y}):w[M]?X({key:M,value:l[M],valueSpec:w[M],style:f,styleSpec:y}):[new a.m(M,l[M],`unknown property "${M}"`)])}return E}const xe={"*":()=>[],array:Xi,boolean:function(g){const l=g.value,f=g.key,y=a.n(l);return y!=="boolean"?[new a.V(f,l,`boolean expected, ${y} found`)]:[]},number:_o,color:function(g){const l=g.key,f=g.value,y=a.n(f);return y!=="string"?[new a.V(l,f,`color expected, ${y} found`)]:a.F(f)===null?[new a.V(l,f,`color expected, "${f}" found`)]:[]},enum:fs,filter:Cr,function:ci,layer:ir,object:Mn,source:ze,model:a.K,light:mt,"light-3d":qt,terrain:ar,fog:gr,string:ur,formatted:function(g){return ur(g).length===0?[]:Bi(g)},resolvedImage:function(g){return ur(g).length===0?[]:Bi(g)},projection:function(g){const l=g.value,f=g.styleSpec,y=f.projection,w=g.style;let E=[];const T=a.n(l);if(T==="object")for(const M in l)E=E.concat(X({key:M,value:l[M],valueSpec:y[M],style:w,styleSpec:f}));else T!=="string"&&(E=E.concat([new a.V("projection",l,`object or string expected, ${T} found`)]));return E},import:function(g){const{value:l,styleSpec:f}=g,{data:y,...w}=l;Object.defineProperty(w,"__line__",{value:l.__line__,enumerable:!1});let E=Mn(a.o({},g,{value:w,valueSpec:f.import}));return a.u(w.id)===""&&E.push(new a.V(`${g.key}.id`,w,"import id can't be an empty string")),y&&(E=E.concat(le(y,f,{key:`${g.key}.data`}))),E}};function X(g,l=!1){const f=g.value,y=g.valueSpec,w=g.styleSpec;if(y.expression&&a.H(a.u(f)))return ci(g);if(y.expression&&a.t(a.v(f)))return Bi(g);if(y.type&&xe[y.type]){const E=xe[y.type](g);return l===!0&&E.length>0&&a.n(g.value)==="array"?Bi(g):E}return Mn(a.o({},g,{valueSpec:y.type?w[y.type]:y}))}function re(g){const l=g.value,f=g.key,y=ur(g);return y.length||(l.indexOf("{fontstack}")===-1&&y.push(new a.V(f,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&y.push(new a.V(f,l,'"glyphs" url must include a "{range}" token'))),y}function le(g,l=a.L,f={}){return X({key:f.key||"",value:g,valueSpec:l.$root,styleSpec:l,style:g,objectElementValidators:{glyphs:re,"*":()=>[]}})}function we(g,l=a.L){return Pr(le(g,l))}const Ie=g=>Pr(ze(g)),Oe=g=>Pr(mt(g)),$e=g=>Pr(qt(g)),Fe=g=>Pr(ar(g)),qe=g=>Pr(gr(g)),kt=g=>Pr(ir(g)),Et=g=>Pr(Cr(g)),er=g=>Pr(Ct(g)),pr=g=>Pr(Wt(g)),kr=g=>Pr(a.K(g));function Pr(g){return g.slice().sort((l,f)=>l.line&&f.line?l.line-f.line:0)}function Ar(g,l){let f=!1;if(l&&l.length)for(const y of l)y instanceof a.m?a.w(y.message):(g.fire(new a.d(new Error(y.message))),f=!0);return f}const Yr=new a.N({anchor:new a.O(a.L.light.anchor),position:new a.Q(a.L.light.position),color:new a.O(a.L.light.color),intensity:new a.O(a.L.light.intensity)});class Qt extends a.E{constructor(l,f="flat"){super(),this._transitionable=new a.U(Yr),this.setLight(l,f),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,f,y={}){this._validate(Oe,l,y)||(this._transitionable.setTransitionOrValue(l),this.id=f)}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y){return(!y||y.validate!==!1)&&Ar(this,l.call(we,a.W({value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.L})))}}const xr=new a.N({source:new a.O(a.L.terrain.source),exaggeration:new a.O(a.L.terrain.exaggeration)});let Dr=class extends a.E{constructor(g,l,f,y){super(),this.scope=f,this._transitionable=new a.U(xr,f,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(g,l){this._transitionable.setTransitionOrValue(g,l)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new a.X(g)).get("exaggeration")}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof a.Z}};const zr=45,Jr=65,An=.05;function Si(g,l,f,y){const w=a.$(zr,Jr,f),[E,T]=yo(g,y);let M=1-Math.min(1,Math.exp((l-E)/(T-E)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*w*g.alpha}function yo(g,l){const f=.5/Math.tan(.5*l);return[g.range[0]+f,g.range[1]+f]}function Uo(g,l,f,y,w){const E=a._.transformMat4([],[l,f,y],w.mercatorFogMatrix);return Si(g,a._.length(E),w.pitch,w._fov)}function vu(g,l,f,y,w,E,T){const M=[[f,y,0],[w,y,0],[w,E,0],[f,E,0]];let L=Number.MAX_VALUE,B=-Number.MAX_VALUE;for(const $ of M){const G=a._.transformMat4([],$,l),Z=a._.length(G);L=Math.min(L,Z),B=Math.max(B,Z)}return[Si(g,L,T.pitch,T._fov),Si(g,B,T.pitch,T._fov)]}const $_=new a.N({range:new a.O(a.L.fog.range),color:new a.O(a.L.fog.color),"high-color":new a.O(a.L.fog["high-color"]),"space-color":new a.O(a.L.fog["space-color"]),"horizon-blend":new a.O(a.L.fog["horizon-blend"]),"star-intensity":new a.O(a.L.fog["star-intensity"]),"vertical-range":new a.O(a.L.fog["vertical-range"])});class rb extends a.E{constructor(l,f,y,w){super(),this._transitionable=new a.U($_,y,new Map(w)),this.set(l,w),this._transitioning=this._transitionable.untransitioned(),this._transform=f,this.properties=new a.a0($_),this.scope=y}get state(){const l=this._transform,f=l.projection.name==="globe",y=a.a1(l.zoom),w=this.properties.get("range"),E=[.5,3];return{range:f?[a.a2(E[0],w[0],y),a.a2(E[1],w[1],y)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,f,y={}){if(this._validate(qe,l,y))return;const w=a.W({},l);for(const E of Object.keys(a.L.fog))w[E]===void 0&&(w[E]=a.L.fog[E].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,f)}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.$(zr,Jr,l))*f.a}getOpacityAtLatLng(l,f){return this._transform.projection.supportsFog?function(y,w,E){const T=a.Y.fromLngLat(w),M=E.elevation?E.elevation.getAtPointOrZero(T):0;return Uo(y,T.x,T.y,M,E)}(this.state,l,f):0}getOpacityForTile(l){if(!this._transform.projection.supportsFog)return[1,1];const f=this._transform.calculateFogTileMatrix(l.toUnwrapped());return vu(this.state,f,0,0,a.a3,a.a3,this._transform)}getOpacityForBounds(l,f,y,w,E){return this._transform.projection.supportsFog?vu(this.state,l,f,y,w,E,this._transform):[1,1]}getFovAdjustedRange(l){return this._transform.projection.supportsFog?yo(this.state,l):[0,1]}isVisibleOnFrustum(l){if(!this._transform.projection.supportsFog)return!1;const f=[4,5,6,7];for(const y of f){const w=l.points[y];let E;if(w[2]>=0)E=w;else{const T=l.points[y-4];E=a.a4(T,w,T[2]/(T[2]-w[2]))}if(Uo(this.state,E[0],E[1],0,this._transform)>=An)return!0}return!1}updateConfig(l){this._transitionable.setTransitionOrValue(this._options,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y){return(!y||y.validate!==!1)&&Ar(this,l.call(we,a.W({value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.L})))}}class xf extends a.E{constructor(l,f,y,w){super(),this.scope=y,this._options=l,this.properties=new a.a0(f),this._transitionable=new a.U(f,y,new Map(w)),this._transitionable.setTransitionOrValue(l.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(l){this._transitionable.setTransitionOrValue(this._options.properties,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(l,f){this._options=l,this._transitionable.setTransitionOrValue(l.properties,f)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Gr=new a.N({color:new a.O(a.L.properties_light_ambient.color),intensity:new a.O(a.L.properties_light_ambient.intensity)}),j_=new a.N({direction:new a.a5(a.L.properties_light_directional.direction),color:new a.O(a.L.properties_light_directional.color),intensity:new a.O(a.L.properties_light_directional.intensity),"cast-shadows":new a.O(a.L.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.O(a.L.properties_light_directional["shadow-intensity"])});var Ic=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,V_=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,H_=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,G_="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",W_=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,q_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,K_=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Y_=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Z_=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,X_=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,nb=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Th=[];Ah(Ic,Th),Ah(H_,Th),Ah(V_,Th);const Am={"_prelude_fog.vertex.glsl":q_,"_prelude_terrain.vertex.glsl":W_,"_prelude_shadow.vertex.glsl":X_,"_prelude_fog.fragment.glsl":K_,"_prelude_shadow.fragment.glsl":nb,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Y_,"_prelude_raster_particle.glsl":Z_},Im={};on("",W_),on(K_,q_),on(nb,X_),on(Y_,""),on(Z_,"");const ib=on(V_,H_),ob=Ic;var sb={background:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:on("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:on(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:on(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:on("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:on("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:on("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:on(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:on(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:on(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:on(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform lowp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/clamp(u_trim_fade_range[0],1e-4,1.0)));float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/clamp(u_trim_fade_range[1],1e-4,1.0)));float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:on("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:on("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:on(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:on(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;
#endif
}`),symbolSDF:on(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:on(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:on("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:on(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,G_),skyboxGradient:on(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,G_),skyboxCapture:on(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:on(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:on(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#else
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:on(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:on(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:on("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ah(g,l){const f=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of f)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=y.split(" ");for(const E of w)l.includes(E)||l.push(E)}}function on(g,l){const f=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=l.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(B=>{const $=B.split(" ");return $[$.length-1]}),w=[...new Set(w)]);const E={},T=[],M=[];if(g=g.replace(f,(B,$)=>(M.push($),"")),(l=l.replace(f,(B,$)=>(T.push($),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let L=[...Th];Ah(g,L),Ah(l,L);for(const B of[...T,...M])Am[B]||console.error(`Undefined include: ${B}`),Im[B]||(Im[B]=[],Ah(Am[B],Im[B])),L=[...L,...Im[B]];return{fragmentSource:g=g.replace(y,(B,$,G,Z,Q)=>(E[Q]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${G} ${Z} ${Q};
#else
uniform ${G} ${Z} u_${Q};
#endif
`:$==="initialize"?`
#ifdef HAS_UNIFORM_u_${Q}
    ${G} ${Z} ${Q} = u_${Q};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${G} ${Z} ${Q};
#endif
`:$==="initialize-attribute"?"":void 0)),vertexSource:l=l.replace(y,(B,$,G,Z,Q)=>{const ne=Z==="float"?"vec2":Z,ie=Q.match(/color/)?"color":ne;return $==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
in ${G} ${Z} a_${Q};
#endif
`:E[Q]?$==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${G} ${ne} a_${Q};
out ${G} ${Z} ${Q};
#else
uniform ${G} ${Z} u_${Q};
#endif
`:$==="initialize"?ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${G} ${Z} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${ie}(a_${Q}, u_${Q}_t);
#else
    ${G} ${Z} ${Q} = u_${Q};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${G} ${Z} a_${Q};
    out ${G} ${Z} ${Q};
#endif
`:$==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Q} = a_${Q};
#endif
`:void 0:$==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${G} ${ne} a_${Q};
#else
uniform ${G} ${Z} u_${Q};
#endif
`:$==="define-instanced"?ie==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Q}0;
in vec4 a_${Q}1;
in vec4 a_${Q}2;
in vec4 a_${Q}3;
#else
uniform ${G} ${Z} u_${Q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${G} ${ne} a_${Q};
#else
uniform ${G} ${Z} u_${Q};
#endif
`:$==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${G} ${Z} ${Q} = a_${Q};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${G} ${Z} ${Q} = a_${Q};
#else
    ${G} ${Z} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${G} ${Z} ${Q} = unpack_mix_${ie}(a_${Q}, u_${Q}_t);
#else
    ${G} ${Z} ${Q} = u_${Q};
#endif
`}),staticAttributes:w,usedDefines:L,vertexIncludes:T,fragmentIncludes:M}}class eI{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,f,y,w,E,T,M,L){this.context=l;let B=this.boundPaintVertexBuffers.length!==w.length;for(let G=0;!B&&G<w.length;G++)this.boundPaintVertexBuffers[G]!==w[G]&&(B=!0);let $=this.boundDynamicVertexBuffers.length!==M.length;for(let G=0;!$&&G<M.length;G++)this.boundDynamicVertexBuffers[G]!==M[G]&&($=!0);if(!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||B||$||this.boundIndexBuffer!==E||this.boundVertexOffset!==T)this.freshBind(f,y,w,E,T,M,L);else{l.bindVertexArrayOES.set(this.vao);for(const G of M)G&&(G.bind(),L&&G.instanceCount&&G.setVertexAttribDivisor(l.gl,f,L));E&&E.dynamicDraw&&E.bind()}}freshBind(l,f,y,w,E,T,M){const L=l.numAttributes,B=this.context,$=B.gl;this.vao&&this.destroy(),this.vao=B.gl.createVertexArray(),B.bindVertexArrayOES.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=T,f.enableAttributes($,l),f.bind(),f.setVertexAttribPointers($,l,E);for(const G of y)G.enableAttributes($,l),G.bind(),G.setVertexAttribPointers($,l,E);for(const G of T)G&&(G.enableAttributes($,l),G.bind(),G.setVertexAttribPointers($,l,E),M&&G.instanceCount&&G.setVertexAttribDivisor($,l,M));w&&w.bind(),B.currentNumAttributes=L}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function tI(g,l){const f=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new a.Y(0,y/f).toLngLat().lat,new a.Y(0,(y+1)/f).toLngLat().lat]}function rI(g,l,f,y,w,E,T){const M=g.context,L=M.gl,B=f.hillshadeFBO;if(!B)return;g.prepareDrawTile();const $=g.isTileAffectedByFog(l),G=g.getOrCreateProgram("hillshade",{overrideFog:$});M.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,B.colorAttachment.get());const Z=((oe,se,me,ge)=>{const _e=me.paint.get("hillshade-shadow-color"),Pe=me.paint.get("hillshade-highlight-color"),Te=me.paint.get("hillshade-accent-color"),pe=me.paint.get("hillshade-emissive-strength");let ye=a.ab(me.paint.get("hillshade-illumination-direction"));if(me.paint.get("hillshade-illumination-anchor")==="viewport")ye-=oe.transform.angle;else if(oe.style&&oe.style.enable3dLights()&&oe.style.directionalLight){const De=oe.style.directionalLight.properties.get("direction"),He=a.ac(De.x,De.y,De.z);ye=a.ab(He[1])}const ve=!oe.options.moving;return{u_matrix:ge||oe.transform.calculateProjMatrix(se.tileID.toUnwrapped(),ve),u_image:0,u_latrange:tI(0,se.tileID),u_light:[me.paint.get("hillshade-exaggeration"),ye],u_shadow:_e.toRenderColor(me.lut),u_highlight:Pe.toRenderColor(me.lut),u_emissive_strength:pe,u_accent:Te.toRenderColor(me.lut)}})(g,f,y,g.terrain?l.projMatrix:null);g.uploadCommonUniforms(M,G,l.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:ne,tileBoundsSegments:ie}=g.getTileBoundsBuffers(f);G.draw(g,L.TRIANGLES,w,E,T,a.af.disabled,Z,y.id,Q,ne,ie)}function Q_(g,l,f){if(!l.needsDEMTextureUpload)return;const y=g.context,w=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||g.getTileTexture(f.stride);const E=f.getPixels();l.demTexture?l.demTexture.update(E,{premultiply:!1}):l.demTexture=new a.T(y,E,w.R32F,{premultiply:!1}),l.needsDEMTextureUpload=!1}function ol(g,l,f){const y=g.context,w=y.gl;if(!l.dem)return;const E=l.dem;if(y.activeTexture.set(w.TEXTURE1),Q_(g,l,E),!l.demTexture)return;l.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const T=E.dim;y.activeTexture.set(w.TEXTURE0);let M=l.hillshadeFBO;if(!M){const Z=new a.T(y,{width:T,height:T,data:null},w.RGBA);Z.bind(w.LINEAR,w.CLAMP_TO_EDGE),M=l.hillshadeFBO=y.createFramebuffer(T,T,!0,"renderbuffer"),M.colorAttachment.set(Z.texture)}y.bindFramebuffer.set(M.framebuffer),y.viewport.set([0,0,T,T]);const{tileBoundsBuffer:L,tileBoundsIndexBuffer:B,tileBoundsSegments:$}=g.getMercatorTileBoundsBuffers(),G=[];g.linearFloatFilteringSupported()&&G.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:G}).draw(g,w.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.disabled,((Z,Q)=>{const ne=Q.stride,ie=a.ad.create();return a.ad.ortho(ie,0,a.a3,-a.a3,0,0,1),a.ad.translate(ie,ie,[0,-a.a3,0]),{u_matrix:ie,u_image:1,u_dimension:[ne,ne],u_zoom:Z.overscaledZ}})(l.tileID,E),f.id,L,B,$),l.needsHillshadePrepare=!1}function J_(g,l,f,y,w){const E=function(T,M){if(T)return w(T);if(M){if(g.url&&M.tiles&&g.tiles&&delete g.tiles,M.variants){if(!Array.isArray(M.variants))return w(new Error("variants must be an array"));for(const B of M.variants){if(B==null||typeof B!="object"||B.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(B.capabilities))return w(new Error("capabilities must be an array"));if(B.capabilities.length===1&&B.capabilities[0]==="meshopt"){M=a.W(M,B);break}}}const L=a.ah(a.W(M,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(L.vectorLayers=M.vector_layers,L.vectorLayerIds=L.vectorLayers.map(B=>B.id)),M.raster_layers&&(L.rasterLayers=M.raster_layers,L.rasterLayerIds=L.rasterLayers.map(B=>B.id)),L.tiles=l.canonicalizeTileset(L,g.url),w(null,L)}};return g.url?a.g(l.transformRequest(l.normalizeSourceURL(g.url,null,f,y),a.R.Source),E):a.e.frame(()=>E(null,g))}class bf{constructor(l,f,y){this.bounds=a.ai.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const f=Math.pow(2,l.z),y=Math.floor(a.aj(this.bounds.getWest())*f),w=Math.floor(a.ak(this.bounds.getNorth())*f),E=Math.ceil(a.aj(this.bounds.getEast())*f),T=Math.ceil(a.ak(this.bounds.getSouth())*f);return l.x>=y&&l.x<E&&l.y>=w&&l.y<T}}class wf extends a.E{constructor(l,f,y,w){super(),this.id=l,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.W({type:"raster"},f),a.W(this,a.ah(f,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"})),this._tileJSONRequest=J_(this._options,this.map._requestManager,null,null,(f,y)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new a.d(f)):y&&(a.W(this,y),y.bounds&&(this.tileBounds=new bf(y.bounds,this.minzoom,this.maxzoom)),a.an(y.tiles),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),l&&l(f)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return a.W({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,f){const y=a.e.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);l.request=a.h(this.map._requestManager.transformRequest(w,a.R.Tile),(E,T,M,L)=>(delete l.request,l.aborted?(l.state="unloaded",f(null)):E?(l.state="errored",f(E)):T?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:M,expires:L}),l.setTexture(T,this.map.painter),l.state="loaded",a.am(this.dispatcher),void f(null)):f(null)))}abortTile(l,f){l.request&&(l.request.cancel(),delete l.request),f&&f()}unloadTile(l,f){l.texture&&l.texture instanceof a.T?(l.destroy(!0),l.texture&&l.texture instanceof a.T&&this.map.painter.saveTileTexture(l.texture)):l.destroy(),f&&f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Mm extends a.E{constructor(l,f,y,w){if(super(),this.id=l,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.W(this,a.ah(f,["url","scheme","tileSize","promoteId"])),this._options=a.W({type:"vector"},f),this._collectResourceTiming=!!f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new a.ao}load(l){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=J_(this._options,this.map._requestManager,f,y,(w,E)=>{this._tileJSONRequest=null,this._loaded=!0,w?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),y&&y.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new a.d(w))):E&&(a.W(this,E),E.bounds&&(this.tileBounds=new bf(E.bounds,this.minzoom,this.maxzoom)),a.an(E.tiles,this.map._requestManager._customAccessToken),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),l&&l(w)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return a.W({},this._options)}loadTile(l,f){const y=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),w=this.map._requestManager.transformRequest(y,a.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,T={request:w,data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,lut:E?{image:E.image.clone()}:null,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:l.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(T.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=f:l.request=l.actor.send("reloadTile",T,M.bind(this));else if(l.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",T,M.bind(this),void 0,!0);else{const L=a.ap.call({deduped:this._deduped},T,(B,$)=>{B||!$?M.call(this,B):(T.data={cacheControl:$.cacheControl,expires:$.expires,rawData:$.rawData.slice(0)},l.actor&&l.actor.send("loadTile",T,M.bind(this),void 0,!0))},!0);l.request={cancel:L}}function M(L,B){return delete l.request,l.aborted?f(null):L&&L.status!==404?f(L):(B&&B.resourceTiming&&(l.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&l.setExpiryData(B),l.loadVectorData(B,this.map.painter),a.am(this.dispatcher),f(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(l,f){l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope}),l.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const xu=g=>({u_matrix:new a.a6(g),u_image0:new a.a7(g),u_skirt_height:new a.aa(g),u_ground_shadow_factor:new a.aq(g)}),Ut=(g,l,f)=>({u_matrix:g,u_image0:0,u_skirt_height:l,u_ground_shadow_factor:f}),ab=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:w,u_merc_center:E,u_image0:0,u_frustum_tl:T,u_frustum_tr:M,u_frustum_br:L,u_frustum_bl:B,u_globe_pos:$,u_globe_radius:G,u_viewport:Z,u_grid_matrix:ie?Float32Array.from(ie):new Float32Array(9),u_skirt_height:Q,u_far_z_cutoff:ne});class Cf{constructor(l=0,f=0,y=0,w=0){if(isNaN(l)||l<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=y,this.right=w}interpolate(l,f,y){return f.top!=null&&l.top!=null&&(this.top=a.a2(l.top,f.top,y)),f.bottom!=null&&l.bottom!=null&&(this.bottom=a.a2(l.bottom,f.bottom,y)),f.left!=null&&l.left!=null&&(this.left=a.a2(l.left,f.left,y)),f.right!=null&&l.right!=null&&(this.right=a.a2(l.right,f.right,y)),this}getCenter(l,f){const y=a.at((this.left+l-this.right)/2,0,l),w=a.at((this.top+f-this.bottom)/2,0,f);return new a.P(y,w)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Cf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function an(g,l){const f=a.aw(g,3);a.ad.fromQuat(g,l),a.az(g,3,f)}function $o(g,l){const f=a.av.identity([]);return a.av.rotateZ(f,f,-l),a.av.rotateX(f,f,-g),f}function lb(g,l){const f=[g[0],g[1],0],y=[l[0],l[1],0];if(a._.length(f)>=1e-15){const T=a._.normalize([],f);a._.scale(y,T,a._.dot(y,T)),l[0]=y[0],l[1]=y[1]}const w=a._.cross([],l,g);if(a._.len(w)<1e-15)return null;const E=Math.atan2(-w[1],w[0]);return $o(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),E)}class ey{constructor(l,f){this.position=l,this.orientation=f}get position(){return this._position}set position(l){if(l){const f=l instanceof a.Y?l:new a.Y(l[0],l[1],l[2]);this._renderWorldCopies&&(f.x=a.au(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(l,f){if(this.orientation=null,!this.position)return;const y=this.position,w=this._elevation?this._elevation.getAtPointOrZero(a.Y.fromLngLat(l)):0,E=a.Y.fromLngLat(l,w),T=[E.x-y.x,E.y-y.y,E.z-y.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=lb(T,f)}setPitchBearing(l,f){this.orientation=$o(a.ab(l),a.ab(-f))}}class Ef{constructor(l,f){this._transform=a.ad.identity([]),this.orientation=f,this.position=l}get mercatorPosition(){const l=this.position;return new a.Y(l[0],l[1],l[2])}get position(){const l=a.aw(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var f;l&&a.az(this._transform,3,[(f=l)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||a.av.identity([]),l&&an(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,f){this._orientation=$o(l,f),an(this._transform,this._orientation)}forward(){const l=a.aw(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=a.aw(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=a.aw(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,f){const y=new Float64Array(16);return a.ad.invert(y,this.getWorldToCamera(l,f)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(l,f,y){const w=this.position;a._.scale(w,w,-l);const E=new Float64Array(16);return a.ad.fromScaling(E,[y,y,y]),a.ad.translate(E,E,w),E[10]*=f,E}getWorldToCamera(l,f){const y=new Float64Array(16),w=new Float64Array(4),E=this.position;return a.av.conjugate(w,this._orientation),a._.scale(E,E,-l),a.ad.fromQuat(y,w),a.ad.translate(y,y,E),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(l,f,y,w){const E=new Float64Array(16);return a.ad.perspective(E,l,f,y,w),E}getCameraToClipOrthographic(l,f,y,w,E,T){const M=new Float64Array(16);return a.ad.ortho(M,l,f,y,w,E,T),M}getDistanceToElevation(l,f=!1){const y=l===0?0:a.ax(l,f?a.ay(this.position[1]):this.position[1]),w=this.forward();return(y-this.position[2])/w[2]}clone(){return new Ef([...this.position],[...this.orientation])}}const Ih={unknown:0,flipRequired:1,flipNotRequired:2},Kr=Math.tan(85*Math.PI/180);function bu(g,l,f,y,w,E,T){const M=a.ad.create();if(f)if(E.name==="globe"){const L=a.aB(w,l);a.ad.multiply(M,M,L)}else{const L=a.aC.invert([],T);M[0]=L[0],M[1]=L[1],M[4]=L[2],M[5]=L[3],y||a.ad.rotateZ(M,M,w.angle)}else a.ad.multiply(M,w.labelPlaneMatrix,g);return M}function wu(g,l,f,y,w,E,T){const M=bu(g,l,f,y,w,E,T);return E.name==="globe"&&f||(M[2]=M[6]=M[10]=M[14]=0),M}function Mh(g,l,f,y,w,E,T){if(f){if(E.name==="globe"){const M=bu(g,l,f,y,w,E,T);return a.ad.invert(M,M),a.ad.multiply(M,g,M),M}{const M=a.ad.clone(g),L=a.ad.identity([]);return L[0]=T[0],L[1]=T[1],L[4]=T[2],L[5]=T[3],a.ad.multiply(M,M,L),y||a.ad.rotateZ(M,M,-w.angle),M}}return w.glCoordMatrix}function oa(g,l,f,y){const w=[g,l,f,1];f?a.aA.transformMat4(w,w,y):sl(w,w,y);const E=w[3];return w[0]/=E,w[1]/=E,w[2]/=E,w}function jo(g,l){return Math.min(.5+g/l*.5,1.5)}function nI(g,l){const f=g[0]/g[3],y=g[1]/g[3];return f>=-l[0]&&f<=l[0]&&y>=-l[1]&&y<=l[1]}function Pm(g,l,f,y,w,E,T,M,L,B){const $=f.transform,G=y?g.textSizeData:g.iconSizeData,Z=a.aD(G,f.transform.zoom),Q=$.projection.name==="globe",ne=[256/f.width*2+1,256/f.height*2+1],ie=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ie.clear();let oe=null;Q&&(oe=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const se=g.lineVertexArray,me=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,ge=f.transform.width/f.transform.height;let _e,Pe=!1;for(let Te=0;Te<me.length;Te++){const pe=me.get(Te),{numGlyphs:ye,writingMode:ve}=pe;if(ve!==a.aE.vertical||Pe||_e===a.aE.horizontal||(Pe=!0),_e=ve,(pe.hidden||ve===a.aE.vertical)&&!Pe){Cu(ye,ie);continue}Pe=!1;const De=new a.P(pe.tileAnchorX,pe.tileAnchorY);let{x:He,y:Ee,z:Ge}=$.projection.projectTilePoint(De.x,De.y,B.canonical);if(L){const[Gt,Nt,St]=L(De);He+=Gt,Ee+=Nt,Ge+=St}const Qe=[He,Ee,Ge,1];if(a.aA.transformMat4(Qe,Qe,l),!nI(Qe,ne)){Cu(ye,ie);continue}const _t=Qe[3],xt=jo(f.transform.getCameraToCenterDistance($.projection),_t),gt=a.aF(G,Z,pe),Ue=T?gt/xt:gt*xt,rt=oa(He,Ee,Ge,w);if(rt[3]<=0){Cu(ye,ie);continue}let pt={};const Ft=T?null:L,zt=ry(pe,Ue,!1,M,l,w,E,g.glyphOffsetArray,se,ie,oe,rt,De,pt,ge,Ft,$.projection,B,T);Pe=zt.useVertical,Ft&&zt.needsFlipping&&(pt={}),(zt.notEnoughRoom||Pe||zt.needsFlipping&&ry(pe,Ue,!0,M,l,w,E,g.glyphOffsetArray,se,ie,oe,rt,De,pt,ge,Ft,$.projection,B,T).notEnoughRoom)&&Cu(ye,ie)}y?(g.text.dynamicLayoutVertexBuffer.updateData(ie),oe&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(oe)):(g.icon.dynamicLayoutVertexBuffer.updateData(ie),oe&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(oe))}function Rm(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie){const{lineStartIndex:oe,glyphStartIndex:se,segment:me}=M,ge=se+M.numGlyphs,_e=oe+M.lineLength,Pe=l.getoffsetX(se),Te=l.getoffsetX(ge-1),pe=Ph(g*Pe,f,y,w,E,T,me,oe,_e,L,B,$,G,Z,!0,Q,ne,ie);if(!pe)return null;const ye=Ph(g*Te,f,y,w,E,T,me,oe,_e,L,B,$,G,Z,!0,Q,ne,ie);return ye?{first:pe,last:ye}:null}function ty(g,l,f,y){return g===a.aE.horizontal&&Math.abs(y)>Math.abs(f)?{useVertical:!0}:g===a.aE.vertical?y>0?{needsFlipping:!0}:null:l!==Ih.unknown&&function(w,E){return w===0||Math.abs(E/w)>Kr}(f,y)?l===Ih.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function ry(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se,me){const ge=l/24,_e=g.lineOffsetX*ge,Pe=g.lineOffsetY*ge,{lineStartIndex:Te,glyphStartIndex:pe,numGlyphs:ye,segment:ve,writingMode:De,flipState:He}=g,Ee=Te+g.lineLength,Ge=Qe=>{if($){const[Ue,rt,pt]=Qe.up,Ft=B.length;a.aG($,Ft+0,Ue,rt,pt),a.aG($,Ft+1,Ue,rt,pt),a.aG($,Ft+2,Ue,rt,pt),a.aG($,Ft+3,Ue,rt,pt)}const[_t,xt,gt]=Qe.point;a.aH(B,_t,xt,gt,Qe.angle)};if(ye>1){const Qe=Rm(ge,M,_e,Pe,f,G,Z,g,L,E,Q,ie,!1,oe,se,me);if(!Qe)return{notEnoughRoom:!0};if(y&&!f){let[_t,xt,gt]=Qe.first.point,[Ue,rt,pt]=Qe.last.point;[_t,xt]=oa(_t,xt,gt,T),[Ue,rt]=oa(Ue,rt,pt,T);const Ft=ty(De,He,(Ue-_t)*ne,rt-xt);if(g.flipState=Ft&&Ft.needsFlipping?Ih.flipRequired:Ih.flipNotRequired,Ft)return Ft}Ge(Qe.first);for(let _t=pe+1;_t<pe+ye-1;_t++){const xt=Ph(ge*M.getoffsetX(_t),_e,Pe,f,G,Z,ve,Te,Ee,L,E,Q,ie,!1,!1,oe,se,me);if(!xt)return B.length-=4*(_t-pe),{notEnoughRoom:!0};Ge(xt)}Ge(Qe.last)}else{if(y&&!f){const _t=oa(Z.x,Z.y,0,w),xt=Te+ve+1,gt=new a.P(L.getx(xt),L.gety(xt)),Ue=oa(gt.x,gt.y,0,w),rt=Ue[3]>0?Ue:Sf(Z,gt,_t,1,w,void 0,oe,se.canonical),pt=ty(De,He,(rt[0]-_t[0])*ne,rt[1]-_t[1]);if(g.flipState=pt&&pt.needsFlipping?Ih.flipRequired:Ih.flipNotRequired,pt)return pt}const Qe=Ph(ge*M.getoffsetX(pe),_e,Pe,f,G,Z,ve,Te,Ee,L,E,Q,ie,!1,!1,oe,se,me);if(!Qe)return{notEnoughRoom:!0};Ge(Qe)}return{}}function km(g,l,f,y,w){const{x:E,y:T,z:M}=y.projectTilePoint(g.x,g.y,l);if(!w)return oa(E,T,M,f);const[L,B,$]=w(g);return oa(E+L,T+B,M+$,f)}function Sf(g,l,f,y,w,E,T,M){const L=km(g.sub(l)._unit()._add(g),M,w,T,E);return a._.sub(L,f,L),a._.normalize(L,L),a._.scaleAndAdd(L,f,L,y)}function Ph(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se){const me=y?g-l:g+l;let ge=me>0?1:-1,_e=0;y&&(ge*=-1,_e=Math.PI),ge<0&&(_e+=Math.PI);let Pe=M+T+(ge>0?0:1)|0,Te=w,pe=w,ye=0,ve=0;const De=Math.abs(me),He=[],Ee=[];let Ge=E,Qe=Ge;const _t=()=>Sf(Qe,Ge,pe,De-ye+1,$,Z,ie,oe.canonical);for(;ye+ve<=De;){if(Pe+=ge,Pe<M||Pe>=L)return null;if(pe=Te,Qe=Ge,He.push(pe),Q&&Ee.push(Qe),Ge=new a.P(B.getx(Pe),B.gety(Pe)),Te=G[Pe],!Te){const Nt=km(Ge,oe.canonical,$,ie,Z);Te=Nt[3]>0?G[Pe]=Nt:_t()}ye+=ve,ve=a._.distance(pe,Te)}ne&&Z&&(G[Pe]&&(Te=_t(),ve=a._.distance(pe,Te)),G[Pe]=Te);const xt=(De-ye)/ve,gt=Ge.sub(Qe)._mult(xt)._add(Qe),Ue=a._.sub([],Te,pe),rt=a._.scaleAndAdd([],pe,Ue,xt);let pt=[0,0,1],Ft=Ue[0],zt=Ue[1];if(se&&(pt=ie.upVector(oe.canonical,gt.x,gt.y),pt[0]!==0||pt[1]!==0||pt[2]!==1)){const Nt=[pt[2],0,-pt[0]],St=a._.cross([],pt,Nt);a._.normalize(Nt,Nt),a._.normalize(St,St),Ft=a._.dot(Ue,Nt),zt=a._.dot(Ue,St)}if(f){const Nt=a._.cross([],pt,Ue);a._.normalize(Nt,Nt),a._.scaleAndAdd(rt,rt,Nt,f*ge)}const Gt=_e+Math.atan2(zt,Ft);return He.push(rt),Q&&Ee.push(gt),{point:rt,angle:Gt,path:He,tilePath:Ee,up:pt}}function Cu(g,l){const f=l.length,y=f+4*g;l.resize(y),l.float32.fill(-1/0,4*f,4*y)}function sl(g,l,f){const y=l[0],w=l[1];return g[0]=f[0]*y+f[4]*w+f[12],g[1]=f[1]*y+f[5]*w+f[13],g[3]=f[3]*y+f[7]*w+f[15],g}const ny=(g,l,f)=>(1-f)*g+f*l,Pi=g=>g*g*g*g*g;class al{constructor(l,f,y,w,E,T,M){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=l||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=w??60,this.setProjection(T),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new a.aI(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Cf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Ef,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const l=new al(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(l,f=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(l||y)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return a.ah(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=a.aJ(this.projectionOptions);const y=!C(f,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(l){return this._orthographicProjectionAtLowPitch!==l&&(this._orthographicProjectionAtLowPitch=l,this._calcMatrices(),!0)}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.aJ({name:"mercator"});const f=l!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.ax(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.au(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const f=-l*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=a.aC.create(),a.aC.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const f=a.at(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=a.ab(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const f=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(l){this._tileCoverLift!==l&&(this._tileCoverLift=l)}_updateCameraOnTerrain(){const l=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,f=this.elevation&&l===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||l===Number.NEGATIVE_INFINITY&&(!f||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;f||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=l||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let w=0,E=0;for(let T=0;T<f.length;T++){const M=new a.P(f[T][0]*this.width,y+f[T][1]*(this.height-y)),L=l.pointCoordinate(M);if(!L)continue;const B=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);w+=L[3]*B,E+=B}return E===0?NaN:w/E}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,w=this._mercatorZfromZoom(l),E=this._mercatorZfromZoom(this._maxZoom),T=Math.max(w-y,E);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let y;y=l.z<this._camera.position[2]?[f.x,f.y,f.z]:[l.x,l.y,l.z];const w=a._.length(a._.sub([],this._camera.position,y));return a.at(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let f=!1;if(l.orientation&&!a.av.exactEquals(l.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(l.orientation)),l.position){const y=[l.position.x,l.position.y,l.position.z];a._.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,f=new ey;return f.position=new a.Y(l[0],l[1],l[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(l){if(!a.av.length(l))return!1;a.av.normalize(l,l);const f=a._.transformQuat([],[0,0,-1],l),y=a._.transformQuat([],[0,-1,0],l);if(y[2]<0)return!1;const w=lb(f,y);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(l){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;l[2]=a.at(l[2],w/y,w/f),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,f,y){this._unmodified=!1,this._edgeInsets.interpolate(l,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const f=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(l){const f=[new a.aK(0,l)];if(this.renderWorldCopies){const y=this.pointCoordinate(new a.P(0,0)),w=this.pointCoordinate(new a.P(this.width,0)),E=this.pointCoordinate(new a.P(this.width,this.height)),T=this.pointCoordinate(new a.P(0,this.height)),M=Math.floor(Math.min(y.x,w.x,E.x,T.x)),L=Math.floor(Math.max(y.x,w.x,E.x,T.x)),B=1;for(let $=M-B;$<=L+B;$++)$!==0&&f.push(new a.aK($,l))}return f}isLODDisabled(l){return(!l||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(l,f,y){let w=[];if(f[0]===0&&f[1]===0)return w;for(const T of l){const M=T.canonical,L=T.overscaledZ,B=T.wrap,$=1<<M.z,G=M.x+1<$,Z=M.x>0,Q=M.y+1<$,ne=M.y>0,ie=T.wrap-(Z?0:1),oe=T.wrap+(G?0:1),se=Z?M.x-1:$-1,me=G?M.x+1:0;f[0]<0?(w.push(new a.aL(L,oe,M.z,me,M.y)),f[1]<0&&Q&&(w.push(new a.aL(L,B,M.z,M.x,M.y+1)),w.push(new a.aL(L,oe,M.z,me,M.y+1))),f[1]>0&&ne&&(w.push(new a.aL(L,B,M.z,M.x,M.y-1)),w.push(new a.aL(L,oe,M.z,me,M.y-1)))):f[0]>0?(w.push(new a.aL(L,ie,M.z,se,M.y)),f[1]<0&&Q&&(w.push(new a.aL(L,B,M.z,M.x,M.y+1)),w.push(new a.aL(L,ie,M.z,se,M.y+1))),f[1]>0&&ne&&(w.push(new a.aL(L,B,M.z,M.x,M.y-1)),w.push(new a.aL(L,ie,M.z,se,M.y-1)))):f[1]<0&&Q?w.push(new a.aL(L,B,M.z,M.x,M.y+1)):ne&&w.push(new a.aL(L,B,M.z,M.x,M.y-1))}if(w.length>1){w.sort((L,B)=>L.overscaledZ-B.overscaledZ||L.wrap-B.wrap||L.canonical.z-B.canonical.z||L.canonical.x-B.canonical.x||L.canonical.y-B.canonical.y);let T=0,M=0;for(;M<w.length;)w[M].equals(w[T])?++M:w[++T]=w[M++];w.length=T+1}const E=[];for(const T of w)w.some(M=>T.isChildOf(M))||E.push(T);return w=E.filter(T=>!l.some(M=>!!(T.overscaledZ<y&&M.isChildOf(T))||T.equals(M)||T.isChildOf(M))),w}coveringTiles(l){let f=this.coveringZoomLevel(l);const y=f,w=this.elevation&&this.elevation.exaggeration(),E=w&&!l.isTerrainDEM,T=this.projection.name==="mercator";if(l.minzoom!==void 0&&f<l.minzoom)return[];l.maxzoom!==void 0&&f>l.maxzoom&&(f=l.maxzoom);const M=this.locationCoordinate(this.center),L=this.center.lat,B=1<<f,$=[B*M.x,B*M.y,0],G=this.projection.name==="globe",Z=!G,Q=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,Z),ne=G?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ie=B*a.ax(1,this.center.lat),oe=this._camera.position[2]/a.ax(1,this.center.lat),se=[B*ne.x,B*ne.y,oe*(Z?1:ie)],me=G||w,ge=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),_e=this.isLODDisabled(!0)?f:0;let Pe;if(this._elevation&&l.isTerrainDEM)Pe=1e4*this._elevation.exaggeration();else if(this._elevation){const Ue=this._elevation.getMinMaxForVisibleTiles();Pe=Ue?Ue.max:this._centerAltitude}else Pe=this._centerAltitude;const Te=l.isTerrainDEM?-Pe:this._elevation?this._elevation.getMinElevationBelowMSL():0,pe=this.projection.isReprojectedInTileSpace?a.aN(this):1,ye=Ue=>{const pt=new a.Y(Ue.x+25e-6,Ue.y,Ue.z),Ft=new a.Y(Ue.x,Ue.y+25e-6,Ue.z),zt=Ue.toLngLat(),Gt=pt.toLngLat(),Nt=Ft.toLngLat(),St=this.locationCoordinate(zt),ut=this.locationCoordinate(Gt),tr=this.locationCoordinate(Nt),$r=Math.hypot(ut.x-St.x,ut.y-St.y),Rr=Math.hypot(tr.x-St.x,tr.y-St.y);return Math.sqrt($r*Rr)*pe/25e-6},ve=Ue=>{const rt=Pe,pt=Te;return{aabb:a.aQ(this,B,0,0,0,Ue,pt,rt,this.projection),zoom:0,x:0,y:0,minZ:pt,maxZ:rt,wrap:Ue,fullyVisible:!1}},De=[];let He=[];const Ee=f,Ge=l.reparseOverscaled?y:f,Qe=Ue=>Ue*Ue,_t=Qe((oe-this._centerAltitude)*ie),xt=Ue=>{if(!this._elevation||!Ue.tileID||!T)return;const rt=this._elevation.getMinMaxForTile(Ue.tileID),pt=Ue.aabb;rt?(pt.min[2]=rt.min,pt.max[2]=rt.max,pt.center[2]=(pt.min[2]+pt.max[2])/2):(Ue.shouldSplit=gt(Ue),Ue.shouldSplit||(pt.min[2]=pt.max[2]=pt.center[2]=this._centerAltitude))},gt=Ue=>{if(Ue.zoom<_e)return!0;if(Ue.zoom===Ee)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const rt=Ue.aabb.distanceX(se),pt=Ue.aabb.distanceY(se);let Ft=_t,zt=1;if(G){Ft=Qe(Ue.aabb.distanceZ(se));const St=Math.pow(2,Ue.zoom),ut=a.ay((Ue.y+1)/St),tr=a.ay(Ue.y/St),$r=Math.min(Math.max(L,ut),tr),Rr=a.b4($r)/a.b4(L);if(zt=$r===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Rr/this._mercatorScaleRatio),this.zoom<=a.b1&&Ue.zoom===Ee-1&&Rr>=.9)return!0}else if(E&&(Ft=Qe(Ue.aabb.distanceZ(se)*ie)),this.projection.isReprojectedInTileSpace&&y<=5){const St=Math.pow(2,Ue.zoom),ut=ye(new a.Y((Ue.x+.5)/St,(Ue.y+.5)/St));zt=ut>.85?1:ut}const Gt=rt*rt+pt*pt+Ft,Nt=Qe((1<<Ee-Ue.zoom)*ge*zt*((St,ut)=>{if(ut*Qe(.707)<St)return 1;const tr=Math.sqrt(ut/St);return tr/(1.4144271570014144+(Math.pow(1.1,tr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ft,_t),Gt));return Gt<Nt};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)De.push(ve(-Ue)),De.push(ve(Ue));for(De.push(ve(0));De.length>0;){const Ue=De.pop(),rt=Ue.x,pt=Ue.y;let Ft=Ue.fullyVisible;const zt=()=>this.projection.name==="globe"&&(Ue.y===0||Ue.y===(1<<Ue.zoom)-1);if(!Ft){let Gt=me?Ue.aabb.intersects(Q):Ue.aabb.intersectsFlat(Q);if(Gt===0&&zt()){const Nt=new a.aO(Ue.zoom,rt,pt);Gt=a.aP(this,B,Nt,!0).intersects(Q)}if(Gt===0)continue;Ft=Gt===2}if(Ue.zoom!==Ee&&gt(Ue))for(let Gt=0;Gt<4;Gt++){const Nt=(rt<<1)+Gt%2,St=(pt<<1)+(Gt>>1),ut={aabb:T?Ue.aabb.quadrant(Gt):a.aQ(this,B,Ue.zoom+1,Nt,St,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Nt,y:St,wrap:Ue.wrap,fullyVisible:Ft,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};E&&!G&&(ut.tileID=new a.aL(Ue.zoom+1===Ee?Ge:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Nt,St),xt(ut)),De.push(ut)}else{const Gt=Ue.zoom===Ee?Ge:Ue.zoom;if(l.minzoom&&l.minzoom>Gt)continue;if(!Ft){let tr=me?Ue.aabb.intersectsPrecise(Q):Ue.aabb.intersectsPreciseFlat(Q);if(tr===0&&zt()){const $r=new a.aO(Ue.zoom,rt,pt);tr=a.aP(this,B,$r,!0).intersectsPrecise(Q)}if(tr===0)continue}const Nt=$[0]-(.5+rt+(Ue.wrap<<Ue.zoom))*(1<<f-Ue.zoom),St=$[1]-.5-pt,ut=Ue.tileID?Ue.tileID:new a.aL(Gt,Ue.wrap,Ue.zoom,rt,pt);He.push({tileID:ut,distanceSq:Nt*Nt+St*St})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,rt=this.horizonLineFromTop();He=He.filter(pt=>{const Ft=[0,0,0,1],zt=[a.a3,a.a3,0,1],Gt=this.calculateFogTileMatrix(pt.tileID.toUnwrapped());a.aA.transformMat4(Ft,Ft,Gt),a.aA.transformMat4(zt,zt,Gt);const Nt=a.aA.min([],Ft,zt),St=a.aA.max([],Ft,zt),ut=a.aR(Nt,St);if(ut===0)return!0;let tr=!1;const $r=this._elevation;if($r&&ut>Ue&&rt!==0){const Rr=this.calculateProjMatrix(pt.tileID.toUnwrapped());let Zr;l.isTerrainDEM||(Zr=$r.getMinMaxForTile(pt.tileID)),Zr||(Zr={min:Te,max:Pe});const ln=a.b2(this.rotation),Pn=[ln[0]*a.a3,ln[1]*a.a3,Zr.max];a._.transformMat4(Pn,Pn,Rr),tr=(1-Pn[1])*this.height*.5<rt}return ut<Ue||tr})}return He.sort((Ue,rt)=>Ue.distanceSq-rt.distanceSq).map(Ue=>Ue.tileID)}resize(l,f){this.width=l,this.height=f,this.pixelsToGLUnits=[2/l,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const f=a.at(l.lat,-a.aS,a.aS),y=this.projection.project(l.lng,f);return new a.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.ax(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,f){let y,w;const E=this.centerPoint;if(this.projection.name==="globe"){const M=this.worldSize;y=(f.x-E.x)/M,w=(f.y-E.y)/M}else{const M=this.pointCoordinate(f),L=this.pointCoordinate(E);y=M.x-L.x,w=M.y-L.y}const T=this.locationCoordinate(l);this.setLocation(new a.Y(T.x-y,T.y-w))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,f){const y=f?a.ax(f,l.lat):void 0,w=this.projection.project(l.lng,l.lat);return new a.Y(w.x,w.y,y)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,f){const y=f??this._centerAltitude,w=[l.x,l.y,0,1],E=[l.x,l.y,1,1];a.aA.transformMat4(w,w,this.pixelMatrixInverse),a.aA.transformMat4(E,E,this.pixelMatrixInverse);const T=E[3];a.aA.scale(w,w,1/w[3]),a.aA.scale(E,E,1/T);const M=w[2],L=E[2];return{p0:w,p1:E,t:M===L?0:(y-M)/(L-M)}}screenPointToMercatorRay(l){const f=[l.x,l.y,0,1],y=[l.x,l.y,1,1];return a.aA.transformMat4(f,f,this.pixelMatrixInverse),a.aA.transformMat4(y,y,this.pixelMatrixInverse),a.aA.scale(f,f,1/f[3]),a.aA.scale(y,y,1/y[3]),f[2]=a.ax(f[2],this._center.lat)*this.worldSize,y[2]=a.ax(y[2],this._center.lat)*this.worldSize,a.aA.scale(f,f,1/this.worldSize),a.aA.scale(y,y,1/this.worldSize),new a.aT([f[0],f[1],f[2]],a._.normalize([],a._.sub([],y,f)))}rayIntersectionCoordinate(l){const{p0:f,p1:y,t:w}=l,E=a.ax(f[2],this._center.lat),T=a.ax(y[2],this._center.lat);return new a.Y(a.a2(f[0],y[0],w)/this.worldSize,a.a2(f[1],y[1],w)/this.worldSize,a.a2(E,T,w))}pointCoordinate(l,f=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,f)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let f=this.projection.pointCoordinate3D(this,l.x,l.y);if(f)return new a.Y(f[0],f[1],f[2]);let y=0,w=this.horizonLineFromTop();if(l.y>w)return this.pointCoordinate(l);const E=.02*w,T=l.clone();for(let M=0;M<10&&w-y>E;M++){T.y=a.a2(y,w,.66);const L=this.projection.pointCoordinate3D(this,T.x,T.y);L?(w=T.y,f=L):y=T.y}return f?new a.Y(f[0],f[1],f[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=a.aU)return!this.isPointAboveHorizon(l);const f=this.pointCoordinate(l);return f.y>=0&&f.y<=1}_coordinatePoint(l,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,w=[l.x*this.worldSize,l.y*this.worldSize,y+l.toAltitude(),1];return a.aA.transformMat4(w,w,this.pixelMatrix),w[3]>0?new a.P(w[0]/w[3],w[1]/w[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:f}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,E=this.pointLocation3D(new a.P(f,l)),T=this.pointLocation3D(new a.P(w,l)),M=this.pointLocation3D(new a.P(w,y)),L=this.pointLocation3D(new a.P(f,y));let B=Math.min(E.lng,T.lng,M.lng,L.lng),$=Math.max(E.lng,T.lng,M.lng,L.lng),G=Math.min(E.lat,T.lat,M.lat,L.lat),Z=Math.max(E.lat,T.lat,M.lat,L.lat);const Q=Math.pow(2,-this.zoom)/16*270,ne=this.projection.name==="globe"?1:4,ie=(oe,se,me,ge,_e)=>{const Pe=(oe+me)/2,Te=(se+ge)/2,pe=new a.P(Pe,Te),{lng:ye,lat:ve}=this.pointLocation3D(pe),De=Math.max(0,B-ye,G-ve,ye-$,ve-Z);B=Math.min(B,ye),$=Math.max($,ye),G=Math.min(G,ve),Z=Math.max(Z,ve),(_e<ne||De>Q)&&(ie(oe,se,Pe,Te,_e+1),ie(Pe,Te,me,ge,_e+1))};if(ie(f,l,w,l,1),ie(w,l,w,y,1),ie(w,y,f,y,1),ie(f,y,f,l,1),this.projection.name==="globe"){const[oe,se]=a.aV(this);oe?(Z=90,$=180,B=-180):se&&(G=-90,$=180,B=-180)}return new a.ai(new a.aI(B,G),new a.aI($,Z))}_getBoundsRectangular(l,f){const{top:y,left:w}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,M=new a.P(w,y),L=new a.P(T,y),B=new a.P(T,E),$=new a.P(w,E);let G=this.pointCoordinate(M,l),Z=this.pointCoordinate(L,l);const Q=this.pointCoordinate(B,f),ne=this.pointCoordinate($,f),ie=(oe,se)=>(se.y-oe.y)/(se.x-oe.x);return G.y>1&&Z.y>=0?G=new a.Y((1-ne.y)/ie(ne,G)+ne.x,1):G.y<0&&Z.y<=1&&(G=new a.Y(-ne.y/ie(ne,G)+ne.x,0)),Z.y>1&&G.y>=0?Z=new a.Y((1-Q.y)/ie(Q,Z)+Q.x,1):Z.y<0&&G.y<=1&&(Z=new a.Y(-Q.y/ie(Q,Z)+Q.x,0)),new a.ai().extend(this.coordinateLocation(G)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=l.visibleDemTiles.reduce((y,w)=>{if(w.dem){const E=w.dem.tree;y.min=Math.min(y.min,E.minimums[0]),y.max=Math.max(y.max,E.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*l.exaggeration(),f.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return l?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-a.aS,this.maxLat=a.aS,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.aj(this.minLng)*this.tileSize,this.worldMaxX=a.aj(this.maxLng)*this.tileSize,this.worldMinY=a.ak(this.maxLat)*this.tileSize,this.worldMaxY=a.ak(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,f){return this.projection.createTileMatrix(this,f,l)}calculateDistanceTileData(l){const f=l.key,y=this._distanceTileDataCache;if(y[f])return y[f];const w=l.canonical,E=1/this.height,T=this.cameraWorldSize,M=T/this.zoomScale(w.z),L=(w.x+Math.pow(2,w.z)*l.wrap)*M,B=w.y*M,$=this.point;$.x*=T/this.worldSize,$.y*=T/this.worldSize;const G=this.angle,Z=Math.sin(-G),Q=-Math.cos(-G);return y[f]={bearing:[Z,Q],center:[($.x-L)*E,($.y-B)*E],scale:M/a.a3*E},y[f]}calculateFogTileMatrix(l){const f=l.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return a.ad.multiply(w,this.worldToFogMatrix,w),y[f]=new Float32Array(w),y[f]}calculateProjMatrix(l,f=!1,y=!1){const w=l.key;let E;if(E=y?this._expandedProjMatrixCache:f?this._alignedProjMatrixCache:this._projMatrixCache,E[w])return E[w];const T=this.calculatePosMatrix(l,this.worldSize);let M;return M=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:f?this.alignedProjMatrix:this.projMatrix,a.ad.multiply(T,M,T),E[w]=new Float32Array(T),E[w]}calculatePixelsToTileUnitsMatrix(l){const f=l.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const w=a.aW(l,this);return y[f]=w,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,f=a.ad.fromScaling([],[l,l,l]);return a.ad.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const f=a.ax(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),w=this._camera.forward(),E=a.ax(1,this._center.lat);y[2]/=E,w[2]/=E,a._.normalize(w,w);const T=l.raycast(y,w,l.exaggeration());if(T){const M=a._.scaleAndAdd([],y,w,T),L=new a.Y(M[0],M[1],a.ax(M[2],a.ay(M[1]))),B=(L.z+a._.length([L.x-y[0],L.y-y[1],L.z-y[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const f=this._elevation,y=a.ax(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(y),E=f.getAtPointOrZero(new a.Y(...w)),T=this.pixelsPerMeter/this.worldSize*E,M=this._minimumHeightOverTerrain(),L=w[2]-T;if(L<=M)if(L<0||l){const B=this.locationCoordinate(this._center,this._centerAltitude),$=[w[0],w[1],B.z-w[2]],G=a._.length($);$[2]-=(M-L)/this._pixelsPerMercatorPixel;const Z=a._.length($);if(Z===0)return;a._.scale($,$,G/Z*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],B.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const Z=this.center;return Z.lat=a.at(Z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(Z.lng=a.at(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const f=this._unmodified,{x:y,y:w}=this.point;let E=0,T=y,M=w;const L=this.width/2,B=this.height/2,$=this.worldMinY*this.scale,G=this.worldMaxY*this.scale;if(w-B<$&&(M=$+B),w+B>G&&(M=G-B),G-$<this.height&&(E=Math.max(E,this.height/(G-$)),M=(G+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,ne=this.worldSize/2-(Z+Q)/2;T=(y+ne+this.worldSize)%this.worldSize-ne,T-L<Z&&(T=Z+L),T+L>Q&&(T=Q-L),Q-Z<this.width&&(E=Math.max(E,this.width/(Q-Z)),T=(Q+Z)/2)}T===y&&M===w||(this.center=this.unproject(new a.P(T,M))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,f=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.ax(1,this.center.lat)/a.ax(1,a.b3));const w=a.aX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?y:1,T=this._camera.getWorldToCamera(this.worldSize,E);let M;const L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(L[8]=2*-l.x/this.width,L[9]=2*l.y/this.height,this.isOrthographic){let ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),De=ve*this.aspect,He=-De,Ee=-ve;De-=l.x,He-=l.x,ve+=l.y,Ee+=l.y,M=this._camera.getCameraToClipOrthographic(He,De,Ee,ve,this._nearZ,this._farZ),((Ge,Qe,_t,xt)=>{for(let gt=0;gt<16;gt++)Ge[gt]=ny(Qe[gt],_t[gt],xt)})(M,M,L,Pi(this.pitch>=15?1:this.pitch/15))}else M=L;const B=a.ad.mul([],L,T);let $=a.ad.mul([],M,T);if(this.projection.isReprojectedInTileSpace){const ve=this.locationCoordinate(this.center),De=a.ad.identity([]);a.ad.translate(De,De,[ve.x*this.worldSize,ve.y*this.worldSize,0]),a.ad.multiply(De,De,a.aY(this)),a.ad.translate(De,De,[-ve.x*this.worldSize,-ve.y*this.worldSize,0]),a.ad.multiply($,$,De),a.ad.multiply(B,B,De),this.inverseAdjustmentMatrix=a.aZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.ad.scale([],$,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=$,this.invProjMatrix=a.ad.invert(new Float64Array(16),this.projMatrix),f){const ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ve[8]=2*-l.x/this.width,ve[9]=2*l.y/this.height,this.expandedFarZProjMatrix=a.ad.mul([],ve,T)}else this.expandedFarZProjMatrix=this.projMatrix;const G=a.ad.invert([],M);this.frustumCorners=a.a_.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!f);const Z=new Float32Array(16);a.ad.identity(Z),a.ad.scale(Z,Z,[1,-1,1]),a.ad.rotateX(Z,Z,this._pitch),a.ad.rotateZ(Z,Z,this.angle);const Q=a.ad.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.ad.clone(Q);const ne=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-l.x/this.width,Q[9]=2*(l.y+ne)/this.height,this.skyboxMatrix=a.ad.multiply(Z,Q,Z);const ie=this.point,oe=ie.x,se=ie.y,me=this.width%2/2,ge=this.height%2/2,_e=Math.cos(this.angle),Pe=Math.sin(this.angle),Te=oe-Math.round(oe)+_e*me+Pe*ge,pe=se-Math.round(se)+_e*ge+Pe*me,ye=new Float64Array($);if(a.ad.translate(ye,ye,[Te>.5?Te-1:Te,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=ye,$=a.ad.create(),a.ad.scale($,$,[this.width/2,-this.height/2,1]),a.ad.translate($,$,[1,-1,0]),this.labelPlaneMatrix=$,$=a.ad.create(),a.ad.scale($,$,[1,-1,1]),a.ad.translate($,$,[-1,-1,0]),a.ad.scale($,$,[2/this.width,2/this.height,1]),this.glCoordMatrix=$,this.pixelMatrix=a.ad.multiply(new Float64Array(16),this.labelPlaneMatrix,B),this._calcFogMatrices(),this._distanceTileDataCache={},$=a.ad.invert(new Float64Array(16),this.pixelMatrix),!$)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=$,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.a$(this);const ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a._.transformMat4(ve,ve,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=$;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,y=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,E=[l,l,f];a._.scale(E,E,w),a._.scale(y,y,-1),a._.multiply(y,y,E);const T=a.ad.create();a.ad.translate(T,T,y),a.ad.scale(T,T,E),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,f,w)}_computeCameraPosition(l){const f=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),w=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-l/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-y[0]*E,w.y/this.worldSize-y[1]*E,l/this.worldSize*this._centerAltitude-y[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],w=l[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(E=Math.min((f-y)/w,1)),this._camera.position=a._.scaleAndAdd([],this._camera.position,l,E),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:w}=this._camera.getPitchBearing(),E=a.ax(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.ab(this._maxPitch)),M=Math.max((l[2]-E)/Math.cos(y),T),L=this._zoomFromMercatorZ(M);a._.scaleAndAdd(l,l,f,M),this._pitch=a.at(y,a.ab(this.minPitch),a.ab(this.maxPitch)),this.angle=a.au(w,-Math.PI,Math.PI),this._setZoom(a.at(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.Y(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let f=0,y=a.aU,w=0,E=1/0;for(;y-f>1e-6&&y>f;){const T=f+.5*(y-f),M=this.tileSize*Math.pow(2,T),L=this.getCameraToCenterDistance(this.projection,T,M),B=this.scaleZoom(L/(l*this.tileSize)),$=Math.abs(T-B);$<E&&(E=$,w=T),T<B?f=T:y=T}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,f){const y=Math.min(l.x,f.x),w=Math.max(l.x,f.x),E=Math.min(l.y,f.y),T=Math.max(l.y,f.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const M=[new a.P(y,E),new a.P(w,T),new a.P(y,T),new a.P(w,E)],L=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const $ of M){const G=this.pointRayIntersection($);if(G.t<0)return!0;const Z=this.rayIntersectionCoordinate(G);if(Z.x<L||Z.y<0||Z.x>B||Z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.b0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(l,f){const y=a._.length(a._.sub([],this._camera.position,l)),w=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const l=function([f,y,w],E){const T=[f,y,w,1];a.aA.transformMat4(T,T,E);const M=T[3]=Math.max(T[3],1e-6);return T[0]/=M,T[1]/=M,T[2]/=M,T}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,l))}}getCameraToCenterDistance(l,f=this.zoom,y=this.worldSize){const w=a.aX(l,f,this.width,this.height,1024),E=l.pixelSpaceConversion(this.center.lat,y,w);let T=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(T=ny(1,T,Pi(this.pitch>=15?1:this.pitch/15))),T}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.ad.multiply(l,l,this.globeMatrix),l}getFrustum(l){return a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,this.projection.zAxisUnit==="meters")}}const Xo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},jl=(g,l)=>{if(l>0&&g.terrain&&a.w("Cutoff is currently disabled on terrain"),l<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const f=g.transform,y=Math.max(Math.abs(f._zoom-(g.minCutoffZoom-1)),1),w=f.isLODDisabled(!1)?a.$(60,45,f.pitch):a.$(30,15,f.pitch),E=f._farZ-f._nearZ,T=l*f.height,M=((1-(L=w))*f.cameraToCenterDistance+L*(f._farZ+T))*y;var L;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[f._nearZ,f._farZ,(M-f._nearZ)/E,(M-T-f._nearZ)/E]}}},Ao={cascadeCount:2,shadowMapResolution:2048};class iy{constructor(l,f){this.aabb=l,this.lastCascade=f}}class oy{add(l,f){const y=this.receivers[l.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],f.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],f.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],f.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],f.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],f.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],f.max[2])):this.receivers[l.key]=new iy(f,null)}clear(){this.receivers={}}get(l){return this.receivers[l.key]}computeRequiredCascades(l,f,y){const w=a.b6.fromPoints(l.points);let E=0;for(const T in this.receivers){const M=this.receivers[T];if(!M||!w.intersectsAabb(M.aabb))continue;M.aabb.min=w.closestPoint(M.aabb.min),M.aabb.max=w.closestPoint(M.aabb.max);const L=M.aabb.getCorners();for(let B=0;B<y.length;B++){let $=!0;for(const G of L){const Z=[G[0]*f,G[1]*f,G[2]];if(a._.transformMat4(Z,Z,y[B].matrix),Z[0]<-1||Z[0]>1||Z[1]<-1||Z[1]>1){$=!1;break}}if(M.lastCascade=B,E=Math.max(E,B),$)break}}return E+1}}class Dm{constructor(l){this.painter=l,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new oy,this._depthMode=new a.ae(l.context.gl.LEQUAL,a.ae.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,l.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),l.tp.registerParameter(Ao,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),l.tp.registerParameter(Ao,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),l.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const l of this._cascades)l.texture.destroy(),l.framebuffer.destroy();this._cascades=[]}updateShadowParameters(l,f){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!f||!f.properties)return;const w=f.properties.get("shadow-intensity");if(!f.shadowsEnabled()||w<=0||(this._shadowLayerCount=y.style.order.reduce((ne,ie)=>{const oe=y.style._mergedLayers[ie];return ne+(oe.hasShadowPass()&&!oe.isHidden(l.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const E=y.context,T=Ao.shadowMapResolution,M=Ao.shadowMapResolution;if(this._cascades.length===0||Ao.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ne=0;ne<Ao.cascadeCount;++ne){const ie=y._shadowMapDebug,oe=E.gl,se=E.createFramebuffer(T,M,ie,"texture"),me=new a.T(E,{width:T,height:M,data:null},oe.DEPTH_COMPONENT);if(se.depthAttachment.set(me.texture),ie){const ge=new a.T(E,{width:T,height:M,data:null},oe.RGBA);se.colorAttachment.set(ge.texture)}this._cascades.push({framebuffer:se,texture:me,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.aM,scale:0})}}this.shadowDirection=Tf(f);let L=0;if(l.elevation){const ne=l.elevation,ie=[1e4,-1e4];ne.visibleDemTiles.filter(oe=>oe.dem).forEach(oe=>{const se=oe.dem.tree;ie[0]=Math.min(ie[0],se.minimums[0]),ie[1]=Math.max(ie[1],se.maximums[0])}),ie[0]!==1e4&&(L=(ie[1]-ie[0])*ne.exaggeration())}const B=1.5*l.cameraToCenterDistance,$=3*B,G=new Float64Array(16);for(let ne=0;ne<this._cascades.length;++ne){const ie=this._cascades[ne];let oe=l.height/50,se=1;Ao.cascadeCount===1?se=$:ne===0?se=B:(oe=B,se=$);const[me,ge]=Af(l,this.shadowDirection,oe,se,Ao.shadowMapResolution,L);ie.scale=l.scale,ie.matrix=me,ie.boundingSphereRadius=ge,a.ad.invert(G,ie.matrix),ie.frustum=a.aM.fromInvProjectionMatrix(G,1,0,!0),ie.far=se}const Z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Z].far,this._cascades[Z].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ao.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ao.shadowMapResolution,this._uniformValues.u_shadowmap_0=Xo.ShadowMap0,this._uniformValues.u_shadowmap_1=Xo.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Q=y.transform.elevation;for(const ne of this._groundShadowTiles){let ie={min:0,max:0};if(Q){const oe=Q.getMinMaxForTile(ne);oe&&(ie=oe)}this.addShadowReceiver(ne.toUnwrapped(),ie.min,ie.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(l){this._enabled=l}drawShadowPass(l,f){if(!this.enabled)return;const y=this.painter,w=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),w.viewport.set([0,0,Ao.shadowMapResolution,Ao.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){y.currentShadowCascade=E,w.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),w.clear({color:a.C.white,depth:1});for(const T of l.order){const M=l._mergedLayers[T];if(!M.hasShadowPass()||M.isHidden(y.transform.zoom))continue;const L=l.getLayerSourceCache(M),B=L?f[L.id]:void 0;(M.type==="model"||B&&B.length)&&y.renderLayer(y,L,M,B)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const l=this.painter,f=l.style,y=l.context,w=f.directionalLight,E=f.ambientLight;if(!w||!E)return;const T=[],M=jl(l,l.longestCutoffRange);M.shouldRenderCutoff&&T.push("RENDER_CUTOFF");const L=Vl(f,w,E),B=new a.ae(y.gl.LEQUAL,a.ae.ReadOnly,l.depthRangeFor3D);for(const $ of this._groundShadowTiles){const G=$.toUnwrapped(),Z=l.isTileAffectedByFog($),Q=l.getOrCreateProgram("groundShadow",{defines:T,overrideFog:Z});this.setupShadows(G,Q),l.uploadCommonUniforms(y,Q,G,null,M);const ne={u_matrix:l.transform.calculateProjMatrix(G),u_ground_shadow_factor:L};Q.draw(l,y.gl.TRIANGLES,B,a.ag.disabled,a.a.multiply,a.af.disabled,ne,"ground_shadow",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments,{},l.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?a.a.unblended:a.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(l){const f=this.painter.transform,y=f.calculatePosMatrix(l,f.worldSize);return a.ad.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(l){return a.ad.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}setupShadows(l,f,y,w=0){if(!this.enabled)return;const E=this.painter.transform,T=this.painter.context,M=T.gl,L=this._uniformValues,B=new Float64Array(16),$=E.calculatePosMatrix(l,E.worldSize);for(let G=0;G<this._cascades.length;G++)a.ad.multiply(B,this._cascades[G].matrix,$),L[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(B),T.activeTexture.set(M.TEXTURE0+Xo.ShadowMap0+G),this._cascades[G].texture.bind(M.NEAREST,M.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const G=a.b5(l.canonical),Z=2/E.tileSize*a.a3/Ao.shadowMapResolution,Q=Z*this._cascades[0].boundingSphereRadius,ne=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,ie=(y==="vector-tile"?1:3)/Math.pow(2,w-l.canonical.z-(1-E.zoom+Math.floor(E.zoom)));L.u_shadow_normal_offset=[G,Q*ie,ne*ie],L.u_shadow_bias=[6e-5,.0012,.012]}else L.u_shadow_bias=[36e-5,.0012,.012];f.setShadowUniformValues(T,L)}setupShadowsFromMatrix(l,f,y=!1){if(!this.enabled)return;const w=this.painter.context,E=w.gl,T=this._uniformValues,M=new Float64Array(16);for(let L=0;L<Ao.cascadeCount;L++)a.ad.multiply(M,this._cascades[L].matrix,l),T[L===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),w.activeTexture.set(E.TEXTURE0+Xo.ShadowMap0+L),this._cascades[L].texture.bind(E.NEAREST,E.CLAMP_TO_EDGE);this.useNormalOffset=y,y?(T.u_shadow_normal_offset=[1,5,5],T.u_shadow_bias=[6e-5,.0012,.012]):T.u_shadow_bias=[36e-5,.0012,.012],f.setShadowUniformValues(w,T)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(l,f,y,w){if(w[2]>=0)return{};const E=function(L,B,$){const G=$/(1<<L.canonical.z);return new a.b6([L.canonical.x*G+L.wrap*$,L.canonical.y*G+L.wrap*$,0],[(L.canonical.x+1)*G+L.wrap*$,(L.canonical.y+1)*G+L.wrap*$,B])}(l,f,y).getCorners(),T=f/-w[2];w[0]<0?(a._.add(E[0],E[0],[w[0]*T,0,0]),a._.add(E[3],E[3],[w[0]*T,0,0])):w[0]>0&&(a._.add(E[1],E[1],[w[0]*T,0,0]),a._.add(E[2],E[2],[w[0]*T,0,0])),w[1]<0?(a._.add(E[0],E[0],[0,w[1]*T,0]),a._.add(E[1],E[1],[0,w[1]*T,0])):w[1]>0&&(a._.add(E[2],E[2],[0,w[1]*T,0]),a._.add(E[3],E[3],[0,w[1]*T,0]));const M={};return M.vertices=E,M.planes=[Rh(E[1],E[0],E[4]),Rh(E[2],E[1],E[5]),Rh(E[3],E[2],E[6]),Rh(E[0],E[3],E[7])],M}addShadowReceiver(l,f,y){this._receivers.add(l,a.b6.fromTileIdAndHeight(l,f,y))}getMaxCascadeForTile(l){const f=this._receivers.get(l);return f&&f.lastCascade?f.lastCascade:0}}function Rh(g,l,f){const y=a._.sub([],f,l),w=a._.sub([],g,l),E=a._.cross([],y,w),T=a._.length(E);return T===0?[0,0,1,0]:(a._.scale(E,E,1/T),[E[0],E[1],E[2],-a._.dot(E,l)])}function Tf(g){const l=g.properties.get("direction"),f=a.ac(l.x,l.y,l.z);f[2]=a.at(f[2],0,75);const y=a.b7([f[0],f[1],f[2]]);return a._.fromValues(y.x,y.y,y.z)}function Vl(g,l,f){const y=l.properties.get("color"),w=l.properties.get("intensity"),E=l.properties.get("direction"),T=[E.x,E.y,E.z],M=f.properties.get("color"),L=f.properties.get("intensity"),B=Math.max(a._.dot([0,0,1],T),0),$=[0,0,0];a._.scale($,M.toRenderColor(g.getLut(l.scope)).toArray01Linear().slice(0,3),L);const G=[0,0,0];return a._.scale(G,y.toRenderColor(g.getLut(f.scope)).toArray01Linear().slice(0,3),B*w),a.b8([$[0]>0?$[0]/($[0]+G[0]):0,$[1]>0?$[1]/($[1]+G[1]):0,$[2]>0?$[2]/($[2]+G[2]):0])}function Af(g,l,f,y,w,E){const T=g.zoom,M=g.scale,L=g.worldSize,B=1/L,$=g.aspect,G=Math.sqrt(1+$*$)*Math.tan(.5*g.fovX),Z=G*G,Q=y-f,ne=y+f;let ie,oe;Z>Q/ne?(ie=y,oe=y*G):(ie=.5*ne*(1+Z),oe=.5*Math.sqrt(Q*Q+2*(y*y+f*f)*Z+ne*ne*Z*Z));const se=g.projection.pixelsPerMeter(g.center.lat,L),me=g._camera.getCameraToWorldMercator(),ge=[0,0,-ie*B];a._.transformMat4(ge,ge,me);let _e=oe*B;const Pe=g._edgeInsets;if(!(Pe.left===0&&Pe.top===0&&Pe.right===0&&Pe.bottom===0||Pe.left===Pe.right&&Pe.top===Pe.bottom)){const Ft=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?se:1),zt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,f,y);zt[8]=2*-g.centerOffset.x/g.width,zt[9]=2*g.centerOffset.y/g.height;const Gt=new Float64Array(16);a.ad.mul(Gt,zt,Ft);const Nt=new Float64Array(16);a.ad.invert(Nt,Gt);const St=a.aM.fromInvProjectionMatrix(Nt,L,T,!0);for(const ut of St.points){const tr=((Te=ut)[0]/=M,Te[1]/=M,Te[2]=a.ax(Te[2],g._center.lat),Te);_e=Math.max(_e,a._.len(a._.subtract([],ge,tr)))}}var Te;_e*=w/(w-1);const pe=Math.acos(l[2]),ye=Math.atan2(-l[0],-l[1]),ve=new Ef;ve.position=ge,ve.setPitchBearing(pe,ye);const De=ve.getWorldToCamera(L,se),He=_e*L,Ee=Math.min(g._mercatorZfromZoom(17)*L*-2,-2*He),Ge=ve.getCameraToClipOrthographic(-He,He,-He,He,Ee,(He+E*se)/l[2]),Qe=new Float64Array(16);a.ad.multiply(Qe,Ge,De);const _t=a._.fromValues(Math.floor(1e6*ge[0])/1e6*L,Math.floor(1e6*ge[1])/1e6*L,0),xt=.5*w,gt=[0,0,0];a._.transformMat4(gt,_t,Qe),a._.scale(gt,gt,xt);const Ue=[Math.floor(gt[0]),Math.floor(gt[1]),Math.floor(gt[2])],rt=[0,0,0];a._.sub(rt,gt,Ue),a._.scale(rt,rt,-1/xt);const pt=new Float64Array(16);return a.ad.identity(pt),a.ad.translate(pt,pt,rt),a.ad.multiply(Qe,pt,Qe),[Qe,He]}function Om(g,l){return g!=null&&l!=null&&!(!g.hasData()||!l.hasData())&&g.demTexture!=null&&l.demTexture!=null&&g.tileID.key!==l.tileID.key}const Eu=new class{constructor(){this.operations={}}newMorphing(g,l,f,y,w){if(g in this.operations){const E=this.operations[g];E.to.tileID.key!==f.tileID.key&&(E.queued=f)}else this.operations[g]={startTime:y,phase:0,duration:w,from:l,to:f,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const l=this.operations[g];return{from:l.from,to:l.to,phase:l.phase}}update(g){for(const l in this.operations){const f=this.operations[l];for(f.phase=(g-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,g)){delete this.operations[l];break}}}_nextOp(g,l){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=l,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},If={0:null,1:"TERRAIN_VERTEX_MORPHING"};function sy(g,l,f){if(l===0)return 0;const y=l<1&&f===514?.25/l:1;return 6*Math.pow(1.5,22-g)*Math.max(l,1)*y}function cb(g,l){const f=1<<g.z;return!l&&(g.x===0||g.x===f-1)||g.y===0||g.y===f-1}const Lm=g=>({u_matrix:g});function Bm(g,l,f,y,w){if(w>0){const E=a.e.now(),T=(E-g.timeAdded)/w,M=l?(E-l.timeAdded)/w:-1,L=f.getSource(),B=y.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),$=!l||Math.abs(l.tileID.overscaledZ-B)>Math.abs(g.tileID.overscaledZ-B),G=$&&g.refreshedUponExpiration?1:a.at($?T:1-M,0,1);return g.refreshedUponExpiration&&T>=1&&(g.refreshedUponExpiration=!1),l?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}class kh extends wf{constructor(l,f,y,w){super(l,f,y,w),this.type="raster-array",this.maxzoom=22,this._options=a.W({type:"raster-array"},f)}triggerRepaint(l){const f=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);f&&f.enabled&&y&&f._clearRenderCacheForTile(y.id,l.tileID),this.map.triggerRepaint()}loadTile(l,f){const y=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(y,a.R.Tile);l.requestParams=w,l.actor||(l.actor=this.dispatcher.getActor()),l.request=l.fetchHeader(void 0,(E,T,M,L)=>{if(delete l.request,l.aborted)return l.state="unloaded",f(null);if(E)return E.code===20?void 0:(l.state="errored",f(E));this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:M,expires:L}),l.state="empty",f(null)})}unloadTile(l,f){const y=l.texture;y&&y instanceof a.T?(l.destroy(!0),this.map.painter.saveTileTexture(y)):(l.destroy(),l.flushQueues(),l._isHeaderLoaded=!1,delete l._mrt,delete l.textureDescriptor),l.fbo&&(l.fbo.destroy(),delete l.fbo),delete l.request,delete l.requestParams,delete l.neighboringTiles,l.state="unloaded"}prepareTile(l,f,y){l._isHeaderLoaded&&(l.state!=="empty"&&(l.state="reloading"),l.fetchBand(f,y,(w,E)=>{if(w)return l.state="errored",this.fire(new a.d(w)),void this.triggerRepaint(l);E&&(l.setTexture(E,this.map.painter),l.state="loaded",this.triggerRepaint(l))}))}getInitialBand(l){if(!this.rasterLayers)return 0;const f=this.rasterLayers.find(({id:E})=>E===l),y=f&&f.fields,w=y&&y.bands&&y.bands;return w?w[0]:0}getTextureDescriptor(l,f,y){if(!l)return;const w=f.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let E=null;f instanceof a.bk?E=f.paint.get("raster-array-band"):f instanceof a.bl&&(E=f.paint.get("raster-particle-array-band"));const T=E||this.getInitialBand(w);if(T!=null)if(l.textureDescriptor){if(!l.updateNeeded(w,T)||y)return Object.assign({},l.textureDescriptor,{texture:l.texture})}else this.prepareTile(l,w,T)}}const Io={vector:Mm,raster:wf,"raster-dem":class extends wf{constructor(g,l,f,y){super(g,l,f,y),this.type="raster-dem",this.maxzoom=22,this._options=a.W({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(g,l){const f=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(w,E){w&&(g.state="errored",l(w)),E&&(g.dem=E,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",l(null))}g.request=a.h(this.map._requestManager.transformRequest(f,a.R.Tile),function(w,E,T,M){if(delete g.request,g.aborted)g.state="unloaded",l(null);else if(w)g.state="errored",l(w);else if(E){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:T,expires:M});const L=ImageBitmap&&E instanceof ImageBitmap&&a.bi(),B=1-(E.width-a.bj(E.width))/2;B<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const $=L?E:a.e.getImageData(E,B),G={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:$,encoding:this.encoding,padding:B};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",G,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(g){const l=g.canonical,f=Math.pow(2,l.z),y=(l.x-1+f)%f,w=l.x===0?g.wrap-1:g.wrap,E=(l.x+1+f)%f,T=l.x+1===f?g.wrap+1:g.wrap,M={};return M[new a.aL(g.overscaledZ,w,l.z,y,l.y).key]={backfilled:!1},M[new a.aL(g.overscaledZ,T,l.z,E,l.y).key]={backfilled:!1},l.y>0&&(M[new a.aL(g.overscaledZ,w,l.z,y,l.y-1).key]={backfilled:!1},M[new a.aL(g.overscaledZ,g.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},M[new a.aL(g.overscaledZ,T,l.z,E,l.y-1).key]={backfilled:!1}),l.y+1<f&&(M[new a.aL(g.overscaledZ,w,l.z,y,l.y+1).key]={backfilled:!1},M[new a.aL(g.overscaledZ,g.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},M[new a.aL(g.overscaledZ,T,l.z,E,l.y+1).key]={backfilled:!1}),M}},"raster-array":kh,geojson:class extends a.E{constructor(g,l,f,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=l.data,this._options=a.W({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.minzoom!==void 0&&(this.minzoom=l.minzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const w=a.a3/this.tileSize;this.workerOptions=a.W({source:this.id,scope:this.scope,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*w,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*w,extent:a.a3,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:a.a3,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*w,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter,dynamic:l.dynamic},l.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){return this._options.dynamic?typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection")?this.fire(new a.d(new Error("Data to update should be a feature or a feature collection."))):(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"?this._data.features.push(...g.features):this._data=g,this._updateWorkerData(!0),this):this.fire(new a.d(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(g,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},l),this}getClusterChildren(g,l){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},l),this}getClusterLeaves(g,l,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:l,offset:f},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.f("dataloading",{dataType:"source"})),this._loaded=!1;const l=a.W({append:g},this.workerOptions);l.scope=this.scope;const f=this._data;typeof f=="string"?(l.request=this.map._requestManager.transformRequest(a.e.resolveURL(f),a.R.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(f),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(y,w)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new a.d(y));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(E.resourceTiming=w.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new a.f("data",E)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,l){const f=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,w=this._partialReload,E={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:y?{image:y.image.clone()}:null,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:w};g.request=this.actor.send(f,E,(T,M)=>w&&!M?(g.state="loaded",l(null)):(delete g.request,g.destroy(),g.aborted?l(null):T?l(T):(g.loadVectorData(M,this.map.painter,f==="reloadTile"),l(null))),void 0,f==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,l){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.W({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.bm{constructor(g,l,f,y){super(g,l,f,y),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const l of g.urls)this.urls.push(this.map._requestManager.transformRequest(l,a.R.Source).url);a.bn(this.urls,(l,f)=>{this._loaded=!0,l?this.fire(new a.d(l)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const l=this.video.seekable;g<l.start(0)||g>l.end(0)?this.fire(new a.d(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,l=g.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(g,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.bm,model:class extends a.E{constructor(g,l,f,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=l}load(){const g=[];for(const l in this._options.models){const f=this._options.models[l],y=a.l(this.map._requestManager.transformRequest(f.uri,a.R.Model).url).then(w=>{if(!w)return;const E=a.c(w),T=new a.M(l,f.position,f.orientation,E);T.computeBoundsAndApplyParent(),this.models.push(T)}).catch(w=>{this.fire(new a.d(new Error(`Could not load model ${l} from ${f.uri}: ${w.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(l=>{this.fire(new a.d(new Error(`Could not load models: ${l.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,l){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(g,l,f,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=l,this.tiles=this._options.tiles,this.maxzoom=l.maxzoom||19,this.minzoom=l.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=f,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}load(g){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=J_(this._options,this.map._requestManager,l,f,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,y?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new a.d(y))):w&&(a.W(this,w),w.bounds&&(this.tileBounds=new bf(w.bounds,this.minzoom,this.maxzoom)),a.an(w.tiles,this.map._requestManager._customAccessToken),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,l){const f=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(f,a.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=l;else{if(g.buckets){const E=Object.values(g.buckets);for(const T of E)T.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,w.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,w.bind(this),void 0,!0);function w(E,T){return g.aborted?l(null):E&&E.status!==404?l(E):(T&&(T.resourceTiming&&(g.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&g.setExpiryData(T),g.buckets={...g.buckets,...T.buckets},T.featureIndex&&(g.latestFeatureIndex=T.featureIndex)),g.state="loaded",void l(null))}}serialize(){return a.W({},this._options)}},canvas:class extends a.bm{constructor(g,l,f,y){super(g,l,f,y),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new a.d(new a.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.d(new a.V(`sources.${g}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new a.d(new a.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new a.d(new a.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.d(new a.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.d(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof a.bo||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends a.E{constructor(g,l,f,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=l,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.d(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.d(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new bf(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),a.W(this,a.ah(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ah(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:l,y:f,z:y}=g.canonical;return this._implementation.hasTile({x:l,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,l){const{x:f,y,z:w}=g.tileID.canonical,E=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:f,y,z:w},{signal:E.signal})).then(function(T){return delete g.request,g.aborted?(g.state="unloaded",l(null)):T===void 0?(g.state="errored",l(null)):T===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",l(null)):function(M){return M instanceof ImageData||M instanceof HTMLCanvasElement||M instanceof ImageBitmap||M instanceof HTMLImageElement}(T)?(this.loadTileData(g,T),g.state="loaded",void l(null)):(g.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(T=>{T.code!==20&&(g.state="errored",l(T))}),g.request.cancel=()=>E.abort()}loadTileData(g,l){g.setTexture(l,this._map.painter)}unloadTile(g,l){if(g.texture&&g.texture instanceof a.T?(g.destroy(!0),g.texture&&g.texture instanceof a.T&&this._map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:f,y,z:w}=g.tileID.canonical;this._implementation.unloadTile({x:f,y,z:w})}l&&l()}abortTile(g,l){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),l&&l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=a.al(this.id,this.scope);this._map.style.clearSource(g)}_update(){this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))}}},Fm=function(g,l,f,y){const w=new Io[l.type](g,l,f,y);if(w.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${w.id}`);return a.bp(["load","abort","unload","serialize","prepare"],w),w};class ay extends a.bv{constructor(l){const f={type:"raster-dem",maxzoom:l.transform.maxZoom},y=new a.bw(a.bx(),null),w=Fm("mock-dem",f,y,l.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,f){l.state="loaded",f(null)}}class ub extends a.bv{constructor(l){const f=Fm("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new a.bw(a.bx(),null),l.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,f,y){if(l.freezeTileCoverage)return;this.transform=l;const w=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,T)=>{if(E[T.key]="",!this._tiles[T.key]){const M=new a.by(T,this._source.tileSize*T.overscaleFactor(),l.tileZoom);M.state="loaded",this._tiles[T.key]=M}return E},{});for(const E in this._tiles)E in w||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(l){const f=this.proxyCachedFBO[l];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ly extends a.aL{constructor(l,f,y){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class cy extends a.bq{constructor(l,f){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},l.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,w,E]=function(L){const B=new a.bt,$=new a.bu,G=131;B.reserve(17161),$.reserve(33800);const Z=a.a3/128,Q=a.a3+Z/2,ne=Q+Z;for(let oe=-Z;oe<ne;oe+=Z)for(let se=-Z;se<ne;se+=Z){const me=se<0||se>Q||oe<0||oe>Q?24575:0,ge=a.at(Math.round(se),0,a.a3),_e=a.at(Math.round(oe),0,a.a3);B.emplaceBack(ge+me,_e)}const ie=(oe,se)=>{const me=se*G+oe;$.emplaceBack(me+1,me,me+G),$.emplaceBack(me+G,me+G+1,me+1)};for(let oe=1;oe<129;oe++)for(let se=1;se<129;se++)ie(se,oe);return[0,129].forEach(oe=>{for(let se=0;se<130;se++)ie(se,oe),ie(oe,se)}),[B,$,32768]}(),T=l.context;this.gridBuffer=T.createVertexBuffer(y,a.br.members),this.gridIndexBuffer=T.createIndexBuffer(w),this.gridSegments=a.b.simpleSegment(0,0,y.length,w.length),this.gridNoSkirtSegments=a.b.simpleSegment(0,0,y.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ub(f.map),this.orthoMatrix=a.ad.create(),a.ad.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.a3,0,a.a3,0,1);const M=T.gl;this._overlapStencilMode=new a.ag({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ay(f.map),this._pendingGroundEffectLayers=[]}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),this._style=l,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,f,y){if(l&&l.terrain){this._style!==l&&(this.style=l,this._evaluationZoom=void 0);const w=l.terrain.properties,E=l.terrain.drapeRenderMode===0,T=l.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.e.now();const M=l.terrain&&l.terrain.scope,L=w.get("source"),B=E?this._mockSourceCache:l.getSourceCache(L,M);if(!B)return void a.w(`Couldn't find terrain source "${L}".`);if(this.sourceCache=B,this._exaggeration=T?this.calculateExaggeration(f):w.get("exaggeration"),!f.projection.requiresDraping&&T&&this._exaggeration===0)return void this._disable();this.enabled=!0;const $=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const G=this.getScaledDemTileSize();this.sourceCache.update(f,G,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,$(),this._initializing=!0),$(),f.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0,this._previousZoom=f.zoom}else this._disable()}calculateExaggeration(l){const f=this._previousCameraAltitude,y=l.getFreeCameraOptions().position.z/l.pixelsPerMeter*l.worldSize;this._previousCameraAltitude=y;const w=f!=null?y-f:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const E=l.zoom,T=this._style.terrain;if(!this._previousUpdateTimestamp)return T.getExaggeration(E);let M=E-this._previousZoom;const L=this._previousUpdateTimestamp;let B=E;this._evaluationZoom!=null&&(B=this._evaluationZoom,Math.abs(E-B)>.5&&(M=.5*(E-B+M)),M*w<0&&(B+=M)),this._evaluationZoom=B;const $=T.getExaggeration(B),G=$===T.getExaggeration(Math.max(0,B-.1));if(G&&Math.abs($-this._exaggeration)<.01)return $;let Z=Math.min(.1,.00375*(this._updateTimestamp-L));return(G||$<.1||Math.abs(M)<1e-4)&&(Z=Math.min(.2,4*Z)),a.a2(this._exaggeration,$,Z)}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._mergedSourceCaches)this._style._mergedSourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(a.Y.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=f.getIds().map(L=>{const B=f.getTileByID(L).tileID;return B.projMatrix=y.calculateProjMatrix(B.toUnwrapped()),B});(function(L,B){const $=B.transform.pointCoordinate(B.transform.getCameraPoint()),G=new a.P($.x,$.y);L.sort((Z,Q)=>{if(Q.overscaledZ-Z.overscaledZ)return Q.overscaledZ-Z.overscaledZ;const ne=new a.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),ie=new a.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),oe=G.mult(1<<Z.canonical.z);return oe.x-=.5,oe.y-=.5,oe.distSqr(ne)-oe.distSqr(ie)})})(w,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},w.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const T=this._style._mergedSourceCaches;for(const L in T){const B=T[L];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,l[L],E),B.usedForTerrain))continue;const $=l[L];B.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[f.id]=w.map(L=>new ly(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const M={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const B=this.terrainTileForTile[L.key];if(!B)continue;const $=B.tileID.key;$ in M||(this._visibleDemTiles.push(B),M[$]=$)}}_assignTerrainTiles(l){this._initializing||l.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const l=this.painter.context,f=l.gl;for(const y in this.terrainTileForTile){const w=this.terrainTileForTile[y],E=w.dem;!E||w.demTexture&&!w.needsDEMTextureUpload||(l.activeTexture.set(f.TEXTURE1),Q_(this.painter,w,E))}}_prepareDemTileUniforms(l,f,y,w){if(!f||f.demTexture==null)return!1;const E=l.tileID.canonical,T=Math.pow(2,f.tileID.canonical.z-E.z),M=w||"";return y[`u_dem_tl${M}`]=[E.x*T%1,E.y*T%1],y[`u_dem_scale${M}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,f=l.gl;if(!this._emptyDepthBufferTexture){const y=new a.i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.T(l,y,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let l=0;const f=this._visibleDemTiles.reduce((y,w)=>{if(!w.dem)return y;const E=w.dem.tree.minimums[0];return E>0&&l++,y+E},0);return l?f/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,f=l.gl;l.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),[w,E]=(()=>{const M=new a.bz({width:1,height:1},new Float32Array([y]));return[f.R32F,M]})();this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(E,{premultiply:!1}):T=this._emptyDEMTexture=new a.T(l,E,w,{premultiply:!1}),T}setupElevationDraw(l,f,y){const w=this.painter.context,E=w.gl,T={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};T.u_exaggeration=this.exaggeration();let M=null,L=null,B=1;if(y&&y.morphing&&this._useVertexMorphing){const Q=y.morphing.srcDemTile,ne=y.morphing.dstDemTile;B=y.morphing.phase,Q&&ne&&(this._prepareDemTileUniforms(l,Q,T,"_prev")&&(L=Q),this._prepareDemTileUniforms(l,ne,T)&&(M=ne))}const $=Q=>Q&&Q.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST;let G=null;var Z;if(this.enabled?L&&M?(G=M.demTexture,w.activeTexture.set(E.TEXTURE4),L.demTexture.bind($(L),E.CLAMP_TO_EDGE),T.u_dem_lerp=B):(M=this.terrainTileForTile[l.tileID.key],G=this._prepareDemTileUniforms(l,M,T)?M.demTexture:this.emptyDEMTexture):G=this.emptyDEMTexture,w.activeTexture.set(E.TEXTURE2),G&&(T.u_dem_size=(Z=G).size[0]===1?1:Z.size[0]-2,G.bind($(M),E.CLAMP_TO_EDGE)),w.activeTexture.set(E.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&M){const Q=(1<<M.tileID.canonical.z)*a.ax(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=Q}if(y&&y.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(w,T),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,l.tileID.canonical,y&&y.useDenormalizedUpVectorScale);f.setGlobeUniformValues(w,Q)}}globeUniformValues(l,f,y){const w=l.projection;return{u_tile_tl_up:w.upVector(f,0,0),u_tile_tr_up:w.upVector(f,a.a3,0),u_tile_br_up:w.upVector(f,a.a3,a.a3),u_tile_bl_up:w.upVector(f,0,a.a3),u_tile_up_scale:y?a.bs(1):w.upVectorScale(f,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const f=this.painter,y=this.painter.context;l.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,E,T,M,L){if(w.transform.projection.name==="globe")(function(B,$,G,Z,Q){const ne=B.context,ie=ne.gl;let oe,se;const me=B.transform,ge=a.ba(B,ne,me),_e=(Ge,Qe)=>{if(se===Qe)return;const _t=[If[Qe],"PROJECTION_GLOBE_VIEW"];ge&&_t.push("CUSTOM_ANTIALIASING");const xt=B.isTileAffectedByFog(Ge);oe=B.getOrCreateProgram("globeRaster",{defines:_t,overrideFog:xt}),se=Qe},Pe=B.colorModeForRenderPass(),Te=new a.ae(ie.LEQUAL,a.ae.ReadWrite,B.depthRangeFor3D);Eu.update(Q);const pe=a.bb(me),ye=[a.aj(me.center.lng),a.ak(me.center.lat)],ve=B.globeSharedBuffers,De=[me.width*a.e.devicePixelRatio,me.height*a.e.devicePixelRatio],He=Float32Array.from(me.globeMatrix),Ee={useDenormalizedUpVectorScale:!0};{const Ge=B.transform,Qe=sy(Ge.zoom,$.exaggeration(),$.sourceCache._source.tileSize);se=-1;const _t=ie.TRIANGLES;for(const xt of Z){const gt=G.getTile(xt),Ue=a.ag.disabled,rt=$.prevTerrainTileForTile[xt.key],pt=$.terrainTileForTile[xt.key];Om(rt,pt)&&Eu.newMorphing(xt.key,rt,pt,Q,250),ne.activeTexture.set(ie.TEXTURE0),gt.texture&&gt.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const Ft=Eu.getMorphValuesForProxy(xt.key),zt=Ft?1:0;Ft&&a.o(Ee,{morphing:{srcDemTile:Ft.from,dstDemTile:Ft.to,phase:a.b9(Ft.phase)}});const Gt=a.bc(xt.canonical),Nt=a.bd(Gt.getCenter().lat),St=a.be(xt.canonical,Gt,Nt,Ge.worldSize/Ge._pixelsPerMercatorPixel),ut=a.bf(a.bg(xt.canonical)),tr=ab(Ge.expandedFarZProjMatrix,He,pe,ut,a.a1(Ge.zoom),ye,Ge.frustumCorners.TL,Ge.frustumCorners.TR,Ge.frustumCorners.BR,Ge.frustumCorners.BL,Ge.globeCenterInViewSpace,Ge.globeRadius,De,Qe,Ge._farZ,St);if(_e(xt,zt),oe&&($.setupElevationDraw(gt,oe,Ee),B.uploadCommonUniforms(ne,oe,xt.toUnwrapped()),ve)){const[$r,Rr,Zr]=ve.getGridBuffers(Nt,Qe!==0);oe.draw(B,_t,Te,Ue,Pe,a.af.backCCW,tr,"globe_raster",$r,Rr,Zr)}}}if(ve&&(B.renderDefaultNorthPole||B.renderDefaultSouthPole)){const Ge=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ge&&Ge.push("CUSTOM_ANTIALIASING"),oe=B.getOrCreateProgram("globeRaster",{defines:Ge});for(const Qe of Z){const{x:_t,y:xt,z:gt}=Qe.canonical,Ue=xt===0,rt=xt===(1<<gt)-1,[pt,Ft,zt,Gt]=ve.getPoleBuffers(gt,!1);if(Gt&&(Ue||rt)){const Nt=G.getTile(Qe);ne.activeTexture.set(ie.TEXTURE0),Nt.texture&&Nt.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);let St=a.bh(gt,_t,me);const ut=a.bf(a.bg(Qe.canonical)),tr=($r,Rr)=>$r.draw(B,ie.TRIANGLES,Te,a.ag.disabled,Pe,a.af.disabled,ab(me.expandedFarZProjMatrix,St,St,ut,0,ye,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,De,0,me._farZ),"globe_pole_raster",Rr,zt,Gt);$.setupElevationDraw(Nt,oe,Ee),B.uploadCommonUniforms(ne,oe,Qe.toUnwrapped()),Ue&&B.renderDefaultNorthPole&&tr(oe,pt),rt&&B.renderDefaultSouthPole&&(St=a.ad.scale(a.ad.create(),St,[1,-1,1]),tr(oe,Ft))}}}})(w,E,T,M,L);else{const B=w.context,$=B.gl;let G,Z;const Q=w.shadowRenderer,ne=jl(w,w.longestCutoffRange),ie=Pe=>{if(Z===Pe)return;const Te=[];Te.push(If[Pe]),ne.shouldRenderCutoff&&Te.push("RENDER_CUTOFF"),G=w.getOrCreateProgram("terrainRaster",{defines:Te}),Z=Pe},oe=w.colorModeForRenderPass(),se=new a.ae($.LEQUAL,a.ae.ReadWrite,w.depthRangeFor3D);Eu.update(L);const me=w.transform,ge=sy(me.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let _e=[0,0,0];if(Q){const Pe=w.style.directionalLight,Te=w.style.ambientLight;Pe&&Te&&(_e=Vl(w.style,Pe,Te))}{Z=-1;const Pe=$.TRIANGLES,[Te,pe]=[E.gridIndexBuffer,E.gridSegments];for(const ye of M){const ve=T.getTile(ye),De=a.ag.disabled,He=E.prevTerrainTileForTile[ye.key],Ee=E.terrainTileForTile[ye.key];Om(He,Ee)&&Eu.newMorphing(ye.key,He,Ee,L,250),B.activeTexture.set($.TEXTURE0),ve.texture&&ve.texture.bind($.LINEAR,$.CLAMP_TO_EDGE);const Ge=Eu.getMorphValuesForProxy(ye.key),Qe=Ge?1:0;let _t;Ge&&(_t={morphing:{srcDemTile:Ge.from,dstDemTile:Ge.to,phase:a.b9(Ge.phase)}});const xt=Ut(ye.projMatrix,cb(ye.canonical,me.renderWorldCopies)?ge/10:ge,_e);if(ie(Qe),!G)continue;E.setupElevationDraw(ve,G,_t);const gt=ye.toUnwrapped();Q&&Q.setupShadows(gt,G),w.uploadCommonUniforms(B,G,gt,null,ne),G.draw(w,Pe,se,De,oe,a.af.backCCW,xt,"terrain_raster",E.gridBuffer,Te,pe)}}}}(f,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,w=this.proxySourceCache,E=this.proxiedCoords[w.id],T=this._drapedRenderBatches.shift(),M=f.style.order,L=[];let B=0;for(const $ of E){const G=w.getTileByID($.proxyTileKey),Z=w.proxyCachedFBO[$.key]?w.proxyCachedFBO[$.key][l]:void 0,Q=Z!==void 0?w.renderCache[Z]:this.pool[B++],ne=Z!==void 0;if(G.texture=Q.tex,ne&&!Q.dirty){L.push(G.tileID);continue}let ie;y.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(y.clear({color:a.C.transparent,stencil:0}),Q.dirty=!1);for(let oe=T.start;oe<=T.end;++oe){const se=f.style._mergedLayers[M[oe]];if(se.isHidden(f.transform.zoom))continue;const me=f.style.getLayerSourceCache(se),ge=me?this.proxyToSource[$.key][me.id]:[$];if(!ge)continue;const _e=ge;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),ie!==(me?me.id:null)&&(this._setupStencil(Q,ge,se,me),ie=me?me.id:null),f.renderLayer(f,me,se,_e)}if(this._drapedRenderBatches.length===0)for(const oe of this._pendingGroundEffectLayers){const se=f.style._mergedLayers[M[oe]];if(se.isHidden(f.transform.zoom))continue;const me=f.style.getLayerSourceCache(se),ge=me?this.proxyToSource[$.key][me.id]:[$];if(!ge)continue;const _e=ge;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),ie!==(me?me.id:null)&&(this._setupStencil(Q,ge,se,me),ie=me?me.id:null),f.renderLayer(f,me,se,_e)}this.renderedToTile?(Q.dirty=!0,L.push(G.tileID)):ne||--B,B===5&&(B=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),T.end+1}postRender(){}isLayerOrderingCorrect(l){const f=l.order.length;let y=-1,w=f;for(let E=0;E<f;++E)this._style.isLayerDraped(l._mergedLayers[l.order[E]])?y=Math.max(y,E):w=Math.min(w,E);return w>y}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{l=Math.min(l,f.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,f,y){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const T=E.tileID,M=1<<T.overscaledZ,{x:L,y:B}=T.canonical,$=L/M,G=(L+1)/M,Z=B/M,Q=(B+1)/M;return{minx:$,miny:Z,maxx:G,maxy:Q,t:E.dem.tree.raycastRoot($,Z,G,Q,l,f,y),tile:E}});w.sort((E,T)=>(E.t!==null?E.t:Number.MAX_VALUE)-(T.t!==null?T.t:Number.MAX_VALUE));for(const E of w){if(E.t==null)return null;const T=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,l,f,y);if(T!=null)return T}return null}_createFBO(){const l=this.painter.context,f=l.gl,y=this.drapeBufferSize;l.activeTexture.set(f.TEXTURE0);const w=new a.T(l,{width:y[0],height:y[1],data:null},f.RGBA);w.bind(f.LINEAR,f.CLAMP_TO_EDGE);const E=l.createFramebuffer(y[0],y[1],!0,null);return E.colorAttachment.set(w.texture),E.depthAttachment=new yr(l,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:E,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const f=this._style._mergedLayers[l],y=f.isHidden(this.painter.transform.zoom);return f.type==="custom"?!y&&f.shouldRedrape():!y&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const y of this._style.getSources())if(y instanceof Mm){l=!0;break}if(!l)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],E=this._style.getLayerSourceCache(w);if(E&&!f[E.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof a.Z){f[E.id]=!0;for(const T of this.proxyCoords){const M=this.proxyToSource[T.key][E.id];if(M)for(const L of M)this._clearRenderCacheForTile(E.id,L)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof wf){l=!0;break}if(!l)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],E=this._style.getLayerSourceCache(w);if(!E||f[E.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const T=w.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const L=this.proxyToSource[M.key][E.id];if(L)for(const B of L){const $=Bm(E.getTile(B),E.findLoadedParent(B,0),E,this.painter.transform,T);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(E.id,B)}}}}_setupDrapedRenderBatches(){const l=this._style.order,f=l.length;if(f===0)return;const y=[];this._pendingGroundEffectLayers=[];let w,E=0,T=this._style._mergedLayers[l[E]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++E<f;)T=this._style._mergedLayers[l[E]];for(;E<f;++E){const M=this._style._mergedLayers[l[E]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?w===void 0&&(w=E):(M.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(E),w!==void 0&&(y.push({start:w,end:E-1}),w=void 0)))}if(w!==void 0&&y.push({start:w,end:E-1}),y.length!==0){const M=y[y.length-1];this._pendingGroundEffectLayers.every(L=>L>M.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(l){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const T=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let M=0;M<T.length;++M){const L=Object.values(T[M]);f.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,w=this._tilesDirty;for(let T=y.length-1;T>=0;T--){const M=y[T];if(f.getTileByID(M.key),f.proxyCachedFBO[M.key]!==void 0){const L=l[M.key],B=this.proxyToSource[M.key];let $=0;for(const G in B){const Z=B[G],Q=L[G];if(!Q||Q.length!==Z.length||Z.some((ne,ie)=>ne!==Q[ie]||w[G]&&w[G].hasOwnProperty(ne.key))){$=-1;break}++$}for(const G in f.proxyCachedFBO[M.key])f.renderCache[f.proxyCachedFBO[M.key][G]].dirty=$<0||$!==Object.values(L).length}}const E=[...this._drapedRenderBatches];E.sort((T,M)=>M.end-M.start-(T.end-T.start));for(const T of E)for(const M of y){if(f.proxyCachedFBO[M.key])continue;let L=f.renderCachePool.pop();L===void 0&&f.renderCache.length<50&&(L=f.renderCache.length,f.renderCache.push(this._createFBO())),L!==void 0&&(f.proxyCachedFBO[M.key]={},f.proxyCachedFBO[M.key][T.start]=L,f.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(l,f,y,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,T=E.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let M;if(y.isTileClipped())M=f.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):a.ag.disabled}_renderTileClippingMasks(l,f){const y=this.painter,w=this.painter.context,E=w.gl;y._tileClippingMaskIDs={},w.setColorMode(a.a.disabled),w.setDepthMode(a.ae.disabled);const T=y.getOrCreateProgram("clippingMask");for(const M of l){const L=y._tileClippingMaskIDs[M.key]=--f;T.draw(y,E.TRIANGLES,a.ae.disabled,new a.ag({func:E.ALWAYS,mask:0},L,255,E.KEEP,E.KEEP,E.REPLACE),a.a.disabled,a.af.disabled,Lm(M.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(l){const f=this.painter.transform;if(l.x<0||l.x>f.width||l.y<0||l.y>f.height)return null;const y=[l.x,l.y,1,1];a.aA.transformMat4(y,y,f.pixelMatrixInverse),a.aA.scale(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const w=f._camera.position,E=a.ax(1,f.center.lat),T=[w[0],w[1],w[2]/E,0],M=a._.subtract([],y.slice(0,3),T);a._.normalize(M,M);const L=this.raycast(T,M,this._exaggeration);return L!==null&&L?(a._.scaleAndAdd(T,T,M,L),T[3]=T[2],T[2]*=E,T):null}drawDepth(){const l=this.painter,f=l.context,y=this.proxySourceCache,w=Math.ceil(l.width),E=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=f.gl,M=f.createFramebuffer(w,E,!0,"renderbuffer");f.activeTexture.set(T.TEXTURE0);const L=new a.T(f,{width:w,height:E,data:null},T.RGBA);L.bind(T.NEAREST,T.CLAMP_TO_EDGE),M.colorAttachment.set(L.texture);const B=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,w,E);M.depthAttachment.set(B),this._depthFBO=M,this._depthTexture=L}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,w,E]),function(T,M,L,B){if(T.transform.projection.name==="globe")return;const $=T.context,G=$.gl;$.clear({depth:1});const Z=T.getOrCreateProgram("terrainDepth"),Q=new a.ae(G.LESS,a.ae.ReadWrite,T.depthRangeFor3D);for(const ne of B){const ie=L.getTile(ne),oe=Ut(ne.projMatrix,0,[0,0,0]);M.setupElevationDraw(ie,Z),Z.draw(T,G.TRIANGLES,Q,a.ag.disabled,a.a.unblended,a.af.backCCW,oe,"terrain_depth",M.gridBuffer,M.gridIndexBuffer,M.gridNoSkirtSegments)}}(l,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,f,y){if(l.getSource()instanceof a.bm)return this._setupProxiedCoordsForImageSource(l,f,y);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const w=this.proxiedCoords[l.id]=[],E=this.proxyCoords;for(let L=0;L<E.length;L++){const B=E[L],$=this._findTileCoveringTileID(B,l);if($){const G=this._createProxiedId(B,$,y[B.key]&&y[B.key][l.id]);w.push(G),this.proxyToSource[B.key][l.id]=[G]}}let T=!1;const M=new Set;for(let L=0;L<f.length;L++){const B=l.getTile(f[L]);if(!B||!B.hasData())continue;const $=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==B.tileID.canonical.z){const G=this.proxyToSource[$.tileID.key][l.id],Z=this._createProxiedId($.tileID,B,y[$.tileID.key]&&y[$.tileID.key][l.id]);G?G.splice(G.length-1,0,Z):this.proxyToSource[$.tileID.key][l.id]=[Z];const Q=this.proxyToSource[$.tileID.key][l.id];M.has(Q)||M.add(Q),w.push(Z),T=!0}}if(this._sourceTilesOverlap[l.id]=T,T&&this._debugParams.sortTilesHiZFirst)for(const L of M)L.sort((B,$)=>$.overscaledZ-B.overscaledZ)}_setupProxiedCoordsForImageSource(l,f,y){if(!l.getSource().loaded())return;const w=this.proxiedCoords[l.id]=[],E=this.proxyCoords,T=l.getSource(),M=T.tileID;if(!M)return;const L=new a.P(M.x,M.y)._div(1<<M.z),B=T.coordinates.map(a.Y.fromLngLat).reduce((G,Z)=>(G.min.x=Math.min(G.min.x,Z.x-L.x),G.min.y=Math.min(G.min.y,Z.y-L.y),G.max.x=Math.max(G.max.x,Z.x-L.x),G.max.y=Math.max(G.max.y,Z.y-L.y),G),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(G,Z)=>{const Q=G.wrap+G.canonical.x/(1<<G.canonical.z),ne=G.canonical.y/(1<<G.canonical.z),ie=a.a3/(1<<G.canonical.z),oe=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),se=Z.canonical.y/(1<<Z.canonical.z);return Q+ie<oe+B.min.x||Q>oe+B.max.x||ne+ie<se+B.min.y||ne>se+B.max.y};for(let G=0;G<E.length;G++){const Z=E[G];for(let Q=0;Q<f.length;Q++){const ne=l.getTile(f[Q]);if(!ne||!ne.hasData()||$(Z,ne.tileID))continue;const ie=this._createProxiedId(Z,ne,y[Z.key]&&y[Z.key][l.id]),oe=this.proxyToSource[Z.key][l.id];oe?oe.push(ie):this.proxyToSource[Z.key][l.id]=[ie],w.push(ie)}}}_createProxiedId(l,f,y){let w=this.orthoMatrix;if(y){const E=y.find(T=>T.key===f.tileID.key);if(E)return E}if(f.tileID.key!==l.key){const E=l.canonical.z-f.tileID.canonical.z;let T,M,L;w=a.ad.create();const B=f.tileID.wrap-l.wrap<<l.overscaledZ;E>0?(T=a.a3>>E,M=T*((f.tileID.canonical.x<<E)-l.canonical.x+B),L=T*((f.tileID.canonical.y<<E)-l.canonical.y)):(T=a.a3<<-E,M=a.a3*(f.tileID.canonical.x-(l.canonical.x+B<<-E)),L=a.a3*(f.tileID.canonical.y-(l.canonical.y<<-E))),a.ad.ortho(w,0,T,0,T,0,1),a.ad.translate(w,w,[M,L,0])}return new ly(f.tileID,l.key,w)}_findTileCoveringTileID(l,f){let y=f.getTile(l);if(y&&y.hasData())return y;const w=this._findCoveringTileCache[f.id],E=w[l.key];if(y=E?f.getTileByID(E):null,y&&y.hasData()||E===null)return y;let T=y?y.tileID:l,M=T.overscaledZ;const L=f.getSource().minzoom,B=[];if(!E){const G=f.getSource().maxzoom;if(l.canonical.z>=G){const Z=l.canonical.z-G;f.getSource().reparseOverscaled?(M=Math.max(l.canonical.z+2,f.transform.tileZoom),T=new a.aL(M,l.wrap,G,l.canonical.x>>Z,l.canonical.y>>Z)):Z!==0&&(M=G,T=new a.aL(M,l.wrap,G,l.canonical.x>>Z,l.canonical.y>>Z))}T.key!==l.key&&(B.push(T.key),y=f.getTile(T))}const $=G=>{B.forEach(Z=>{w[Z]=G}),B.length=0};for(M-=1;M>=L&&(!y||!y.hasData());M--){y&&$(y.tileID.key);const G=T.calculateScaledKey(M);if(y=f.getTileByID(G),y&&y.hasData())break;const Z=w[G];if(Z===null)break;Z===void 0?B.push(G):y=f.getTileByID(Z)}return $(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,f){let y=this._tilesDirty[l];y||(y=this._tilesDirty[l]={}),y[f.key]=!0}}function Hl(g,l,f){const y=function(M,L,B){const $=a._.dot(L,M),G=a._.dot(B,[.2126,.7152,.0722]),Z=(ne,ie,oe)=>(1-oe)*ne+oe*ie,Q=Z(1-.3*Math.min(G,1),1,Math.min($+1,1));return Z(.92,1,Math.asin(a.at(L[2],-1,1))/Math.PI+.5)*Q}(g,[0,0,1],l),w=[0,0,0];a._.scale(w,f.slice(0,3),y);const E=[0,0,0];a._.scale(E,l.slice(0,3),g[2]);const T=[0,0,0];return a._.add(T,w,E),a.b8(T)}const zm=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],hb=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Mf{static cacheKey(l,f,y,w){let E=`${f}${w?w.cacheKey:""}`;for(const T of y)l.usedDefines.includes(T)&&(E+=`/${T}`);return E}constructor(l,f,y,w,E,T){const M=l.gl;this.program=M.createProgram(),this.configuration=w,this.name=f,this.fixedDefines=[...T];const L=w?w.getBinderAttributes():[],B=(y.staticAttributes||[]).concat(L);let $=w?w.defines():[];$=$.concat(T.map(oe=>`#define ${oe}`));const G=`#version 300 es
`;let Z=G+$.concat("precision mediump float;",ob,ib.fragmentSource).join(`
`);for(const oe of y.fragmentIncludes)Z+=`
${Am[oe]}`;Z+=`
${y.fragmentSource}`;let Q=G+$.concat("precision highp float;",ob,ib.vertexSource).join(`
`);for(const oe of y.vertexIncludes)Q+=`
${Am[oe]}`;Q+=`
${y.vertexSource}`;const ne=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(ne,Z),M.compileShader(ne),M.attachShader(this.program,ne);const ie=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(ie,Q),M.compileShader(ie),M.attachShader(this.program,ie),this.attributes={},this.numAttributes=B.length;for(let oe=0;oe<this.numAttributes;oe++)if(B[oe]){const se=B[oe].startsWith("a_")?B[oe]:`a_${B[oe]}`;M.bindAttribLocation(this.program,oe,se),this.attributes[se]=oe}M.linkProgram(this.program),M.deleteShader(ie),M.deleteShader(ne),this.fixedUniforms=E(l),this.binderUniforms=w?w.getUniforms(l):[],T.includes("TERRAIN")&&(this.terrainUniforms=(oe=>({u_dem:new a.a7(oe),u_dem_prev:new a.a7(oe),u_dem_tl:new a.a8(oe),u_dem_scale:new a.aa(oe),u_dem_tl_prev:new a.a8(oe),u_dem_scale_prev:new a.aa(oe),u_dem_size:new a.aa(oe),u_dem_lerp:new a.aa(oe),u_exaggeration:new a.aa(oe),u_depth:new a.a7(oe),u_depth_size_inv:new a.a8(oe),u_meter_to_dem:new a.aa(oe),u_label_plane_matrix_inv:new a.a6(oe)}))(l)),T.includes("GLOBE")&&(this.globeUniforms=(oe=>({u_tile_tl_up:new a.aq(oe),u_tile_tr_up:new a.aq(oe),u_tile_br_up:new a.aq(oe),u_tile_bl_up:new a.aq(oe),u_tile_up_scale:new a.aa(oe)}))(l)),T.includes("FOG")&&(this.fogUniforms=(oe=>({u_fog_matrix:new a.a6(oe),u_fog_range:new a.a8(oe),u_fog_color:new a.as(oe),u_fog_horizon_blend:new a.aa(oe),u_fog_vertical_limit:new a.a8(oe),u_fog_temporal_offset:new a.aa(oe),u_frustum_tl:new a.aq(oe),u_frustum_tr:new a.aq(oe),u_frustum_br:new a.aq(oe),u_frustum_bl:new a.aq(oe),u_globe_pos:new a.aq(oe),u_globe_radius:new a.aa(oe),u_globe_transition:new a.aa(oe),u_is_globe:new a.a7(oe),u_viewport:new a.a8(oe)}))(l)),T.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(oe=>({u_cutoff_params:new a.as(oe)}))(l)),T.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(oe=>({u_lighting_ambient_color:new a.aq(oe),u_lighting_directional_dir:new a.aq(oe),u_lighting_directional_color:new a.aq(oe),u_ground_radiance:new a.aq(oe)}))(l)),T.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(oe=>({u_light_matrix_0:new a.a6(oe),u_light_matrix_1:new a.a6(oe),u_fade_range:new a.a8(oe),u_shadow_normal_offset:new a.aq(oe),u_shadow_intensity:new a.aa(oe),u_shadow_texel_size:new a.aa(oe),u_shadow_map_resolution:new a.aa(oe),u_shadow_direction:new a.aq(oe),u_shadow_bias:new a.aq(oe),u_shadowmap_0:new a.a7(oe),u_shadowmap_1:new a.a7(oe)}))(l))}}setTerrainUniformValues(l,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setGlobeUniformValues(l,f){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setFogUniformValues(l,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setCutoffUniformValues(l,f){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setLightsUniformValues(l,f){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setShadowUniformValues(l,f){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;l.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}_drawDebugWireframe(l,f,y,w,E,T,M,L,B,$){const G=l.options.wireframe;if(G.terrain===!1&&G.layers2D===!1&&G.layers3D===!1)return;const Z=l.context;if(!(!(!G.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!G.layers2D||l._terrain&&l._terrain.renderingToTexture||!zm.includes(this.name))||!(!G.layers3D||!hb.includes(this.name))))return;const Q=Z.gl,ne=l.wireframeDebugCache.getLinesFromTrianglesBuffer(l.frameCounter,E,Z);if(!ne)return;const ie=[...this.fixedDefines];ie.push("DEBUG_WIREFRAME");const oe=l.getOrCreateProgram(this.name,{config:this.configuration,defines:ie});Z.program.set(oe.program);const se=(_e,Pe,Te)=>{if(Pe[_e]&&Te[_e])for(const pe in Pe[_e])Te[_e][pe]&&Te[_e][pe].set(Te.program,pe,Pe[_e][pe].current)};B&&B.setUniforms(oe.program,Z,oe.binderUniforms,M,{zoom:L}),se("fixedUniforms",this,oe),se("terrainUniforms",this,oe),se("globeUniforms",this,oe),se("fogUniforms",this,oe),se("lightsUniforms",this,oe),se("shadowUniforms",this,oe),ne.bind(),Z.setColorMode(new a.a([Q.ONE,Q.ONE_MINUS_SRC_ALPHA,Q.ZERO,Q.ONE],a.C.transparent,[!0,!0,!0,!1])),Z.setDepthMode(new a.ae(f.func===Q.LESS?Q.LEQUAL:f.func,a.ae.ReadOnly,f.range)),Z.setStencilMode(a.ag.disabled);const me=3*T.primitiveLength*2,ge=3*T.primitiveOffset*2*2;$&&$>1?Q.drawElementsInstanced(Q.LINES,me,Q.UNSIGNED_SHORT,ge,$):Q.drawElements(Q.LINES,me,Q.UNSIGNED_SHORT,ge),E.bind(),Z.program.set(this.program),Z.setDepthMode(f),Z.setStencilMode(y),Z.setColorMode(w)}draw(l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe){const se=l.context,me=se.gl;if(this.failedToCreate)return;se.program.set(this.program),se.setDepthMode(y),se.setStencilMode(w),se.setColorMode(E),se.setCullFace(T);for(const Pe of Object.keys(this.fixedUniforms))this.fixedUniforms[Pe].set(this.program,Pe,M[Pe]);ne&&ne.setUniforms(this.program,se,this.binderUniforms,Z,{zoom:Q});const ge={[me.POINTS]:1,[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[f],_e=oe&&oe>0?1:void 0;for(const Pe of G.get()){const Te=Pe.vaos||(Pe.vaos={});(Te[L]||(Te[L]=new eI)).bind(se,this,B,ne?ne.getPaintVertexBuffers():[],$,Pe.vertexOffset,ie||[],_e),oe&&oe>1?me.drawElementsInstanced(f,Pe.primitiveLength*ge,me.UNSIGNED_SHORT,Pe.primitiveOffset*ge*2,oe):$?me.drawElements(f,Pe.primitiveLength*ge,me.UNSIGNED_SHORT,Pe.primitiveOffset*ge*2):me.drawArrays(f,Pe.vertexOffset,Pe.vertexLength),f===me.TRIANGLES&&$&&this._drawDebugWireframe(l,y,w,E,$,Pe,Z,Q,ne,oe)}}}function Nm(g,l){const f=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,g.transform.tileZoom)/f,w=y*(l.tileID.canonical.x+l.tileID.wrap*f),E=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture?l.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.bB(l,1,g.transform.tileZoom),u_pixel_coord_upper:[w>>16,E>>16],u_pixel_coord_lower:[65535&w,65535&E]}}const Um=a.ad.create(),Dh=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie)=>{const oe=l.style.light,se=oe.properties.get("position"),me=[se.x,se.y,se.z],ge=a.bC.create();oe.properties.get("anchor")==="viewport"&&(a.bC.fromRotation(ge,-l.transform.angle),a._.transformMat3(me,me,ge));const _e=oe.properties.get("color"),Pe=l.transform,Te={u_matrix:g,u_lightpos:me,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Um,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:E,u_flood_light_color:G,u_vertical_scale:Z,u_flood_light_intensity:Q,u_ground_shadow_factor:ne,u_emissive_strength:ie};return Pe.projection.name==="globe"&&(Te.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],Te.u_zoom_transition=L,Te.u_inv_rot_matrix=$,Te.u_merc_center=B,Te.u_up_dir=Pe.projection.upVector(new a.aO(0,0,0),B[0]*a.a3,B[1]*a.a3),Te.u_height_lift=M),Te},Oh=(g,l,f)=>({u_matrix:g,u_edge_radius:l,u_vertical_scale:f}),uy=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q)=>{const ne=Dh(g,l,f,y,w,E,T,L,B,$,G,Z,Q,1,[0,0,0],0),ie={u_height_factor:-Math.pow(2,T.overscaledZ)/M.tileSize/8};return a.W(ne,Nm(l,M),ie)},hy=(g,l)=>({u_matrix:g,u_emissive_strength:l}),dy=(g,l,f,y)=>a.W(hy(g,l),Nm(f,y)),db=(g,l,f)=>({u_matrix:g,u_world:f,u_emissive_strength:l}),$m=(g,l,f,y,w)=>a.W(dy(g,l,f,y),{u_world:w}),fy=(g,l,f,y)=>{const w=a.a3/f.tileSize;return{u_matrix:g,u_camera_to_center_distance:l.getCameraToCenterDistance(y),u_extrude_scale:[l.pixelsToGLUnits[0]/w,l.pixelsToGLUnits[1]/w]}},jm=(g,l,f=1)=>({u_matrix:g,u_color:l.toRenderColor(null),u_overlay:0,u_overlay_scale:f}),Pf=a.ad.create(),Su=(g,l,f,y,w,E,T)=>{const M=g.transform,L=M.projection.name==="globe",B=L?a.bD(M.zoom,l.canonical)*M._pixelsPerMercatorPixel:a.bB(f,1,E),$={u_matrix:l.projMatrix,u_extrude_scale:B,u_intensity:T,u_inv_rot_matrix:Pf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){$.u_inv_rot_matrix=y,$.u_merc_center=w,$.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],$.u_zoom_transition=a.a1(M.zoom);const G=w[0]*a.a3,Z=w[1]*a.a3;$.u_up_dir=M.projection.upVector(new a.aO(0,0,0),G,Z)}return $};function fb(g,[l,f,y,w],[E,T]){if(E===T)return[0,0,0,0];const M=255*(g-1)/(g*(T-E));return[l*M,f*M,y*M,w*M]}function py(g,l,[f,y]){return f===y?0:.5/g+(l-f)*(g-1)/(g*(y-f))}const Rf=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se,me,ge,_e)=>({u_matrix:g,u_normalize_matrix:l,u_globe_matrix:f,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:B,u_fade_t:$.mix,u_opacity:$.opacity*G.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:G.paint.get("raster-brightness-min"),u_brightness_high:G.paint.get("raster-brightness-max"),u_saturation_factor:a.bE(G.paint.get("raster-saturation")),u_contrast_factor:a.bF(G.paint.get("raster-contrast")),u_spin_weights:kf(G.paint.get("raster-hue-rotate")),u_perspective_transform:Z,u_raster_elevation:Q,u_zoom_transition:T,u_merc_center:M,u_cutoff_params:L,u_colorization_mix:fb(a.bG,ie,se),u_colorization_offset:py(a.bG,oe,se),u_color_ramp:ne,u_texture_offset:[ge/(me+2*ge),me/(me+2*ge)],u_texture_res:[me+2*ge,me+2*ge],u_emissive_strength:_e});function kf(g){g*=Math.PI/180;const l=Math.sin(g),f=Math.cos(g);return[(2*f+1)/3,(-Math.sqrt(3)*l-f+1)/3,(Math.sqrt(3)*l-f+1)/3]}const Mc=.15,my=(g,l,f,y,w,E,T,M,L,B,$,G)=>({u_matrix:g,u_normalize_matrix:l,u_globe_matrix:f,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:B,u_fade_t:$.mix,u_opacity:$.opacity,u_image0:0,u_image1:1,u_raster_elevation:G,u_zoom_transition:T,u_merc_center:M,u_cutoff_params:L}),gy=(g,l,f,y,w,E,T,M,L,B)=>({u_particle_texture:g,u_particle_texture_side_len:l,u_tile_offset:f,u_velocity:y,u_color_ramp:E,u_velocity_res:w,u_max_speed:T,u_uv_offset:M,u_data_scale:L,u_data_offset:B,u_particle_pos_scale:1.3,u_particle_pos_offset:[Mc,Mc]}),iI=(g,l,f,y,w,E,T,M,L,B)=>({u_particle_texture:g,u_particle_texture_side_len:l,u_velocity:f,u_velocity_res:y,u_max_speed:w,u_speed_factor:E,u_reset_rate:T,u_rand_seed:Math.random(),u_uv_offset:M,u_data_scale:L,u_data_offset:B,u_particle_pos_scale:1.3,u_particle_pos_offset:[Mc,Mc]}),Ta=a.ad.create(),Lh=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se)=>{const me=w.transform,ge={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:me.getCameraToCenterDistance(ie),u_rotate_symbol:+f,u_aspect_ratio:me.width/me.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:T,u_coord_matrix:M,u_is_text:+L,u_pitch_with_map:+y,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ta,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ta,u_up_vector:[0,-1,0],u_color_adj_mat:oe,u_icon_transition:se||0};return ie.name==="globe"&&(ge.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],ge.u_zoom_transition=G,ge.u_inv_rot_matrix=Q,ge.u_merc_center=Z,ge.u_camera_forward=me._camera.forward(),ge.u_ecef_origin=a.bH(me.globeMatrix,$.toUnwrapped()),ge.u_tile_matrix=Float32Array.from(me.globeMatrix),ge.u_up_vector=ne),ge},Vm=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe)=>a.W(Lh(g,l,f,y,w,E,T,M,L,B,G,Z,Q,ne,ie,oe),{u_gamma_scale:y?w.transform.getCameraToCenterDistance(oe)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:a.e.devicePixelRatio,u_is_halo:+$,undefined:void 0}),pb=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie)=>a.W(Vm(g,l,f,y,w,E,T,M,!0,L,!0,$,G,Z,Q,ne,ie),{u_texsize_icon:B,u_texture_icon:1}),Df=(g,l,f,y)=>({u_matrix:g,u_emissive_strength:l,u_opacity:f,u_color:y}),mb=(g,l,f,y,w,E,T,M)=>a.W(function(L,B,$,G,Z){const{width:Q,height:ne}=G.imageManager.getPixelSize(B),ie=Math.pow(2,Z.tileID.overscaledZ),oe=Z.tileSize*Math.pow(2,G.transform.tileZoom)/ie,se=oe*(Z.tileID.canonical.x+Z.tileID.wrap*ie),me=oe*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl:$.tl,u_pattern_br:$.br,u_texsize:[Q,ne],u_pattern_size:$.displaySize,u_tile_units_to_pixels:1/a.bB(Z,1,G.transform.tileZoom),u_pixel_coord_upper:[se>>16,me>>16],u_pixel_coord_lower:[65535&se,65535&me]}}(0,E,T,y,M),{u_matrix:g,u_emissive_strength:l,u_opacity:f}),_y=new Float32Array(a.ad.identity([])),Of=(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q=[0,0,0],ne)=>{const ie=w.style.light,oe=ie.properties.get("position"),se=[-oe.x,-oe.y,oe.z],me=a.bC.create();ie.properties.get("anchor")==="viewport"&&(a.bC.fromRotation(me,-w.transform.angle),a._.transformMat3(se,se,me));const ge=$.alphaMode==="MASK",_e=ie.properties.get("color").toRenderColor(null),Pe=Z.paint.get("model-ambient-occlusion-intensity"),Te=Z.paint.get("model-color").constantOr(a.C.white).toRenderColor(null),pe=Z.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:l,u_normal_matrix:f,u_node_matrix:y||_y,u_lightpos:se,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_camera_pos:Q,u_opacity:E,u_baseTextureIsAlpha:0,u_alphaMask:+ge,u_alphaCutoff:$.alphaCutoff,u_baseColorFactor:[T.r,T.g,T.b,T.a],u_emissiveFactor:[M[0],M[1],M[2],1],u_metallicFactor:L,u_roughnessFactor:B,u_baseColorTexture:Xo.BaseColor,u_metallicRoughnessTexture:Xo.MetallicRoughness,u_normalTexture:Xo.Normal,u_occlusionTexture:Xo.Occlusion,u_emissionTexture:Xo.Emission,u_lutTexture:Xo.LUT,u_color_mix:[Te.r,Te.g,Te.b,pe],u_aoIntensity:Pe,u_emissive_strength:G,u_occlusionTextureTransform:ne||[0,0,0,0]}},gb=(g,l=_y,f=_y)=>({u_matrix:g,u_instance:l,u_node_matrix:f}),_b=(g,l,f,y,w)=>({u_matrix:Float32Array.from(g),u_anchorPos:l,u_screenSizePx:f,u_occluderSizePx:y,u_color:w}),oI={fillExtrusion:g=>({u_matrix:new a.a6(g),u_lightpos:new a.aq(g),u_lightintensity:new a.aa(g),u_lightcolor:new a.aq(g),u_vertical_gradient:new a.aa(g),u_opacity:new a.aa(g),u_edge_radius:new a.aa(g),u_ao:new a.a8(g),u_tile_id:new a.aq(g),u_zoom_transition:new a.aa(g),u_inv_rot_matrix:new a.a6(g),u_merc_center:new a.a8(g),u_up_dir:new a.aq(g),u_height_lift:new a.aa(g),u_flood_light_color:new a.aq(g),u_vertical_scale:new a.aa(g),u_flood_light_intensity:new a.aa(g),u_ground_shadow_factor:new a.aq(g),u_emissive_strength:new a.aa(g)}),fillExtrusionDepth:g=>({u_matrix:new a.a6(g),u_edge_radius:new a.aa(g),u_vertical_scale:new a.aa(g)}),fillExtrusionPattern:g=>({u_matrix:new a.a6(g),u_lightpos:new a.aq(g),u_lightintensity:new a.aa(g),u_lightcolor:new a.aq(g),u_vertical_gradient:new a.aa(g),u_height_factor:new a.aa(g),u_edge_radius:new a.aa(g),u_ao:new a.a8(g),u_tile_id:new a.aq(g),u_zoom_transition:new a.aa(g),u_inv_rot_matrix:new a.a6(g),u_merc_center:new a.a8(g),u_up_dir:new a.aq(g),u_height_lift:new a.aa(g),u_image:new a.a7(g),u_texsize:new a.a8(g),u_pixel_coord_upper:new a.a8(g),u_pixel_coord_lower:new a.a8(g),u_tile_units_to_pixels:new a.aa(g),u_opacity:new a.aa(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new a.a6(g),u_opacity:new a.aa(g),u_ao_pass:new a.aa(g),u_meter_to_tile:new a.aa(g),u_ao:new a.a8(g),u_flood_light_intensity:new a.aa(g),u_flood_light_color:new a.aq(g),u_attenuation:new a.aa(g),u_edge_radius:new a.aa(g),u_fb:new a.a7(g),u_fb_size:new a.aa(g)}),fill:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g)}),fillPattern:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g),u_image:new a.a7(g),u_texsize:new a.a8(g),u_pixel_coord_upper:new a.a8(g),u_pixel_coord_lower:new a.a8(g),u_tile_units_to_pixels:new a.aa(g)}),fillOutline:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g),u_world:new a.a8(g)}),fillOutlinePattern:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g),u_world:new a.a8(g),u_image:new a.a7(g),u_texsize:new a.a8(g),u_pixel_coord_upper:new a.a8(g),u_pixel_coord_lower:new a.a8(g),u_tile_units_to_pixels:new a.aa(g)}),circle:a.bI,collisionBox:g=>({u_matrix:new a.a6(g),u_camera_to_center_distance:new a.aa(g),u_extrude_scale:new a.a8(g)}),collisionCircle:g=>({u_matrix:new a.a6(g),u_inv_matrix:new a.a6(g),u_camera_to_center_distance:new a.aa(g),u_viewport_size:new a.a8(g)}),debug:g=>({u_color:new a.a9(g),u_matrix:new a.a6(g),u_overlay:new a.a7(g),u_overlay_scale:new a.aa(g)}),clippingMask:g=>({u_matrix:new a.a6(g)}),heatmap:g=>({u_extrude_scale:new a.aa(g),u_intensity:new a.aa(g),u_matrix:new a.a6(g),u_inv_rot_matrix:new a.a6(g),u_merc_center:new a.a8(g),u_tile_id:new a.aq(g),u_zoom_transition:new a.aa(g),u_up_dir:new a.aq(g)}),heatmapTexture:g=>({u_image:new a.a7(g),u_color_ramp:new a.a7(g),u_opacity:new a.aa(g)}),hillshade:g=>({u_matrix:new a.a6(g),u_image:new a.a7(g),u_latrange:new a.a8(g),u_light:new a.a8(g),u_shadow:new a.a9(g),u_highlight:new a.a9(g),u_emissive_strength:new a.aa(g),u_accent:new a.a9(g)}),hillshadePrepare:g=>({u_matrix:new a.a6(g),u_image:new a.a7(g),u_dimension:new a.a8(g),u_zoom:new a.aa(g)}),line:a.bJ,linePattern:a.bK,raster:g=>({u_matrix:new a.a6(g),u_normalize_matrix:new a.a6(g),u_globe_matrix:new a.a6(g),u_merc_matrix:new a.a6(g),u_grid_matrix:new a.ar(g),u_tl_parent:new a.a8(g),u_scale_parent:new a.aa(g),u_fade_t:new a.aa(g),u_opacity:new a.aa(g),u_image0:new a.a7(g),u_image1:new a.a7(g),u_brightness_low:new a.aa(g),u_brightness_high:new a.aa(g),u_saturation_factor:new a.aa(g),u_contrast_factor:new a.aa(g),u_spin_weights:new a.aq(g),u_perspective_transform:new a.a8(g),u_raster_elevation:new a.aa(g),u_zoom_transition:new a.aa(g),u_merc_center:new a.a8(g),u_cutoff_params:new a.as(g),u_colorization_mix:new a.as(g),u_colorization_offset:new a.aa(g),u_color_ramp:new a.a7(g),u_texture_offset:new a.a8(g),u_texture_res:new a.a8(g),u_emissive_strength:new a.aa(g)}),rasterParticle:g=>({u_matrix:new a.a6(g),u_normalize_matrix:new a.a6(g),u_globe_matrix:new a.a6(g),u_merc_matrix:new a.a6(g),u_grid_matrix:new a.ar(g),u_tl_parent:new a.a8(g),u_scale_parent:new a.aa(g),u_fade_t:new a.aa(g),u_opacity:new a.aa(g),u_image0:new a.a7(g),u_image1:new a.a7(g),u_raster_elevation:new a.aa(g),u_zoom_transition:new a.aa(g),u_merc_center:new a.a8(g),u_cutoff_params:new a.as(g)}),rasterParticleTexture:g=>({u_texture:new a.a7(g),u_opacity:new a.aa(g)}),rasterParticleDraw:g=>({u_particle_texture:new a.a7(g),u_particle_texture_side_len:new a.aa(g),u_tile_offset:new a.a8(g),u_velocity:new a.a7(g),u_color_ramp:new a.a7(g),u_velocity_res:new a.a8(g),u_max_speed:new a.aa(g),u_uv_offset:new a.a8(g),u_data_scale:new a.as(g),u_data_offset:new a.aa(g),u_particle_pos_scale:new a.aa(g),u_particle_pos_offset:new a.a8(g)}),rasterParticleUpdate:g=>({u_particle_texture:new a.a7(g),u_particle_texture_side_len:new a.aa(g),u_velocity:new a.a7(g),u_velocity_res:new a.a8(g),u_max_speed:new a.aa(g),u_speed_factor:new a.aa(g),u_reset_rate:new a.aa(g),u_rand_seed:new a.aa(g),u_uv_offset:new a.a8(g),u_data_scale:new a.as(g),u_data_offset:new a.aa(g),u_particle_pos_scale:new a.aa(g),u_particle_pos_offset:new a.a8(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new a.a7(g),u_is_size_feature_constant:new a.a7(g),u_size_t:new a.aa(g),u_size:new a.aa(g),u_camera_to_center_distance:new a.aa(g),u_rotate_symbol:new a.a7(g),u_aspect_ratio:new a.aa(g),u_fade_change:new a.aa(g),u_matrix:new a.a6(g),u_label_plane_matrix:new a.a6(g),u_coord_matrix:new a.a6(g),u_is_text:new a.a7(g),u_pitch_with_map:new a.a7(g),u_texsize:new a.a8(g),u_tile_id:new a.aq(g),u_zoom_transition:new a.aa(g),u_inv_rot_matrix:new a.a6(g),u_merc_center:new a.a8(g),u_camera_forward:new a.aq(g),u_tile_matrix:new a.a6(g),u_up_vector:new a.aq(g),u_ecef_origin:new a.aq(g),u_texture:new a.a7(g),u_icon_transition:new a.aa(g),u_color_adj_mat:new a.a6(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new a.a7(g),u_is_size_feature_constant:new a.a7(g),u_size_t:new a.aa(g),u_size:new a.aa(g),u_camera_to_center_distance:new a.aa(g),u_rotate_symbol:new a.a7(g),u_aspect_ratio:new a.aa(g),u_fade_change:new a.aa(g),u_matrix:new a.a6(g),u_label_plane_matrix:new a.a6(g),u_coord_matrix:new a.a6(g),u_is_text:new a.a7(g),u_pitch_with_map:new a.a7(g),u_texsize:new a.a8(g),u_texture:new a.a7(g),u_gamma_scale:new a.aa(g),u_device_pixel_ratio:new a.aa(g),u_tile_id:new a.aq(g),u_zoom_transition:new a.aa(g),u_inv_rot_matrix:new a.a6(g),u_merc_center:new a.a8(g),u_camera_forward:new a.aq(g),u_tile_matrix:new a.a6(g),u_up_vector:new a.aq(g),u_ecef_origin:new a.aq(g),u_is_halo:new a.a7(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new a.a7(g),u_is_size_feature_constant:new a.a7(g),u_size_t:new a.aa(g),u_size:new a.aa(g),u_camera_to_center_distance:new a.aa(g),u_rotate_symbol:new a.a7(g),u_aspect_ratio:new a.aa(g),u_fade_change:new a.aa(g),u_matrix:new a.a6(g),u_label_plane_matrix:new a.a6(g),u_coord_matrix:new a.a6(g),u_is_text:new a.a7(g),u_pitch_with_map:new a.a7(g),u_texsize:new a.a8(g),u_texsize_icon:new a.a8(g),u_texture:new a.a7(g),u_texture_icon:new a.a7(g),u_gamma_scale:new a.aa(g),u_device_pixel_ratio:new a.aa(g),u_is_halo:new a.a7(g)}),background:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g),u_opacity:new a.aa(g),u_color:new a.a9(g)}),backgroundPattern:g=>({u_matrix:new a.a6(g),u_emissive_strength:new a.aa(g),u_opacity:new a.aa(g),u_image:new a.a7(g),u_pattern_tl:new a.a8(g),u_pattern_br:new a.a8(g),u_texsize:new a.a8(g),u_pattern_size:new a.a8(g),u_pixel_coord_upper:new a.a8(g),u_pixel_coord_lower:new a.a8(g),u_tile_units_to_pixels:new a.aa(g)}),terrainRaster:xu,terrainDepth:xu,skybox:g=>({u_matrix:new a.a6(g),u_sun_direction:new a.aq(g),u_cubemap:new a.a7(g),u_opacity:new a.aa(g),u_temporal_offset:new a.aa(g)}),skyboxGradient:g=>({u_matrix:new a.a6(g),u_color_ramp:new a.a7(g),u_center_direction:new a.aq(g),u_radius:new a.aa(g),u_opacity:new a.aa(g),u_temporal_offset:new a.aa(g)}),skyboxCapture:g=>({u_matrix_3f:new a.ar(g),u_sun_direction:new a.aq(g),u_sun_intensity:new a.aa(g),u_color_tint_r:new a.as(g),u_color_tint_m:new a.as(g),u_luminance:new a.aa(g)}),globeRaster:g=>({u_proj_matrix:new a.a6(g),u_globe_matrix:new a.a6(g),u_normalize_matrix:new a.a6(g),u_merc_matrix:new a.a6(g),u_zoom_transition:new a.aa(g),u_merc_center:new a.a8(g),u_image0:new a.a7(g),u_grid_matrix:new a.ar(g),u_skirt_height:new a.aa(g),u_far_z_cutoff:new a.aa(g),u_frustum_tl:new a.aq(g),u_frustum_tr:new a.aq(g),u_frustum_br:new a.aq(g),u_frustum_bl:new a.aq(g),u_globe_pos:new a.aq(g),u_globe_radius:new a.aa(g),u_viewport:new a.a8(g)}),globeAtmosphere:g=>({u_frustum_tl:new a.aq(g),u_frustum_tr:new a.aq(g),u_frustum_br:new a.aq(g),u_frustum_bl:new a.aq(g),u_horizon:new a.aa(g),u_transition:new a.aa(g),u_fadeout_range:new a.aa(g),u_color:new a.as(g),u_high_color:new a.as(g),u_space_color:new a.as(g),u_temporal_offset:new a.aa(g),u_horizon_angle:new a.aa(g)}),model:g=>({u_matrix:new a.a6(g),u_lighting_matrix:new a.a6(g),u_normal_matrix:new a.a6(g),u_node_matrix:new a.a6(g),u_lightpos:new a.aq(g),u_lightintensity:new a.aa(g),u_lightcolor:new a.aq(g),u_camera_pos:new a.aq(g),u_opacity:new a.aa(g),u_baseColorFactor:new a.as(g),u_emissiveFactor:new a.as(g),u_metallicFactor:new a.aa(g),u_roughnessFactor:new a.aa(g),u_baseTextureIsAlpha:new a.a7(g),u_alphaMask:new a.a7(g),u_alphaCutoff:new a.aa(g),u_baseColorTexture:new a.a7(g),u_metallicRoughnessTexture:new a.a7(g),u_normalTexture:new a.a7(g),u_occlusionTexture:new a.a7(g),u_emissionTexture:new a.a7(g),u_lutTexture:new a.a7(g),u_color_mix:new a.as(g),u_aoIntensity:new a.aa(g),u_emissive_strength:new a.aa(g),u_occlusionTextureTransform:new a.as(g)}),modelDepth:g=>({u_matrix:new a.a6(g),u_instance:new a.a6(g),u_node_matrix:new a.a6(g)}),groundShadow:g=>({u_matrix:new a.a6(g),u_ground_shadow_factor:new a.aq(g)}),stars:g=>({u_matrix:new a.a6(g),u_up:new a.aq(g),u_right:new a.aq(g),u_intensity_multiplier:new a.aa(g)}),occlusion:g=>({u_matrix:new a.a6(g),u_anchorPos:new a.aq(g),u_screenSizePx:new a.a8(g),u_occluderSizePx:new a.a8(g),u_color:new a.as(g)})};function Hm(g,l,f){const y=l.createTileMatrix(g,g.worldSize,f.toUnwrapped());return a.ad.multiply(new Float32Array(16),g.projMatrix,y)}function sI(g,l,f){if(l.projection.name===f.projection.name)return g.projMatrix;const y=f.clone();return y.setProjection(l.projection),Hm(y,l.getProjection(),g)}function Bh(g,l,f){return l.name===f.projection.name?g.projMatrix:Hm(f,l,g)}let Gm;function Lf(g,l,f,y,w,E,T){const M=g.context,L=M.gl,B=g.transform,$=g.getOrCreateProgram("collisionBox"),G=[];let Z=0,Q=0;for(let _e=0;_e<y.length;_e++){const Pe=y[_e],Te=l.getTile(Pe),pe=Te.getBucket(f);if(!pe)continue;const ye=sI(Pe,pe,B);let ve=ye;w[0]===0&&w[1]===0||(ve=g.translatePosMatrix(ye,Te,w,E));const De=T?pe.textCollisionBox:pe.iconCollisionBox,He=pe.collisionCircleArray;if(He.length>0){const Ee=a.ad.create(),Ge=ve;a.ad.mul(Ee,pe.placementInvProjMatrix,B.glCoordMatrix),a.ad.mul(Ee,Ee,pe.placementViewportMatrix),G.push({circleArray:He,circleOffset:Q,transform:Ge,invTransform:Ee,projection:pe.getProjection()}),Z+=He.length/4,Q=Z}De&&(g.terrain&&g.terrain.setupElevationDraw(Te,$),$.draw(g,L.LINES,a.ae.disabled,a.ag.disabled,g.colorModeForRenderPass(),a.af.disabled,fy(ve,B,Te,pe.getProjection()),f.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,null,B.zoom,null,[De.collisionVertexBuffer,De.collisionVertexBufferExt]))}if(!T||!G.length)return;const ne=g.getOrCreateProgram("collisionCircle"),ie=new a.bL;ie.resize(4*Z),ie._trim();let oe=0;for(const _e of G)for(let Pe=0;Pe<_e.circleArray.length/4;Pe++){const Te=4*Pe,pe=_e.circleArray[Te+0],ye=_e.circleArray[Te+1],ve=_e.circleArray[Te+2],De=_e.circleArray[Te+3];ie.emplace(oe++,pe,ye,ve,De,0),ie.emplace(oe++,pe,ye,ve,De,1),ie.emplace(oe++,pe,ye,ve,De,2),ie.emplace(oe++,pe,ye,ve,De,3)}(!Gm||Gm.length<2*Z)&&(Gm=function(_e){const Pe=2*_e,Te=new a.bu;Te.resize(Pe),Te._trim();for(let pe=0;pe<Pe;pe++){const ye=6*pe;Te.uint16[ye+0]=4*pe+0,Te.uint16[ye+1]=4*pe+1,Te.uint16[ye+2]=4*pe+2,Te.uint16[ye+3]=4*pe+2,Te.uint16[ye+4]=4*pe+3,Te.uint16[ye+5]=4*pe+0}return Te}(Z));const se=M.createIndexBuffer(Gm,!0),me=M.createVertexBuffer(ie,a.bM.members,!0);for(const _e of G){const Pe={u_matrix:_e.transform,u_inv_matrix:_e.invTransform,u_camera_to_center_distance:(ge=B).getCameraToCenterDistance(_e.projection),u_viewport_size:[ge.width,ge.height]};ne.draw(g,L.TRIANGLES,a.ae.disabled,a.ag.disabled,g.colorModeForRenderPass(),a.af.disabled,Pe,f.id,me,se,a.b.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,B.zoom)}var ge;me.destroy(),se.destroy()}const Tu=a.ad.create();function yb(g){const l=g._camera.getWorldToCamera(g.worldSize,1),f=a.ad.multiply([],l,g.globeMatrix);a.ad.invert(f,f);const y=[0,0,0],w=[0,1,0,0];return a.aA.transformMat4(w,w,f),y[0]=w[0],y[1]=w[1],y[2]=w[2],a._.normalize(y,y),y}function aI({width:g,height:l,anchor:f,textOffset:y,textScale:w},E){const{horizontalAlign:T,verticalAlign:M}=a.bQ(f),L=-(T-.5)*g,B=-(M-.5)*l,$=a.bP(f,y);return new a.P((L/w+$[0])*E,(B/w+$[1])*E)}function vb(g,l,f,y,w,E,T,M,L,B,$){const G=g.text.placedSymbolArray,Z=g.text.dynamicLayoutVertexArray,Q=g.icon.dynamicLayoutVertexArray,ne={},ie=g.getProjection(),oe=Bh(M,ie,E),se=E.elevation,me=ie.upVectorScale(M.canonical,E.center.lat,E.worldSize).metersToTile;Z.clear();for(let ge=0;ge<G.length;ge++){const _e=G.get(ge),{tileAnchorX:Pe,tileAnchorY:Te,numGlyphs:pe}=_e,ye=_e.hidden||!_e.crossTileID||g.allowVerticalPlacement&&!_e.placedOrientation?null:y[_e.crossTileID];if(ye){let ve=0,De=0,He=0;if(se){const pt=se?se.getAtTileOffset(M,Pe,Te):0,[Ft,zt,Gt]=ie.upVector(M.canonical,Pe,Te);ve=pt*Ft*me,De=pt*zt*me,He=pt*Gt*me}let[Ee,Ge,Qe,_t]=oa(_e.projectedAnchorX+ve,_e.projectedAnchorY+De,_e.projectedAnchorZ+He,f?oe:T);const xt=jo(E.getCameraToCenterDistance(ie),_t);let gt=w.evaluateSizeForFeature(g.textSizeData,B,_e)*xt/a.bN;f&&(gt*=g.tilePixelRatio/L);const Ue=aI(ye,gt);f?({x:Ee,y:Ge,z:Qe}=ie.projectTilePoint(Pe+Ue.x,Te+Ue.y,M.canonical),[Ee,Ge,Qe]=oa(Ee+ve,Ge+De,Qe+He,T)):(l&&Ue._rotate(-E.angle),Ee+=Ue.x,Ge+=Ue.y,Qe=0);const rt=g.allowVerticalPlacement&&_e.placedOrientation===a.aE.vertical?Math.PI/2:0;for(let pt=0;pt<pe;pt++)a.aH(Z,Ee,Ge,Qe,rt);$&&_e.associatedIconIndex>=0&&(ne[_e.associatedIconIndex]={x:Ee,y:Ge,z:Qe,angle:rt})}else Cu(pe,Z)}if($){Q.clear();const ge=g.icon.placedSymbolArray;for(let _e=0;_e<ge.length;_e++){const Pe=ge.get(_e),{numGlyphs:Te}=Pe,pe=ne[_e];if(Pe.hidden||!pe)Cu(Te,Q);else{const{x:ye,y:ve,z:De,angle:He}=pe;for(let Ee=0;Ee<Te;Ee++)a.aH(Q,ye,ve,De,He)}}g.icon.dynamicLayoutVertexBuffer.updateData(Q)}g.text.dynamicLayoutVertexBuffer.updateData(Z)}function yy(g,l,f,y,w,E,T={}){const M=f.paint.get("icon-translate"),L=f.paint.get("text-translate"),B=f.paint.get("icon-translate-anchor"),$=f.paint.get("text-translate-anchor"),G=f.layout.get("icon-rotation-alignment"),Z=f.layout.get("text-rotation-alignment"),Q=f.layout.get("icon-pitch-alignment"),ne=f.layout.get("text-pitch-alignment"),ie=f.layout.get("icon-keep-upright"),oe=f.layout.get("text-keep-upright"),se=f.paint.get("icon-color-saturation"),me=f.paint.get("icon-color-contrast"),ge=f.paint.get("icon-color-brightness-min"),_e=f.paint.get("icon-color-brightness-max"),Pe=f.paint.get("icon-occlusion-opacity").constantOr(0),Te=f.paint.get("text-occlusion-opacity").constantOr(0),pe=g.context,ye=pe.gl,ve=g.transform,De=G==="map",He=Z==="map",Ee=Q==="map",Ge=ne==="map",Qe=Pe!==1,_t=Te!==1,xt=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let gt=!1;const Ue=g.depthModeForSublayer(0,a.ae.ReadOnly),rt=[a.aj(ve.center.lng),a.ak(ve.center.lat)],pt=f.layout.get("text-variable-anchor"),Ft=ve.projection.name==="globe",zt=[],Gt=[0,-1,0];for(const Nt of y){const St=l.getTile(Nt),ut=St.getBucket(f);if(!ut||ut.projection.name==="mercator"&&Ft||ut.fullyClipped)continue;const tr=ut.projection.name==="globe",$r=tr?a.a1(ve.zoom):0,Rr=Bh(Nt,ut.getProjection(),ve),Zr=ve.calculatePixelsToTileUnitsMatrix(St),ln=pt&&ut.hasTextData(),Pn=ut.hasIconTextFit()&&ln&&ut.hasIconData(),Mr=ut.getProjection().createInversionMatrix(ve,Nt.canonical),En=()=>{const yt=De&&f.layout.get("symbol-placement")!=="point",jt=[];f.hasInitialOcclusionOpacityProperties&&Qe&&g.symbolParams.useOcclusionQueries&&!tr&&!Ft&&jt.push("OCCLUSION_QUERIES"),f.hasInitialOcclusionOpacityProperties||jt.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH");const ui=yt||Pn,Sn=f.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&Ee&&jt.push("PITCH_WITH_MAP_TERRAIN"),tr&&(jt.push("PROJECTION_GLOBE_VIEW"),ui&&jt.push("PROJECTED_POS_ON_VIEWPORT")),Sn>0&&jt.push("ICON_TRANSITION"),ut.icon.zOffsetVertexBuffer&&jt.push("Z_OFFSET"),se===0&&me===0&&ge===0&&_e===1||jt.push("COLOR_ADJUSTMENT");const Ve=ut.icon.programConfigurations.get(f.id),qs=g.getOrCreateProgram(ut.sdfIcons?"symbolSDF":"symbolIcon",{config:Ve,defines:jt});let Po;const Jo=St.imageAtlasTexture?St.imageAtlasTexture.size:[0,0],co=ut.iconSizeData,ys=a.aD(co,ve.zoom),ka=Ee||ve.pitch!==0,Ks=bu(Rr,St.tileID.canonical,Ee,De,ve,ut.getProjection(),Zr),Fc=Mh(Rr,St.tileID.canonical,Ee,De,ve,ut.getProjection(),Zr),zc=g.translatePosMatrix(Fc,St,M,B,!0),ql=g.translatePosMatrix(Rr,St,M,B),hl=ui?Tu:Ks,Kl=De&&!Ee&&!yt;let Yh=Gt;!Ft&&!ve.mercatorFromTransition||De||(Yh=yb(ve));const Zh=tr?Yh:Gt;if(ut.sdfIcons&&!ut.iconsInText)Po=Vm(co.kind,ys,Kl,Ee,g,ql,hl,zc,!1,Jo,!0,Nt,$r,rt,Mr,Zh,ut.getProjection());else{const Qi=f.getColorAdjustmentMatrix(se,me,ge,_e);Po=Lh(co.kind,ys,Kl,Ee,g,ql,hl,zc,!1,Jo,Nt,$r,rt,Mr,Zh,ut.getProjection(),Qi,Sn)}const Fu=St.imageAtlasTexture?St.imageAtlasTexture:null,Xh=f.layout.get("icon-size").constantOr(0)!==1||ut.iconsNeedLinear,d0=ut.sdfIcons||g.options.rotating||g.options.zooming||Xh||ka?ye.LINEAR:ye.NEAREST,f0=ut.sdfIcons&&f.paint.get("icon-halo-width").constantOr(1)!==0,Zy=g.terrain&&Ee&&yt?a.ad.invert(a.ad.create(),Ks):Tu;if(yt&&ut.icon){const Qi=ve.elevation,Xy=Qi?Qi.getAtTileOffsetFunc(Nt,ve.center.lat,ve.worldSize,ut.getProjection()):null,Qh=wu(Rr,St.tileID.canonical,Ee,De,ve,ut.getProjection(),Zr);Pm(ut,Rr,g,!1,Qh,Fc,Ee,ie,Xy,Nt)}return{program:qs,buffers:ut.icon,uniformValues:Po,atlasTexture:Fu,atlasTextureIcon:null,atlasInterpolation:d0,atlasInterpolationIcon:null,isSDF:ut.sdfIcons,hasHalo:f0,tile:St,labelPlaneMatrixInv:Zy}},Un=()=>{const yt=He&&f.layout.get("symbol-placement")!=="point",jt=[],ui=yt||pt||Pn;f.hasInitialOcclusionOpacityProperties&&_t&&g.symbolParams.useOcclusionQueries&&!tr&&!Ft&&jt.push("OCCLUSION_QUERIES"),f.hasInitialOcclusionOpacityProperties||jt.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH"),g.terrainRenderModeElevated()&&Ge&&jt.push("PITCH_WITH_MAP_TERRAIN"),tr&&(jt.push("PROJECTION_GLOBE_VIEW"),ui&&jt.push("PROJECTED_POS_ON_VIEWPORT")),ut.text.zOffsetVertexBuffer&&jt.push("Z_OFFSET");const Sn=ut.text.programConfigurations.get(f.id),Ve=g.getOrCreateProgram(ut.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:Sn,defines:jt});let qs,Po=[0,0],Jo=null;const co=ut.textSizeData;ut.iconsInText&&(Po=St.imageAtlasTexture?St.imageAtlasTexture.size:[0,0],Jo=St.imageAtlasTexture?St.imageAtlasTexture:null,qs=Ge||ve.pitch!==0||g.options.rotating||g.options.zooming||co.kind==="composite"||co.kind==="camera"?ye.LINEAR:ye.NEAREST);const ys=St.glyphAtlasTexture?St.glyphAtlasTexture.size:[0,0],ka=a.aD(co,ve.zoom),Ks=bu(Rr,St.tileID.canonical,Ge,He,ve,ut.getProjection(),Zr),Fc=Mh(Rr,St.tileID.canonical,Ge,He,ve,ut.getProjection(),Zr),zc=g.translatePosMatrix(Fc,St,L,$,!0),ql=g.translatePosMatrix(Rr,St,L,$),hl=ui?Tu:Ks,Kl=He&&!Ge&&!yt;let Yh=Gt;!Ft&&!ve.mercatorFromTransition||He||(Yh=yb(ve));const Zh=tr?Yh:Gt;let Fu;Fu=ut.iconsInText?pb(co.kind,ka,Kl,Ge,g,ql,hl,zc,ys,Po,Nt,$r,rt,Mr,Zh,ut.getProjection()):Vm(co.kind,ka,Kl,Ge,g,ql,hl,zc,!0,ys,!0,Nt,$r,rt,Mr,Zh,ut.getProjection());const Xh=St.glyphAtlasTexture?St.glyphAtlasTexture:null,d0=ye.LINEAR,f0=f.paint.get("text-halo-width").constantOr(1)!==0,Zy=g.terrain&&Ge&&yt?a.ad.invert(a.ad.create(),Ks):Tu;if(yt&&ut.text){const Qi=ve.elevation,Xy=Qi?Qi.getAtTileOffsetFunc(Nt,ve.center.lat,ve.worldSize,ut.getProjection()):null,Qh=wu(Rr,St.tileID.canonical,Ge,He,ve,ut.getProjection(),Zr);Pm(ut,Rr,g,!0,Qh,Fc,Ge,oe,Xy,Nt)}return{program:Ve,buffers:ut.text,uniformValues:Fu,atlasTexture:Xh,atlasTextureIcon:Jo,atlasInterpolation:d0,atlasInterpolationIcon:qs,isSDF:!0,hasHalo:f0,tile:St,labelPlaneMatrixInv:Zy}},In=ut.icon.segments.get().length,en=ut.text.segments.get().length,Br=In&&!T.onlyText?En():null,Xn=en&&!T.onlyIcons?Un():null,Jn=f.paint.get("icon-opacity").constantOr(1),Dn=f.paint.get("text-opacity").constantOr(1);if(xt&&ut.canOverlap){gt=!0;const yt=Jn&&!T.onlyText?ut.icon.segments.get():[],jt=Dn&&!T.onlyIcons?ut.text.segments.get():[];for(const ui of yt)zt.push({segments:new a.b([ui]),sortKey:ui.sortKey,state:Br});for(const ui of jt)zt.push({segments:new a.b([ui]),sortKey:ui.sortKey,state:Xn})}else T.onlyText||zt.push({segments:Jn?ut.icon.segments:new a.b([]),sortKey:0,state:Br}),T.onlyIcons||zt.push({segments:Dn?ut.text.segments:new a.b([]),sortKey:0,state:Xn})}gt&&zt.sort((Nt,St)=>Nt.sortKey-St.sortKey);for(const Nt of zt){const St=Nt.state;if(St)if(g.terrain&&g.terrain.setupElevationDraw(St.tile,St.program,{useDepthForOcclusion:!f.hasInitialOcclusionOpacityProperties&&ve.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:St.labelPlaneMatrixInv}),pe.activeTexture.set(ye.TEXTURE0),St.atlasTexture&&St.atlasTexture.bind(St.atlasInterpolation,ye.CLAMP_TO_EDGE,!0),St.atlasTextureIcon&&(pe.activeTexture.set(ye.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,ye.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,St.program),St.hasHalo){const ut=St.uniformValues;ut.u_is_halo=1,Fh(St.buffers,Nt.segments,f,g,St.program,Ue,w,E,ut,2),ut.u_is_halo=0}else{if(St.isSDF){const ut=St.uniformValues;St.hasHalo&&(ut.u_is_halo=1,Fh(St.buffers,Nt.segments,f,g,St.program,Ue,w,E,ut,1)),ut.u_is_halo=0}Fh(St.buffers,Nt.segments,f,g,St.program,Ue,w,E,St.uniformValues,1)}}}function Fh(g,l,f,y,w,E,T,M,L,B){const $=y.context.gl,G=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];g.occlusionQueryOpacityVertexBuffer.length>0&&G.push(g.occlusionQueryOpacityVertexBuffer),w.draw(y,$.TRIANGLES,E,T,M,a.af.disabled,L,f.id,g.layoutVertexBuffer,g.indexBuffer,l,f.paint,y.transform.zoom,g.programConfigurations.get(f.id),G,B)}function vy(g,l,f,y,w,E,T){const M=g.context.gl,L=f.paint.get("fill-pattern"),B=L&&L.constantOr(1);let $,G,Z,Q,ne;T?(G=B&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=M.LINES):(G=B?"fillPattern":"fill",$=M.TRIANGLES);for(const ie of y){const oe=l.getTile(ie);if(B&&!oe.patternsLoaded())continue;const se=oe.getBucket(f);if(!se)continue;g.prepareDrawTile();const me=se.programConfigurations.get(f.id),ge=g.isTileAffectedByFog(ie),_e=g.getOrCreateProgram(G,{config:me,overrideFog:ge});B&&(g.context.activeTexture.set(M.TEXTURE0),oe.imageAtlasTexture&&oe.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),me.updatePaintBuffers());const Pe=L.constantOr(null);if(Pe&&oe.imageAtlas){const ye=oe.imageAtlas.patternPositions[Pe.toString()];ye&&me.setConstantPatternPositions(ye)}const Te=g.translatePosMatrix(ie.projMatrix,oe,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor")),pe=f.paint.get("fill-emissive-strength");if(T){Q=se.indexBuffer2,ne=se.segments2;const ye=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[M.drawingBufferWidth,M.drawingBufferHeight];Z=G==="fillOutlinePattern"&&B?$m(Te,pe,g,oe,ye):db(Te,pe,ye)}else Q=se.indexBuffer,ne=se.segments,Z=B?dy(Te,pe,g,oe):hy(Te,pe);g.uploadCommonUniforms(g.context,_e,ie.toUnwrapped()),_e.draw(g,$,w,g.stencilModeForClipping(ie),E,a.af.disabled,Z,f.id,se.layoutVertexBuffer,Q,ne,f.paint,g.transform.zoom,me,void 0)}}function zh(g,l,f,y,w,E,T,M){f.resetLayerRenderingStats(g);const L=g.context,B=L.gl,$=g.transform,G=f.paint.get("fill-extrusion-pattern"),Z=G.constantOr(1),Q=f.paint.get("fill-extrusion-opacity"),ne=g.style.enable3dLights(),ie=f.paint.get(ne&&!Z?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),oe=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),ie],se=f.layout.get("fill-extrusion-edge-radius"),me=se>0&&!f.paint.get("fill-extrusion-rounded-roof"),ge=me?0:se,_e=$.projection.name==="globe"?a.bY():0,Pe=$.projection.name==="globe",Te=Pe?a.a1($.zoom):0,pe=[a.aj($.center.lng),a.ak($.center.lat)],ye=f.paint.get("fill-extrusion-flood-light-color").toRenderColor(f.lut).toArray01().slice(0,3),ve=f.paint.get("fill-extrusion-flood-light-intensity"),De=f.paint.get("fill-extrusion-vertical-scale"),He=jl(g,f.paint.get("fill-extrusion-cutoff-fade-range")),Ee=f.paint.get("fill-extrusion-emissive-strength"),Ge=[];let Qe;Pe&&Ge.push("PROJECTION_GLOBE_VIEW"),oe[0]>0&&Ge.push("FAUX_AO"),me&&Ge.push("ZERO_ROOF_RADIUS"),M&&Ge.push("HAS_CENTROID"),ve>0&&Ge.push("FLOOD_LIGHT"),He.shouldRenderCutoff&&Ge.push("RENDER_CUTOFF");const _t=g.renderPass==="shadow",xt=g.shadowRenderer,gt=_t&&!!xt;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Ue=[0,0,0];if(xt){const Ft=g.style.directionalLight,zt=g.style.ambientLight;Ft&&zt&&(Ue=Vl(g.style,Ft,zt)),Qe=Ge.concat(["SHADOWS_SINGLE_CASCADE"])}const rt=gt?"fillExtrusionDepth":Z?"fillExtrusionPattern":"fillExtrusion",pt=f.getLayerRenderingStats();for(const Ft of y){const zt=l.getTile(Ft),Gt=zt.getBucket(f);if(!Gt||Gt.projection.name!==$.projection.name)continue;let Nt=!1;xt&&(Nt=xt.getMaxCascadeForTile(Ft.toUnwrapped())===0);const St=g.isTileAffectedByFog(Ft),ut=Gt.programConfigurations.get(f.id),tr=g.getOrCreateProgram(rt,{config:ut,defines:Nt?Qe:Ge,overrideFog:St});if(g.terrain&&g.terrain.setupElevationDraw(zt,tr,{useMeterToDem:!0}),!Gt.centroidVertexBuffer){const Mr=tr.attributes.a_centroid_pos;Mr!==void 0&&B.vertexAttrib2f(Mr,0,0)}!_t&&xt&&xt.setupShadows(zt.tileID.toUnwrapped(),tr,"vector-tile",zt.tileID.overscaledZ),Z&&(g.context.activeTexture.set(B.TEXTURE0),zt.imageAtlasTexture&&zt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),ut.updatePaintBuffers());const $r=G.constantOr(null);if($r&&zt.imageAtlas){const Mr=zt.imageAtlas.patternPositions[$r.toString()];Mr&&ut.setConstantPatternPositions(Mr)}const Rr=f.paint.get("fill-extrusion-vertical-gradient");let Zr;if(_t&&xt){if(xy(zt.tileID,Gt,g))continue;const Mr=xt.calculateShadowPassMatrixFromTile(zt.tileID.toUnwrapped());Zr=Oh(Mr,ge,De)}else{const Mr=g.translatePosMatrix(Ft.expandedProjMatrix,zt,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),En=$.projection.createInversionMatrix($,Ft.canonical);Zr=Z?uy(Mr,g,Rr,Q,oe,ge,Ft,zt,_e,Te,pe,En,ye,De):Dh(Mr,g,Rr,Q,oe,ge,Ft,_e,Te,pe,En,ye,De,ve,Ue,Ee)}g.uploadCommonUniforms(L,tr,Ft.toUnwrapped(),null,He);let ln=Gt.segments;if($.projection.name==="mercator"&&!_t&&(ln=Gt.getVisibleSegments(zt.tileID,g.terrain,g.transform.getFrustum(0)),!ln.get().length))continue;if(pt)if(_t)for(const Mr of ln.get())pt.numRenderedVerticesInShadowPass+=Mr.primitiveLength;else for(const Mr of ln.get())pt.numRenderedVerticesInTransparentPass+=Mr.primitiveLength;const Pn=[];(g.terrain||M)&&Pn.push(Gt.centroidVertexBuffer),Pe&&Pn.push(Gt.layoutVertexExtBuffer),tr.draw(g,L.gl.TRIANGLES,w,E,T,a.af.backCCW,Zr,f.id,Gt.layoutVertexBuffer,Gt.indexBuffer,ln,f.paint,g.transform.zoom,ut,Pn)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function ps(g,l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se,me){const ge=g.context,_e=ge.gl,Pe=g.transform,Te=g.transform.zoom,pe=[],ye=jl(g,f.paint.get("fill-extrusion-cutoff-fade-range"));B==="clear"?(pe.push("CLEAR_SUBPASS"),me&&(pe.push("CLEAR_FROM_TEXTURE"),ge.activeTexture.set(_e.TEXTURE0),me.bind(_e.LINEAR,_e.CLAMP_TO_EDGE))):B==="sdf"&&pe.push("SDF_SUBPASS"),oe&&pe.push("HAS_CENTROID"),ye.shouldRenderCutoff&&pe.push("RENDER_CUTOFF");const ve=f.layout.get("fill-extrusion-edge-radius"),De=(He,Ee,Ge,Qe,_t)=>{const xt=Ee.programConfigurations.get(f.id),gt=g.isTileAffectedByFog(He),Ue=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:xt,defines:pe,overrideFog:gt}),rt=((Ft,zt,Gt,Nt,St,ut,tr,$r,Rr,Zr,ln)=>({u_matrix:zt,u_opacity:Gt,u_ao_pass:Nt?1:0,u_meter_to_tile:St,u_ao:ut,u_flood_light_intensity:tr,u_flood_light_color:$r,u_attenuation:Rr,u_edge_radius:Zr,u_fb:0,u_fb_size:ln}))(0,Qe,$,L,_t,[G,Z*_t],Q,ne,ie,Te>=17?0:ve*_t,me?me.size[0]:0),pt=[];oe&&pt.push(Ee.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms(ge,Ue,He.toUnwrapped(),null,ye),Ue.draw(g,ge.gl.TRIANGLES,w,E,T,M,rt,f.id,Ee.vertexBuffer,Ee.indexBuffer,Ge,f.paint,Te,xt,pt)};for(const He of y){const Ee=l.getTile(He),Ge=Ee.getBucket(f);if(!Ge||Ge.projection.name!==Pe.projection.name||!Ge.groundEffect||Ge.groundEffect&&!Ge.groundEffect.hasData())continue;const Qe=Ge.groundEffect,_t=1/Ge.tileToMeter;{const xt=g.translatePosMatrix(He.projMatrix,Ee,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),gt=Qe.getDefaultSegment();De(He,Qe,gt,xt,_t)}if(se)for(let xt=0;xt<4;xt++){const gt=a.bZ[xt](He),Ue=l.getTile(gt);if(!Ue)continue;const rt=Ue.getBucket(f);if(!rt||rt.projection.name!==Pe.projection.name||!rt.groundEffect||rt.groundEffect&&!rt.groundEffect.hasData())continue;const pt=rt.groundEffect;let Ft,zt;xt===0?(Ft=[-a.a3,0,0],zt=1):xt===1?(Ft=[a.a3,0,0],zt=0):xt===2?(Ft=[0,-a.a3,0],zt=3):(Ft=[0,a.a3,0],zt=2);const Gt=pt.regionSegments[zt];if(!Gt)continue;const Nt=new Float32Array(16);a.ad.translate(Nt,He.projMatrix,Ft),De(He,pt,Gt,g.translatePosMatrix(Nt,Ee,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),_t)}}}function Wm(g,l,f,y,w,E,T){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const M=E?E.findDEMTileFor(f):null;if(!(M&&M.dem||T))return;const L=se=>new a.P(Math.ceil((se+a.c0)*a.c1),0),B=se=>{const me=l.getSource().minzoom,ge=Pe=>{const Te=l.getTileByID(Pe);if(Te&&Te.hasData())return Te.getBucket(w)},_e=[0,-1,1];for(const Pe of _e){if(se.overscaledZ+Pe<me)continue;const Te=ge(se.calculateScaledKey(se.overscaledZ+Pe));if(Te)return Te}},$=[0,0,0],G=(se,me)=>($[0]=Math.min(se.min.y,me.min.y),$[1]=Math.max(se.max.y,me.max.y),$[2]=a.a3-me.min.x>se.max.x?me.min.x-a.a3:se.max.x,$),Z=(se,me)=>($[0]=Math.min(se.min.x,me.min.x),$[1]=Math.max(se.max.x,me.max.x),$[2]=a.a3-me.min.y>se.max.y?me.min.y-a.a3:se.max.y,$),Q=[(se,me)=>G(se,me),(se,me)=>G(me,se),(se,me)=>Z(se,me),(se,me)=>Z(me,se)],ne=(se,me,ge,_e,Pe,Te,pe)=>{if(!E)return 0;const ye=[[Te?ge:se,Te?se:ge,0],[Te?ge:me,Te?me:ge,0]],ve=pe<0?a.a3+pe:pe,De=[Te?ve:(se+me)/2,Te?(se+me)/2:ve,0];return ge===0&&pe<0||ge!==0&&pe>0?E.getForTilePoints(Pe,[De],!0,_e):ye.push(De),E.getForTilePoints(f,ye,!0,M),Math.max(ye[0][2],ye[1][2],De[2])/E.exaggeration()};for(let se=0;se<4;se++){const me=y.borderFeatureIndices[se];if(me.length===0)continue;const ge=a.bZ[se](f),_e=B(ge);if(!(_e&&_e instanceof a.b_)||y.borderDoneWithNeighborZ[se]===_e.canonical.z)continue;_e.centroidVertexArray.length===0&&_e.createCentroidsBuffer();const Pe=E?E.findDEMTileFor(ge):null;if(!(Pe&&Pe.dem||T))continue;const Te=(se<2?1:5)-se,pe=_e.borderDoneWithNeighborZ[Te]!==y.canonical.z,ye=_e.borderFeatureIndices[Te];let ve=0;if(y.canonical.z!==_e.canonical.z){for(const De of me)y.showCentroid(y.featuresOnBorder[De]);if(pe)for(const De of ye)_e.showCentroid(_e.featuresOnBorder[De]);y.borderDoneWithNeighborZ[se]=_e.canonical.z,_e.borderDoneWithNeighborZ[Te]=y.canonical.z}for(const De of me){const He=y.featuresOnBorder[De],Ee=y.centroidData[He.centroidDataIndex],Ge=He.borders[se];let Qe;for(;ve<ye.length;){Qe=_e.featuresOnBorder[ye[ve]];const _t=Qe.borders[Te];if(_t[1]>Ge[0]+3||_t[0]>Ge[0]-3)break;_e.showCentroid(Qe),ve++}if(Qe&&ve<ye.length){const _t=ve;let xt=0;for(;!(Qe.borders[Te][0]>Ge[1]-3)&&(xt++,++ve!==ye.length);)Qe=_e.featuresOnBorder[ye[ve]];if(Qe=_e.featuresOnBorder[ye[_t]],xt>1){const rt=Qe.borders[Te];Math.abs(Ge[0]-rt[0])<3&&Math.abs(Ge[1]-rt[1])<3&&(xt=1,ve=_t+1)}else if(xt===0){y.showCentroid(He);continue}const gt=_e.centroidData[Qe.centroidDataIndex];T&&xt===1&&(((ie=Ee).flags|(oe=gt).flags)&a.b$?(ie.flags|=a.b$,oe.flags|=a.b$):(ie.flags&=~a.b$,oe.flags&=~a.b$));const Ue=He.intersectsCount()>1||Qe.intersectsCount()>1;if(xt>1)ve=_t,Ee.centroidXY=gt.centroidXY=new a.P(0,0);else if(Pe&&Pe.dem&&!Ue){const rt=Q[se](Ee,gt),pt=se%2?a.a3-1:0,Ft=ne(rt[0],Math.min(a.a3-1,rt[1]),pt,Pe,ge,se<2,rt[2]);Ee.centroidXY=gt.centroidXY=L(Ft)}else Ue?Ee.centroidXY=gt.centroidXY=new a.P(0,0):(Ee.centroidXY=y.encodeBorderCentroid(He),gt.centroidXY=_e.encodeBorderCentroid(Qe));y.writeCentroidToBuffer(Ee),_e.writeCentroidToBuffer(gt)}else y.showCentroid(He)}y.borderDoneWithNeighborZ[se]=_e.canonical.z,_e.borderDoneWithNeighborZ[Te]=y.canonical.z}var ie,oe;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const Au=[1,0,0],xb=[0,1,0],qm=[0,0,1];function xy(g,l,f){const y=f.transform,w=f.shadowRenderer;if(!w)return!0;const E=g.toUnwrapped(),T=y.tileSize*w._cascades[f.currentShadowCascade].scale;let M=l.maxHeight;if(y.elevation){const ie=y.elevation.getMinMaxForTile(g);ie&&(M+=ie.max)}const L=[...w.shadowDirection];L[2]=-L[2];const B=w.computeSimplifiedTileShadowVolume(E,M,T,L);if(!B)return!1;const $=[Au,xb,qm,L,[L[0],0,L[2]],[0,L[1],L[2]]],G=y.projection.name==="globe",Z=y.scaleZoom(T),Q=a.aM.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,Z,!G),ne=w.getCurrentCascadeFrustum();return Q.intersectsPrecise(B.vertices,B.planes,$)===0||ne.intersectsPrecise(B.vertices,B.planes,$)===0}function Bf(g){return[g[0]*a.c2,g[1]*a.c2,g[2]*a.c2,0]}function Ff(g,l,f,y,w,E,T,M,L){const B=y.getSource(),$=f.globeSharedBuffers;if(!$)return;let G,Z,Q;if(l&&(G=y.getTile(l)),B instanceof a.bm?(Z=B.texture,Q=a.bh(0,0,f.transform)):G&&l&&(Z=G.texture,Q=a.bh(l.canonical.z,l.canonical.x,f.transform)),!Z||!Q)return;g||(Q=a.ad.scale(a.ad.create(),Q,[1,-1,1]));const ne=f.context,ie=ne.gl,oe=w.paint.get("raster-resampling")==="nearest"?ie.NEAREST:ie.LINEAR,se=f.colorModeForDrapableLayerRenderPass(E),me=T.defines;me.push("GLOBE_POLES");const ge=new a.ae(ie.LEQUAL,a.ae.ReadWrite,f.depthRangeFor3D),_e=Float32Array.from(f.transform.expandedFarZProjMatrix),Pe=Float32Array.from(a.bf(a.bg(new a.aO(0,0,0))));f.terrain&&f.terrain.prepareDrawTile(),ne.activeTexture.set(ie.TEXTURE0),Z.bind(oe,ie.CLAMP_TO_EDGE),ne.activeTexture.set(ie.TEXTURE1),Z.bind(oe,ie.CLAMP_TO_EDGE),Z.useMipmap&&ne.extTextureFilterAnisotropic&&f.transform.pitch>20&&ie.texParameterf(ie.TEXTURE_2D,ne.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ne.extTextureFilterAnisotropicMax);const[Te,pe,ye,ve]=l?$.getPoleBuffers(l.canonical.z,!1):$.getPoleBuffers(0,!0),De=w.paint.get("raster-elevation");let He;g?(He=Te,f.renderDefaultNorthPole=De!==0):(He=pe,f.renderDefaultSouthPole=De!==0);const Ee=Bf(T.mix),Ge=((_t,xt,gt,Ue,rt,pt,Ft,zt,Gt,Nt,St,ut,tr)=>Rf(_t,xt,gt,new Float32Array(16),new Float32Array(9),[0,0],Ue,[0,0],[0,0,0,0],1,{opacity:1,mix:0},pt,[0,0],zt,2,Nt,St,ut,1,0,tr))(_e,Pe,Q,a.a1(f.transform.zoom),0,w,0,De,0,Ee,T.offset,T.range,E),Qe=f.getOrCreateProgram("raster",{defines:me});f.uploadCommonUniforms(ne,Qe,null),Qe.draw(f,ie.TRIANGLES,ge,L,se,M,Ge,w.id,He,ye,ve)}function yn(g){const l=g._nearZ,f=g.projection.farthestPixelDistance(g),y=f-l,w=.2*g.height,E=l+w;return[l,f,(E-w-l)/y,(E-l)/y]}function lI(g,l,f,y){if(g)return l instanceof kh&&g instanceof a.c3?l.getTextureDescriptor(g,f,!0):{texture:g.texture,mix:Bf(y.mix),offset:y.offset,buffer:0,tileSize:1}}function _r(g,l,f){if(!g)return null;const y=l.getTextureDescriptor(g,f,!0);if(!y)return null;let{texture:w,mix:E,offset:T,tileSize:M,buffer:L,format:B}=y;if(!w||!B)return null;let $=!1;return B==="uint32"&&($=!0,E[3]=0,E=fb(a.c4,E,[0,f.paint.get("raster-particle-max-speed")]),T=py(a.c4,T,[0,f.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[L/(M+2*L),M/(M+2*L)],tileSize:M,scalarData:$,scale:E,offset:T,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[B]]}}function bb(g){const l=g._nearZ,f=g.projection.farthestPixelDistance(g),y=f-l,w=.2*g.height,E=l+w;return[l,f,(E-w-l)/y,(E-l)/y]}const Km=new a.C(1,0,0,1),by=new a.C(0,1,0,1),ll=new a.C(0,0,1,1),wy=new a.C(1,0,1,1),Nh=new a.C(0,1,1,1);function Kt(g,l,f,y,w,E,T){const M=g.context,L=g.transform,B=M.gl,$=L.projection.name==="globe",G=$?["PROJECTION_GLOBE_VIEW"]:[];let Z=a.ad.clone(f.projMatrix);if($&&a.a1(L.zoom)>0){const Ee=a.c5(f.canonical,L),Ge=a.c6(Ee);Z=a.ad.multiply(new Float32Array(16),L.globeMatrix,Ge),a.ad.multiply(Z,L.projMatrix,Z)}const Q=a.ad.create();Q[12]+=2*w/(a.e.devicePixelRatio*L.width),Q[13]+=2*E/(a.e.devicePixelRatio*L.height),a.ad.multiply(Z,Q,Z);const ne=g.getOrCreateProgram("debug",{defines:G}),ie=l.getTileByID(f.key);g.terrain&&g.terrain.setupElevationDraw(ie,ne);const oe=a.ae.disabled,se=a.ag.disabled,me=g.colorModeForRenderPass(),ge="$debug";M.activeTexture.set(B.TEXTURE0),g.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),$?ie._makeGlobeTileDebugBuffers(g.context,L):ie._makeDebugTileBoundsBuffers(g.context,L.projection);const _e=ie._tileDebugBuffer||g.debugBuffer,Pe=ie._tileDebugIndexBuffer||g.debugIndexBuffer,Te=ie._tileDebugSegments||g.debugSegments;if(ne.draw(g,B.LINE_STRIP,oe,se,me,a.af.disabled,jm(Z,y),ge,_e,Pe,Te,null,null,null,[ie._globeTileDebugBorderBuffer]),T){const Ee=ie.latestRawTileData,Ge=Math.floor((Ee&&Ee.byteLength||0)/1024);let Qe=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Qe+=` => ${f.overscaledZ}`),Qe+=` ${ie.state}`,Qe+=` ${Ge}kb`,function(_t,xt){_t.initDebugOverlayCanvas();const gt=_t.debugOverlayCanvas,Ue=_t.context.gl,rt=_t.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,gt.width,gt.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(xt,5,5),rt.strokeText(xt,5,5),_t.debugOverlayTexture.update(gt),_t.debugOverlayTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}(g,Qe)}const pe=l.getTile(f).tileSize,ye=512/Math.min(pe,512)*(f.overscaledZ/L.zoom)*.5,ve=ie._tileDebugTextBuffer||g.debugBuffer,De=ie._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,He=ie._tileDebugTextSegments||g.debugSegments;ne.draw(g,B.TRIANGLES,oe,se,a.a.alphaBlended,a.af.disabled,jm(Z,a.C.transparent,ye),ge,ve,De,He,null,null,null,[ie._globeTileDebugTextBuffer])}function vn(g,l,f,y){ms(g,0,l+f/2,g.transform.width,f,y)}function xn(g,l,f,y){ms(g,l-f/2,0,f,g.transform.height,y)}function ms(g,l,f,y,w,E){const T=g.context,M=T.gl;M.enable(M.SCISSOR_TEST),M.scissor(l*a.e.devicePixelRatio,f*a.e.devicePixelRatio,y*a.e.devicePixelRatio,w*a.e.devicePixelRatio),T.clear({color:E}),M.disable(M.SCISSOR_TEST)}const Uh=a.c7([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:mn}=Uh;function Aa(g,l,f,y){g.emplaceBack(l,f,y)}class $h{constructor(l){this.vertexArray=new a.c8,this.indices=new a.bu,Aa(this.vertexArray,-1,-1,1),Aa(this.vertexArray,1,-1,1),Aa(this.vertexArray,-1,1,1),Aa(this.vertexArray,1,1,1),Aa(this.vertexArray,-1,-1,-1),Aa(this.vertexArray,1,-1,-1),Aa(this.vertexArray,-1,1,-1),Aa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,mn),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=a.b.simpleSegment(0,0,36,12)}}function cl(g,l,f,y,w,E){const T=g.context.gl,M=l.paint.get("sky-atmosphere-color"),L=l.paint.get("sky-atmosphere-halo-color"),B=l.paint.get("sky-atmosphere-sun-intensity"),$=((G,Z,Q,ne,ie)=>({u_matrix_3f:G,u_sun_direction:Z,u_sun_intensity:Q,u_color_tint_r:[ne.r,ne.g,ne.b,ne.a],u_color_tint_m:[ie.r,ie.g,ie.b,ie.a],u_luminance:5e-5}))(a.bC.fromMat4(a.bC.create(),y),w,B,M,L);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+E,l.skyboxTexture,0),f.draw(g,T.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.frontCW,$,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Ps=a.c7([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ri{constructor(l){const f=new a.c9;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new a.bu;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(f,Ps.members),this.indexBuffer=l.createIndexBuffer(y),this.segments=a.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const cI=a.c7([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class zf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Cy{constructor(l){this.colorModeAlphaBlendedWriteRGB=new a.a([a.ca,a.cb,a.ca,a.cb],a.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new a.a([a.ca,a.cc,a.ca,a.cc],a.C.transparent,[!1,!1,!1,!0]),this.params=new zf,this.updateNeeded=!0,l.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),l.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(l){const f=l.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Ri(f);const y=this.params.sizeRange,w=this.params.intensityRange,E=function($){const G=a.cf(30),Z=[];for(let Q=0;Q<$;++Q){const ne=2*Math.PI*G(),ie=Math.acos(1-2*G())-.5*Math.PI;Z.push(a._.fromValues(Math.cos(ie)*Math.cos(ne),Math.cos(ie)*Math.sin(ne),Math.sin(ie)))}return Z}(this.params.starsCount),T=a.cf(300),M=new a.cd,L=new a.bu;let B=0;for(let $=0;$<E.length;++$){const G=a._.scale([],E[$],200),Z=Math.max(0,1+.01*y*(1*T()-.5)),Q=Math.max(0,1+.01*w*(1*T()-.5));M.emplaceBack(G[0],G[1],G[2],-1,-1,Z,Q),M.emplaceBack(G[0],G[1],G[2],1,-1,Z,Q),M.emplaceBack(G[0],G[1],G[2],1,1,Z,Q),M.emplaceBack(G[0],G[1],G[2],-1,1,Z,Q),L.emplaceBack(B+0,B+1,B+2),L.emplaceBack(B+0,B+2,B+3),B+=4}this.starsVx=f.createVertexBuffer(M,cI.members),this.starsIdx=f.createIndexBuffer(L),this.starsSegments=a.b.simpleSegment(0,0,M.length,L.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(l,f){const y=l.context,w=y.gl,E=l.transform,T=new a.ae(w.LEQUAL,a.ae.ReadOnly,[0,1]),M=a.a1(E.zoom),L=l.style.getLut(f.scope),B=f.properties.get("color").toRenderColor(L).toArray01(),$=f.properties.get("high-color").toRenderColor(L).toArray01(),G=f.properties.get("space-color").toRenderColor(L).toArray01PremultipliedAlpha(),Z=5e-4,Q=a.ce(f.properties.get("horizon-blend"),0,1,Z,.25),ne=a.ba(l,y,E)&&Q===Z?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,ie=l.frameCounter/1e3%1,oe=a._.length(E.globeCenterInViewSpace),se=Math.sqrt(Math.pow(oe,2)-Math.pow(ne,2)),me=Math.acos(se/oe),ge=_e=>{const Pe=E.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];_e&&Pe.push("ALPHA_PASS");const Te=l.getOrCreateProgram("globeAtmosphere",{defines:Pe}),pe=((ve,De,He,Ee,Ge,Qe,_t,xt,gt,Ue,rt,pt)=>({u_frustum_tl:ve,u_frustum_tr:De,u_frustum_br:He,u_frustum_bl:Ee,u_horizon:Ge,u_transition:Qe,u_fadeout_range:_t,u_color:xt,u_high_color:gt,u_space_color:Ue,u_temporal_offset:rt,u_horizon_angle:pt}))(E.frustumCorners.TL,E.frustumCorners.TR,E.frustumCorners.BR,E.frustumCorners.BL,E.frustumCorners.horizon,M,Q,B,$,G,ie,me);l.uploadCommonUniforms(y,Te);const ye=this.atmosphereBuffer;ye&&Te.draw(l,w.TRIANGLES,T,a.ag.disabled,_e?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,a.af.backCW,pe,_e?"atmosphere_glow_alpha":"atmosphere_glow",ye.vertexBuffer,ye.indexBuffer,ye.segments)};ge(!1),ge(!0)}drawStars(l,f){const y=a.at(f.properties.get("star-intensity"),0,1);if(y===0)return;const w=l.context,E=w.gl,T=l.transform,M=l.getOrCreateProgram("stars"),L=a.av.identity([]);a.av.rotateX(L,L,-T._pitch),a.av.rotateZ(L,L,-T.angle),a.av.rotateX(L,L,a.ab(T._center.lat)),a.av.rotateY(L,L,-a.ab(T._center.lng));const B=a.ad.fromQuat(new Float32Array(16),L),$=a.ad.multiply([],T.starsProjMatrix,B),G=a.bC.fromMat4([],B),Z=a.bC.invert([],G),Q=[0,1,0];a._.transformMat3(Q,Q,Z),a._.scale(Q,Q,this.params.sizeMultiplier);const ne=[1,0,0];a._.transformMat3(ne,ne,Z),a._.scale(ne,ne,this.params.sizeMultiplier);const ie=(oe=Q,se=ne,me=y,{u_matrix:Float32Array.from($),u_up:oe,u_right:se,u_intensity_multiplier:me});var oe,se,me;l.uploadCommonUniforms(w,M),this.starsVx&&this.starsIdx&&M.draw(l,E.TRIANGLES,a.ae.disabled,a.ag.disabled,this.colorModeAlphaBlendedWriteRGB,a.af.disabled,ie,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function jh(g,l){const f=[...g],y=l.cameraWorldSizeForFog/l.worldSize,w=a.ad.identity([]);return a.ad.scale(w,w,[y,y,1]),a.ad.multiply(f,w,f),a.ad.multiply(f,l.worldToFogMatrix,f),f}function Nf(g,l,f,y,w){const E=f.material,T=y.context,{baseColorTexture:M,metallicRoughnessTexture:L}=E.pbrMetallicRoughness,{normalTexture:B,occlusionTexture:$,emissionTexture:G}=E;function Z(Q,ne,ie){if(Q&&(g.push(ne),T.activeTexture.set(T.gl.TEXTURE0+ie),Q.gfxTexture)){const{minFilter:oe,magFilter:se,wrapS:me,wrapT:ge}=Q.sampler;Q.gfxTexture.bindExtraParam(oe,se,me,ge)}}Z(M,"HAS_TEXTURE_u_baseColorTexture",Xo.BaseColor),Z(L,"HAS_TEXTURE_u_metallicRoughnessTexture",Xo.MetallicRoughness),Z(B,"HAS_TEXTURE_u_normalTexture",Xo.Normal),Z($,"HAS_TEXTURE_u_occlusionTexture",Xo.Occlusion),Z(G,"HAS_TEXTURE_u_emissionTexture",Xo.Emission),w&&(w.texture||(w.texture=new a.ch(y.context,w.image,[w.image.height,w.image.height,w.image.height],T.gl.RGBA)),T.activeTexture.set(T.gl.TEXTURE0+Xo.LUT),w.texture&&w.texture.bind(T.gl.LINEAR,T.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),f.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),l.push(f.texcoordBuffer)),f.colorBuffer&&(g.push(f.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),l.push(f.colorBuffer)),f.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),l.push(f.normalBuffer)),f.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),l.push(f.pbrBuffer)),E.alphaMode!=="OPAQUE"&&E.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),E.defined||g.push("DIFFUSE_SHADED"),g.push("USE_STANDARD_DERIVATIVES")}function Iu(g,l,f,y,w,E){const T=f.paint.get("model-opacity"),M=l.context,L=new a.ae(l.context.gl.LEQUAL,a.ae.ReadWrite,l.depthRangeFor3D),B=l.transform,$=g.mesh,G=$.material,Z=G.pbrMetallicRoughness,Q=l.style.fog;let ne;ne=l.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:a.ad.multiply([],y.zScaleMatrix,g.nodeModelMatrix),a.ad.multiply(ne,y.negCameraPosMatrix,ne);const ie=a.ad.invert([],ne);a.ad.transpose(ie,ie);const oe=f.paint.get("model-emissive-strength").constantOr(0),se=Of(new Float32Array(g.worldViewProjection),new Float32Array(ne),new Float32Array(ie),null,l,T,Z.baseColorFactor.toRenderColor(null),G.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,G,oe,f),me={defines:[]},ge=[];Nf(me.defines,ge,$,l,f.lut);const _e=l.shadowRenderer;_e&&(_e.useNormalOffset=!1);let Pe=null;if(Q){const ye=jh(g.nodeModelMatrix,l.transform);if(Pe=new Float32Array(ye),B.projection.name!=="globe"){const ve=$.aabb.min,De=$.aabb.max,[He,Ee]=Q.getOpacityForBounds(ye,ve[0],ve[1],De[0],De[1]);me.overrideFog=He>=An||Ee>=An}}const Te=jl(l,f.paint.get("model-cutoff-fade-range"));Te.shouldRenderCutoff&&me.defines.push("RENDER_CUTOFF");const pe=l.getOrCreateProgram("model",me);l.uploadCommonUniforms(M,pe,null,Pe,Te),l.renderPass!=="shadow"&&_e&&_e.setupShadowsFromMatrix(g.nodeModelMatrix,pe),pe.draw(l,M.gl.TRIANGLES,L,w,E,$.material.doubleSided?a.af.disabled:a.af.backCCW,se,f.id,$.vertexBuffer,$.indexBuffer,$.segments,f.paint,l.transform.zoom,void 0,ge)}function Vo(g,l,f,y,w,E,T){let M;M=g.projection.name==="globe"?a.ci(f,g):[...f],a.ad.multiply(M,M,l.matrix);const L=a.ad.multiply([],y,M);if(l.meshes)for(const B of l.meshes){if(B.material.alphaMode!=="BLEND"){T.push({mesh:B,depth:0,modelIndex:w,worldViewProjection:L,nodeModelMatrix:M});continue}const $=a._.transformMat4([],B.centroid,L);$[2]>0&&E.push({mesh:B,depth:$[2],modelIndex:w,worldViewProjection:L,nodeModelMatrix:M})}if(l.children)for(const B of l.children)Vo(g,B,f,y,w,E,T)}function gs(g,l,f,y){const w=f.shadowRenderer;if(!w)return;const E=w.getShadowPassDepthMode(),T=w.getShadowPassColorMode(),M=w.calculateShadowPassMatrixFromMatrix(l),L=gb(M);f.getOrCreateProgram("modelDepth",{defines:f._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(f,f.context.gl.TRIANGLES,E,a.ag.disabled,T,a.af.backCCW,L,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,f.transform.zoom,void 0,void 0)}function wb(g,l,f){const y=l.updateZoomBasedPaintProperties(),w=function(E,T,M){let L,B,$,G=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&G>0){const Z=E.terrain,Q=Z.findDEMTileFor(M);Q&&Q.dem?L=a.ck.create(Z,M,Q):G=0}if(G===0&&(T.terrainElevationMin=0,T.terrainElevationMax=0),G===T.validForExaggeration&&(G===0||L&&L._demTile&&L._demTile.tileID===T.validForDEMTile.id&&L._dem._timestamp===T.validForDEMTile.timestamp))return!1;for(const Z in T.instancesPerModel){const Q=T.instancesPerModel[Z];for(let ne=0;ne<Q.instancedDataArray.length;++ne){const ie=(L?G*L.getElevationAt(0|Q.instancedDataArray.float32[16*ne],0|Q.instancedDataArray.float32[16*ne+1],!0,!0):0)+Q.instancesEvaluatedElevation[ne];Q.instancedDataArray.float32[16*ne+6]=ie,B=B?Math.min(T.terrainElevationMin,ie):ie,$=$?Math.max(T.terrainElevationMax,ie):ie}}return T.terrainElevationMin=B||0,T.terrainElevationMax=$||0,T.validForExaggeration=G,T.validForDEMTile=L&&L._demTile?{id:L._demTile.tileID,timestamp:L._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,l,f);(y||w)&&(l.uploaded=!1,l.upload(g.context))}const _s={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.b6([0,0,0],[a.a3,a.a3,0])};function ji(g,l){const f=1<<g.canonical.z,y=l.getFreeCameraOptions().position,w=l.elevation,E=g.canonical.x/f,T=(g.canonical.x+1)/f,M=g.canonical.y/f,L=(g.canonical.y+1)/f;let B=l._centerAltitude;if(w){const Q=w.getMinMaxForTile(g);Q&&Q.max>B&&(B=Q.max)}const $=a.at(y.x,E,T)-y.x,G=a.at(y.y,M,L)-y.y,Z=a.ax(B,l.center.lat)-y.z;return l._zoomFromMercatorZ(Math.sqrt($*$+G*G+Z*Z))}function sa(g,l,f,y,w,E,T){const M=g.context,L=g.renderPass==="shadow",B=g.shadowRenderer,$=L&&B?B.getShadowPassDepthMode():new a.ae(M.gl.LEQUAL,a.ae.ReadWrite,g.depthRangeFor3D),G=g.isTileAffectedByFog(E);if(f.meshes)for(const Z of f.meshes){const Q=["MODEL_POSITION_ON_GPU"],ne=[];let ie,oe,se;y.instancedDataArray.length>20&&Q.push("INSTANCED_ARRAYS");const me=jl(g,l.paint.get("model-cutoff-fade-range"));if(me.shouldRenderCutoff&&Q.push("RENDER_CUTOFF"),L&&B)ie=g.getOrCreateProgram("modelDepth",{defines:Q}),oe=gb(T.shadowTileMatrix,T.shadowTileMatrix,Float32Array.from(f.matrix)),se=B.getShadowPassColorMode();else{Nf(Q,ne,Z,g,l.lut),ie=g.getOrCreateProgram("model",{defines:Q,overrideFog:G});const _e=Z.material,Pe=_e.pbrMetallicRoughness,Te=l.paint.get("model-opacity"),pe=l.paint.get("model-emissive-strength").constantOr(0);oe=Of(E.expandedProjMatrix,Float32Array.from(f.matrix),new Float32Array(16),null,g,Te,Pe.baseColorFactor.toRenderColor(null),_e.emissiveFactor,Pe.metallicFactor,Pe.roughnessFactor,_e,pe,l,w),B&&(T.shadowUniformsInitialized?ie.setShadowUniformValues(M,B.getShadowUniformValues()):(B.setupShadows(E.toUnwrapped(),ie,"model-tile",E.overscaledZ),T.shadowUniformsInitialized=!0)),se=me.shouldRenderCutoff||Te<1||_e.alphaMode!=="OPAQUE"?a.a.alphaBlended:a.a.unblended}g.uploadCommonUniforms(M,ie,E.toUnwrapped(),null,me);const ge=Z.material.doubleSided?a.af.disabled:a.af.backCCW;if(y.instancedDataArray.length>20)ne.push(y.instancedDataBuffer),ie.draw(g,M.gl.TRIANGLES,$,a.ag.disabled,se,ge,oe,l.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,l.paint,g.transform.zoom,void 0,ne,y.instancedDataArray.length);else{const _e=L?"u_instance":"u_normal_matrix";for(let Pe=0;Pe<y.instancedDataArray.length;++Pe)oe[_e]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Pe,16),ie.draw(g,M.gl.TRIANGLES,$,a.ag.disabled,se,ge,oe,l.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,l.paint,g.transform.zoom,void 0,ne)}}if(f.children)for(const Z of f.children)sa(g,l,Z,y,w,E,T)}const Gl=[1,-1,1];function lo(g,l,f,y){if(!f.modelManager)return!0;const w=f.modelManager;if(!f.shadowRenderer)return!0;const E=f.shadowRenderer,T=l.aabb;let M=!0,L=g.maxHeight;if(L===0){let $=0;for(const G in g.instancesPerModel){const Z=w.getModel(G,y);Z?$=Math.max($,Math.max(Math.max(Z.aabb.max[0],Z.aabb.max[1]),Z.aabb.max[2])):M=!1}L=g.maxScale*$*1.41+g.maxVerticalOffset,M&&(g.maxHeight=L)}T.max[2]=L,T.min[2]+=g.terrainElevationMin,T.max[2]+=g.terrainElevationMax,a._.transformMat4(T.min,T.min,l.tileMatrix),a._.transformMat4(T.max,T.max,l.tileMatrix);const B=T.intersects(E.getCurrentCascadeFrustum());return f.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=B===2),B===0}function Ey(g,l){const f=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],w=g.uniformValues.u_cutoff_params[2],E=g.uniformValues.u_cutoff_params[3];return y===f||E===w?1:a.at(((l-f)/(y-f)-w)/(E-w),0,1)}function Ia(g,l,f,y){if(l.pitch<20)return 1;const w=l.getWorldToCameraMatrix(),E=a.ad.multiply([],w,g),T=[...f.min,1];let M=a.aA.transformMat4([],T,E),L=M,B=M;T[1]=f.max[1],M=a.aA.transformMat4([],T,E),L=M[1]<L[1]?M:L,B=M[1]>B[1]?M:B,T[0]=f.max[0],M=a.aA.transformMat4([],T,E),L=M[1]<L[1]?M:L,B=M[1]>B[1]?M:B,T[1]=f.min[1],M=a.aA.transformMat4([],T,E),L=M[1]<L[1]?M:L,B=M[1]>B[1]?M:B;const $=a.at(y[0],0,1),G=100*l.pixelsPerMeter*a.at(y[1],0,1),Z=a.at(y[2],0,1),Q=a._.lerp([],L,B,$),ne=Math.tan(.5*l.fovX),ie=-Q[2]*ne;if(G===0)return Q[1]<-Math.abs(ie)?Z:1;const oe=(-Math.abs(ie)-Q[1])/G,se=(ge,_e,Pe)=>(1-Pe)*ge+Pe*_e,me=a.at(se(1,Z,oe),Z,1);return se(1,me,a.at((l.pitch-20)/20,0,1))}class Uf{}class $f{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(l,f,y){{const G=this._storage.get(f.id);if(G)return G.lastUsedFrameIdx=l,G.buf}const w=y.gl,E=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),T=new ArrayBuffer(E),M=new Int16Array(T);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(T));const L=new a.cm;for(let G=0;G<E/2;G+=3){const Z=M[G],Q=M[G+1],ne=M[G+2];L.emplaceBack(Z,Q),L.emplaceBack(Q,ne),L.emplaceBack(ne,Z)}const B=y.bindVertexArrayOES.current,$=new Uf;return $.buf=new a.I(y,L),$.lastUsedFrameIdx=l,this._storage.set(f.id,$),y.bindVertexArrayOES.set(B),$.buf}update(l){for(const[f,y]of this._storage)l-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(f))}destroy(){for(const[l,f]of this._storage)f.buf.destroy(),this._storage.delete(l)}}const Mu=a.c7([{type:"Float32",name:"a_offset_xy",components:2}]);class uI{constructor(l){const f=new a.cn,y=new a.bu;f.emplaceBack(-1,-1),f.emplaceBack(1,-1),f.emplaceBack(1,1),f.emplaceBack(-1,1),y.emplaceBack(0,1,2),y.emplaceBack(0,2,3),this.segments=a.b.simpleSegment(0,0,f.length,y.length),this.vx=l.createVertexBuffer(f,Mu.members),this.idx=l.createIndexBuffer(y)}destroy(){this.vx.destroy(),this.idx.destroy()}}const Ma={symbol:function(g,l,f,y,w){if(g.renderPass!=="translucent")return;const E=a.ag.disabled,T=g.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(B,$,G,Z,Q,ne,ie){const oe=$.transform,se=Q==="map",me=ne==="map";for(const ge of B){const _e=Z.getTile(ge),Pe=_e.getBucket(G);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;const Te=a.aD(Pe.textSizeData,oe.zoom),pe=Bh(ge,Pe.getProjection(),oe),ye=oe.calculatePixelsToTileUnitsMatrix(_e),ve=bu(pe,_e.tileID.canonical,me,se,oe,Pe.getProjection(),ye),De=Pe.hasIconTextFit()&&Pe.hasIconData();if(Te){const He=Math.pow(2,oe.zoom-_e.tileID.overscaledZ);vb(Pe,se,me,ie,a.bO,oe,ve,ge,He,Te,De)}}}(y,g,f,l,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),w);const M=f.paint.get("icon-opacity").constantOr(1)!==0,L=f.paint.get("text-opacity").constantOr(1)!==0;f.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(M||L)?yy(g,l,f,y,E,T):(M&&yy(g,l,f,y,E,T,{onlyIcons:!0}),L&&yy(g,l,f,y,E,T,{onlyText:!0}),function(B,$,G,Z){if(!B.symbolParams.useOcclusionQueries)return;const Q=B.context.gl,ne=B.transform,ie=G.paint,oe=ie.get("icon-occlusion-opacity").constantOr(0),se=ie.get("text-occlusion-opacity").constantOr(0);if(!G.hasInitialOcclusionOpacityProperties||oe===1&&se===1)return;const me=ne.projection.name==="globe";for(const ge of Z){const _e=$.getTile(ge),Pe=_e.getBucket(G);if(!Pe||Pe.projection.name==="mercator"&&me||Pe.fullyClipped)continue;if(Pe.projection.name==="globe"){a.w(`Occlusion not supported for globe mode. Layer: ${G.type}`);continue}const Te=Bh(ge,Pe.getProjection(),ne),pe=a.ad.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,B.symbolParams.depthOffset,1),ye=a.ad.multiply([],pe,Te),ve=B.symbolParams.visualizeOcclusions!=="none"?1:B.symbolParams.occlusionQueryFrameWindow;for(let De=0;De<Pe.symbolInstances.length;De++){const He=Pe.symbolInstances.get(De),Ee=B.style.placement.opacities[He.crossTileID];if(Ee&&Ee.isHidden()||(B.frameCounter+De)%ve!=0)continue;const Ge=He.tileAnchorX,Qe=He.tileAnchorY,_t=He.zOffset;let xt;if(B.symbolParams.visualizeOcclusions==="none"){const Ft=Pe.queries.get(De);if(Ft){if(!Ft.isFree()){if(!Ft.isResultAvailable())continue;const zt=Ft.consumeResult();He.occlusionState=zt===0?0:1;continue}xt=Ft}else xt=new $i(B.context),Pe.queries.set(De,xt)}const gt=B.getOrCreateProgram("occlusion"),Ue=B.symbolParams.occluderSize,rt=_b(ye,[Ge,Qe,_t],[ne.width,ne.height],[Ue,Ue],B.symbolParams.visualizeOcclusions==="zPass"?[1,0,0,.8]:[1,.4,.2,.9]);B.terrain&&B.terrain.setupElevationDraw(_e,gt,{useDepthForOcclusion:!1,labelPlaneMatrixInv:void 0}),B.symbolParams.visualizeOcclusions==="none"&&xt&&xt.begin();const pt=new a.ae(B.symbolParams.visualizeOcclusions==="zPass"?B.context.gl.ALWAYS:B.context.gl.LEQUAL,a.ae.ReadOnly,B.depthRangeFor3D);gt.draw(B,Q.TRIANGLES,pt,a.ag.disabled,B.symbolParams.visualizeOcclusions!=="none"?a.a.alphaBlendedNonPremultiplied:a.a.disabled,a.af.disabled,rt,"occlusion",B.occlusionBuffers.vx,B.occlusionBuffers.idx,B.occlusionBuffers.segments),B.symbolParams.visualizeOcclusions==="none"&&xt&&xt.end()}}}(g,l,f,y)),l.map.showCollisionBoxes&&(Lf(g,l,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Lf(g,l,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(g,l,f,y){if(g.renderPass!=="translucent")return;const w=f.paint.get("circle-opacity"),E=f.paint.get("circle-stroke-width"),T=f.paint.get("circle-stroke-opacity"),M=f.layout.get("circle-sort-key").constantOr(1)!==void 0,L=f.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(E.constantOr(1)===0||T.constantOr(1)===0))return;const B=g.context,$=B.gl,G=g.transform,Z=g.depthModeForSublayer(0,a.ae.ReadOnly),Q=a.ag.disabled,ne=g.colorModeForDrapableLayerRenderPass(L),ie=G.projection.name==="globe",oe=[a.aj(G.center.lng),a.ak(G.center.lat)],se=[];for(let ge=0;ge<y.length;ge++){const _e=y[ge],Pe=l.getTile(_e),Te=Pe.getBucket(f);if(!Te||Te.projection.name!==G.projection.name)continue;const pe=Te.programConfigurations.get(f.id),ye=a.bR(f),ve=g.isTileAffectedByFog(_e);ie&&ye.push("PROJECTION_GLOBE_VIEW");const De=g.getOrCreateProgram("circle",{config:pe,defines:ye,overrideFog:ve}),He=Te.layoutVertexBuffer,Ee=Te.globeExtVertexBuffer,Ge=Te.indexBuffer,Qe=G.projection.createInversionMatrix(G,_e.canonical),_t={programConfiguration:pe,program:De,layoutVertexBuffer:He,globeExtVertexBuffer:Ee,indexBuffer:Ge,uniformValues:a.bS(g,_e,Pe,Qe,oe,f),tile:Pe};if(M){const xt=Te.segments.get();for(const gt of xt)se.push({segments:new a.b([gt]),sortKey:gt.sortKey,state:_t})}else se.push({segments:Te.segments,sortKey:0,state:_t})}M&&se.sort((ge,_e)=>ge.sortKey-_e.sortKey);const me={useDepthForOcclusion:G.depthOcclusionForSymbolsAndCircles};for(const ge of se){const{programConfiguration:_e,program:Pe,layoutVertexBuffer:Te,globeExtVertexBuffer:pe,indexBuffer:ye,uniformValues:ve,tile:De}=ge.state,He=ge.segments;g.terrain&&g.terrain.setupElevationDraw(De,Pe,me),g.uploadCommonUniforms(B,Pe,De.tileID.toUnwrapped()),Pe.draw(g,$.TRIANGLES,Z,Q,ne,a.af.disabled,ve,f.id,Te,ye,He,f.paint,G.zoom,_e,[pe])}},heatmap:function(g,l,f,y){if(f.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const w=g.context,E=w.gl,T=a.ag.disabled,M=new a.a([E.ONE,E.ONE,E.ONE,E.ONE],a.C.transparent,[!0,!0,!0,!0]);(function(Q,ne,ie,oe){const se=Q.gl,me=ne.width*oe,ge=ne.height*oe;Q.activeTexture.set(se.TEXTURE1),Q.viewport.set([0,0,me,ge]);let _e=ie.heatmapFbo;if(!_e||_e&&(_e.width!==me||_e.height!==ge)){_e&&_e.destroy();const Pe=se.createTexture();se.bindTexture(se.TEXTURE_2D,Pe),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),_e=ie.heatmapFbo=Q.createFramebuffer(me,ge,!0,null),function(Te,pe,ye,ve,De,He){const Ee=Te.gl;Ee.texImage2D(Ee.TEXTURE_2D,0,Te.extRenderToTextureHalfFloat?Ee.RGBA16F:Ee.RGBA,De,He,0,Ee.RGBA,Te.extRenderToTextureHalfFloat?Ee.HALF_FLOAT:Ee.UNSIGNED_BYTE,null),ve.colorAttachment.set(ye)}(Q,0,Pe,_e,me,ge)}else se.bindTexture(se.TEXTURE_2D,_e.colorAttachment.get()),Q.bindFramebuffer.set(_e.framebuffer)})(w,g,f,g.transform.projection.name==="globe"?.5:.25),w.clear({color:a.C.transparent});const L=g.transform,B=L.projection.name==="globe",$=B?["PROJECTION_GLOBE_VIEW"]:[],G=B?a.af.frontCCW:a.af.disabled,Z=[a.aj(L.center.lng),a.ak(L.center.lat)];for(let Q=0;Q<y.length;Q++){const ne=y[Q];if(l.hasRenderableParent(ne))continue;const ie=l.getTile(ne),oe=ie.getBucket(f);if(!oe||oe.projection.name!==L.projection.name)continue;const se=g.isTileAffectedByFog(ne),me=oe.programConfigurations.get(f.id),ge=g.getOrCreateProgram("heatmap",{config:me,defines:$,overrideFog:se}),{zoom:_e}=g.transform;g.terrain&&g.terrain.setupElevationDraw(ie,ge),g.uploadCommonUniforms(w,ge,ne.toUnwrapped());const Pe=L.projection.createInversionMatrix(L,ne.canonical);ge.draw(g,E.TRIANGLES,a.ae.disabled,T,M,G,Su(g,ne,ie,Pe,Z,_e,f.paint.get("heatmap-intensity")),f.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,f.paint,g.transform.zoom,me,B?[oe.globeExtVertexBuffer]:null)}w.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(w,E){const T=w.context,M=T.gl,L=E.heatmapFbo;if(!L)return;T.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,L.colorAttachment.get()),T.activeTexture.set(M.TEXTURE1);let B=E.colorRampTexture;B||(B=E.colorRampTexture=new a.T(T,E.colorRamp,M.RGBA)),B.bind(M.LINEAR,M.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,M.TRIANGLES,a.ae.disabled,a.ag.disabled,w.colorModeForRenderPass(),a.af.disabled,(($,G,Z,Q)=>({u_image:0,u_color_ramp:1,u_opacity:G.paint.get("heatmap-opacity")}))(0,E),E.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,E.paint,w.transform.zoom)}(g,f))},line:function(g,l,f,y){if(g.renderPass!=="translucent")return;const w=f.paint.get("line-opacity"),E=f.paint.get("line-width");if(w.constantOr(1)===0||E.constantOr(1)===0)return;const T=f.paint.get("line-emissive-strength"),M=f.paint.get("line-occlusion-opacity"),L=g.context,B=L.gl,$=f.layout.get("line-z-offset"),G=!$.isConstant()||!!$.constantOr(0),Z=G?new a.ae(g.depthOcclusion?B.GREATER:B.LEQUAL,a.ae.ReadOnly,g.depthRangeFor3D):g.depthModeForSublayer(0,a.ae.ReadOnly),Q=g.colorModeForDrapableLayerRenderPass(T),ne=g.terrain&&g.terrain.renderingToTexture,ie=ne?1:a.e.devicePixelRatio,oe=f.paint.get("line-dasharray"),se=oe.constantOr(1),me=f.layout.get("line-cap"),ge=oe.constantOr(null),_e=me.constantOr(null),Pe=f.paint.get("line-pattern"),Te=Pe.constantOr(1),pe=Pe.constantOr(null),ye=f.paint.get("line-opacity").constantOr(1);let ve=!Te&&ye!==1||g.depthOcclusion&&M>0&&M<1;const De=f.paint.get("line-gradient"),He=Te?"linePattern":"line",Ee=a.bT(f);let Ge;if(ne&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(ve=!1),M!==0&&g.depthOcclusion){const _t=f.paint._values["line-opacity"];_t&&_t.value&&_t.value.kind==="constant"?Ge=_t.value:a.w(`Occlusion opacity for layer ${f.id} is supported only when line-opacity isn't data-driven.`)}if(G&&(g.forceTerrainMode=!0),!G&&M!==0&&g.terrain&&!ne)return void a.w(`Occlusion opacity for layer ${f.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Qe=ve&&G?g.stencilModeFor3D():a.ag.disabled;for(const _t of y){const xt=l.getTile(_t);if(Te&&!xt.patternsLoaded())continue;const gt=xt.getBucket(f);if(!gt)continue;g.prepareDrawTile();const Ue=gt.programConfigurations.get(f.id),rt=g.isTileAffectedByFog(_t),pt=g.getOrCreateProgram(He,{config:Ue,defines:G?[...Ee,"ELEVATED"]:Ee,overrideFog:rt});if(pe&&xt.imageAtlas){const ut=xt.imageAtlas.patternPositions[pe.toString()];ut&&Ue.setConstantPatternPositions(ut)}if(!Te&&ge&&_e&&xt.lineAtlas){const ut=xt.lineAtlas.getDash(ge,_e);ut&&Ue.setConstantPatternPositions(ut)}let[Ft,zt]=f.paint.get("line-trim-offset");(_e==="round"||_e==="square")&&Ft!==zt&&(Ft===0&&(Ft-=1),zt===1&&(zt+=1));const Gt=ne?_t.projMatrix:null,Nt=Te?a.bU(g,xt,f,Gt,ie,[Ft,zt]):a.bV(g,xt,f,Gt,gt.lineClipsArray.length,ie,[Ft,zt]);if(De){const ut=gt.gradients[f.id];let tr=ut.texture;if(f.gradientVersion!==ut.version){let $r=256;if(f.stepInterpolant){const Rr=l.getSource().maxzoom,Zr=_t.canonical.z===Rr?Math.ceil(1<<g.transform.maxZoom-_t.canonical.z):1;$r=a.at(a.bW(gt.maxLineLength/a.a3*1024*Zr),256,L.maxTextureSize)}ut.gradient=a.bX({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:$r,image:ut.gradient||void 0,clips:gt.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new a.T(L,ut.gradient,B.RGBA),ut.version=f.gradientVersion,tr=ut.texture}L.activeTexture.set(B.TEXTURE1),tr.bind(f.stepInterpolant?B.NEAREST:B.LINEAR,B.CLAMP_TO_EDGE)}se&&(L.activeTexture.set(B.TEXTURE0),xt.lineAtlasTexture&&xt.lineAtlasTexture.bind(B.LINEAR,B.REPEAT),Ue.updatePaintBuffers()),Te&&(L.activeTexture.set(B.TEXTURE0),xt.imageAtlasTexture&&xt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Ue.updatePaintBuffers()),G&&g.terrain.setupElevationDraw(xt,pt),g.uploadCommonUniforms(L,pt,_t.toUnwrapped());const St=ut=>{Ge!=null&&(Ge.value=ye*M),pt.draw(g,B.TRIANGLES,Z,ut,Q,a.af.disabled,Nt,f.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,f.paint,g.transform.zoom,Ue,[gt.layoutVertexBuffer2,gt.patternVertexBuffer,gt.zOffsetVertexBuffer]),Ge!=null&&(Ge.value=ye)};if(ve&&!G){const ut=g.stencilModeForClipping(_t).ref;ut===0&&ne&&L.clear({stencil:0});const tr={func:B.EQUAL,mask:255};Nt.u_alpha_discard_threshold=.8,St(new a.ag(tr,ut,255,B.KEEP,B.KEEP,B.INVERT)),Nt.u_alpha_discard_threshold=0,St(new a.ag(tr,ut,255,B.KEEP,B.KEEP,B.KEEP))}else ve&&G&&(Nt.u_alpha_discard_threshold=.001),St(G?Qe:g.stencilModeForClipping(_t))}ve&&(g.resetStencilClippingMasks(),ne&&L.clear({stencil:0})),M===0||g.depthOcclusion||ne||g.layersWithOcclusionOpacity.push(g.currentLayer),G&&(g.forceTerrainMode=!1)},fill:function(g,l,f,y){const w=f.paint.get("fill-color"),E=f.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const T=f.paint.get("fill-emissive-strength"),M=g.colorModeForDrapableLayerRenderPass(T),L=f.paint.get("fill-pattern"),B=g.opaquePassEnabledForLayer()&&!L.constantOr(1)&&w.constantOr(a.C.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===B){const $=g.depthModeForSublayer(1,g.renderPass==="opaque"?a.ae.ReadWrite:a.ae.ReadOnly);vy(g,l,f,y,$,M,!1)}if(g.renderPass==="translucent"&&f.paint.get("fill-antialias")){const $=g.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,a.ae.ReadOnly);vy(g,l,f,y,$,M,!0)}},"fill-extrusion":function(g,l,f,y){const w=f.paint.get("fill-extrusion-opacity"),E=g.context,T=E.gl,M=g.terrain,L=M&&M.renderingToTexture;if(w===0)return;const B=g.conflationActive&&g.style.isLayerClipped(f,l.getSource()),$=g.style.order.indexOf(f.fqid);if(B&&function(G,Z,Q,ne,ie){for(const oe of ne){const se=Z.getTile(oe).getBucket(Q);se&&(se.updateReplacement(oe,G.replacementSource,ie),se.uploadCentroid(G.context))}}(g,l,f,y,$),M||B)for(const G of y){const Z=l.getTile(G).getBucket(f);Z&&Wm(g.context,l,G,Z,f,M,B)}if(g.renderPass==="shadow"&&g.shadowRenderer){const G=g.shadowRenderer;if(M&&w<.65&&f._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.Z)return;const Z=G.getShadowPassDepthMode(),Q=G.getShadowPassColorMode();zh(g,l,f,y,Z,a.ag.disabled,Q,B)}else if(g.renderPass==="translucent"){const G=!f.paint.get("fill-extrusion-pattern").constantOr(1),Z=f.paint.get("fill-extrusion-color").constantOr(a.C.white);if(!L&&Z.a!==0){const Q=new a.ae(g.context.gl.LEQUAL,a.ae.ReadWrite,g.depthRangeFor3D);w===1&&G?zh(g,l,f,y,Q,a.ag.disabled,a.a.unblended,B):(zh(g,l,f,y,Q,a.ag.disabled,a.a.disabled,B),zh(g,l,f,y,Q,g.stencilModeFor3D(),g.colorModeForRenderPass(),B),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&G&&(!M&&g.transform.projection.name!=="globe"||L)){const Q=f.paint.get("fill-extrusion-opacity"),ne=f.paint.get("fill-extrusion-ambient-occlusion-intensity"),ie=f.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),oe=f.paint.get("fill-extrusion-flood-light-intensity"),se=f.paint.get("fill-extrusion-flood-light-color").toRenderColor(f.lut).toArray01().slice(0,3),me=ne>0&&ie>0,ge=oe>0,_e=(Te,pe,ye)=>(1-ye)*Te+ye*pe,Pe=Te=>{const pe=g.depthModeForSublayer(1,a.ae.ReadOnly,T.LEQUAL,!0),ye=f.paint.get(Te?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ve=_e(.1,3,ye),De=g._showOverdrawInspector;if(!De){const He=new a.ag({func:T.ALWAYS,mask:255},255,255,T.KEEP,T.KEEP,T.REPLACE),Ee=new a.a([T.ONE,T.ONE,T.ONE,T.ONE],a.C.transparent,[!1,!1,!1,!0],T.MIN);ps(g,l,f,y,pe,He,Ee,a.af.disabled,Te,"sdf",Q,ne,ie,oe,se,ve,B,!1)}{const He=De?a.ag.disabled:new a.ag({func:T.EQUAL,mask:255},255,255,T.KEEP,T.DECR,T.DECR),Ee=De?g.colorModeForRenderPass():new a.a([T.ONE_MINUS_DST_ALPHA,T.DST_ALPHA,T.ONE,T.ONE],a.C.transparent,[!0,!0,!0,!0]);ps(g,l,f,y,pe,He,Ee,a.af.disabled,Te,"color",Q,ne,ie,oe,se,ve,B,!1)}};if(L){const Te=(pe,ye,ve)=>{const De=g.depthModeForSublayer(1,a.ae.ReadOnly,T.LEQUAL,!1),He=f.paint.get(pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ee=_e(.1,3,He);{const Ge=new a.a([T.ONE,T.ONE,T.ONE,T.ONE],a.C.transparent,[!1,!1,!1,!0]);ps(g,l,f,y,De,a.ag.disabled,Ge,a.af.disabled,pe,"clear",Q,ne,ie,oe,se,Ee,B,ye)}{const Ge=new a.ag({func:T.ALWAYS,mask:255},255,255,T.KEEP,T.KEEP,T.REPLACE),Qe=new a.a([T.ONE,T.ONE,T.ONE,T.ONE],a.C.transparent,[!1,!1,!1,!0],T.MIN);ps(g,l,f,y,De,Ge,Qe,a.af.disabled,pe,"sdf",Q,ne,ie,oe,se,Ee,B,ye)}{const Ge=pe?T.ZERO:T.ONE_MINUS_DST_ALPHA,Qe=new a.ag({func:T.EQUAL,mask:255},255,255,T.KEEP,T.DECR,T.DECR),_t=new a.a([Ge,T.DST_ALPHA,T.ONE_MINUS_DST_ALPHA,T.ZERO],a.C.transparent,[!0,!0,!0,!0]);ps(g,l,f,y,De,Qe,_t,a.af.disabled,pe,"color",Q,ne,ie,oe,se,Ee,B,ye)}{const Ge=new a.a([T.ONE,T.ONE,T.ONE,pe?T.ZERO:T.ONE],a.C.transparent,[!1,!1,!1,!0],pe?T.FUNC_ADD:T.MAX);ps(g,l,f,y,De,a.ag.disabled,Ge,a.af.disabled,pe,"clear",Q,ne,ie,oe,se,Ee,B,ye,ve)}};if(me||ge){let pe;if(g.prepareDrawTile(),M){const ye=M.drapeBufferSize[0],ve=M.drapeBufferSize[1];pe=M.framebufferCopyTexture,pe&&(!pe||pe.size[0]===ye&&pe.size[1]===ve)||(pe&&pe.destroy(),pe=M.framebufferCopyTexture=new a.T(E,new a.i({width:ye,height:ve}),T.RGBA)),pe.bind(T.LINEAR,T.CLAMP_TO_EDGE),T.copyTexImage2D(T.TEXTURE_2D,0,T.RGBA,0,0,ye,ve,0)}me&&Te(!0,!1,pe),ge&&Te(!1,!0,pe)}}else me&&Pe(!0),ge&&Pe(!1)}}},hillshade:function(g,l,f,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const w=g.context,E=g.terrain&&g.terrain.renderingToTexture,[T,M]=g.renderPass!=="translucent"||E?[{},y]:g.stencilConfigForOverlap(y);for(const L of M){const B=l.getTile(L);if(B.needsHillshadePrepare&&g.renderPass==="offscreen")ol(g,B,f);else if(g.renderPass==="translucent"){const $=g.depthModeForSublayer(0,a.ae.ReadOnly),G=f.paint.get("hillshade-emissive-strength"),Z=g.colorModeForDrapableLayerRenderPass(G),Q=E&&g.terrain?g.terrain.stencilModeForRTTOverlap(L):T[L.overscaledZ];rI(g,L,B,f,$,Q,Z)}}w.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,l,f,y,w,E){if(g.renderPass!=="translucent"||f.paint.get("raster-opacity")===0)return;const T=g.transform.projection.name==="globe",M=f.paint.get("raster-elevation")!==0,L=M&&T;if(g.renderElevatedRasterBackface&&!L)return;const B=g.context,$=B.gl,G=l.getSource(),Z=function(Te,pe,ye,ve){const De=pe.paint.get("raster-color"),He=Te.type==="raster-array",Ee=[],Ge=pe.paint.get("raster-resampling"),Qe=pe.paint.get("raster-color-mix");let _t=pe.paint.get("raster-color-range");const xt=[Qe[0],Qe[1],Qe[2],0],gt=Qe[3];let Ue=Ge==="nearest"?ve.NEAREST:ve.LINEAR;if(He&&(Ee.push("RASTER_ARRAY"),De||Ee.push("RASTER_COLOR"),Ge==="linear"&&Ee.push("RASTER_ARRAY_LINEAR"),Ue=ve.NEAREST,!_t&&Te.rasterLayers)){const rt=Te.rasterLayers.find(({id:pt})=>pt===pe.sourceLayer);rt&&rt.fields&&rt.fields.range&&(_t=rt.fields.range)}if(_t=_t||[0,1],De){Ee.push("RASTER_COLOR"),ye.activeTexture.set(ve.TEXTURE2),pe.updateColorRamp(_t);let rt=pe.colorRampTexture;rt||(rt=pe.colorRampTexture=new a.T(ye,pe.colorRamp,ve.RGBA)),rt.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}return{mix:xt,range:_t,offset:gt,defines:Ee,resampling:Ue}}(G,f,B,$);if(G instanceof a.bm&&!y.length&&!T)return;const Q=f.paint.get("raster-emissive-strength"),ne=g.colorModeForDrapableLayerRenderPass(Q),ie=g.terrain&&g.terrain.renderingToTexture,oe=!g.options.moving,se=f.paint.get("raster-resampling")==="nearest"?$.NEAREST:$.LINEAR;if(G instanceof a.bm&&!y.length&&(G.onNorthPole||G.onSouthPole)){const Te=M?g.stencilModeFor3D():a.ag.disabled;return void Ff(!!G.onNorthPole,null,g,l,f,Q,Z,a.af.disabled,Te)}if(!y.length)return;const[me,ge]=G instanceof a.bm||ie?[{},y]:g.stencilConfigForOverlap(y),_e=ge[ge.length-1].overscaledZ;L&&Z.defines.push("PROJECTION_GLOBE_VIEW"),M&&Z.defines.push("RENDER_CUTOFF");const Pe=(Te,pe,ye)=>{for(const ve of Te){const De=ve.toUnwrapped(),He=l.getTile(ve);if(ie&&(!He||!He.hasData()))continue;B.activeTexture.set($.TEXTURE0);const Ee=lI(He,G,f,Z);if(!Ee||!Ee.texture)continue;const{texture:Ge,mix:Qe,offset:_t,tileSize:xt,buffer:gt}=Ee;let Ue,rt;ie?(Ue=a.ae.disabled,rt=ve.projMatrix):M?(Ue=new a.ae($.LEQUAL,a.ae.ReadWrite,g.depthRangeFor3D),rt=T?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(De,oe)):(Ue=g.depthModeForSublayer(ve.overscaledZ-_e,f.paint.get("raster-opacity")===1?a.ae.ReadWrite:a.ae.ReadOnly,$.LESS),rt=g.transform.calculateProjMatrix(De,oe));const pt=g.terrain&&ie?g.terrain.stencilModeForRTTOverlap(ve):me[ve.overscaledZ],Ft=E?0:f.paint.get("raster-fade-duration");He.registerFadeDuration(Ft);const zt=l.findLoadedParent(ve,0),Gt=Bm(He,zt,l,g.transform,Ft);let Nt,St;g.terrain&&g.terrain.prepareDrawTile(),B.activeTexture.set($.TEXTURE0),Ge.bind(se,$.CLAMP_TO_EDGE),B.activeTexture.set($.TEXTURE1),zt?(zt.texture&&zt.texture.bind(se,$.CLAMP_TO_EDGE),Nt=Math.pow(2,zt.tileID.overscaledZ-He.tileID.overscaledZ),St=[He.tileID.canonical.x*Nt%1,He.tileID.canonical.y*Nt%1]):Ge.bind(se,$.CLAMP_TO_EDGE),Ge.useMipmap&&B.extTextureFilterAnisotropic&&g.transform.pitch>20&&$.texParameterf($.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const ut=g.transform;let tr;const $r=M?yn(ut):[0,0,0,0];let Rr,Zr,ln,Pn,Mr,En=0;if(L&&G instanceof a.bm&&G.coordinates.length>3)Rr=Float32Array.from(a.bf(a.bg(new a.aO(0,0,0)))),Zr=Float32Array.from(ut.globeMatrix),ln=Float32Array.from(a.bb(ut)),Pn=[a.aj(ut.center.lng),a.ak(ut.center.lat)],tr=G.elevatedGlobePerspectiveTransform,Mr=G.elevatedGlobeGridMatrix||new Float32Array(9);else if(L){const Br=a.bc(ve.canonical);En=a.bd(Br.getCenter().lat),Rr=Float32Array.from(a.bf(a.bg(ve.canonical))),Zr=Float32Array.from(ut.globeMatrix),ln=Float32Array.from(a.bb(ut)),Pn=[a.aj(ut.center.lng),a.ak(ut.center.lat)],tr=[0,0],Mr=Float32Array.from(a.be(ve.canonical,Br,En,ut.worldSize/ut._pixelsPerMercatorPixel))}else tr=G instanceof a.bm?G.perspectiveTransform:[0,0],Rr=new Float32Array(16),Zr=new Float32Array(9),ln=new Float32Array(16),Pn=[0,0],Mr=new Float32Array(9);const Un=Rf(rt,Rr,Zr,ln,Mr,St||[0,0],a.a1(g.transform.zoom),Pn,$r,Nt||1,Gt,f,tr,M?f.paint.get("raster-elevation"):0,2,Qe,_t,Z.range,xt,gt,Q),In=g.isTileAffectedByFog(ve),en=g.getOrCreateProgram("raster",{defines:Z.defines,overrideFog:In});if(g.uploadCommonUniforms(B,en,De),G instanceof a.bm){const Br=G.elevatedGlobeVertexBuffer,Xn=G.elevatedGlobeIndexBuffer;if(ie||!T)G.boundsBuffer&&G.boundsSegments&&en.draw(g,$.TRIANGLES,Ue,a.ag.disabled,ne,a.af.disabled,Un,f.id,G.boundsBuffer,g.quadTriangleIndexBuffer,G.boundsSegments);else if(Br&&Xn){const Jn=ut.zoom<=a.b1?G.elevatedGlobeSegments:G.getSegmentsForLongitude(ut.center.lng);Jn&&en.draw(g,$.TRIANGLES,Ue,a.ag.disabled,ne,pe,Un,f.id,Br,Xn,Jn)}}else if(L){Ue=new a.ae($.LEQUAL,a.ae.ReadOnly,g.depthRangeFor3D);const Br=g.globeSharedBuffers;if(Br){const[Xn,Jn,Dn]=Br.getGridBuffers(En,!1);en.draw(g,$.TRIANGLES,Ue,ye||pt,g.colorModeForRenderPass(),pe,Un,f.id,Xn,Jn,Dn)}}else{const{tileBoundsBuffer:Br,tileBoundsIndexBuffer:Xn,tileBoundsSegments:Jn}=g.getTileBoundsBuffers(He);en.draw(g,$.TRIANGLES,Ue,pt,ne,a.af.disabled,Un,f.id,Br,Xn,Jn)}}if(!(G instanceof a.bm)&&L)for(const ve of Te){const De=ve.canonical.y===(1<<ve.canonical.z)-1;ve.canonical.y===0&&Ff(!0,ve,g,l,f,Q,Z,pe,ye||a.ag.disabled),De&&Ff(!1,ve,g,l,f,Q,Z,pe===a.af.frontCW?a.af.backCW:a.af.frontCW,ye||a.ag.disabled)}};L?Pe(ge,g.renderElevatedRasterBackface?a.af.backCW:a.af.frontCW,g.stencilModeFor3D()):Pe(ge,a.af.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,l,f,y,w,E){g.renderPass==="offscreen"&&function(T,M,L,B){if(!B.length)return;const $=T.context,G=$.gl,Z=M.getSource();if(!(Z instanceof kh))return;const Q=Math.ceil(Math.sqrt(L.paint.get("raster-particle-count")));let ne=L.particlePositionRGBAImage;if(!ne||ne.width!==Q){const ge=function(_e){const Pe=_e*_e,Te=new Uint8Array(4*Pe),pe=function(ve){return ve|=0,ve=Math.imul(2747636419^ve,2654435769),ve=Math.imul(ve^ve>>>16,2654435769),((ve=Math.imul(ve^ve>>>16,2654435769))>>>0)/4294967296},ye=1/1.3;for(let ve=0;ve<Pe;ve++){const De=ye*(pe(2*ve+0)+Mc),He=ye*(pe(2*ve+1)+Mc),Ee=255*De%1,Ge=255*He%1,Qe=Ee,_t=He-Ge/255,xt=Ge;Te[4*ve+0]=255*(De-Ee/255),Te[4*ve+1]=255*Qe,Te[4*ve+2]=255*_t,Te[4*ve+3]=255*xt}return Te}(Q);ne=L.particlePositionRGBAImage=new a.i({width:Q,height:Q},ge)}let ie=L.particleFramebuffer;ie?ie.width!==Q&&(ie.destroy(),ie=L.particleFramebuffer=$.createFramebuffer(Q,Q,!0,null)):ie=L.particleFramebuffer=$.createFramebuffer(Q,Q,!0,null);const oe=[];for(const ge of B){const _e=M.getTile(ge);if(!(_e instanceof a.c3))continue;const Pe=_r(_e,Z,L);if(!Pe)continue;const Te=[_e.tileSize,_e.tileSize];let pe=L.tileFramebuffer;pe||(pe=L.tileFramebuffer=$.createFramebuffer(Te[0],Te[1],!0,null));let ye=_e.rasterParticleState;ye||(ye=_e.rasterParticleState=new nn($,ge,Te,ne));const ve=ye.update(L.lastInvalidatedAt);ye.particleTextureDimension!==Q&&ye.updateParticleTexture(ge,ne);const De=ye.targetColorTexture;ye.targetColorTexture=ye.backgroundColorTexture,ye.backgroundColorTexture=De;const He=ye.particleTexture0;ye.particleTexture0=ye.particleTexture1,ye.particleTexture1=He,oe.push([ge,Pe,ye,ve])}if(oe.length===0)return;const se=a.e.now(),me=L.previousDrawTimestamp?.001*(se-L.previousDrawTimestamp):.0167;if(L.previousDrawTimestamp=se,L.hasColorMap()){$.activeTexture.set(G.TEXTURE0+2);let ge=L.colorRampTexture;ge||(ge=L.colorRampTexture=new a.T($,L.colorRamp,G.RGBA)),ge.bind(G.LINEAR,G.CLAMP_TO_EDGE)}$.bindFramebuffer.set(L.tileFramebuffer.framebuffer),function(ge,_e,Pe){const Te=ge.context,pe=Te.gl,ye=_e.tileFramebuffer;Te.activeTexture.set(pe.TEXTURE0);const ve={u_texture:0,u_opacity:1.05*(He=_e.paint.get("raster-particle-fade-opacity-factor"))/(He+.05)},De=ge.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var He;for(const Ee of Pe){const[,,Ge,Qe]=Ee;ye.colorAttachment.set(Ge.targetColorTexture.texture),Te.viewport.set([0,0,ye.width,ye.height]),Te.clear({color:a.C.transparent}),Qe&&(Ge.backgroundColorTexture.bind(pe.NEAREST,pe.CLAMP_TO_EDGE),De.draw(ge,pe.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.alphaBlended,a.af.disabled,ve,_e.id,ge.viewportBuffer,ge.quadTriangleIndexBuffer,ge.viewportSegments))}}(T,L,oe),function(ge,_e,Pe,Te){const pe=ge.context,ye=pe.gl,ve=Pe.tileFramebuffer,De=ge.transform.projection.name==="globe",He=Pe.paint.get("raster-particle-max-speed");for(const Ee of Te){const[Ge,Qe,_t]=Ee;pe.activeTexture.set(ye.TEXTURE0+0),Qe.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),ve.colorAttachment.set(_t.targetColorTexture.texture);const xt=ge.getOrCreateProgram("rasterParticleDraw",{defines:Qe.defines,overrideFog:!1});pe.activeTexture.set(ye.TEXTURE0+1);const gt=Qe.scalarData?[]:[0,1,2,3].map(pt=>a.bZ[pt](Ge));gt.push(Ge);const Ue=Ge.canonical.x,rt=Ge.canonical.y;for(const pt of gt){const Ft=_e.getTile(De?pt.wrapped():pt);if(!Ft)continue;const zt=Ft.rasterParticleState;if(!zt)continue;const Gt=pt.canonical.x+(1<<pt.canonical.z)*(pt.wrap-Ge.wrap),Nt=pt.canonical.y;zt.particleTexture0.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);const St=gy(1,zt.particleTexture0.size[0],[Gt-Ue,Nt-rt],0,Qe.texture.size,2,He,Qe.textureOffset,Qe.scale,Qe.offset);xt.draw(ge,ye.POINTS,a.ae.disabled,a.ag.disabled,a.a.alphaBlended,a.af.disabled,St,Pe.id,zt.particleIndexBuffer,void 0,zt.particleSegment)}}}(T,M,L,oe),$.bindFramebuffer.set(L.particleFramebuffer.framebuffer),function(ge,_e,Pe,Te){const pe=ge.context,ye=pe.gl,ve=_e.paint.get("raster-particle-max-speed"),De=Te*_e.paint.get("raster-particle-speed-factor")*.15,He=function(Ge){return Math.pow(Ge,6)}(.01+1*_e.paint.get("raster-particle-reset-rate-factor")),Ee=_e.particleFramebuffer;pe.viewport.set([0,0,Ee.width,Ee.height]);for(const Ge of Pe){const[,Qe,_t]=Ge;pe.activeTexture.set(ye.TEXTURE0+0),Qe.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),pe.activeTexture.set(ye.TEXTURE0+1);const xt=_t.particleTexture0;xt.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);const gt=iI(1,xt.size[0],0,Qe.texture.size,ve,De,He,Qe.textureOffset,Qe.scale,Qe.offset);Ee.colorAttachment.set(_t.particleTexture1.texture),pe.clear({color:a.C.transparent}),ge.getOrCreateProgram("rasterParticleUpdate",{defines:Qe.defines}).draw(ge,ye.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.disabled,gt,_e.id,ge.viewportBuffer,ge.quadTriangleIndexBuffer,ge.viewportSegments)}}(T,L,oe,me)}(g,l,f,y),g.renderPass==="translucent"&&(function(T,M,L,B,$){const G=T.context,Z=G.gl,Q=!T.options.moving,ne=T.transform.projection.name==="globe";if(!B.length)return;const[ie,oe]=T.stencilConfigForOverlap(B),se=[];ne&&se.push("PROJECTION_GLOBE_VIEW");const me=T.stencilModeFor3D();for(const ge of oe){const _e=ge.toUnwrapped(),Pe=M.getTile(ge);if(!Pe.rasterParticleState)continue;const Te=Pe.rasterParticleState,pe=100;Pe.registerFadeDuration(pe);const ye=M.findLoadedParent(ge,0),ve=Bm(Pe,ye,M,T.transform,pe);let De,He;T.terrain&&T.terrain.prepareDrawTile(),G.activeTexture.set(Z.TEXTURE0),Te.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),G.activeTexture.set(Z.TEXTURE1),ye&&ye.rasterParticleState?(ye.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),De=Math.pow(2,ye.tileID.overscaledZ-Pe.tileID.overscaledZ),He=[Pe.tileID.canonical.x*De%1,Pe.tileID.canonical.y*De%1]):Te.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const Ee=ne?Float32Array.from(T.transform.expandedFarZProjMatrix):T.transform.calculateProjMatrix(_e,Q),Ge=T.transform,Qe=bb(Ge),_t=a.bc(ge.canonical),xt=a.bd(_t.getCenter().lat);let gt,Ue,rt,pt,Ft;ne?(gt=Float32Array.from(a.bf(a.bg(ge.canonical))),Ue=Float32Array.from(Ge.globeMatrix),rt=Float32Array.from(a.bb(Ge)),pt=[a.aj(Ge.center.lng),a.ak(Ge.center.lat)],Ft=Float32Array.from(a.be(ge.canonical,_t,xt,Ge.worldSize/Ge._pixelsPerMercatorPixel))):(gt=new Float32Array(16),Ue=new Float32Array(9),rt=new Float32Array(16),pt=[0,0],Ft=new Float32Array(9));const zt=my(Ee,gt,Ue,rt,Ft,He||[0,0],a.a1(T.transform.zoom),pt,Qe,De||1,ve,250),Gt=T.isTileAffectedByFog(ge),Nt=T.getOrCreateProgram("rasterParticle",{defines:se,overrideFog:Gt});if(T.uploadCommonUniforms(G,Nt,_e),ne){const St=new a.ae(Z.LEQUAL,a.ae.ReadWrite,T.depthRangeFor3D),ut=0,tr=T.globeSharedBuffers;if(tr){const[$r,Rr,Zr]=tr.getGridBuffers(xt,ut!==0);Nt.draw(T,Z.TRIANGLES,St,me,a.a.alphaBlended,a.af.backCCW,zt,L.id,$r,Rr,Zr)}}else{const St=T.depthModeForSublayer(0,a.ae.ReadOnly),ut=ie[ge.overscaledZ],{tileBoundsBuffer:tr,tileBoundsIndexBuffer:$r,tileBoundsSegments:Rr}=T.getTileBoundsBuffers(Pe);Nt.draw(T,Z.TRIANGLES,St,ut,a.a.alphaBlended,a.af.disabled,zt,L.id,tr,$r,Rr)}}T.resetStencilClippingMasks()}(g,l,f,y),g.style.map.triggerRepaint())},background:function(g,l,f,y){const w=f.paint.get("background-color"),E=f.paint.get("background-opacity"),T=f.paint.get("background-emissive-strength");if(E===0)return;const M=g.context,L=M.gl,B=g.transform,$=B.tileSize,G=f.paint.get("background-pattern");let Z;if(G!==void 0&&(G===null||(Z=g.imageManager.getPattern(G.toString(),f.scope,g.style.getLut(f.scope)),!Z)))return;const Q=!G&&w.a===1&&E===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==Q)return;const ne=a.ag.disabled,ie=g.depthModeForSublayer(0,Q==="opaque"?a.ae.ReadWrite:a.ae.ReadOnly),oe=g.colorModeForDrapableLayerRenderPass(T),se=G?"backgroundPattern":"background";let me,ge=y;ge||(me=g.getBackgroundTiles(),ge=Object.values(me).map(_e=>_e.tileID)),G&&(M.activeTexture.set(L.TEXTURE0),g.imageManager.bind(g.context,f.scope));for(const _e of ge){const Pe=g.isTileAffectedByFog(_e),Te=g.getOrCreateProgram(se,{overrideFog:Pe}),pe=_e.toUnwrapped(),ye=y?_e.projMatrix:g.transform.calculateProjMatrix(pe);g.prepareDrawTile();const ve=l?l.getTile(_e):me?me[_e.key]:new a.by(_e,$,B.zoom,g),De=G?mb(ye,T,E,g,0,f.scope,Z,{tileID:_e,tileSize:$}):Df(ye,T,E,w.toRenderColor(f.lut));g.uploadCommonUniforms(M,Te,pe);const{tileBoundsBuffer:He,tileBoundsIndexBuffer:Ee,tileBoundsSegments:Ge}=g.getTileBoundsBuffers(ve);Te.draw(g,L.TRIANGLES,ie,ne,oe,a.af.disabled,De,f.id,He,Ee,Ge)}},sky:function(g,l,f){const y=g._atmosphere?a.a1(g.transform.zoom):1,w=f.paint.get("sky-opacity")*y;if(w===0)return;const E=g.context,T=f.paint.get("sky-type"),M=new a.ae(E.gl.LEQUAL,a.ae.ReadOnly,[0,1]),L=g.frameCounter/1e3%1;T==="atmosphere"?g.renderPass==="offscreen"?f.needsSkyboxCapture(g)&&(function(B,$,G,Z){const Q=B.context,ne=Q.gl;let ie=$.skyboxFbo;if(!ie){ie=$.skyboxFbo=Q.createFramebuffer(32,32,!0,null),$.skyboxGeometry=new $h(Q),$.skyboxTexture=Q.gl.createTexture(),ne.bindTexture(ne.TEXTURE_CUBE_MAP,$.skyboxTexture),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MAG_FILTER,ne.LINEAR);for(let ge=0;ge<6;++ge)ne.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+ge,0,ne.RGBA,32,32,0,ne.RGBA,ne.UNSIGNED_BYTE,null)}Q.bindFramebuffer.set(ie.framebuffer),Q.viewport.set([0,0,32,32]);const oe=$.getCenter(B,!0),se=B.getOrCreateProgram("skyboxCapture"),me=new Float64Array(16);a.ad.identity(me),a.ad.rotateY(me,me,.5*-Math.PI),cl(B,$,se,me,oe,0),a.ad.identity(me),a.ad.rotateY(me,me,.5*Math.PI),cl(B,$,se,me,oe,1),a.ad.identity(me),a.ad.rotateX(me,me,.5*-Math.PI),cl(B,$,se,me,oe,2),a.ad.identity(me),a.ad.rotateX(me,me,.5*Math.PI),cl(B,$,se,me,oe,3),a.ad.identity(me),cl(B,$,se,me,oe,4),a.ad.identity(me),a.ad.rotateY(me,me,Math.PI),cl(B,$,se,me,oe,5),Q.viewport.set([0,0,B.width,B.height])}(g,f),f.markSkyboxValid(g)):g.renderPass==="sky"&&function(B,$,G,Z,Q){const ne=B.context,ie=ne.gl,oe=B.transform,se=B.getOrCreateProgram("skybox");ne.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_CUBE_MAP,$.skyboxTexture);const me=((ge,_e,Pe,Te,pe)=>({u_matrix:ge,u_sun_direction:_e,u_cubemap:0,u_opacity:Te,u_temporal_offset:pe}))(oe.skyboxMatrix,$.getCenter(B,!1),0,Z,Q);B.uploadCommonUniforms(ne,se),se.draw(B,ie.TRIANGLES,G,a.ag.disabled,B.colorModeForRenderPass(),a.af.backCW,me,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(g,f,M,w,L):T==="gradient"&&g.renderPass==="sky"&&function(B,$,G,Z,Q){const ne=B.context,ie=ne.gl,oe=B.transform,se=B.getOrCreateProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new $h(ne)),ne.activeTexture.set(ie.TEXTURE0);let me=$.colorRampTexture;me||(me=$.colorRampTexture=new a.T(ne,$.colorRamp,ie.RGBA)),me.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const ge=((_e,Pe,Te,pe,ye)=>({u_matrix:_e,u_color_ramp:0,u_center_direction:Pe,u_radius:a.ab(Te),u_opacity:pe,u_temporal_offset:ye}))(oe.skyboxMatrix,$.getCenter(B,!1),$.paint.get("sky-gradient-radius"),Z,Q);B.uploadCommonUniforms(ne,se),se.draw(B,ie.TRIANGLES,G,a.ag.disabled,B.colorModeForRenderPass(),a.af.backCW,ge,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(g,f,M,w,L)},debug:function(g,l,f,y,w,E){for(let T=0;T<f.length;T++)if(w){const B=new a.C(y.r*.8,y.g*.8,y.b*.8,1);Kt(g,l,f[T],y,-1,-1,E),Kt(g,l,f[T],y,-1,1,E),Kt(g,l,f[T],y,1,1,E),Kt(g,l,f[T],y,1,-1,E),Kt(g,l,f[T],B,0,0,E)}else Kt(g,l,f[T],y,0,0,E)},custom:function(g,l,f,y){const w=g.context,E=f.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&f.isDraped(l)){if(g.renderPass==="offscreen"){const T=E.prerender;if(T){if(g.setCustomLayerDefaults(),w.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const M=g.transform.pointMerc;T.call(E,w.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.a1(g.transform.zoom),[M.x,M.y],g.transform.pixelsPerMeterRatio)}else T.call(E,w.gl,g.transform.customLayerMatrix());w.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const M=E.renderToTile;if(M){const L=y[0].canonical,B=new a.Y(L.x+y[0].wrap*(1<<L.z),L.y,L.z);w.setDepthMode(a.ae.disabled),w.setStencilMode(a.ag.disabled),w.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),M.call(E,w.gl,B),w.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),w.setColorMode(g.colorModeForRenderPass()),w.setStencilMode(a.ag.disabled);const T=E.renderingMode==="3d"?new a.ae(g.context.gl.LEQUAL,a.ae.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,a.ae.ReadOnly);if(w.setDepthMode(T),g.transform.projection.name==="globe"){const M=g.transform.pointMerc;E.render(w.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.a1(g.transform.zoom),[M.x,M.y],g.transform.pixelsPerMeterRatio)}else E.render(w.gl,g.transform.customLayerMatrix());w.setDirty(),g.setBaseState(),w.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,l,f,y){if(g.renderPass==="opaque")return;const w=f.paint.get("model-opacity");if(w===0)return;const E=f.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!E||g.terrain&&w<.65&&f._transitionablePaint._values["model-opacity"].value.expression instanceof a.Z))return;const T=g.shadowRenderer,M=f.paint.get("model-receive-shadows");T&&(T.useNormalOffset=!0,M||(T.enabled=!1));const L=()=>{T&&(T.useNormalOffset=!0,M||(T.enabled=!0))},B=l.getSource();if(g.renderPass==="light-beam"&&B.type!=="batched-model")return;if(B.type==="vector"||B.type==="geojson")return function(se,me,ge,_e,Pe){const Te=se.transform;if(Te.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${Te.projection.name} projection is not yet implemented`);const pe=Te.getFreeCameraOptions().position;if(!se.modelManager)return;const ye=se.modelManager;ge.modelManager=ye;const ve=se.shadowRenderer;if(!ge._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const De=ge._unevaluatedLayout._values["model-id"],He={...ge.layout.get("model-id").parameters},Ee=se.style.order.indexOf(ge.fqid);for(const Ge of _e){const Qe=me.getTile(Ge).getBucket(ge);if(!Qe||Qe.projection.name!==Te.projection.name)continue;const _t=Qe.getModelUris();_t&&!Qe.modelsRequested&&(ye.addModelsFromBucket(_t,Pe),Qe.modelsRequested=!0);const xt=ji(Ge,Te);He.zoom=xt;const gt=De.possiblyEvaluate(He);if(wb(se,Qe,Ge),_s.shadowUniformsInitialized=!1,_s.useSingleShadowCascade=!!ve&&ve.getMaxCascadeForTile(Ge.toUnwrapped())===0,se.renderPass==="shadow"&&ve){if(se.currentShadowCascade===1&&Qe.isInsideFirstShadowMapFrustum)continue;const pt=Te.calculatePosMatrix(Ge.toUnwrapped(),Te.worldSize);if(_s.tileMatrix.set(pt),_s.shadowTileMatrix=Float32Array.from(ve.calculateShadowPassMatrixFromMatrix(pt)),_s.aabb.min.fill(0),_s.aabb.max[0]=_s.aabb.max[1]=a.a3,_s.aabb.max[2]=0,lo(Qe,_s,se,ge.scope))continue}const Ue=1<<Ge.canonical.z,rt=[((pe.x-Ge.wrap)*Ue-Ge.canonical.x)*a.a3,(pe.y*Ue-Ge.canonical.y)*a.a3,pe.z*Ue*a.a3];se.conflationActive&&Object.keys(Qe.instancesPerModel).length>0&&se.style.isLayerClipped(ge,me.getSource())&&Qe.updateReplacement(Ge,se.replacementSource,Ee)&&(Qe.uploaded=!1,Qe.upload(se.context));for(let pt in Qe.instancesPerModel){const Ft=Qe.instancesPerModel[pt];Ft.features.length>0&&(pt=gt.evaluate(Ft.features[0].feature,{}));const zt=ye.getModel(pt,Pe);if(zt&&zt.uploaded)for(const Gt of zt.nodes)sa(se,ge,Gt,Ft,rt,Ge,_s)}}}(g,l,f,y,B.type==="vector"?f.scope:""),void L();if(!B.loaded())return;if(B.type==="batched-model")return function(se,me,ge,_e){ge.resetLayerRenderingStats(se);const Pe=se.context,Te=se.transform,pe=se.style.fog,ye=se.shadowRenderer;if(Te.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${Te.projection.name} projection is not yet implemented`);const ve=se.transform.getFreeCameraOptions().position,De=a._.scale([],[ve.x,ve.y,ve.z],se.transform.worldSize);a._.negate(De,De);const He=a.ad.identity([]),Ee=a.cg(Te.center.lat,Te.zoom),Ge=a.ad.fromScaling([],[1,1,1/Ee]);a.ad.translate(He,He,De);const Qe=ge.paint.get("model-opacity"),_t=new a.ae(Pe.gl.LEQUAL,a.ae.ReadWrite,se.depthRangeFor3D),xt=new a.ae(Pe.gl.LEQUAL,a.ae.ReadOnly,se.depthRangeFor3D),gt=new a.b6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ue=se.renderPass==="shadow",rt=Ue&&ye?ye.getCurrentCascadeFrustum():Te.getFrustum(Te.scaleZoom(Te.worldSize)),pt=ge.paint.get("model-front-cutoff"),Ft=pt[2]<1,zt=jl(se,ge.paint.get("model-cutoff-fade-range")),Gt=ge.getLayerRenderingStats();(function(Nt,St,ut,tr){const $r=Nt.terrain?Nt.terrain.exaggeration():0,Rr=Nt.transform.zoom;for(const Zr of tr){const ln=St.getTile(Zr).getBucket(ut);ln&&(Nt.conflationActive&&ln.updateReplacement(Zr,Nt.replacementSource),ln.evaluateScale(Nt,ut),Nt.terrain&&$r>0&&ln.elevationUpdate(Nt.terrain,$r,Zr,ut.source),ln.needsReEvaluation(Nt,Rr,ut)&&ln.evaluate(ut))}})(se,me,ge,_e),function(){let Nt,St,ut;Ft?(Nt=_e.length-1,St=-1,ut=-1):(Nt=0,St=_e.length,ut=1);for(let tr=Nt;tr!==St;tr+=ut){const $r=_e[tr],Rr=me.getTile($r).getBucket(ge);if(!Rr||!Rr.uploaded)continue;let Zr=!1;ye&&(Zr=ye.getMaxCascadeForTile($r.toUnwrapped())===0);const ln=Te.calculatePosMatrix($r.toUnwrapped(),Te.worldSize),Pn=Rr.modelTraits,Mr=[];for(const En of Rr.getNodesInfo()){if(En.hiddenByReplacement||!En.node.meshes)continue;const Un=En.node;let In=0;se.terrain&&Un.elevation&&(In=Un.elevation*se.terrain.exaggeration());const en=En.evaluatedScale;if(en[0]<=1&&en[1]<=1&&en[2]<=1&&(()=>{const Ve=En.aabb;return gt.min=[...Ve.min],gt.max=[...Ve.max],gt.min[2]+=In,gt.max[2]+=In,a._.transformMat4(gt.min,gt.min,ln),a._.transformMat4(gt.max,gt.max,ln),gt})().intersects(rt)===0)continue;const Br=[...ln],Xn=Un.anchor?Un.anchor[0]:0,Jn=Un.anchor?Un.anchor[1]:0;a.ad.translate(Br,Br,[Xn*(en[0]-1),Jn*(en[1]-1),In]),a._.exactEquals(en,a.cj)||a.ad.scale(Br,Br,en);const Dn=a.ad.multiply([],Br,Un.matrix),yt=a.ad.multiply([],Te.expandedFarZProjMatrix,Dn),jt=a.ad.multiply([],Te.expandedFarZProjMatrix,Br),ui=a.aA.transformMat4([],[Xn,Jn,In,1],yt)[2];Un.hidden=!1;let Sn=Qe;Ue||(Ft&&(Sn*=Ia(Br,Te,En.aabb,pt)),Sn*=Ey(zt,ui)),Sn!==0?Mr.push({nodeInfo:En,depth:ui,opacity:Sn,wvpForNode:yt,wvpForTile:jt,nodeModelMatrix:Dn,tileModelMatrix:Br}):Un.hidden=!0}Ue||Mr.sort((En,Un)=>!Ft||En.opacity===1&&Un.opacity===1?En.depth<Un.depth?-1:1:En.opacity===1?-1:Un.opacity===1?1:En.depth>Un.depth?-1:1);for(const En of Mr){const Un=En.nodeInfo,In=Un.node;let en=a.ad.multiply([],Ge,En.tileModelMatrix);a.ad.multiply(en,He,en);const Br=a.ad.invert([],en);a.ad.transpose(Br,Br),a.ad.scale(Br,Br,Gl),en=a.ad.multiply(en,en,In.matrix);const Xn=se.renderPass==="light-beam",Jn=Pn&a.cl.HasMapboxMeshFeatures,Dn=Jn?0:Un.evaluatedRMEA[0][2];for(let yt=0;yt<In.meshes.length;++yt){const jt=In.meshes[yt],ui=yt===In.lightMeshIndex;let Sn=En.wvpForNode;if(ui){if(!Xn&&!se.terrain&&se.shadowRenderer){se.currentLayer<se.firstLightBeamLayer&&(se.firstLightBeamLayer=se.currentLayer);continue}Sn=En.wvpForTile}else if(Xn)continue;const Ve={defines:[]},qs=[];if(Nf(Ve.defines,qs,jt,se,ge.lut),Jn||Ve.defines.push("DIFFUSE_SHADED"),Zr&&Ve.defines.push("SHADOWS_SINGLE_CASCADE"),Gt&&(Ue?Gt.numRenderedVerticesInShadowPass+=jt.vertexArray.length:Gt.numRenderedVerticesInTransparentPass+=jt.vertexArray.length),Ue){gs(jt,En.nodeModelMatrix,se,ge);continue}let Po=null;if(pe){const Fc=jh(En.nodeModelMatrix,se.transform);if(Po=new Float32Array(Fc),Te.projection.name!=="globe"){const zc=jt.aabb.min,ql=jt.aabb.max,[hl,Kl]=pe.getOpacityForBounds(Fc,zc[0],zc[1],ql[0],ql[1]);Ve.overrideFog=hl>=An||Kl>=An}}const Jo=jt.material;let co;Jo.occlusionTexture&&Jo.occlusionTexture.offsetScale&&(co=Jo.occlusionTexture.offsetScale,Ve.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Ue&&ye&&(ye.useNormalOffset=!!jt.normalBuffer);const ys=se.getOrCreateProgram("model",Ve);!Ue&&ye&&ye.setupShadowsFromMatrix(En.tileModelMatrix,ys,ye.useNormalOffset),se.uploadCommonUniforms(Pe,ys,null,Po);const ka=Jo.pbrMetallicRoughness;ka.metallicFactor=.9,ka.roughnessFactor=.5;const Ks=Of(new Float32Array(Sn),new Float32Array(en),new Float32Array(Br),new Float32Array(In.matrix),se,En.opacity,ka.baseColorFactor.toRenderColor(null),Jo.emissiveFactor,ka.metallicFactor,ka.roughnessFactor,Jo,Dn,ge,[0,0,0],co);!ui&&(Un.hasTranslucentParts||En.opacity<1)&&ys.draw(se,Pe.gl.TRIANGLES,_t,a.ag.disabled,a.a.disabled,a.af.backCCW,Ks,ge.id,jt.vertexBuffer,jt.indexBuffer,jt.segments,ge.paint,se.transform.zoom,void 0,qs),ys.draw(se,Pe.gl.TRIANGLES,ui?xt:_t,a.ag.disabled,ui||En.opacity<1||Un.hasTranslucentParts?a.a.alphaBlended:a.a.unblended,a.af.backCCW,Ks,ge.id,jt.vertexBuffer,jt.indexBuffer,jt.segments,ge.paint,se.transform.zoom,void 0,qs)}}}}()}(g,l,f,y),void L();const $=B.getModels(),G=[],Z=g.transform.getFreeCameraOptions().position,Q=a._.scale([],[Z.x,Z.y,Z.z],g.transform.worldSize);a._.negate(Q,Q);const ne=[],ie=[];let oe=0;for(const se of $){const me=f.paint.get("model-rotation").constantOr(null),ge=f.paint.get("model-scale").constantOr(null),_e=f.paint.get("model-translation").constantOr(null);se.computeModelMatrix(g,me,ge,_e,!0,!0,!1);const Pe=a.ad.identity([]),Te=a.cg(se.position.lat,g.transform.zoom),pe=a.ad.fromScaling([],[1,1,1/Te]);a.ad.translate(Pe,Pe,Q),G.push({zScaleMatrix:pe,negCameraPosMatrix:Pe});for(const ye of se.nodes)Vo(g.transform,ye,se.matrix,g.transform.expandedFarZProjMatrix,oe,ne,ie);oe++}if(ne.sort((se,me)=>me.depth-se.depth),g.renderPass!=="shadow"){if(w===1)for(const se of ie)Iu(se,g,f,G[se.modelIndex],a.ag.disabled,g.colorModeForRenderPass());else{for(const se of ie)Iu(se,g,f,G[se.modelIndex],a.ag.disabled,a.a.disabled);for(const se of ie)Iu(se,g,f,G[se.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const se of ne)Iu(se,g,f,G[se.modelIndex],a.ag.disabled,g.colorModeForRenderPass());L()}else{for(const se of ie)gs(se.mesh,se.nodeModelMatrix,g,f);for(const se of ne)gs(se.mesh,se.nodeModelMatrix,g,f);L()}}},Cb={model:function(g,l,f){const y=l.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(f.modelManager&&f.modelManager.upload(f,y.type==="vector"?g.scope:""));if(y.type==="batched-model")return;const w=y.getModels();for(const E of w)E.upload(f.context)},raster:function(g,l,f){const y=l.getSource();if(!(y instanceof kh&&y.loaded()))return;const w=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const E=g.paint.get("raster-array-band")||y.getInitialBand(w);if(E==null)return;const T=l.getIds().map(M=>l.getTileByID(M));for(const M of T)M.updateNeeded(w,E)&&y.prepareTile(M,w,E)},"raster-particle":function(g,l,f){const y=l.getSource();if(!(y instanceof kh&&y.loaded()))return;const w=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const E=g.paint.get("raster-particle-array-band")||y.getInitialBand(w);if(E==null)return;const T=l.getIds().map(M=>l.getTileByID(M));for(const M of T)M.updateNeeded(w,E)&&y.prepareTile(M,w,E)}};class Eb{constructor(l,f,y,w){this.context=new Ei(l,f),this.occlusionBuffers=new uI(this.context),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=a.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const T of E)this._debugParams.enabledLayers[T]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const T of E)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],T);this.symbolParams=new vr(w),this.setup(),this.numSublayers=a.bv.maxUnderzooming+a.bv.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.co,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Dm(this),this._wireframeDebugCache=new $f,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[]}updateTerrain(l,f){const y=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new cy(this,l));const w=this._terrain;this.transform.elevation=y?w:null,w.update(l,this.transform,f),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(l){const f=l.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,w]=f.getFovAdjustedRange(this.transform._fov);if(y>w)return void(this.transform.fogCullDistSq=null);const E=y+.78*(w-y);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(l){l&&!this._terrain&&(this._terrain=new cy(this,this.style)),this._forceTerrainMode=l}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(l,f){if(this.width=l*a.e.devicePixelRatio,this.height=f*a.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const l=this.context,f=new a.bt;f.emplaceBack(0,0),f.emplaceBack(a.a3,0),f.emplaceBack(0,a.a3),f.emplaceBack(a.a3,a.a3),this.tileExtentBuffer=l.createVertexBuffer(f,a.br.members),this.tileExtentSegments=a.b.simpleSegment(0,0,4,2);const y=new a.bt;y.emplaceBack(0,0),y.emplaceBack(a.a3,0),y.emplaceBack(0,a.a3),y.emplaceBack(a.a3,a.a3),this.debugBuffer=l.createVertexBuffer(y,a.br.members),this.debugSegments=a.b.simpleSegment(0,0,4,5);const w=new a.bt;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(w,a.br.members),this.viewportSegments=a.b.simpleSegment(0,0,4,2);const E=new a.cp;E.emplaceBack(0,0,0,0),E.emplaceBack(a.a3,0,a.a3,0),E.emplaceBack(0,a.a3,0,a.a3),E.emplaceBack(a.a3,a.a3,a.a3,a.a3),this.mercatorBoundsBuffer=l.createVertexBuffer(E,a.cq.members),this.mercatorBoundsSegments=a.b.simpleSegment(0,0,4,2);const T=new a.bu;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(T);const M=new a.cr;for(const B of[0,1,3,2,0])M.emplaceBack(B);this.debugIndexBuffer=l.createIndexBuffer(M),this.emptyTexture=new a.T(l,new a.i({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=a.ad.create();const L=this.context.gl;this.stencilClearMode=new a.ag({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,l.TRIANGLES,a.ae.disabled,this.stencilClearMode,a.a.disabled,a.af.disabled,Lm(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,f,y){if(!f||this.currentStencilSource===f.id||!l.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const L of y)if(this._tileClippingMaskIDs[L.key]===void 0){M=!0;break}if(!M)return}this.currentStencilSource=f.id;const w=this.context,E=w.gl;this.nextStencilID+y.length>256&&this.clearStencil(),w.setColorMode(a.a.disabled),w.setDepthMode(a.ae.disabled);const T=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of y){const L=f.getTile(M),B=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:G,tileBoundsSegments:Z}=this.getTileBoundsBuffers(L);T.draw(this,E.TRIANGLES,a.ae.disabled,new a.ag({func:E.ALWAYS,mask:0},B,255,E.KEEP,E.KEEP,E.REPLACE),a.a.disabled,a.af.disabled,Lm(M.projMatrix),"$clipping",$,G,Z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,f=this.context.gl;return new a.ag({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const f=this.context.gl;return new a.ag({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(l){const f=this.context.gl,y=l.sort((T,M)=>M.overscaledZ-T.overscaledZ),w=y[y.length-1].overscaledZ,E=y[0].overscaledZ-w+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const T={};for(let M=0;M<E;M++)T[M+w]=new a.ag({func:f.GEQUAL,mask:255},M+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=E,[T,y]}return[{[w]:a.ag.disabled},y]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new a.a([l.CONSTANT_COLOR,l.ONE,l.CONSTANT_COLOR,l.ONE],new a.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.a.unblended:a.a.alphaBlended}colorModeForDrapableLayerRenderPass(l){const f=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new a.a([f.ONE,f.ONE_MINUS_SRC_ALPHA,f.CONSTANT_ALPHA,f.ONE_MINUS_SRC_ALPHA],new a.C(0,0,0,l===void 0?0:l),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(l,f,y,w=!1){if(this.depthOcclusion)return new a.ae(this.context.gl.GREATER,a.ae.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return a.ae.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new a.ae(y||this.context.gl.LEQUAL,f,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((l,f)=>l+f/this._fpsHistory.length,0))}render(l,f){const y=a.e.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=l.map.repaint,this.style=l,this.options=f;const w=this.style._mergedLayers,E=this.style.order.filter(ye=>{const ve=w[ye];return!(ve.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[ve.type]}),T=E.map(ye=>w[ye]),M=this.style._mergedSourceCaches;this.imageManager=l.imageManager,this.modelManager=l.modelManager,this.symbolFadeChange=l.placement.symbolFadeChange(a.e.now()),this.imageManager.beginFrame();let L=0,B=!1;for(const ye in M){const ve=M[ye];ve.used&&(ve.prepare(this.context),ve.getSource().usedInConflation&&++L)}let $=!1;for(const ye of T)ye.isHidden(this.transform.zoom)||(ye.type==="clip"&&($=!0),this.prepareLayer(ye));const G={},Z={},Q={},ne={},ie={};for(const ye in M){const ve=M[ye];G[ye]=ve.getVisibleCoordinates(),Z[ye]=G[ye].slice().reverse(),Q[ye]=ve.getVisibleCoordinates(!0).reverse(),ne[ye]=ve.getShadowCasterCoordinates(),ie[ye]=ve.sortCoordinatesByDistance(G[ye])}const oe=ye=>{const ve=this.style.getLayerSourceCache(ye);return ve&&ve.used?ve.getSource():null};if(L||$){const ye=[],ve=[];let De=0;for(const He of T)this.isSourceForClippingOrConflation(He,oe(He))&&(ye.push(He),ve.push(De)),De++;if(ye&&($||ye.length>1)){const He=[];for(let Ee=0;Ee<ye.length;Ee++){const Ge=ye[Ee],Qe=ve[Ee],_t=this.style.getLayerSourceCache(Ge);if(!_t||!_t.used||!_t.getSource().usedInConflation&&Ge.type!=="clip")continue;let xt=1/0,gt=a.cu.None;if(Ge.type==="clip"){xt=Qe;for(const Ue of Ge.layout.get("clip-layer-types"))gt|=Ue==="model"?a.cu.Model:Ue==="symbol"?a.cu.Symbol:a.cu.FillExtrusion}He.push({layer:Ge.fqid,cache:_t,order:xt,clipMask:gt})}this.replacementSource.setSources(He),B=!0}}B||this.replacementSource.clear(),this.conflationActive=B,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ye=0;ye<T.length;ye++){const ve=T[ye],De=ve.cutoffRange();if(this.longestCutoffRange=Math.max(De,this.longestCutoffRange),De>0){const He=oe(ve);He&&(this.minCutoffZoom=Math.max(He.minzoom,this.minCutoffZoom)),ve.minzoom&&(this.minCutoffZoom=Math.max(ve.minzoom,this.minCutoffZoom))}ve.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ye),this._lastOcclusionLayer=ye)}const se=this.style&&this.style.fog;se?(this._fogVisible=se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Q),this.opaquePassCutoff=0);const me=this._shadowRenderer;if(me){me.updateShadowParameters(this.transform,this.style.directionalLight);for(const ye in M)for(const ve of G[ye]){let De={min:0,max:0};this.terrain&&(De=this.terrain.getMinMaxForTile(ve)||De),me.addShadowReceiver(ve.toUnwrapped(),De.min,De.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.cs(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Cy(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!a.ct(this.context.gl))return;this.renderPass="offscreen";for(const ye of T){const ve=l.getLayerSourceCache(ye);if(!ye.hasOffscreenPass()||ye.isHidden(this.transform.zoom))continue;const De=ve?Z[ve.id]:void 0;(ye.type==="custom"||ye.type==="raster"||ye.type==="raster-particle"||ye.isSky()||De&&De.length)&&this.renderLayer(this,ve,ye,De)}this.depthRangeFor3D=[0,1-(T.length+2)*this.numSublayers*this.depthEpsilon];const ge=this.terrain;ge&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&ge.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ne)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const _e=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Pe=(()=>{if(f.showOverdrawInspector)return a.C.black;const ye=this.style.fog;if(ye&&this.transform.projection.supportsFog){const ve=this.style.getLut(ye.scope);if(!_e){const De=ye.properties.get("color").toRenderColor(ve).toArray01();return new a.C(...De)}if(_e){const De=ye.properties.get("space-color").toRenderColor(ve).toArray01();return new a.C(...De)}}return a.C.transparent})();if(this.context.clear({color:Pe,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&_e&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=E.length-1;this.currentLayer>=0;this.currentLayer--){const ye=T[this.currentLayer],ve=l.getLayerSourceCache(ye);if(ye.isSky())continue;const De=ve?(ye.is3D()?ie:Z)[ve.id]:void 0;this._renderTileClippingMasks(ye,ve,De),this.renderLayer(this,ve,ye,De)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&_e&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a1(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<E.length;this.currentLayer++){const ye=T[this.currentLayer],ve=l.getLayerSourceCache(ye);ye.isSky()&&this.renderLayer(this,ve,ye,ve?Z[ve.id]:void 0)}function Te(ye,ve){let De;return ve&&(De=(ye.type==="symbol"?Q:ye.is3D()?ie:Z)[ve.id]),De}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<E.length;){const ye=T[this.currentLayer];if(ye.type==="raster"){const ve=l.getLayerSourceCache(ye);this.renderLayer(this,ve,ye,Te(ye,ve))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let pe=0;for(me&&(pe=me.getShadowCastingLayerCount());this.currentLayer<E.length;){const ye=T[this.currentLayer],ve=l.getLayerSourceCache(ye);if(ye.isSky())++this.currentLayer;else if(ge&&this.style.isLayerDraped(ye)){if(ye.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=ge.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(ye.is3D()||this.terrain||this._renderTileClippingMasks(ye,ve,ve?G[ve.id]:void 0),this.renderLayer(this,ve,ye,Te(ye,ve)),!ge&&me&&pe>0&&ye.hasShadowPass()&&--pe==0&&(me.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const De=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=De;this.currentLayer++){const He=T[this.currentLayer];if(!He.hasLightBeamPass())continue;const Ee=l.getLayerSourceCache(He);this.renderLayer(this,Ee,He,Ee?Z[Ee.id]:void 0)}this.currentLayer=De,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const De=this.currentLayer;this.depthOcclusion=!0;for(const He of this.layersWithOcclusionOpacity){this.currentLayer=He;const Ee=T[this.currentLayer],Ge=l.getLayerSourceCache(Ee),Qe=Ge?Z[Ge.id]:void 0;Ee.is3D()||this.terrain||this._renderTileClippingMasks(Ee,Ge,Ge?G[Ge.id]:void 0),this.renderLayer(this,Ge,Ee,Qe)}this.depthOcclusion=!1,this.currentLayer=De,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ye=null;T.forEach(ve=>{const De=l.getLayerSourceCache(ve);De&&!ve.isHidden(this.transform.zoom)&&De.getVisibleCoordinates().length&&(!ye||ye.getSource().maxzoom<De.getSource().maxzoom)&&(ye=De)}),ye&&this.options.showTileBoundaries&&Ma.debug(this,ye,ye.getVisibleCoordinates(),a.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Ma.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ye){const ve=ye.transform.padding;vn(ye,ye.transform.height-(ve.top||0),3,Km),vn(ye,ve.bottom||0,3,by),xn(ye,ve.left||0,3,ll),xn(ye,ye.transform.width-(ve.right||0),3,wy);const De=ye.transform.centerPoint;(function(He,Ee,Ge,Qe){ms(He,Ee-1,Ge-10,2,20,Qe),ms(He,Ee-10,Ge-1,20,2,Qe)})(ye,De.x,ye.transform.height-De.y,Nh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),B||(this.conflationActive=!1)}prepareLayer(l){this.gpuTimingStart(l);const{unsupportedLayers:f}=this.transform.projection,y=!f||!f.includes(l.type);if(Cb[l.type]&&(y||this.terrain&&l.type==="custom")){const w=this.style.getLayerSourceCache(l);Cb[l.type](l,w,this)}this.gpuTimingEnd()}renderLayer(l,f,y,w){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||w&&w.length)&&(this.id=y.id,this.gpuTimingStart(y),l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes(y.type)&&(!l.terrain||y.type!=="custom")||y.type==="clip"||Ma[y.type](l,f,y,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery,y=this.context.gl;let w=this.gpuTimers[l.id];w||(w=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:y.createQuery()}),w.calls++,y.beginQuery(f.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,f=this.context.gl,y=f.createQuery();this.deferredRenderGpuTimeQueries.push(y),f.beginQuery(l.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const f={};for(const y in l){const w=l[y],E=this.context.extTimerQuery,T=E.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(w.query),f[y]=T}return f}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery,y=this.context.gl;let w=0;for(const E of l)w+=f.getQueryParameter(E,y.QUERY_RESULT)/1e6,f.deleteQueryEXT(E);return w}translatePosMatrix(l,f,y,w,E){if(!y[0]&&!y[1])return l;const T=E?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(T){const B=Math.sin(T),$=Math.cos(T);y=[y[0]*$-y[1]*B,y[0]*B+y[1]*$]}const M=[E?y[0]:a.bB(f,y[0],this.transform.zoom),E?y[1]:a.bB(f,y[1],this.transform.zoom),0],L=new Float32Array(16);return a.ad.translate(L,l,M),L}saveTileTexture(l){const f=l.size[0],y=this._tileTextures[f];y?y.push(l):this._tileTextures[f]=[l]}getTileTexture(l){const f=this._tileTextures[l];return f&&f.length>0?f.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(l,f,y){const w=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,E=[];return this.style&&this.style.enable3dLights()&&(l==="globeRaster"||l==="terrainRaster"?(E.push("LIGHTING_3D_MODE"),E.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||E.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||E.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?E.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):E.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(E.push("TERRAIN"),this.linearFloatFilteringSupported()&&E.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&E.push("GLOBE"),!this._fogVisible||w||f!==void 0&&!f||E.push("FOG","FOG_DITHERING"),w&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}getOrCreateProgram(l,f){this.cache=this.cache||{};const y=f&&f.defines||[],w=f&&f.config,E=this.currentGlobalDefines(l,f&&f.overrideFog,f&&f.overrideRtt).concat(y),T=Mf.cacheKey(sb[l],l,E,w);return this.cache[T]||(this.cache[T]=new Mf(this.context,l,sb[l],w,oI[l],E)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(l,f){if(this.style.enable3dLights()){const y=this.style.directionalLight,w=this.style.ambientLight;if(y&&w){const E=((T,M,L)=>{const B=T.properties.get("direction"),$=T.properties.get("color").toRenderColor(L.getLut(T.scope)).toArray01(),G=T.properties.get("intensity"),Z=M.properties.get("color").toRenderColor(L.getLut(M.scope)).toArray01(),Q=M.properties.get("intensity"),ne=[B.x,B.y,B.z],ie=a.bA(Z,Q),oe=a.bA($,G);return{u_lighting_ambient_color:ie,u_lighting_directional_dir:ne,u_lighting_directional_color:oe,u_ground_radiance:Hl(ne,oe,ie)}})(y,w,this.style);f.setLightsUniformValues(l,E)}}}uploadCommonUniforms(l,f,y,w,E){if(this.uploadCommonLightUniforms(l,f),this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const M=T.getOpacity(this.transform.pitch),L=((B,$,G,Z,Q,ne,ie,oe,se,me,ge,_e)=>{const Pe=B.transform,Te=$.properties.get("color").toRenderColor(B.style.getLut($.scope)).toArray01();Te[3]=Z;const pe=B.frameCounter/1e3%1,[ye,ve]=$.properties.get("vertical-range");return{u_fog_matrix:G?Pe.calculateFogTileMatrix(G):_e||B.identityMat,u_fog_range:$.getFovAdjustedRange(Pe._fov),u_fog_color:Te,u_fog_horizon_blend:$.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ye,ve),ve],u_fog_temporal_offset:pe,u_frustum_tl:Q,u_frustum_tr:ne,u_frustum_br:ie,u_frustum_bl:oe,u_globe_pos:se,u_globe_radius:me,u_viewport:ge,u_globe_transition:a.a1(Pe.zoom),u_is_globe:+(Pe.projection.name==="globe")}})(this,T,y,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.e.devicePixelRatio,this.transform.height*a.e.devicePixelRatio],w);f.setFogUniformValues(l,L)}E&&f.setCutoffUniformValues(l,E.uniformValues)}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,f=l.createTexture();return l.bindTexture(l.TEXTURE_2D,f),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const w of y)f[w.key]=l[w.key]||new a.by(w,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(l,f){return!(!l.is3D()||l.minzoom&&l.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||l.sourceLayer!=="building")&&l.type!=="clip"&&(!f||f.type!=="batched-model"))}isTileAffectedByFog(l){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let f=this._cachedTileFogOpacities[l.key];return f||(this._cachedTileFogOpacities[l.key]=f=this.style.fog.getOpacityForTile(l)),f[0]>=An||f[1]>=An}}class Qo{constructor(l,f,y,w){this.screenBounds=l,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(l,f){let y,w;if(l instanceof a.P||typeof l[0]=="number"){const E=a.P.convert(l);y=[E],w=f.isPointAboveHorizon(E)}else{const E=a.P.convert(l[0]),T=a.P.convert(l[1]);y=[E,T],w=a.cv(E,T).every(M=>f.isPointAboveHorizon(M))}return new Qo(y,f.getCameraPoint(),w,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return a.cv(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],w=a.cv(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?w[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(w[3]=this.cameraPoint)),a.cw(w,l)}bufferedCameraGeometryGlobe(l){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],w=a.cv(f,y,l),E=this.cameraPoint.clone();switch(3*((E.y>f.y)+(E.y>y.y))+((E.x>f.x)+(E.x>y.x))){case 0:w[0]=E,w[4]=E.clone();break;case 1:w.splice(1,0,E);break;case 2:w[1]=E;break;case 3:w.splice(4,0,E);break;case 5:w.splice(2,0,E);break;case 6:w[3]=E;break;case 7:w.splice(3,0,E);break;case 8:w[2]=E}return w}containsTile(l,f,y,w=0){const E=l.queryPadding/f._pixelsPerMercatorPixel+1,T=y?this._bufferedCameraMercator(E,f):this._bufferedScreenMercator(E,f);let M=l.tileID.wrap+(T.unwrapped?w:0);const L=T.polygon.map(oe=>a.cx(l.tileTransform,oe,M));if(!a.cy(L,0,0,a.a3,a.a3))return;M=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const B=this.screenGeometryMercator.polygon.map(oe=>a.cz(l.tileTransform,oe,M)),$=B.map(oe=>new a.P(oe[0],oe[1])),G=f.getFreeCameraOptions().position||new a.Y(0,0,0),Z=a.cz(l.tileTransform,G,M),Q=B.map(oe=>{const se=a._.sub(oe,oe,Z);return a._.normalize(se,se),new a.aT(Z,se)}),ne=a.bB(l,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:Q,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(ie=a.cA(L),ie.min.x=a.at(ie.min.x,0,a.a3),ie.min.y=a.at(ie.min.y,0,a.a3),ie.max.x=a.at(ie.max.x,0,a.a3),ie.max.y=a.at(ie.max.y,0,a.a3),ie),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:ne};var ie}_bufferedScreenMercator(l,f){const y=Ty(l);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),f):{polygon:this.bufferedScreenGeometry(l).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[y]=w,w}}_bufferedCameraMercator(l,f){const y=Ty(l);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),f):{polygon:this.bufferedCameraGeometry(l).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[y]=w,w}}_projectAndResample(l,f){const y=function(E,T){const M=a.ad.multiply([],T.pixelMatrix,T.globeMatrix),L=[0,-a.cD,0,1],B=[0,a.cD,0,1],$=[0,0,0,1];a.aA.transformMat4(L,L,M),a.aA.transformMat4(B,B,M),a.aA.transformMat4($,$,M);const G=new a.P(L[0]/L[3],L[1]/L[3]),Z=new a.P(B[0]/B[3],B[1]/B[3]),Q=a.cB(E,G)&&L[3]<$[3],ne=a.cB(E,Z)&&B[3]<$[3];if(!Q&&!ne)return null;const ie=function(pe,ye,ve){for(let De=1;De<pe.length;De++){const He=Pc(ye.pointCoordinate3D(pe[De-1]).x),Ee=Pc(ye.pointCoordinate3D(pe[De]).x);if(ve<0){if(He<Ee)return{idx:De,t:-He/(Ee-1-He)}}else if(Ee<He)return{idx:De,t:(1-He)/(Ee+1-He)}}return null}(E,T,Q?-1:1);if(!ie)return null;const{idx:oe,t:se}=ie;let me=oe>1?Sy(E.slice(0,oe),T):[],ge=oe<E.length?Sy(E.slice(oe),T):[];me=me.map(pe=>new a.P(Pc(pe.x),pe.y)),ge=ge.map(pe=>new a.P(Pc(pe.x),pe.y));const _e=[...me];_e.length===0&&_e.push(ge[ge.length-1]);const Pe=a.a2(_e[_e.length-1].y,(ge.length===0?me[0]:ge[0]).y,se);let Te;return Te=Q?[new a.P(0,Pe),new a.P(0,0),new a.P(1,0),new a.P(1,Pe)]:[new a.P(1,Pe),new a.P(1,1),new a.P(0,1),new a.P(0,Pe)],_e.push(...Te),ge.length===0?_e.push(me[0]):_e.push(...ge),{polygon:_e.map(pe=>new a.Y(pe.x,pe.y)),unwrapped:!1}}(l,f);if(y)return y;const w=function(E,T){let M=!1,L=-1/0,B=0;for(let G=0;G<E.length-1;G++)E[G].x>L&&(L=E[G].x,B=G);for(let G=0;G<E.length-1;G++){const Z=(B+G)%(E.length-1),Q=E[Z],ne=E[Z+1];Math.abs(Q.x-ne.x)>.5&&(Q.x<ne.x?(Q.x+=1,Z===0&&(E[E.length-1].x+=1)):(ne.x+=1,Z+1===E.length-1&&(E[0].x+=1)),M=!0)}const $=a.aj(T.center.lng);return M&&$<Math.abs($-1)&&E.forEach(G=>{G.x-=1}),{polygon:E,unwrapped:M}}(Sy(l,f).map(E=>new a.P(Pc(E.x),E.y)),f);return{polygon:w.polygon.map(E=>new a.Y(E.x,E.y)),unwrapped:w.unwrapped}}}function Sy(g,l){return a.cC(g,f=>{const y=l.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function Pc(g){return g<0?1+g%1:g%1}function Ty(g){return 100*g|0}function hI(g,l){const f=a.ad.identity([]);return a.ad.scale(f,f,[.5*g.width,.5*-g.height,1]),a.ad.translate(f,f,[1,-1,0]),a.ad.multiply(f,f,g.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(f)}function dI(g,l,f,y,w,E,T,M=!1){const L=g.tilesIn(y,T,M);L.sort(Vh);const B=[];for(const G of L)B.push({wrappedTileID:G.tile.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(l,f,g._state,G,w,E,hI(g.transform,G.tile.tileID),M)});const $=function(G){const Z={},Q={};for(const ne of G){const ie=ne.queryResults,oe=ne.wrappedTileID,se=Q[oe]=Q[oe]||{};for(const me in ie){const ge=ie[me],_e=se[me]=se[me]||{},Pe=Z[me]=Z[me]||[];for(const Te of ge)_e[Te.featureIndex]||(_e[Te.featureIndex]=!0,Pe.push(Te))}}return Z}(B);for(const G in $)$[G].forEach(Z=>{const Q=Z.feature,ne=Q.layer;ne&&ne.type!=="background"&&ne.type!=="sky"&&ne.type!=="slot"&&(Q.source=ne.source,ne["source-layer"]&&(Q.sourceLayer=ne["source-layer"]),Q.state=Q.id!==void 0?g.getFeatureState(ne["source-layer"],Q.id):{})});return $}function jf(g,l){const f=g.getRenderableIds().map(E=>g.getTileByID(E)),y=[],w={};for(let E=0;E<f.length;E++){const T=f[E],M=T.tileID.canonical.key;w[M]||(w[M]=!0,T.querySourceFeatures(y,l))}return y}function Vh(g,l){const f=g.tileID,y=l.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}class fI{constructor(l){this.style=l,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const l=!1,f=!1;for(const y in this.style._mergedLayers){const w=this.style._mergedLayers[y];if(w.type==="fill-extrusion")this.layers.push({layer:w,visible:l,visibilityChanged:f});else if(w.type==="model"){const E=this.style.getLayerSource(w);E&&E.type==="batched-model"&&this.layers.push({layer:w,visible:l,visibilityChanged:f})}}}onNewFrame(l){this.layersGotHidden=!1;for(const f of this.layers){const y=f.layer;let w=!1;y.type==="fill-extrusion"?w=!y.isHidden(l)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(w=!y.isHidden(l)&&y.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!w&&f.visible,f.visible=w}}updateZOffset(l,f){this.currentBuildingBuckets=[];for(const w of this.layers){const E=w.layer,T=this.style.getLayerSourceCache(E);let M=1;E.type==="fill-extrusion"&&(M=w.visible?E.paint.get("fill-extrusion-vertical-scale"):0);let L=T?T.getTile(f):null;if(!L&&T&&f.canonical.z>T.getSource().minzoom){let B=f.scaledTo(Math.min(T.getSource().maxzoom,f.overscaledZ-1));for(;B.overscaledZ>=T.getSource().minzoom&&(L=T.getTile(B),!L&&B.overscaledZ!==0);)B=B.scaledTo(B.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:L?L.getBucket(E):null,tileID:L?L.tileID:f,verticalScale:M})}l.hasAnyZOffset=!1;let y=!1;for(let w=0;w<l.symbolInstances.length;w++){const E=l.symbolInstances.get(w),T=E.zOffset,M=this._getHeightAtTileOffset(f,E.tileAnchorX,E.tileAnchorY);E.zOffset=M!==Number.NEGATIVE_INFINITY?M:T,y||T===E.zOffset||(y=!0),l.hasAnyZOffset||E.zOffset===0||(l.hasAnyZOffset=!0)}y&&(l.zOffsetBuffersNeedUpload=!0,l.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(l,f,y,w){let E=f,T=y;if(l.canonical.z!==w.canonical.z){const M=w.canonical,L=1/(1<<l.canonical.z-M.z);E=(f+l.canonical.x*a.a3)*L-M.x*a.a3|0,T=(y+l.canonical.y*a.a3)*L-M.y*a.a3|0}return{tileX:E,tileY:T}}_getHeightAtTileOffset(l,f,y){let w,E;for(let T=0;T<this.layers.length;++T){if(this.layers[T].layer.type!=="fill-extrusion")continue;const{bucket:M,tileID:L,verticalScale:B}=this.currentBuildingBuckets[T];if(!M)continue;const{tileX:$,tileY:G}=this._mapCoordToOverlappingTile(l,f,y,L),Z=M.getHeightAtTileCoord($,G);Z&&Z.height!==void 0&&(Z.hidden?w=Z.height:E=Math.max(Z.height*B,E||0))}if(E!==void 0)return E;for(let T=0;T<this.layers.length;++T){const M=this.layers[T];if(M.layer.type!=="model"||!M.visible)continue;const{bucket:L,tileID:B}=this.currentBuildingBuckets[T];if(!L)continue;const{tileX:$,tileY:G}=this._mapCoordToOverlappingTile(l,f,y,B),Z=L.getHeightAtTileCoord($,G);if(Z&&!Z.hidden)return Z.height===void 0&&w!==void 0?Math.min(Z.maxHeight,w)*Z.verticalScale:Z.height?Z.height*Z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Hh(g,l){const f={};for(const y in g)y!=="ref"&&(f[y]=g[y]);return a.cE.forEach(y=>{y in l&&(f[y]=l[y])}),f}function Ay(g){g=g.slice();const l=Object.create(null);for(let f=0;f<g.length;f++)l[g[f].id]=g[f];for(let f=0;f<g.length;f++)"ref"in g[f]&&(g[f]=Hh(g[f],l[g[f].ref]));return g}const hn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Wl(g,l,f){f.push({command:hn.addSource,args:[g,l[g]]})}function Sb(g,l,f){l.push({command:hn.removeSource,args:[g]}),f[g]=!0}function pI(g,l,f,y){Sb(g,f,y),Wl(g,l,f)}function mI(g,l,f){let y;for(y in g[f])if(g[f].hasOwnProperty(y)&&y!=="data"&&!C(g[f][y],l[f][y]))return!1;for(y in l[f])if(l[f].hasOwnProperty(y)&&y!=="data"&&!C(g[f][y],l[f][y]))return!1;return!0}function Vf(g,l,f,y,w,E){let T;for(T in l=l||{},g=g||{})g.hasOwnProperty(T)&&(C(g[T],l[T])||f.push({command:E,args:[y,T,l[T],w]}));for(T in l)l.hasOwnProperty(T)&&!g.hasOwnProperty(T)&&(C(g[T],l[T])||f.push({command:E,args:[y,T,l[T],w]}))}function Ym(g){return g.id}function Gh(g,l){return g[l.id]=l,g}class Tb{constructor(l,f){this.reset(l,f)}reset(l,f){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.at(l,0,1);let f=1,y=this._distances[f];const w=l*this.paddedLength+this.padding;for(;y<w&&f<this._distances.length;)y=this._distances[++f];const E=f-1,T=this._distances[E],M=y-T,L=M>0?(w-T)/M:0;return this.points[E].mult(1-L).add(this.points[f].mult(L))}}class Iy{constructor(l,f,y){const w=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(f/y);for(let T=0;T<this.xCellCount*this.yCellCount;T++)w.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,f,y,w,E){this._forEachCell(f,y,w,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(E)}insertCircle(l,f,y,w){this._forEachCell(f-w,y-w,f+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(y),this.circles.push(w)}_insertBoxCell(l,f,y,w,E,T){this.boxCells[E].push(T)}_insertCircleCell(l,f,y,w,E,T){this.circleCells[E].push(T)}_query(l,f,y,w,E,T){if(y<0||l>this.width||w<0||f>this.height)return!E&&[];const M=[];if(l<=0&&f<=0&&this.width<=y&&this.height<=w){if(E)return!0;for(let L=0;L<this.boxKeys.length;L++)M.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const B=this.circles[3*L],$=this.circles[3*L+1],G=this.circles[3*L+2];M.push({key:this.circleKeys[L],x1:B-G,y1:$-G,x2:B+G,y2:$+G})}return T?M.filter(T):M}return this._forEachCell(l,f,y,w,this._queryCell,M,{hitTest:E,seenUids:{box:{},circle:{}}},T),E?M.length>0:M}_queryCircle(l,f,y,w,E){const T=l-y,M=l+y,L=f-y,B=f+y;if(M<0||T>this.width||B<0||L>this.height)return!w&&[];const $=[];return this._forEachCell(T,L,M,B,this._queryCellCircle,$,{hitTest:w,circle:{x:l,y:f,radius:y},seenUids:{box:{},circle:{}}},E),w?$.length>0:$}query(l,f,y,w,E){return this._query(l,f,y,w,!1,E)}hitTest(l,f,y,w,E){return this._query(l,f,y,w,!0,E)}hitTestCircle(l,f,y,w){return this._queryCircle(l,f,y,!0,w)}_queryCell(l,f,y,w,E,T,M,L){const B=M.seenUids,$=this.boxCells[E];if($!==null){const Z=this.bboxes;for(const Q of $)if(!B.box[Q]){B.box[Q]=!0;const ne=4*Q;if(l<=Z[ne+2]&&f<=Z[ne+3]&&y>=Z[ne+0]&&w>=Z[ne+1]&&(!L||L(this.boxKeys[Q]))){if(M.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[Q],x1:Z[ne],y1:Z[ne+1],x2:Z[ne+2],y2:Z[ne+3]})}}}const G=this.circleCells[E];if(G!==null){const Z=this.circles;for(const Q of G)if(!B.circle[Q]){B.circle[Q]=!0;const ne=3*Q;if(this._circleAndRectCollide(Z[ne],Z[ne+1],Z[ne+2],l,f,y,w)&&(!L||L(this.circleKeys[Q]))){if(M.hitTest)return T.push(!0),!0;{const ie=Z[ne],oe=Z[ne+1],se=Z[ne+2];T.push({key:this.circleKeys[Q],x1:ie-se,y1:oe-se,x2:ie+se,y2:oe+se})}}}}}_queryCellCircle(l,f,y,w,E,T,M,L){const B=M.circle,$=M.seenUids,G=this.boxCells[E];if(G!==null){const Q=this.bboxes;for(const ne of G)if(!$.box[ne]){$.box[ne]=!0;const ie=4*ne;if(this._circleAndRectCollide(B.x,B.y,B.radius,Q[ie+0],Q[ie+1],Q[ie+2],Q[ie+3])&&(!L||L(this.boxKeys[ne])))return T.push(!0),!0}}const Z=this.circleCells[E];if(Z!==null){const Q=this.circles;for(const ne of Z)if(!$.circle[ne]){$.circle[ne]=!0;const ie=3*ne;if(this._circlesCollide(Q[ie],Q[ie+1],Q[ie+2],B.x,B.y,B.radius)&&(!L||L(this.circleKeys[ne])))return T.push(!0),!0}}}_forEachCell(l,f,y,w,E,T,M,L){const B=this._convertToXCellCoord(l),$=this._convertToYCellCoord(f),G=this._convertToXCellCoord(y),Z=this._convertToYCellCoord(w);for(let Q=B;Q<=G;Q++)for(let ne=$;ne<=Z;ne++)if(E.call(this,l,f,y,w,this.xCellCount*ne+Q,T,M,L))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,f,y,w,E,T){const M=w-l,L=E-f,B=y+T;return B*B>M*M+L*L}_circleAndRectCollide(l,f,y,w,E,T,M){const L=(T-w)/2,B=Math.abs(l-(w+L));if(B>L+y)return!1;const $=(M-E)/2,G=Math.abs(f-(E+$));if(G>$+y)return!1;if(B<=L||G<=$)return!0;const Z=B-L,Q=G-$;return Z*Z+Q*Q<=y*y}}const Pa=100;class Ab{constructor(l,f,y=new Iy(l.width+200,l.height+200,25),w=new Iy(l.width+200,l.height+200,25)){this.transform=l,this.grid=y,this.ignoredGrid=w,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Pa,this.screenBottomBoundary=l.height+Pa,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=f}placeCollisionBox(l,f,y,w,E,T,M,L){let B=y.projectedAnchorX,$=y.projectedAnchorY,G=y.projectedAnchorZ;const Z=y.elevation,Q=y.tileID,ne=l.getProjection();if(Z&&Q){const[Te,pe,ye]=ne.upVector(Q.canonical,y.tileAnchorX,y.tileAnchorY),ve=ne.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=Te*Z*ve,$+=pe*Z*ve,G+=ye*Z*ve}const ie=this.projectAndGetPerspectiveRatio(M,B,$,G,y.tileID,ne.name==="globe"||!!Z||this.transform.pitch>0,ne),oe=T*ie.perspectiveRatio,se=(y.x1*f+w.x-y.padding)*oe+ie.point.x,me=(y.y1*f+w.y-y.padding)*oe+ie.point.y,ge=(y.x2*f+w.x+y.padding)*oe+ie.point.x,_e=(y.y2*f+w.y+y.padding)*oe+ie.point.y,Pe=ie.perspectiveRatio<=.55||ie.occluded;return!this.isInsideGrid(se,me,ge,_e)||!E&&this.grid.hitTest(se,me,ge,_e,L)||Pe?{box:[],offscreen:!1,occluded:ie.occluded}:{box:[se,me,ge,_e],offscreen:this.isOffscreen(se,me,ge,_e),occluded:!1}}placeCollisionCircles(l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie){const oe=[],se=this.transform.elevation,me=l.getProjection(),ge=se?se.getAtTileOffsetFunc(ie,this.transform.center.lat,this.transform.worldSize,me):null,_e=new a.P(y.tileAnchorX,y.tileAnchorY);let{x:Pe,y:Te,z:pe}=me.projectTilePoint(_e.x,_e.y,ie.canonical);if(ge){const[gt,Ue,rt]=ge(_e);Pe+=gt,Te+=Ue,pe+=rt}const ye=me.name==="globe",ve=this.projectAndGetPerspectiveRatio(M,Pe,Te,pe,ie,ye||!!se||this.transform.pitch>0,me),{perspectiveRatio:De}=ve,He=(G?T/De:T*De)/a.bN,Ee=oa(Pe,Te,pe,L),Ge=ve.signedDistanceFromCamera>0?Rm(He,E,y.lineOffsetX*He,y.lineOffsetY*He,!1,Ee,_e,y,w,L,{},se&&!G?ge:null,G&&!!se,me,ie,G):null;let Qe=!1,_t=!1,xt=!0;if(Ge&&!ve.occluded){const gt=.5*Q*De+ne,Ue=new a.P(-100,-100),rt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),pt=new Tb,{first:Ft,last:zt}=Ge,Gt=Ft.path.length;let Nt=[];for(let tr=Gt-1;tr>=1;tr--)Nt.push(Ft.path[tr]);for(let tr=1;tr<zt.path.length;tr++)Nt.push(zt.path[tr]);const St=2.5*gt;B&&(Nt=Nt.map(([tr,$r,Rr],Zr)=>(ge&&!ye&&(Rr=ge(Zr<Gt-1?Ft.tilePath[Gt-1-Zr]:zt.tilePath[Zr-Gt+2])[2]),oa(tr,$r,Rr,B))),Nt.some(tr=>tr[3]<=0)&&(Nt=[]));let ut=[];if(Nt.length>0){let tr=1/0,$r=-1/0,Rr=1/0,Zr=-1/0;for(const ln of Nt)tr=Math.min(tr,ln[0]),Rr=Math.min(Rr,ln[1]),$r=Math.max($r,ln[0]),Zr=Math.max(Zr,ln[1]);$r>=Ue.x&&tr<=rt.x&&Zr>=Ue.y&&Rr<=rt.y&&(ut=[Nt.map(ln=>new a.P(ln[0],ln[1]))],(tr<Ue.x||$r>rt.x||Rr<Ue.y||Zr>rt.y)&&(ut=a.cF(ut,Ue.x,Ue.y,rt.x,rt.y)))}for(const tr of ut){pt.reset(tr,.25*gt);let $r=0;$r=pt.length<=.5*gt?1:Math.ceil(pt.paddedLength/St)+1;for(let Rr=0;Rr<$r;Rr++){const Zr=Rr/Math.max($r-1,1),ln=pt.lerp(Zr),Pn=ln.x+Pa,Mr=ln.y+Pa;oe.push(Pn,Mr,gt,0);const En=Pn-gt,Un=Mr-gt,In=Pn+gt,en=Mr+gt;if(xt=xt&&this.isOffscreen(En,Un,In,en),_t=_t||this.isInsideGrid(En,Un,In,en),!f&&this.grid.hitTestCircle(Pn,Mr,gt,Z)&&(Qe=!0,!$))return{circles:[],offscreen:!1,collisionDetected:Qe,occluded:!1}}}}return{circles:!$&&Qe||!_t?[]:oe,offscreen:xt,collisionDetected:Qe,occluded:ve.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,w=1/0,E=-1/0,T=-1/0;for(const $ of l){const G=new a.P($.x+Pa,$.y+Pa);y=Math.min(y,G.x),w=Math.min(w,G.y),E=Math.max(E,G.x),T=Math.max(T,G.y),f.push(G)}const M=this.grid.query(y,w,E,T).concat(this.ignoredGrid.query(y,w,E,T)),L={},B={};for(const $ of M){const G=$.key;if(L[G.bucketInstanceId]===void 0&&(L[G.bucketInstanceId]={}),L[G.bucketInstanceId][G.featureIndex])continue;const Z=[new a.P($.x1,$.y1),new a.P($.x2,$.y1),new a.P($.x2,$.y2),new a.P($.x1,$.y2)];a.cG(f,Z)&&(L[G.bucketInstanceId][G.featureIndex]=!0,B[G.bucketInstanceId]===void 0&&(B[G.bucketInstanceId]=[]),B[G.bucketInstanceId].push(G.featureIndex))}return B}insertCollisionBox(l,f,y,w,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:E},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,f,y,w,E){const T=f?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:w,collisionGroupID:E};for(let L=0;L<l.length;L+=4)T.insertCircle(M,l[L],l[L+1],l[L+2])}projectAndGetPerspectiveRatio(l,f,y,w,E,T,M){const L=[f,y,w,1];let B=!1;w||this.transform.pitch>0?(a.aA.transformMat4(L,L,l),this.fogState&&E&&M.name!=="globe"&&(B=function(Z,Q,ne,ie,oe,se){const me=se.calculateFogTileMatrix(oe),ge=[Q,ne,ie];return a._.transformMat4(ge,ge,me),Si(Z,a._.length(ge),se.pitch,se._fov)}(this.fogState,f,y,w,E.toUnwrapped(),this.transform)>.9)):sl(L,L,l);const $=L[3];return{point:new a.P((L[0]/$+1)/2*this.transform.width+Pa,(-L[1]/$+1)/2*this.transform.height+Pa),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/$*.5,1.5),signedDistanceFromCamera:$,occluded:T&&L[2]>$||B}}isOffscreen(l,f,y,w){return y<Pa||l>=this.screenRightBoundary||w<Pa||f>this.screenBottomBoundary}isInsideGrid(l,f,y,w){return y>=0&&l<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const l=a.ad.identity([]);return a.ad.translate(l,l,[-100,-100,0]),l}}class Rc{constructor(l,f,y,w){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class kc{constructor(l,f,y,w,E,T=!1){this.text=new Rc(l?l.text:null,f,y,E),this.icon=new Rc(l?l.icon:null,f,w,E),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zm{constructor(l,f,y,w=!1){this.text=l,this.icon=f,this.skipFade=y,this.clipped=w}}class Ib{constructor(){this.invProjMatrix=a.ad.create(),this.viewportMatrix=a.ad.create(),this.circles=[]}}class Hf{constructor(l,f,y,w,E){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=E}}class Gf{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[l]}}function My(g,l,f,y,w){const{horizontalAlign:E,verticalAlign:T}=a.bQ(g),M=-(E-.5)*l,L=-(T-.5)*f,B=a.bP(g,y);return new a.P(M+B[0]*w,L+B[1]*w)}function Wf(g,l,f,y,w){const E=new a.P(g,l);return f&&E._rotate(y?w:-w),E}class aa{constructor(l,f,y,w,E,T){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new Ab(this.transform,E),this.buildingIndex=T,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Gf(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,f,y,w){const E=y.getBucket(f),T=y.latestFeatureIndex;if(!E||!T||f.fqid!==E.layerIds[0])return;const M=E.layers[0].layout,L=y.collisionBoxArray,B=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),$=y.tileSize/a.a3,G=y.tileID.toUnwrapped();this.transform.setProjection(E.projection);const Z=(Q=y.tileID,ne=E.getProjection(),ie=this.transform,ne.name===this.projection?ie.calculateProjMatrix(Q.toUnwrapped()):Hm(ie,ne,Q));var Q,ne,ie;const oe=M.get("text-pitch-alignment")==="map",se=M.get("text-rotation-alignment")==="map";f.compileFilter();const me=f.dynamicFilter(),ge=f.dynamicFilterNeedsFeature(),_e=this.transform.calculatePixelsToTileUnitsMatrix(y),Pe=wu(Z,y.tileID.canonical,oe,se,this.transform,E.getProjection(),_e);let Te=null;if(oe){const ve=Mh(Z,y.tileID.canonical,oe,se,this.transform,E.getProjection(),_e);Te=a.ad.multiply([],this.transform.labelPlaneMatrix,ve)}let pe=null;me&&y.latestFeatureIndex&&(pe={unwrappedTileID:G,dynamicFilter:me,dynamicFilterNeedsFeature:ge,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new Hf(E.bucketInstanceId,T,E.sourceLayerIndex,E.index,y.tileID);const ye={bucket:E,layout:M,posMatrix:Z,textLabelPlaneMatrix:Pe,labelToScreenMatrix:Te,clippingData:pe,scale:B,textPixelRatio:$,holdingForFade:y.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:a.aD(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.aD(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(w)for(const ve of E.sortKeyRanges){const{sortKey:De,symbolInstanceStart:He,symbolInstanceEnd:Ee}=ve;l.push({sortKey:De,symbolInstanceStart:He,symbolInstanceEnd:Ee,parameters:ye})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:ye})}attemptAnchorPlacement(l,f,y,w,E,T,M,L,B,$,G,Z,Q,ne,ie,oe,se,me){const{textOffset0:ge,textOffset1:_e,crossTileID:Pe}=Z,Te=[ge,_e],pe=My(l,y,w,Te,E),ye=this.collisionIndex.placeCollisionBox(ne,E,f,Wf(pe.x,pe.y,T,M,this.transform.angle),G,L,B,$.predicate);if(oe){const ve=ne.getSymbolInstanceIconSize(me,this.transform.zoom,Z.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ne,ve,oe,Wf(pe.x,pe.y,T,M,this.transform.angle),G,L,B,$.predicate).box.length===0)return}if(ye.box.length>0){let ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(ve=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:Te,width:y,height:w,anchor:l,textScale:E,prevAnchor:ve},this.markUsedJustification(ne,l,Z,ie),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,ie,Z),this.placedOrientations[Pe]=ie),{shift:pe,placedGlyphBoxes:ye}}}placeLayerBucketPart(l,f,y,w){const{bucket:E,layout:T,posMatrix:M,textLabelPlaneMatrix:L,labelToScreenMatrix:B,clippingData:$,textPixelRatio:G,holdingForFade:Z,collisionBoxArray:Q,partiallyEvaluatedTextSize:ne,partiallyEvaluatedIconSize:ie,collisionGroup:oe}=l.parameters,se=T.get("text-optional"),me=T.get("icon-optional"),ge=T.get("text-allow-overlap"),_e=T.get("icon-allow-overlap"),Pe=T.get("text-rotation-alignment")==="map",Te=T.get("text-pitch-alignment")==="map",pe=T.get("symbol-z-order")==="viewport-y",ye=T.get("symbol-z-elevate");this.transform.setProjection(E.projection);let ve=ge&&(_e||!E.hasIconData()||me),De=_e&&(ge||!E.hasTextData()||se);!E.collisionArrays&&Q&&E.deserializeCollisionBoxes(Q),y&&w&&E.updateCollisionDebugBuffers(this.transform.zoom,Q);const He=(Ee,Ge,Qe)=>{const{crossTileID:_t,numVerticalGlyphVertices:xt}=Ee;if($){const In={zoom:this.transform.zoom,pitch:this.transform.pitch};let en=null;if($.dynamicFilterNeedsFeature){const Br=this.retainedQueryData[E.bucketInstanceId];en=$.featureIndex.loadFeature({featureIndex:Ee.featureIndex,bucketIndex:Br.bucketIndex,sourceLayerIndex:Br.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(In,en,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new a.P(Ee.tileAnchorX,Ee.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[_t]=new Zm(!1,!1,!1,!0),void f.add(_t)}if(f.has(_t))return;if(Z)return void(this.placements[_t]=new Zm(!1,!1,!1));let gt=!1,Ue=!1,rt=!0,pt=!1,Ft=!1,zt=null,Gt={box:null,offscreen:null,occluded:null},Nt={box:null,offscreen:null,occluded:null},St=null,ut=null,tr=null,$r=0,Rr=0,Zr=0;Qe.textFeatureIndex?$r=Qe.textFeatureIndex:Ee.useRuntimeCollisionCircles&&($r=Ee.featureIndex),Qe.verticalTextFeatureIndex&&(Rr=Qe.verticalTextFeatureIndex);const ln=In=>{In.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const en=this.transform.elevation;In.elevation=Ee.zOffset+(en?en.getAtTileOffset(In.tileID,In.tileAnchorX,In.tileAnchorY):0)},Pn=Qe.textBox;if(Pn){ln(Pn);const In=Br=>{let Xn=a.aE.horizontal;if(E.allowVerticalPlacement&&!Br&&this.prevPlacement){const Jn=this.prevPlacement.placedOrientations[_t];Jn&&(this.placedOrientations[_t]=Jn,Xn=Jn,this.markUsedOrientation(E,Xn,Ee))}return Xn},en=(Br,Xn)=>{if(E.allowVerticalPlacement&&xt>0&&Qe.verticalTextBox){for(const Jn of E.writingModes)if(Jn===a.aE.vertical?(Gt=Xn(),Nt=Gt):Gt=Br(),Gt&&Gt.box&&Gt.box.length)break}else Gt=Br()};if(T.get("text-variable-anchor")){let Br=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[_t]){const Dn=this.prevPlacement.variableOffsets[_t];Br.indexOf(Dn.anchor)>0&&(Br=Br.filter(yt=>yt!==Dn.anchor),Br.unshift(Dn.anchor))}const Xn=(Dn,yt,jt)=>{const ui=E.getSymbolInstanceTextSize(ne,Ee,this.transform.zoom,Ge),Sn=(Dn.x2-Dn.x1)*ui+2*Dn.padding,Ve=(Dn.y2-Dn.y1)*ui+2*Dn.padding,qs=Ee.hasIconTextFit&&!_e?yt:null;qs&&ln(qs);let Po={box:[],offscreen:!1,occluded:!1};const Jo=ge?2*Br.length:Br.length;for(let co=0;co<Jo;++co){const ys=this.attemptAnchorPlacement(Br[co%Br.length],Dn,Sn,Ve,ui,Pe,Te,G,M,oe,co>=Br.length,Ee,Ge,E,jt,qs,ne,ie);if(ys&&(Po=ys.placedGlyphBoxes,Po&&Po.box&&Po.box.length)){gt=!0,zt=ys.shift;break}}return Po};en(()=>Xn(Pn,Qe.iconBox,a.aE.horizontal),()=>{const Dn=Qe.verticalTextBox;return Dn&&ln(Dn),E.allowVerticalPlacement&&!(Gt&&Gt.box&&Gt.box.length)&&xt>0&&Dn?Xn(Dn,Qe.verticalIconBox,a.aE.vertical):{box:null,offscreen:null,occluded:null}}),Gt&&(gt=Gt.box,rt=Gt.offscreen,pt=Gt.occluded);const Jn=In(!(!Gt||!Gt.box));if(!gt&&this.prevPlacement){const Dn=this.prevPlacement.variableOffsets[_t];Dn&&(this.variableOffsets[_t]=Dn,this.markUsedJustification(E,Dn.anchor,Ee,Jn))}}else{const Br=(Xn,Jn)=>{const Dn=E.getSymbolInstanceTextSize(ne,Ee,this.transform.zoom,Ge),yt=this.collisionIndex.placeCollisionBox(E,Dn,Xn,new a.P(0,0),ge,G,M,oe.predicate);return yt&&yt.box&&yt.box.length&&(this.markUsedOrientation(E,Jn,Ee),this.placedOrientations[_t]=Jn),yt};en(()=>Br(Pn,a.aE.horizontal),()=>{const Xn=Qe.verticalTextBox;return E.allowVerticalPlacement&&xt>0&&Xn?(ln(Xn),Br(Xn,a.aE.vertical)):{box:null,offscreen:null,occluded:null}}),In(!!(Gt&&Gt.box&&Gt.box.length))}}if(St=Gt,gt=St&&St.box&&St.box.length>0,rt=St&&St.offscreen,pt=St&&St.occluded,Ee.useRuntimeCollisionCircles){const In=E.text.placedSymbolArray.get(Ee.centerJustifiedTextSymbolIndex>=0?Ee.centerJustifiedTextSymbolIndex:Ee.verticalPlacedTextSymbolIndex),en=a.aF(E.textSizeData,ne,In),Br=T.get("text-padding");ut=this.collisionIndex.placeCollisionCircles(E,ge,In,E.lineVertexArray,E.glyphOffsetArray,en,M,L,B,y,Te,oe.predicate,Ee.collisionCircleDiameter*en/a.bN,Br,this.retainedQueryData[E.bucketInstanceId].tileID),gt=ge||ut.circles.length>0&&!ut.collisionDetected,rt=rt&&ut.offscreen,pt=ut.occluded}if(Qe.iconFeatureIndex&&(Zr=Qe.iconFeatureIndex),Qe.iconBox){const In=en=>{ln(en);const Br=Ee.hasIconTextFit&&zt?Wf(zt.x,zt.y,Pe,Te,this.transform.angle):new a.P(0,0),Xn=E.getSymbolInstanceIconSize(ie,this.transform.zoom,Ee.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Xn,en,Br,_e,G,M,oe.predicate)};Nt&&Nt.box&&Nt.box.length&&Qe.verticalIconBox?(tr=In(Qe.verticalIconBox),Ue=tr.box.length>0):(tr=In(Qe.iconBox),Ue=tr.box.length>0),rt=rt&&tr.offscreen,Ft=tr.occluded}const Mr=se||Ee.numHorizontalGlyphVertices===0&&xt===0,En=me||Ee.numIconVertices===0;if(Mr||En?En?Mr||(Ue=Ue&&gt):gt=Ue&&gt:Ue=gt=Ue&&gt,gt&&St&&St.box&&this.collisionIndex.insertCollisionBox(St.box,T.get("text-ignore-placement"),E.bucketInstanceId,Nt&&Nt.box&&Rr?Rr:$r,oe.ID),Ue&&tr&&this.collisionIndex.insertCollisionBox(tr.box,T.get("icon-ignore-placement"),E.bucketInstanceId,Zr,oe.ID),ut&&(gt&&this.collisionIndex.insertCollisionCircles(ut.circles,T.get("text-ignore-placement"),E.bucketInstanceId,$r,oe.ID),y)){const In=E.bucketInstanceId;let en=this.collisionCircleArrays[In];en===void 0&&(en=this.collisionCircleArrays[In]=new Ib);for(let Br=0;Br<ut.circles.length;Br+=4)en.circles.push(ut.circles[Br+0]),en.circles.push(ut.circles[Br+1]),en.circles.push(ut.circles[Br+2]),en.circles.push(ut.collisionDetected?1:0)}const Un=E.projection.name!=="globe";ve=ve&&(Un||!pt),De=De&&(Un||!Ft),this.placements[_t]=new Zm(gt||ve,Ue||De,rt||E.justReloaded),f.add(_t)};if(ye&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),pe){const Ee=E.getSortedSymbolIndexes(this.transform.angle);for(let Ge=Ee.length-1;Ge>=0;--Ge){const Qe=Ee[Ge];He(E.symbolInstances.get(Qe),Qe,E.collisionArrays[Qe])}E.hasAnyZOffset&&a.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const Ee=E.getSortedIndexesByZOffset();for(let Ge=0;Ge<Ee.length;++Ge){const Qe=Ee[Ge];He(E.symbolInstances.get(Qe),Qe,E.collisionArrays[Qe])}}else for(let Ee=l.symbolInstanceStart;Ee<l.symbolInstanceEnd;Ee++)He(E.symbolInstances.get(Ee),Ee,E.collisionArrays[Ee]);if(y&&E.bucketInstanceId in this.collisionCircleArrays){const Ee=this.collisionCircleArrays[E.bucketInstanceId];a.ad.invert(Ee.invProjMatrix,M),Ee.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(l,f,y,w){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:L,crossTileID:B}=y,$=a.cJ(f),G=w===a.aE.vertical?L:$==="left"?E:$==="center"?T:$==="right"?M:-1;E>=0&&(l.text.placedSymbolArray.get(E).crossTileID=G>=0&&E!==G?0:B),T>=0&&(l.text.placedSymbolArray.get(T).crossTileID=G>=0&&T!==G?0:B),M>=0&&(l.text.placedSymbolArray.get(M).crossTileID=G>=0&&M!==G?0:B),L>=0&&(l.text.placedSymbolArray.get(L).crossTileID=G>=0&&L!==G?0:B)}markUsedOrientation(l,f,y){const w=f===a.aE.horizontal||f===a.aE.horizontalOnly?f:0,E=f===a.aE.vertical?f:0,{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:B}=y,$=l.text.placedSymbolArray;T>=0&&($.get(T).placedOrientation=w),M>=0&&($.get(M).placedOrientation=w),L>=0&&($.get(L).placedOrientation=w),B>=0&&($.get(B).placedOrientation=E)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const w=f?f.symbolFadeChange(l):1,E=f?f.opacities:{},T=f?f.variableOffsets:{},M=f?f.placedOrientations:{};for(const L in this.placements){const B=this.placements[L],$=E[L];$?(this.opacities[L]=new kc($,w,B.text,B.icon,null,B.clipped),y=y||B.text!==$.text.placed||B.icon!==$.icon.placed):(this.opacities[L]=new kc(null,w,B.text,B.icon,B.skipFade,B.clipped),y=y||B.text||B.icon)}for(const L in E){const B=E[L];if(!this.opacities[L]){const $=new kc(B,w,!1,!1);$.isHidden()||(this.opacities[L]=$,y=y||B.text.placed||B.icon.placed)}}for(const L in T)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=T[L]);for(const L in M)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=M[L]);y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)}updateLayerOpacities(l,f,y,w){const E=new Set;for(const T of f){const M=T.getBucket(l);M&&T.latestFeatureIndex&&l.fqid===M.layerIds[0]&&(this.updateBucketOpacities(M,E,T.collisionBoxArray,y,w,T.tileID),M.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(M,T.tileID),M.updateZOffset()))}}updateBucketOpacities(l,f,y,w,E,T){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const M=l.layers[0].layout,L=!!l.layers[0].dynamicFilter(),B=new kc(null,0,!1,!1,!0),$=M.get("text-allow-overlap"),G=M.get("icon-allow-overlap"),Z=M.get("text-variable-anchor"),Q=M.get("text-rotation-alignment")==="map",ne=M.get("text-pitch-alignment")==="map",ie=new kc(null,0,$&&(G||!l.hasIconData()||M.get("icon-optional")),G&&($||!l.hasTextData()||M.get("text-optional")),!0);!l.collisionArrays&&y&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(y);const oe=(me,ge,_e)=>{for(let Pe=0;Pe<ge/4;Pe++)me.opacityVertexArray.emplaceBack(_e)};let se=0;E&&l.updateReplacement(T,E);for(let me=0;me<l.symbolInstances.length;me++){const ge=l.symbolInstances.get(me),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:Pe,crossTileID:Te,numIconVertices:pe,tileAnchorX:ye,tileAnchorY:ve}=ge,De=f.has(Te);let He=this.opacities[Te];De?He=B:He||(He=ie,this.opacities[Te]=He),f.add(Te);const Ee=_e>0||Pe>0,Ge=pe>0,Qe=this.placedOrientations[Te],_t=Qe===a.aE.vertical,xt=Qe===a.aE.horizontal||Qe===a.aE.horizontalOnly;!Ee&&!Ge||He.isHidden()||se++;let gt=!1;if((Ee||Ge)&&E)for(const Ue of l.activeReplacements){if(Ue.order<w||Ue.order===1/0||!(Ue.clipMask&a.cu.Symbol)||Ue.min.x>ye||ye>Ue.max.x||Ue.min.y>ve||ve>Ue.max.y)continue;const rt=a.cH(ye,ve,T.canonical,Ue.footprintTileId.canonical);if(gt=a.cI(rt,Ue),gt)break}if(Ee){const Ue=gt?Dc:ul(He.text);oe(l.text,_e,_t?Dc:Ue),oe(l.text,Pe,xt?Dc:Ue);const rt=He.text.isHidden(),{leftJustifiedTextSymbolIndex:pt,centerJustifiedTextSymbolIndex:Ft,rightJustifiedTextSymbolIndex:zt,verticalPlacedTextSymbolIndex:Gt}=ge,Nt=l.text.placedSymbolArray,St=rt||_t?1:0;pt>=0&&(Nt.get(pt).hidden=St),Ft>=0&&(Nt.get(Ft).hidden=St),zt>=0&&(Nt.get(zt).hidden=St),Gt>=0&&(Nt.get(Gt).hidden=rt||xt?1:0);const ut=this.variableOffsets[Te];ut&&this.markUsedJustification(l,ut.anchor,ge,Qe);const tr=this.placedOrientations[Te];tr&&(this.markUsedJustification(l,"left",ge,tr),this.markUsedOrientation(l,tr,ge))}if(Ge){const Ue=gt?Dc:ul(He.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:pt}=ge,Ft=l.icon.placedSymbolArray,zt=He.icon.isHidden()?1:0;rt>=0&&(oe(l.icon,pe,_t?Dc:Ue),Ft.get(rt).hidden=zt),pt>=0&&(oe(l.icon,ge.numVerticalIconVertices,xt?Dc:Ue),Ft.get(pt).hidden=zt)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const Ue=l.collisionArrays[me];if(Ue){let rt=new a.P(0,0),pt=!0;if(Ue.textBox||Ue.verticalTextBox){if(Z){const zt=this.variableOffsets[Te];zt?(rt=My(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textScale),Q&&rt._rotate(ne?this.transform.angle:-this.transform.angle)):pt=!1}L&&(pt=!He.clipped),Ue.textBox&&qf(l.textCollisionBox.collisionVertexArray,He.text.placed,!pt||_t,rt.x,rt.y),Ue.verticalTextBox&&qf(l.textCollisionBox.collisionVertexArray,He.text.placed,!pt||xt,rt.x,rt.y)}const Ft=pt&&!!(!xt&&Ue.verticalIconBox);Ue.iconBox&&qf(l.iconCollisionBox.collisionVertexArray,He.icon.placed,Ft,ge.hasIconTextFit?rt.x:0,ge.hasIconTextFit?rt.y:0),Ue.verticalIconBox&&qf(l.iconCollisionBox.collisionVertexArray,He.icon.placed,!Ft,ge.hasIconTextFit?rt.x:0,ge.hasIconTextFit?rt.y:0)}}}if(l.fullyClipped=se===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=me.invProjMatrix,l.placementViewportMatrix=me.viewportMatrix,l.collisionCircleArray=me.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function qf(g,l,f,y,w){g.emplaceBack(l?1:0,f?1:0,y||0,w||0),g.emplaceBack(l?1:0,f?1:0,y||0,w||0),g.emplaceBack(l?1:0,f?1:0,y||0,w||0),g.emplaceBack(l?1:0,f?1:0,y||0,w||0)}const Py=Math.pow(2,25),Bt=Math.pow(2,24),Mb=Math.pow(2,17),Ry=Math.pow(2,16),ky=Math.pow(2,9),Pb=Math.pow(2,8),Xm=Math.pow(2,1);function ul(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const l=g.placed?1:0,f=Math.floor(127*g.opacity);return f*Py+l*Bt+f*Mb+l*Ry+f*ky+l*Pb+f*Xm+l}const Dc=0;class Pu{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,f,y,w,E){const T=this._bucketParts;for(;this._currentTileIndex<l.length;)if(f.getBucketParts(T,w,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((M,L)=>M.sortKey-L.sortKey));this._currentPartIndex<T.length;){const M=T[this._currentPartIndex];if(f.placeLayerBucketPart(M,this._seenCrossTileIDs,y,M.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Qm{constructor(l,f,y,w,E,T,M,L,B){this.placement=new aa(l,E,T,M,L,B),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(l,f,y,w){const E=a.e.now(),T=()=>{const M=a.e.now()-E;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=f[l[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=L)&&(!M.maxzoom||M.maxzoom>L)){const B=M,$=B.layout.get("symbol-z-elevate"),G=this._inProgressLayer=this._inProgressLayer||new Pu(B),Z=a.al(M.source,M.scope);if(G.continuePlacement($?w[Z]:y[Z],this.placement,this._showCollisionBoxes,M,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Oc=512/a.a3/2;class gI{constructor(l,f,y){this.tileID=l,this.bucketInstanceId=y,this.index=new a.cK(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=l.canonical.x*a.a3,E=l.canonical.y*a.a3;for(let T=0;T<f.length;T++){const{key:M,crossTileID:L,tileAnchorX:B,tileAnchorY:$}=f.get(T),G=Math.floor((w+B)*Oc),Z=Math.floor((E+$)*Oc);this.index.add(G,Z),this.keys.push(M),this.crossTileIDs.push(L)}this.index.finish()}findMatches(l,f,y){const w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=Oc/Math.pow(2,f.canonical.z-this.tileID.canonical.z),T=f.canonical.x*a.a3,M=f.canonical.y*a.a3;for(let L=0;L<l.length;L++){const B=l.get(L);if(B.crossTileID)continue;const{key:$,tileAnchorX:G,tileAnchorY:Z}=B,Q=Math.floor((T+G)*E),ne=Math.floor((M+Z)*E),ie=this.index.range(Q-w,ne-w,Q+w,ne+w);for(const oe of ie){const se=this.crossTileIDs[oe];if(this.keys[oe]===$&&!y.has(se)){y.add(se),B.crossTileID=se;break}}}}}class _I{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Dy{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const f=Math.round((l-this.lng)/360);if(f!==0)for(const y in this.indexes){const w=this.indexes[y],E={};for(const T in w){const M=w[T];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+f),E[M.tileID.key]=M}this.indexes[y]=E}this.lng=l}addBucket(l,f,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let E=0;E<f.symbolInstances.length;E++)f.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const w=this.usedCrossTileIDs[l.overscaledZ];for(const E in this.indexes){const T=this.indexes[E];if(Number(E)>l.overscaledZ)for(const M in T){const L=T[M];L.tileID.isChildOf(l)&&L.findMatches(f.symbolInstances,l,w)}else{const M=T[l.scaledTo(Number(E)).key];M&&M.findMatches(f.symbolInstances,l,w)}}for(let E=0;E<f.symbolInstances.length;E++){const T=f.symbolInstances.get(E);T.crossTileID||(T.crossTileID=y.generate(),w.add(T.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new gI(l,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(l,f){for(const y of f.crossTileIDs)this.usedCrossTileIDs[l].delete(y)}removeStaleBuckets(l){let f=!1;for(const y in this.indexes){const w=this.indexes[y];for(const E in w)l[w[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[E]),delete w[E],f=!0)}return f}}class yI{constructor(){this.layerIndexes={},this.crossTileIDs=new _I,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,f,y,w){let E=this.layerIndexes[l.fqid];E===void 0&&(E=this.layerIndexes[l.fqid]=new Dy);let T=!1;const M={};w.name!=="globe"&&E.handleWrapJump(y);for(const L of f){const B=L.getBucket(l);B&&l.fqid===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(L.tileID,B,this.crossTileIDs)&&(T=!0),M[B.bucketInstanceId]=!0)}return E.removeStaleBuckets(M)&&(T=!0),T}pruneUnusedLayers(l){const f={};l.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const Rb=new a.N({data:new a.O(a.L.colorTheme.data)}),Lc=(g,l)=>Ar(g,l&&l.filter(f=>f.identifier!=="source.canvas")),Oy=a.ah(hn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),vI=a.ah(hn,["setCenter","setZoom","setBearing","setPitch"]),kb={version:8,layers:[],sources:{}},Db={duration:300,delay:0};class Ra extends a.E{constructor(l,f={}){super(),this.map=l,this.scope=f.scope||"",this.globalId=null,this.fragments=[],this.importDepth=f.importDepth||0,this.importsCache=f.importsCache||new Map,this.resolvedImports=f.resolvedImports||new Set,this.transition=a.W({},Db),this._buildingIndex=new fI(this),this.crossTileSymbolIndex=new yI,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=f.styleChanges||new Ce,this.dispatcher=f.dispatcher?f.dispatcher:new a.bw(a.bx(),this),f.imageManager?this.imageManager=f.imageManager:(this.imageManager=new Is,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=f.glyphManager?f.glyphManager:new a.cM(l._requestManager,f.localFontFamily?a.cN.all:f.localIdeographFontFamily?a.cN.ideographs:a.cN.none,f.localFontFamily||f.localIdeographFontFamily),f.modelManager?this.modelManager=f.modelManager:(this.modelManager=new Hn(l._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,colorTheme:null},this._styleColorThemeForScope={},this.options=f.configOptions?f.configOptions:new Map,this._configDependentLayers=f.configDependentLayers?f.configDependentLayers:new Set,this._config=f.config,this._initialConfig=f.initialConfig,this.dispatcher.broadcast("setReferrer",a.cO());const y=this;this._rtlTextPluginCallback=Ra.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(E,T)=>{if(a.cP(E),T&&T.every(M=>M))for(const M in y._sourceCaches){const L=y._sourceCaches[M],B=L.getSource().type;B!=="vector"&&B!=="geojson"||L.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const E=this.getOwnSource(w.sourceId);if(E&&E.vectorLayerIds)for(const T in this._layers){const M=this._layers[T];M.source===E.id&&this._validateLayer(M)}})}load(l){return l?(typeof l=="string"?this.loadURL(l):this.loadJSON(l),this):this}_getGlobalId(l){if(!l)return null;if(typeof l=="string"){if(a.cQ(l))return l;const f=a.cR(l);if(!f.startsWith("http"))try{return new URL(f,location.href).toString()}catch{return f}return f}return`json://${a.cS(JSON.stringify(l))}`}_diffStyle(l,f,y){this.globalId=this._getGlobalId(l);const w=(E,T)=>{try{T(null,this.setState(E,y))}catch(M){T(M,!1)}};if(typeof l=="string"){const E=this.map._requestManager.normalizeStyleURL(l),T=this.map._requestManager.transformRequest(E,a.R.Style);a.g(T,(M,L)=>{M?this.fire(new a.d(M)):L&&w(L,f)})}else typeof l=="object"&&w(l,f)}loadURL(l,f={}){this.fire(new a.f("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!a.cQ(l);this.globalId=this._getGlobalId(l),l=this.map._requestManager.normalizeStyleURL(l,f.accessToken),this.resolvedImports.add(l);const w=this.importsCache.get(l);if(w)return this._load(w,y);const E=this.map._requestManager.transformRequest(l,a.R.Style);this._request=a.g(E,(T,M)=>{if(this._request=null,T)this.fire(new a.d(T));else if(M)return this.importsCache.set(l,M),this._load(M,y)})}loadJSON(l,f={}){this.fire(new a.f("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(l),this._request=a.e.frame(()=>{this._request=null,this._load(l,f.validate!==!1)})}loadEmpty(){this.fire(new a.f("dataloading",{dataType:"style"})),this._load(kb,!1)}_loadImports(l,f,y){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const E of l){const T=this._createFragmentStyle(E),M=new Promise($=>{T.once("style.import.load",$),T.once("error",$)}).then(()=>this.mergeAll());if(w.push(M),this.resolvedImports.has(E.url)){T.loadEmpty();continue}const L=E.data||this.importsCache.get(E.url);L?(T.loadJSON(L,{validate:f}),this._isInternalStyle(L)&&(T.globalId=null)):E.url?T.loadURL(E.url,{validate:f}):T.loadEmpty();const B={style:T,id:E.id,config:E.config};if(y){const $=this.fragments.findIndex(({id:G})=>G===y);this.fragments=this.fragments.slice(0,$).concat(B).concat(this.fragments.slice($))}else this.fragments.push(B)}return Promise.allSettled(w)}getImportGlobalIds(l=this,f=new Set){for(const y of l.fragments)y.style.globalId&&f.add(y.style.globalId),this.getImportGlobalIds(y.style,f);return[...f.values()]}_createFragmentStyle(l){const f=this.scope?a.al(l.id,this.scope):l.id;let y;const w=this._initialConfig&&this._initialConfig[f];(l.config||w)&&(y=a.W({},l.config,w));const E=new Ra(this.map,{scope:f,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,configDependentLayers:this._configDependentLayers});return E.setEventedParent(this.map,{style:E}),E}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(l){return this.isRootStyle()&&(l.fragment||!!l.schema&&l.fragment!==!1)}_load(l,f){const y=l.schema;if(this._isInternalStyle(l)){const T=a.W({},kb,{imports:[{id:"basemap",data:l,url:""}]});return void this._load(T,f)}if(this.updateConfig(this._config,y),f&&Lc(this,we(l)))return;this._loaded=!0,this.stylesheet=a.cT(l);const w=()=>{for(const B in l.sources)this.addSource(B,l.sources[B],{validate:!1,isInitialLoad:!0});l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(l.glyphs,this.scope);const T=Ay(this.stylesheet.layers);if(this._order=T.map(B=>B.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const B=this.stylesheet.lights[0];this.light=new Qt(B.properties,B.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Qt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const B of T){const $=a.cY(B,this.scope,this._styleColorTheme.lut,this.options);$.isConfigDependent&&this._configDependentLayers.add($.fqid),$.setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$,this._serializedLayers[$.id]=$.serialize();const G=this.getOwnLayerSourceCache($),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();G&&$.canCastShadows()&&Z&&(G.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const M=this.stylesheet.terrain;M&&(this.checkCanvasFingerprintNoise(),this.terrainSetForDrapingOnly()||this._createTerrain(M,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.f("data",{dataType:"style"}));const L=this.isRootStyle();l.imports?this._loadImports(l.imports,f).then(()=>{this._reloadImports(),this.fire(new a.f(L?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.f(L?"style.load":"style.import.load")))},E=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=E,E){const T=this._evaluateColorThemeData(E);this._loadColorTheme(T).then(()=>{w()}).catch(M=>{a.w(`Couldn't load color theme from the stylesheet: ${M}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let l,f,y,w,E,T,M,L;const B={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle($=>{if($.stylesheet){if($.light!=null&&(l=$.light),$.stylesheet.lights)for(const G of $.stylesheet.lights)G.type==="ambient"&&$.ambientLight!=null&&(f=$.ambientLight),G.type==="directional"&&$.directionalLight!=null&&(y=$.directionalLight);w=this._prioritizeTerrain(w,$.terrain,$.stylesheet.terrain),$.stylesheet.fog&&$.fog!=null&&(E=$.fog),$.stylesheet.camera!=null&&(L=$.stylesheet.camera),$.stylesheet.projection!=null&&(T=$.stylesheet.projection),$.stylesheet.transition!=null&&(M=$.stylesheet.transition),B[$.scope]=$._styleColorTheme}}),this.light=l,this.ambientLight=f,this.directionalLight=y,this.fog=E,this._styleColorThemeForScope=B,w===null?delete this.terrain:this.terrain=w,this.camera=L||{"camera-projection":"perspective"},this.projection=T||{name:"mercator"},this.transition=a.W({},Db,M),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(l){const f=y=>{for(const w of y.fragments)f(w.style);l(y)};f(this)}_prioritizeTerrain(l,f,y){const w=l&&l.drapeRenderMode===0;return y===null?f&&f.drapeRenderMode===0?f:w?l:null:f!=null&&(!l||w||f&&f.drapeRenderMode===1)?f:l}mergeTerrain(){let l;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(f=>{l=this._prioritizeTerrain(l,f.terrain,f.stylesheet.terrain)}),l===null?delete this.terrain:this.terrain=l}mergeProjection(){let l;this.forEachFragmentStyle(f=>{f.stylesheet.projection!=null&&(l=f.stylesheet.projection)}),this.projection=l||{name:"mercator"}}mergeSources(){const l={},f={},y={};this.forEachFragmentStyle(w=>{for(const E in w._sourceCaches){const T=a.al(E,w.scope);l[T]=w._sourceCaches[E]}for(const E in w._otherSourceCaches){const T=a.al(E,w.scope);f[T]=w._otherSourceCaches[E]}for(const E in w._symbolSourceCaches){const T=a.al(E,w.scope);y[T]=w._symbolSourceCaches[E]}}),this._mergedSourceCaches=l,this._mergedOtherSourceCaches=f,this._mergedSymbolSourceCaches=y}mergeLayers(){const l={},f=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(T=>{for(const M of T._order){const L=T._layers[M];if(L.type==="slot"){const B=a.cU(M);if(l[B])continue;l[B]=[]}L.slot&&l[L.slot]?l[L.slot].push(L):f.push(L)}}),this._mergedOrder=[],this._clipLayerIndices=[];let w=0;const E=(T=[])=>{for(const M of T)if(M.type==="slot"){const L=a.cU(M.id);l[L]&&E(l[L]),this._mergedSlots.push(L)}else{const L=a.al(M.id,M.scope);this._mergedOrder.push(L),y[L]=M,M.is3D()&&(this._has3DLayers=!0),M.type==="circle"&&(this._hasCircleLayers=!0),M.type==="symbol"&&(this._hasSymbolLayers=!0),M.type==="clip"&&this._clipLayerIndices.push(w),w++}};E(f),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(l){return this.stylesheet.camera=a.W({},this.stylesheet.camera,l),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(l){return l.data?function(f,y,w){const E=a.W({},y);for(const M of Object.keys(a.L.colorTheme))E[M]===void 0&&(E[M]=a.L.colorTheme[M].default);const T=new a.U(Rb,f,new Map(w));return T.setTransitionOrValue(E,w),T.untransitioned().possiblyEvaluate(new a.X(0))}(this.scope,l,this.options).get("data"):null}_loadColorTheme(l){return this._styleColorTheme.lutLoading=!0,new Promise((f,y)=>{const w="data:image/png;base64,";if(l.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void f();l.startsWith(w)||(l=w+l);const E="mapbox-reserved-lut",T=new Image;T.src=l,T.onerror=()=>{this._styleColorTheme.lutLoading=!1,y(new Error("Failed to load image data"))},T.onload=()=>{this._styleColorTheme.lutLoading=!1;const{width:M,height:L,data:B}=a.e.getImageData(T);if(L>32)return void y(new Error("The height of the image must be less than or equal to 32 pixels."));if(M!==L*L)return void y(new Error("The width of the image must be equal to the height squared."));this.getImage(E)&&this.removeImage(E),this.addImage(E,{data:new a.i({width:M,height:L},B),pixelRatio:1,sdf:!1,version:0});const $=this.imageManager.getImage(E,this.scope);$?(this._styleColorTheme.lut={image:$.data,data:l},f()):y(new Error("Missing LUT image."))}})}getLut(l){const f=this._styleColorThemeForScope[l];return f?f.lut:null}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(l){this._spriteRequest=function(f,y,w){let E,T,M;const L=a.e.devicePixelRatio>1?"@2x":"";let B=a.g(y.transformRequest(y.normalizeSpriteURL(f,L,".json"),a.R.SpriteJSON),(Z,Q)=>{B=null,M||(M=Z,E=Q,G())}),$=a.h(y.transformRequest(y.normalizeSpriteURL(f,L,".png"),a.R.SpriteImage),(Z,Q)=>{$=null,M||(M=Z,T=Q,G())});function G(){if(M)w(M);else if(E&&T){const Z=a.e.getImageData(T),Q={};for(const ne in E){const{width:ie,height:oe,x:se,y:me,sdf:ge,pixelRatio:_e,stretchX:Pe,stretchY:Te,content:pe}=E[ne],ye=new a.i({width:ie,height:oe});a.i.copy(Z,ye,{x:se,y:me},{x:0,y:0},{width:ie,height:oe},null),Q[ne]={data:ye,pixelRatio:_e,sdf:ge,stretchX:Pe,stretchY:Te,content:pe}}w(null,Q)}}return{cancel(){B&&(B.cancel(),B=null),$&&($.cancel(),$=null)}}}(l,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new a.d(f));else if(y)for(const w in y)this.imageManager.addImage(w,this.scope,y[w]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.f("data",{dataType:"style"}))})}_validateLayer(l){const f=this.getOwnSource(l.source);if(!f)return;const y=l.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.d(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:l}of this.fragments)if(!l.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((l,f)=>{const y=this.fragments[f];return y&&y.style&&(l.data=y.style.serialize()),l})}_serializeSources(){const l={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();l[y.id]||(l[y.id]=y.serialize())}return l}_serializeLayers(l){const f=[];for(const y of l){const w=this._layers[y];w&&w.type!=="custom"&&f.push(w.serialize())}return f}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(l){return!!this.terrain&&l.isDraped(this.getLayerSourceCache(l))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(l){const f=this.getOwnLayer(l);if(f)return f;this.fire(new a.d(new Error(`The layer '${l}' does not exist in the map's style.`)))}_checkSource(l){const f=this.getOwnSource(l);if(f)return f;this.fire(new a.d(new Error(`The source '${l}' does not exist in the map's style.`)))}update(l){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l);const f=this.calculateLightsBrightness();l.brightness=f||0,f!==this._brightness&&(this._brightness=f,this.dispatcher.broadcast("setBrightness",f));const y=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const T=this._changes.getLayerUpdatesByScope();for(const M in T){const{updatedIds:L,removedIds:B}=T[M];(L||B)&&(this._updateWorkerLayers(M,L,B),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(l),this.light&&this.light.updateTransitions(l),this.ambientLight&&this.ambientLight.updateTransitions(l),this.directionalLight&&this.directionalLight.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._changes.reset()}const E={};for(const T in this._mergedSourceCaches){const M=this._mergedSourceCaches[T];E[T]=M.used,M.used=!1,M.tileCoverLift=0}for(const T of this._mergedOrder){const M=this._mergedLayers[T];if(M.recalculate(l,this._availableImages),!M.isHidden(l.zoom)){const L=this.getLayerSourceCache(M);L&&(L.used=!0,L.tileCoverLift=Math.max(L.tileCoverLift,M.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let L=M.minzoom||0;L<(M.maxzoom||25.5);L++){const B=this.map.painter;if(B){const $=M.getProgramIds();if(!$)continue;for(const G of $){const Z=M.getDefaultProgramParams(G,l.zoom,this._styleColorTheme.lut);Z&&(B.style=this,this.fog&&(B._fogVisible=!0,Z.overrideFog=!0,B.getOrCreateProgram(G,Z)),B._fogVisible=!1,Z.overrideFog=!1,B.getOrCreateProgram(G,Z),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(Z.overrideRtt=!0,B.getOrCreateProgram(G,Z)))}}}}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();for(const T in E){const M=this._mergedSourceCaches[T];E[T]!==M.used&&M.getSource().fire(new a.f("data",{sourceDataType:"visibility",dataType:"source",sourceId:M.getSource().id}))}this.light&&this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new a.f("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=this._changes.getUpdatedImages();if(l.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],l);this._changes.resetUpdatedImages()}}_updateWorkerLayers(l,f,y){const w=this.getFragmentStyle(l);w&&this.dispatcher.broadcast("updateLayers",{layers:f?w._serializeLayers(f):[],scope:l,removedIds:y||[],options:w.options})}setState(l,f){if(this._checkLoaded(),Lc(this,we(l)))return!1;(l=a.cT(l)).layers=Ay(l.layers);const y=function(T,M){if(!T)return[{command:hn.setStyle,args:[M]}];let L=[];try{if(!C(T.version,M.version))return[{command:hn.setStyle,args:[M]}];if(C(T.center,M.center)||L.push({command:hn.setCenter,args:[M.center]}),C(T.zoom,M.zoom)||L.push({command:hn.setZoom,args:[M.zoom]}),C(T.bearing,M.bearing)||L.push({command:hn.setBearing,args:[M.bearing]}),C(T.pitch,M.pitch)||L.push({command:hn.setPitch,args:[M.pitch]}),C(T.sprite,M.sprite)||L.push({command:hn.setSprite,args:[M.sprite]}),C(T.glyphs,M.glyphs)||L.push({command:hn.setGlyphs,args:[M.glyphs]}),C(T.imports,M.imports)||function(Q=[],ne=[],ie){ne=ne||[];const oe=(Q=Q||[]).map(Ym),se=ne.map(Ym),me=Q.reduce(Gh,{}),ge=ne.reduce(Gh,{}),_e=oe.slice();let Pe,Te,pe,ye;for(Pe=0,Te=0;Pe<oe.length;Pe++)pe=oe[Pe],ge.hasOwnProperty(pe)?Te++:(ie.push({command:hn.removeImport,args:[pe]}),_e.splice(_e.indexOf(pe,Te),1));for(Pe=0,Te=0;Pe<se.length;Pe++)pe=se[se.length-1-Pe],_e[_e.length-1-Pe]!==pe&&(me.hasOwnProperty(pe)?(ie.push({command:hn.removeImport,args:[pe]}),_e.splice(_e.lastIndexOf(pe,_e.length-Te),1)):Te++,ye=_e[_e.length-Pe],ie.push({command:hn.addImport,args:[ge[pe],ye]}),_e.splice(_e.length-Pe,0,pe));for(const ve of ne){const De=me[ve.id];De&&!C(De,ve)&&ie.push({command:hn.updateImport,args:[ve.id,ve]})}}(T.imports,M.imports,L),C(T.transition,M.transition)||L.push({command:hn.setTransition,args:[M.transition]}),C(T.light,M.light)||L.push({command:hn.setLight,args:[M.light]}),C(T.fog,M.fog)||L.push({command:hn.setFog,args:[M.fog]}),C(T.projection,M.projection)||L.push({command:hn.setProjection,args:[M.projection]}),C(T.lights,M.lights)||L.push({command:hn.setLights,args:[M.lights]}),C(T.camera,M.camera)||L.push({command:hn.setCamera,args:[M.camera]}),!C(T["color-theme"],M["color-theme"]))return[{command:hn.setStyle,args:[M]}];const B={},$=[];(function(Q,ne,ie,oe){let se;for(se in ne=ne||{},Q=Q||{})Q.hasOwnProperty(se)&&(ne.hasOwnProperty(se)||Sb(se,ie,oe));for(se in ne){if(!ne.hasOwnProperty(se))continue;const me=ne[se];Q.hasOwnProperty(se)?C(Q[se],me)||(Q[se].type==="geojson"&&me.type==="geojson"&&mI(Q,ne,se)?ie.push({command:hn.setGeoJSONSourceData,args:[se,me.data]}):pI(se,ne,ie,oe)):Wl(se,ne,ie)}})(T.sources,M.sources,$,B);const G=[];T.layers&&T.layers.forEach(Q=>{Q.source&&B[Q.source]?L.push({command:hn.removeLayer,args:[Q.id]}):G.push(Q)});let Z=T.terrain;Z&&B[Z.source]&&(L.push({command:hn.setTerrain,args:[void 0]}),Z=void 0),L=L.concat($),C(Z,M.terrain)||L.push({command:hn.setTerrain,args:[M.terrain]}),function(Q,ne,ie){ne=ne||[];const oe=(Q=Q||[]).map(Ym),se=ne.map(Ym),me=Q.reduce(Gh,{}),ge=ne.reduce(Gh,{}),_e=oe.slice(),Pe=Object.create(null);let Te,pe,ye,ve,De,He,Ee;for(Te=0,pe=0;Te<oe.length;Te++)ye=oe[Te],ge.hasOwnProperty(ye)?pe++:(ie.push({command:hn.removeLayer,args:[ye]}),_e.splice(_e.indexOf(ye,pe),1));for(Te=0,pe=0;Te<se.length;Te++)ye=se[se.length-1-Te],_e[_e.length-1-Te]!==ye&&(me.hasOwnProperty(ye)?(ie.push({command:hn.removeLayer,args:[ye]}),_e.splice(_e.lastIndexOf(ye,_e.length-pe),1)):pe++,He=_e[_e.length-Te],ie.push({command:hn.addLayer,args:[ge[ye],He]}),_e.splice(_e.length-Te,0,ye),Pe[ye]=!0);for(Te=0;Te<se.length;Te++)if(ye=se[Te],ve=me[ye],De=ge[ye],!Pe[ye]&&!C(ve,De))if(C(ve.source,De.source)&&C(ve["source-layer"],De["source-layer"])&&C(ve.type,De.type)){for(Ee in Vf(ve.layout,De.layout,ie,ye,null,hn.setLayoutProperty),Vf(ve.paint,De.paint,ie,ye,null,hn.setPaintProperty),C(ve.slot,De.slot)||ie.push({command:hn.setSlot,args:[ye,De.slot]}),C(ve.filter,De.filter)||ie.push({command:hn.setFilter,args:[ye,De.filter]}),C(ve.minzoom,De.minzoom)&&C(ve.maxzoom,De.maxzoom)||ie.push({command:hn.setLayerZoomRange,args:[ye,De.minzoom,De.maxzoom]}),ve)ve.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&Ee!=="slot"&&(Ee.indexOf("paint.")===0?Vf(ve[Ee],De[Ee],ie,ye,Ee.slice(6),hn.setPaintProperty):C(ve[Ee],De[Ee])||ie.push({command:hn.setLayerProperty,args:[ye,Ee,De[Ee]]}));for(Ee in De)De.hasOwnProperty(Ee)&&!ve.hasOwnProperty(Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&Ee!=="slot"&&(Ee.indexOf("paint.")===0?Vf(ve[Ee],De[Ee],ie,ye,Ee.slice(6),hn.setPaintProperty):C(ve[Ee],De[Ee])||ie.push({command:hn.setLayerProperty,args:[ye,Ee,De[Ee]]}))}else ie.push({command:hn.removeLayer,args:[ye]}),He=_e[_e.lastIndexOf(ye)+1],ie.push({command:hn.addLayer,args:[De,He]})}(G,M.layers,L)}catch(B){console.warn("Unable to compute style diff:",B),L=[{command:hn.setStyle,args:[M]}]}return L}(this.serialize(),l).filter(T=>!(T.command in vI));if(y.length===0)return!1;const w=y.filter(T=>!(T.command in Oy));if(w.length>0)throw new Error(`Unimplemented: ${w.map(T=>T.command).join(", ")}.`);const E=[];return y.forEach(T=>{E.push(this[T.command].apply(this,T.args))}),f&&Promise.all(E).then(f),this.stylesheet=l,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(l,f){return this.getImage(l)?this.fire(new a.d(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,this.scope,f),this._afterImageUpdated(l),this)}updateImage(l,f){this.imageManager.updateImage(l,this.scope,f)}getImage(l){return this.imageManager.getImage(l,this.scope)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l,this.scope),this._afterImageUpdated(l),this):this.fire(new a.d(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(l),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.f("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(l,f,y={}){return this._checkLoaded(),this._validate(kr,`models.${l}`,f,null,y)||(this.modelManager.addModel(l,f,this.scope),this._changes.setDirty()),this}hasModel(l){return this.modelManager.hasModel(l,this.scope)}removeModel(l){return this.hasModel(l)?(this.modelManager.removeModel(l,this.scope),this):this.fire(new a.d(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(l,f,y={}){if(this._checkLoaded(),this.getOwnSource(l)!==void 0)throw new Error(`There is already a source with ID "${l}".`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(Ie,`sources.${l}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const w=Fm(l,f,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const E=T=>{const M=(T?"symbol:":"other:")+w.id,L=a.al(M,this.scope),B=this._sourceCaches[M]=new a.bv(L,w,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=B,B.onAdd(this.map)};E(!1),f.type!=="vector"&&f.type!=="geojson"||E(!0),w.onAdd&&w.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(l){this._checkLoaded();const f=this.getOwnSource(l);if(!f)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===l)return this.fire(new a.d(new Error(`Source "${l}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===l)return this.fire(new a.d(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(l);for(const w of y){const E=a.cU(w.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(w.id),w.fire(new a.f("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],this.mergeSources(),f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(l,f){this._checkLoaded(),this.getOwnSource(l).setData(f),this._changes.setDirty()}getOwnSource(l){const f=this.getOwnSourceCache(l);return f&&f.getSource()}getOwnSources(){const l=[];for(const f in this._otherSourceCaches){const y=this.getOwnSourceCache(f);y&&l.push(y.getSource())}return l}areTilesLoaded(){const l=this._mergedSourceCaches;for(const f in l){const y=l[f]._tiles;for(const w in y){const E=y[w];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}setLights(l){if(this._checkLoaded(),!l)return delete this.ambientLight,void delete this.directionalLight;const f=this._getTransitionParameters();for(const w of l){if(this._validate($e,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(w),E.updateTransitions(f)}else this.ambientLight=new xf(w,Gr,this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(w),E.updateTransitions(f)}else this.directionalLight=new xf(w,j_,this.scope,this.options)}}const y=new a.X(this.z||0,f);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const l=this.directionalLight,f=this.ambientLight;if(!l||!f)return;const y=G=>.2126*(G[0]<=.03928?G[0]/12.92:Math.pow((G[0]+.055)/1.055,2.4))+.7152*(G[1]<=.03928?G[1]/12.92:Math.pow((G[1]+.055)/1.055,2.4))+.0722*(G[2]<=.03928?G[2]/12.92:Math.pow((G[2]+.055)/1.055,2.4)),w=l.properties.get("color").toRenderColor(null).toArray01(),E=l.properties.get("intensity"),T=l.properties.get("direction"),M=1-a.ac(T.x,T.y,T.z)[2]/90,L=y(w)*E*M,B=f.properties.get("color").toRenderColor(null).toArray01(),$=f.properties.get("intensity");return(L+y(B)*$)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const l=[];return this.directionalLight&&l.push(this.directionalLight.get()),this.ambientLight&&l.push(this.ambientLight.get()),l}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(l){if(!l)return this;if(a.cV(l)){const f=a.cW(l),y=this.fragments.find(({id:E})=>E===f);if(!y)throw new Error(`Style import not found: ${l}`);const w=a.cU(l);return y.style.getFragmentStyle(w)}{const f=this.fragments.find(({id:y})=>y===l);if(!f)throw new Error(`Style import not found: ${l}`);return f.style}}getConfigProperty(l,f){const y=this.getFragmentStyle(l);if(!y)return null;const w=a.al(f,y.scope),E=y.options.get(w),T=E?E.value||E.default:null;return T?T.serialize():null}setConfigProperty(l,f,y){const w=this.getFragmentStyle(l);if(!w)return;const E=w.stylesheet.schema;if(!E||!E[f])return;const T=a.y(y);if(T.result!=="success")return void Lc(this,T.value);const M=T.value.expression,L=a.al(f,w.scope),B=w.options.get(L);if(!B)return;let $;const{minValue:G,maxValue:Z,stepValue:Q,type:ne,values:ie}=E[f],oe=a.y(E[f].default);oe.result==="success"&&($=oe.value.expression),$?(this.options.set(L,{...B,value:M,default:$,minValue:G,maxValue:Z,stepValue:Q,type:ne,values:ie}),this.updateConfigDependencies()):this.fire(new a.d(new Error(`No schema defined for the config option "${f}" in the "${l}" fragment.`)))}getConfig(l){const f=this.getFragmentStyle(l);if(!f)return null;const y=f.stylesheet.schema;if(!y)return null;const w={};for(const E in y){const T=a.al(E,f.scope),M=f.options.get(T),L=M?M.value||M.default:null;w[E]=L?L.serialize():null}return w}setConfig(l,f){const y=this.getFragmentStyle(l);y&&(y.updateConfig(f,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(l){const f=this.getFragmentStyle(l);return f?f.stylesheet.schema:null}setSchema(l,f){const y=this.getFragmentStyle(l);y&&(y.stylesheet.schema=f,y.updateConfig(y._config,f),this.updateConfigDependencies())}updateConfig(l,f){if(this._config=l,l||f)if(f)for(const y in f){let w,E;const T=a.y(f[y].default);if(T.result==="success"&&(w=T.value.expression),l&&l[y]!==void 0){const Z=a.y(l[y]);Z.result==="success"&&(E=Z.value.expression)}const{minValue:M,maxValue:L,stepValue:B,type:$,values:G}=f[y];if(w){const Z=a.al(y,this.scope);this.options.set(Z,{default:w,value:E,minValue:M,maxValue:L,stepValue:B,type:$,values:G})}else this.fire(new a.d(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new a.d(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const l of this._configDependentLayers){const f=this.getLayer(l);f&&(f.possiblyEvaluateVisibility(),this._updateLayer(f))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const f=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut||l._styleColorTheme.lut&&f!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(l,f,y={}){this._checkLoaded();const w=l.id;if(this._layers[w])return void this.fire(new a.d(new Error(`Layer with id "${w}" already exists on this map`)));let E;if(l.type==="custom"){if(Lc(this,a.cX(l)))return;E=a.cY(l,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof l.source=="object"&&(this.addSource(w,l.source),l=a.cT(l),l=a.W(l,{source:w})),this._validate(kt,`layers.${w}`,l,{arrayIndex:-1},y))return;E=a.cY(l,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[E.id]=E.serialize()}E.isConfigDependent&&this._configDependentLayers.add(E.fqid);let T=this._order.length;if(f){const $=this._order.indexOf(f);if($===-1)return void this.fire(new a.d(new Error(`Layer with id "${f}" does not exist on this map.`)));E.slot===this._layers[f].slot?T=$:a.w(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,w),this._layerOrderChanged=!0,this._layers[w]=E;const M=this.getOwnLayerSourceCache(E),L=!!this.directionalLight&&this.directionalLight.shadowsEnabled();M&&E.canCastShadows()&&L&&(M.castsShadows=!0);const B=this._changes.getRemovedLayer(E);if(B&&E.source&&M&&E.type!=="custom"){this._changes.discardLayerRemoval(E);const $=a.al(E.source,E.scope);B.type!==E.type?this._changes.updateSourceCache($,"clear"):(this._changes.updateSourceCache($,"reload"),M.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(l,f){this._checkLoaded();const y=this._checkLayer(l);if(!y||l===f)return;const w=this._order.indexOf(l);this._order.splice(w,1);let E=this._order.length;if(f){const T=this._order.indexOf(f);if(T===-1)return void this.fire(new a.d(new Error(`Layer with id "${f}" does not exist on this map.`)));y.slot===this._layers[f].slot?E=T:a.w(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,l),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(l){this._checkLoaded();const f=this._checkLayer(l);if(!f)return;f.setEventedParent(null);const y=this._order.indexOf(l);this._order.splice(y,1),delete this._layers[l],delete this._serializedLayers[l],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(f.fqid),this._changes.removeLayer(f);const w=this.getOwnLayerSourceCache(f);if(w&&w.castsShadows){let E=!1;for(const T in this._layers)if(this._layers[T].source===f.source&&this._layers[T].canCastShadows()){E=!0;break}w.castsShadows=E}f.onRemove&&f.onRemove(this.map),this.mergeLayers()}getOwnLayer(l){return this._layers[l]}hasLayer(l){return l in this._mergedLayers}hasLayerType(l){for(const f in this._layers)if(this._layers[f].type===l)return!0;return!1}setLayerZoomRange(l,f,y){this._checkLoaded();const w=this._checkLayer(l);w&&(w.minzoom===f&&w.maxzoom===y||(f!=null&&(w.minzoom=f),y!=null&&(w.maxzoom=y),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(l,f){this._checkLoaded();const y=this._checkLayer(l);y&&y.slot!==f&&(y.slot=f,this._updateLayer(y))}setFilter(l,f,y={}){this._checkLoaded();const w=this._checkLayer(l);if(w&&!C(w.filter,f))return f==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(Et,`layers.${w.id}.filter`,f,{layerType:w.type},y)||(w.filter=a.cT(f),this._updateLayer(w)))}getFilter(l){const f=this._checkLayer(l);if(f)return a.cT(f.filter)}setLayoutProperty(l,f,y,w={}){this._checkLoaded();const E=this._checkLayer(l);if(E&&!C(E.getLayoutProperty(f),y)){if(y!=null&&(!w||w.validate!==!1)&&Lc(E,pr.call(we,{key:`layers.${l}.layout.${f}`,layerType:E.type,objectKey:f,value:y,styleSpec:a.L,style:{glyphs:!0,sprite:!0}})))return;E.setLayoutProperty(f,y),E.isConfigDependent&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)}}getLayoutProperty(l,f){const y=this._checkLayer(l);if(y)return y.getLayoutProperty(f)}setPaintProperty(l,f,y,w={}){this._checkLoaded();const E=this._checkLayer(l);if(!E||C(E.getPaintProperty(f),y)||y!=null&&(!w||w.validate!==!1)&&Lc(E,er.call(we,{key:`layers.${l}.paint.${f}`,layerType:E.type,objectKey:f,value:y,styleSpec:a.L})))return;const T=E.setPaintProperty(f,y);E.isConfigDependent&&this._configDependentLayers.add(E.fqid),T&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(l,f){const y=this._checkLayer(l);if(y)return y.getPaintProperty(f)}setFeatureState(l,f){this._checkLoaded();const y=l.source,w=l.sourceLayer,E=this._checkSource(y);if(!E)return;const T=E.type;if(T==="geojson"&&w)return void this.fire(new a.d(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(T==="vector"&&!w)return void this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new a.d(new Error("The feature id parameter must be provided.")));const M=this.getOwnSourceCaches(y);for(const L of M)L.setFeatureState(w,l.id,f)}removeFeatureState(l,f){this._checkLoaded();const y=l.source,w=this._checkSource(y);if(!w)return;const E=w.type,T=E==="vector"?l.sourceLayer:void 0;if(E==="vector"&&!T)return void this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new a.d(new Error("A feature id is required to remove its specific state property.")));const M=this.getOwnSourceCaches(y);for(const L of M)L.removeFeatureState(T,l.id,f)}getFeatureState(l){this._checkLoaded();const f=l.source,y=l.sourceLayer,w=this._checkSource(f);if(w){if(w.type!=="vector"||y)return l.id===void 0&&this.fire(new a.d(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(f)[0].getFeatureState(y,l.id);this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(l){return this.stylesheet.transition=a.W({},this.stylesheet.transition,l),this.transition=this.stylesheet.transition,this}getTransition(){return a.W({},this.stylesheet.transition)}serialize(){this._checkLoaded();const l=this.getTerrain(),f=l&&this.terrain&&this.terrain.scope===this.scope?l:this.stylesheet.terrain;return a.cZ({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:f,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateLayer(l){this._changes.updateLayer(l);const f=this.getLayerSourceCache(l),y=a.al(l.source,l.scope),w=this._changes.getUpdatedSourceCaches();l.source&&!w[y]&&f&&f.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),f.pause()),l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const f=M=>this._mergedLayers[M].type==="fill-extrusion"||this._mergedLayers[M].type==="model",y=this.order,w={},E=[];for(let M=y.length-1;M>=0;M--){const L=y[M];if(f(L)){w[L]=M;for(const B of l){const $=B[L];if($)for(const G of $)E.push(G)}}}E.sort((M,L)=>L.intersectionZ-M.intersectionZ);const T=[];for(let M=y.length-1;M>=0;M--){const L=y[M];if(f(L))for(let B=E.length-1;B>=0;B--){const $=E[B].feature;if($.layer&&w[$.layer.id]<M)break;T.push($),E.pop()}else for(const B of l){const $=B[L];if($)for(const G of $)T.push(G.feature)}}return T}queryRenderedFeatures(l,f,y){f&&f.filter&&this._validate(Et,"queryRenderedFeatures.filter",f.filter,null,f),f.scope=this.scope,f.availableImages=this._availableImages,f.serializedLayers=this._serializedLayers;const w={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new a.d(new Error("parameters.layers must be an Array."))),[];for(const B of f.layers){const $=this._mergedLayers[B];if(!$)return this.fire(new a.d(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];w[$.source]=!0}}const E=[],T=f.serializedLayers||{},M=f&&f.layers?f.layers.some(B=>{const $=this.getLayer(B);return $&&$.is3D()}):this.has3DLayers(),L=Qo.createFromScreenPoints(l,y);for(const B in this._mergedSourceCaches){const $=this._mergedSourceCaches[B].getSource();if(!$||$.scope!==f.scope)continue;const G=this._mergedSourceCaches[B].getSource().id;f.layers&&!w[G]||E.push(dI(this._mergedSourceCaches[B],this._mergedLayers,T,L,f,y,M,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(B,$,G,Z,Q,ne,ie){const oe={},se=ne.queryRenderedSymbols(Z),me=[];for(const ge of Object.keys(se).map(Number))me.push(ie[ge]);me.sort(Vh);for(const ge of me){const _e=ge.featureIndex.lookupSymbolFeatures(se[ge.bucketInstanceId],$,ge.bucketIndex,ge.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,B);for(const Pe in _e){const Te=oe[Pe]=oe[Pe]||[],pe=_e[Pe];pe.sort((ye,ve)=>{const De=ge.featureSortOrder;if(De){const He=De.indexOf(ye.featureIndex);return De.indexOf(ve.featureIndex)-He}return ve.featureIndex-ye.featureIndex});for(const ye of pe)Te.push(ye)}}for(const ge in oe)oe[ge].forEach(_e=>{const Pe=_e.feature,Te=G(B[ge]);if(!Te)return;const pe=Te.getFeatureState(Pe.layer["source-layer"],Pe.id);Pe.source=Pe.layer.source,Pe.layer["source-layer"]&&(Pe.sourceLayer=Pe.layer["source-layer"]),Pe.state=pe});return oe}(this._mergedLayers,T,this.getLayerSourceCache.bind(this),L.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(l,f){f&&f.filter&&this._validate(Et,"querySourceFeatures.filter",f.filter,null,f);const y=this.getOwnSourceCaches(l);let w=[];for(const E of y)w=w.concat(jf(E,f));return w}addSourceType(l,f,y){return Ra.getSourceType(l)?y(new Error(`A source type called "${l}" already exists.`)):(Ra.setSourceType(l,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:f.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(l,f,y={}){this._checkLoaded();const w=this.light.getLight();let E=!1;for(const M in l)if(!C(l[M],w[M])){E=!0;break}if(!E)return;const T=this._getTransitionParameters();this.light.setLight(l,f,y),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(l,f=1){if(this._checkLoaded(),!l)return this.terrainSetForDrapingOnly()&&f!==0||delete this.terrain,l===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=l;const w=l.source==null;if(f===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const M="terrain-dem-src";this.addSource(M,y.source),y=a.cT(y),y=a.W(y,{source:M})}const E=a.W({},y),T={};if(this.terrain&&w){E.source=this.terrain.get().source;const M=this.terrain?this.getFragmentStyle(this.terrain.scope):null;M&&(T.style=M.serialize())}if(this._validate(Fe,"terrain",E,T))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&f!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,f),this.fire(new a.f("data",{dataType:"style"}))}else{const E=this.terrain,T=E.get();for(const M of Object.keys(a.L.terrain))!y.hasOwnProperty(M)&&a.L.terrain[M].default&&(y[M]=a.L.terrain[M].default);for(const M in l)if(!C(l[M],T[M])){E.set(l,this.options),this.stylesheet.terrain=l;const L=this._getTransitionParameters({duration:0});E.updateTransitions(L),this.fire(new a.f("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const f=this.fog=new rb(l,this.map.transform,this.scope,this.options);this.stylesheet.fog=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog;if(!C(f.get(),l)){f.set(l,this.options),this.stylesheet.fog=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}}else this._createFog(l);this._markersNeedUpdate=!0}setColorTheme(l){this._checkLoaded();const f=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()};if(this._styleColorTheme.colorTheme=l,!l)return this._styleColorTheme.lut=null,void f();const y=this._evaluateColorThemeData(l);this._loadColorTheme(y).then(()=>{f()}).catch(w=>{a.w(`Couldn't set color theme: ${w}`)})}_getTransitionParameters(l){return{now:a.e.now(),transition:a.W(this.transition,l)}}updateDrapeFirstLayers(){if(!this.terrain)return;const l=[],f=[];for(const y in this._mergedLayers)this.isLayerDraped(this._mergedLayers[y])?l.push(y):f.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...f)}_createTerrain(l,f){const y=this.terrain=new Dr(l,f,this.scope,this.options);f===1&&(this.stylesheet.terrain=l),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});y.updateTransitions(w)}_force3DLayerUpdate(){for(const l in this._layers){const f=this._layers[l];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const f=this._layers[l];f.type==="symbol"&&this._updateLayer(f)}}_validate(l,f,y,w,E={}){if(E&&E.validate===!1)return!1;const T=a.W({},this.serialize());return Lc(this,l.call(we,a.W({key:f,style:T,value:y,styleSpec:a.L},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.c_.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._mergedLayers)this._mergedLayers[l].setEventedParent(null);for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles(),this._mergedSourceCaches[l].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(l){const f=this.getSourceCaches(l);for(const y of f)y.clearTiles()}clearSources(){for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles()}reloadSource(l){const f=this.getSourceCaches(l);for(const y of f)y.resume(),y.reload()}reloadSources(){for(const l of this.getSources())l.reload&&l.reload()}updateSources(l){let f;this.directionalLight&&(f=Tf(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(l,void 0,void 0,f)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const f=this._sourceCaches[l];f.resume(),f.reload()}}_updatePlacement(l,f,y,w,E,T,M=!1){let L=!1,B=!1;const $={},G={};for(const Q of this._mergedOrder){const ne=this._mergedLayers[Q];if(ne.type!=="symbol")continue;const ie=a.al(ne.source,ne.scope);let oe=$[ie];if(!oe){const me=this.getLayerSourceCache(ne);if(!me)continue;const ge=me.getRenderableIds(!0).map(_e=>me.getTileByID(_e));G[ie]=ge.slice(),oe=$[ie]=ge.sort((_e,Pe)=>Pe.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(Pe.tileID)?-1:1))}const se=this.crossTileSymbolIndex.addLayer(ne,oe,f.center.lng,f.projection);L=L||se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),M=M||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new a.f("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.e.now(),f.zoom))&&(this.pauseablePlacement=new Qm(f,this._mergedOrder,M,y,w,E,this.placement,this.fog&&f.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,$,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.e.now()),B=!0),L&&this.pauseablePlacement.placement.setStale()),B||L){this._buildingIndex.onNewFrame(f.zoom);for(let Q=0;Q<this._mergedOrder.length;Q++){const ne=this._mergedLayers[this._mergedOrder[Q]];if(ne.type!=="symbol")continue;const ie=this.isLayerClipped(ne)&&this._clipLayerIndices.some(oe=>Q<oe);this.placement.updateLayerOpacities(ne,$[a.al(ne.source,ne.scope)],Q,ie?T:null)}}let Z=!1;for(const Q of this._mergedOrder){const ne=this._mergedLayers[Q];if(ne.type!=="symbol")continue;const ie=$[a.al(ne.source,ne.scope)];for(const oe of ie){const se=oe.getBucket(ne);se&&oe.latestFeatureIndex&&ne.fqid===se.layerIds[0]&&(Z=se.updateOcclusionOpacities(l.context,l.symbolParams,l._dt)||Z)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.e.now())||Z,occlusionQueryBasedOpacityChanged:Z}}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}addImport(l,f){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:E})=>E===l.id)!==-1)return void this.fire(new a.d(new Error(`Import with id '${l.id}' already exists in the map's style.`)));if(!f)return y.push(l),this._loadImports([l],!0);const w=y.findIndex(({id:E})=>E===f);return w===-1&&this.fire(new a.d(new Error(`Import with id "${f}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,w).concat(l).concat(y.slice(w)),this._loadImports([l],!0,f)}updateImport(l,f){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(l);return w===-1?this:typeof f=="string"?(this.setImportUrl(l,f),this):(f.url&&f.url!==y[w].url&&this.setImportUrl(l,f.url),C(f.config,y[w].config)||this.setImportConfig(l,f.config),C(f.data,y[w].data)||this.setImportData(l,f.data),this)}moveImport(l,f){this._checkLoaded();let y=this.stylesheet.imports||[];const w=this.getImportIndex(l);if(w===-1)return this;const E=this.getImportIndex(f);if(E===-1)return this;const T=y[w],M=this.fragments[w];return y=y.filter(({id:L})=>L!==l),this.fragments=this.fragments.filter(({id:L})=>L!==l),this.stylesheet.imports=y.slice(0,E).concat(T).concat(y.slice(E)),this.fragments=this.fragments.slice(0,E).concat(M).concat(this.fragments.slice(E)),this.mergeLayers(),this}setImportUrl(l,f){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(l);if(w===-1)return this;y[w].url=f;const E=this.fragments[w];return E.style=this._createFragmentStyle(y[w]),E.style.on("style.import.load",()=>this.mergeAll()),E.style.loadURL(f),this}setImportData(l,f){this._checkLoaded();const y=this.getImportIndex(l),w=this.stylesheet.imports||[];return y===-1?this:f?(this.fragments[y].style.setState(f),this._reloadImports(),this):(delete w[y].data,this.setImportUrl(l,w[y].url))}setImportConfig(l,f){this._checkLoaded();const y=this.getImportIndex(l),w=this.stylesheet.imports||[];if(y===-1)return this;f?w[y].config=f:delete w[y].config;const E=this.fragments[y],T=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=f,E.style.updateConfig(f,T),this.updateConfigDependencies(),this}removeImport(l){this._checkLoaded();const f=this.stylesheet.imports||[],y=this.getImportIndex(l);y!==-1&&(f.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(l){const f=(this.stylesheet.imports||[]).findIndex(y=>y.id===l);return f===-1&&this.fire(new a.d(new Error(`Import '${l}' does not exist in the map's style and cannot be updated.`))),f}getLayer(l){return this._mergedLayers[l]}getSources(){const l=[];for(const f in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[f];y&&l.push(y.getSource())}return l}getSource(l,f){const y=this.getSourceCache(l,f);return y&&y.getSource()}getLayerSource(l){const f=this.getLayerSourceCache(l);return f&&f.getSource()}getSourceCache(l,f){const y=a.al(l,f);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(l){const f=a.al(l.source,l.scope);return l.type==="symbol"?this._mergedSymbolSourceCaches[f]:this._mergedOtherSourceCaches[f]}getSourceCaches(l){if(l==null)return Object.values(this._mergedSourceCaches);const f=[];return this._mergedOtherSourceCaches[l]&&f.push(this._mergedOtherSourceCaches[l]),this._mergedSymbolSourceCaches[l]&&f.push(this._mergedSymbolSourceCaches[l]),f}updateSourceCaches(){const l=this._changes.getUpdatedSourceCaches();for(const f in l){const y=l[f];y==="reload"?this.reloadSource(f):y==="clear"&&this.clearSource(f)}}updateLayers(l){const f=this._changes.getUpdatedPaintProperties();for(const y of f){const w=this.getLayer(y);w&&w.updateTransitions(l)}}getImages(l,f,y){this.imageManager.getImages(f.icons,f.scope,y),this._updateTilesForChangedImages();const w=E=>{E&&E.setDependencies(f.tileID.key,f.type,f.icons)};w(this._otherSourceCaches[f.source]),w(this._symbolSourceCaches[f.source])}getGlyphs(l,f,y){this.glyphManager.getGlyphs(f.stacks,f.scope,y)}getResource(l,f,y){return a.c$(f,y)}getOwnSourceCache(l){return this._otherSourceCaches[l]}getOwnLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}getOwnSourceCaches(l){const f=[];return this._otherSourceCaches[l]&&f.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&f.push(this._symbolSourceCaches[l]),f}_isSourceCacheLoaded(l){const f=this.getOwnSourceCaches(l);return f.length===0?(this.fire(new a.d(new Error(`There is no source with ID '${l}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(l,f){if(this._clipLayerIndices.length===0&&l.type!=="fill-extrusion")return!1;const y=l.type==="fill-extrusion"&&l.sourceLayer==="building";let w=0;if(l.is3D()){if(y||f&&f.type==="batched-model")return!0;l.type==="model"&&(w=a.cu.Model)}else l.type==="symbol"&&(w=a.cu.Symbol);for(const E of this._clipLayerIndices){const T=this._mergedLayers[this._mergedOrder[E]];if(!T)continue;const M=[];for(const L of T.layout.get("clip-layer-types"))M.push(L==="model"?a.cu.Model:L==="symbol"?a.cu.Symbol:a.cu.FillExtrusion);for(const L of M)if(w&L)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(l=>{l.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function Ly(g,l){let f=!1,y=null;const w=()=>{y=null,f&&(g(),y=setTimeout(w,l),f=!1)};return()=>(f=!0,y||w(),y)}Ra.getSourceType=function(g){return Io[g]},Ra.setSourceType=function(g,l){Io[g]=l},Ra.registerForPluginStateChange=a.cL;class xI{constructor(l){this._hashName=l&&encodeURIComponent(l),a.bp(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ly(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const f=Kf(l);if(this._hashName){const y=this._hashName;let w=!1;const E=location.hash.slice(1).split("&").map(T=>{const M=T.split("=")[0];return M===y?(w=!0,`${M}=${f}`):T}).filter(T=>T);return w||E.push(`${y}=${f}`),`#${E.join("&")}`}return`#${f}`}_getCurrentHash(){const l=location.hash.replace("#","");if(this._hashName){let f;return l.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(y))){const y=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(f[3]||0):l.getBearing();return l.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Kf(g,l){const f=g.getCenter(),y=Math.round(100*g.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,w),T=Math.round(f.lng*E)/E,M=Math.round(f.lat*E)/E,L=g.getBearing(),B=g.getPitch();let $=l?`/${T}/${M}/${y}`:`${y}/${M}/${T}`;return(L||B)&&($+="/"+Math.round(10*L)/10),B&&($+=`/${Math.round(B)}`),$}const Jm={linearity:.3,easing:a.d0(0,0,.3,1)},Ob=a.W({deceleration:2500,maxSpeed:1400},Jm),By=a.W({deceleration:20,maxSpeed:1400},Jm),e0=a.W({deceleration:1e3,maxSpeed:360},Jm),Fy=a.W({deceleration:1e3,maxSpeed:90},Jm);class Ru{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.e.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,f=a.e.now();for(;l.length>0&&f-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){const E=Yf(f.pan.mag(),y,a.W({},Ob,l||{}));w.offset=f.pan.mult(E.amount/f.pan.mag()),w.center=this._map.transform.center,Wh(w,E)}if(f.zoom){const E=Yf(f.zoom,y,By);w.zoom=this._map.transform.zoom+E.amount,Wh(w,E)}if(f.bearing){const E=Yf(f.bearing,y,e0);w.bearing=this._map.transform.bearing+a.at(E.amount,-179,179),Wh(w,E)}if(f.pitch){const E=Yf(f.pitch,y,Fy);w.pitch=this._map.transform.pitch+E.amount,Wh(w,E)}if(w.zoom||w.bearing){const E=f.pinchAround===void 0?f.around:f.pinchAround;w.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Wh(g,l){(!g.duration||g.duration<l.duration)&&(g.duration=l.duration,g.easing=l.easing)}function Yf(g,l,f){const{maxSpeed:y,linearity:w,deceleration:E}=f,T=a.at(g*w/(l/1e3),-y,y),M=Math.abs(T)/(E*w);return{easing:f.easing,duration:1e3*M,amount:T*(M/2)}}class Mo extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y,w={}){const E=J(f.getCanvasContainer(),y),T=f.unproject(E);super(l,a.W({point:E,lngLat:T,originalEvent:y},w)),this._defaultPrevented=!1,this.target=f}}class Bc extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){const w=l==="touchend"?y.changedTouches:y.touches,E=ae(f.getCanvasContainer(),w),T=E.map(L=>f.unproject(L)),M=E.reduce((L,B,$,G)=>L.add(B.div(G.length)),new a.P(0,0));super(l,{points:E,point:M,lngLats:T,lngLat:f.unproject(M),originalEvent:y}),this._defaultPrevented=!1}}class t0 extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){super(l,{originalEvent:y}),this._defaultPrevented=!1}}class zy{constructor(l,f){this._map=l,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new t0(l.type,this._map,l))}mousedown(l,f){return this._mousedownPos=f,this._firePreventable(new Mo(l.type,this._map,l))}mouseup(l){this._map.fire(new Mo(l.type,this._map,l))}preclick(l){const f=a.W({},l);f.type="preclick",this._map.fire(new Mo(f.type,this._map,f))}click(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(l),this._map.fire(new Mo(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new Mo(l.type,this._map,l))}mouseover(l){this._map.fire(new Mo(l.type,this._map,l))}mouseout(l){this._map.fire(new Mo(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Bc(l.type,this._map,l))}touchmove(l){this._map.fire(new Bc(l.type,this._map,l))}touchend(l){this._map.fire(new Bc(l.type,this._map,l))}touchcancel(l){this._map.fire(new Bc(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zf{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new Mo(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Mo(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class r0{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,f){this.isEnabled()&&l.shiftKey&&l.button===0&&(j(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(l,f){if(!this._active)return;const y=f,w=this._startPos,E=this._lastPos;if(!w||!E||E.equals(y)||!this._box&&y.dist(w)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=R("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const T=Math.min(w.x,y.x),M=Math.max(w.x,y.x),L=Math.min(w.y,y.y),B=Math.max(w.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${L}px)`,this._box.style.width=M-T+"px",this._box.style.height=B-L+"px")})}mouseupWindow(l,f){if(!this._active)return;const y=this._startPos,w=f;if(y&&l.button===0){if(this.reset(),te(),y.x!==w.x||y.y!==w.y)return this._map.fire(new a.f("boxzoomend",{originalEvent:l})),{cameraAnimation:E=>E.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),H(),delete this._startPos,delete this._lastPos}_fireEvent(l,f){return this._map.fire(new a.f(l,{originalEvent:f}))}}function Xf(g,l){const f={};for(let y=0;y<g.length;y++)f[g[y].identifier]=l[y];return f}class Lb{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const E=new a.P(0,0);for(const T of w)E._add(T);return E.div(w.length)}(f),this.touches=Xf(y,f)))}touchmove(l,f,y){if(this.aborted||!this.centroid)return;const w=Xf(y,f);for(const E in this.touches){const T=w[E];(!T||T.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(l,f,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Qf{constructor(l){this.singleTap=new Lb(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,f,y){this.singleTap.touchstart(l,f,y)}touchmove(l,f,y){this.singleTap.touchmove(l,f,y)}touchend(l,f,y){const w=this.singleTap.touchend(l,f,y);if(w){const E=l.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(w)<30;if(E&&T||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class n0{constructor(){this._zoomIn=new Qf({numTouches:1,numTaps:2}),this._zoomOut=new Qf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,f,y){this._zoomIn.touchstart(l,f,y),this._zoomOut.touchstart(l,f,y)}touchmove(l,f,y){this._zoomIn.touchmove(l,f,y),this._zoomOut.touchmove(l,f,y)}touchend(l,f,y){const w=this._zoomIn.touchend(l,f,y),E=this._zoomOut.touchend(l,f,y);return w?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(w)},{originalEvent:l})}):E?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(E)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Jf={0:1,2:2};class i0{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,f){return!1}_move(l,f){return{}}mousedown(l,f){if(this._lastPoint)return;const y=de(l);this._correctButton(l,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(l,f){const y=this._lastPoint;if(y){if(l.preventDefault(),this._eventButton!=null&&function(w,E){const T=Jf[E];return w.buttons===void 0||(w.buttons&T)!==T}(l,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(l){this._lastPoint&&de(l)===this._eventButton&&(this._moved&&te(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bb extends i0{mousedown(l,f){super.mousedown(l,f),this._lastPoint&&(this._active=!0)}_correctButton(l,f){return f===0&&!l.ctrlKey}_move(l,f){return{around:f,panDelta:f.sub(l)}}}class Ny extends i0{_correctButton(l,f){return f===0&&l.ctrlKey||f===2}_move(l,f){const y=.8*(f.x-l.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(l){l.preventDefault()}}class ku extends i0{_correctButton(l,f){return f===0&&l.ctrlKey||f===2}_move(l,f){const y=-.5*(f.y-l.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(l){l.preventDefault()}}class Fb{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),a.bp(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(l,f,y){return this._calculateTransform(l,f,y)}touchmove(l,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!a.d1())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,f,y)}}touchend(l,f,y){this._calculateTransform(l,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,f,y){y.length>0&&(this._active=!0);const w=Xf(y,f),E=new a.P(0,0),T=new a.P(0,0);let M=0;for(const B in w){const $=w[B],G=this._touches[B];G&&(E._add($),T._add($.sub(G)),M++,w[B]=$)}if(this._touches=w,M<this._minTouches||!T.mag())return;const L=T.div(M);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(M),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Uy{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,f,y){return{}}touchstart(l,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(l,f,y){const w=this._firstTwoTouches;if(!w)return;l.preventDefault();const[E,T]=w,M=o0(y,f,E),L=o0(y,f,T);if(!M||!L)return;const B=this._aroundCenter?null:M.add(L).div(2);return this._move([M,L],B,l)}touchend(l,f,y){if(!this._firstTwoTouches)return;const[w,E]=this._firstTwoTouches,T=o0(y,f,w),M=o0(y,f,E);T&&M||(this._active&&te(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function o0(g,l,f){for(let y=0;y<g.length;y++)if(g[y].identifier===f)return l[y]}function zb(g,l){return Math.log(g/l)/Math.LN2}class $y extends Uy{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,f){const y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(zb(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zb(this._distance,y),pinchAround:f}}}function s0(g,l){return 180*g.angleWith(l)/Math.PI}class jy extends Uy{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,f){const y=this._vector;if(this._vector=l[0].sub(l[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:s0(this._vector,y),pinchAround:f}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const f=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const w=s0(l,y);return Math.abs(w)<f}}function ep(g){return Math.abs(g.y)>Math.abs(g.x)}class Nb extends Uy{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,ep(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,f,y){const w=this._lastPoints;if(!w)return;const E=l[0].sub(w[0]),T=l[1].sub(w[1]);return this._map._cooperativeGestures&&!a.d1()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(E,T,y.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(E.y+T.y)/2*-.5})}gestureBeginsVertically(l,f,y){if(this._valid!==void 0)return this._valid;const w=l.mag()>=2,E=f.mag()>=2;if(!w&&!E)return;if(!w||!E)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const T=l.y>0==f.y>0;return ep(l)&&ep(f)&&T}}const Ub={panStep:100,bearingStep:15,pitchStep:10};class bI{constructor(){const l=Ub;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let f=0,y=0,w=0,E=0,T=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),E=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),E=1);break;case 38:l.shiftKey?w=1:(l.preventDefault(),T=-1);break;case 40:l.shiftKey?w=-1:(l.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:M=>{const L=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:tp,zoom:f?Math.round(L)+f*(l.shiftKey?2:1):L,bearing:M.getBearing()+y*this._bearingStep,pitch:M.getPitch()+w*this._pitchStep,offset:[-E*this._panStep,-T*this._panStep],center:M.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tp(g){return g*(2-g)}const qh=4.000244140625,$b=1/450;class Ws{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._handler=f,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=$b,a.bp(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||a.d1()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const y=a.e.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%qh==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(w*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=J(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>qh?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&$!==0&&($=1/$);const G=f(),Z=Math.pow(2,G),Q=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(Q*$))),this._type==="wheel"&&(this._startZoom=G,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),w=this._startZoom,E=this._easing;let T,M=!1;if(this._type==="wheel"&&w&&E){const B=Math.min((a.e.now()-this._lastWheelEventTime)/200,1),$=E(B);T=a.a2(w,y,$),B<1?this._frameId||(this._frameId=!0):M=!0}else T=y,M=!0;this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let L=T-f();return L*this._lastDelta<0&&(L=0),{noInertia:!0,needsRenderFrame:!M,zoomDelta:L,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let f=a.d2;if(this._prevEase){const y=this._prevEase,w=(a.e.now()-y.start)/y.duration,E=y.easing(w+.01)-y.easing(w),T=.27/Math.sqrt(E*E+1e-4)*.01,M=Math.sqrt(.0729-T*T);f=a.d0(T,M,.25,1)}return this._prevEase={start:a.e.now(),duration:l,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Vy{constructor(l,f){this._clickZoom=l,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class a0{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,f){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(l.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class l0{constructor(){this._tap=new Qf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,f,y){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(l,f,y))}touchmove(l,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=f[0],E=w.y-this._swipePoint.y;return this._swipePoint=w,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,f,y)}touchend(l,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(l,f,y)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hy{constructor(l,f,y){this._el=l,this._mousePan=f,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gy{constructor(l,f,y){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class c0{constructor(l,f,y,w){this._el=l,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Kh=g=>g.zoom||g.drag||g.pitch||g.rotate;class Wy extends a.f{}class u0{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,f){const y=a._.sub([],f,l);this.radius=a._.length(y[2]<0?a._.div([],y,this.constants):[y[0],y[1],0])}projectRay(l){a._.div(l,l,this.constants),a._.normalize(l,l),a._.mul(l,l,this.constants);const f=a._.scale([],l,this.radius);if(f[2]>0){const y=a._.scale([],[0,0,1],a._.dot(f,[0,0,1])),w=a._.scale([],a._.normalize([],[f[0],f[1],0]),this.radius),E=a._.add([],f,a._.scale([],a._.sub([],a._.add([],w,y),f),2));f[0]=E[0],f[1]=E[1]}return f}}function rp(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class jb{constructor(l,f){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ru(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new u0,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),a.bp(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,E,T]of this._listeners){const M=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(E,M,T)}}destroy(){for(const[l,f,y]of this._listeners){const w=l===document?this.handleWindowEvent:this.handleEvent;l.removeEventListener(f,w,y)}}_addDefaultHandlers(l){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new zy(f,l));const w=f.boxZoom=new r0(f,l);this._add("boxZoom",w);const E=new n0,T=new a0;f.doubleClickZoom=new Vy(T,E),this._add("tapZoom",E),this._add("clickZoom",T);const M=new l0;this._add("tapDragZoom",M);const L=f.touchPitch=new Nb(f);this._add("touchPitch",L);const B=new Ny(l),$=new ku(l);f.dragRotate=new Gy(l,B,$),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const G=new Bb(l),Z=new Fb(f,l);f.dragPan=new Hy(y,G,Z),this._add("mousePan",G),this._add("touchPan",Z,["touchZoom","touchRotate"]);const Q=new jy,ne=new $y;f.touchZoomRotate=new c0(y,ne,Q,M),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Zf(f));const ie=f.scrollZoom=new Ws(f,this);this._add("scrollZoom",ie,["mousePan"]);const oe=f.keyboard=new bI;this._add("keyboard",oe);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[se]&&f[se].enable(l[se])}_add(l,f,y){this._handlers.push({handlerName:l,handler:f,allowed:y}),this._handlersById[l]=f}stop(l){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Kh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,f,y){for(const w in l)if(w!==y&&(!f||f.indexOf(w)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const f=[];for(const y of l)this._el.contains(y.target)&&f.push(y);return f}handleEvent(l,f){this._updatingCamera=!0;const y=l.type==="renderFrame",w=y?void 0:l,E={needsRenderFrame:!1},T={},M={},L=l.touches?this._getMapTouches(l.touches):void 0,B=L?ae(this._el,L):y?void 0:J(this._el,l);for(const{handlerName:Z,handler:Q,allowed:ne}of this._handlers){if(!Q.isEnabled())continue;let ie;this._blockedByActive(M,ne,Z)?Q.reset():Q[f||l.type]&&(ie=Q[f||l.type](l,B,L),this.mergeHandlerResult(E,T,ie,Z,w),ie&&ie.needsRenderFrame&&this._triggerRenderFrame()),(ie||Q.isActive())&&(M[Z]=Q)}const $={};for(const Z in this._previousActiveHandlers)M[Z]||($[Z]=w);this._previousActiveHandlers=M,(Object.keys($).length||rp(E))&&(this._changes.push([E,T,$]),this._triggerRenderFrame()),(Object.keys(M).length||rp(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=E;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))}mergeHandlerResult(l,f,y,w,E){if(!y)return;a.W(l,y);const T={handlerName:w,originalEvent:y.originalEvent||E};y.zoomDelta!==void 0&&(f.zoom=T),y.panDelta!==void 0&&(f.drag=T),y.pitchDelta!==void 0&&(f.pitch=T),y.bearingDelta!==void 0&&(f.rotate=T)}_applyChanges(){const l={},f={},y={};for(const[w,E,T]of this._changes)w.panDelta&&(l.panDelta=(l.panDelta||new a.P(0,0))._add(w.panDelta)),w.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(l.around=w.around),w.aroundCoord!==void 0&&(l.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(l.pinchAround=w.pinchAround),w.noInertia&&(l.noInertia=w.noInertia),a.W(f,E),a.W(y,T);this._updateMapTransform(l,f,y),this._changes=[]}_updateMapTransform(l,f,y){const w=this._map,E=w.transform,T=me=>[me.x,me.y,me.z];if((me=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!rp(l)){const me=E.zoom;E.cameraElevationReference="sea",this._originalZoom!=null&&E._orthographicProjectionAtLowPitch&&E.projection.name!=="globe"&&E.pitch===0?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),me!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&w._stop(!0),!rp(l))return void this._fireEvents(f,y,!0);let{panDelta:M,zoomDelta:L,bearingDelta:B,pitchDelta:$,around:G,aroundCoord:Z,pinchAround:Q}=l;E._isCameraConstrained&&(L>0&&(L=0),E._isCameraConstrained=!1),Q!==void 0&&(G=Q),(L||(me=>f[me]&&!this._eventsInProgress[me])("drag"))&&G&&(this._dragOrigin=T(E.pointCoordinate3D(G)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",w._stop(!0),G=G||w.transform.centerPoint,B&&(E.bearing+=B),$&&(E.pitch+=$),E._updateCameraState();const ne=[0,0,0];if(M)if(E.projection.name==="mercator"){const me=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(G).dir),ge=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(G.sub(M)).dir);ne[0]=ge[0]-me[0],ne[1]=ge[1]-me[1]}else{const me=E.pointCoordinate(G);if(E.projection.name==="globe"){M=M.rotate(-E.angle);const ge=E._pixelsPerMercatorPixel/E.worldSize;ne[0]=-M.x*a.d3(a.ay(me.y))*ge,ne[1]=-M.y*a.d3(E.center.lat)*ge}else{const ge=E.pointCoordinate(G.sub(M));me&&ge&&(ne[0]=ge.x-me.x,ne[1]=ge.y-me.y)}}const ie=E.zoom,oe=[0,0,0];if(L){const me=T(Z||E.pointCoordinate3D(G)),ge={dir:a._.normalize([],a._.sub([],me,E._camera.position))};if(ge.dir[2]<0){const _e=E.zoomDeltaToMovement(me,L);a._.scale(oe,ge.dir,_e)}}const se=a._.add(ne,ne,oe);E._translateCameraConstrained(se),L&&Math.abs(E.zoom-ie)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,y,!0)}_fireEvents(l,f,y){const w=Kh(this._eventsInProgress),E=Kh(l),T={};for(const $ in l){const{originalEvent:G}=l[$];this._eventsInProgress[$]||(T[`${$}start`]=G),this._eventsInProgress[$]=l[$]}!w&&E&&this._fireEvent("movestart",E.originalEvent);for(const $ in T)this._fireEvent($,T[$]);E&&this._fireEvent("move",E.originalEvent);for(const $ in l){const{originalEvent:G}=l[$];this._fireEvent($,G)}const M={};let L;for(const $ in this._eventsInProgress){const{handlerName:G,originalEvent:Z}=this._eventsInProgress[$];this._handlersById[G].isActive()||(delete this._eventsInProgress[$],L=f[G]||Z,M[`${$}end`]=L)}for(const $ in M)this._fireEvent($,M[$]);const B=Kh(this._eventsInProgress);if(y&&(w||E)&&!B){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;$?(G($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:L})):(this._map.fire(new a.f("moveend",{originalEvent:L})),G(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,f){this._map.fire(new a.f(l,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new Wy("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Du="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wI extends a.E{constructor(l,f){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,a.bp(["_renderFrameCallback"],this)}getCenter(){return new a.aI(this.transform.center.lng,this.transform.center.lat)}setCenter(l,f){return this.jumpTo({center:l},f)}panBy(l,f,y){return l=a.P.convert(l).mult(-1),this.panTo(this.transform.center,a.W({offset:l},f),y)}panTo(l,f,y){return this.easeTo(a.W({center:l},f),y)}getZoom(){return this.transform.zoom}setZoom(l,f){return this.jumpTo({zoom:l},f),this}zoomTo(l,f,y){return this.easeTo(a.W({zoom:l},f),y)}zoomIn(l,f){return this.zoomTo(this.getZoom()+1,l,f),this}zoomOut(l,f){return this.zoomTo(this.getZoom()-1,l,f),this}getBearing(){return this.transform.bearing}setBearing(l,f){return this.jumpTo({bearing:l},f),this}getPadding(){return this.transform.padding}setPadding(l,f){return this.jumpTo({padding:l},f),this}rotateTo(l,f,y){return this.easeTo(a.W({bearing:l},f),y)}resetNorth(l,f){return this.rotateTo(0,a.W({duration:1e3},l),f),this}resetNorthPitch(l,f){return this.easeTo(a.W({bearing:0,pitch:0,duration:1e3},l),f),this}snapToNorth(l,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,f):this}getPitch(){return this.transform.pitch}setPitch(l,f){return this.jumpTo({pitch:l},f),this}cameraForBounds(l,f){l=a.ai.convert(l);const y=f&&f.bearing||0,w=f&&f.pitch||0,E=l.getNorthWest(),T=l.getSouthEast();return this._cameraForBounds(this.transform,E,T,y,w,f)}_extendPadding(l){const f={top:0,right:0,bottom:0,left:0};return l==null?a.W({},f,this.transform.padding):typeof l=="number"?{top:l,bottom:l,right:l,left:l}:a.W({},f,l)}_extendCameraOptions(l){return(l=a.W({offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=this._extendPadding(l.padding),l}_minimumAABBFrustumDistance(l,f){const y=f.max[0]-f.min[0],w=f.max[1]-f.min[1];return y/w>l.aspect?y/(2*Math.tan(.5*l.fovX)*l.aspect):w/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,f,y,w,E,T){const M=l.clone(),L=this._extendCameraOptions(T);M.bearing=w,M.pitch=E;const B=a.aI.convert(f),$=a.aI.convert(y),G=.5*(B.lat+$.lat),Z=.5*(B.lng+$.lng),Q=a.d4(G,Z),ne=a._.normalize([],Q),ie=a._.normalize([],a._.cross([],ne,[0,1,0])),oe=a._.cross([],ie,ne),se=[ie[0],ie[1],ie[2],0,oe[0],oe[1],oe[2],0,ne[0],ne[1],ne[2],0,0,0,0,1],me=[Q,a.d4(B.lat,B.lng),a.d4($.lat,B.lng),a.d4($.lat,$.lng),a.d4(B.lat,$.lng),a.d4(G,B.lng),a.d4(G,$.lng),a.d4(B.lat,Z),a.d4($.lat,Z)];let ge=a.b6.fromPoints(me.map(pt=>[a._.dot(ie,pt),a._.dot(oe,pt),a._.dot(ne,pt)]));const _e=a._.transformMat4([],ge.center,se);a._.squaredLength(_e)===0&&a._.set(_e,0,0,1),a._.normalize(_e,_e),a._.scale(_e,_e,a.cD),M.center=a.d5(_e);const Pe=M.getWorldToCameraMatrix(),Te=a.ad.invert(new Float64Array(16),Pe);ge=a.b6.applyTransform(ge,a.ad.multiply([],Pe,se));const pe=this._extendAABB(ge,M,L,w);if(!pe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ge=pe,a._.transformMat4(_e,_e,Pe);const ye=.5*(ge.max[2]-ge.min[2]),ve=this._minimumAABBFrustumDistance(M,ge),De=a._.scale([],[0,0,1],ye),He=a._.add(De,_e,De),Ee=ve+(M.pitch===0?0:a._.distance(_e,He)),Ge=M.globeCenterInViewSpace,Qe=a._.sub([],_e,[Ge[0],Ge[1],Ge[2]]);a._.normalize(Qe,Qe),a._.scale(Qe,Qe,Ee);const _t=a._.add([],_e,Qe);a._.transformMat4(_t,_t,Te);const xt=a.d7/a.cD,gt=a._.length(_t),Ue=a.ax(Math.max(gt*xt-a.d7,Number.EPSILON),0),rt=Math.min(M.zoomFromMercatorZAdjusted(Ue),L.maxZoom);return rt>.5*(a.b1+a.aU)?(M.setProjection({name:"mercator"}),M.zoom=rt,this._cameraForBounds(M,f,y,w,E,T)):{center:M.center,zoom:rt,bearing:w,pitch:E}}_extendAABB(l,f,y,w){const E=.5*((y.padding.left||0)+(y.padding.right||0)),T=.5*((y.padding.top||0)+(y.padding.bottom||0)),M=T,L=E,B=E,$=T,G=f.width-(L+B),Z=f.height-(M+$),Q=a._.sub([],l.max,l.min),ne=Math.min(G/Q[0],Z/Q[1]),ie=Math.min(f.scaleZoom(f.scale*ne),y.maxZoom);if(isNaN(ie))return null;const oe=f.scale/f.zoomScale(ie),se=new a.b6([l.min[0]-L*oe,l.min[1]-$*oe,l.min[2]],[l.max[0]+B*oe,l.max[1]+M*oe,l.max[2]]),me=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new a.P(y.offset.x,y.offset.y):a.P.convert(y.offset)).rotate(-a.ab(w));return se.center[0]-=me.x*oe,se.center[1]+=me.y*oe,se}queryTerrainElevation(l,f){const y=this.transform.elevation;return y?(f=a.W({},{exaggerated:!0},f),y.getAtPoint(a.Y.fromLngLat(l),null,f.exaggerated)):null}_cameraForBounds(l,f,y,w,E,T){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,f,y,w,E,T);const M=l.clone(),L=this._extendCameraOptions(T);M.bearing=w,M.pitch=E;const B=a.aI.convert(f),$=a.aI.convert(y),G=new a.aI(B.lng,$.lat),Z=new a.aI($.lng,B.lat),Q=M.project(B),ne=M.project($),ie=this.queryTerrainElevation(B),oe=this.queryTerrainElevation($),se=this.queryTerrainElevation(G),me=this.queryTerrainElevation(Z),ge=[[Q.x,Q.y,Math.min(ie||0,oe||0,se||0,me||0)],[ne.x,ne.y,Math.max(ie||0,oe||0,se||0,me||0)]];let _e=a.b6.fromPoints(ge);const Pe=M.getWorldToCameraMatrix(),Te=a.ad.invert(new Float64Array(16),Pe);_e=a.b6.applyTransform(_e,Pe);const pe=this._extendAABB(_e,M,L,w);if(!pe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");_e=pe;const ye=.5*a._.sub([],_e.max,_e.min)[2],ve=this._minimumAABBFrustumDistance(M,_e),De=[0,0,1,0];a.aA.transformMat4(De,De,Pe),a.aA.normalize(De,De);const He=a._.scale([],De,ve+ye),Ee=a._.add([],_e.center,He);a._.transformMat4(_e.center,_e.center,Te),a._.transformMat4(Ee,Ee,Te);const Ge=[_e.center[0],_e.center[1],Ee[2]*M.pixelsPerMeter];a._.scale(Ge,Ge,1/M.worldSize);const Qe=a.d6(Ge[0]),_t=a.ay(Ge[1]),xt=Math.min(M._zoomFromMercatorZ(Ge[2]),L.maxZoom),gt=new a.aI(Qe,_t);return M.mercatorFromTransition&&xt<.5*(a.b1+a.aU)?(M.setProjection({name:"globe"}),M.zoom=xt,this._cameraForBounds(M,f,y,w,E,T)):{center:gt,zoom:xt,bearing:w,pitch:E}}fitBounds(l,f,y){const w=this.cameraForBounds(l,f);return this._fitInternal(w,f,y)}fitScreenCoordinates(l,f,y,w,E){const T=a.P.convert(l),M=a.P.convert(f),L=new a.P(Math.min(T.x,M.x),Math.min(T.y,M.y)),B=new a.P(Math.max(T.x,M.x),Math.max(T.y,M.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(T,M))return this;const $=this.transform.pointLocation3D(L),G=this.transform.pointLocation3D(B),Z=this.transform.pointLocation3D(new a.P(L.x,B.y)),Q=this.transform.pointLocation3D(new a.P(B.x,L.y)),ne=[Math.min($.lng,G.lng,Z.lng,Q.lng),Math.min($.lat,G.lat,Z.lat,Q.lat)],ie=[Math.max($.lng,G.lng,Z.lng,Q.lng),Math.max($.lat,G.lat,Z.lat,Q.lat)],oe=w&&w.pitch?w.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,ne,ie,y,oe,w);return this._fitInternal(se,w,E)}_fitInternal(l,f,y){return l?(f=a.W(l,f)).linear?this.easeTo(f,y):this.flyTo(f,y):this}jumpTo(l,f){this.stop();const y=l.preloadOnly?this.transform.clone():this.transform;let w=!1,E=!1,T=!1;return"zoom"in l&&y.zoom!==+l.zoom&&(w=!0,y.zoom=+l.zoom),l.center!==void 0&&(y.center=a.aI.convert(l.center)),"bearing"in l&&y.bearing!==+l.bearing&&(E=!0,y.bearing=+l.bearing),"pitch"in l&&y.pitch!==+l.pitch&&(T=!0,y.pitch=+l.pitch),l.padding==null||y.isPaddingEqual(l.padding)||(y.padding=l.padding),l.preloadOnly?(this._preloadTiles(y),this):(this.fire(new a.f("movestart",f)).fire(new a.f("move",f)),w&&this.fire(new a.f("zoomstart",f)).fire(new a.f("zoom",f)).fire(new a.f("zoomend",f)),E&&this.fire(new a.f("rotatestart",f)).fire(new a.f("rotate",f)).fire(new a.f("rotateend",f)),T&&this.fire(new a.f("pitchstart",f)).fire(new a.f("pitch",f)).fire(new a.f("pitchend",f)),this.fire(new a.f("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(Du),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return a.w(Du),this;this.stop();const w=y.zoom,E=y.pitch,T=y.bearing;y.setFreeCameraOptions(l);const M=w!==y.zoom,L=E!==y.pitch,B=T!==y.bearing;return this.fire(new a.f("movestart",f)).fire(new a.f("move",f)),M&&this.fire(new a.f("zoomstart",f)).fire(new a.f("zoom",f)).fire(new a.f("zoomend",f)),B&&this.fire(new a.f("rotatestart",f)).fire(new a.f("rotate",f)).fire(new a.f("rotateend",f)),L&&this.fire(new a.f("pitchstart",f)).fire(new a.f("pitch",f)).fire(new a.f("pitchend",f)),this.fire(new a.f("moveend",f)),this}easeTo(l,f){this._stop(!1,l.easeId),((l=a.W({offset:[0,0],duration:500,easing:a.d2},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const y=this.transform,w=this.getZoom(),E=this.getBearing(),T=this.getPitch(),M=this.getPadding(),L="zoom"in l?+l.zoom:w,B="bearing"in l?this._normalizeBearing(l.bearing,E):E,$="pitch"in l?+l.pitch:T,G=this._extendPadding(l.padding),Z=a.P.convert(l.offset);let Q,ne,ie;if(y.projection.name==="globe"){const ve=a.Y.fromLngLat(y.center),De=Z.rotate(-y.angle);ve.x+=De.x/y.worldSize,ve.y+=De.y/y.worldSize;const He=ve.toLngLat(),Ee=a.aI.convert(l.center||He);this._normalizeCenter(Ee),Q=y.centerPoint.add(De),ne=new a.P(ve.x,ve.y).mult(y.worldSize),ie=new a.P(a.aj(Ee.lng),a.ak(Ee.lat)).mult(y.worldSize).sub(ne)}else{Q=y.centerPoint.add(Z);const ve=y.pointLocation(Q),De=a.aI.convert(l.center||ve);this._normalizeCenter(De),ne=y.project(ve),ie=y.project(De).sub(ne)}const oe=y.zoomScale(L-w);let se,me;l.around&&(se=a.aI.convert(l.around),me=y.locationPoint(se));const ge=this._zooming||L!==w,_e=this._rotating||E!==B,Pe=this._pitching||$!==T,Te=!y.isPaddingEqual(G),pe=ve=>De=>{if(ge&&(ve.zoom=a.a2(w,L,De)),_e&&(ve.bearing=a.a2(E,B,De)),Pe&&(ve.pitch=a.a2(T,$,De)),Te&&(ve.interpolatePadding(M,G,De),Q=ve.centerPoint.add(Z)),se)ve.setLocationAtPoint(se,me);else{const He=ve.zoomScale(ve.zoom-w),Ee=L>w?Math.min(2,oe):Math.max(.5,oe),Ge=Math.pow(Ee,1-De),Qe=ve.unproject(ne.add(ie.mult(De*Ge)).mult(He));ve.setLocationAtPoint(ve.renderWorldCopies?Qe.wrap():Qe,Q)}return l.preloadOnly||this._fireMoveEvents(f),ve};if(l.preloadOnly){const ve=this._emulate(pe,l.duration,y);return this._preloadTiles(ve),this}const ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ge,this._rotating=_e,this._pitching=Pe,this._padding=Te,this._easeId=l.easeId,this._prepareEase(f,l.noMoveStart,ye),this._ease(pe(y),ve=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(f,ve)},l),this}_prepareEase(l,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),f||y.moving||this.fire(new a.f("movestart",l)),this._zooming&&!y.zooming&&this.fire(new a.f("zoomstart",l)),this._rotating&&!y.rotating&&this.fire(new a.f("rotatestart",l)),this._pitching&&!y.pitching&&this.fire(new a.f("pitchstart",l))}_fireMoveEvents(l){this.fire(new a.f("move",l)),this._zooming&&this.fire(new a.f("zoom",l)),this._rotating&&this.fire(new a.f("rotate",l)),this._pitching&&this.fire(new a.f("pitch",l))}_afterEase(l,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.f("zoomend",l)),w&&this.fire(new a.f("rotateend",l)),E&&this.fire(new a.f("pitchend",l)),this.fire(new a.f("moveend",l))}flyTo(l,f){if(this._prefersReducedMotion(l)){const rt=a.ah(l,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(rt,f)}this.stop(),l=a.W({offset:[0,0],speed:1.2,curve:1.42,easing:a.d2},l);const y=this.transform,w=this.getZoom(),E=this.getBearing(),T=this.getPitch(),M=this.getPadding(),L="zoom"in l?a.at(+l.zoom,y.minZoom,y.maxZoom):w,B="bearing"in l?this._normalizeBearing(l.bearing,E):E,$="pitch"in l?+l.pitch:T,G=this._extendPadding(l.padding),Z=y.zoomScale(L-w),Q=a.P.convert(l.offset);let ne=y.centerPoint.add(Q);const ie=y.pointLocation(ne),oe=a.aI.convert(l.center||ie);this._normalizeCenter(oe);const se=y.project(ie),me=y.project(oe).sub(se);let ge=l.curve;const _e=Math.max(y.width,y.height),Pe=_e/Z,Te=me.mag();if("minZoom"in l){const rt=a.at(Math.min(l.minZoom,w,L),y.minZoom,y.maxZoom),pt=_e/y.zoomScale(rt-w);ge=Math.sqrt(pt/Te*2)}const pe=ge*ge;function ye(rt){const pt=(Pe*Pe-_e*_e+(rt?-1:1)*pe*pe*Te*Te)/(2*(rt?Pe:_e)*pe*Te);return Math.log(Math.sqrt(pt*pt+1)-pt)}function ve(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function De(rt){return(Math.exp(rt)+Math.exp(-rt))/2}const He=ye(0);let Ee=function(rt){return De(He)/De(He+ge*rt)},Ge=function(rt){return _e*((De(He)*(ve(pt=He+ge*rt)/De(pt))-ve(He))/pe)/Te;var pt},Qe=(ye(1)-He)/ge;if(Math.abs(Te)<1e-6||!isFinite(Qe)){if(Math.abs(_e-Pe)<1e-6)return this.easeTo(l,f);const rt=Pe<_e?-1:1;Qe=Math.abs(Math.log(Pe/_e))/ge,Ge=function(){return 0},Ee=function(pt){return Math.exp(rt*ge*pt)}}l.duration="duration"in l?+l.duration:1e3*Qe/("screenSpeed"in l?+l.screenSpeed/ge:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const _t=E!==B,xt=$!==T,gt=!y.isPaddingEqual(G),Ue=rt=>pt=>{const Ft=pt*Qe,zt=1/Ee(Ft);rt.zoom=pt===1?L:w+rt.scaleZoom(zt),_t&&(rt.bearing=a.a2(E,B,pt)),xt&&(rt.pitch=a.a2(T,$,pt)),gt&&(rt.interpolatePadding(M,G,pt),ne=rt.centerPoint.add(Q));const Gt=pt===1?oe:rt.unproject(se.add(me.mult(Ge(Ft))).mult(zt));return rt.setLocationAtPoint(rt.renderWorldCopies?Gt.wrap():Gt,ne),rt._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(f),rt};if(l.preloadOnly){const rt=this._emulate(Ue,l.duration,y);return this._preloadTiles(rt),this}return this._zooming=!0,this._rotating=_t,this._pitching=xt,this._padding=gt,this._prepareEase(f,!1),this._ease(Ue(y),()=>this._afterEase(f),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(l){}_cancelRenderFrame(l){}_stop(l,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!l){const y=this.handlers;y&&y.stop(!1)}return this}_ease(l,f,y){y.animate===!1||y.duration===0?(l(1),f()):(this._easeStart=a.e.now(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((a.e.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,f){l=a.au(l,-180,180);const y=Math.abs(l-f);return Math.abs(l-360-f)<y&&(l-=360),Math.abs(l+360-f)<y&&(l+=360),l}_normalizeCenter(l){const f=this.transform;if(f.maxBounds||f.projection.name!=="globe"&&!f.renderWorldCopies)return;const y=l.lng-f.center.lng;l.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&a.e.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,f,y){const w=Math.ceil(15*f/1e3),E=[],T=l(y.clone());for(let M=0;M<=w;M++){const L=T(M/w);E.push(L.clone())}return E}_preloadTiles(l,f){}}class Vb{constructor(l={}){this.options=l,a.bp(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const f=this.options&&this.options.compact;return this._map=l,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=R("button","mapboxgl-ctrl-attrib-button",this._container),R("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=R("div","mapboxgl-ctrl-attrib-inner",this._container),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,f){const y=this._map._getUIString(`AttributionControl.${f}`);l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.d8.ACCESS_TOKEN}];if(l){const y=f.reduce((w,E,T)=>(E.value&&(w+=`${E.key}=${E.value}${T<f.length-1?"&":""}`),w),"?");l.href=`${a.d8.FEEDBACK_URL}/${y}#${Kf(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const f=this._map.style._mergedSourceCaches;for(const w in f){const E=f[w];if(E.used){const T=E.getSource();T.attribution&&l.indexOf(T.attribution)<0&&l.push(T.attribution)}}l.sort((w,E)=>w.length-E.length),l=l.filter((w,E)=>{for(let T=E+1;T<l.length;T++)if(l[T].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const y=l.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Hb{constructor(){a.bp(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=R("div","mapboxgl-ctrl");const f=R("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const f in l){const y=l[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const f=l[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class Gb{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f}remove(l){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const w of y)if(w.id===l)return void(w.cancelled=!0)}run(l=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Wb(g,l,f){if(g=new a.aI(g.lng,g.lat),l){const y=new a.aI(g.lng-360,g.lat),w=new a.aI(g.lng+360,g.lat),E=360*Math.ceil(Math.abs(g.lng-f.center.lng)/360),T=f.locationPoint(g).distSqr(l),M=l.x<0||l.y<0||l.x>f.width||l.y>f.height;f.locationPoint(y).distSqr(l)<T&&(M||Math.abs(y.lng-f.center.lng)<E)?g=y:f.locationPoint(w).distSqr(l)<T&&(M||Math.abs(w.lng-f.center.lng)<E)&&(g=w)}for(;Math.abs(g.lng-f.center.lng)>180;){const y=f.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;g.lng>f.center.lng?g.lng-=360:g.lng+=360}return g}const qy={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class np extends a.E{constructor(l,f){if(super(),(l instanceof HTMLElement||f)&&(l=a.W({element:l},f)),a.bp(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=a.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=R("div");const E=41,T=27,M=z("svg",{display:"block",height:E*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${E}`},this._element),L=z("radialGradient",{id:"shadowGradient"},z("defs",{},M));z("stop",{offset:"10%","stop-opacity":.4},L),z("stop",{offset:"100%","stop-opacity":.05},L),z("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),z("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),z("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),z("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=a.P.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const y=this._element.classList;for(const E in qy)y.remove(`mapboxgl-marker-anchor-${E}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const w=l&&l.className?l.className.trim().split(/\s+/):[];y.add(...w),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.aI.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const f=l.code,y=l.charCode||l.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(l){const f=l.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,f=this._pos;if(!l||!f)return!1;const y=l.unproject(f),w=l.getFreeCameraOptions();if(!w.position)return!1;const E=w.position.toLngLat();return E.distanceTo(y)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const f=this._pos;if(!f||f.x<0||f.x>l.transform.width||f.y<0||f.y>l.transform.height)return void this._clearFadeTimer();const y=l.unproject(f);let w;l._showingGlobe()&&a.d9(l.transform,this._lngLat)?w=0:(w=1-l._queryFogOpacity(y),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${qy[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const l=this._pos,f=this._map,y=this.getPitchAlignment();if(!f||!l||y!=="map")return"";if(!f._showingGlobe()){const L=f.getPitch();return L?`rotateX(${L}deg)`:""}const w=a.b0(a.da(f.transform,this._lngLat)),E=l.sub(a.db(f.transform)),T=Math.abs(E.x)+Math.abs(E.y);if(T===0)return"";const M=w/T;return`rotateX(${-E.y*M}deg) rotateY(${E.x*M}deg)`}_calculateZTransform(){const l=this._pos,f=this._map;if(!f||!l)return"";let y=0;const w=this.getRotationAlignment();if(w==="map")if(f._showingGlobe()){const E=f.project(new a.aI(this._lngLat.lng,this._lngLat.lat+.001)),T=f.project(new a.aI(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);y=a.b0(Math.atan2(T.y,T.x))-90}else y=-f.getBearing();else if(w==="horizon"){const E=a.$(4,6,f.getZoom()),T=a.db(f.transform);T.y+=E*f.transform.height;const M=l.sub(T),L=a.b0(Math.atan2(M.y,M.x));y=(L>90?L-270:L+90)*(1-E)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(l){cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Wb(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),l===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=a.P.convert(l),this._update(),this}addClassName(l){return this._element.classList.add(l),this}removeClassName(l){return this._element.classList.remove(l),this}toggleClassName(l){return this._element.classList.toggle(l)}_onMove(l){const f=this._map;if(!f)return;const y=this._pointerdownPos,w=this._positionDelta;if(y&&w){if(!this._isDragging){const E=this._clickTolerance||f._clickTolerance;if(l.point.dist(y)<E)return;this._isDragging=!0}this._pos=l.point.sub(w),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.f("dragstart"))),this.fire(new a.f("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.f("dragend")),this._state="inactive"}_addDragHandler(l){const f=this._map,y=this._pos;f&&y&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(y),this._pointerdownPos=l.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const f=this._map;return f&&(l?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ky={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},qb=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ou(g=new a.P(0,0),l="bottom"){if(typeof g=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(l){case"top":return new a.P(0,g);case"top-left":return new a.P(f,f);case"top-right":return new a.P(-f,f);case"bottom":return new a.P(0,-g);case"bottom-left":return new a.P(f,-f);case"bottom-right":return new a.P(-f,-f);case"left":return new a.P(g,0);case"right":return new a.P(-g,0)}return new a.P(0,0)}return g instanceof a.P||Array.isArray(g)?a.P.convert(g):a.P.convert(g[l]||[0,0])}class Kb{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const f=a.b9((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,f,y){this._start=this.getValue(f),this._end=l,this._startTime=f,this._endTime=f+y}}const Yb={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Zb{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Yy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Lu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Xb{constructor(l,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Ny({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,y&&(this.mousePitch=new ku({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),a.bp(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(l,f){this.mouseRotate.mousedown(l,f),this.mousePitch&&this.mousePitch.mousedown(l,f),j()}move(l,f){const y=this.map,w=this.mouseRotate.mousemoveWindow(l,f),E=w&&w.bearingDelta;if(E&&y.setBearing(y.getBearing()+E),this.mousePitch){const T=this.mousePitch.mousemoveWindow(l,f),M=T&&T.pitchDelta;M&&y.setPitch(y.getPitch()+M)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){H(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(a.W({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),J(this.element,l)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,J(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=ae(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Bu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Qb={maxWidth:100,unit:"metric"},h0={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:a.dt,supported:A,setRTLTextPlugin:a.dv,getRTLTextPluginStatus:a.dw,Map:class extends wI{constructor(g){a.dc.mark(a.dd.create);const l=g;if((g=a.W({},Yy,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&a.de(window)&&(g.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new al(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Gb,this._domRenderTaskQueue=new Gb,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.df(),this._locale=a.W({},Yb,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Kb(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._lastDirtyFrameId=0,this._requestManager=new a.dg(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?{...g.contextCreateOptions}:{},typeof g.container=="string"){const f=document.getElementById(g.container);if(!f)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=f}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),a.bp(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Zb),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new jb(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||a.d8.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),g.hash&&(this._hash=new xI(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){l.center==null&&l.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const f=g.bounds;f&&(this.resize(),this.fitBounds(f,a.W({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new Vb({customAttribution:g.customAttribution})),this._logoControl=new Hb,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new a.f(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new a.f(`${f.dataType}dataloading`,f))})}_getMapId(){return this._mapId}addControl(g,l){if(l===void 0&&(l=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.d(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[l];return l.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.d(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(g);return l>-1&&this._controls.splice(l,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new a.f("movestart",g)).fire(new a.f("move",g)),this.fire(new a.f("resize",g)),l&&this.fire(new a.f("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.ai.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.f("zoomstart")).fire(new a.f("zoom")).fire(new a.f("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.f("zoomstart")).fire(new a.f("zoom")).fire(new a.f("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.f("pitchstart")).fire(new a.f("pitch")).fire(new a.f("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.f("pitchstart")).fire(new a.f("pitch")).fire(new a.f("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(l=>l==="auto"?navigator.language:l):g}setLanguage(g){const l=this._parseLanguage(g);if(!this.style||l===this._language)return this;this._language=l,this.style.reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,l=g.projection.name;let f;l==="globe"&&g.zoom>=a.aU?(g.setMercatorFromTransition(),f=!0):l==="mercator"&&g.zoom<a.aU&&(g.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,l){return this._updateProjection(g||l||{name:"mercator"})}_updateProjection(g){let l;return l=g.name==="globe"&&this.transform.zoom>=a.aU?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),l&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(a.aI.convert(g))}unproject(g){return this.transform.pointLocation3D(a.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,l,f){if(g==="mouseenter"||g==="mouseover"){let y=!1;const w=T=>{const M=l.filter(B=>this.getLayer(B)),L=M.length?this.queryRenderedFeatures(T.point,{layers:M}):[];L.length?y||(y=!0,f.call(this,new Mo(g,this,T.originalEvent,{features:L}))):y=!1},E=()=>{y=!1};return{layers:new Set(l),listener:f,delegates:{mousemove:w,mouseout:E}}}if(g==="mouseleave"||g==="mouseout"){let y=!1;const w=T=>{const M=l.filter(L=>this.getLayer(L));(M.length?this.queryRenderedFeatures(T.point,{layers:M}):[]).length?y=!0:y&&(y=!1,f.call(this,new Mo(g,this,T.originalEvent)))},E=T=>{y&&(y=!1,f.call(this,new Mo(g,this,T.originalEvent)))};return{layers:new Set(l),listener:f,delegates:{mousemove:w,mouseout:E}}}{const y=w=>{const E=l.filter(M=>this.getLayer(M)),T=E.length?this.queryRenderedFeatures(w.point,{layers:E}):[];T.length&&(w.features=T,f.call(this,w),delete w.features)};return{layers:new Set(l),listener:f,delegates:{[g]:y}}}}on(g,l,f){if(typeof l=="function"||f===void 0)return super.on(g,l);if(Array.isArray(l)||(l=[l]),l){for(const w of l)if(!this._isValidId(w))return this}const y=this._createDelegatedListener(g,l,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(g,l,f){if(typeof l=="function"||f===void 0)return super.once(g,l);if(Array.isArray(l)||(l=[l]),l){for(const w of l)if(!this._isValidId(w))return this}const y=this._createDelegatedListener(g,l,f);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(g,l,f){if(typeof l=="function"||f===void 0)return super.off(g,l);const y=new Set(Array.isArray(l)?l:[l]);for(const T of y)if(!this._isValidId(T))return this;const w=(T,M)=>{if(T.size!==M.size)return!1;for(const L of T)if(!M.has(L))return!1;return!0},E=this._delegatedListeners?this._delegatedListeners[g]:void 0;return E&&(T=>{for(let M=0;M<T.length;M++){const L=T[M];if(L.listener===f&&w(L.layers,y)){for(const B in L.delegates)this.off(B,L.delegates[B]);return T.splice(M,1),this}}})(E),this}queryRenderedFeatures(g,l){if(!this.style)return[];if(l!==void 0||g===void 0||g instanceof a.P||Array.isArray(g)||(l=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],(l=l||{}).layers&&Array.isArray(l.layers)){for(const f of l.layers)if(!this._isValidId(f))return[]}return this.style.queryRenderedFeatures(g,l,this.transform)}querySourceFeatures(g,l){return this._isValidId(g)?this.style.querySourceFeatures(g,l):[]}isPointOnSurface(g){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&a.w(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(g))}setStyle(g,l){return l=a.W({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l),this.style&&g&&l.diff!==!1&&l.localFontFamily===this._localFontFamily&&l.localIdeographFontFamily===this._localIdeographFontFamily&&!l.config?(this.style._diffStyle(g,(f,y)=>{f?(a.w(`Unable to perform style diff: ${String(f.message||f.error||f)}. Rebuilding the style from scratch.`),this._updateStyle(g,l)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(g,l))}_getUIString(g){const l=this._locale[g];if(l==null)throw new Error(`Missing UI string '${g}'`);return l}_updateStyle(g,l){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const f=a.W({},l);l&&l.config&&(f.initialConfig=l.config,delete f.config),this.style=new Ra(this,f).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ra(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new a.d(new Error("IDs can't be empty."))),!1):!a.cV(g)||(this.fire(new a.d(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}addSource(g,l){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,l),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,l,f){this._lazyInitEmptyStyle(),this.style.addSourceType(g,l,f)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,l,{pixelRatio:f=1,sdf:y=!1,stretchX:w,stretchY:E,content:T}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap){const{width:M,height:L,data:B}=a.e.getImageData(l);this.style.addImage(g,{data:new a.i({width:M,height:L},B),pixelRatio:f,stretchX:w,stretchY:E,content:T,sdf:y,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new a.d(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:L}=l,B=l;this.style.addImage(g,{data:new a.i({width:M,height:L},new Uint8Array(B.data)),pixelRatio:f,stretchX:w,stretchY:E,content:T,sdf:y,version:0,userImage:B}),B.onAdd&&B.onAdd(this,g)}}updateImage(g,l){this._lazyInitEmptyStyle();const f=this.style.getImage(g);if(!f)return void this.fire(new a.d(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap?a.e.getImageData(l):l,{width:w,height:E,data:T}=y;if(w===void 0||E===void 0)return void this.fire(new a.d(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==f.data.width||E!==f.data.height)return void this.fire(new a.d(new Error(`The width and height of the updated image (${w}, ${E})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`)));const M=!(l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap);f.data.replace(T,M),this.style.updateImage(g,f)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new a.d(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,l){a.h(this._requestManager.transformRequest(g,a.R.Image),(f,y)=>{l(f,y instanceof HTMLImageElement?a.e.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,l){this._lazyInitEmptyStyle(),this.style.addModel(g,l)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new a.d(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,l){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,l),this._update(!0)):this}getSlot(g){const l=this.getLayer(g);return l&&l.slot||null}setSlot(g,l){return this.style.setSlot(g,l),this.style.mergeLayers(),this._update(!0)}addImport(g,l){return this.style.addImport(g,l),this}updateImport(g,l){return typeof l!="string"&&l.id!==g?(this.removeImport(g),this.addImport(l)):(this.style.updateImport(g,l),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,l){return this.style.moveImport(g,l),this._update(!0)}moveLayer(g,l){return this._isValidId(g)?(this.style.moveLayer(g,l),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){return this._isValidId(g)?this.style.getOwnLayer(g):null}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,l,f){return this._isValidId(g)?(this.style.setLayerZoomRange(g,l,f),this._update(!0)):this}setFilter(g,l,f={}){return this._isValidId(g)?(this.style.setFilter(g,l,f),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,l,f,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,l,f,y),this._update(!0)):this}getPaintProperty(g,l){return this._isValidId(g)?this.style.getPaintProperty(g,l):null}setLayoutProperty(g,l,f,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,l,f,y),this._update(!0)):this}getLayoutProperty(g,l){return this._isValidId(g)?this.style.getLayoutProperty(g,l):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,l){return this.style.setSchema(g,l),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,l){return this.style.setConfig(g,l),this._update(!0)}getConfigProperty(g,l){return this.style.getConfigProperty(g,l)}setConfigProperty(g,l,f){return this.style.setConfigProperty(g,l,f),this._update(!0)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const l=g[0];l.properties?this.style.setFlatLight(l.properties,l.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,l={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.aI.convert(g),this.transform):0}setFeatureState(g,l){return this._isValidId(g.source)?(this.style.setFeatureState(g,l),this._update()):this}removeFeatureState(g,l){return this._isValidId(g.source)?(this.style.removeFeatureState(g,l),this._update()):this}getFeatureState(g){return this._isValidId(g.source)?this.style.getFeatureState(g):null}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let f,y,w,E=this._container;for(;E&&(!y||!w);){const T=window.getComputedStyle(E).transform;T&&T!=="none"&&(f=T.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(w=f[3])),E=E.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=w?Math.abs(l/w):l}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=R("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=R("div","mapboxgl-canvas-container",g);this._canvas=R("canvas","mapboxgl-canvas",l),this._interactive&&(l.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=R("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=R("div",`mapboxgl-ctrl-${w}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,l){const f=a.e.devicePixelRatio||1;this._canvas.width=f*Math.ceil(g),this._canvas.height=f*Math.ceil(l),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${l}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const l=this._markers.indexOf(g);l!==-1&&this._markers.splice(l,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const l=this._popups.indexOf(g);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const g=a.W({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl2",g);l?(a.dh(l,!0),this.painter=new Eb(l,this._contextCreateOptions,this.transform,this._tp),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.di.testSupport(l)):this.fire(new a.d(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.f("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new a.f("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty&&!this._occlusionOpacityChanged&&this._occlusionCriteriaSatisfied()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let l;this.fire(new a.f("renderstart")),++this._frameId;const f=this.painter.context.extTimerQuery,y=a.e.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(l=w.createQuery(),w.beginQuery(f.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,$=this.transform.pitch,G=a.e.now(),Z=new a.X(B,{now:G,fadeDuration:E,pitch:$,transition:this.style.transition});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(y);const M=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,this.painter.replacementSource);if(M&&(this._placementDirty=M.needsRerender,this._occlusionOpacityChanged=M.occlusionQueryBasedOpacityChanged),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.f("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.dc.mark(a.dd.load),this.fire(new a.f("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const B=a.e.now()-y;w.endQuery(f.TIME_ELAPSED_EXT),setTimeout(()=>{const $=w.getQueryParameter(l,w.QUERY_RESULT)/1e6;w.deleteQuery(l),this.fire(new a.f("gpu-timing-frame",{cpuTime:B,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(B);this.fire(new a.f("gpu-timing-layer",{layerTimes:$}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const $=this.painter.queryGpuTimeDeferredRender(B);this.fire(new a.f("gpu-timing-deferred-render",{gpuTime:$}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||this._occlusionOpacityChanged||T;if((this._sourcesDirty||this._styleDirty||T||this._occlusionOpacityChanged)&&(this._lastDirtyFrameId=this._frameId),L||this._repaint||!this._occlusionCriteriaSatisfied())this.triggerRepaint();else{const B=!this.isMoving()&&this.loaded();if(B&&(T=this._updateAverageElevation(y,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new a.f("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new a.f("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}this._loaded&&!this._fullyLoaded&&!L&&this._occlusionCriteriaSatisfied()&&(this._fullyLoaded=!0,a.dc.mark(a.dd.fullLoad),this._performanceMetricsCollection&&a.dj(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const l of this._markers)g&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!g||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(g,l=!1){const f=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(l||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const w=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=g;const T=Math.abs(w-E);if(T>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(E),f(E);this._averageElevation.easeTo(E,g,300)}else if(T>1e-4)return this._averageElevation.jumpTo(E),f(E)}return!!this._averageElevation.isEasing(g)&&f(this._averageElevation.getValue(g))}_authenticate(){a.dk(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===a.dl||g.status===401)){const l=this.painter.context.gl;a.dh(l,!1),this._logoControl instanceof Hb&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.d(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&a.dn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function w(E){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,E,0);const T=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,T),T}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(w(g),l.canvasCopies.map(w),l.timeStamps)}_canvasPixelComparison(g,l,f){let y=f[1]-f[0];const w=g.length/4;for(let E=0;E<l.length;E++){const T=l[E];let M=0;for(let L=0;L<T.length;L+=4)T[L]===g[L]&&T[L+1]===g[L+1]&&T[L+2]===g[L+2]&&T[L+3]===g[L+3]&&(M+=1);y+=(f[E+2]-f[E+1])*(1-M/w)}return y}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.dp(this.painter.context.gl),a.dq.remove(),a.dr.remove(),this._removed=!0,this.fire(new a.f("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.e.frame(l=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(l)}))}_preloadTiles(g){const l=this.style?this.style.getSourceCaches():[];return a.ds(l,(f,y)=>f._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,l){a.du(g,l)}_occlusionCriteriaSatisfied(){const g=this.style&&(this.style.has3DLayers()||this.style.terrain&&!this.style.disableElevatedTerrain);return!(this.style&&this.style.hasSymbolLayers()&&g&&this.painter)||this._frameId-this._lastDirtyFrameId>5+2*this.painter.symbolParams.occlusionQueryFrameWindow}get version(){return a.dt}},NavigationControl:class{constructor(g){this.options=a.W({},Lu,g),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(a.bp(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),R("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),R("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bp(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:l}):f.resetNorth({},{originalEvent:l}))}),this._compassIcon=R("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const l=g.getZoom(),f=l===g.getMaxZoom(),y=l===g.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xb(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,l){const f=R("button",g,this._container);return f.type="button",f.addEventListener("click",l),f}_setButtonTitle(g,l){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${l}`);g.setAttribute("aria-label",f),g.firstElementChild&&g.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends a.E{constructor(g){super();const l=navigator.geolocation;this.options=a.W({geolocation:l},Bu,g),a.bp(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ly(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const l=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,g(f)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(f=>l(f.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(g){const l=this._map.getMaxBounds(),f=g.coords;return!!l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.f("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.f("geolocate",g)),this._finish()}}_updateCamera(g){const l=new a.aI(g.coords.longitude,g.coords.latitude),f=g.coords.accuracy,y=this._map.getBearing(),w=a.W({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(f),w,{geolocateSource:!0})}_updateMarker(g){if(g){const l=new a.aI(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,l=a.ax(1,g._center.lat)*g.worldSize,f=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.f("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=R("button","mapboxgl-ctrl-geolocate",this._container),R("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R("div","mapboxgl-user-location"),this._dotElement.appendChild(R("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(R("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new np({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=R("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new np({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.f("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.f("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.f("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.f("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Vb,ScaleControl:class{constructor(g){this.options=a.W({},Qb,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bp(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,l=this._map,f=l._containerHeight/2,y=l._containerWidth/2-g/2,w=l.unproject([y,f]),E=l.unproject([y+g,f]),T=w.distanceTo(E);if(this.options.unit==="imperial"){const M=3.2808*T;M>5280?this._setScale(g,M/5280,"mile"):this._setScale(g,M,"foot")}else this.options.unit==="nautical"?this._setScale(g,T/1852,"nautical-mile"):T>=1e3?this._setScale(g,T/1e3,"kilometer"):this._setScale(g,T,"meter")}_setScale(g,l,f){this._map._requestDomTask(()=>{const y=function(E){const T=Math.pow(10,`${Math.floor(E)}`.length-1);let M=E/T;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(L){const B=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*B)/B}(M),T*M}(l),w=y/l;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(y):`${y}&nbsp;${h0[f]}`,this._container.style.width=g*w+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:a.w("Full screen control 'container' must be a DOM element.")),a.bp(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=R("button","mapboxgl-ctrl-fullscreen",this._controlContainer);R("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(g){super(),this.options=a.W(Object.create(Ky),g),a.bp(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new a.f("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new a.f("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=a.aI.convert(g),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const l=document.createDocumentFragment(),f=document.createElement("body");let y;for(f.innerHTML=g;y=f.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=R("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(g),this.options.closeButton){const f=this._closeButton=R("button","mapboxgl-popup-close-button",l);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let l;return this._classList.delete(g)?l=!1:(this._classList.add(g),l=!0),this._updateClassList(),l}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const l=this._map,f=this._container,y=this._pos;if(!l||!f||!y)return"bottom";const w=f.offsetWidth,E=f.offsetHeight,T=y.x<w/2,M=y.x>l.transform.width-w/2;if(y.y+g<E)return T?"top-left":M?"top-right":"top";if(y.y>l.transform.height-E){if(T)return"bottom-left";if(M)return"bottom-right"}return T?"left":M?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),g.className=l.join(" ")}_update(g){const l=this._map,f=this._content;if(!l||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=R("div","mapboxgl-popup",l.getContainer()),this._tip=R("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wb(this._lngLat,this._pos,l.transform)),!this._trackPointer||g){const w=this._pos=this._trackPointer&&g?g:l.project(this._lngLat),E=Ou(this.options.offset),T=this._anchor=this._getAnchor(E.y),M=Ou(this.options.offset,T),L=w.add(M).round();l._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${qy[T]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&l._showingGlobe()){const w=a.d9(l.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(qb);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:np,Style:Ra,LngLat:a.aI,LngLatBounds:a.ai,Point:a.P,MercatorCoordinate:a.Y,FreeCameraOptions:ey,Evented:a.E,config:a.d8,prewarm:a.dx,clearPrewarmedResources:a.dy,get accessToken(){return a.d8.ACCESS_TOKEN},set accessToken(g){a.d8.ACCESS_TOKEN=g},get baseApiUrl(){return a.d8.API_URL},set baseApiUrl(g){a.d8.API_URL=g},get workerCount(){return a.dz.workerCount},set workerCount(g){a.dz.workerCount=g},get maxParallelImageRequests(){return a.d8.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.d8.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.dA(g)},get workerUrl(){return a.dB.workerUrl},set workerUrl(g){a.dB.workerUrl=g},get workerClass(){return a.dB.workerClass},set workerClass(g){a.dB.workerClass=g},get workerParams(){return a.dB.workerParams},set workerParams(g){a.dB.workerParams=g},get dracoUrl(){return a.dC()},set dracoUrl(g){a.dD(g)},get meshoptUrl(){return a.dE()},set meshoptUrl(g){a.dF(g)},setNow:a.e.setNow,restoreNow:a.e.restoreNow}});var v=d;return v})})(UH);var _pe=UH.exports;const jH=aT(_pe);var D2=Object.prototype.toString,VH=function(e){var n=D2.call(e),o=n==="[object Arguments]";return o||(o=n!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&D2.call(e.callee)==="[object Function]"),o},LP,O2;function ype(){if(O2)return LP;O2=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=VH,u=Object.prototype.propertyIsEnumerable,d=!u.call({toString:null},"toString"),_=u.call(function(){},"prototype"),v=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=function(O){var R=O.constructor;return R&&R.prototype===O},C={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},A=function(){if(typeof window>"u")return!1;for(var O in window)try{if(!C["$"+O]&&e.call(window,O)&&window[O]!==null&&typeof window[O]=="object")try{a(window[O])}catch{return!0}}catch{return!0}return!1}(),k=function(O){if(typeof window>"u"||!A)return a(O);try{return a(O)}catch{return!1}};t=function(R){var z=R!==null&&typeof R=="object",N=n.call(R)==="[object Function]",K=o(R),q=z&&n.call(R)==="[object String]",j=[];if(!z&&!N&&!K)throw new TypeError("Object.keys called on a non-object");var H=_&&N;if(q&&R.length>0&&!e.call(R,0))for(var Y=0;Y<R.length;++Y)j.push(String(Y));if(K&&R.length>0)for(var te=0;te<R.length;++te)j.push(String(te));else for(var J in R)!(H&&J==="prototype")&&e.call(R,J)&&j.push(String(J));if(d)for(var ae=k(R),de=0;de<v.length;++de)!(ae&&v[de]==="constructor")&&e.call(R,v[de])&&j.push(v[de]);return j}}return LP=t,LP}var vpe=Array.prototype.slice,xpe=VH,L2=Object.keys,gE=L2?function(e){return L2(e)}:ype(),B2=Object.keys;gE.shim=function(){if(Object.keys){var e=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);e||(Object.keys=function(o){return xpe(o)?B2(vpe.call(o)):B2(o)})}else Object.keys=gE;return Object.keys||gE};var $O=gE,bpe=Error,wpe=EvalError,Cpe=RangeError,Epe=ReferenceError,HH=SyntaxError,gf=TypeError,Spe=URIError,DA=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),o=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(o)!=="[object Symbol]")return!1;var u=42;e[n]=u;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var d=Object.getOwnPropertySymbols(e);if(d.length!==1||d[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var _=Object.getOwnPropertyDescriptor(e,n);if(_.value!==u||_.enumerable!==!0)return!1}return!0},F2=typeof Symbol<"u"&&Symbol,Tpe=DA,jO=function(){return typeof F2!="function"||typeof Symbol!="function"||typeof F2("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Tpe()},BP={__proto__:null,foo:{}},Ape=Object,Ipe=function(){return{__proto__:BP}.foo===BP.foo&&!(BP instanceof Ape)},Mpe="Function.prototype.bind called on incompatible ",Ppe=Object.prototype.toString,Rpe=Math.max,kpe="[object Function]",z2=function(e,n){for(var o=[],u=0;u<e.length;u+=1)o[u]=e[u];for(var d=0;d<n.length;d+=1)o[d+e.length]=n[d];return o},Dpe=function(e,n){for(var o=[],u=n,d=0;u<e.length;u+=1,d+=1)o[d]=e[u];return o},Ope=function(t,e){for(var n="",o=0;o<t.length;o+=1)n+=t[o],o+1<t.length&&(n+=e);return n},Lpe=function(e){var n=this;if(typeof n!="function"||Ppe.apply(n)!==kpe)throw new TypeError(Mpe+n);for(var o=Dpe(arguments,1),u,d=function(){if(this instanceof u){var A=n.apply(this,z2(o,arguments));return Object(A)===A?A:this}return n.apply(e,z2(o,arguments))},_=Rpe(0,n.length-o.length),v=[],a=0;a<_;a++)v[a]="$"+a;if(u=Function("binder","return function ("+Ope(v,",")+"){ return binder.apply(this,arguments); }")(d),n.prototype){var C=function(){};C.prototype=n.prototype,u.prototype=new C,C.prototype=null}return u},Bpe=Lpe,VO=Function.prototype.bind||Bpe,Fpe=Function.prototype.call,zpe=Object.prototype.hasOwnProperty,Npe=VO,GH=Npe.call(Fpe,zpe),jn,Upe=bpe,$pe=wpe,jpe=Cpe,Vpe=Epe,s_=HH,Lg=gf,Hpe=Spe,WH=Function,FP=function(t){try{return WH('"use strict"; return ('+t+").constructor;")()}catch{}},Wp=Object.getOwnPropertyDescriptor;if(Wp)try{Wp({},"")}catch{Wp=null}var zP=function(){throw new Lg},Gpe=Wp?function(){try{return arguments.callee,zP}catch{try{return Wp(arguments,"callee").get}catch{return zP}}}():zP,K0=jO(),Wpe=Ipe(),is=Object.getPrototypeOf||(Wpe?function(t){return t.__proto__}:null),tg={},qpe=typeof Uint8Array>"u"||!is?jn:is(Uint8Array),qp={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?jn:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?jn:ArrayBuffer,"%ArrayIteratorPrototype%":K0&&is?is([][Symbol.iterator]()):jn,"%AsyncFromSyncIteratorPrototype%":jn,"%AsyncFunction%":tg,"%AsyncGenerator%":tg,"%AsyncGeneratorFunction%":tg,"%AsyncIteratorPrototype%":tg,"%Atomics%":typeof Atomics>"u"?jn:Atomics,"%BigInt%":typeof BigInt>"u"?jn:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?jn:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?jn:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?jn:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Upe,"%eval%":eval,"%EvalError%":$pe,"%Float32Array%":typeof Float32Array>"u"?jn:Float32Array,"%Float64Array%":typeof Float64Array>"u"?jn:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?jn:FinalizationRegistry,"%Function%":WH,"%GeneratorFunction%":tg,"%Int8Array%":typeof Int8Array>"u"?jn:Int8Array,"%Int16Array%":typeof Int16Array>"u"?jn:Int16Array,"%Int32Array%":typeof Int32Array>"u"?jn:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":K0&&is?is(is([][Symbol.iterator]())):jn,"%JSON%":typeof JSON=="object"?JSON:jn,"%Map%":typeof Map>"u"?jn:Map,"%MapIteratorPrototype%":typeof Map>"u"||!K0||!is?jn:is(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?jn:Promise,"%Proxy%":typeof Proxy>"u"?jn:Proxy,"%RangeError%":jpe,"%ReferenceError%":Vpe,"%Reflect%":typeof Reflect>"u"?jn:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?jn:Set,"%SetIteratorPrototype%":typeof Set>"u"||!K0||!is?jn:is(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?jn:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":K0&&is?is(""[Symbol.iterator]()):jn,"%Symbol%":K0?Symbol:jn,"%SyntaxError%":s_,"%ThrowTypeError%":Gpe,"%TypedArray%":qpe,"%TypeError%":Lg,"%Uint8Array%":typeof Uint8Array>"u"?jn:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?jn:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?jn:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?jn:Uint32Array,"%URIError%":Hpe,"%WeakMap%":typeof WeakMap>"u"?jn:WeakMap,"%WeakRef%":typeof WeakRef>"u"?jn:WeakRef,"%WeakSet%":typeof WeakSet>"u"?jn:WeakSet};if(is)try{null.error}catch(t){var Kpe=is(is(t));qp["%Error.prototype%"]=Kpe}var Ype=function t(e){var n;if(e==="%AsyncFunction%")n=FP("async function () {}");else if(e==="%GeneratorFunction%")n=FP("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=FP("async function* () {}");else if(e==="%AsyncGenerator%"){var o=t("%AsyncGeneratorFunction%");o&&(n=o.prototype)}else if(e==="%AsyncIteratorPrototype%"){var u=t("%AsyncGenerator%");u&&is&&(n=is(u.prototype))}return qp[e]=n,n},N2={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},q1=VO,wS=GH,Zpe=q1.call(Function.call,Array.prototype.concat),Xpe=q1.call(Function.apply,Array.prototype.splice),U2=q1.call(Function.call,String.prototype.replace),CS=q1.call(Function.call,String.prototype.slice),Qpe=q1.call(Function.call,RegExp.prototype.exec),Jpe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,eme=/\\(\\)?/g,tme=function(e){var n=CS(e,0,1),o=CS(e,-1);if(n==="%"&&o!=="%")throw new s_("invalid intrinsic syntax, expected closing `%`");if(o==="%"&&n!=="%")throw new s_("invalid intrinsic syntax, expected opening `%`");var u=[];return U2(e,Jpe,function(d,_,v,a){u[u.length]=v?U2(a,eme,"$1"):_||d}),u},rme=function(e,n){var o=e,u;if(wS(N2,o)&&(u=N2[o],o="%"+u[0]+"%"),wS(qp,o)){var d=qp[o];if(d===tg&&(d=Ype(o)),typeof d>"u"&&!n)throw new Lg("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:u,name:o,value:d}}throw new s_("intrinsic "+e+" does not exist!")},_u=function(e,n){if(typeof e!="string"||e.length===0)throw new Lg("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Lg('"allowMissing" argument must be a boolean');if(Qpe(/^%?[^%]*%?$/,e)===null)throw new s_("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var o=tme(e),u=o.length>0?o[0]:"",d=rme("%"+u+"%",n),_=d.name,v=d.value,a=!1,C=d.alias;C&&(u=C[0],Xpe(o,Zpe([0,1],C)));for(var A=1,k=!0;A<o.length;A+=1){var O=o[A],R=CS(O,0,1),z=CS(O,-1);if((R==='"'||R==="'"||R==="`"||z==='"'||z==="'"||z==="`")&&R!==z)throw new s_("property names with quotes must have matching quotes");if((O==="constructor"||!k)&&(a=!0),u+="."+O,_="%"+u+"%",wS(qp,_))v=qp[_];else if(v!=null){if(!(O in v)){if(!n)throw new Lg("base intrinsic for "+e+" exists, but the property is not available.");return}if(Wp&&A+1>=o.length){var N=Wp(v,O);k=!!N,k&&"get"in N&&!("originalValue"in N.get)?v=N.get:v=v[O]}else k=wS(v,O),v=v[O];k&&!a&&(qp[_]=v)}}return v},nme=_u,_E=nme("%Object.defineProperty%",!0)||!1;if(_E)try{_E({},"a",{value:1})}catch{_E=!1}var HO=_E,ime=_u,yE=ime("%Object.getOwnPropertyDescriptor%",!0);if(yE)try{yE([],"length")}catch{yE=null}var GO=yE,$2=HO,ome=HH,Y0=gf,j2=GO,WO=function(e,n,o){if(!e||typeof e!="object"&&typeof e!="function")throw new Y0("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new Y0("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Y0("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Y0("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Y0("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Y0("`loose`, if provided, must be a boolean");var u=arguments.length>3?arguments[3]:null,d=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,v=arguments.length>6?arguments[6]:!1,a=!!j2&&j2(e,n);if($2)$2(e,n,{configurable:_===null&&a?a.configurable:!_,enumerable:u===null&&a?a.enumerable:!u,value:o,writable:d===null&&a?a.writable:!d});else if(v||!u&&!d&&!_)e[n]=o;else throw new ome("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Nk=HO,qH=function(){return!!Nk};qH.hasArrayLengthDefineBug=function(){if(!Nk)return null;try{return Nk([],"length",{value:1}).length!==1}catch{return!0}};var qO=qH,sme=$O,ame=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",lme=Object.prototype.toString,cme=Array.prototype.concat,V2=WO,ume=function(t){return typeof t=="function"&&lme.call(t)==="[object Function]"},KH=qO(),hme=function(t,e,n,o){if(e in t){if(o===!0){if(t[e]===n)return}else if(!ume(o)||!o())return}KH?V2(t,e,n,!0):V2(t,e,n)},YH=function(t,e){var n=arguments.length>2?arguments[2]:{},o=sme(e);ame&&(o=cme.call(o,Object.getOwnPropertySymbols(e)));for(var u=0;u<o.length;u+=1)hme(t,o[u],e[o[u]],n[o[u]])};YH.supportsDescriptors=!!KH;var bm=YH,ZH={exports:{}},dme=_u,H2=WO,fme=qO(),G2=GO,W2=gf,pme=dme("%Math.floor%"),mme=function(e,n){if(typeof e!="function")throw new W2("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||pme(n)!==n)throw new W2("`length` must be a positive 32-bit integer");var o=arguments.length>2&&!!arguments[2],u=!0,d=!0;if("length"in e&&G2){var _=G2(e,"length");_&&!_.configurable&&(u=!1),_&&!_.writable&&(d=!1)}return(u||d||!o)&&(fme?H2(e,"length",n,!0,!0):H2(e,"length",n)),e};(function(t){var e=VO,n=_u,o=mme,u=gf,d=n("%Function.prototype.apply%"),_=n("%Function.prototype.call%"),v=n("%Reflect.apply%",!0)||e.call(_,d),a=HO,C=n("%Math.max%");t.exports=function(O){if(typeof O!="function")throw new u("a function is required");var R=v(e,_,arguments);return o(R,1+C(0,O.length-(arguments.length-1)),!0)};var A=function(){return v(e,d,arguments)};a?a(t.exports,"apply",{value:A}):t.exports.apply=A})(ZH);var D_=ZH.exports,XH=_u,QH=D_,gme=QH(XH("String.prototype.indexOf")),Ul=function(e,n){var o=XH(e,!!n);return typeof o=="function"&&gme(e,".prototype.")>-1?QH(o):o},_me=$O,JH=DA(),eG=Ul,q2=Object,yme=eG("Array.prototype.push"),K2=eG("Object.prototype.propertyIsEnumerable"),vme=JH?Object.getOwnPropertySymbols:null,tG=function(e,n){if(e==null)throw new TypeError("target must be an object");var o=q2(e);if(arguments.length===1)return o;for(var u=1;u<arguments.length;++u){var d=q2(arguments[u]),_=_me(d),v=JH&&(Object.getOwnPropertySymbols||vme);if(v)for(var a=v(d),C=0;C<a.length;++C){var A=a[C];K2(d,A)&&yme(_,A)}for(var k=0;k<_.length;++k){var O=_[k];if(K2(d,O)){var R=d[O];o[O]=R}}}return o},NP=tG,xme=function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),n={},o=0;o<e.length;++o)n[e[o]]=e[o];var u=Object.assign({},n),d="";for(var _ in u)d+=_;return t!==d},bme=function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch{return t[1]==="y"}return!1},rG=function(){return!Object.assign||xme()||bme()?NP:Object.assign},wme=bm,Cme=rG,Eme=function(){var e=Cme();return wme(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e},Sme=bm,Tme=D_,Ame=tG,nG=rG,Ime=Eme,Mme=Tme.apply(nG()),iG=function(e,n){return Mme(Object,arguments)};Sme(iG,{getPolyfill:nG,implementation:Ame,shim:Ime});var Pme=iG,x1=function(){return typeof function(){}.name=="string"},Dx=Object.getOwnPropertyDescriptor;if(Dx)try{Dx([],"length")}catch{Dx=null}x1.functionsHaveConfigurableNames=function(){if(!x1()||!Dx)return!1;var e=Dx(function(){},"name");return!!e&&!!e.configurable};var Rme=Function.prototype.bind;x1.boundFunctionsHaveNames=function(){return x1()&&typeof Rme=="function"&&function(){}.bind().name!==""};var kme=x1,Y2=WO,Dme=qO(),Ome=kme.functionsHaveConfigurableNames(),Lme=gf,Bme=function(e,n){if(typeof e!="function")throw new Lme("`fn` is not a function");var o=arguments.length>2&&!!arguments[2];return(!o||Ome)&&(Dme?Y2(e,"name",n,!0,!0):Y2(e,"name",n)),e},Fme=Bme,zme=gf,Nme=Object,oG=Fme(function(){if(this==null||this!==Nme(this))throw new zme("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),Ume=oG,$me=bm.supportsDescriptors,jme=Object.getOwnPropertyDescriptor,sG=function(){if($me&&/a/mig.flags==="gim"){var e=jme(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var n="",o={};if(Object.defineProperty(o,"hasIndices",{get:function(){n+="d"}}),Object.defineProperty(o,"sticky",{get:function(){n+="y"}}),n==="dy")return e.get}}return Ume},Vme=bm.supportsDescriptors,Hme=sG,Gme=Object.getOwnPropertyDescriptor,Wme=Object.defineProperty,qme=TypeError,Z2=Object.getPrototypeOf,Kme=/a/,Yme=function(){if(!Vme||!Z2)throw new qme("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=Hme(),n=Z2(Kme),o=Gme(n,"flags");return(!o||o.get!==e)&&Wme(n,"flags",{configurable:!0,enumerable:!1,get:e}),e},Zme=bm,Xme=D_,Qme=oG,aG=sG,Jme=Yme,lG=Xme(aG());Zme(lG,{getPolyfill:aG,implementation:Qme,shim:Jme});var e0e=lG,vE={exports:{}},t0e=DA,wm=function(){return t0e()&&!!Symbol.toStringTag},r0e=wm(),n0e=Ul,Uk=n0e("Object.prototype.toString"),OA=function(e){return r0e&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Uk(e)==="[object Arguments]"},cG=function(e){return OA(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Uk(e)!=="[object Array]"&&Uk(e.callee)==="[object Function]"},i0e=function(){return OA(arguments)}();OA.isLegacyArguments=cG;var uG=i0e?OA:cG,KO=typeof Map=="function"&&Map.prototype,UP=Object.getOwnPropertyDescriptor&&KO?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ES=KO&&UP&&typeof UP.get=="function"?UP.get:null,X2=KO&&Map.prototype.forEach,YO=typeof Set=="function"&&Set.prototype,$P=Object.getOwnPropertyDescriptor&&YO?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,SS=YO&&$P&&typeof $P.get=="function"?$P.get:null,Q2=YO&&Set.prototype.forEach,o0e=typeof WeakMap=="function"&&WeakMap.prototype,Ox=o0e?WeakMap.prototype.has:null,s0e=typeof WeakSet=="function"&&WeakSet.prototype,Lx=s0e?WeakSet.prototype.has:null,a0e=typeof WeakRef=="function"&&WeakRef.prototype,J2=a0e?WeakRef.prototype.deref:null,l0e=Boolean.prototype.valueOf,c0e=Object.prototype.toString,u0e=Function.prototype.toString,h0e=String.prototype.match,ZO=String.prototype.slice,Fd=String.prototype.replace,d0e=String.prototype.toUpperCase,eU=String.prototype.toLowerCase,hG=RegExp.prototype.test,tU=Array.prototype.concat,Jc=Array.prototype.join,f0e=Array.prototype.slice,rU=Math.floor,$k=typeof BigInt=="function"?BigInt.prototype.valueOf:null,jP=Object.getOwnPropertySymbols,jk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,a_=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Gs=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===a_||!0)?Symbol.toStringTag:null,dG=Object.prototype.propertyIsEnumerable,nU=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function iU(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||hG.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var o=t<0?-rU(-t):rU(t);if(o!==t){var u=String(o),d=ZO.call(e,u.length+1);return Fd.call(u,n,"$&_")+"."+Fd.call(Fd.call(d,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Fd.call(e,n,"$&_")}var Vk=LH,oU=Vk.custom,sU=pG(oU)?oU:null,p0e=function t(e,n,o,u){var d=n||{};if(Rd(d,"quoteStyle")&&d.quoteStyle!=="single"&&d.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Rd(d,"maxStringLength")&&(typeof d.maxStringLength=="number"?d.maxStringLength<0&&d.maxStringLength!==1/0:d.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var _=Rd(d,"customInspect")?d.customInspect:!0;if(typeof _!="boolean"&&_!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Rd(d,"indent")&&d.indent!==null&&d.indent!=="	"&&!(parseInt(d.indent,10)===d.indent&&d.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Rd(d,"numericSeparator")&&typeof d.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=d.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return gG(e,d);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var a=String(e);return v?iU(e,a):a}if(typeof e=="bigint"){var C=String(e)+"n";return v?iU(e,C):C}var A=typeof d.depth>"u"?5:d.depth;if(typeof o>"u"&&(o=0),o>=A&&A>0&&typeof e=="object")return Hk(e)?"[Array]":"[Object]";var k=k0e(d,o);if(typeof u>"u")u=[];else if(mG(u,e)>=0)return"[Circular]";function O(Re,Ye,ht){if(Ye&&(u=f0e.call(u),u.push(Ye)),ht){var ft={depth:d.depth};return Rd(d,"quoteStyle")&&(ft.quoteStyle=d.quoteStyle),t(Re,ft,o+1,u)}return t(Re,d,o+1,u)}if(typeof e=="function"&&!aU(e)){var R=C0e(e),z=RC(e,O);return"[Function"+(R?": "+R:" (anonymous)")+"]"+(z.length>0?" { "+Jc.call(z,", ")+" }":"")}if(pG(e)){var N=a_?Fd.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):jk.call(e);return typeof e=="object"&&!a_?Xv(N):N}if(M0e(e)){for(var K="<"+eU.call(String(e.nodeName)),q=e.attributes||[],j=0;j<q.length;j++)K+=" "+q[j].name+"="+fG(m0e(q[j].value),"double",d);return K+=">",e.childNodes&&e.childNodes.length&&(K+="..."),K+="</"+eU.call(String(e.nodeName))+">",K}if(Hk(e)){if(e.length===0)return"[]";var H=RC(e,O);return k&&!R0e(H)?"["+Gk(H,k)+"]":"[ "+Jc.call(H,", ")+" ]"}if(_0e(e)){var Y=RC(e,O);return!("cause"in Error.prototype)&&"cause"in e&&!dG.call(e,"cause")?"{ ["+String(e)+"] "+Jc.call(tU.call("[cause]: "+O(e.cause),Y),", ")+" }":Y.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Jc.call(Y,", ")+" }"}if(typeof e=="object"&&_){if(sU&&typeof e[sU]=="function"&&Vk)return Vk(e,{depth:A-o});if(_!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(E0e(e)){var te=[];return X2&&X2.call(e,function(Re,Ye){te.push(O(Ye,e,!0)+" => "+O(Re,e))}),lU("Map",ES.call(e),te,k)}if(A0e(e)){var J=[];return Q2&&Q2.call(e,function(Re){J.push(O(Re,e))}),lU("Set",SS.call(e),J,k)}if(S0e(e))return VP("WeakMap");if(I0e(e))return VP("WeakSet");if(T0e(e))return VP("WeakRef");if(v0e(e))return Xv(O(Number(e)));if(b0e(e))return Xv(O($k.call(e)));if(x0e(e))return Xv(l0e.call(e));if(y0e(e))return Xv(O(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof Cn<"u"&&e===Cn)return"{ [object globalThis] }";if(!g0e(e)&&!aU(e)){var ae=RC(e,O),de=nU?nU(e)===Object.prototype:e instanceof Object||e.constructor===Object,Me=e instanceof Object?"":"null prototype",Ce=!de&&Gs&&Object(e)===e&&Gs in e?ZO.call(_f(e),8,-1):Me?"Object":"",Ae=de||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",Ne=Ae+(Ce||Me?"["+Jc.call(tU.call([],Ce||[],Me||[]),": ")+"] ":"");return ae.length===0?Ne+"{}":k?Ne+"{"+Gk(ae,k)+"}":Ne+"{ "+Jc.call(ae,", ")+" }"}return String(e)};function fG(t,e,n){var o=(n.quoteStyle||e)==="double"?'"':"'";return o+t+o}function m0e(t){return Fd.call(String(t),/"/g,"&quot;")}function Hk(t){return _f(t)==="[object Array]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function g0e(t){return _f(t)==="[object Date]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function aU(t){return _f(t)==="[object RegExp]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function _0e(t){return _f(t)==="[object Error]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function y0e(t){return _f(t)==="[object String]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function v0e(t){return _f(t)==="[object Number]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function x0e(t){return _f(t)==="[object Boolean]"&&(!Gs||!(typeof t=="object"&&Gs in t))}function pG(t){if(a_)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!jk)return!1;try{return jk.call(t),!0}catch{}return!1}function b0e(t){if(!t||typeof t!="object"||!$k)return!1;try{return $k.call(t),!0}catch{}return!1}var w0e=Object.prototype.hasOwnProperty||function(t){return t in this};function Rd(t,e){return w0e.call(t,e)}function _f(t){return c0e.call(t)}function C0e(t){if(t.name)return t.name;var e=h0e.call(u0e.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function mG(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,o=t.length;n<o;n++)if(t[n]===e)return n;return-1}function E0e(t){if(!ES||!t||typeof t!="object")return!1;try{ES.call(t);try{SS.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function S0e(t){if(!Ox||!t||typeof t!="object")return!1;try{Ox.call(t,Ox);try{Lx.call(t,Lx)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function T0e(t){if(!J2||!t||typeof t!="object")return!1;try{return J2.call(t),!0}catch{}return!1}function A0e(t){if(!SS||!t||typeof t!="object")return!1;try{SS.call(t);try{ES.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function I0e(t){if(!Lx||!t||typeof t!="object")return!1;try{Lx.call(t,Lx);try{Ox.call(t,Ox)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function M0e(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function gG(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,o="... "+n+" more character"+(n>1?"s":"");return gG(ZO.call(t,0,e.maxStringLength),e)+o}var u=Fd.call(Fd.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,P0e);return fG(u,"single",e)}function P0e(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+d0e.call(e.toString(16))}function Xv(t){return"Object("+t+")"}function VP(t){return t+" { ? }"}function lU(t,e,n,o){var u=o?Gk(n,o):Jc.call(n,", ");return t+" ("+e+") {"+u+"}"}function R0e(t){for(var e=0;e<t.length;e++)if(mG(t[e],`
`)>=0)return!1;return!0}function k0e(t,e){var n;if(t.indent==="	")n="	";else if(typeof t.indent=="number"&&t.indent>0)n=Jc.call(Array(t.indent+1)," ");else return null;return{base:n,prev:Jc.call(Array(e+1),n)}}function Gk(t,e){if(t.length===0)return"";var n=`
`+e.prev+e.base;return n+Jc.call(t,","+n)+`
`+e.prev}function RC(t,e){var n=Hk(t),o=[];if(n){o.length=t.length;for(var u=0;u<t.length;u++)o[u]=Rd(t,u)?e(t[u],t):""}var d=typeof jP=="function"?jP(t):[],_;if(a_){_={};for(var v=0;v<d.length;v++)_["$"+d[v]]=d[v]}for(var a in t)Rd(t,a)&&(n&&String(Number(a))===a&&a<t.length||a_&&_["$"+a]instanceof Symbol||(hG.call(/[^\w$]/,a)?o.push(e(a,t)+": "+e(t[a],t)):o.push(a+": "+e(t[a],t))));if(typeof jP=="function")for(var C=0;C<d.length;C++)dG.call(t,d[C])&&o.push("["+e(d[C])+"]: "+e(t[d[C]],t));return o}var _G=_u,O_=Ul,D0e=p0e,O0e=gf,kC=_G("%WeakMap%",!0),DC=_G("%Map%",!0),L0e=O_("WeakMap.prototype.get",!0),B0e=O_("WeakMap.prototype.set",!0),F0e=O_("WeakMap.prototype.has",!0),z0e=O_("Map.prototype.get",!0),N0e=O_("Map.prototype.set",!0),U0e=O_("Map.prototype.has",!0),XO=function(t,e){for(var n=t,o;(o=n.next)!==null;n=o)if(o.key===e)return n.next=o.next,o.next=t.next,t.next=o,o},$0e=function(t,e){var n=XO(t,e);return n&&n.value},j0e=function(t,e,n){var o=XO(t,e);o?o.value=n:t.next={key:e,next:t.next,value:n}},V0e=function(t,e){return!!XO(t,e)},yG=function(){var e,n,o,u={assert:function(d){if(!u.has(d))throw new O0e("Side channel does not contain "+D0e(d))},get:function(d){if(kC&&d&&(typeof d=="object"||typeof d=="function")){if(e)return L0e(e,d)}else if(DC){if(n)return z0e(n,d)}else if(o)return $0e(o,d)},has:function(d){if(kC&&d&&(typeof d=="object"||typeof d=="function")){if(e)return F0e(e,d)}else if(DC){if(n)return U0e(n,d)}else if(o)return V0e(o,d);return!1},set:function(d,_){kC&&d&&(typeof d=="object"||typeof d=="function")?(e||(e=new kC),B0e(e,d,_)):DC?(n||(n=new DC),N0e(n,d,_)):(o||(o={key:{},next:null}),j0e(o,d,_))}};return u},H0e=GH,Qv=yG(),qu=gf,QO={assert:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new qu("`O` is not an object");if(typeof e!="string")throw new qu("`slot` must be a string");if(Qv.assert(t),!QO.has(t,e))throw new qu("`"+e+"` is not present on `O`")},get:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new qu("`O` is not an object");if(typeof e!="string")throw new qu("`slot` must be a string");var n=Qv.get(t);return n&&n["$"+e]},has:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new qu("`O` is not an object");if(typeof e!="string")throw new qu("`slot` must be a string");var n=Qv.get(t);return!!n&&H0e(n,"$"+e)},set:function(t,e,n){if(!t||typeof t!="object"&&typeof t!="function")throw new qu("`O` is not an object");if(typeof e!="string")throw new qu("`slot` must be a string");var o=Qv.get(t);o||(o={},Qv.set(t,o)),o["$"+e]=n}};Object.freeze&&Object.freeze(QO);var G0e=QO,Jv=G0e,W0e=SyntaxError,cU=typeof StopIteration=="object"?StopIteration:null,q0e=function(e){if(!cU)throw new W0e("this environment lacks StopIteration");Jv.set(e,"[[Done]]",!1);var n={next:function(){var u=Jv.get(this,"[[Iterator]]"),d=Jv.get(u,"[[Done]]");try{return{done:d,value:d?void 0:u.next()}}catch(_){if(Jv.set(u,"[[Done]]",!0),_!==cU)throw _;return{done:!0,value:void 0}}}};return Jv.set(n,"[[Iterator]]",e),n},K0e={}.toString,vG=Array.isArray||function(t){return K0e.call(t)=="[object Array]"},Y0e=String.prototype.valueOf,Z0e=function(e){try{return Y0e.call(e),!0}catch{return!1}},X0e=Object.prototype.toString,Q0e="[object String]",J0e=wm(),xG=function(e){return typeof e=="string"?!0:typeof e!="object"?!1:J0e?Z0e(e):X0e.call(e)===Q0e},JO=typeof Map=="function"&&Map.prototype?Map:null,ege=typeof Set=="function"&&Set.prototype?Set:null,TS;JO||(TS=function(e){return!1});var bG=JO?Map.prototype.has:null,uU=ege?Set.prototype.has:null;!TS&&!bG&&(TS=function(e){return!1});var wG=TS||function(e){if(!e||typeof e!="object")return!1;try{if(bG.call(e),uU)try{uU.call(e)}catch{return!0}return e instanceof JO}catch{}return!1},tge=typeof Map=="function"&&Map.prototype?Map:null,e5=typeof Set=="function"&&Set.prototype?Set:null,AS;e5||(AS=function(e){return!1});var hU=tge?Map.prototype.has:null,CG=e5?Set.prototype.has:null;!AS&&!CG&&(AS=function(e){return!1});var EG=AS||function(e){if(!e||typeof e!="object")return!1;try{if(CG.call(e),hU)try{hU.call(e)}catch{return!0}return e instanceof e5}catch{}return!1},dU=uG,fU=q0e;if(jO()||DA()){var HP=Symbol.iterator;vE.exports=function(e){if(e!=null&&typeof e[HP]<"u")return e[HP]();if(dU(e))return Array.prototype[HP].call(e)}}else{var rge=vG,nge=xG,pU=_u,ige=pU("%Map%",!0),oge=pU("%Set%",!0),ac=Ul,mU=ac("Array.prototype.push"),gU=ac("String.prototype.charCodeAt"),sge=ac("String.prototype.slice"),age=function(e,n){var o=e.length;if(n+1>=o)return n+1;var u=gU(e,n);if(u<55296||u>56319)return n+1;var d=gU(e,n+1);return d<56320||d>57343?n+1:n+2},GP=function(e){var n=0;return{next:function(){var u=n>=e.length,d;return u||(d=e[n],n+=1),{done:u,value:d}}}},_U=function(e,n){if(rge(e)||dU(e))return GP(e);if(nge(e)){var o=0;return{next:function(){var d=age(e,o),_=sge(e,o,d);return o=d,{done:d>e.length,value:_}}}}if(n&&typeof e["_es6-shim iterator_"]<"u")return e["_es6-shim iterator_"]()};if(!ige&&!oge)vE.exports=function(e){if(e!=null)return _U(e,!0)};else{var lge=wG,cge=EG,yU=ac("Map.prototype.forEach",!0),vU=ac("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var xU=ac("Map.prototype.iterator",!0),bU=ac("Set.prototype.iterator",!0);var wU=ac("Map.prototype.@@iterator",!0)||ac("Map.prototype._es6-shim iterator_",!0),CU=ac("Set.prototype.@@iterator",!0)||ac("Set.prototype._es6-shim iterator_",!0),uge=function(e){if(lge(e)){if(xU)return fU(xU(e));if(wU)return wU(e);if(yU){var n=[];return yU(e,function(u,d){mU(n,[d,u])}),GP(n)}}if(cge(e)){if(bU)return fU(bU(e));if(CU)return CU(e);if(vU){var o=[];return vU(e,function(u){mU(o,u)}),GP(o)}}};vE.exports=function(e){return uge(e)||_U(e)}}}var hge=vE.exports,EU=function(t){return t!==t},SG=function(e,n){return e===0&&n===0?1/e===1/n:!!(e===n||EU(e)&&EU(n))},dge=SG,TG=function(){return typeof Object.is=="function"?Object.is:dge},fge=TG,pge=bm,mge=function(){var e=fge();return pge(Object,{is:e},{is:function(){return Object.is!==e}}),e},gge=bm,_ge=D_,yge=SG,AG=TG,vge=mge,IG=_ge(AG(),Object);gge(IG,{getPolyfill:AG,implementation:yge,shim:vge});var xge=IG,bge=D_,MG=Ul,wge=_u,Wk=wge("%ArrayBuffer%",!0),xE=MG("ArrayBuffer.prototype.byteLength",!0),Cge=MG("Object.prototype.toString"),SU=!!Wk&&!xE&&new Wk(0).slice,TU=!!SU&&bge(SU),PG=xE||TU?function(e){if(!e||typeof e!="object")return!1;try{return xE?xE(e):TU(e,0),!0}catch{return!1}}:Wk?function(e){return Cge(e)==="[object ArrayBuffer]"}:function(e){return!1},Ege=Date.prototype.getDay,Sge=function(e){try{return Ege.call(e),!0}catch{return!1}},Tge=Object.prototype.toString,Age="[object Date]",Ige=wm(),Mge=function(e){return typeof e!="object"||e===null?!1:Ige?Sge(e):Tge.call(e)===Age},qk=Ul,RG=wm(),kG,DG,Kk,Yk;if(RG){kG=qk("Object.prototype.hasOwnProperty"),DG=qk("RegExp.prototype.exec"),Kk={};var WP=function(){throw Kk};Yk={toString:WP,valueOf:WP},typeof Symbol.toPrimitive=="symbol"&&(Yk[Symbol.toPrimitive]=WP)}var Pge=qk("Object.prototype.toString"),Rge=Object.getOwnPropertyDescriptor,kge="[object RegExp]",Dge=RG?function(e){if(!e||typeof e!="object")return!1;var n=Rge(e,"lastIndex"),o=n&&kG(n,"value");if(!o)return!1;try{DG(e,Yk)}catch(u){return u===Kk}}:function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:Pge(e)===kge},Oge=Ul,AU=Oge("SharedArrayBuffer.prototype.byteLength",!0),Lge=AU?function(e){if(!e||typeof e!="object")return!1;try{return AU(e),!0}catch{return!1}}:function(e){return!1},Bge=Number.prototype.toString,Fge=function(e){try{return Bge.call(e),!0}catch{return!1}},zge=Object.prototype.toString,Nge="[object Number]",Uge=wm(),$ge=function(e){return typeof e=="number"?!0:typeof e!="object"?!1:Uge?Fge(e):zge.call(e)===Nge},OG=Ul,jge=OG("Boolean.prototype.toString"),Vge=OG("Object.prototype.toString"),Hge=function(e){try{return jge(e),!0}catch{return!1}},Gge="[object Boolean]",Wge=wm(),qge=function(e){return typeof e=="boolean"?!0:e===null||typeof e!="object"?!1:Wge&&Symbol.toStringTag in e?Hge(e):Vge(e)===Gge},Zk={exports:{}},Kge=Object.prototype.toString,Yge=jO();if(Yge){var Zge=Symbol.prototype.toString,Xge=/^Symbol\(.*\)$/,Qge=function(e){return typeof e.valueOf()!="symbol"?!1:Xge.test(Zge.call(e))};Zk.exports=function(e){if(typeof e=="symbol")return!0;if(Kge.call(e)!=="[object Symbol]")return!1;try{return Qge(e)}catch{return!1}}}else Zk.exports=function(e){return!1};var Jge=Zk.exports,Xk={exports:{}},IU=typeof BigInt<"u"&&BigInt,e_e=function(){return typeof IU=="function"&&typeof BigInt=="function"&&typeof IU(42)=="bigint"&&typeof BigInt(42)=="bigint"},t_e=e_e();if(t_e){var r_e=BigInt.prototype.valueOf,n_e=function(e){try{return r_e.call(e),!0}catch{}return!1};Xk.exports=function(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="function"?!1:typeof e=="bigint"?!0:n_e(e)}}else Xk.exports=function(e){return!1};var i_e=Xk.exports,o_e=xG,s_e=$ge,a_e=qge,l_e=Jge,c_e=i_e,u_e=function(e){if(e==null||typeof e!="object"&&typeof e!="function")return null;if(o_e(e))return"String";if(s_e(e))return"Number";if(a_e(e))return"Boolean";if(l_e(e))return"Symbol";if(c_e(e))return"BigInt"},IS=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,MU=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,MS;IS||(MS=function(e){return!1});var Qk=IS?IS.prototype.has:null,qP=MU?MU.prototype.has:null;!MS&&!Qk&&(MS=function(e){return!1});var h_e=MS||function(e){if(!e||typeof e!="object")return!1;try{if(Qk.call(e,Qk),qP)try{qP.call(e,qP)}catch{return!0}return e instanceof IS}catch{}return!1},Jk={exports:{}},d_e=_u,LG=Ul,f_e=d_e("%WeakSet%",!0),KP=LG("WeakSet.prototype.has",!0);if(KP){var YP=LG("WeakMap.prototype.has",!0);Jk.exports=function(e){if(!e||typeof e!="object")return!1;try{if(KP(e,KP),YP)try{YP(e,YP)}catch{return!0}return e instanceof f_e}catch{}return!1}}else Jk.exports=function(e){return!1};var p_e=Jk.exports,m_e=wG,g_e=EG,__e=h_e,y_e=p_e,v_e=function(e){if(e&&typeof e=="object"){if(m_e(e))return"Map";if(g_e(e))return"Set";if(__e(e))return"WeakMap";if(y_e(e))return"WeakSet"}return!1},BG=Function.prototype.toString,bg=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,e4,bE;if(typeof bg=="function"&&typeof Object.defineProperty=="function")try{e4=Object.defineProperty({},"length",{get:function(){throw bE}}),bE={},bg(function(){throw 42},null,e4)}catch(t){t!==bE&&(bg=null)}else bg=null;var x_e=/^\s*class\b/,t4=function(e){try{var n=BG.call(e);return x_e.test(n)}catch{return!1}},ZP=function(e){try{return t4(e)?!1:(BG.call(e),!0)}catch{return!1}},wE=Object.prototype.toString,b_e="[object Object]",w_e="[object Function]",C_e="[object GeneratorFunction]",E_e="[object HTMLAllCollection]",S_e="[object HTML document.all class]",T_e="[object HTMLCollection]",A_e=typeof Symbol=="function"&&!!Symbol.toStringTag,I_e=!(0 in[,]),r4=function(){return!1};if(typeof document=="object"){var M_e=document.all;wE.call(M_e)===wE.call(document.all)&&(r4=function(e){if((I_e||!e)&&(typeof e>"u"||typeof e=="object"))try{var n=wE.call(e);return(n===E_e||n===S_e||n===T_e||n===b_e)&&e("")==null}catch{}return!1})}var P_e=bg?function(e){if(r4(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{bg(e,null,e4)}catch(n){if(n!==bE)return!1}return!t4(e)&&ZP(e)}:function(e){if(r4(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(A_e)return ZP(e);if(t4(e))return!1;var n=wE.call(e);return n!==w_e&&n!==C_e&&!/^\[object HTML/.test(n)?!1:ZP(e)},R_e=P_e,k_e=Object.prototype.toString,FG=Object.prototype.hasOwnProperty,D_e=function(e,n,o){for(var u=0,d=e.length;u<d;u++)FG.call(e,u)&&(o==null?n(e[u],u,e):n.call(o,e[u],u,e))},O_e=function(e,n,o){for(var u=0,d=e.length;u<d;u++)o==null?n(e.charAt(u),u,e):n.call(o,e.charAt(u),u,e)},L_e=function(e,n,o){for(var u in e)FG.call(e,u)&&(o==null?n(e[u],u,e):n.call(o,e[u],u,e))},B_e=function(e,n,o){if(!R_e(n))throw new TypeError("iterator must be a function");var u;arguments.length>=3&&(u=o),k_e.call(e)==="[object Array]"?D_e(e,n,u):typeof e=="string"?O_e(e,n,u):L_e(e,n,u)},F_e=B_e,z_e=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],XP=z_e,N_e=typeof globalThis>"u"?Cn:globalThis,U_e=function(){for(var e=[],n=0;n<XP.length;n++)typeof N_e[XP[n]]=="function"&&(e[e.length]=XP[n]);return e},PS=F_e,$_e=U_e,PU=D_,t5=Ul,CE=GO,j_e=t5("Object.prototype.toString"),zG=wm(),RU=typeof globalThis>"u"?Cn:globalThis,n4=$_e(),r5=t5("String.prototype.slice"),QP=Object.getPrototypeOf,V_e=t5("Array.prototype.indexOf",!0)||function(e,n){for(var o=0;o<e.length;o+=1)if(e[o]===n)return o;return-1},RS={__proto__:null};zG&&CE&&QP?PS(n4,function(t){var e=new RU[t];if(Symbol.toStringTag in e){var n=QP(e),o=CE(n,Symbol.toStringTag);if(!o){var u=QP(n);o=CE(u,Symbol.toStringTag)}RS["$"+t]=PU(o.get)}}):PS(n4,function(t){var e=new RU[t],n=e.slice||e.set;n&&(RS["$"+t]=PU(n))});var H_e=function(e){var n=!1;return PS(RS,function(o,u){if(!n)try{"$"+o(e)===u&&(n=r5(u,1))}catch{}}),n},G_e=function(e){var n=!1;return PS(RS,function(o,u){if(!n)try{o(e),n=r5(u,1)}catch{}}),n},W_e=function(e){if(!e||typeof e!="object")return!1;if(!zG){var n=r5(j_e(e),8,-1);return V_e(n4,n)>-1?n:n!=="Object"?!1:G_e(e)}return CE?H_e(e):null},q_e=Ul,kU=q_e("ArrayBuffer.prototype.byteLength",!0),K_e=PG,Y_e=function(e){return K_e(e)?kU?kU(e):e.byteLength:NaN},NG=Pme,yu=Ul,DU=e0e,Z_e=_u,l_=hge,X_e=yG,OU=xge,LU=uG,BU=vG,FU=PG,zU=Mge,NU=Dge,UU=Lge,$U=$O,jU=u_e,VU=v_e,HU=W_e,GU=Y_e,WU=yu("SharedArrayBuffer.prototype.byteLength",!0),qU=yu("Date.prototype.getTime"),JP=Object.getPrototypeOf,KU=yu("Object.prototype.toString"),kS=Z_e("%Set%",!0),i4=yu("Map.prototype.has",!0),DS=yu("Map.prototype.get",!0),YU=yu("Map.prototype.size",!0),OS=yu("Set.prototype.add",!0),UG=yu("Set.prototype.delete",!0),LS=yu("Set.prototype.has",!0),EE=yu("Set.prototype.size",!0);function ZU(t,e,n,o){for(var u=l_(t),d;(d=u.next())&&!d.done;)if(vc(e,d.value,n,o))return UG(t,d.value),!0;return!1}function $G(t){if(typeof t>"u")return null;if(typeof t!="object")return typeof t=="symbol"?!1:typeof t=="string"||typeof t=="number"?+t==+t:!0}function Q_e(t,e,n,o,u,d){var _=$G(n);if(_!=null)return _;var v=DS(e,_),a=NG({},u,{strict:!1});return typeof v>"u"&&!i4(e,_)||!vc(o,v,a,d)?!1:!i4(t,_)&&vc(o,v,a,d)}function J_e(t,e,n){var o=$G(n);return o??(LS(e,o)&&!LS(t,o))}function XU(t,e,n,o,u,d){for(var _=l_(t),v,a;(v=_.next())&&!v.done;)if(a=v.value,vc(n,a,u,d)&&vc(o,DS(e,a),u,d))return UG(t,a),!0;return!1}function vc(t,e,n,o){var u=n||{};if(u.strict?OU(t,e):t===e)return!0;var d=jU(t),_=jU(e);if(d!==_)return!1;if(!t||!e||typeof t!="object"&&typeof e!="object")return u.strict?OU(t,e):t==e;var v=o.has(t),a=o.has(e),C;if(v&&a){if(o.get(t)===o.get(e))return!0}else C={};return v||o.set(t,C),a||o.set(e,C),rye(t,e,u,o)}function QU(t){return!t||typeof t!="object"||typeof t.length!="number"||typeof t.copy!="function"||typeof t.slice!="function"||t.length>0&&typeof t[0]!="number"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function eye(t,e,n,o){if(EE(t)!==EE(e))return!1;for(var u=l_(t),d=l_(e),_,v,a;(_=u.next())&&!_.done;)if(_.value&&typeof _.value=="object")a||(a=new kS),OS(a,_.value);else if(!LS(e,_.value)){if(n.strict||!J_e(t,e,_.value))return!1;a||(a=new kS),OS(a,_.value)}if(a){for(;(v=d.next())&&!v.done;)if(v.value&&typeof v.value=="object"){if(!ZU(a,v.value,n.strict,o))return!1}else if(!n.strict&&!LS(t,v.value)&&!ZU(a,v.value,n.strict,o))return!1;return EE(a)===0}return!0}function tye(t,e,n,o){if(YU(t)!==YU(e))return!1;for(var u=l_(t),d=l_(e),_,v,a,C,A,k;(_=u.next())&&!_.done;)if(C=_.value[0],A=_.value[1],C&&typeof C=="object")a||(a=new kS),OS(a,C);else if(k=DS(e,C),typeof k>"u"&&!i4(e,C)||!vc(A,k,n,o)){if(n.strict||!Q_e(t,e,C,A,n,o))return!1;a||(a=new kS),OS(a,C)}if(a){for(;(v=d.next())&&!v.done;)if(C=v.value[0],k=v.value[1],C&&typeof C=="object"){if(!XU(a,t,C,k,n,o))return!1}else if(!n.strict&&(!t.has(C)||!vc(DS(t,C),k,n,o))&&!XU(a,t,C,k,NG({},n,{strict:!1}),o))return!1;return EE(a)===0}return!0}function rye(t,e,n,o){var u,d;if(typeof t!=typeof e||t==null||e==null||KU(t)!==KU(e)||LU(t)!==LU(e))return!1;var _=BU(t),v=BU(e);if(_!==v)return!1;var a=t instanceof Error,C=e instanceof Error;if(a!==C||(a||C)&&(t.name!==e.name||t.message!==e.message))return!1;var A=NU(t),k=NU(e);if(A!==k||(A||k)&&(t.source!==e.source||DU(t)!==DU(e)))return!1;var O=zU(t),R=zU(e);if(O!==R||(O||R)&&qU(t)!==qU(e)||n.strict&&JP&&JP(t)!==JP(e))return!1;var z=HU(t),N=HU(e);if(z!==N)return!1;if(z||N){if(t.length!==e.length)return!1;for(u=0;u<t.length;u++)if(t[u]!==e[u])return!1;return!0}var K=QU(t),q=QU(e);if(K!==q)return!1;if(K||q){if(t.length!==e.length)return!1;for(u=0;u<t.length;u++)if(t[u]!==e[u])return!1;return!0}var j=FU(t),H=FU(e);if(j!==H)return!1;if(j||H)return GU(t)!==GU(e)?!1:typeof Uint8Array=="function"&&vc(new Uint8Array(t),new Uint8Array(e),n,o);var Y=UU(t),te=UU(e);if(Y!==te)return!1;if(Y||te)return WU(t)!==WU(e)?!1:typeof Uint8Array=="function"&&vc(new Uint8Array(t),new Uint8Array(e),n,o);if(typeof t!=typeof e)return!1;var J=$U(t),ae=$U(e);if(J.length!==ae.length)return!1;for(J.sort(),ae.sort(),u=J.length-1;u>=0;u--)if(J[u]!=ae[u])return!1;for(u=J.length-1;u>=0;u--)if(d=J[u],!vc(t[d],e[d],n,o))return!1;var de=VU(t),Me=VU(e);return de!==Me?!1:de==="Set"||Me==="Set"?eye(t,e,n,o):de==="Map"?tye(t,e,n,o):!0}var nye=function(e,n,o){return vc(e,n,o,X_e())};const iye=aT(nye);var oye=Object.defineProperty,vi=(t,e)=>oye(t,"name",{value:e,configurable:!0}),sye=class{constructor(e){this.direction=!1,this.compareProperties=!0;var n,o,u;this.precision=10**-((n=e?.precision)!=null?n:17),this.direction=(o=e?.direction)!=null?o:!1,this.compareProperties=(u=e?.compareProperties)!=null?u:!0}compare(e,n){if(e.type!==n.type||!hx(e,n))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,n.coordinates);case"LineString":return this.compareLine(e.coordinates,n.coordinates);case"Polygon":return this.comparePolygon(e,n);case"GeometryCollection":return this.compareGeometryCollection(e,n);case"Feature":return this.compareFeature(e,n);case"FeatureCollection":return this.compareFeatureCollection(e,n);default:if(e.type.startsWith("Multi")){const o=o4(e),u=o4(n);return o.every(d=>u.some(_=>this.compare(d,_)))}}return!1}compareCoord(e,n){return e.length===n.length&&e.every((o,u)=>Math.abs(o-n[u])<this.precision)}compareLine(e,n,o=0,u=!1){if(!hx(e,n))return!1;const d=e;let _=n;if(u&&!this.compareCoord(d[0],_[0])){const a=this.fixStartIndex(_,d);if(a)_=a;else return!1}const v=this.compareCoord(d[o],_[o]);return this.direction||v?this.comparePath(d,_):this.compareCoord(d[o],_[_.length-(1+o)])?this.comparePath(d.slice().reverse(),_):!1}fixStartIndex(e,n){let o,u=-1;for(let d=0;d<e.length;d++)if(this.compareCoord(e[d],n[0])){u=d;break}return u>=0&&(o=[].concat(e.slice(u,e.length),e.slice(1,u+1))),o}comparePath(e,n){return e.every((o,u)=>this.compareCoord(o,n[u]))}comparePolygon(e,n){if(this.compareLine(e.coordinates[0],n.coordinates[0],1,!0)){const o=e.coordinates.slice(1,e.coordinates.length),u=n.coordinates.slice(1,n.coordinates.length);return o.every(d=>u.some(_=>this.compareLine(d,_,1,!0)))}return!1}compareGeometryCollection(e,n){return hx(e.geometries,n.geometries)&&this.compareBBox(e,n)&&e.geometries.every((o,u)=>this.compare(o,n.geometries[u]))}compareFeature(e,n){return e.id===n.id&&(this.compareProperties?iye(e.properties,n.properties):!0)&&this.compareBBox(e,n)&&this.compare(e.geometry,n.geometry)}compareFeatureCollection(e,n){return hx(e.features,n.features)&&this.compareBBox(e,n)&&e.features.every((o,u)=>this.compare(o,n.features[u]))}compareBBox(e,n){return!e.bbox&&!n.bbox||(e.bbox&&n.bbox?this.compareCoord(e.bbox,n.bbox):!1)}};vi(sye,"GeojsonEquality");function hx(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}vi(hx,"sameLength");function o4(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}vi(o4,"explode");var Zs=63710088e-1,jG={centimeters:Zs*100,centimetres:Zs*100,degrees:360/(2*Math.PI),feet:Zs*3.28084,inches:Zs*39.37,kilometers:Zs/1e3,kilometres:Zs/1e3,meters:Zs,metres:Zs,miles:Zs/1609.344,millimeters:Zs*1e3,millimetres:Zs*1e3,nauticalmiles:Zs/1852,radians:1,yards:Zs*1.0936},JU={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Ea(t,e,n={}){const o={type:"Feature"};return(n.id===0||n.id)&&(o.id=n.id),n.bbox&&(o.bbox=n.bbox),o.properties=e||{},o.geometry=t,o}vi(Ea,"feature");function aye(t,e,n={}){switch(t){case"Point":return po(e).geometry;case"LineString":return Es(e).geometry;case"Polygon":return c_(e).geometry;case"MultiPoint":return VG(e).geometry;case"MultiLineString":return b1(e).geometry;case"MultiPolygon":return n5(e).geometry;default:throw new Error(t+" is invalid")}}vi(aye,"geometry");function po(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!sf(t[0])||!sf(t[1]))throw new Error("coordinates must contain numbers");return Ea({type:"Point",coordinates:t},e,n)}vi(po,"point");function lye(t,e,n={}){return ya(t.map(o=>po(o,e)),n)}vi(lye,"points");function c_(t,e,n={}){for(const u of t){if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(u[u.length-1].length!==u[0].length)throw new Error("First and last Position are not equivalent.");for(let d=0;d<u[u.length-1].length;d++)if(u[u.length-1][d]!==u[0][d])throw new Error("First and last Position are not equivalent.")}return Ea({type:"Polygon",coordinates:t},e,n)}vi(c_,"polygon");function cye(t,e,n={}){return ya(t.map(o=>c_(o,e)),n)}vi(cye,"polygons");function Es(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Ea({type:"LineString",coordinates:t},e,n)}vi(Es,"lineString");function uye(t,e,n={}){return ya(t.map(o=>Es(o,e)),n)}vi(uye,"lineStrings");function ya(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}vi(ya,"featureCollection");function b1(t,e,n={}){return Ea({type:"MultiLineString",coordinates:t},e,n)}vi(b1,"multiLineString");function VG(t,e,n={}){return Ea({type:"MultiPoint",coordinates:t},e,n)}vi(VG,"multiPoint");function n5(t,e,n={}){return Ea({type:"MultiPolygon",coordinates:t},e,n)}vi(n5,"multiPolygon");function hye(t,e,n={}){return Ea({type:"GeometryCollection",geometries:t},e,n)}vi(hye,"geometryCollection");function dye(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n}vi(dye,"round");function i5(t,e="kilometers"){const n=jG[e];if(!n)throw new Error(e+" units is invalid");return t*n}vi(i5,"radiansToLength");function LA(t,e="kilometers"){const n=jG[e];if(!n)throw new Error(e+" units is invalid");return t/n}vi(LA,"lengthToRadians");function fye(t,e){return u_(LA(t,e))}vi(fye,"lengthToDegrees");function pye(t){let e=t%360;return e<0&&(e+=360),e}vi(pye,"bearingToAzimuth");function u_(t){return t%(2*Math.PI)*180/Math.PI}vi(u_,"radiansToDegrees");function ls(t){return t%360*Math.PI/180}vi(ls,"degreesToRadians");function o5(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return i5(LA(t,e),n)}vi(o5,"convertLength");function mye(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const o=JU[e];if(!o)throw new Error("invalid original units");const u=JU[n];if(!u)throw new Error("invalid final units");return t/o*u}vi(mye,"convertArea");function sf(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}vi(sf,"isNumber");function L_(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}vi(L_,"isObject");function gye(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!sf(e))throw new Error("bbox must only contain numbers")})}vi(gye,"validateBBox");function _ye(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}vi(_ye,"validateId");var yye=Object.defineProperty,yf=(t,e)=>yye(t,"name",{value:e,configurable:!0});function Eo(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}yf(Eo,"getCoord");function dh(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}yf(dh,"getCoords");function HG(t){if(t.length>1&&sf(t[0])&&sf(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return HG(t[0]);throw new Error("coordinates must only contain numbers")}yf(HG,"containsNumber");function vye(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}yf(vye,"geojsonType");function xye(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}yf(xye,"featureOf");function bye(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const o of t.features){if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}}yf(bye,"collectionOf");function af(t){return t.type==="Feature"?t.geometry:t}yf(af,"getGeom");function s4(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}yf(s4,"getType");var wye=Object.defineProperty,GG=(t,e)=>wye(t,"name",{value:e,configurable:!0});function s5(t,e,n={}){if(n.final===!0)return WG(t,e);const o=Eo(t),u=Eo(e),d=ls(o[0]),_=ls(u[0]),v=ls(o[1]),a=ls(u[1]),C=Math.sin(_-d)*Math.cos(a),A=Math.cos(v)*Math.sin(a)-Math.sin(v)*Math.cos(a)*Math.cos(_-d);return u_(Math.atan2(C,A))}GG(s5,"bearing");function WG(t,e){let n=s5(e,t);return n=(n+180)%360,n}GG(WG,"calculateFinalBearing");var Cye=Object.defineProperty,Eye=(t,e)=>Cye(t,"name",{value:e,configurable:!0});function a4(t,e,n,o={}){const u=Eo(t),d=ls(u[0]),_=ls(u[1]),v=ls(n),a=LA(e,o.units),C=Math.asin(Math.sin(_)*Math.cos(a)+Math.cos(_)*Math.sin(a)*Math.cos(v)),A=d+Math.atan2(Math.sin(v)*Math.sin(a)*Math.cos(_),Math.cos(a)-Math.sin(_)*Math.sin(C)),k=u_(A),O=u_(C);return po([k,O],o.properties)}Eye(a4,"destination");var Sye=Object.defineProperty,Tye=(t,e)=>Sye(t,"name",{value:e,configurable:!0});function ru(t,e,n={}){var o=Eo(t),u=Eo(e),d=ls(u[1]-o[1]),_=ls(u[0]-o[0]),v=ls(o[1]),a=ls(u[1]),C=Math.pow(Math.sin(d/2),2)+Math.pow(Math.sin(_/2),2)*Math.cos(v)*Math.cos(a);return i5(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),n.units)}Tye(ru,"distance");var Aye=Object.defineProperty,qG=(t,e)=>Aye(t,"name",{value:e,configurable:!0});function KG(t,e,n={}){let o;return n.final?o=l4(Eo(e),Eo(t)):o=l4(Eo(t),Eo(e)),o>180?-(360-o):o}qG(KG,"rhumbBearing");function l4(t,e){const n=ls(t[1]),o=ls(e[1]);let u=ls(e[0]-t[0]);u>Math.PI&&(u-=2*Math.PI),u<-Math.PI&&(u+=2*Math.PI);const d=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),_=Math.atan2(u,d);return(u_(_)+360)%360}qG(l4,"calculateRhumbBearing");var Iye=Object.defineProperty,As=(t,e)=>Iye(t,"name",{value:e,configurable:!0});function Sh(t,e,n){if(t!==null)for(var o,u,d,_,v,a,C,A=0,k=0,O,R=t.type,z=R==="FeatureCollection",N=R==="Feature",K=z?t.features.length:1,q=0;q<K;q++){C=z?t.features[q].geometry:N?t.geometry:t,O=C?C.type==="GeometryCollection":!1,v=O?C.geometries.length:1;for(var j=0;j<v;j++){var H=0,Y=0;if(_=O?C.geometries[j]:C,_!==null){a=_.coordinates;var te=_.type;switch(A=n&&(te==="Polygon"||te==="MultiPolygon")?1:0,te){case null:break;case"Point":if(e(a,k,q,H,Y)===!1)return!1;k++,H++;break;case"LineString":case"MultiPoint":for(o=0;o<a.length;o++){if(e(a[o],k,q,H,Y)===!1)return!1;k++,te==="MultiPoint"&&H++}te==="LineString"&&H++;break;case"Polygon":case"MultiLineString":for(o=0;o<a.length;o++){for(u=0;u<a[o].length-A;u++){if(e(a[o][u],k,q,H,Y)===!1)return!1;k++}te==="MultiLineString"&&H++,te==="Polygon"&&Y++}te==="Polygon"&&H++;break;case"MultiPolygon":for(o=0;o<a.length;o++){for(Y=0,u=0;u<a[o].length;u++){for(d=0;d<a[o][u].length-A;d++){if(e(a[o][u][d],k,q,H,Y)===!1)return!1;k++}Y++}H++}break;case"GeometryCollection":for(o=0;o<_.geometries.length;o++)if(Sh(_.geometries[o],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}As(Sh,"coordEach");function Mye(t,e,n,o){var u=n;return Sh(t,function(d,_,v,a,C){_===0&&n===void 0?u=d:u=e(u,d,_,v,a,C)},o),u}As(Mye,"coordReduce");function YG(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&e(t.features[n].properties,n)!==!1;n++);break;case"Feature":e(t.properties,0);break}}As(YG,"propEach");function Pye(t,e,n){var o=n;return YG(t,function(u,d){d===0&&n===void 0?o=u:o=e(o,u,d)}),o}As(Pye,"propReduce");function K1(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}As(K1,"featureEach");function ZG(t,e,n){var o=n;return K1(t,function(u,d){d===0&&n===void 0?o=u:o=e(o,u,d)}),o}As(ZG,"featureReduce");function Rye(t){var e=[];return Sh(t,function(n){e.push(n)}),e}As(Rye,"coordAll");function a5(t,e){var n,o,u,d,_,v,a,C,A,k,O=0,R=t.type==="FeatureCollection",z=t.type==="Feature",N=R?t.features.length:1;for(n=0;n<N;n++){for(v=R?t.features[n].geometry:z?t.geometry:t,C=R?t.features[n].properties:z?t.properties:{},A=R?t.features[n].bbox:z?t.bbox:void 0,k=R?t.features[n].id:z?t.id:void 0,a=v?v.type==="GeometryCollection":!1,_=a?v.geometries.length:1,u=0;u<_;u++){if(d=a?v.geometries[u]:v,d===null){if(e(null,O,C,A,k)===!1)return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(d,O,C,A,k)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<d.geometries.length;o++)if(e(d.geometries[o],O,C,A,k)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}O++}}As(a5,"geomEach");function kye(t,e,n){var o=n;return a5(t,function(u,d,_,v,a){d===0&&n===void 0?o=u:o=e(o,u,d,_,v,a)}),o}As(kye,"geomReduce");function Cm(t,e){a5(t,function(n,o,u,d,_){var v=n===null?null:n.type;switch(v){case null:case"Point":case"LineString":case"Polygon":return e(Ea(n,u,{bbox:d,id:_}),o,0)===!1?!1:void 0}var a;switch(v){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon";break}for(var C=0;C<n.coordinates.length;C++){var A=n.coordinates[C],k={type:a,coordinates:A};if(e(Ea(k,u),o,C)===!1)return!1}})}As(Cm,"flattenEach");function Dye(t,e,n){var o=n;return Cm(t,function(u,d,_){d===0&&_===0&&n===void 0?o=u:o=e(o,u,d,_)}),o}As(Dye,"flattenReduce");function XG(t,e){Cm(t,function(n,o,u){var d=0;if(n.geometry){var _=n.geometry.type;if(!(_==="Point"||_==="MultiPoint")){var v,a=0,C=0,A=0;if(Sh(n,function(k,O,R,z,N){if(v===void 0||o>a||z>C||N>A){v=k,a=o,C=z,A=N,d=0;return}var K=Es([v,k],n.properties);if(e(K,o,u,N,d)===!1)return!1;d++,v=k})===!1)return!1}}})}As(XG,"segmentEach");function Oye(t,e,n){var o=n,u=!1;return XG(t,function(d,_,v,a,C){u===!1&&n===void 0?o=d:o=e(o,d,_,v,a,C),u=!0}),o}As(Oye,"segmentReduce");function QG(t,e){if(!t)throw new Error("geojson is required");Cm(t,function(n,o,u){if(n.geometry!==null){var d=n.geometry.type,_=n.geometry.coordinates;switch(d){case"LineString":if(e(n,o,u,0,0)===!1)return!1;break;case"Polygon":for(var v=0;v<_.length;v++)if(e(Es(_[v],n.properties),o,u,v)===!1)return!1;break}}})}As(QG,"lineEach");function Lye(t,e,n){var o=n;return QG(t,function(u,d,_,v){d===0&&n===void 0?o=u:o=e(o,u,d,_,v)}),o}As(Lye,"lineReduce");function Bye(t,e){if(e=e||{},!L_(e))throw new Error("options is invalid");var n=e.featureIndex||0,o=e.multiFeatureIndex||0,u=e.geometryIndex||0,d=e.segmentIndex||0,_=e.properties,v;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),_=_||t.features[n].properties,v=t.features[n].geometry;break;case"Feature":_=_||t.properties,v=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":v=t;break;default:throw new Error("geojson is invalid")}if(v===null)return null;var a=v.coordinates;switch(v.type){case"Point":case"MultiPoint":return null;case"LineString":return d<0&&(d=a.length+d-1),Es([a[d],a[d+1]],_,e);case"Polygon":return u<0&&(u=a.length+u),d<0&&(d=a[u].length+d-1),Es([a[u][d],a[u][d+1]],_,e);case"MultiLineString":return o<0&&(o=a.length+o),d<0&&(d=a[o].length+d-1),Es([a[o][d],a[o][d+1]],_,e);case"MultiPolygon":return o<0&&(o=a.length+o),u<0&&(u=a[o].length+u),d<0&&(d=a[o][u].length-d-1),Es([a[o][u][d],a[o][u][d+1]],_,e)}throw new Error("geojson is invalid")}As(Bye,"findSegment");function Fye(t,e){if(e=e||{},!L_(e))throw new Error("options is invalid");var n=e.featureIndex||0,o=e.multiFeatureIndex||0,u=e.geometryIndex||0,d=e.coordIndex||0,_=e.properties,v;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),_=_||t.features[n].properties,v=t.features[n].geometry;break;case"Feature":_=_||t.properties,v=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":v=t;break;default:throw new Error("geojson is invalid")}if(v===null)return null;var a=v.coordinates;switch(v.type){case"Point":return po(a,_,e);case"MultiPoint":return o<0&&(o=a.length+o),po(a[o],_,e);case"LineString":return d<0&&(d=a.length+d),po(a[d],_,e);case"Polygon":return u<0&&(u=a.length+u),d<0&&(d=a[u].length+d),po(a[u][d],_,e);case"MultiLineString":return o<0&&(o=a.length+o),d<0&&(d=a[o].length+d),po(a[o][d],_,e);case"MultiPolygon":return o<0&&(o=a.length+o),u<0&&(u=a[o].length+u),d<0&&(d=a[o][u].length-d),po(a[o][u][d],_,e)}throw new Error("geojson is invalid")}As(Fye,"findPoint");var zye=Object.defineProperty,Nye=(t,e)=>zye(t,"name",{value:e,configurable:!0});function Cs(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const n=[1/0,1/0,-1/0,-1/0];return Sh(t,o=>{n[0]>o[0]&&(n[0]=o[0]),n[1]>o[1]&&(n[1]=o[1]),n[2]<o[0]&&(n[2]=o[0]),n[3]<o[1]&&(n[3]=o[1])}),n}Nye(Cs,"bbox");var Uye=Object.defineProperty,B_=(t,e)=>Uye(t,"name",{value:e,configurable:!0});function JG(t,e,n){var o=t.length,u=$p(t[0],e),d=[],_,v,a;let C,A;for(n||(n=[]),_=1;_<o;_++){for(C=t[_-1],A=t[_],v=a=$p(A,e);;)if(u|v){if(u&v)break;u?(C=BS(C,A,u,e),u=$p(C,e)):(A=BS(C,A,v,e),v=$p(A,e))}else{d.push(C),v!==a?(d.push(A),_<o-1&&(n.push(d),d=[])):_===o-1&&d.push(A);break}u=a}return d.length&&n.push(d),n}B_(JG,"lineclip");function eW(t,e){var n,o,u,d,_,v,a;for(o=1;o<=8;o*=2){for(n=[],u=t[t.length-1],d=!($p(u,e)&o),_=0;_<t.length;_++)v=t[_],a=!($p(v,e)&o),a!==d&&n.push(BS(u,v,o,e)),a&&n.push(v),u=v,d=a;if(t=n,!t.length)break}return n}B_(eW,"polygonclip");function BS(t,e,n,o){return n&8?[t[0]+(e[0]-t[0])*(o[3]-t[1])/(e[1]-t[1]),o[3]]:n&4?[t[0]+(e[0]-t[0])*(o[1]-t[1])/(e[1]-t[1]),o[1]]:n&2?[o[2],t[1]+(e[1]-t[1])*(o[2]-t[0])/(e[0]-t[0])]:n&1?[o[0],t[1]+(e[1]-t[1])*(o[0]-t[0])/(e[0]-t[0])]:null}B_(BS,"intersect");function $p(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}B_($p,"bitCode");function tW(t,e){const n=af(t),o=n.type,u=t.type==="Feature"?t.properties:{};let d=n.coordinates;switch(o){case"LineString":case"MultiLineString":{const _=[];return o==="LineString"&&(d=[d]),d.forEach(v=>{JG(v,e,_)}),_.length===1?Es(_[0],u):b1(_,u)}case"Polygon":return c_(c4(d,e),u);case"MultiPolygon":return n5(d.map(_=>c4(_,e)),u);default:throw new Error("geometry "+o+" not supported")}}B_(tW,"bboxClip");function c4(t,e){const n=[];for(const o of t){const u=eW(o,e);u.length>0&&((u[0][0]!==u[u.length-1][0]||u[0][1]!==u[u.length-1][1])&&u.push(u[0]),u.length>=4&&n.push(u))}return n}B_(c4,"clipPolygon");function $ye(t,e){var n=0,o=0,u=0,d=0,_=0,v=0,a=0,C=0,A=null,k=null,O=t[0],R=t[1],z=e.length;for(n;n<z;n++){o=0;var N=e[n].length-1,K=e[n];if(A=K[0],A[0]!==K[N][0]&&A[1]!==K[N][1])throw new Error("First and last coordinates in a ring must be the same");for(_=A[0]-O,v=A[1]-R,o;o<N;o++){if(k=K[o+1],C=k[1]-R,v<0&&C<0||v>0&&C>0){A=k,v=C,_=A[0]-O;continue}if(a=k[0]-t[0],C>0&&v<=0){if(d=_*C-a*v,d>0)u=u+1;else if(d===0)return 0}else if(v>0&&C<=0){if(d=_*C-a*v,d<0)u=u+1;else if(d===0)return 0}else if(C===0&&v<0){if(d=_*C-a*v,d===0)return 0}else if(v===0&&C<0){if(d=_*C-a*v,d===0)return 0}else if(v===0&&C===0){if(a<=0&&_>=0)return 0;if(_<=0&&a>=0)return 0}A=k,v=C,_=a}}return u%2!==0}var jye=Object.defineProperty,rW=(t,e)=>jye(t,"name",{value:e,configurable:!0});function Rl(t,e,n={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const o=Eo(t),u=af(e),d=u.type,_=e.bbox;let v=u.coordinates;if(_&&nW(o,_)===!1)return!1;d==="Polygon"&&(v=[v]);let a=!1;for(var C=0;C<v.length;++C){const A=$ye(o,v[C]);if(A===0)return!n.ignoreBoundary;A&&(a=!0)}return a}rW(Rl,"booleanPointInPolygon");function nW(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}rW(nW,"inBBox");var Vye=Object.defineProperty,iW=(t,e)=>Vye(t,"name",{value:e,configurable:!0});function pu(t,e,n={}){const o=Eo(t),u=dh(e);for(let d=0;d<u.length-1;d++){let _=!1;if(n.ignoreEndVertices&&(d===0&&(_="start"),d===u.length-2&&(_="end"),d===0&&d+1===u.length-1&&(_="both")),oW(u[d],u[d+1],o,_,typeof n.epsilon>"u"?null:n.epsilon))return!0}return!1}iW(pu,"booleanPointOnLine");function oW(t,e,n,o,u){const d=n[0],_=n[1],v=t[0],a=t[1],C=e[0],A=e[1],k=n[0]-v,O=n[1]-a,R=C-v,z=A-a,N=k*z-O*R;if(u!==null){if(Math.abs(N)>u)return!1}else if(N!==0)return!1;if(o){if(o==="start")return Math.abs(R)>=Math.abs(z)?R>0?v<d&&d<=C:C<=d&&d<v:z>0?a<_&&_<=A:A<=_&&_<a;if(o==="end")return Math.abs(R)>=Math.abs(z)?R>0?v<=d&&d<C:C<d&&d<=v:z>0?a<=_&&_<A:A<_&&_<=a;if(o==="both")return Math.abs(R)>=Math.abs(z)?R>0?v<d&&d<C:C<d&&d<v:z>0?a<_&&_<A:A<_&&_<a}else return Math.abs(R)>=Math.abs(z)?R>0?v<=d&&d<=C:C<=d&&d<=v:z>0?a<=_&&_<=A:A<=_&&_<=a;return!1}iW(oW,"isPointOnLineSegment");var Hye=Object.defineProperty,$l=(t,e)=>Hye(t,"name",{value:e,configurable:!0});function sW(t,e){const n=af(t),o=af(e),u=n.type,d=o.type,_=n.coordinates,v=o.coordinates;switch(u){case"Point":switch(d){case"Point":return BA(_,v);default:throw new Error("feature2 "+d+" geometry not supported")}case"MultiPoint":switch(d){case"Point":return lW(n,o);case"MultiPoint":return cW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}case"LineString":switch(d){case"Point":return pu(o,n,{ignoreEndVertices:!0});case"LineString":return dW(n,o);case"MultiPoint":return uW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}case"Polygon":switch(d){case"Point":return Rl(o,n,{ignoreBoundary:!0});case"LineString":return fW(n,o);case"Polygon":return l5(n,o);case"MultiPoint":return hW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}case"MultiPolygon":switch(d){case"Polygon":return aW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}$l(sW,"booleanContains");function aW(t,e){return t.coordinates.some(n=>l5({type:"Polygon",coordinates:n},e))}$l(aW,"isPolygonInMultiPolygon");function lW(t,e){let n,o=!1;for(n=0;n<t.coordinates.length;n++)if(BA(t.coordinates[n],e.coordinates)){o=!0;break}return o}$l(lW,"isPointInMultiPoint");function cW(t,e){for(const n of e.coordinates){let o=!1;for(const u of t.coordinates)if(BA(n,u)){o=!0;break}if(!o)return!1}return!0}$l(cW,"isMultiPointInMultiPoint");function uW(t,e){let n=!1;for(const o of e.coordinates)if(pu(o,t,{ignoreEndVertices:!0})&&(n=!0),!pu(o,t))return!1;return!!n}$l(uW,"isMultiPointOnLine");function hW(t,e){for(const n of e.coordinates)if(!Rl(n,t,{ignoreBoundary:!0}))return!1;return!0}$l(hW,"isMultiPointInPoly");function dW(t,e){let n=!1;for(const o of e.coordinates)if(pu({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(n=!0),!pu({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1;return n}$l(dW,"isLineOnLine");function fW(t,e){let n=!1,o=0;const u=Cs(t),d=Cs(e);if(!c5(u,d))return!1;for(o;o<e.coordinates.length-1;o++){const _=pW(e.coordinates[o],e.coordinates[o+1]);if(Rl({type:"Point",coordinates:_},t,{ignoreBoundary:!0})){n=!0;break}}return n}$l(fW,"isLineInPoly");function l5(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const n=Cs(t),o=Cs(e);if(!c5(n,o))return!1;const u=af(e).coordinates;for(const d of u)for(const _ of d)if(!Rl(_,t))return!1;return!0}$l(l5,"isPolyInPoly");function c5(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}$l(c5,"doBBoxOverlap");function BA(t,e){return t[0]===e[0]&&t[1]===e[1]}$l(BA,"compareCoords");function pW(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}$l(pW,"getMidpoint");class mW{constructor(e=[],n=Gye){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:o}=this,u=n[e];for(;e>0;){const d=e-1>>1,_=n[d];if(o(u,_)>=0)break;n[e]=_,e=d}n[e]=u}_down(e){const{data:n,compare:o}=this,u=this.length>>1,d=n[e];for(;e<u;){let _=(e<<1)+1,v=n[_];const a=_+1;if(a<this.length&&o(n[a],v)<0&&(_=a,v=n[a]),o(v,d)>=0)break;n[e]=v,e=_}n[e]=d}}function Gye(t,e){return t<e?-1:t>e?1:0}function gW(t,e){return t.p.x>e.p.x?1:t.p.x<e.p.x?-1:t.p.y!==e.p.y?t.p.y>e.p.y?1:-1:1}function Wye(t,e){return t.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:t.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:t.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?t.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}let e9=class{constructor(e,n,o,u){this.p={x:e[0],y:e[1]},this.featureId=n,this.ringId=o,this.eventId=u,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}};function qye(t,e){if(t.type==="FeatureCollection"){const n=t.features;for(let o=0;o<n.length;o++)t9(n[o],e)}else t9(t,e)}let OC=0,LC=0,BC=0;function t9(t,e){const n=t.type==="Feature"?t.geometry:t;let o=n.coordinates;(n.type==="Polygon"||n.type==="MultiLineString")&&(o=[o]),n.type==="LineString"&&(o=[[o]]);for(let u=0;u<o.length;u++)for(let d=0;d<o[u].length;d++){let _=o[u][d][0],v=null;LC=LC+1;for(let a=0;a<o[u][d].length-1;a++){v=o[u][d][a+1];const C=new e9(_,OC,LC,BC),A=new e9(v,OC,LC,BC+1);C.otherEvent=A,A.otherEvent=C,gW(C,A)>0?(A.isLeftEndpoint=!0,C.isLeftEndpoint=!1):(C.isLeftEndpoint=!0,A.isLeftEndpoint=!1),e.push(C),e.push(A),_=v,BC=BC+1}}OC=OC+1}class Kye{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function Yye(t,e){if(t===null||e===null||t.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.rightSweepEvent)||t.leftSweepEvent.isSamePoint(e.leftSweepEvent)||t.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const n=t.leftSweepEvent.p.x,o=t.leftSweepEvent.p.y,u=t.rightSweepEvent.p.x,d=t.rightSweepEvent.p.y,_=e.leftSweepEvent.p.x,v=e.leftSweepEvent.p.y,a=e.rightSweepEvent.p.x,C=e.rightSweepEvent.p.y,A=(C-v)*(u-n)-(a-_)*(d-o),k=(a-_)*(o-v)-(C-v)*(n-_),O=(u-n)*(o-v)-(d-o)*(n-_);if(A===0)return!1;const R=k/A,z=O/A;if(R>=0&&R<=1&&z>=0&&z<=1){const N=n+R*(u-n),K=o+R*(d-o);return[N,K]}return!1}function Zye(t,e){e=e||!1;const n=[],o=new mW([],Wye);for(;t.length;){const u=t.pop();if(u.isLeftEndpoint){const d=new Kye(u);for(let _=0;_<o.data.length;_++){const v=o.data[_];if(e&&v.leftSweepEvent.featureId===u.featureId)continue;const a=Yye(d,v);a!==!1&&n.push(a)}o.push(d)}else u.isLeftEndpoint===!1&&o.pop()}return n}function Xye(t,e){const n=new mW([],gW);return qye(t,n),Zye(n,e)}var Qye=Object.defineProperty,Jye=(t,e)=>Qye(t,"name",{value:e,configurable:!0}),eve=Xye;function u5(t,e,n={}){const{removeDuplicates:o=!0,ignoreSelfIntersections:u=!1}=n;let d=[];t.type==="FeatureCollection"?d=d.concat(t.features):t.type==="Feature"?d.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&d.push(Ea(t)),e.type==="FeatureCollection"?d=d.concat(e.features):e.type==="Feature"?d.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&d.push(Ea(e));const _=eve(ya(d),u);let v=[];if(o){const a={};_.forEach(C=>{const A=C.join(",");a[A]||(a[A]=!0,v.push(C))})}else v=_;return ya(v.map(a=>po(a)))}Jye(u5,"lineIntersect");function tve(t,e,n,o,u){_W(t,e,n||0,o||t.length-1,u||rve)}function _W(t,e,n,o,u){for(;o>n;){if(o-n>600){var d=o-n+1,_=e-n+1,v=Math.log(d),a=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*a*(d-a)/d)*(_-d/2<0?-1:1),A=Math.max(n,Math.floor(e-_*a/d+C)),k=Math.min(o,Math.floor(e+(d-_)*a/d+C));_W(t,e,A,k,u)}var O=t[e],R=n,z=o;for(ex(t,n,e),u(t[o],O)>0&&ex(t,n,o);R<z;){for(ex(t,R,z),R++,z--;u(t[R],O)<0;)R++;for(;u(t[z],O)>0;)z--}u(t[n],O)===0?ex(t,n,z):(z++,ex(t,z,o)),z<=e&&(n=z+1),e<=z&&(o=z-1)}}function ex(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function rve(t,e){return t<e?-1:t>e?1:0}class qc{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const o=[];if(!zC(e,n))return o;const u=this.toBBox,d=[];for(;n;){for(let _=0;_<n.children.length;_++){const v=n.children[_],a=n.leaf?u(v):v;zC(e,a)&&(n.leaf?o.push(v):tR(e,a)?this._all(v,o):d.push(v))}n=d.pop()}return o}collides(e){let n=this.data;if(!zC(e,n))return!1;const o=[];for(;n;){for(let u=0;u<n.children.length;u++){const d=n.children[u],_=n.leaf?this.toBBox(d):d;if(zC(e,_)){if(n.leaf||tR(e,_))return!0;o.push(d)}}n=o.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let o=0;o<e.length;o++)this.insert(e[o]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=rg([]),this}remove(e,n){if(!e)return this;let o=this.data;const u=this.toBBox(e),d=[],_=[];let v,a,C;for(;o||d.length;){if(o||(o=d.pop(),a=d[d.length-1],v=_.pop(),C=!0),o.leaf){const A=nve(e,o.children,n);if(A!==-1)return o.children.splice(A,1),d.push(o),this._condense(d),this}!C&&!o.leaf&&tR(o,u)?(d.push(o),_.push(v),v=0,a=o,o=o.children[0]):a?(v++,o=a.children[v],C=!1):o=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const o=[];for(;e;)e.leaf?n.push(...e.children):o.push(...e.children),e=o.pop();return n}_build(e,n,o,u){const d=o-n+1;let _=this._maxEntries,v;if(d<=_)return v=rg(e.slice(n,o+1)),Z0(v,this.toBBox),v;u||(u=Math.ceil(Math.log(d)/Math.log(_)),_=Math.ceil(d/Math.pow(_,u-1))),v=rg([]),v.leaf=!1,v.height=u;const a=Math.ceil(d/_),C=a*Math.ceil(Math.sqrt(_));r9(e,n,o,C,this.compareMinX);for(let A=n;A<=o;A+=C){const k=Math.min(A+C-1,o);r9(e,A,k,a,this.compareMinY);for(let O=A;O<=k;O+=a){const R=Math.min(O+a-1,k);v.children.push(this._build(e,O,R,u-1))}}return Z0(v,this.toBBox),v}_chooseSubtree(e,n,o,u){for(;u.push(n),!(n.leaf||u.length-1===o);){let d=1/0,_=1/0,v;for(let a=0;a<n.children.length;a++){const C=n.children[a],A=eR(C),k=sve(e,C)-A;k<_?(_=k,d=A<d?A:d,v=C):k===_&&A<d&&(d=A,v=C)}n=v||n.children[0]}return n}_insert(e,n,o){const u=o?e:this.toBBox(e),d=[],_=this._chooseSubtree(u,this.data,n,d);for(_.children.push(e),fx(_,u);n>=0&&d[n].children.length>this._maxEntries;)this._split(d,n),n--;this._adjustParentBBoxes(u,d,n)}_split(e,n){const o=e[n],u=o.children.length,d=this._minEntries;this._chooseSplitAxis(o,d,u);const _=this._chooseSplitIndex(o,d,u),v=rg(o.children.splice(_,o.children.length-_));v.height=o.height,v.leaf=o.leaf,Z0(o,this.toBBox),Z0(v,this.toBBox),n?e[n-1].children.push(v):this._splitRoot(o,v)}_splitRoot(e,n){this.data=rg([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Z0(this.data,this.toBBox)}_chooseSplitIndex(e,n,o){let u,d=1/0,_=1/0;for(let v=n;v<=o-n;v++){const a=dx(e,0,v,this.toBBox),C=dx(e,v,o,this.toBBox),A=ave(a,C),k=eR(a)+eR(C);A<d?(d=A,u=v,_=k<_?k:_):A===d&&k<_&&(_=k,u=v)}return u||o-n}_chooseSplitAxis(e,n,o){const u=e.leaf?this.compareMinX:ive,d=e.leaf?this.compareMinY:ove,_=this._allDistMargin(e,n,o,u),v=this._allDistMargin(e,n,o,d);_<v&&e.children.sort(u)}_allDistMargin(e,n,o,u){e.children.sort(u);const d=this.toBBox,_=dx(e,0,n,d),v=dx(e,o-n,o,d);let a=FC(_)+FC(v);for(let C=n;C<o-n;C++){const A=e.children[C];fx(_,e.leaf?d(A):A),a+=FC(_)}for(let C=o-n-1;C>=n;C--){const A=e.children[C];fx(v,e.leaf?d(A):A),a+=FC(v)}return a}_adjustParentBBoxes(e,n,o){for(let u=o;u>=0;u--)fx(n[u],e)}_condense(e){for(let n=e.length-1,o;n>=0;n--)e[n].children.length===0?n>0?(o=e[n-1].children,o.splice(o.indexOf(e[n]),1)):this.clear():Z0(e[n],this.toBBox)}}function nve(t,e,n){if(!n)return e.indexOf(t);for(let o=0;o<e.length;o++)if(n(t,e[o]))return o;return-1}function Z0(t,e){dx(t,0,t.children.length,e,t)}function dx(t,e,n,o,u){u||(u=rg(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let d=e;d<n;d++){const _=t.children[d];fx(u,t.leaf?o(_):_)}return u}function fx(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function ive(t,e){return t.minX-e.minX}function ove(t,e){return t.minY-e.minY}function eR(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function FC(t){return t.maxX-t.minX+(t.maxY-t.minY)}function sve(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function ave(t,e){const n=Math.max(t.minX,e.minX),o=Math.max(t.minY,e.minY),u=Math.min(t.maxX,e.maxX),d=Math.min(t.maxY,e.maxY);return Math.max(0,u-n)*Math.max(0,d-o)}function tR(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function zC(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function rg(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function r9(t,e,n,o,u){const d=[e,n];for(;d.length;){if(n=d.pop(),e=d.pop(),n-e<=o)continue;const _=e+Math.ceil((n-e)/o/2)*o;tve(t,_,e,n,u),d.push(e,_,_,n)}}var lve=Object.defineProperty,cve=(t,e)=>lve(t,"name",{value:e,configurable:!0});function h5(t){var e=new qc(t);return e.insert=function(n){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Cs(n),qc.prototype.insert.call(this,n)},e.load=function(n){var o=[];return Array.isArray(n)?n.forEach(function(u){if(u.type!=="Feature")throw new Error("invalid features");u.bbox=u.bbox?u.bbox:Cs(u),o.push(u)}):K1(n,function(u){if(u.type!=="Feature")throw new Error("invalid features");u.bbox=u.bbox?u.bbox:Cs(u),o.push(u)}),qc.prototype.load.call(this,o)},e.remove=function(n,o){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Cs(n),qc.prototype.remove.call(this,n,o)},e.clear=function(){return qc.prototype.clear.call(this)},e.search=function(n){var o=qc.prototype.search.call(this,this.toBBox(n));return ya(o)},e.collides=function(n){return qc.prototype.collides.call(this,this.toBBox(n))},e.all=function(){var n=qc.prototype.all.call(this);return ya(n)},e.toJSON=function(){return qc.prototype.toJSON.call(this)},e.fromJSON=function(n){return qc.prototype.fromJSON.call(this,n)},e.toBBox=function(n){var o;if(n.bbox)o=n.bbox;else if(Array.isArray(n)&&n.length===4)o=n;else if(Array.isArray(n)&&n.length===6)o=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")o=Cs(n);else if(n.type==="FeatureCollection")o=Cs(n);else throw new Error("invalid geojson");return{minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]}},e}cve(h5,"geojsonRbush");var uve=Object.defineProperty,FA=(t,e)=>uve(t,"name",{value:e,configurable:!0});function yW(t){if(!t)throw new Error("geojson is required");const e=[];return Cm(t,n=>{vW(n,e)}),ya(e)}FA(yW,"lineSegment");function vW(t,e){let n=[];const o=t.geometry;if(o!==null){switch(o.type){case"Polygon":n=dh(o);break;case"LineString":n=[dh(o)]}n.forEach(u=>{xW(u,t.properties).forEach(_=>{_.id=e.length,e.push(_)})})}}FA(vW,"lineSegmentFeature");function xW(t,e){const n=[];return t.reduce((o,u)=>{const d=Es([o,u],e);return d.bbox=bW(o,u),n.push(d),u}),n}FA(xW,"createSegments");function bW(t,e){const n=t[0],o=t[1],u=e[0],d=e[1],_=n<u?n:u,v=o<d?o:d,a=n>u?n:u,C=o>d?o:d;return[_,v,a,C]}FA(bW,"bbox");var wW=Object.defineProperty,hve=Object.defineProperties,dve=Object.getOwnPropertyDescriptors,n9=Object.getOwnPropertySymbols,fve=Object.prototype.hasOwnProperty,pve=Object.prototype.propertyIsEnumerable,i9=(t,e,n)=>e in t?wW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wp=(t,e)=>{for(var n in e||(e={}))fve.call(e,n)&&i9(t,n,e[n]);if(n9)for(var n of n9(e))pve.call(e,n)&&i9(t,n,e[n]);return t},Cp=(t,e)=>hve(t,dve(e)),mve=(t,e)=>wW(t,"name",{value:e,configurable:!0});function d5(t,e,n={}){if(!t||!e)throw new Error("lines and pt are required arguments");let o=po([1/0,1/0],{dist:1/0,index:-1,location:-1}),u=0;return Cm(t,function(d){const _=dh(d);for(let v=0;v<_.length-1;v++){const a=po(_[v]);a.properties.dist=ru(e,a,n);const C=po(_[v+1]);C.properties.dist=ru(e,C,n);const A=ru(a,C,n),k=Math.max(a.properties.dist,C.properties.dist),O=s5(a,C),R=a4(e,k,O+90,n),z=a4(e,k,O-90,n),N=u5(Es([R.geometry.coordinates,z.geometry.coordinates]),Es([a.geometry.coordinates,C.geometry.coordinates]));let K;N.features.length>0&&N.features[0]&&(K=Cp(wp({},N.features[0]),{properties:{dist:ru(e,N.features[0],n),location:u+ru(a,N.features[0],n)}})),a.properties.dist<o.properties.dist&&(o=Cp(wp({},a),{properties:Cp(wp({},a.properties),{index:v,location:u})})),C.properties.dist<o.properties.dist&&(o=Cp(wp({},C),{properties:Cp(wp({},C.properties),{index:v+1,location:u+A})})),K&&K.properties.dist<o.properties.dist&&(o=Cp(wp({},K),{properties:Cp(wp({},K.properties),{index:v})})),u+=A}}),o}mve(d5,"nearestPointOnLine");var gve=Object.defineProperty,Ac=(t,e)=>gve(t,"name",{value:e,configurable:!0});function CW(t,e){var n=af(t),o=af(e),u=n.type,d=o.type;switch(u){case"Point":switch(d){case"MultiPoint":return EW(n,o);case"LineString":return pu(n,o,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Rl(n,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+d+" geometry not supported")}case"MultiPoint":switch(d){case"MultiPoint":return SW(n,o);case"LineString":return TW(n,o);case"Polygon":case"MultiPolygon":return AW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}case"LineString":switch(d){case"LineString":return IW(n,o);case"Polygon":case"MultiPolygon":return MW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}case"Polygon":switch(d){case"Polygon":case"MultiPolygon":return PW(n,o);default:throw new Error("feature2 "+d+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}Ac(CW,"booleanWithin");function EW(t,e){var n,o=!1;for(n=0;n<e.coordinates.length;n++)if(p5(e.coordinates[n],t.coordinates)){o=!0;break}return o}Ac(EW,"isPointInMultiPoint");function SW(t,e){for(var n=0;n<t.coordinates.length;n++){for(var o=!1,u=0;u<e.coordinates.length;u++)p5(t.coordinates[n],e.coordinates[u])&&(o=!0);if(!o)return!1}return!0}Ac(SW,"isMultiPointInMultiPoint");function TW(t,e){for(var n=!1,o=0;o<t.coordinates.length;o++){if(!pu(t.coordinates[o],e))return!1;n||(n=pu(t.coordinates[o],e,{ignoreEndVertices:!0}))}return n}Ac(TW,"isMultiPointOnLine");function AW(t,e){for(var n=!0,o=!1,u=0;u<t.coordinates.length;u++){if(o=Rl(t.coordinates[u],e),!o){n=!1;break}o=Rl(t.coordinates[u],e,{ignoreBoundary:!0})}return n&&o}Ac(AW,"isMultiPointInPoly");function IW(t,e){for(var n=0;n<t.coordinates.length;n++)if(!pu(t.coordinates[n],e))return!1;return!0}Ac(IW,"isLineOnLine");function MW(t,e){var n=Cs(e),o=Cs(t);if(!f5(n,o))return!1;for(var u=!1,d=0;d<t.coordinates.length;d++){if(!Rl(t.coordinates[d],e))return!1;if(u||(u=Rl(t.coordinates[d],e,{ignoreBoundary:!0})),!u&&d<t.coordinates.length-1){var _=RW(t.coordinates[d],t.coordinates[d+1]);u=Rl(_,e,{ignoreBoundary:!0})}}return u}Ac(MW,"isLineInPoly");function PW(t,e){var n=Cs(t),o=Cs(e);if(!f5(o,n))return!1;for(var u=0;u<t.coordinates[0].length;u++)if(!Rl(t.coordinates[0][u],e))return!1;return!0}Ac(PW,"isPolyInPoly");function f5(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}Ac(f5,"doBBoxOverlap");function p5(t,e){return t[0]===e[0]&&t[1]===e[1]}Ac(p5,"compareCoords");function RW(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}Ac(RW,"getMidpoint");var _ve=Object.defineProperty,yve=(t,e)=>_ve(t,"name",{value:e,configurable:!0});function kW(t,e={}){let n=0,o=0,u=0;return Sh(t,function(d){n+=d[0],o+=d[1],u++},!0),po([n/u,o/u],e.properties)}yve(kW,"centroid");var vve=Object.defineProperty,F_=(t,e)=>vve(t,"name",{value:e,configurable:!0});function DW(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return m5(t);case"FeatureCollection":return OW(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return zA(t);default:throw new Error("unknown GeoJSON type")}}F_(DW,"clone");function m5(t){const e={type:"Feature"};return Object.keys(t).forEach(n=>{switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=g5(t.properties),t.geometry==null?e.geometry=null:e.geometry=zA(t.geometry),e}F_(m5,"cloneFeature");function g5(t){const e={};return t&&Object.keys(t).forEach(n=>{const o=t[n];typeof o=="object"?o===null?e[n]=null:Array.isArray(o)?e[n]=o.map(u=>u):e[n]=g5(o):e[n]=o}),e}F_(g5,"cloneProperties");function OW(t){const e={type:"FeatureCollection"};return Object.keys(t).forEach(n=>{switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(n=>m5(n)),e}F_(OW,"cloneFeatureCollection");function zA(t){const e={type:t.type};return t.bbox&&(e.bbox=t.bbox),t.type==="GeometryCollection"?(e.geometries=t.geometries.map(n=>zA(n)),e):(e.coordinates=_5(t.coordinates),e)}F_(zA,"cloneGeometry");function _5(t){const e=t;return typeof e[0]!="object"?e.slice():e.map(n=>_5(n))}F_(_5,"deepSlice");var xve=Object.defineProperty,LW=(t,e)=>xve(t,"name",{value:e,configurable:!0});function FS(t,e,n,o={}){const u=e<0;let d=o5(Math.abs(e),o.units,"meters");u&&(d=-Math.abs(d));const _=Eo(t),v=BW(_,d,n);return v[0]+=v[0]-_[0]>180?-360:_[0]-v[0]>180?360:0,po(v,o.properties)}LW(FS,"rhumbDestination");function BW(t,e,n,o){o=o===void 0?Zs:Number(o);const u=e/o,d=t[0]*Math.PI/180,_=ls(t[1]),v=ls(n),a=u*Math.cos(v);let C=_+a;Math.abs(C)>Math.PI/2&&(C=C>0?Math.PI-C:-Math.PI-C);const A=Math.log(Math.tan(C/2+Math.PI/4)/Math.tan(_/2+Math.PI/4)),k=Math.abs(A)>1e-11?a/A:Math.cos(_),O=u*Math.sin(v)/k;return[((d+O)*180/Math.PI+540)%360-180,C*180/Math.PI]}LW(BW,"calculateRhumbDestination");var bve=Object.defineProperty,FW=(t,e)=>bve(t,"name",{value:e,configurable:!0});function zW(t,e,n={}){const o=Eo(t),u=Eo(e);u[0]+=u[0]-o[0]>180?-360:o[0]-u[0]>180?360:0;const d=NW(o,u);return o5(d,"meters",n.units)}FW(zW,"rhumbDistance");function NW(t,e,n){n=n===void 0?Zs:Number(n);const o=n,u=t[1]*Math.PI/180,d=e[1]*Math.PI/180,_=d-u;let v=Math.abs(e[0]-t[0])*Math.PI/180;v>Math.PI&&(v-=2*Math.PI);const a=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(u/2+Math.PI/4)),C=Math.abs(a)>1e-11?_/a:Math.cos(u);return Math.sqrt(_*_+C*C*v*v)*o}FW(NW,"calculateRhumbDistance");var wve=Object.defineProperty,Cve=(t,e)=>wve(t,"name",{value:e,configurable:!0});function UW(t,e,n){if(n=n||{},!L_(n))throw new Error("options is invalid");var o=n.pivot,u=n.mutate;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("angle is required");return e===0||(o||(o=kW(t)),(u===!1||u===void 0)&&(t=DW(t)),Sh(t,function(d){var _=KG(o,d),v=_+e,a=zW(o,d),C=dh(FS(o,a,v));d[0]=C[0],d[1]=C[1]})),t}Cve(UW,"transformRotate");var Eve=Object.defineProperty,$W=(t,e)=>Eve(t,"name",{value:e,configurable:!0});function jW(t,e,n,o){o=o||{};const u=o.steps||64,d=o.units||"kilometers",_=o.angle||0,v=o.pivot||t,a=o.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!L_(o))throw new Error("options must be an object");if(!sf(u))throw new Error("steps must be a number");if(!sf(_))throw new Error("angle must be a number");const C=Eo(t);if(d!=="degrees"){const k=FS(t,e,90,{units:d}),O=FS(t,n,0,{units:d});e=Eo(k)[0]-C[0],n=Eo(O)[1]-C[1]}const A=[];for(let k=0;k<u;k+=1){const O=k*-360/u;let R=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(u4(O),2)),z=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(u4(O),2));if(O<-90&&O>=-270&&(R=-R),O<-180&&O>=-360&&(z=-z),d==="degrees"){const N=ls(_),K=R*Math.cos(N)+z*Math.sin(N),q=z*Math.cos(N)-R*Math.sin(N);R=K,z=q}A.push([R+C[0],z+C[1]])}return A.push(A[0]),d==="degrees"?c_([A],a):UW(c_([A],a),_,{pivot:v})}$W(jW,"ellipse");function u4(t){const e=t*Math.PI/180;return Math.tan(e)}$W(u4,"getTanDeg");var Sve=Object.defineProperty,Tve=(t,e)=>Sve(t,"name",{value:e,configurable:!0});function VW(t){var e=t[0],n=t[1],o=t[2],u=t[3],d=ru(t.slice(0,2),[o,n]),_=ru(t.slice(0,2),[e,u]);if(d>=_){var v=(n+u)/2;return[e,v-(o-e)/2,o,v+(o-e)/2]}else{var a=(e+o)/2;return[a-(u-n)/2,n,a+(u-n)/2,u]}}Tve(VW,"square");var Ave=Object.defineProperty,HW=(t,e)=>Ave(t,"name",{value:e,configurable:!0});function GW(t,e){if(e=e??{},!L_(e))throw new Error("options is invalid");var n=e.precision,o=e.coordinates,u=e.mutate;if(n=n==null||isNaN(n)?6:n,o=o==null||isNaN(o)?3:o,!t)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof o!="number")throw new Error("<coordinates> must be a number");(u===!1||u===void 0)&&(t=JSON.parse(JSON.stringify(t)));var d=Math.pow(10,n);return Sh(t,function(_){WW(_,d,o)}),t}HW(GW,"truncate");function WW(t,e,n){t.length>n&&t.splice(n,t.length);for(var o=0;o<t.length;o++)t[o]=Math.round(t[o]*e)/e;return t}HW(WW,"truncateCoords");var Ive=Object.defineProperty,Y1=(t,e)=>Ive(t,"name",{value:e,configurable:!0});function qW(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=s4(t),o=s4(e);if(n!=="LineString")throw new Error("line must be LineString");if(o==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(o==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var u=GW(e,{precision:7});switch(o){case"Point":return zS(t,u);case"MultiPoint":return h4(t,u);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return h4(t,u5(t,u,{ignoreSelfIntersections:!0}))}}Y1(qW,"lineSplit");function h4(t,e){var n=[],o=h5();return Cm(e,function(u){if(n.forEach(function(v,a){v.id=a}),!n.length)n=zS(t,u).features,n.forEach(function(v){v.bbox||(v.bbox=VW(Cs(v)))}),o.load(ya(n));else{var d=o.search(u);if(d.features.length){var _=y5(u,d);n=n.filter(function(v){return v.id!==_.id}),o.remove(_),K1(zS(_,u),function(v){n.push(v),o.insert(v)})}}}),ya(n)}Y1(h4,"splitLineWithPoints");function zS(t,e){var n=[],o=dh(t)[0],u=dh(t)[t.geometry.coordinates.length-1];if(SE(o,Eo(e))||SE(u,Eo(e)))return ya([t]);var d=h5(),_=yW(t);d.load(_);var v=d.search(e);if(!v.features.length)return ya([t]);var a=y5(e,v),C=[o],A=ZG(_,function(k,O,R){var z=dh(O)[1],N=Eo(e);return R===a.id?(k.push(N),n.push(Es(k)),SE(N,z)?[N]:[N,z]):(k.push(z),k)},C);return A.length>1&&n.push(Es(A)),ya(n)}Y1(zS,"splitLineWithPoint");function y5(t,e){if(!e.features.length)throw new Error("lines must contain features");if(e.features.length===1)return e.features[0];var n,o=1/0;return K1(e,function(u){var d=d5(u,t),_=d.properties.dist;_<o&&(n=u,o=_)}),n}Y1(y5,"findClosestFeature");function SE(t,e){return t[0]===e[0]&&t[1]===e[1]}Y1(SE,"pointsEquals");function Qu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KW(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Xa={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},h_={duration:.5,overwrite:!1,delay:0},v5,js,qi,Il=1e8,Oi=1/Il,d4=Math.PI*2,Mve=d4/4,Pve=0,YW=Math.sqrt,Rve=Math.cos,kve=Math.sin,us=function(e){return typeof e=="string"},mo=function(e){return typeof e=="function"},vh=function(e){return typeof e=="number"},x5=function(e){return typeof e>"u"},mu=function(e){return typeof e=="object"},va=function(e){return e!==!1},b5=function(){return typeof window<"u"},NC=function(e){return mo(e)||us(e)},ZW=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Vs=Array.isArray,f4=/(?:-?\.?\d|\.)+/gi,XW=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,wg=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,rR=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,QW=/[+-]=-?[.\d]+/,JW=/[^,'"\[\]\s]+/gi,Dve=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,no,Zc,p4,w5,tl={},NS={},eq,tq=function(e){return(NS=um(e,tl))&&Sa},C5=function(e,n){return console.warn("Invalid property",e,"set to",n,"Missing plugin? gsap.registerPlugin()")},w1=function(e,n){return!n&&console.warn(e)},rq=function(e,n){return e&&(tl[e]=n)&&NS&&(NS[e]=n)||tl},C1=function(){return 0},Ove={suppressEvents:!0,isStart:!0,kill:!1},TE={suppressEvents:!0,kill:!1},Lve={suppressEvents:!0},E5={},Xd=[],m4={},nq,Ua={},nR={},o9=30,AE=[],S5="",T5=function(e){var n=e[0],o,u;if(mu(n)||mo(n)||(e=[e]),!(o=(n._gsap||{}).harness)){for(u=AE.length;u--&&!AE[u].targetTest(n););o=AE[u]}for(u=e.length;u--;)e[u]&&(e[u]._gsap||(e[u]._gsap=new Aq(e[u],o)))||e.splice(u,1);return e},Kp=function(e){return e._gsap||T5(Ml(e))[0]._gsap},iq=function(e,n,o){return(o=e[n])&&mo(o)?e[n]():x5(o)&&e.getAttribute&&e.getAttribute(n)||o},xa=function(e,n){return(e=e.split(",")).forEach(n)||e},bo=function(e){return Math.round(e*1e5)/1e5||0},ss=function(e){return Math.round(e*1e7)/1e7||0},Bg=function(e,n){var o=n.charAt(0),u=parseFloat(n.substr(2));return e=parseFloat(e),o==="+"?e+u:o==="-"?e-u:o==="*"?e*u:e/u},Bve=function(e,n){for(var o=n.length,u=0;e.indexOf(n[u])<0&&++u<o;);return u<o},US=function(){var e=Xd.length,n=Xd.slice(0),o,u;for(m4={},Xd.length=0,o=0;o<e;o++)u=n[o],u&&u._lazy&&(u.render(u._lazy[0],u._lazy[1],!0)._lazy=0)},oq=function(e,n,o,u){Xd.length&&!js&&US(),e.render(n,o,js&&n<0&&(e._initted||e._startAt)),Xd.length&&!js&&US()},sq=function(e){var n=parseFloat(e);return(n||n===0)&&(e+"").match(JW).length<2?n:us(e)?e.trim():e},aq=function(e){return e},Ll=function(e,n){for(var o in n)o in e||(e[o]=n[o]);return e},Fve=function(e){return function(n,o){for(var u in o)u in n||u==="duration"&&e||u==="ease"||(n[u]=o[u])}},um=function(e,n){for(var o in n)e[o]=n[o];return e},s9=function t(e,n){for(var o in n)o!=="__proto__"&&o!=="constructor"&&o!=="prototype"&&(e[o]=mu(n[o])?t(e[o]||(e[o]={}),n[o]):n[o]);return e},$S=function(e,n){var o={},u;for(u in e)u in n||(o[u]=e[u]);return o},Bx=function(e){var n=e.parent||no,o=e.keyframes?Fve(Vs(e.keyframes)):Ll;if(va(e.inherit))for(;n;)o(e,n.vars.defaults),n=n.parent||n._dp;return e},zve=function(e,n){for(var o=e.length,u=o===n.length;u&&o--&&e[o]===n[o];);return o<0},lq=function(e,n,o,u,d){var _=e[u],v;if(d)for(v=n[d];_&&_[d]>v;)_=_._prev;return _?(n._next=_._next,_._next=n):(n._next=e[o],e[o]=n),n._next?n._next._prev=n:e[u]=n,n._prev=_,n.parent=n._dp=e,n},NA=function(e,n,o,u){o===void 0&&(o="_first"),u===void 0&&(u="_last");var d=n._prev,_=n._next;d?d._next=_:e[o]===n&&(e[o]=_),_?_._prev=d:e[u]===n&&(e[u]=d),n._next=n._prev=n.parent=null},lf=function(e,n){e.parent&&(!n||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Yp=function(e,n){if(e&&(!n||n._end>e._dur||n._start<0))for(var o=e;o;)o._dirty=1,o=o.parent;return e},Nve=function(e){for(var n=e.parent;n&&n.parent;)n._dirty=1,n.totalDuration(),n=n.parent;return e},g4=function(e,n,o,u){return e._startAt&&(js?e._startAt.revert(TE):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(n,!0,u))},Uve=function t(e){return!e||e._ts&&t(e.parent)},a9=function(e){return e._repeat?d_(e._tTime,e=e.duration()+e._rDelay)*e:0},d_=function(e,n){var o=Math.floor(e/=n);return e&&o===e?o-1:o},jS=function(e,n){return(e-n._start)*n._ts+(n._ts>=0?0:n._dirty?n.totalDuration():n._tDur)},UA=function(e){return e._end=ss(e._start+(e._tDur/Math.abs(e._ts||e._rts||Oi)||0))},$A=function(e,n){var o=e._dp;return o&&o.smoothChildTiming&&e._ts&&(e._start=ss(o._time-(e._ts>0?n/e._ts:((e._dirty?e.totalDuration():e._tDur)-n)/-e._ts)),UA(e),o._dirty||Yp(o,e)),e},cq=function(e,n){var o;if((n._time||!n._dur&&n._initted||n._start<e._time&&(n._dur||!n.add))&&(o=jS(e.rawTime(),n),(!n._dur||Z1(0,n.totalDuration(),o)-n._tTime>Oi)&&n.render(o,!0)),Yp(e,n)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(o=e;o._dp;)o.rawTime()>=0&&o.totalTime(o._tTime),o=o._dp;e._zTime=-Oi}},nu=function(e,n,o,u){return n.parent&&lf(n),n._start=ss((vh(o)?o:o||e!==no?vl(e,o,n):e._time)+n._delay),n._end=ss(n._start+(n.totalDuration()/Math.abs(n.timeScale())||0)),lq(e,n,"_first","_last",e._sort?"_start":0),_4(n)||(e._recent=n),u||cq(e,n),e._ts<0&&$A(e,e._tTime),e},uq=function(e,n){return(tl.ScrollTrigger||C5("scrollTrigger",n))&&tl.ScrollTrigger.create(n,e)},hq=function(e,n,o,u,d){if(I5(e,n,d),!e._initted)return 1;if(!o&&e._pt&&!js&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&nq!==ja.frame)return Xd.push(e),e._lazy=[d,u],1},$ve=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},_4=function(e){var n=e.data;return n==="isFromStart"||n==="isStart"},jve=function(e,n,o,u){var d=e.ratio,_=n<0||!n&&(!e._start&&$ve(e)&&!(!e._initted&&_4(e))||(e._ts<0||e._dp._ts<0)&&!_4(e))?0:1,v=e._rDelay,a=0,C,A,k;if(v&&e._repeat&&(a=Z1(0,e._tDur,n),A=d_(a,v),e._yoyo&&A&1&&(_=1-_),A!==d_(e._tTime,v)&&(d=1-_,e.vars.repeatRefresh&&e._initted&&e.invalidate())),_!==d||js||u||e._zTime===Oi||!n&&e._zTime){if(!e._initted&&hq(e,n,u,o,a))return;for(k=e._zTime,e._zTime=n||(o?Oi:0),o||(o=n&&!k),e.ratio=_,e._from&&(_=1-_),e._time=0,e._tTime=a,C=e._pt;C;)C.r(_,C.d),C=C._next;n<0&&g4(e,n,o,!0),e._onUpdate&&!o&&Wa(e,"onUpdate"),a&&e._repeat&&!o&&e.parent&&Wa(e,"onRepeat"),(n>=e._tDur||n<0)&&e.ratio===_&&(_&&lf(e,1),!o&&!js&&(Wa(e,_?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=n)},Vve=function(e,n,o){var u;if(o>n)for(u=e._first;u&&u._start<=o;){if(u.data==="isPause"&&u._start>n)return u;u=u._next}else for(u=e._last;u&&u._start>=o;){if(u.data==="isPause"&&u._start<n)return u;u=u._prev}},f_=function(e,n,o,u){var d=e._repeat,_=ss(n)||0,v=e._tTime/e._tDur;return v&&!u&&(e._time*=_/e._dur),e._dur=_,e._tDur=d?d<0?1e10:ss(_*(d+1)+e._rDelay*d):_,v>0&&!u&&$A(e,e._tTime=e._tDur*v),e.parent&&UA(e),o||Yp(e.parent,e),e},l9=function(e){return e instanceof Js?Yp(e):f_(e,e._dur)},Hve={_start:0,endTime:C1,totalDuration:C1},vl=function t(e,n,o){var u=e.labels,d=e._recent||Hve,_=e.duration()>=Il?d.endTime(!1):e._dur,v,a,C;return us(n)&&(isNaN(n)||n in u)?(a=n.charAt(0),C=n.substr(-1)==="%",v=n.indexOf("="),a==="<"||a===">"?(v>=0&&(n=n.replace(/=/,"")),(a==="<"?d._start:d.endTime(d._repeat>=0))+(parseFloat(n.substr(1))||0)*(C?(v<0?d:o).totalDuration()/100:1)):v<0?(n in u||(u[n]=_),u[n]):(a=parseFloat(n.charAt(v-1)+n.substr(v+1)),C&&o&&(a=a/100*(Vs(o)?o[0]:o).totalDuration()),v>1?t(e,n.substr(0,v-1),o)+a:_+a)):n==null?_:+n},Fx=function(e,n,o){var u=vh(n[1]),d=(u?2:1)+(e<2?0:1),_=n[d],v,a;if(u&&(_.duration=n[1]),_.parent=o,e){for(v=_,a=o;a&&!("immediateRender"in v);)v=a.vars.defaults||{},a=va(a.vars.inherit)&&a.parent;_.immediateRender=va(v.immediateRender),e<2?_.runBackwards=1:_.startAt=n[d-1]}return new Fo(n[0],_,n[d+1])},vf=function(e,n){return e||e===0?n(e):n},Z1=function(e,n,o){return o<e?e:o>n?n:o},$s=function(e,n){return!us(e)||!(n=Dve.exec(e))?"":n[1]},Gve=function(e,n,o){return vf(o,function(u){return Z1(e,n,u)})},y4=[].slice,dq=function(e,n){return e&&mu(e)&&"length"in e&&(!n&&!e.length||e.length-1 in e&&mu(e[0]))&&!e.nodeType&&e!==Zc},Wve=function(e,n,o){return o===void 0&&(o=[]),e.forEach(function(u){var d;return us(u)&&!n||dq(u,1)?(d=o).push.apply(d,Ml(u)):o.push(u)})||o},Ml=function(e,n,o){return qi&&!n&&qi.selector?qi.selector(e):us(e)&&!o&&(p4||!p_())?y4.call((n||w5).querySelectorAll(e),0):Vs(e)?Wve(e,o):dq(e)?y4.call(e,0):e?[e]:[]},v4=function(e){return e=Ml(e)[0]||w1("Invalid scope")||{},function(n){var o=e.current||e.nativeElement||e;return Ml(n,o.querySelectorAll?o:o===e?w1("Invalid scope")||w5.createElement("div"):e)}},fq=function(e){return e.sort(function(){return .5-Math.random()})},pq=function(e){if(mo(e))return e;var n=mu(e)?e:{each:e},o=Zp(n.ease),u=n.from||0,d=parseFloat(n.base)||0,_={},v=u>0&&u<1,a=isNaN(u)||v,C=n.axis,A=u,k=u;return us(u)?A=k={center:.5,edges:.5,end:1}[u]||0:!v&&a&&(A=u[0],k=u[1]),function(O,R,z){var N=(z||n).length,K=_[N],q,j,H,Y,te,J,ae,de,Me;if(!K){if(Me=n.grid==="auto"?0:(n.grid||[1,Il])[1],!Me){for(ae=-Il;ae<(ae=z[Me++].getBoundingClientRect().left)&&Me<N;);Me<N&&Me--}for(K=_[N]=[],q=a?Math.min(Me,N)*A-.5:u%Me,j=Me===Il?0:a?N*k/Me-.5:u/Me|0,ae=0,de=Il,J=0;J<N;J++)H=J%Me-q,Y=j-(J/Me|0),K[J]=te=C?Math.abs(C==="y"?Y:H):YW(H*H+Y*Y),te>ae&&(ae=te),te<de&&(de=te);u==="random"&&fq(K),K.max=ae-de,K.min=de,K.v=N=(parseFloat(n.amount)||parseFloat(n.each)*(Me>N?N-1:C?C==="y"?N/Me:Me:Math.max(Me,N/Me))||0)*(u==="edges"?-1:1),K.b=N<0?d-N:d,K.u=$s(n.amount||n.each)||0,o=o&&N<0?Eq(o):o}return N=(K[O]-K.min)/K.max||0,ss(K.b+(o?o(N):N)*K.v)+K.u}},x4=function(e){var n=Math.pow(10,((e+"").split(".")[1]||"").length);return function(o){var u=ss(Math.round(parseFloat(o)/e)*e*n);return(u-u%1)/n+(vh(o)?0:$s(o))}},mq=function(e,n){var o=Vs(e),u,d;return!o&&mu(e)&&(u=o=e.radius||Il,e.values?(e=Ml(e.values),(d=!vh(e[0]))&&(u*=u)):e=x4(e.increment)),vf(n,o?mo(e)?function(_){return d=e(_),Math.abs(d-_)<=u?d:_}:function(_){for(var v=parseFloat(d?_.x:_),a=parseFloat(d?_.y:0),C=Il,A=0,k=e.length,O,R;k--;)d?(O=e[k].x-v,R=e[k].y-a,O=O*O+R*R):O=Math.abs(e[k]-v),O<C&&(C=O,A=k);return A=!u||C<=u?e[A]:_,d||A===_||vh(_)?A:A+$s(_)}:x4(e))},gq=function(e,n,o,u){return vf(Vs(e)?!n:o===!0?!!(o=0):!u,function(){return Vs(e)?e[~~(Math.random()*e.length)]:(o=o||1e-5)&&(u=o<1?Math.pow(10,(o+"").length-2):1)&&Math.floor(Math.round((e-o/2+Math.random()*(n-e+o*.99))/o)*o*u)/u})},qve=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(u){return n.reduce(function(d,_){return _(d)},u)}},Kve=function(e,n){return function(o){return e(parseFloat(o))+(n||$s(o))}},Yve=function(e,n,o){return yq(e,n,0,1,o)},_q=function(e,n,o){return vf(o,function(u){return e[~~n(u)]})},Zve=function t(e,n,o){var u=n-e;return Vs(e)?_q(e,t(0,e.length),n):vf(o,function(d){return(u+(d-e)%u)%u+e})},Xve=function t(e,n,o){var u=n-e,d=u*2;return Vs(e)?_q(e,t(0,e.length-1),n):vf(o,function(_){return _=(d+(_-e)%d)%d||0,e+(_>u?d-_:_)})},E1=function(e){for(var n=0,o="",u,d,_,v;~(u=e.indexOf("random(",n));)_=e.indexOf(")",u),v=e.charAt(u+7)==="[",d=e.substr(u+7,_-u-7).match(v?JW:f4),o+=e.substr(n,u-n)+gq(v?d:+d[0],v?0:+d[1],+d[2]||1e-5),n=_+1;return o+e.substr(n,e.length-n)},yq=function(e,n,o,u,d){var _=n-e,v=u-o;return vf(d,function(a){return o+((a-e)/_*v||0)})},Qve=function t(e,n,o,u){var d=isNaN(e+n)?0:function(R){return(1-R)*e+R*n};if(!d){var _=us(e),v={},a,C,A,k,O;if(o===!0&&(u=1)&&(o=null),_)e={p:e},n={p:n};else if(Vs(e)&&!Vs(n)){for(A=[],k=e.length,O=k-2,C=1;C<k;C++)A.push(t(e[C-1],e[C]));k--,d=function(z){z*=k;var N=Math.min(O,~~z);return A[N](z-N)},o=n}else u||(e=um(Vs(e)?[]:{},e));if(!A){for(a in n)A5.call(v,e,a,"get",n[a]);d=function(z){return R5(z,v)||(_?e.p:e)}}}return vf(o,d)},c9=function(e,n,o){var u=e.labels,d=Il,_,v,a;for(_ in u)v=u[_]-n,v<0==!!o&&v&&d>(v=Math.abs(v))&&(a=_,d=v);return a},Wa=function(e,n,o){var u=e.vars,d=u[n],_=qi,v=e._ctx,a,C,A;if(d)return a=u[n+"Params"],C=u.callbackScope||e,o&&Xd.length&&US(),v&&(qi=v),A=a?d.apply(C,a):d.call(C),qi=_,A},px=function(e){return lf(e),e.scrollTrigger&&e.scrollTrigger.kill(!!js),e.progress()<1&&Wa(e,"onInterrupt"),e},Cg,vq=[],xq=function(e){if(e)if(e=!e.name&&e.default||e,b5()||e.headless){var n=e.name,o=mo(e),u=n&&!o&&e.init?function(){this._props=[]}:e,d={init:C1,render:R5,add:A5,kill:pxe,modifier:fxe,rawVars:0},_={targetTest:0,get:0,getSetter:P5,aliases:{},register:0};if(p_(),e!==u){if(Ua[n])return;Ll(u,Ll($S(e,d),_)),um(u.prototype,um(d,$S(e,_))),Ua[u.prop=n]=u,e.targetTest&&(AE.push(u),E5[n]=1),n=(n==="css"?"CSS":n.charAt(0).toUpperCase()+n.substr(1))+"Plugin"}rq(n,u),e.register&&e.register(Sa,u,ba)}else vq.push(e)},Ai=255,mx={aqua:[0,Ai,Ai],lime:[0,Ai,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ai],navy:[0,0,128],white:[Ai,Ai,Ai],olive:[128,128,0],yellow:[Ai,Ai,0],orange:[Ai,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ai,0,0],pink:[Ai,192,203],cyan:[0,Ai,Ai],transparent:[Ai,Ai,Ai,0]},iR=function(e,n,o){return e+=e<0?1:e>1?-1:0,(e*6<1?n+(o-n)*e*6:e<.5?o:e*3<2?n+(o-n)*(2/3-e)*6:n)*Ai+.5|0},bq=function(e,n,o){var u=e?vh(e)?[e>>16,e>>8&Ai,e&Ai]:0:mx.black,d,_,v,a,C,A,k,O,R,z;if(!u){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),mx[e])u=mx[e];else if(e.charAt(0)==="#"){if(e.length<6&&(d=e.charAt(1),_=e.charAt(2),v=e.charAt(3),e="#"+d+d+_+_+v+v+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return u=parseInt(e.substr(1,6),16),[u>>16,u>>8&Ai,u&Ai,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),u=[e>>16,e>>8&Ai,e&Ai]}else if(e.substr(0,3)==="hsl"){if(u=z=e.match(f4),!n)a=+u[0]%360/360,C=+u[1]/100,A=+u[2]/100,_=A<=.5?A*(C+1):A+C-A*C,d=A*2-_,u.length>3&&(u[3]*=1),u[0]=iR(a+1/3,d,_),u[1]=iR(a,d,_),u[2]=iR(a-1/3,d,_);else if(~e.indexOf("="))return u=e.match(XW),o&&u.length<4&&(u[3]=1),u}else u=e.match(f4)||mx.transparent;u=u.map(Number)}return n&&!z&&(d=u[0]/Ai,_=u[1]/Ai,v=u[2]/Ai,k=Math.max(d,_,v),O=Math.min(d,_,v),A=(k+O)/2,k===O?a=C=0:(R=k-O,C=A>.5?R/(2-k-O):R/(k+O),a=k===d?(_-v)/R+(_<v?6:0):k===_?(v-d)/R+2:(d-_)/R+4,a*=60),u[0]=~~(a+.5),u[1]=~~(C*100+.5),u[2]=~~(A*100+.5)),o&&u.length<4&&(u[3]=1),u},wq=function(e){var n=[],o=[],u=-1;return e.split(Qd).forEach(function(d){var _=d.match(wg)||[];n.push.apply(n,_),o.push(u+=_.length+1)}),n.c=o,n},u9=function(e,n,o){var u="",d=(e+u).match(Qd),_=n?"hsla(":"rgba(",v=0,a,C,A,k;if(!d)return e;if(d=d.map(function(O){return(O=bq(O,n,1))&&_+(n?O[0]+","+O[1]+"%,"+O[2]+"%,"+O[3]:O.join(","))+")"}),o&&(A=wq(e),a=o.c,a.join(u)!==A.c.join(u)))for(C=e.replace(Qd,"1").split(wg),k=C.length-1;v<k;v++)u+=C[v]+(~a.indexOf(v)?d.shift()||_+"0,0,0,0)":(A.length?A:d.length?d:o).shift());if(!C)for(C=e.split(Qd),k=C.length-1;v<k;v++)u+=C[v]+d[v];return u+C[k]},Qd=function(){var t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in mx)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Jve=/hsl[a]?\(/,Cq=function(e){var n=e.join(" "),o;if(Qd.lastIndex=0,Qd.test(n))return o=Jve.test(n),e[1]=u9(e[1],o),e[0]=u9(e[0],o,wq(e[1])),!0},S1,ja=function(){var t=Date.now,e=500,n=33,o=t(),u=o,d=1e3/240,_=d,v=[],a,C,A,k,O,R,z=function N(K){var q=t()-u,j=K===!0,H,Y,te,J;if((q>e||q<0)&&(o+=q-n),u+=q,te=u-o,H=te-_,(H>0||j)&&(J=++k.frame,O=te-k.time*1e3,k.time=te=te/1e3,_+=H+(H>=d?4:d-H),Y=1),j||(a=C(N)),Y)for(R=0;R<v.length;R++)v[R](te,O,J,K)};return k={time:0,frame:0,tick:function(){z(!0)},deltaRatio:function(K){return O/(1e3/(K||60))},wake:function(){eq&&(!p4&&b5()&&(Zc=p4=window,w5=Zc.document||{},tl.gsap=Sa,(Zc.gsapVersions||(Zc.gsapVersions=[])).push(Sa.version),tq(NS||Zc.GreenSockGlobals||!Zc.gsap&&Zc||{}),vq.forEach(xq)),A=typeof requestAnimationFrame<"u"&&requestAnimationFrame,a&&k.sleep(),C=A||function(K){return setTimeout(K,_-k.time*1e3+1|0)},S1=1,z(2))},sleep:function(){(A?cancelAnimationFrame:clearTimeout)(a),S1=0,C=C1},lagSmoothing:function(K,q){e=K||1/0,n=Math.min(q||33,e)},fps:function(K){d=1e3/(K||240),_=k.time*1e3+d},add:function(K,q,j){var H=q?function(Y,te,J,ae){K(Y,te,J,ae),k.remove(H)}:K;return k.remove(K),v[j?"unshift":"push"](H),p_(),H},remove:function(K,q){~(q=v.indexOf(K))&&v.splice(q,1)&&R>=q&&R--},_listeners:v},k}(),p_=function(){return!S1&&ja.wake()},Kn={},exe=/^[\d.\-M][\d.\-,\s]/,txe=/["']/g,rxe=function(e){for(var n={},o=e.substr(1,e.length-3).split(":"),u=o[0],d=1,_=o.length,v,a,C;d<_;d++)a=o[d],v=d!==_-1?a.lastIndexOf(","):a.length,C=a.substr(0,v),n[u]=isNaN(C)?C.replace(txe,"").trim():+C,u=a.substr(v+1).trim();return n},nxe=function(e){var n=e.indexOf("(")+1,o=e.indexOf(")"),u=e.indexOf("(",n);return e.substring(n,~u&&u<o?e.indexOf(")",o+1):o)},ixe=function(e){var n=(e+"").split("("),o=Kn[n[0]];return o&&n.length>1&&o.config?o.config.apply(null,~e.indexOf("{")?[rxe(n[1])]:nxe(e).split(",").map(sq)):Kn._CE&&exe.test(e)?Kn._CE("",e):o},Eq=function(e){return function(n){return 1-e(1-n)}},Sq=function t(e,n){for(var o=e._first,u;o;)o instanceof Js?t(o,n):o.vars.yoyoEase&&(!o._yoyo||!o._repeat)&&o._yoyo!==n&&(o.timeline?t(o.timeline,n):(u=o._ease,o._ease=o._yEase,o._yEase=u,o._yoyo=n)),o=o._next},Zp=function(e,n){return e&&(mo(e)?e:Kn[e]||ixe(e))||n},Em=function(e,n,o,u){o===void 0&&(o=function(a){return 1-n(1-a)}),u===void 0&&(u=function(a){return a<.5?n(a*2)/2:1-n((1-a)*2)/2});var d={easeIn:n,easeOut:o,easeInOut:u},_;return xa(e,function(v){Kn[v]=tl[v]=d,Kn[_=v.toLowerCase()]=o;for(var a in d)Kn[_+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=Kn[v+"."+a]=d[a]}),d},Tq=function(e){return function(n){return n<.5?(1-e(1-n*2))/2:.5+e((n-.5)*2)/2}},oR=function t(e,n,o){var u=n>=1?n:1,d=(o||(e?.3:.45))/(n<1?n:1),_=d/d4*(Math.asin(1/u)||0),v=function(A){return A===1?1:u*Math.pow(2,-10*A)*kve((A-_)*d)+1},a=e==="out"?v:e==="in"?function(C){return 1-v(1-C)}:Tq(v);return d=d4/d,a.config=function(C,A){return t(e,C,A)},a},sR=function t(e,n){n===void 0&&(n=1.70158);var o=function(_){return _?--_*_*((n+1)*_+n)+1:0},u=e==="out"?o:e==="in"?function(d){return 1-o(1-d)}:Tq(o);return u.config=function(d){return t(e,d)},u};xa("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var n=e<5?e+1:e;Em(t+",Power"+(n-1),e?function(o){return Math.pow(o,n)}:function(o){return o},function(o){return 1-Math.pow(1-o,n)},function(o){return o<.5?Math.pow(o*2,n)/2:1-Math.pow((1-o)*2,n)/2})});Kn.Linear.easeNone=Kn.none=Kn.Linear.easeIn;Em("Elastic",oR("in"),oR("out"),oR());(function(t,e){var n=1/e,o=2*n,u=2.5*n,d=function(v){return v<n?t*v*v:v<o?t*Math.pow(v-1.5/e,2)+.75:v<u?t*(v-=2.25/e)*v+.9375:t*Math.pow(v-2.625/e,2)+.984375};Em("Bounce",function(_){return 1-d(1-_)},d)})(7.5625,2.75);Em("Expo",function(t){return t?Math.pow(2,10*(t-1)):0});Em("Circ",function(t){return-(YW(1-t*t)-1)});Em("Sine",function(t){return t===1?1:-Rve(t*Mve)+1});Em("Back",sR("in"),sR("out"),sR());Kn.SteppedEase=Kn.steps=tl.SteppedEase={config:function(e,n){e===void 0&&(e=1);var o=1/e,u=e+(n?0:1),d=n?1:0,_=1-Oi;return function(v){return((u*Z1(0,_,v)|0)+d)*o}}};h_.ease=Kn["quad.out"];xa("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return S5+=t+","+t+"Params,"});var Aq=function(e,n){this.id=Pve++,e._gsap=this,this.target=e,this.harness=n,this.get=n?n.get:iq,this.set=n?n.getSetter:P5},T1=function(){function t(n){this.vars=n,this._delay=+n.delay||0,(this._repeat=n.repeat===1/0?-2:n.repeat||0)&&(this._rDelay=n.repeatDelay||0,this._yoyo=!!n.yoyo||!!n.yoyoEase),this._ts=1,f_(this,+n.duration,1,1),this.data=n.data,qi&&(this._ctx=qi,qi.data.push(this)),S1||ja.wake()}var e=t.prototype;return e.delay=function(o){return o||o===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+o-this._delay),this._delay=o,this):this._delay},e.duration=function(o){return arguments.length?this.totalDuration(this._repeat>0?o+(o+this._rDelay)*this._repeat:o):this.totalDuration()&&this._dur},e.totalDuration=function(o){return arguments.length?(this._dirty=0,f_(this,this._repeat<0?o:(o-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(o,u){if(p_(),!arguments.length)return this._tTime;var d=this._dp;if(d&&d.smoothChildTiming&&this._ts){for($A(this,o),!d._dp||d.parent||cq(d,this);d&&d.parent;)d.parent._time!==d._start+(d._ts>=0?d._tTime/d._ts:(d.totalDuration()-d._tTime)/-d._ts)&&d.totalTime(d._tTime,!0),d=d.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&o<this._tDur||this._ts<0&&o>0||!this._tDur&&!o)&&nu(this._dp,this,this._start-this._delay)}return(this._tTime!==o||!this._dur&&!u||this._initted&&Math.abs(this._zTime)===Oi||!o&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=o),oq(this,o,u)),this},e.time=function(o,u){return arguments.length?this.totalTime(Math.min(this.totalDuration(),o+a9(this))%(this._dur+this._rDelay)||(o?this._dur:0),u):this._time},e.totalProgress=function(o,u){return arguments.length?this.totalTime(this.totalDuration()*o,u):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(o,u){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-o:o)+a9(this),u):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(o,u){var d=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(o-1)*d,u):this._repeat?d_(this._tTime,d)+1:1},e.timeScale=function(o,u){if(!arguments.length)return this._rts===-Oi?0:this._rts;if(this._rts===o)return this;var d=this.parent&&this._ts?jS(this.parent._time,this):this._tTime;return this._rts=+o||0,this._ts=this._ps||o===-Oi?0:this._rts,this.totalTime(Z1(-Math.abs(this._delay),this._tDur,d),u!==!1),UA(this),Nve(this)},e.paused=function(o){return arguments.length?(this._ps!==o&&(this._ps=o,o?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(p_(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Oi&&(this._tTime-=Oi)))),this):this._ps},e.startTime=function(o){if(arguments.length){this._start=o;var u=this.parent||this._dp;return u&&(u._sort||!this.parent)&&nu(u,this,o-this._delay),this}return this._start},e.endTime=function(o){return this._start+(va(o)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(o){var u=this.parent||this._dp;return u?o&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?jS(u.rawTime(o),this):this._tTime:this._tTime},e.revert=function(o){o===void 0&&(o=Lve);var u=js;return js=o,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(o),this.totalTime(-.01,o.suppressEvents)),this.data!=="nested"&&o.kill!==!1&&this.kill(),js=u,this},e.globalTime=function(o){for(var u=this,d=arguments.length?o:u.rawTime();u;)d=u._start+d/(Math.abs(u._ts)||1),u=u._dp;return!this.parent&&this._sat?this._sat.globalTime(o):d},e.repeat=function(o){return arguments.length?(this._repeat=o===1/0?-2:o,l9(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(o){if(arguments.length){var u=this._time;return this._rDelay=o,l9(this),u?this.time(u):this}return this._rDelay},e.yoyo=function(o){return arguments.length?(this._yoyo=o,this):this._yoyo},e.seek=function(o,u){return this.totalTime(vl(this,o),va(u))},e.restart=function(o,u){return this.play().totalTime(o?-this._delay:0,va(u))},e.play=function(o,u){return o!=null&&this.seek(o,u),this.reversed(!1).paused(!1)},e.reverse=function(o,u){return o!=null&&this.seek(o||this.totalDuration(),u),this.reversed(!0).paused(!1)},e.pause=function(o,u){return o!=null&&this.seek(o,u),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(o){return arguments.length?(!!o!==this.reversed()&&this.timeScale(-this._rts||(o?-Oi:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Oi,this},e.isActive=function(){var o=this.parent||this._dp,u=this._start,d;return!!(!o||this._ts&&this._initted&&o.isActive()&&(d=o.rawTime(!0))>=u&&d<this.endTime(!0)-Oi)},e.eventCallback=function(o,u,d){var _=this.vars;return arguments.length>1?(u?(_[o]=u,d&&(_[o+"Params"]=d),o==="onUpdate"&&(this._onUpdate=u)):delete _[o],this):_[o]},e.then=function(o){var u=this;return new Promise(function(d){var _=mo(o)?o:aq,v=function(){var C=u.then;u.then=null,mo(_)&&(_=_(u))&&(_.then||_===u)&&(u.then=C),d(_),u.then=C};u._initted&&u.totalProgress()===1&&u._ts>=0||!u._tTime&&u._ts<0?v():u._prom=v})},e.kill=function(){px(this)},t}();Ll(T1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Oi,_prom:0,_ps:!1,_rts:1});var Js=function(t){KW(e,t);function e(o,u){var d;return o===void 0&&(o={}),d=t.call(this,o)||this,d.labels={},d.smoothChildTiming=!!o.smoothChildTiming,d.autoRemoveChildren=!!o.autoRemoveChildren,d._sort=va(o.sortChildren),no&&nu(o.parent||no,Qu(d),u),o.reversed&&d.reverse(),o.paused&&d.paused(!0),o.scrollTrigger&&uq(Qu(d),o.scrollTrigger),d}var n=e.prototype;return n.to=function(u,d,_){return Fx(0,arguments,this),this},n.from=function(u,d,_){return Fx(1,arguments,this),this},n.fromTo=function(u,d,_,v){return Fx(2,arguments,this),this},n.set=function(u,d,_){return d.duration=0,d.parent=this,Bx(d).repeatDelay||(d.repeat=0),d.immediateRender=!!d.immediateRender,new Fo(u,d,vl(this,_),1),this},n.call=function(u,d,_){return nu(this,Fo.delayedCall(0,u,d),_)},n.staggerTo=function(u,d,_,v,a,C,A){return _.duration=d,_.stagger=_.stagger||v,_.onComplete=C,_.onCompleteParams=A,_.parent=this,new Fo(u,_,vl(this,a)),this},n.staggerFrom=function(u,d,_,v,a,C,A){return _.runBackwards=1,Bx(_).immediateRender=va(_.immediateRender),this.staggerTo(u,d,_,v,a,C,A)},n.staggerFromTo=function(u,d,_,v,a,C,A,k){return v.startAt=_,Bx(v).immediateRender=va(v.immediateRender),this.staggerTo(u,d,v,a,C,A,k)},n.render=function(u,d,_){var v=this._time,a=this._dirty?this.totalDuration():this._tDur,C=this._dur,A=u<=0?0:ss(u),k=this._zTime<0!=u<0&&(this._initted||!C),O,R,z,N,K,q,j,H,Y,te,J,ae;if(this!==no&&A>a&&u>=0&&(A=a),A!==this._tTime||_||k){if(v!==this._time&&C&&(A+=this._time-v,u+=this._time-v),O=A,Y=this._start,H=this._ts,q=!H,k&&(C||(v=this._zTime),(u||!d)&&(this._zTime=u)),this._repeat){if(J=this._yoyo,K=C+this._rDelay,this._repeat<-1&&u<0)return this.totalTime(K*100+u,d,_);if(O=ss(A%K),A===a?(N=this._repeat,O=C):(N=~~(A/K),N&&N===A/K&&(O=C,N--),O>C&&(O=C)),te=d_(this._tTime,K),!v&&this._tTime&&te!==N&&this._tTime-te*K-this._dur<=0&&(te=N),J&&N&1&&(O=C-O,ae=1),N!==te&&!this._lock){var de=J&&te&1,Me=de===(J&&N&1);if(N<te&&(de=!de),v=de?0:A%C?C:A,this._lock=1,this.render(v||(ae?0:ss(N*K)),d,!C)._lock=0,this._tTime=A,!d&&this.parent&&Wa(this,"onRepeat"),this.vars.repeatRefresh&&!ae&&(this.invalidate()._lock=1),v&&v!==this._time||q!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(C=this._dur,a=this._tDur,Me&&(this._lock=2,v=de?C:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!ae&&this.invalidate()),this._lock=0,!this._ts&&!q)return this;Sq(this,ae)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(j=Vve(this,ss(v),ss(O)),j&&(A-=O-(O=j._start))),this._tTime=A,this._time=O,this._act=!H,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=u,v=0),!v&&O&&!d&&!N&&(Wa(this,"onStart"),this._tTime!==A))return this;if(O>=v&&u>=0)for(R=this._first;R;){if(z=R._next,(R._act||O>=R._start)&&R._ts&&j!==R){if(R.parent!==this)return this.render(u,d,_);if(R.render(R._ts>0?(O-R._start)*R._ts:(R._dirty?R.totalDuration():R._tDur)+(O-R._start)*R._ts,d,_),O!==this._time||!this._ts&&!q){j=0,z&&(A+=this._zTime=-Oi);break}}R=z}else{R=this._last;for(var Ce=u<0?u:O;R;){if(z=R._prev,(R._act||Ce<=R._end)&&R._ts&&j!==R){if(R.parent!==this)return this.render(u,d,_);if(R.render(R._ts>0?(Ce-R._start)*R._ts:(R._dirty?R.totalDuration():R._tDur)+(Ce-R._start)*R._ts,d,_||js&&(R._initted||R._startAt)),O!==this._time||!this._ts&&!q){j=0,z&&(A+=this._zTime=Ce?-Oi:Oi);break}}R=z}}if(j&&!d&&(this.pause(),j.render(O>=v?0:-Oi)._zTime=O>=v?1:-1,this._ts))return this._start=Y,UA(this),this.render(u,d,_);this._onUpdate&&!d&&Wa(this,"onUpdate",!0),(A===a&&this._tTime>=this.totalDuration()||!A&&v)&&(Y===this._start||Math.abs(H)!==Math.abs(this._ts))&&(this._lock||((u||!C)&&(A===a&&this._ts>0||!A&&this._ts<0)&&lf(this,1),!d&&!(u<0&&!v)&&(A||v||!a)&&(Wa(this,A===a&&u>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(A<a&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(u,d){var _=this;if(vh(d)||(d=vl(this,d,u)),!(u instanceof T1)){if(Vs(u))return u.forEach(function(v){return _.add(v,d)}),this;if(us(u))return this.addLabel(u,d);if(mo(u))u=Fo.delayedCall(0,u);else return this}return this!==u?nu(this,u,d):this},n.getChildren=function(u,d,_,v){u===void 0&&(u=!0),d===void 0&&(d=!0),_===void 0&&(_=!0),v===void 0&&(v=-Il);for(var a=[],C=this._first;C;)C._start>=v&&(C instanceof Fo?d&&a.push(C):(_&&a.push(C),u&&a.push.apply(a,C.getChildren(!0,d,_)))),C=C._next;return a},n.getById=function(u){for(var d=this.getChildren(1,1,1),_=d.length;_--;)if(d[_].vars.id===u)return d[_]},n.remove=function(u){return us(u)?this.removeLabel(u):mo(u)?this.killTweensOf(u):(NA(this,u),u===this._recent&&(this._recent=this._last),Yp(this))},n.totalTime=function(u,d){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ss(ja.time-(this._ts>0?u/this._ts:(this.totalDuration()-u)/-this._ts))),t.prototype.totalTime.call(this,u,d),this._forcing=0,this):this._tTime},n.addLabel=function(u,d){return this.labels[u]=vl(this,d),this},n.removeLabel=function(u){return delete this.labels[u],this},n.addPause=function(u,d,_){var v=Fo.delayedCall(0,d||C1,_);return v.data="isPause",this._hasPause=1,nu(this,v,vl(this,u))},n.removePause=function(u){var d=this._first;for(u=vl(this,u);d;)d._start===u&&d.data==="isPause"&&lf(d),d=d._next},n.killTweensOf=function(u,d,_){for(var v=this.getTweensOf(u,_),a=v.length;a--;)zd!==v[a]&&v[a].kill(u,d);return this},n.getTweensOf=function(u,d){for(var _=[],v=Ml(u),a=this._first,C=vh(d),A;a;)a instanceof Fo?Bve(a._targets,v)&&(C?(!zd||a._initted&&a._ts)&&a.globalTime(0)<=d&&a.globalTime(a.totalDuration())>d:!d||a.isActive())&&_.push(a):(A=a.getTweensOf(v,d)).length&&_.push.apply(_,A),a=a._next;return _},n.tweenTo=function(u,d){d=d||{};var _=this,v=vl(_,u),a=d,C=a.startAt,A=a.onStart,k=a.onStartParams,O=a.immediateRender,R,z=Fo.to(_,Ll({ease:d.ease||"none",lazy:!1,immediateRender:!1,time:v,overwrite:"auto",duration:d.duration||Math.abs((v-(C&&"time"in C?C.time:_._time))/_.timeScale())||Oi,onStart:function(){if(_.pause(),!R){var K=d.duration||Math.abs((v-(C&&"time"in C?C.time:_._time))/_.timeScale());z._dur!==K&&f_(z,K,0,1).render(z._time,!0,!0),R=1}A&&A.apply(z,k||[])}},d));return O?z.render(0):z},n.tweenFromTo=function(u,d,_){return this.tweenTo(d,Ll({startAt:{time:vl(this,u)}},_))},n.recent=function(){return this._recent},n.nextLabel=function(u){return u===void 0&&(u=this._time),c9(this,vl(this,u))},n.previousLabel=function(u){return u===void 0&&(u=this._time),c9(this,vl(this,u),1)},n.currentLabel=function(u){return arguments.length?this.seek(u,!0):this.previousLabel(this._time+Oi)},n.shiftChildren=function(u,d,_){_===void 0&&(_=0);for(var v=this._first,a=this.labels,C;v;)v._start>=_&&(v._start+=u,v._end+=u),v=v._next;if(d)for(C in a)a[C]>=_&&(a[C]+=u);return Yp(this)},n.invalidate=function(u){var d=this._first;for(this._lock=0;d;)d.invalidate(u),d=d._next;return t.prototype.invalidate.call(this,u)},n.clear=function(u){u===void 0&&(u=!0);for(var d=this._first,_;d;)_=d._next,this.remove(d),d=_;return this._dp&&(this._time=this._tTime=this._pTime=0),u&&(this.labels={}),Yp(this)},n.totalDuration=function(u){var d=0,_=this,v=_._last,a=Il,C,A,k;if(arguments.length)return _.timeScale((_._repeat<0?_.duration():_.totalDuration())/(_.reversed()?-u:u));if(_._dirty){for(k=_.parent;v;)C=v._prev,v._dirty&&v.totalDuration(),A=v._start,A>a&&_._sort&&v._ts&&!_._lock?(_._lock=1,nu(_,v,A-v._delay,1)._lock=0):a=A,A<0&&v._ts&&(d-=A,(!k&&!_._dp||k&&k.smoothChildTiming)&&(_._start+=A/_._ts,_._time-=A,_._tTime-=A),_.shiftChildren(-A,!1,-1/0),a=0),v._end>d&&v._ts&&(d=v._end),v=C;f_(_,_===no&&_._time>d?_._time:d,1,1),_._dirty=0}return _._tDur},e.updateRoot=function(u){if(no._ts&&(oq(no,jS(u,no)),nq=ja.frame),ja.frame>=o9){o9+=Xa.autoSleep||120;var d=no._first;if((!d||!d._ts)&&Xa.autoSleep&&ja._listeners.length<2){for(;d&&!d._ts;)d=d._next;d||ja.sleep()}}},e}(T1);Ll(Js.prototype,{_lock:0,_hasPause:0,_forcing:0});var oxe=function(e,n,o,u,d,_,v){var a=new ba(this._pt,e,n,0,1,Dq,null,d),C=0,A=0,k,O,R,z,N,K,q,j;for(a.b=o,a.e=u,o+="",u+="",(q=~u.indexOf("random("))&&(u=E1(u)),_&&(j=[o,u],_(j,e,n),o=j[0],u=j[1]),O=o.match(rR)||[];k=rR.exec(u);)z=k[0],N=u.substring(C,k.index),R?R=(R+1)%5:N.substr(-5)==="rgba("&&(R=1),z!==O[A++]&&(K=parseFloat(O[A-1])||0,a._pt={_next:a._pt,p:N||A===1?N:",",s:K,c:z.charAt(1)==="="?Bg(K,z)-K:parseFloat(z)-K,m:R&&R<4?Math.round:0},C=rR.lastIndex);return a.c=C<u.length?u.substring(C,u.length):"",a.fp=v,(QW.test(u)||q)&&(a.e=0),this._pt=a,a},A5=function(e,n,o,u,d,_,v,a,C,A){mo(u)&&(u=u(d||0,e,_));var k=e[n],O=o!=="get"?o:mo(k)?C?e[n.indexOf("set")||!mo(e["get"+n.substr(3)])?n:"get"+n.substr(3)](C):e[n]():k,R=mo(k)?C?uxe:Rq:M5,z;if(us(u)&&(~u.indexOf("random(")&&(u=E1(u)),u.charAt(1)==="="&&(z=Bg(O,u)+($s(O)||0),(z||z===0)&&(u=z))),!A||O!==u||b4)return!isNaN(O*u)&&u!==""?(z=new ba(this._pt,e,n,+O||0,u-(O||0),typeof k=="boolean"?dxe:kq,0,R),C&&(z.fp=C),v&&z.modifier(v,this,e),this._pt=z):(!k&&!(n in e)&&C5(n,u),oxe.call(this,e,n,O,u,R,a||Xa.stringFilter,C))},sxe=function(e,n,o,u,d){if(mo(e)&&(e=zx(e,d,n,o,u)),!mu(e)||e.style&&e.nodeType||Vs(e)||ZW(e))return us(e)?zx(e,d,n,o,u):e;var _={},v;for(v in e)_[v]=zx(e[v],d,n,o,u);return _},Iq=function(e,n,o,u,d,_){var v,a,C,A;if(Ua[e]&&(v=new Ua[e]).init(d,v.rawVars?n[e]:sxe(n[e],u,d,_,o),o,u,_)!==!1&&(o._pt=a=new ba(o._pt,d,e,0,1,v.render,v,0,v.priority),o!==Cg))for(C=o._ptLookup[o._targets.indexOf(d)],A=v._props.length;A--;)C[v._props[A]]=a;return v},zd,b4,I5=function t(e,n,o){var u=e.vars,d=u.ease,_=u.startAt,v=u.immediateRender,a=u.lazy,C=u.onUpdate,A=u.runBackwards,k=u.yoyoEase,O=u.keyframes,R=u.autoRevert,z=e._dur,N=e._startAt,K=e._targets,q=e.parent,j=q&&q.data==="nested"?q.vars.targets:K,H=e._overwrite==="auto"&&!v5,Y=e.timeline,te,J,ae,de,Me,Ce,Ae,Ne,Re,Ye,ht,ft,et;if(Y&&(!O||!d)&&(d="none"),e._ease=Zp(d,h_.ease),e._yEase=k?Eq(Zp(k===!0?d:k,h_.ease)):0,k&&e._yoyo&&!e._repeat&&(k=e._yEase,e._yEase=e._ease,e._ease=k),e._from=!Y&&!!u.runBackwards,!Y||O&&!u.stagger){if(Ne=K[0]?Kp(K[0]).harness:0,ft=Ne&&u[Ne.prop],te=$S(u,E5),N&&(N._zTime<0&&N.progress(1),n<0&&A&&v&&!R?N.render(-1,!0):N.revert(A&&z?TE:Ove),N._lazy=0),_){if(lf(e._startAt=Fo.set(K,Ll({data:"isStart",overwrite:!1,parent:q,immediateRender:!0,lazy:!N&&va(a),startAt:null,delay:0,onUpdate:C&&function(){return Wa(e,"onUpdate")},stagger:0},_))),e._startAt._dp=0,e._startAt._sat=e,n<0&&(js||!v&&!R)&&e._startAt.revert(TE),v&&z&&n<=0&&o<=0){n&&(e._zTime=n);return}}else if(A&&z&&!N){if(n&&(v=!1),ae=Ll({overwrite:!1,data:"isFromStart",lazy:v&&!N&&va(a),immediateRender:v,stagger:0,parent:q},te),ft&&(ae[Ne.prop]=ft),lf(e._startAt=Fo.set(K,ae)),e._startAt._dp=0,e._startAt._sat=e,n<0&&(js?e._startAt.revert(TE):e._startAt.render(-1,!0)),e._zTime=n,!v)t(e._startAt,Oi,Oi);else if(!n)return}for(e._pt=e._ptCache=0,a=z&&va(a)||a&&!z,J=0;J<K.length;J++){if(Me=K[J],Ae=Me._gsap||T5(K)[J]._gsap,e._ptLookup[J]=Ye={},m4[Ae.id]&&Xd.length&&US(),ht=j===K?J:j.indexOf(Me),Ne&&(Re=new Ne).init(Me,ft||te,e,ht,j)!==!1&&(e._pt=de=new ba(e._pt,Me,Re.name,0,1,Re.render,Re,0,Re.priority),Re._props.forEach(function(Xe){Ye[Xe]=de}),Re.priority&&(Ce=1)),!Ne||ft)for(ae in te)Ua[ae]&&(Re=Iq(ae,te,e,ht,Me,j))?Re.priority&&(Ce=1):Ye[ae]=de=A5.call(e,Me,ae,"get",te[ae],ht,j,0,u.stringFilter);e._op&&e._op[J]&&e.kill(Me,e._op[J]),H&&e._pt&&(zd=e,no.killTweensOf(Me,Ye,e.globalTime(n)),et=!e.parent,zd=0),e._pt&&a&&(m4[Ae.id]=1)}Ce&&Oq(e),e._onInit&&e._onInit(e)}e._onUpdate=C,e._initted=(!e._op||e._pt)&&!et,O&&n<=0&&Y.render(Il,!0,!0)},axe=function(e,n,o,u,d,_,v,a){var C=(e._pt&&e._ptCache||(e._ptCache={}))[n],A,k,O,R;if(!C)for(C=e._ptCache[n]=[],O=e._ptLookup,R=e._targets.length;R--;){if(A=O[R][n],A&&A.d&&A.d._pt)for(A=A.d._pt;A&&A.p!==n&&A.fp!==n;)A=A._next;if(!A)return b4=1,e.vars[n]="+=0",I5(e,v),b4=0,a?w1(n+" not eligible for reset"):1;C.push(A)}for(R=C.length;R--;)k=C[R],A=k._pt||k,A.s=(u||u===0)&&!d?u:A.s+(u||0)+_*A.c,A.c=o-A.s,k.e&&(k.e=bo(o)+$s(k.e)),k.b&&(k.b=A.s+$s(k.b))},lxe=function(e,n){var o=e[0]?Kp(e[0]).harness:0,u=o&&o.aliases,d,_,v,a;if(!u)return n;d=um({},n);for(_ in u)if(_ in d)for(a=u[_].split(","),v=a.length;v--;)d[a[v]]=d[_];return d},cxe=function(e,n,o,u){var d=n.ease||u||"power1.inOut",_,v;if(Vs(n))v=o[e]||(o[e]=[]),n.forEach(function(a,C){return v.push({t:C/(n.length-1)*100,v:a,e:d})});else for(_ in n)v=o[_]||(o[_]=[]),_==="ease"||v.push({t:parseFloat(e),v:n[_],e:d})},zx=function(e,n,o,u,d){return mo(e)?e.call(n,o,u,d):us(e)&&~e.indexOf("random(")?E1(e):e},Mq=S5+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Pq={};xa(Mq+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return Pq[t]=1});var Fo=function(t){KW(e,t);function e(o,u,d,_){var v;typeof u=="number"&&(d.duration=u,u=d,d=null),v=t.call(this,_?u:Bx(u))||this;var a=v.vars,C=a.duration,A=a.delay,k=a.immediateRender,O=a.stagger,R=a.overwrite,z=a.keyframes,N=a.defaults,K=a.scrollTrigger,q=a.yoyoEase,j=u.parent||no,H=(Vs(o)||ZW(o)?vh(o[0]):"length"in u)?[o]:Ml(o),Y,te,J,ae,de,Me,Ce,Ae;if(v._targets=H.length?T5(H):w1("GSAP target "+o+" not found. https://gsap.com",!Xa.nullTargetWarn)||[],v._ptLookup=[],v._overwrite=R,z||O||NC(C)||NC(A)){if(u=v.vars,Y=v.timeline=new Js({data:"nested",defaults:N||{},targets:j&&j.data==="nested"?j.vars.targets:H}),Y.kill(),Y.parent=Y._dp=Qu(v),Y._start=0,O||NC(C)||NC(A)){if(ae=H.length,Ce=O&&pq(O),mu(O))for(de in O)~Mq.indexOf(de)&&(Ae||(Ae={}),Ae[de]=O[de]);for(te=0;te<ae;te++)J=$S(u,Pq),J.stagger=0,q&&(J.yoyoEase=q),Ae&&um(J,Ae),Me=H[te],J.duration=+zx(C,Qu(v),te,Me,H),J.delay=(+zx(A,Qu(v),te,Me,H)||0)-v._delay,!O&&ae===1&&J.delay&&(v._delay=A=J.delay,v._start+=A,J.delay=0),Y.to(Me,J,Ce?Ce(te,Me,H):0),Y._ease=Kn.none;Y.duration()?C=A=0:v.timeline=0}else if(z){Bx(Ll(Y.vars.defaults,{ease:"none"})),Y._ease=Zp(z.ease||u.ease||"none");var Ne=0,Re,Ye,ht;if(Vs(z))z.forEach(function(ft){return Y.to(H,ft,">")}),Y.duration();else{J={};for(de in z)de==="ease"||de==="easeEach"||cxe(de,z[de],J,z.easeEach);for(de in J)for(Re=J[de].sort(function(ft,et){return ft.t-et.t}),Ne=0,te=0;te<Re.length;te++)Ye=Re[te],ht={ease:Ye.e,duration:(Ye.t-(te?Re[te-1].t:0))/100*C},ht[de]=Ye.v,Y.to(H,ht,Ne),Ne+=ht.duration;Y.duration()<C&&Y.to({},{duration:C-Y.duration()})}}C||v.duration(C=Y.duration())}else v.timeline=0;return R===!0&&!v5&&(zd=Qu(v),no.killTweensOf(H),zd=0),nu(j,Qu(v),d),u.reversed&&v.reverse(),u.paused&&v.paused(!0),(k||!C&&!z&&v._start===ss(j._time)&&va(k)&&Uve(Qu(v))&&j.data!=="nested")&&(v._tTime=-Oi,v.render(Math.max(0,-A)||0)),K&&uq(Qu(v),K),v}var n=e.prototype;return n.render=function(u,d,_){var v=this._time,a=this._tDur,C=this._dur,A=u<0,k=u>a-Oi&&!A?a:u<Oi?0:u,O,R,z,N,K,q,j,H,Y;if(!C)jve(this,u,d,_);else if(k!==this._tTime||!u||_||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==A){if(O=k,H=this.timeline,this._repeat){if(N=C+this._rDelay,this._repeat<-1&&A)return this.totalTime(N*100+u,d,_);if(O=ss(k%N),k===a?(z=this._repeat,O=C):(z=~~(k/N),z&&z===ss(k/N)&&(O=C,z--),O>C&&(O=C)),q=this._yoyo&&z&1,q&&(Y=this._yEase,O=C-O),K=d_(this._tTime,N),O===v&&!_&&this._initted&&z===K)return this._tTime=k,this;z!==K&&(H&&this._yEase&&Sq(H,q),this.vars.repeatRefresh&&!q&&!this._lock&&this._time!==N&&this._initted&&(this._lock=_=1,this.render(ss(N*z),!0).invalidate()._lock=0))}if(!this._initted){if(hq(this,A?u:O,_,d,k))return this._tTime=0,this;if(v!==this._time&&!(_&&this.vars.repeatRefresh&&z!==K))return this;if(C!==this._dur)return this.render(u,d,_)}if(this._tTime=k,this._time=O,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=j=(Y||this._ease)(O/C),this._from&&(this.ratio=j=1-j),O&&!v&&!d&&!z&&(Wa(this,"onStart"),this._tTime!==k))return this;for(R=this._pt;R;)R.r(j,R.d),R=R._next;H&&H.render(u<0?u:H._dur*H._ease(O/this._dur),d,_)||this._startAt&&(this._zTime=u),this._onUpdate&&!d&&(A&&g4(this,u,d,_),Wa(this,"onUpdate")),this._repeat&&z!==K&&this.vars.onRepeat&&!d&&this.parent&&Wa(this,"onRepeat"),(k===this._tDur||!k)&&this._tTime===k&&(A&&!this._onUpdate&&g4(this,u,!0,!0),(u||!C)&&(k===this._tDur&&this._ts>0||!k&&this._ts<0)&&lf(this,1),!d&&!(A&&!v)&&(k||v||q)&&(Wa(this,k===a?"onComplete":"onReverseComplete",!0),this._prom&&!(k<a&&this.timeScale()>0)&&this._prom()))}return this},n.targets=function(){return this._targets},n.invalidate=function(u){return(!u||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(u),t.prototype.invalidate.call(this,u)},n.resetTo=function(u,d,_,v,a){S1||ja.wake(),this._ts||this.play();var C=Math.min(this._dur,(this._dp._time-this._start)*this._ts),A;return this._initted||I5(this,C),A=this._ease(C/this._dur),axe(this,u,d,_,v,A,C,a)?this.resetTo(u,d,_,v,1):($A(this,0),this.parent||lq(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(u,d){if(d===void 0&&(d="all"),!u&&(!d||d==="all"))return this._lazy=this._pt=0,this.parent?px(this):this;if(this.timeline){var _=this.timeline.totalDuration();return this.timeline.killTweensOf(u,d,zd&&zd.vars.overwrite!==!0)._first||px(this),this.parent&&_!==this.timeline.totalDuration()&&f_(this,this._dur*this.timeline._tDur/_,0,1),this}var v=this._targets,a=u?Ml(u):v,C=this._ptLookup,A=this._pt,k,O,R,z,N,K,q;if((!d||d==="all")&&zve(v,a))return d==="all"&&(this._pt=0),px(this);for(k=this._op=this._op||[],d!=="all"&&(us(d)&&(N={},xa(d,function(j){return N[j]=1}),d=N),d=lxe(v,d)),q=v.length;q--;)if(~a.indexOf(v[q])){O=C[q],d==="all"?(k[q]=d,z=O,R={}):(R=k[q]=k[q]||{},z=d);for(N in z)K=O&&O[N],K&&((!("kill"in K.d)||K.d.kill(N)===!0)&&NA(this,K,"_pt"),delete O[N]),R!=="all"&&(R[N]=1)}return this._initted&&!this._pt&&A&&px(this),this},e.to=function(u,d){return new e(u,d,arguments[2])},e.from=function(u,d){return Fx(1,arguments)},e.delayedCall=function(u,d,_,v){return new e(d,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:u,onComplete:d,onReverseComplete:d,onCompleteParams:_,onReverseCompleteParams:_,callbackScope:v})},e.fromTo=function(u,d,_){return Fx(2,arguments)},e.set=function(u,d){return d.duration=0,d.repeatDelay||(d.repeat=0),new e(u,d)},e.killTweensOf=function(u,d,_){return no.killTweensOf(u,d,_)},e}(T1);Ll(Fo.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});xa("staggerTo,staggerFrom,staggerFromTo",function(t){Fo[t]=function(){var e=new Js,n=y4.call(arguments,0);return n.splice(t==="staggerFromTo"?5:4,0,0),e[t].apply(e,n)}});var M5=function(e,n,o){return e[n]=o},Rq=function(e,n,o){return e[n](o)},uxe=function(e,n,o,u){return e[n](u.fp,o)},hxe=function(e,n,o){return e.setAttribute(n,o)},P5=function(e,n){return mo(e[n])?Rq:x5(e[n])&&e.setAttribute?hxe:M5},kq=function(e,n){return n.set(n.t,n.p,Math.round((n.s+n.c*e)*1e6)/1e6,n)},dxe=function(e,n){return n.set(n.t,n.p,!!(n.s+n.c*e),n)},Dq=function(e,n){var o=n._pt,u="";if(!e&&n.b)u=n.b;else if(e===1&&n.e)u=n.e;else{for(;o;)u=o.p+(o.m?o.m(o.s+o.c*e):Math.round((o.s+o.c*e)*1e4)/1e4)+u,o=o._next;u+=n.c}n.set(n.t,n.p,u,n)},R5=function(e,n){for(var o=n._pt;o;)o.r(e,o.d),o=o._next},fxe=function(e,n,o,u){for(var d=this._pt,_;d;)_=d._next,d.p===u&&d.modifier(e,n,o),d=_},pxe=function(e){for(var n=this._pt,o,u;n;)u=n._next,n.p===e&&!n.op||n.op===e?NA(this,n,"_pt"):n.dep||(o=1),n=u;return!o},mxe=function(e,n,o,u){u.mSet(e,n,u.m.call(u.tween,o,u.mt),u)},Oq=function(e){for(var n=e._pt,o,u,d,_;n;){for(o=n._next,u=d;u&&u.pr>n.pr;)u=u._next;(n._prev=u?u._prev:_)?n._prev._next=n:d=n,(n._next=u)?u._prev=n:_=n,n=o}e._pt=d},ba=function(){function t(n,o,u,d,_,v,a,C,A){this.t=o,this.s=d,this.c=_,this.p=u,this.r=v||kq,this.d=a||this,this.set=C||M5,this.pr=A||0,this._next=n,n&&(n._prev=this)}var e=t.prototype;return e.modifier=function(o,u,d){this.mSet=this.mSet||this.set,this.set=mxe,this.m=o,this.mt=d,this.tween=u},t}();xa(S5+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return E5[t]=1});tl.TweenMax=tl.TweenLite=Fo;tl.TimelineLite=tl.TimelineMax=Js;no=new Js({sortChildren:!1,defaults:h_,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Xa.stringFilter=Cq;var Xp=[],IE={},gxe=[],h9=0,_xe=0,aR=function(e){return(IE[e]||gxe).map(function(n){return n()})},w4=function(){var e=Date.now(),n=[];e-h9>2&&(aR("matchMediaInit"),Xp.forEach(function(o){var u=o.queries,d=o.conditions,_,v,a,C;for(v in u)_=Zc.matchMedia(u[v]).matches,_&&(a=1),_!==d[v]&&(d[v]=_,C=1);C&&(o.revert(),a&&n.push(o))}),aR("matchMediaRevert"),n.forEach(function(o){return o.onMatch(o,function(u){return o.add(null,u)})}),h9=e,aR("matchMedia"))},Lq=function(){function t(n,o){this.selector=o&&v4(o),this.data=[],this._r=[],this.isReverted=!1,this.id=_xe++,n&&this.add(n)}var e=t.prototype;return e.add=function(o,u,d){mo(o)&&(d=u,u=o,o=mo);var _=this,v=function(){var C=qi,A=_.selector,k;return C&&C!==_&&C.data.push(_),d&&(_.selector=v4(d)),qi=_,k=u.apply(_,arguments),mo(k)&&_._r.push(k),qi=C,_.selector=A,_.isReverted=!1,k};return _.last=v,o===mo?v(_,function(a){return _.add(null,a)}):o?_[o]=v:v},e.ignore=function(o){var u=qi;qi=null,o(this),qi=u},e.getTweens=function(){var o=[];return this.data.forEach(function(u){return u instanceof t?o.push.apply(o,u.getTweens()):u instanceof Fo&&!(u.parent&&u.parent.data==="nested")&&o.push(u)}),o},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(o,u){var d=this;if(o?function(){for(var v=d.getTweens(),a=d.data.length,C;a--;)C=d.data[a],C.data==="isFlip"&&(C.revert(),C.getChildren(!0,!0,!1).forEach(function(A){return v.splice(v.indexOf(A),1)}));for(v.map(function(A){return{g:A._dur||A._delay||A._sat&&!A._sat.vars.immediateRender?A.globalTime(0):-1/0,t:A}}).sort(function(A,k){return k.g-A.g||-1/0}).forEach(function(A){return A.t.revert(o)}),a=d.data.length;a--;)C=d.data[a],C instanceof Js?C.data!=="nested"&&(C.scrollTrigger&&C.scrollTrigger.revert(),C.kill()):!(C instanceof Fo)&&C.revert&&C.revert(o);d._r.forEach(function(A){return A(o,d)}),d.isReverted=!0}():this.data.forEach(function(v){return v.kill&&v.kill()}),this.clear(),u)for(var _=Xp.length;_--;)Xp[_].id===this.id&&Xp.splice(_,1)},e.revert=function(o){this.kill(o||{})},t}(),yxe=function(){function t(n){this.contexts=[],this.scope=n,qi&&qi.data.push(this)}var e=t.prototype;return e.add=function(o,u,d){mu(o)||(o={matches:o});var _=new Lq(0,d||this.scope),v=_.conditions={},a,C,A;qi&&!_.selector&&(_.selector=qi.selector),this.contexts.push(_),u=_.add("onMatch",u),_.queries=o;for(C in o)C==="all"?A=1:(a=Zc.matchMedia(o[C]),a&&(Xp.indexOf(_)<0&&Xp.push(_),(v[C]=a.matches)&&(A=1),a.addListener?a.addListener(w4):a.addEventListener("change",w4)));return A&&u(_,function(k){return _.add(null,k)}),this},e.revert=function(o){this.kill(o||{})},e.kill=function(o){this.contexts.forEach(function(u){return u.kill(o,!0)})},t}(),VS={registerPlugin:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];n.forEach(function(u){return xq(u)})},timeline:function(e){return new Js(e)},getTweensOf:function(e,n){return no.getTweensOf(e,n)},getProperty:function(e,n,o,u){us(e)&&(e=Ml(e)[0]);var d=Kp(e||{}).get,_=o?aq:sq;return o==="native"&&(o=""),e&&(n?_((Ua[n]&&Ua[n].get||d)(e,n,o,u)):function(v,a,C){return _((Ua[v]&&Ua[v].get||d)(e,v,a,C))})},quickSetter:function(e,n,o){if(e=Ml(e),e.length>1){var u=e.map(function(A){return Sa.quickSetter(A,n,o)}),d=u.length;return function(A){for(var k=d;k--;)u[k](A)}}e=e[0]||{};var _=Ua[n],v=Kp(e),a=v.harness&&(v.harness.aliases||{})[n]||n,C=_?function(A){var k=new _;Cg._pt=0,k.init(e,o?A+o:A,Cg,0,[e]),k.render(1,k),Cg._pt&&R5(1,Cg)}:v.set(e,a);return _?C:function(A){return C(e,a,o?A+o:A,v,1)}},quickTo:function(e,n,o){var u,d=Sa.to(e,um((u={},u[n]="+=0.1",u.paused=!0,u),o||{})),_=function(a,C,A){return d.resetTo(n,a,C,A)};return _.tween=d,_},isTweening:function(e){return no.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Zp(e.ease,h_.ease)),s9(h_,e||{})},config:function(e){return s9(Xa,e||{})},registerEffect:function(e){var n=e.name,o=e.effect,u=e.plugins,d=e.defaults,_=e.extendTimeline;(u||"").split(",").forEach(function(v){return v&&!Ua[v]&&!tl[v]&&w1(n+" effect requires "+v+" plugin.")}),nR[n]=function(v,a,C){return o(Ml(v),Ll(a||{},d),C)},_&&(Js.prototype[n]=function(v,a,C){return this.add(nR[n](v,mu(a)?a:(C=a)&&{},this),C)})},registerEase:function(e,n){Kn[e]=Zp(n)},parseEase:function(e,n){return arguments.length?Zp(e,n):Kn},getById:function(e){return no.getById(e)},exportRoot:function(e,n){e===void 0&&(e={});var o=new Js(e),u,d;for(o.smoothChildTiming=va(e.smoothChildTiming),no.remove(o),o._dp=0,o._time=o._tTime=no._time,u=no._first;u;)d=u._next,(n||!(!u._dur&&u instanceof Fo&&u.vars.onComplete===u._targets[0]))&&nu(o,u,u._start-u._delay),u=d;return nu(no,o,0),o},context:function(e,n){return e?new Lq(e,n):qi},matchMedia:function(e){return new yxe(e)},matchMediaRefresh:function(){return Xp.forEach(function(e){var n=e.conditions,o,u;for(u in n)n[u]&&(n[u]=!1,o=1);o&&e.revert()})||w4()},addEventListener:function(e,n){var o=IE[e]||(IE[e]=[]);~o.indexOf(n)||o.push(n)},removeEventListener:function(e,n){var o=IE[e],u=o&&o.indexOf(n);u>=0&&o.splice(u,1)},utils:{wrap:Zve,wrapYoyo:Xve,distribute:pq,random:gq,snap:mq,normalize:Yve,getUnit:$s,clamp:Gve,splitColor:bq,toArray:Ml,selector:v4,mapRange:yq,pipe:qve,unitize:Kve,interpolate:Qve,shuffle:fq},install:tq,effects:nR,ticker:ja,updateRoot:Js.updateRoot,plugins:Ua,globalTimeline:no,core:{PropTween:ba,globals:rq,Tween:Fo,Timeline:Js,Animation:T1,getCache:Kp,_removeLinkedListItem:NA,reverting:function(){return js},context:function(e){return e&&qi&&(qi.data.push(e),e._ctx=qi),qi},suppressOverwrites:function(e){return v5=e}}};xa("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return VS[t]=Fo[t]});ja.add(Js.updateRoot);Cg=VS.to({},{duration:0});var vxe=function(e,n){for(var o=e._pt;o&&o.p!==n&&o.op!==n&&o.fp!==n;)o=o._next;return o},xxe=function(e,n){var o=e._targets,u,d,_;for(u in n)for(d=o.length;d--;)_=e._ptLookup[d][u],_&&(_=_.d)&&(_._pt&&(_=vxe(_,u)),_&&_.modifier&&_.modifier(n[u],e,o[d],u))},lR=function(e,n){return{name:e,rawVars:1,init:function(u,d,_){_._onInit=function(v){var a,C;if(us(d)&&(a={},xa(d,function(A){return a[A]=1}),d=a),n){a={};for(C in d)a[C]=n(d[C]);d=a}xxe(v,d)}}}},Sa=VS.registerPlugin({name:"attr",init:function(e,n,o,u,d){var _,v,a;this.tween=o;for(_ in n)a=e.getAttribute(_)||"",v=this.add(e,"setAttribute",(a||0)+"",n[_],u,d,0,0,_),v.op=_,v.b=a,this._props.push(_)},render:function(e,n){for(var o=n._pt;o;)js?o.set(o.t,o.p,o.b,o):o.r(e,o.d),o=o._next}},{name:"endArray",init:function(e,n){for(var o=n.length;o--;)this.add(e,o,e[o]||0,n[o],0,0,0,0,0,1)}},lR("roundProps",x4),lR("modifiers"),lR("snap",mq))||VS;Fo.version=Js.version=Sa.version="3.12.5";eq=1;b5()&&p_();Kn.Power0;Kn.Power1;Kn.Power2;Kn.Power3;Kn.Power4;Kn.Linear;Kn.Quad;Kn.Cubic;Kn.Quart;Kn.Quint;Kn.Strong;Kn.Elastic;Kn.Back;Kn.SteppedEase;Kn.Bounce;Kn.Sine;Kn.Expo;Kn.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var d9,Nd,Fg,k5,jp,f9,D5,bxe=function(){return typeof window<"u"},xh={},kp=180/Math.PI,zg=Math.PI/180,X0=Math.atan2,p9=1e8,O5=/([A-Z])/g,wxe=/(left|right|width|margin|padding|x)/i,Cxe=/[\s,\(]\S/,su={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},C4=function(e,n){return n.set(n.t,n.p,Math.round((n.s+n.c*e)*1e4)/1e4+n.u,n)},Exe=function(e,n){return n.set(n.t,n.p,e===1?n.e:Math.round((n.s+n.c*e)*1e4)/1e4+n.u,n)},Sxe=function(e,n){return n.set(n.t,n.p,e?Math.round((n.s+n.c*e)*1e4)/1e4+n.u:n.b,n)},Txe=function(e,n){var o=n.s+n.c*e;n.set(n.t,n.p,~~(o+(o<0?-.5:.5))+n.u,n)},Bq=function(e,n){return n.set(n.t,n.p,e?n.e:n.b,n)},Fq=function(e,n){return n.set(n.t,n.p,e!==1?n.b:n.e,n)},Axe=function(e,n,o){return e.style[n]=o},Ixe=function(e,n,o){return e.style.setProperty(n,o)},Mxe=function(e,n,o){return e._gsap[n]=o},Pxe=function(e,n,o){return e._gsap.scaleX=e._gsap.scaleY=o},Rxe=function(e,n,o,u,d){var _=e._gsap;_.scaleX=_.scaleY=o,_.renderTransform(d,_)},kxe=function(e,n,o,u,d){var _=e._gsap;_[n]=o,_.renderTransform(d,_)},io="transform",wa=io+"Origin",Dxe=function t(e,n){var o=this,u=this.target,d=u.style,_=u._gsap;if(e in xh&&d){if(this.tfm=this.tfm||{},e!=="transform")e=su[e]||e,~e.indexOf(",")?e.split(",").forEach(function(v){return o.tfm[v]=th(u,v)}):this.tfm[e]=_.x?_[e]:th(u,e),e===wa&&(this.tfm.zOrigin=_.zOrigin);else return su.transform.split(",").forEach(function(v){return t.call(o,v,n)});if(this.props.indexOf(io)>=0)return;_.svg&&(this.svgo=u.getAttribute("data-svg-origin"),this.props.push(wa,n,"")),e=io}(d||n)&&this.props.push(e,n,d[e])},zq=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Oxe=function(){var e=this.props,n=this.target,o=n.style,u=n._gsap,d,_;for(d=0;d<e.length;d+=3)e[d+1]?n[e[d]]=e[d+2]:e[d+2]?o[e[d]]=e[d+2]:o.removeProperty(e[d].substr(0,2)==="--"?e[d]:e[d].replace(O5,"-$1").toLowerCase());if(this.tfm){for(_ in this.tfm)u[_]=this.tfm[_];u.svg&&(u.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),d=D5(),(!d||!d.isStart)&&!o[io]&&(zq(o),u.zOrigin&&o[wa]&&(o[wa]+=" "+u.zOrigin+"px",u.zOrigin=0,u.renderTransform()),u.uncache=1)}},Nq=function(e,n){var o={target:e,props:[],revert:Oxe,save:Dxe};return e._gsap||Sa.core.getCache(e),n&&n.split(",").forEach(function(u){return o.save(u)}),o},Uq,E4=function(e,n){var o=Nd.createElementNS?Nd.createElementNS((n||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Nd.createElement(e);return o&&o.style?o:Nd.createElement(e)},du=function t(e,n,o){var u=getComputedStyle(e);return u[n]||u.getPropertyValue(n.replace(O5,"-$1").toLowerCase())||u.getPropertyValue(n)||!o&&t(e,m_(n)||n,1)||""},m9="O,Moz,ms,Ms,Webkit".split(","),m_=function(e,n,o){var u=n||jp,d=u.style,_=5;if(e in d&&!o)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);_--&&!(m9[_]+e in d););return _<0?null:(_===3?"ms":_>=0?m9[_]:"")+e},S4=function(){bxe()&&window.document&&(d9=window,Nd=d9.document,Fg=Nd.documentElement,jp=E4("div")||{style:{}},E4("div"),io=m_(io),wa=io+"Origin",jp.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Uq=!!m_("perspective"),D5=Sa.core.reverting,k5=1)},cR=function t(e){var n=E4("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),o=this.parentNode,u=this.nextSibling,d=this.style.cssText,_;if(Fg.appendChild(n),n.appendChild(this),this.style.display="block",e)try{_=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch{}else this._gsapBBox&&(_=this._gsapBBox());return o&&(u?o.insertBefore(this,u):o.appendChild(this)),Fg.removeChild(n),this.style.cssText=d,_},g9=function(e,n){for(var o=n.length;o--;)if(e.hasAttribute(n[o]))return e.getAttribute(n[o])},$q=function(e){var n;try{n=e.getBBox()}catch{n=cR.call(e,!0)}return n&&(n.width||n.height)||e.getBBox===cR||(n=cR.call(e,!0)),n&&!n.width&&!n.x&&!n.y?{x:+g9(e,["x","cx","x1"])||0,y:+g9(e,["y","cy","y1"])||0,width:0,height:0}:n},jq=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&$q(e))},hm=function(e,n){if(n){var o=e.style,u;n in xh&&n!==wa&&(n=io),o.removeProperty?(u=n.substr(0,2),(u==="ms"||n.substr(0,6)==="webkit")&&(n="-"+n),o.removeProperty(u==="--"?n:n.replace(O5,"-$1").toLowerCase())):o.removeAttribute(n)}},Ud=function(e,n,o,u,d,_){var v=new ba(e._pt,n,o,0,1,_?Fq:Bq);return e._pt=v,v.b=u,v.e=d,e._props.push(o),v},_9={deg:1,rad:1,turn:1},Lxe={grid:1,flex:1},cf=function t(e,n,o,u){var d=parseFloat(o)||0,_=(o+"").trim().substr((d+"").length)||"px",v=jp.style,a=wxe.test(n),C=e.tagName.toLowerCase()==="svg",A=(C?"client":"offset")+(a?"Width":"Height"),k=100,O=u==="px",R=u==="%",z,N,K,q;if(u===_||!d||_9[u]||_9[_])return d;if(_!=="px"&&!O&&(d=t(e,n,o,"px")),q=e.getCTM&&jq(e),(R||_==="%")&&(xh[n]||~n.indexOf("adius")))return z=q?e.getBBox()[a?"width":"height"]:e[A],bo(R?d/z*k:d/100*z);if(v[a?"width":"height"]=k+(O?_:u),N=~n.indexOf("adius")||u==="em"&&e.appendChild&&!C?e:e.parentNode,q&&(N=(e.ownerSVGElement||{}).parentNode),(!N||N===Nd||!N.appendChild)&&(N=Nd.body),K=N._gsap,K&&R&&K.width&&a&&K.time===ja.time&&!K.uncache)return bo(d/K.width*k);if(R&&(n==="height"||n==="width")){var j=e.style[n];e.style[n]=k+u,z=e[A],j?e.style[n]=j:hm(e,n)}else(R||_==="%")&&!Lxe[du(N,"display")]&&(v.position=du(e,"position")),N===e&&(v.position="static"),N.appendChild(jp),z=jp[A],N.removeChild(jp),v.position="absolute";return a&&R&&(K=Kp(N),K.time=ja.time,K.width=N[A]),bo(O?z*d/k:z&&d?k/z*d:0)},th=function(e,n,o,u){var d;return k5||S4(),n in su&&n!=="transform"&&(n=su[n],~n.indexOf(",")&&(n=n.split(",")[0])),xh[n]&&n!=="transform"?(d=I1(e,u),d=n!=="transformOrigin"?d[n]:d.svg?d.origin:GS(du(e,wa))+" "+d.zOrigin+"px"):(d=e.style[n],(!d||d==="auto"||u||~(d+"").indexOf("calc("))&&(d=HS[n]&&HS[n](e,n,o)||du(e,n)||iq(e,n)||(n==="opacity"?1:0))),o&&!~(d+"").trim().indexOf(" ")?cf(e,n,d,o)+o:d},Bxe=function(e,n,o,u){if(!o||o==="none"){var d=m_(n,e,1),_=d&&du(e,d,1);_&&_!==o?(n=d,o=_):n==="borderColor"&&(o=du(e,"borderTopColor"))}var v=new ba(this._pt,e.style,n,0,1,Dq),a=0,C=0,A,k,O,R,z,N,K,q,j,H,Y,te;if(v.b=o,v.e=u,o+="",u+="",u==="auto"&&(N=e.style[n],e.style[n]=u,u=du(e,n)||u,N?e.style[n]=N:hm(e,n)),A=[o,u],Cq(A),o=A[0],u=A[1],O=o.match(wg)||[],te=u.match(wg)||[],te.length){for(;k=wg.exec(u);)K=k[0],j=u.substring(a,k.index),z?z=(z+1)%5:(j.substr(-5)==="rgba("||j.substr(-5)==="hsla(")&&(z=1),K!==(N=O[C++]||"")&&(R=parseFloat(N)||0,Y=N.substr((R+"").length),K.charAt(1)==="="&&(K=Bg(R,K)+Y),q=parseFloat(K),H=K.substr((q+"").length),a=wg.lastIndex-H.length,H||(H=H||Xa.units[n]||Y,a===u.length&&(u+=H,v.e+=H)),Y!==H&&(R=cf(e,n,N,H)||0),v._pt={_next:v._pt,p:j||C===1?j:",",s:R,c:q-R,m:z&&z<4||n==="zIndex"?Math.round:0});v.c=a<u.length?u.substring(a,u.length):""}else v.r=n==="display"&&u==="none"?Fq:Bq;return QW.test(u)&&(v.e=0),this._pt=v,v},y9={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Fxe=function(e){var n=e.split(" "),o=n[0],u=n[1]||"50%";return(o==="top"||o==="bottom"||u==="left"||u==="right")&&(e=o,o=u,u=e),n[0]=y9[o]||o,n[1]=y9[u]||u,n.join(" ")},zxe=function(e,n){if(n.tween&&n.tween._time===n.tween._dur){var o=n.t,u=o.style,d=n.u,_=o._gsap,v,a,C;if(d==="all"||d===!0)u.cssText="",a=1;else for(d=d.split(","),C=d.length;--C>-1;)v=d[C],xh[v]&&(a=1,v=v==="transformOrigin"?wa:io),hm(o,v);a&&(hm(o,io),_&&(_.svg&&o.removeAttribute("transform"),I1(o,1),_.uncache=1,zq(u)))}},HS={clearProps:function(e,n,o,u,d){if(d.data!=="isFromStart"){var _=e._pt=new ba(e._pt,n,o,0,0,zxe);return _.u=u,_.pr=-10,_.tween=d,e._props.push(o),1}}},A1=[1,0,0,1,0,0],Vq={},Hq=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},v9=function(e){var n=du(e,io);return Hq(n)?A1:n.substr(7).match(XW).map(bo)},L5=function(e,n){var o=e._gsap||Kp(e),u=e.style,d=v9(e),_,v,a,C;return o.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,d=[a.a,a.b,a.c,a.d,a.e,a.f],d.join(",")==="1,0,0,1,0,0"?A1:d):(d===A1&&!e.offsetParent&&e!==Fg&&!o.svg&&(a=u.display,u.display="block",_=e.parentNode,(!_||!e.offsetParent)&&(C=1,v=e.nextElementSibling,Fg.appendChild(e)),d=v9(e),a?u.display=a:hm(e,"display"),C&&(v?_.insertBefore(e,v):_?_.appendChild(e):Fg.removeChild(e))),n&&d.length>6?[d[0],d[1],d[4],d[5],d[12],d[13]]:d)},T4=function(e,n,o,u,d,_){var v=e._gsap,a=d||L5(e,!0),C=v.xOrigin||0,A=v.yOrigin||0,k=v.xOffset||0,O=v.yOffset||0,R=a[0],z=a[1],N=a[2],K=a[3],q=a[4],j=a[5],H=n.split(" "),Y=parseFloat(H[0])||0,te=parseFloat(H[1])||0,J,ae,de,Me;o?a!==A1&&(ae=R*K-z*N)&&(de=Y*(K/ae)+te*(-N/ae)+(N*j-K*q)/ae,Me=Y*(-z/ae)+te*(R/ae)-(R*j-z*q)/ae,Y=de,te=Me):(J=$q(e),Y=J.x+(~H[0].indexOf("%")?Y/100*J.width:Y),te=J.y+(~(H[1]||H[0]).indexOf("%")?te/100*J.height:te)),u||u!==!1&&v.smooth?(q=Y-C,j=te-A,v.xOffset=k+(q*R+j*N)-q,v.yOffset=O+(q*z+j*K)-j):v.xOffset=v.yOffset=0,v.xOrigin=Y,v.yOrigin=te,v.smooth=!!u,v.origin=n,v.originIsAbsolute=!!o,e.style[wa]="0px 0px",_&&(Ud(_,v,"xOrigin",C,Y),Ud(_,v,"yOrigin",A,te),Ud(_,v,"xOffset",k,v.xOffset),Ud(_,v,"yOffset",O,v.yOffset)),e.setAttribute("data-svg-origin",Y+" "+te)},I1=function(e,n){var o=e._gsap||new Aq(e);if("x"in o&&!n&&!o.uncache)return o;var u=e.style,d=o.scaleX<0,_="px",v="deg",a=getComputedStyle(e),C=du(e,wa)||"0",A,k,O,R,z,N,K,q,j,H,Y,te,J,ae,de,Me,Ce,Ae,Ne,Re,Ye,ht,ft,et,Xe,Mt,Lt,nt,at,it,tt,Jt;return A=k=O=N=K=q=j=H=Y=0,R=z=1,o.svg=!!(e.getCTM&&jq(e)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(u[io]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[io]!=="none"?a[io]:"")),u.scale=u.rotate=u.translate="none"),ae=L5(e,o.svg),o.svg&&(o.uncache?(Xe=e.getBBox(),C=o.xOrigin-Xe.x+"px "+(o.yOrigin-Xe.y)+"px",et=""):et=!n&&e.getAttribute("data-svg-origin"),T4(e,et||C,!!et||o.originIsAbsolute,o.smooth!==!1,ae)),te=o.xOrigin||0,J=o.yOrigin||0,ae!==A1&&(Ae=ae[0],Ne=ae[1],Re=ae[2],Ye=ae[3],A=ht=ae[4],k=ft=ae[5],ae.length===6?(R=Math.sqrt(Ae*Ae+Ne*Ne),z=Math.sqrt(Ye*Ye+Re*Re),N=Ae||Ne?X0(Ne,Ae)*kp:0,j=Re||Ye?X0(Re,Ye)*kp+N:0,j&&(z*=Math.abs(Math.cos(j*zg))),o.svg&&(A-=te-(te*Ae+J*Re),k-=J-(te*Ne+J*Ye))):(Jt=ae[6],it=ae[7],Lt=ae[8],nt=ae[9],at=ae[10],tt=ae[11],A=ae[12],k=ae[13],O=ae[14],de=X0(Jt,at),K=de*kp,de&&(Me=Math.cos(-de),Ce=Math.sin(-de),et=ht*Me+Lt*Ce,Xe=ft*Me+nt*Ce,Mt=Jt*Me+at*Ce,Lt=ht*-Ce+Lt*Me,nt=ft*-Ce+nt*Me,at=Jt*-Ce+at*Me,tt=it*-Ce+tt*Me,ht=et,ft=Xe,Jt=Mt),de=X0(-Re,at),q=de*kp,de&&(Me=Math.cos(-de),Ce=Math.sin(-de),et=Ae*Me-Lt*Ce,Xe=Ne*Me-nt*Ce,Mt=Re*Me-at*Ce,tt=Ye*Ce+tt*Me,Ae=et,Ne=Xe,Re=Mt),de=X0(Ne,Ae),N=de*kp,de&&(Me=Math.cos(de),Ce=Math.sin(de),et=Ae*Me+Ne*Ce,Xe=ht*Me+ft*Ce,Ne=Ne*Me-Ae*Ce,ft=ft*Me-ht*Ce,Ae=et,ht=Xe),K&&Math.abs(K)+Math.abs(N)>359.9&&(K=N=0,q=180-q),R=bo(Math.sqrt(Ae*Ae+Ne*Ne+Re*Re)),z=bo(Math.sqrt(ft*ft+Jt*Jt)),de=X0(ht,ft),j=Math.abs(de)>2e-4?de*kp:0,Y=tt?1/(tt<0?-tt:tt):0),o.svg&&(et=e.getAttribute("transform"),o.forceCSS=e.setAttribute("transform","")||!Hq(du(e,io)),et&&e.setAttribute("transform",et))),Math.abs(j)>90&&Math.abs(j)<270&&(d?(R*=-1,j+=N<=0?180:-180,N+=N<=0?180:-180):(z*=-1,j+=j<=0?180:-180)),n=n||o.uncache,o.x=A-((o.xPercent=A&&(!n&&o.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-A)?-50:0)))?e.offsetWidth*o.xPercent/100:0)+_,o.y=k-((o.yPercent=k&&(!n&&o.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-k)?-50:0)))?e.offsetHeight*o.yPercent/100:0)+_,o.z=O+_,o.scaleX=bo(R),o.scaleY=bo(z),o.rotation=bo(N)+v,o.rotationX=bo(K)+v,o.rotationY=bo(q)+v,o.skewX=j+v,o.skewY=H+v,o.transformPerspective=Y+_,(o.zOrigin=parseFloat(C.split(" ")[2])||!n&&o.zOrigin||0)&&(u[wa]=GS(C)),o.xOffset=o.yOffset=0,o.force3D=Xa.force3D,o.renderTransform=o.svg?Uxe:Uq?Gq:Nxe,o.uncache=0,o},GS=function(e){return(e=e.split(" "))[0]+" "+e[1]},uR=function(e,n,o){var u=$s(n);return bo(parseFloat(n)+parseFloat(cf(e,"x",o+"px",u)))+u},Nxe=function(e,n){n.z="0px",n.rotationY=n.rotationX="0deg",n.force3D=0,Gq(e,n)},Ep="0deg",tx="0px",Sp=") ",Gq=function(e,n){var o=n||this,u=o.xPercent,d=o.yPercent,_=o.x,v=o.y,a=o.z,C=o.rotation,A=o.rotationY,k=o.rotationX,O=o.skewX,R=o.skewY,z=o.scaleX,N=o.scaleY,K=o.transformPerspective,q=o.force3D,j=o.target,H=o.zOrigin,Y="",te=q==="auto"&&e&&e!==1||q===!0;if(H&&(k!==Ep||A!==Ep)){var J=parseFloat(A)*zg,ae=Math.sin(J),de=Math.cos(J),Me;J=parseFloat(k)*zg,Me=Math.cos(J),_=uR(j,_,ae*Me*-H),v=uR(j,v,-Math.sin(J)*-H),a=uR(j,a,de*Me*-H+H)}K!==tx&&(Y+="perspective("+K+Sp),(u||d)&&(Y+="translate("+u+"%, "+d+"%) "),(te||_!==tx||v!==tx||a!==tx)&&(Y+=a!==tx||te?"translate3d("+_+", "+v+", "+a+") ":"translate("+_+", "+v+Sp),C!==Ep&&(Y+="rotate("+C+Sp),A!==Ep&&(Y+="rotateY("+A+Sp),k!==Ep&&(Y+="rotateX("+k+Sp),(O!==Ep||R!==Ep)&&(Y+="skew("+O+", "+R+Sp),(z!==1||N!==1)&&(Y+="scale("+z+", "+N+Sp),j.style[io]=Y||"translate(0, 0)"},Uxe=function(e,n){var o=n||this,u=o.xPercent,d=o.yPercent,_=o.x,v=o.y,a=o.rotation,C=o.skewX,A=o.skewY,k=o.scaleX,O=o.scaleY,R=o.target,z=o.xOrigin,N=o.yOrigin,K=o.xOffset,q=o.yOffset,j=o.forceCSS,H=parseFloat(_),Y=parseFloat(v),te,J,ae,de,Me;a=parseFloat(a),C=parseFloat(C),A=parseFloat(A),A&&(A=parseFloat(A),C+=A,a+=A),a||C?(a*=zg,C*=zg,te=Math.cos(a)*k,J=Math.sin(a)*k,ae=Math.sin(a-C)*-O,de=Math.cos(a-C)*O,C&&(A*=zg,Me=Math.tan(C-A),Me=Math.sqrt(1+Me*Me),ae*=Me,de*=Me,A&&(Me=Math.tan(A),Me=Math.sqrt(1+Me*Me),te*=Me,J*=Me)),te=bo(te),J=bo(J),ae=bo(ae),de=bo(de)):(te=k,de=O,J=ae=0),(H&&!~(_+"").indexOf("px")||Y&&!~(v+"").indexOf("px"))&&(H=cf(R,"x",_,"px"),Y=cf(R,"y",v,"px")),(z||N||K||q)&&(H=bo(H+z-(z*te+N*ae)+K),Y=bo(Y+N-(z*J+N*de)+q)),(u||d)&&(Me=R.getBBox(),H=bo(H+u/100*Me.width),Y=bo(Y+d/100*Me.height)),Me="matrix("+te+","+J+","+ae+","+de+","+H+","+Y+")",R.setAttribute("transform",Me),j&&(R.style[io]=Me)},$xe=function(e,n,o,u,d){var _=360,v=us(d),a=parseFloat(d)*(v&&~d.indexOf("rad")?kp:1),C=a-u,A=u+C+"deg",k,O;return v&&(k=d.split("_")[1],k==="short"&&(C%=_,C!==C%(_/2)&&(C+=C<0?_:-_)),k==="cw"&&C<0?C=(C+_*p9)%_-~~(C/_)*_:k==="ccw"&&C>0&&(C=(C-_*p9)%_-~~(C/_)*_)),e._pt=O=new ba(e._pt,n,o,u,C,Exe),O.e=A,O.u="deg",e._props.push(o),O},x9=function(e,n){for(var o in n)e[o]=n[o];return e},jxe=function(e,n,o){var u=x9({},o._gsap),d="perspective,force3D,transformOrigin,svgOrigin",_=o.style,v,a,C,A,k,O,R,z;u.svg?(C=o.getAttribute("transform"),o.setAttribute("transform",""),_[io]=n,v=I1(o,1),hm(o,io),o.setAttribute("transform",C)):(C=getComputedStyle(o)[io],_[io]=n,v=I1(o,1),_[io]=C);for(a in xh)C=u[a],A=v[a],C!==A&&d.indexOf(a)<0&&(R=$s(C),z=$s(A),k=R!==z?cf(o,a,C,z):parseFloat(C),O=parseFloat(A),e._pt=new ba(e._pt,v,a,k,O-k,C4),e._pt.u=z||0,e._props.push(a));x9(v,u)};xa("padding,margin,Width,Radius",function(t,e){var n="Top",o="Right",u="Bottom",d="Left",_=(e<3?[n,o,u,d]:[n+d,n+o,u+o,u+d]).map(function(v){return e<2?t+v:"border"+v+t});HS[e>1?"border"+t:t]=function(v,a,C,A,k){var O,R;if(arguments.length<4)return O=_.map(function(z){return th(v,z,C)}),R=O.join(" "),R.split(O[0]).length===5?O[0]:R;O=(A+"").split(" "),R={},_.forEach(function(z,N){return R[z]=O[N]=O[N]||O[(N-1)/2|0]}),v.init(a,R,k)}});var Wq={name:"css",register:S4,targetTest:function(e){return e.style&&e.nodeType},init:function(e,n,o,u,d){var _=this._props,v=e.style,a=o.vars.startAt,C,A,k,O,R,z,N,K,q,j,H,Y,te,J,ae,de;k5||S4(),this.styles=this.styles||Nq(e),de=this.styles.props,this.tween=o;for(N in n)if(N!=="autoRound"&&(A=n[N],!(Ua[N]&&Iq(N,n,o,u,e,d)))){if(R=typeof A,z=HS[N],R==="function"&&(A=A.call(o,u,e,d),R=typeof A),R==="string"&&~A.indexOf("random(")&&(A=E1(A)),z)z(this,e,N,A,o)&&(ae=1);else if(N.substr(0,2)==="--")C=(getComputedStyle(e).getPropertyValue(N)+"").trim(),A+="",Qd.lastIndex=0,Qd.test(C)||(K=$s(C),q=$s(A)),q?K!==q&&(C=cf(e,N,C,q)+q):K&&(A+=K),this.add(v,"setProperty",C,A,u,d,0,0,N),_.push(N),de.push(N,0,v[N]);else if(R!=="undefined"){if(a&&N in a?(C=typeof a[N]=="function"?a[N].call(o,u,e,d):a[N],us(C)&&~C.indexOf("random(")&&(C=E1(C)),$s(C+"")||C==="auto"||(C+=Xa.units[N]||$s(th(e,N))||""),(C+"").charAt(1)==="="&&(C=th(e,N))):C=th(e,N),O=parseFloat(C),j=R==="string"&&A.charAt(1)==="="&&A.substr(0,2),j&&(A=A.substr(2)),k=parseFloat(A),N in su&&(N==="autoAlpha"&&(O===1&&th(e,"visibility")==="hidden"&&k&&(O=0),de.push("visibility",0,v.visibility),Ud(this,v,"visibility",O?"inherit":"hidden",k?"inherit":"hidden",!k)),N!=="scale"&&N!=="transform"&&(N=su[N],~N.indexOf(",")&&(N=N.split(",")[0]))),H=N in xh,H){if(this.styles.save(N),Y||(te=e._gsap,te.renderTransform&&!n.parseTransform||I1(e,n.parseTransform),J=n.smoothOrigin!==!1&&te.smooth,Y=this._pt=new ba(this._pt,v,io,0,1,te.renderTransform,te,0,-1),Y.dep=1),N==="scale")this._pt=new ba(this._pt,te,"scaleY",te.scaleY,(j?Bg(te.scaleY,j+k):k)-te.scaleY||0,C4),this._pt.u=0,_.push("scaleY",N),N+="X";else if(N==="transformOrigin"){de.push(wa,0,v[wa]),A=Fxe(A),te.svg?T4(e,A,0,J,0,this):(q=parseFloat(A.split(" ")[2])||0,q!==te.zOrigin&&Ud(this,te,"zOrigin",te.zOrigin,q),Ud(this,v,N,GS(C),GS(A)));continue}else if(N==="svgOrigin"){T4(e,A,1,J,0,this);continue}else if(N in Vq){$xe(this,te,N,O,j?Bg(O,j+A):A);continue}else if(N==="smoothOrigin"){Ud(this,te,"smooth",te.smooth,A);continue}else if(N==="force3D"){te[N]=A;continue}else if(N==="transform"){jxe(this,A,e);continue}}else N in v||(N=m_(N)||N);if(H||(k||k===0)&&(O||O===0)&&!Cxe.test(A)&&N in v)K=(C+"").substr((O+"").length),k||(k=0),q=$s(A)||(N in Xa.units?Xa.units[N]:K),K!==q&&(O=cf(e,N,C,q)),this._pt=new ba(this._pt,H?te:v,N,O,(j?Bg(O,j+k):k)-O,!H&&(q==="px"||N==="zIndex")&&n.autoRound!==!1?Txe:C4),this._pt.u=q||0,K!==q&&q!=="%"&&(this._pt.b=C,this._pt.r=Sxe);else if(N in v)Bxe.call(this,e,N,C,j?j+A:A);else if(N in e)this.add(e,N,C||e[N],j?j+A:A,u,d);else if(N!=="parseTransform"){C5(N,A);continue}H||(N in v?de.push(N,0,v[N]):de.push(N,1,C||e[N])),_.push(N)}}ae&&Oq(this)},render:function(e,n){if(n.tween._time||!D5())for(var o=n._pt;o;)o.r(e,o.d),o=o._next;else n.styles.revert()},get:th,aliases:su,getSetter:function(e,n,o){var u=su[n];return u&&u.indexOf(",")<0&&(n=u),n in xh&&n!==wa&&(e._gsap.x||th(e,"x"))?o&&f9===o?n==="scale"?Pxe:Mxe:(f9=o||{})&&(n==="scale"?Rxe:kxe):e.style&&!x5(e.style[n])?Axe:~n.indexOf("-")?Ixe:P5(e,n)},core:{_removeProperty:hm,_getMatrix:L5}};Sa.utils.checkPrefix=m_;Sa.core.getStyleSaver=Nq;(function(t,e,n,o){var u=xa(t+","+e+","+n,function(d){xh[d]=1});xa(e,function(d){Xa.units[d]="deg",Vq[d]=1}),su[u[13]]=t+","+e,xa(o,function(d){var _=d.split(":");su[_[1]]=u[_[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");xa("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Xa.units[t]="px"});Sa.registerPlugin(Wq);var g_=Sa.registerPlugin(Wq)||Sa;g_.core.Tween;var Vxe=g_.timeline();function b9(t,e){const{lng:n,lat:o}=t.target.getCenter(),u=t.target.getSource("pickup-zones-clipped-source")._data.geometry;if(u){const d=d5(u,po([n,o])),_=t.target.getSource("nearest-point")._data.geometry.coordinates,v=d.geometry.coordinates;Vxe.clear().to(_,{0:v[0],1:v[1],duration:.25,onUpdate:()=>{t.target.getSource("nearest-point")?.setData(po(_))}}),t.originalEvent&&t.type==="moveend"&&t.target.flyTo({center:d.geometry.coordinates,essential:!0,duration:500})}}function qq(t,e){const n=t._canvas.getBoundingClientRect(),{lng:o,lat:u}=t.unproject([e?.top-n.y,e?.left-n.x]),{lng:d,lat:_}=t.unproject([e?.bottom-n.y,e?.right-n.x]),v=t.unproject([e?.left+e?.width/2-n.x,e?.top+e?.height/2-n.y]),a=ru(po([o,u]),po([d,u]))/2.1,{lng:C,lat:A}=v,k=jW([C,A],a,a,{steps:16}),O=b1(t.getSource("pickup-zones-source")?._data.features.map(R=>R.geometry.coordinates));if(O?.geometry?.coordinates?.length){const R=tW(O,Cs(k));t&&t?.getSource("clipping-ellipse-source")?.setData(k);const z=[];R.geometry.coordinates.forEach(K=>{const q=Es(K);try{CW(q,k)&&z.push(K)}catch{}const j=Es(K);qW(j,k).features.forEach(Y=>{sW(k,Y)&&z.push(Y.geometry.coordinates)})});const N=b1(z);N.geometry.coordinates.length&&t&&t?.getSource("pickup-zones-clipped-source")?.setData(N)}}function hR(t){const{map:e,mapClippingArea:n,forceUpdate:o=!1,maxDistance:u=0}=t??{};if(n&&e){const d=e._canvas.getBoundingClientRect(),_=e.unproject([n?.left+n?.width/2-d.x,n?.top+n?.height/2-d.y]);(o||ru(po([_.lng,_.lat]),po((()=>{const{lng:v,lat:a}=e.getCenter();return[v,a]})()))>u)&&qq(e,n)}}const Hxe="modulepreload",Gxe=function(t){return"/wayfind_pwa/"+t},w9={},B5=function(e,n,o){let u=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),_=d?.nonce||d?.getAttribute("nonce");u=Promise.all(n.map(v=>{if(v=Gxe(v),v in w9)return;w9[v]=!0;const a=v.endsWith(".css"),C=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${C}`))return;const A=document.createElement("link");if(A.rel=a?"stylesheet":Hxe,a||(A.as="script",A.crossOrigin=""),A.href=v,_&&A.setAttribute("nonce",_),document.head.appendChild(A),a)return new Promise((k,O)=>{A.addEventListener("load",k),A.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${v}`)))})}))}return u.then(()=>e()).catch(d=>{const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=d,window.dispatchEvent(_),!_.defaultPrevented)throw d})},Wxe=()=>B5(()=>import("./zoox_zones_sf_reduced-CPL40h23.js"),[]);async function qxe(t){const{lng:e,lat:n}=t.getCenter();t.addSource("center-point",{type:"geojson",data:Ea({type:"Point",coordinates:[e,n]})}),t.addSource("nearest-point",{type:"geojson",data:Ea({type:"Point",coordinates:[e,n]})}),t.addLayer({id:"nearest-point",type:"circle",source:"nearest-point",paint:{"circle-radius":10,"circle-color":"#ffffff","circle-stroke-color":"#000000","circle-stroke-width":3}}),t.addSource("pickup-zones-clipped-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),t.addLayer({id:"pickup-zones-clipped-layer",type:"line",source:"pickup-zones-clipped-source",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#11F0A0","line-width":7,"line-opacity":0,"line-opacity-transition":{duration:200}}}),t.addSource("pickup-zones-source",{type:"geojson",data:JSON.parse(await(await Wxe()).default)}),t.addSource("clipping-ellipse-source",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[]}}})}const Kxe=wi[typeof document<"u"&&document.createElement!==void 0?"useLayoutEffect":"useEffect"],Yxe=t=>{const e=fe.useRef(t);return fe.useEffect(()=>{e.current=t}),e};function Zxe(){}function sh(t,e,n={}){const o=Qxe(n.polyfill),u=Yxe(e);return Kxe(()=>{let d=!1;const _=t&&"current"in t?t.current:t;if(!_)return Zxe;function v(a,C){d||u.current(a,C)}return o.subscribe(_,v),()=>{d=!0,o.unsubscribe(_,v)}},[t,o,u]),o.observer}function Xxe(t){let e=!1,n=[];const o=new Map,u=new(t||window.ResizeObserver)((d,_)=>{n=n.concat(d);function v(){const a=new Set;for(let C=0;C<n.length;C++){if(a.has(n[C].target))continue;a.add(n[C].target);const A=o.get(n[C].target);A?.forEach(k=>k(n[C],_))}n=[],e=!1}e||window.requestAnimationFrame(v),e=!0});return{observer:u,subscribe(d,_){var v;u.observe(d);const a=(v=o.get(d))!==null&&v!==void 0?v:[];a.push(_),o.set(d,a)},unsubscribe(d,_){var v;const a=(v=o.get(d))!==null&&v!==void 0?v:[];if(a.length===1){u.unobserve(d),o.delete(d);return}const C=a.indexOf(_);C!==-1&&a.splice(C,1),o.set(d,a)}}}let dR;const Qxe=t=>dR||(dR=Xxe(t));jH.accessToken="pk.eyJ1IjoiZ2xpbnNjb3R0IiwiYSI6IjM2MzZhNWYzZTcyODcwYzc2ZmE2M2M3N2Y5NTRlMzcxIn0.WxlKZk3Bp928DcmQ-3pwEg";function Jxe({}){const t=fe.useRef(null),e=fe.useRef(null),n=fe.useRef(null),o=fe.useRef(null),u=dK(),d=fe.useRef(),[_,v]=fe.useState(null),a=fe.useRef(null),[C,A]=fe.useState(!1),[k,O]=fe.useState(!1),R=RO(q=>q.bottomDrawer.bottomDrawerRect);function z(){d.current&&(a.current=d.current?.getBoundingClientRect()),e?.current&&v(e?.current?.getBoundingClientRect())}sh(t,z),sh(d,z),sh(e,z),sh(o,z),fe.useEffect(()=>{u==="entered"&&z()},[u]),fe.useEffect(()=>{C&&(k?n.current&&n.current.setPaintProperty("pickup-zones-clipped-layer","line-opacity",.6):n.current&&n.current.setPaintProperty("pickup-zones-clipped-layer","line-opacity",0))},[k,C]);const N=fe.useMemo(()=>C&&n.current&&R?{top:0,left:0,right:0,bottom:Math.max(e.current&&R&&_?_.height-R.top+_.top:0,0)}:{top:0,left:0,right:0,bottom:0},[R,_,C]);fe.useEffect(()=>{C&&n?.current?.setPadding(N)},[N,C]),fe.useEffect(()=>{C&&n.current&&R&&n.current.setPadding(N)},[R,C,N]),fe.useEffect(()=>{z(),!n.current&&K()},[]);function K(){n.current=new jH.Map({container:e.current,style:"mapbox://styles/glinscott/clypome1j03qu01r4c9wk76iw",center:[-122.41140530333949,37.76895201685544],zoom:17}),n.current.on("load",async q=>{n.current&&a.current&&(await qxe(n.current),qq(n.current,a.current),A(!0))}),n.current.on("dragstart",()=>{hR({map:n.current,mapClippingArea:a.current}),O(!0)}),n.current.on("dragend",()=>O(!1)),n.current.on("move",function(q){n.current&&b9(q),hR({map:n.current,mapClippingArea:a.current})}),n.current.on("moveend",function(q){n.current&&(hR({map:n.current,mapClippingArea:a.current}),b9(q))})}return Ke.jsxs(kn,{ref:t,sx:{width:"100%",height:"100%",position:"relative",boxSizing:"border-box"},children:[Ke.jsx(mpe,{ref:e,className:"zoox-map-cont"}),Ke.jsx(kn,{className:"zoox-vis-area",ref:o,sx:{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:N.bottom||0,boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center"},children:Ke.jsx(gpe,{ref:d,visible:k,width:_?.width||0,height:_?.width||0})}),!C&&Ke.jsx(kn,{sx:{width:"100%",height:"100%",position:"absolute",left:0,top:0,background:"#00000080",display:"flex",justifyContent:"center",alignItems:"center"},children:Ke.jsx(Fle,{color:"success"})})]})}const e1e=Hr("div")(({theme:t})=>({margin:"0px",boxSizing:"border-box",width:"100%",height:"100%",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative"})),t1e={bottomDrawerRect:null,bottomDrawerVisibilityState:"closed"},Kq=W1({name:"bottomDrawer",initialState:t1e,reducers:{setBottomDrawerRect(t,e){t.bottomDrawerRect=e.payload},setBottomDrawerVisibilityState(t,e){t.bottomDrawerVisibilityState=e.payload}}}),{setBottomDrawerRect:C9,setBottomDrawerVisibilityState:r1e}=Kq.actions,n1e=Kq.reducer;/*!
 * matrix 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ah,Qp,F5,jA,gx,ME,WS,Nx,gc="transform",A4=gc+"Origin",Yq,Zq=function(e){var n=e.ownerDocument||e;for(!(gc in e.style)&&("msTransform"in e.style)&&(gc="msTransform",A4=gc+"Origin");n.parentNode&&(n=n.parentNode););if(Qp=window,WS=new dm,n){ah=n,F5=n.documentElement,jA=n.body,Nx=ah.createElementNS("http://www.w3.org/2000/svg","g"),Nx.style.transform="none";var o=n.createElement("div"),u=n.createElement("div"),d=n&&(n.body||n.firstElementChild);d&&d.appendChild&&(d.appendChild(o),o.appendChild(u),o.setAttribute("style","position:static;transform:translate3d(0,0,1px)"),Yq=u.offsetParent!==o,d.removeChild(o))}return n},i1e=function(e){for(var n,o;e&&e!==jA;)o=e._gsap,o&&o.uncache&&o.get(e,"x"),o&&!o.scaleX&&!o.scaleY&&o.renderTransform&&(o.scaleX=o.scaleY=1e-4,o.renderTransform(1,o),n?n.push(o):n=[o]),e=e.parentNode;return n},Xq=[],Qq=[],o1e=function(){return Qp.pageYOffset||ah.scrollTop||F5.scrollTop||jA.scrollTop||0},s1e=function(){return Qp.pageXOffset||ah.scrollLeft||F5.scrollLeft||jA.scrollLeft||0},z5=function(e){return e.ownerSVGElement||((e.tagName+"").toLowerCase()==="svg"?e:null)},a1e=function t(e){if(Qp.getComputedStyle(e).position==="fixed")return!0;if(e=e.parentNode,e&&e.nodeType===1)return t(e)},fR=function t(e,n){if(e.parentNode&&(ah||Zq(e))){var o=z5(e),u=o?o.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",d=o?n?"rect":"g":"div",_=n!==2?0:100,v=n===3?100:0,a="position:absolute;display:block;pointer-events:none;margin:0;padding:0;",C=ah.createElementNS?ah.createElementNS(u.replace(/^https/,"http"),d):ah.createElement(d);return n&&(o?(ME||(ME=t(e)),C.setAttribute("width",.01),C.setAttribute("height",.01),C.setAttribute("transform","translate("+_+","+v+")"),ME.appendChild(C)):(gx||(gx=t(e),gx.style.cssText=a),C.style.cssText=a+"width:0.1px;height:0.1px;top:"+v+"px;left:"+_+"px",gx.appendChild(C))),C}throw"Need document and parent."},l1e=function(e){for(var n=new dm,o=0;o<e.numberOfItems;o++)n.multiply(e.getItem(o).matrix);return n},c1e=function(e){var n=e.getCTM(),o;return n||(o=e.style[gc],e.style[gc]="none",e.appendChild(Nx),n=Nx.getCTM(),e.removeChild(Nx),o?e.style[gc]=o:e.style.removeProperty(gc.replace(/([A-Z])/g,"-$1").toLowerCase())),n||WS.clone()},u1e=function(e,n){var o=z5(e),u=e===o,d=o?Xq:Qq,_=e.parentNode,v,a,C,A,k,O;if(e===Qp)return e;if(d.length||d.push(fR(e,1),fR(e,2),fR(e,3)),v=o?ME:gx,o)u?(C=c1e(e),A=-C.e/C.a,k=-C.f/C.d,a=WS):e.getBBox?(C=e.getBBox(),a=e.transform?e.transform.baseVal:{},a=a.numberOfItems?a.numberOfItems>1?l1e(a):a.getItem(0).matrix:WS,A=a.a*C.x+a.c*C.y,k=a.b*C.x+a.d*C.y):(a=new dm,A=k=0),(u?o:_).appendChild(v),v.setAttribute("transform","matrix("+a.a+","+a.b+","+a.c+","+a.d+","+(a.e+A)+","+(a.f+k)+")");else{if(A=k=0,Yq)for(a=e.offsetParent,C=e;C&&(C=C.parentNode)&&C!==a&&C.parentNode;)(Qp.getComputedStyle(C)[gc]+"").length>4&&(A=C.offsetLeft,k=C.offsetTop,C=0);if(O=Qp.getComputedStyle(e),O.position!=="absolute"&&O.position!=="fixed")for(a=e.offsetParent;_&&_!==a;)A+=_.scrollLeft||0,k+=_.scrollTop||0,_=_.parentNode;C=v.style,C.top=e.offsetTop-k+"px",C.left=e.offsetLeft-A+"px",C[gc]=O[gc],C[A4]=O[A4],C.position=O.position==="fixed"?"fixed":"absolute",e.parentNode.appendChild(v)}return v},pR=function(e,n,o,u,d,_,v){return e.a=n,e.b=o,e.c=u,e.d=d,e.e=_,e.f=v,e},dm=function(){function t(n,o,u,d,_,v){n===void 0&&(n=1),o===void 0&&(o=0),u===void 0&&(u=0),d===void 0&&(d=1),_===void 0&&(_=0),v===void 0&&(v=0),pR(this,n,o,u,d,_,v)}var e=t.prototype;return e.inverse=function(){var o=this.a,u=this.b,d=this.c,_=this.d,v=this.e,a=this.f,C=o*_-u*d||1e-10;return pR(this,_/C,-u/C,-d/C,o/C,(d*a-_*v)/C,-(o*a-u*v)/C)},e.multiply=function(o){var u=this.a,d=this.b,_=this.c,v=this.d,a=this.e,C=this.f,A=o.a,k=o.c,O=o.b,R=o.d,z=o.e,N=o.f;return pR(this,A*u+O*_,A*d+O*v,k*u+R*_,k*d+R*v,a+z*u+N*_,C+z*d+N*v)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)},e.equals=function(o){var u=this.a,d=this.b,_=this.c,v=this.d,a=this.e,C=this.f;return u===o.a&&d===o.b&&_===o.c&&v===o.d&&a===o.e&&C===o.f},e.apply=function(o,u){u===void 0&&(u={});var d=o.x,_=o.y,v=this.a,a=this.b,C=this.c,A=this.d,k=this.e,O=this.f;return u.x=d*v+_*C+k||0,u.y=d*a+_*A+O||0,u},t}();function Op(t,e,n,o){if(!t||!t.parentNode||(ah||Zq(t)).documentElement===t)return new dm;var u=i1e(t),d=z5(t),_=d?Xq:Qq,v=u1e(t),a=_[0].getBoundingClientRect(),C=_[1].getBoundingClientRect(),A=_[2].getBoundingClientRect(),k=v.parentNode,O=a1e(t),R=new dm((C.left-a.left)/100,(C.top-a.top)/100,(A.left-a.left)/100,(A.top-a.top)/100,a.left+(O?0:s1e()),a.top+(O?0:o1e()));if(k.removeChild(v),u)for(a=u.length;a--;)C=u[a],C.scaleX=C.scaleY=0,C.renderTransform(1,C);return e?R.inverse():R}function E9(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h1e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Wn,Ii,Va,xc,lh,mR,rh,I4,_x,$d,Jq,M4,M1,N5,yx,lc,vx,PE,eK,P4,qS=0,tK=function(){return typeof window<"u"},rK=function(){return Wn||tK()&&(Wn=window.gsap)&&Wn.registerPlugin&&Wn},kd=function(e){return typeof e=="function"},Ux=function(e){return typeof e=="object"},pc=function(e){return typeof e>"u"},RE=function(){return!1},$x="transform",R4="transformOrigin",Ed=function(e){return Math.round(e*1e4)/1e4},rx=Array.isArray,UC=function(e,n){var o=Va.createElementNS?Va.createElementNS("http://www.w3.org/1999/xhtml".replace(/^https/,"http"),e):Va.createElement(e);return o.style?o:Va.createElement(e)},S9=180/Math.PI,Tp=1e20,d1e=new dm,Sd=Date.now||function(){return new Date().getTime()},Jp=[],Ng={},f1e=0,p1e=/^(?:a|input|textarea|button|select)$/i,T9=0,Q0={},Zu={},nK=function(e,n){var o={},u;for(u in e)o[u]=n?e[u]*n:e[u];return o},m1e=function(e,n){for(var o in n)o in e||(e[o]=n[o]);return e},A9=function t(e,n){for(var o=e.length,u;o--;)n?e[o].style.touchAction=n:e[o].style.removeProperty("touch-action"),u=e[o].children,u&&u.length&&t(u,n)},iK=function(){return Jp.forEach(function(e){return e()})},g1e=function(e){Jp.push(e),Jp.length===1&&Wn.ticker.add(iK)},I9=function(){return!Jp.length&&Wn.ticker.remove(iK)},M9=function(e){for(var n=Jp.length;n--;)Jp[n]===e&&Jp.splice(n,1);Wn.to(I9,{overwrite:!0,delay:15,duration:0,onComplete:I9,data:"_draggable"})},_1e=function(e,n){for(var o in n)o in e||(e[o]=n[o]);return e},Wo=function(e,n,o,u){if(e.addEventListener){var d=M1[n];u=u||(Jq?{passive:!1}:null),e.addEventListener(d||n,o,u),d&&n!==d&&e.addEventListener(n,o,u)}},Oo=function(e,n,o,u){if(e.removeEventListener){var d=M1[n];e.removeEventListener(d||n,o,u),d&&n!==d&&e.removeEventListener(n,o,u)}},_l=function(e){e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation()},y1e=function(e,n){for(var o=e.length;o--;)if(e[o].identifier===n)return!0},v1e=function t(e){N5=e.touches&&qS<e.touches.length,Oo(e.target,"touchend",t)},P9=function(e){N5=e.touches&&qS<e.touches.length,Wo(e.target,"touchend",v1e)},Ug=function(e){return Ii.pageYOffset||e.scrollTop||e.documentElement.scrollTop||e.body.scrollTop||0},$g=function(e){return Ii.pageXOffset||e.scrollLeft||e.documentElement.scrollLeft||e.body.scrollLeft||0},R9=function t(e,n){Wo(e,"scroll",n),__(e.parentNode)||t(e.parentNode,n)},k9=function t(e,n){Oo(e,"scroll",n),__(e.parentNode)||t(e.parentNode,n)},__=function(e){return!e||e===xc||e.nodeType===9||e===Va.body||e===Ii||!e.nodeType||!e.parentNode},D9=function(e,n){var o=n==="x"?"Width":"Height",u="scroll"+o,d="client"+o;return Math.max(0,__(e)?Math.max(xc[u],lh[u])-(Ii["inner"+o]||xc[d]||lh[d]):e[u]-e[d])},gR=function t(e,n){var o=D9(e,"x"),u=D9(e,"y");__(e)?e=Zu:t(e.parentNode,n),e._gsMaxScrollX=o,e._gsMaxScrollY=u,n||(e._gsScrollX=e.scrollLeft||0,e._gsScrollY=e.scrollTop||0)},_R=function(e,n,o){var u=e.style;u&&(pc(u[n])&&(n=_x(n,e)||n),o==null?u.removeProperty&&u.removeProperty(n.replace(/([A-Z])/g,"-$1").toLowerCase()):u[n]=o)},P1=function(e){return Ii.getComputedStyle(e instanceof Element?e:e.host||(e.parentNode||{}).host||e)},Ap={},J0=function(e){if(e===Ii)return Ap.left=Ap.top=0,Ap.width=Ap.right=xc.clientWidth||e.innerWidth||lh.clientWidth||0,Ap.height=Ap.bottom=(e.innerHeight||0)-20<xc.clientHeight?xc.clientHeight:e.innerHeight||lh.clientHeight||0,Ap;var n=e.ownerDocument||Va,o=pc(e.pageX)?!e.nodeType&&!pc(e.left)&&!pc(e.top)?e:$d(e)[0].getBoundingClientRect():{left:e.pageX-$g(n),top:e.pageY-Ug(n),right:e.pageX-$g(n)+1,bottom:e.pageY-Ug(n)+1};return pc(o.right)&&!pc(o.width)?(o.right=o.left+o.width,o.bottom=o.top+o.height):pc(o.width)&&(o={width:o.right-o.left,height:o.bottom-o.top,right:o.right,left:o.left,bottom:o.bottom,top:o.top}),o},xo=function(e,n,o){var u=e.vars,d=u[o],_=e._listeners[n],v;return kd(d)&&(v=d.apply(u.callbackScope||e,u[o+"Params"]||[e.pointerEvent])),_&&e.dispatchEvent(n)===!1&&(v=!1),v},O9=function(e,n){var o=$d(e)[0],u,d,_;return!o.nodeType&&o!==Ii?pc(e.left)?(d=e.min||e.minX||e.minRotation||0,u=e.min||e.minY||0,{left:d,top:u,width:(e.max||e.maxX||e.maxRotation||0)-d,height:(e.max||e.maxY||0)-u}):(_={x:0,y:0},{left:e.left-_.x,top:e.top-_.y,width:e.width,height:e.height}):x1e(o,n)},yl={},x1e=function(e,n){n=$d(n)[0];var o=e.getBBox&&e.ownerSVGElement,u=e.ownerDocument||Va,d,_,v,a,C,A,k,O,R,z,N,K,q;if(e===Ii)v=Ug(u),d=$g(u),_=d+(u.documentElement.clientWidth||e.innerWidth||u.body.clientWidth||0),a=v+((e.innerHeight||0)-20<u.documentElement.clientHeight?u.documentElement.clientHeight:e.innerHeight||u.body.clientHeight||0);else{if(n===Ii||pc(n))return e.getBoundingClientRect();d=v=0,o?(z=e.getBBox(),N=z.width,K=z.height):(e.viewBox&&(z=e.viewBox.baseVal)&&(d=z.x||0,v=z.y||0,N=z.width,K=z.height),N||(q=P1(e),z=q.boxSizing==="border-box",N=(parseFloat(q.width)||e.clientWidth||0)+(z?0:parseFloat(q.borderLeftWidth)+parseFloat(q.borderRightWidth)),K=(parseFloat(q.height)||e.clientHeight||0)+(z?0:parseFloat(q.borderTopWidth)+parseFloat(q.borderBottomWidth)))),_=N,a=K}return e===n?{left:d,top:v,width:_-d,height:a-v}:(C=Op(n,!0).multiply(Op(e)),A=C.apply({x:d,y:v}),k=C.apply({x:_,y:v}),O=C.apply({x:_,y:a}),R=C.apply({x:d,y:a}),d=Math.min(A.x,k.x,O.x,R.x),v=Math.min(A.y,k.y,O.y,R.y),{left:d,top:v,width:Math.max(A.x,k.x,O.x,R.x)-d,height:Math.max(A.y,k.y,O.y,R.y)-v})},yR=function(e,n,o,u,d,_){var v={},a,C,A;if(n)if(d!==1&&n instanceof Array){if(v.end=a=[],A=n.length,Ux(n[0]))for(C=0;C<A;C++)a[C]=nK(n[C],d);else for(C=0;C<A;C++)a[C]=n[C]*d;o+=1.1,u-=1.1}else kd(n)?v.end=function(k){var O=n.call(e,k),R,z;if(d!==1)if(Ux(O)){R={};for(z in O)R[z]=O[z]*d;O=R}else O*=d;return O}:v.end=n;return(o||o===0)&&(v.max=o),(u||u===0)&&(v.min=u),_&&(v.velocity=0),v},b1e=function t(e){var n;return!e||!e.getAttribute||e===lh?!1:(n=e.getAttribute("data-clickable"))==="true"||n!=="false"&&(p1e.test(e.nodeName+"")||e.getAttribute("contentEditable")==="true")?!0:t(e.parentNode)},$C=function(e,n){for(var o=e.length,u;o--;)u=e[o],u.ondragstart=u.onselectstart=n?null:RE,Wn.set(u,{lazy:!0,userSelect:n?"text":"none"})},w1e=function t(e){if(P1(e).position==="fixed")return!0;if(e=e.parentNode,e&&e.nodeType===1)return t(e)},oK,k4,C1e=function(e,n){e=Wn.utils.toArray(e)[0],n=n||{};var o=document.createElement("div"),u=o.style,d=e.firstChild,_=0,v=0,a=e.scrollTop,C=e.scrollLeft,A=e.scrollWidth,k=e.scrollHeight,O=0,R=0,z=0,N,K,q,j,H,Y;oK&&n.force3D!==!1?(H="translate3d(",Y="px,0px)"):$x&&(H="translate(",Y="px)"),this.scrollTop=function(te,J){if(!arguments.length)return-this.top();this.top(-te,J)},this.scrollLeft=function(te,J){if(!arguments.length)return-this.left();this.left(-te,J)},this.left=function(te,J){if(!arguments.length)return-(e.scrollLeft+v);var ae=e.scrollLeft-C,de=v;if((ae>2||ae<-2)&&!J){C=e.scrollLeft,Wn.killTweensOf(this,{left:1,scrollLeft:1}),this.left(-C),n.onKill&&n.onKill();return}te=-te,te<0?(v=te-.5|0,te=0):te>R?(v=te-R|0,te=R):v=0,(v||de)&&(this._skip||(u[$x]=H+-v+"px,"+-_+Y),v+O>=0&&(u.paddingRight=v+O+"px")),e.scrollLeft=te|0,C=e.scrollLeft},this.top=function(te,J){if(!arguments.length)return-(e.scrollTop+_);var ae=e.scrollTop-a,de=_;if((ae>2||ae<-2)&&!J){a=e.scrollTop,Wn.killTweensOf(this,{top:1,scrollTop:1}),this.top(-a),n.onKill&&n.onKill();return}te=-te,te<0?(_=te-.5|0,te=0):te>z?(_=te-z|0,te=z):_=0,(_||de)&&(this._skip||(u[$x]=H+-v+"px,"+-_+Y)),e.scrollTop=te|0,a=e.scrollTop},this.maxScrollTop=function(){return z},this.maxScrollLeft=function(){return R},this.disable=function(){for(d=o.firstChild;d;)j=d.nextSibling,e.appendChild(d),d=j;e===o.parentNode&&e.removeChild(o)},this.enable=function(){if(d=e.firstChild,d!==o){for(;d;)j=d.nextSibling,o.appendChild(d),d=j;e.appendChild(o),this.calibrate()}},this.calibrate=function(te){var J=e.clientWidth===N,ae,de,Me;a=e.scrollTop,C=e.scrollLeft,!(J&&e.clientHeight===K&&o.offsetHeight===q&&A===e.scrollWidth&&k===e.scrollHeight&&!te)&&((_||v)&&(de=this.left(),Me=this.top(),this.left(-e.scrollLeft),this.top(-e.scrollTop)),ae=P1(e),(!J||te)&&(u.display="block",u.width="auto",u.paddingRight="0px",O=Math.max(0,e.scrollWidth-e.clientWidth),O&&(O+=parseFloat(ae.paddingLeft)+(k4?parseFloat(ae.paddingRight):0))),u.display="inline-block",u.position="relative",u.overflow="visible",u.verticalAlign="top",u.boxSizing="content-box",u.width="100%",u.paddingRight=O+"px",k4&&(u.paddingBottom=ae.paddingBottom),N=e.clientWidth,K=e.clientHeight,A=e.scrollWidth,k=e.scrollHeight,R=e.scrollWidth-N,z=e.scrollHeight-K,q=o.offsetHeight,u.display="block",(de||Me)&&(this.left(de),this.top(Me)))},this.content=o,this.element=e,this._skip=!1,this.enable()},vR=function(e){if(tK()&&document.body){var n=window&&window.navigator;Ii=window,Va=document,xc=Va.documentElement,lh=Va.body,mR=UC("div"),PE=!!window.PointerEvent,rh=UC("div"),rh.style.cssText="visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;cursor:grab",vx=rh.style.cursor==="grab"?"grab":"move",yx=n&&n.userAgent.toLowerCase().indexOf("android")!==-1,M4="ontouchstart"in xc&&"orientation"in Ii||n&&(n.MaxTouchPoints>0||n.msMaxTouchPoints>0),k4=function(){var o=UC("div"),u=UC("div"),d=u.style,_=lh,v;return d.display="inline-block",d.position="relative",o.style.cssText="width:90px;height:40px;padding:10px;overflow:auto;visibility:hidden",o.appendChild(u),_.appendChild(o),v=u.offsetHeight+18>o.scrollHeight,_.removeChild(o),v}(),M1=function(o){for(var u=o.split(","),d=("onpointerdown"in mR?"pointerdown,pointermove,pointerup,pointercancel":"onmspointerdown"in mR?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":o).split(","),_={},v=4;--v>-1;)_[u[v]]=d[v],_[d[v]]=u[v];try{xc.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){Jq=1}}))}catch{}return _}("touchstart,touchmove,touchend,touchcancel"),Wo(Va,"touchcancel",RE),Wo(Ii,"touchmove",RE),lh&&lh.addEventListener("touchstart",RE),Wo(Va,"contextmenu",function(){for(var o in Ng)Ng[o].isPressed&&Ng[o].endDrag()}),Wn=I4=rK()}Wn?(lc=Wn.plugins.inertia,eK=Wn.core.context||function(){},_x=Wn.utils.checkPrefix,$x=_x($x),R4=_x(R4),$d=Wn.utils.toArray,P4=Wn.core.getStyleSaver,oK=!!_x("perspective")):e&&console.warn("Please gsap.registerPlugin(Draggable)")},E1e=function(){function t(n){this._listeners={},this.target=n||this}var e=t.prototype;return e.addEventListener=function(o,u){var d=this._listeners[o]||(this._listeners[o]=[]);~d.indexOf(u)||d.push(u)},e.removeEventListener=function(o,u){var d=this._listeners[o],_=d&&d.indexOf(u);_>=0&&d.splice(_,1)},e.dispatchEvent=function(o){var u=this,d;return(this._listeners[o]||[]).forEach(function(_){return _.call(u,{type:o,target:u.target})===!1&&(d=!1)}),d},t}(),z_=function(t){h1e(e,t);function e(n,o){var u;u=t.call(this)||this,I4||vR(1),n=$d(n)[0],u.styles=P4&&P4(n,"transform,left,top"),lc||(lc=Wn.plugins.inertia),u.vars=o=nK(o||{}),u.target=n,u.x=u.y=u.rotation=0,u.dragResistance=parseFloat(o.dragResistance)||0,u.edgeResistance=isNaN(o.edgeResistance)?1:parseFloat(o.edgeResistance)||0,u.lockAxis=o.lockAxis,u.autoScroll=o.autoScroll||0,u.lockedAxis=null,u.allowEventDefault=!!o.allowEventDefault,Wn.getProperty(n,"x");var d=(o.type||"x,y").toLowerCase(),_=~d.indexOf("x")||~d.indexOf("y"),v=d.indexOf("rotation")!==-1,a=v?"rotation":_?"x":"left",C=_?"y":"top",A=!!(~d.indexOf("x")||~d.indexOf("left")||d==="scroll"),k=!!(~d.indexOf("y")||~d.indexOf("top")||d==="scroll"),O=o.minimumMovement||2,R=E9(u),z=$d(o.trigger||o.handle||n),N={},K=0,q=!1,j=o.autoScrollMarginTop||40,H=o.autoScrollMarginRight||40,Y=o.autoScrollMarginBottom||40,te=o.autoScrollMarginLeft||40,J=o.clickableTest||b1e,ae=0,de=n._gsap||Wn.core.getCache(n),Me=w1e(n),Ce=function(Je,Vt){return parseFloat(de.get(n,Je,Vt))},Ae=n.ownerDocument||Va,Ne,Re,Ye,ht,ft,et,Xe,Mt,Lt,nt,at,it,tt,Jt,$t,Lr,rr,Zt,dn,dr,Ur,Tr,wr,Er,Zn,fn,pn,li,or,Yt,un,_n,rn,ri=function(Je){return _l(Je),Je.stopImmediatePropagation&&Je.stopImmediatePropagation(),!1},Ln=function Cr(Je){if(R.autoScroll&&R.isDragging&&(q||rr)){var Vt=n,Ct=R.autoScroll*15,Wt,ir,ur,Be,ze,lt,mt,qt;for(q=!1,Zu.scrollTop=Ii.pageYOffset!=null?Ii.pageYOffset:Ae.documentElement.scrollTop!=null?Ae.documentElement.scrollTop:Ae.body.scrollTop,Zu.scrollLeft=Ii.pageXOffset!=null?Ii.pageXOffset:Ae.documentElement.scrollLeft!=null?Ae.documentElement.scrollLeft:Ae.body.scrollLeft,Be=R.pointerX-Zu.scrollLeft,ze=R.pointerY-Zu.scrollTop;Vt&&!ir;)ir=__(Vt.parentNode),Wt=ir?Zu:Vt.parentNode,ur=ir?{bottom:Math.max(xc.clientHeight,Ii.innerHeight||0),right:Math.max(xc.clientWidth,Ii.innerWidth||0),left:0,top:0}:Wt.getBoundingClientRect(),lt=mt=0,k&&(qt=Wt._gsMaxScrollY-Wt.scrollTop,qt<0?mt=qt:ze>ur.bottom-Y&&qt?(q=!0,mt=Math.min(qt,Ct*(1-Math.max(0,ur.bottom-ze)/Y)|0)):ze<ur.top+j&&Wt.scrollTop&&(q=!0,mt=-Math.min(Wt.scrollTop,Ct*(1-Math.max(0,ze-ur.top)/j)|0)),mt&&(Wt.scrollTop+=mt)),A&&(qt=Wt._gsMaxScrollX-Wt.scrollLeft,qt<0?lt=qt:Be>ur.right-H&&qt?(q=!0,lt=Math.min(qt,Ct*(1-Math.max(0,ur.right-Be)/H)|0)):Be<ur.left+te&&Wt.scrollLeft&&(q=!0,lt=-Math.min(Wt.scrollLeft,Ct*(1-Math.max(0,Be-ur.left)/te)|0)),lt&&(Wt.scrollLeft+=lt)),ir&&(lt||mt)&&(Ii.scrollTo(Wt.scrollLeft,Wt.scrollTop),_o(R.pointerX+lt,R.pointerY+mt)),Vt=Wt}if(rr){var ar=R.x,gr=R.y;v?(R.deltaX=ar-parseFloat(de.rotation),R.rotation=ar,de.rotation=ar+"deg",de.renderTransform(1,de)):Re?(k&&(R.deltaY=gr-Re.top(),Re.top(gr)),A&&(R.deltaX=ar-Re.left(),Re.left(ar))):_?(k&&(R.deltaY=gr-parseFloat(de.y),de.y=gr+"px"),A&&(R.deltaX=ar-parseFloat(de.x),de.x=ar+"px"),de.renderTransform(1,de)):(k&&(R.deltaY=gr-parseFloat(n.style.top||0),n.style.top=gr+"px"),A&&(R.deltaX=ar-parseFloat(n.style.left||0),n.style.left=ar+"px")),Mt&&!Je&&!li&&(li=!0,xo(R,"drag","onDrag")===!1&&(A&&(R.x-=R.deltaX),k&&(R.y-=R.deltaY),Cr(!0)),li=!1)}rr=!1},Vn=function(Je,Vt){var Ct=R.x,Wt=R.y,ir,ur;n._gsap||(de=Wn.core.getCache(n)),de.uncache&&Wn.getProperty(n,"x"),_?(R.x=parseFloat(de.x),R.y=parseFloat(de.y)):v?R.x=R.rotation=parseFloat(de.rotation):Re?(R.y=Re.top(),R.x=Re.left()):(R.y=parseFloat(n.style.top||(ur=P1(n))&&ur.top)||0,R.x=parseFloat(n.style.left||(ur||{}).left)||0),(dn||dr||Ur)&&!Vt&&(R.isDragging||R.isThrowing)&&(Ur&&(Q0.x=R.x,Q0.y=R.y,ir=Ur(Q0),ir.x!==R.x&&(R.x=ir.x,rr=!0),ir.y!==R.y&&(R.y=ir.y,rr=!0)),dn&&(ir=dn(R.x),ir!==R.x&&(R.x=ir,v&&(R.rotation=ir),rr=!0)),dr&&(ir=dr(R.y),ir!==R.y&&(R.y=ir),rr=!0)),rr&&Ln(!0),Je||(R.deltaX=R.x-Ct,R.deltaY=R.y-Wt,xo(R,"throwupdate","onThrowUpdate"))},Xr=function(Je,Vt,Ct,Wt){return Vt==null&&(Vt=-Tp),Ct==null&&(Ct=Tp),kd(Je)?function(ir){var ur=R.isPressed?1-R.edgeResistance:1;return Je.call(R,(ir>Ct?Ct+(ir-Ct)*ur:ir<Vt?Vt+(ir-Vt)*ur:ir)*Wt)*Wt}:rx(Je)?function(ir){for(var ur=Je.length,Be=0,ze=Tp,lt,mt;--ur>-1;)lt=Je[ur],mt=lt-ir,mt<0&&(mt=-mt),mt<ze&&lt>=Vt&&lt<=Ct&&(Be=ur,ze=mt);return Je[Be]}:isNaN(Je)?function(ir){return ir}:function(){return Je*Wt}},yr=function(Je,Vt,Ct,Wt,ir,ur,Be){return ur=ur&&ur<Tp?ur*ur:Tp,kd(Je)?function(ze){var lt=R.isPressed?1-R.edgeResistance:1,mt=ze.x,qt=ze.y,ar,gr,xe;return ze.x=mt=mt>Ct?Ct+(mt-Ct)*lt:mt<Vt?Vt+(mt-Vt)*lt:mt,ze.y=qt=qt>ir?ir+(qt-ir)*lt:qt<Wt?Wt+(qt-Wt)*lt:qt,ar=Je.call(R,ze),ar!==ze&&(ze.x=ar.x,ze.y=ar.y),Be!==1&&(ze.x*=Be,ze.y*=Be),ur<Tp&&(gr=ze.x-mt,xe=ze.y-qt,gr*gr+xe*xe>ur&&(ze.x=mt,ze.y=qt)),ze}:rx(Je)?function(ze){for(var lt=Je.length,mt=0,qt=Tp,ar,gr,xe,X;--lt>-1;)xe=Je[lt],ar=xe.x-ze.x,gr=xe.y-ze.y,X=ar*ar+gr*gr,X<qt&&(mt=lt,qt=X);return qt<=ur?Je[mt]:ze}:function(ze){return ze}},xi=function(){var Je,Vt,Ct,Wt;Xe=!1,Re?(Re.calibrate(),R.minX=at=-Re.maxScrollLeft(),R.minY=tt=-Re.maxScrollTop(),R.maxX=nt=R.maxY=it=0,Xe=!0):o.bounds&&(Je=O9(o.bounds,n.parentNode),v?(R.minX=at=Je.left,R.maxX=nt=Je.left+Je.width,R.minY=tt=R.maxY=it=0):!pc(o.bounds.maxX)||!pc(o.bounds.maxY)?(Je=o.bounds,R.minX=at=Je.minX,R.minY=tt=Je.minY,R.maxX=nt=Je.maxX,R.maxY=it=Je.maxY):(Vt=O9(n,n.parentNode),R.minX=at=Math.round(Ce(a,"px")+Je.left-Vt.left),R.minY=tt=Math.round(Ce(C,"px")+Je.top-Vt.top),R.maxX=nt=Math.round(at+(Je.width-Vt.width)),R.maxY=it=Math.round(tt+(Je.height-Vt.height))),at>nt&&(R.minX=nt,R.maxX=nt=at,at=R.minX),tt>it&&(R.minY=it,R.maxY=it=tt,tt=R.minY),v&&(R.minRotation=at,R.maxRotation=nt),Xe=!0),o.liveSnap&&(Ct=o.liveSnap===!0?o.snap||{}:o.liveSnap,Wt=rx(Ct)||kd(Ct),v?(dn=Xr(Wt?Ct:Ct.rotation,at,nt,1),dr=null):Ct.points?Ur=yr(Wt?Ct:Ct.points,at,nt,tt,it,Ct.radius,Re?-1:1):(A&&(dn=Xr(Wt?Ct:Ct.x||Ct.left||Ct.scrollLeft,at,nt,Re?-1:1)),k&&(dr=Xr(Wt?Ct:Ct.y||Ct.top||Ct.scrollTop,tt,it,Re?-1:1))))},Ei=function(){R.isThrowing=!1,xo(R,"throwcomplete","onThrowComplete")},$i=function(){R.isThrowing=!1},vr=function(Je,Vt){var Ct,Wt,ir,ur;Je&&lc?(Je===!0&&(Ct=o.snap||o.liveSnap||{},Wt=rx(Ct)||kd(Ct),Je={resistance:(o.throwResistance||o.resistance||1e3)/(v?10:1)},v?Je.rotation=yR(R,Wt?Ct:Ct.rotation,nt,at,1,Vt):(A&&(Je[a]=yR(R,Wt?Ct:Ct.points||Ct.x||Ct.left,nt,at,Re?-1:1,Vt||R.lockedAxis==="x")),k&&(Je[C]=yR(R,Wt?Ct:Ct.points||Ct.y||Ct.top,it,tt,Re?-1:1,Vt||R.lockedAxis==="y")),(Ct.points||rx(Ct)&&Ux(Ct[0]))&&(Je.linkedProps=a+","+C,Je.radius=Ct.radius))),R.isThrowing=!0,ur=isNaN(o.overshootTolerance)?o.edgeResistance===1?0:1-R.edgeResistance+.2:o.overshootTolerance,Je.duration||(Je.duration={max:Math.max(o.minDuration||0,"maxDuration"in o?o.maxDuration:2),min:isNaN(o.minDuration)?ur===0||Ux(Je)&&Je.resistance>1e3?0:.5:o.minDuration,overshoot:ur}),R.tween=ir=Wn.to(Re||n,{inertia:Je,data:"_draggable",inherit:!1,onComplete:Ei,onInterrupt:$i,onUpdate:o.fastMode?xo:Vn,onUpdateParams:o.fastMode?[R,"onthrowupdate","onThrowUpdate"]:Ct&&Ct.radius?[!1,!0]:[]}),o.fastMode||(Re&&(Re._skip=!0),ir.render(1e9,!0,!0),Vn(!0,!0),R.endX=R.x,R.endY=R.y,v&&(R.endRotation=R.x),ir.play(0),Vn(!0,!0),Re&&(Re._skip=!1))):Xe&&R.applyBounds()},nn=function(Je){var Vt=Er,Ct;Er=Op(n.parentNode,!0),Je&&R.isPressed&&!Er.equals(Vt||new dm)&&(Ct=Vt.inverse().apply({x:Ye,y:ht}),Er.apply(Ct,Ct),Ye=Ct.x,ht=Ct.y),Er.equals(d1e)&&(Er=null)},Hn=function(){var Je=1-R.edgeResistance,Vt=Me?$g(Ae):0,Ct=Me?Ug(Ae):0,Wt,ir,ur;_&&(de.x=Ce(a,"px")+"px",de.y=Ce(C,"px")+"px",de.renderTransform()),nn(!1),yl.x=R.pointerX-Vt,yl.y=R.pointerY-Ct,Er&&Er.apply(yl,yl),Ye=yl.x,ht=yl.y,rr&&(_o(R.pointerX,R.pointerY),Ln(!0)),_n=Op(n),Re?(xi(),et=Re.top(),ft=Re.left()):(cr()?(Vn(!0,!0),xi()):R.applyBounds(),v?(Wt=n.ownerSVGElement?[de.xOrigin-n.getBBox().x,de.yOrigin-n.getBBox().y]:(P1(n)[R4]||"0 0").split(" "),Lr=R.rotationOrigin=Op(n).apply({x:parseFloat(Wt[0])||0,y:parseFloat(Wt[1])||0}),Vn(!0,!0),ir=R.pointerX-Lr.x-Vt,ur=Lr.y-R.pointerY+Ct,ft=R.x,et=R.y=Math.atan2(ur,ir)*S9):(et=Ce(C,"px"),ft=Ce(a,"px"))),Xe&&Je&&(ft>nt?ft=nt+(ft-nt)/Je:ft<at&&(ft=at-(at-ft)/Je),v||(et>it?et=it+(et-it)/Je:et<tt&&(et=tt-(tt-et)/Je))),R.startX=ft=Ed(ft),R.startY=et=Ed(et)},cr=function(){return R.tween&&R.tween.isActive()},Is=function(){rh.parentNode&&!cr()&&!R.isDragging&&rh.parentNode.removeChild(rh)},Mn=function(Je,Vt){var Ct;if(!Ne||R.isPressed||!Je||(Je.type==="mousedown"||Je.type==="pointerdown")&&!Vt&&Sd()-ae<30&&M1[R.pointerEvent.type]){un&&Je&&Ne&&_l(Je);return}if(Zn=cr(),rn=!1,R.pointerEvent=Je,M1[Je.type]?(wr=~Je.type.indexOf("touch")?Je.currentTarget||Je.target:Ae,Wo(wr,"touchend",ci),Wo(wr,"touchmove",Xi),Wo(wr,"touchcancel",ci),Wo(Ae,"touchstart",P9)):(wr=null,Wo(Ae,"mousemove",Xi)),pn=null,(!PE||!wr)&&(Wo(Ae,"mouseup",ci),Je&&Je.target&&Wo(Je.target,"mouseup",ci)),Tr=J.call(R,Je.target)&&o.dragClickables===!1&&!Vt,Tr){Wo(Je.target,"change",ci),xo(R,"pressInit","onPressInit"),xo(R,"press","onPress"),$C(z,!0),un=!1;return}if(fn=!wr||A===k||R.vars.allowNativeTouchScrolling===!1||R.vars.allowContextMenu&&Je&&(Je.ctrlKey||Je.which>2)?!1:A?"y":"x",un=!fn&&!R.allowEventDefault,un&&(_l(Je),Wo(Ii,"touchforcechange",_l)),Je.changedTouches?(Je=Jt=Je.changedTouches[0],$t=Je.identifier):Je.pointerId?$t=Je.pointerId:Jt=$t=null,qS++,g1e(Ln),ht=R.pointerY=Je.pageY,Ye=R.pointerX=Je.pageX,xo(R,"pressInit","onPressInit"),(fn||R.autoScroll)&&gR(n.parentNode),n.parentNode&&R.autoScroll&&!Re&&!v&&n.parentNode._gsMaxScrollX&&!rh.parentNode&&!n.getBBox&&(rh.style.width=n.parentNode.scrollWidth+"px",n.parentNode.appendChild(rh)),Hn(),R.tween&&R.tween.kill(),R.isThrowing=!1,Wn.killTweensOf(Re||n,N,!0),Re&&Wn.killTweensOf(n,{scrollTo:1},!0),R.tween=R.lockedAxis=null,(o.zIndexBoost||!v&&!Re&&o.zIndexBoost!==!1)&&(n.style.zIndex=e.zIndex++),R.isPressed=!0,Mt=!!(o.onDrag||R._listeners.drag),Lt=!!(o.onMove||R._listeners.move),o.cursor!==!1||o.activeCursor)for(Ct=z.length;--Ct>-1;)Wn.set(z[Ct],{cursor:o.activeCursor||o.cursor||(vx==="grab"?"grabbing":vx)});xo(R,"press","onPress")},Xi=function(Je){var Vt=Je,Ct,Wt,ir,ur,Be,ze;if(!Ne||N5||!R.isPressed||!Je){un&&Je&&Ne&&_l(Je);return}if(R.pointerEvent=Je,Ct=Je.changedTouches,Ct){if(Je=Ct[0],Je!==Jt&&Je.identifier!==$t){for(ur=Ct.length;--ur>-1&&(Je=Ct[ur]).identifier!==$t&&Je.target!==n;);if(ur<0)return}}else if(Je.pointerId&&$t&&Je.pointerId!==$t)return;if(wr&&fn&&!pn&&(yl.x=Je.pageX-(Me?$g(Ae):0),yl.y=Je.pageY-(Me?Ug(Ae):0),Er&&Er.apply(yl,yl),Wt=yl.x,ir=yl.y,Be=Math.abs(Wt-Ye),ze=Math.abs(ir-ht),(Be!==ze&&(Be>O||ze>O)||yx&&fn===pn)&&(pn=Be>ze&&A?"x":"y",fn&&pn!==fn&&Wo(Ii,"touchforcechange",_l),R.vars.lockAxisOnTouchScroll!==!1&&A&&k&&(R.lockedAxis=pn==="x"?"y":"x",kd(R.vars.onLockAxis)&&R.vars.onLockAxis.call(R,Vt)),yx&&fn===pn))){ci(Vt);return}!R.allowEventDefault&&(!fn||pn&&fn!==pn)&&Vt.cancelable!==!1?(_l(Vt),un=!0):un&&(un=!1),R.autoScroll&&(q=!0),_o(Je.pageX,Je.pageY,Lt)},_o=function(Je,Vt,Ct){var Wt=1-R.dragResistance,ir=1-R.edgeResistance,ur=R.pointerX,Be=R.pointerY,ze=et,lt=R.x,mt=R.y,qt=R.endX,ar=R.endY,gr=R.endRotation,xe=rr,X,re,le,we,Ie,Oe;R.pointerX=Je,R.pointerY=Vt,Me&&(Je-=$g(Ae),Vt-=Ug(Ae)),v?(we=Math.atan2(Lr.y-Vt,Je-Lr.x)*S9,Ie=R.y-we,Ie>180?(et-=360,R.y=we):Ie<-180&&(et+=360,R.y=we),R.x!==ft||Math.abs(et-we)>O?(R.y=we,le=ft+(et-we)*Wt):le=ft):(Er&&(Oe=Je*Er.a+Vt*Er.c+Er.e,Vt=Je*Er.b+Vt*Er.d+Er.f,Je=Oe),re=Vt-ht,X=Je-Ye,re<O&&re>-O&&(re=0),X<O&&X>-O&&(X=0),(R.lockAxis||R.lockedAxis)&&(X||re)&&(Oe=R.lockedAxis,Oe||(R.lockedAxis=Oe=A&&Math.abs(X)>Math.abs(re)?"y":k?"x":null,Oe&&kd(R.vars.onLockAxis)&&R.vars.onLockAxis.call(R,R.pointerEvent)),Oe==="y"?re=0:Oe==="x"&&(X=0)),le=Ed(ft+X*Wt),we=Ed(et+re*Wt)),(dn||dr||Ur)&&(R.x!==le||R.y!==we&&!v)&&(Ur&&(Q0.x=le,Q0.y=we,Oe=Ur(Q0),le=Ed(Oe.x),we=Ed(Oe.y)),dn&&(le=Ed(dn(le))),dr&&(we=Ed(dr(we)))),Xe&&(le>nt?le=nt+Math.round((le-nt)*ir):le<at&&(le=at+Math.round((le-at)*ir)),v||(we>it?we=Math.round(it+(we-it)*ir):we<tt&&(we=Math.round(tt+(we-tt)*ir)))),(R.x!==le||R.y!==we&&!v)&&(v?(R.endRotation=R.x=R.endX=le,rr=!0):(k&&(R.y=R.endY=we,rr=!0),A&&(R.x=R.endX=le,rr=!0)),!Ct||xo(R,"move","onMove")!==!1?!R.isDragging&&R.isPressed&&(R.isDragging=rn=!0,xo(R,"dragstart","onDragStart")):(R.pointerX=ur,R.pointerY=Be,et=ze,R.x=lt,R.y=mt,R.endX=qt,R.endY=ar,R.endRotation=gr,rr=xe))},ci=function Cr(Je,Vt){if(!Ne||!R.isPressed||Je&&$t!=null&&!Vt&&(Je.pointerId&&Je.pointerId!==$t&&Je.target!==n||Je.changedTouches&&!y1e(Je.changedTouches,$t))){un&&Je&&Ne&&_l(Je);return}R.isPressed=!1;var Ct=Je,Wt=R.isDragging,ir=R.vars.allowContextMenu&&Je&&(Je.ctrlKey||Je.which>2),ur=Wn.delayedCall(.001,Is),Be,ze,lt,mt,qt;if(wr?(Oo(wr,"touchend",Cr),Oo(wr,"touchmove",Xi),Oo(wr,"touchcancel",Cr),Oo(Ae,"touchstart",P9)):Oo(Ae,"mousemove",Xi),Oo(Ii,"touchforcechange",_l),(!PE||!wr)&&(Oo(Ae,"mouseup",Cr),Je&&Je.target&&Oo(Je.target,"mouseup",Cr)),rr=!1,Wt&&(K=T9=Sd(),R.isDragging=!1),M9(Ln),Tr&&!ir){Je&&(Oo(Je.target,"change",Cr),R.pointerEvent=Ct),$C(z,!1),xo(R,"release","onRelease"),xo(R,"click","onClick"),Tr=!1;return}for(ze=z.length;--ze>-1;)_R(z[ze],"cursor",o.cursor||(o.cursor!==!1?vx:null));if(qS--,Je){if(Be=Je.changedTouches,Be&&(Je=Be[0],Je!==Jt&&Je.identifier!==$t)){for(ze=Be.length;--ze>-1&&(Je=Be[ze]).identifier!==$t&&Je.target!==n;);if(ze<0&&!Vt)return}R.pointerEvent=Ct,R.pointerX=Je.pageX,R.pointerY=Je.pageY}return ir&&Ct?(_l(Ct),un=!0,xo(R,"release","onRelease")):Ct&&!Wt?(un=!1,Zn&&(o.snap||o.bounds)&&vr(o.inertia||o.throwProps),xo(R,"release","onRelease"),(!yx||Ct.type!=="touchmove")&&Ct.type.indexOf("cancel")===-1&&(xo(R,"click","onClick"),Sd()-ae<300&&xo(R,"doubleclick","onDoubleClick"),mt=Ct.target||n,ae=Sd(),qt=function(){ae!==or&&R.enabled()&&!R.isPressed&&!Ct.defaultPrevented&&(mt.click?mt.click():Ae.createEvent&&(lt=Ae.createEvent("MouseEvents"),lt.initMouseEvent("click",!0,!0,Ii,1,R.pointerEvent.screenX,R.pointerEvent.screenY,R.pointerX,R.pointerY,!1,!1,!1,!1,0,null),mt.dispatchEvent(lt)))},!yx&&!Ct.defaultPrevented&&Wn.delayedCall(.05,qt))):(vr(o.inertia||o.throwProps),!R.allowEventDefault&&Ct&&(o.dragClickables!==!1||!J.call(R,Ct.target))&&Wt&&(!fn||pn&&fn===pn)&&Ct.cancelable!==!1?(un=!0,_l(Ct)):un=!1,xo(R,"release","onRelease")),cr()&&ur.duration(R.tween.duration()),Wt&&xo(R,"dragend","onDragEnd"),!0},Bi=function(Je){if(Je&&R.isDragging&&!Re){var Vt=Je.target||n.parentNode,Ct=Vt.scrollLeft-Vt._gsScrollX,Wt=Vt.scrollTop-Vt._gsScrollY;(Ct||Wt)&&(Er?(Ye-=Ct*Er.a+Wt*Er.c,ht-=Wt*Er.d+Ct*Er.b):(Ye-=Ct,ht-=Wt),Vt._gsScrollX+=Ct,Vt._gsScrollY+=Wt,_o(R.pointerX,R.pointerY))}},Ms=function(Je){var Vt=Sd(),Ct=Vt-ae<100,Wt=Vt-K<50,ir=Ct&&or===ae,ur=R.pointerEvent&&R.pointerEvent.defaultPrevented,Be=Ct&&Yt===ae,ze=Je.isTrusted||Je.isTrusted==null&&Ct&&ir;if((ir||Wt&&R.vars.suppressClickOnDrag!==!1)&&Je.stopImmediatePropagation&&Je.stopImmediatePropagation(),Ct&&!(R.pointerEvent&&R.pointerEvent.defaultPrevented)&&(!ir||ze&&!Be)){ze&&ir&&(Yt=ae),or=ae;return}(R.isPressed||Wt||Ct)&&(!ze||!Je.detail||!Ct||ur)&&_l(Je),!Ct&&!Wt&&!rn&&(Je&&Je.target&&(R.pointerEvent=Je),xo(R,"click","onClick"))},fs=function(Je){return Er?{x:Je.x*Er.a+Je.y*Er.c+Er.e,y:Je.x*Er.b+Je.y*Er.d+Er.f}:{x:Je.x,y:Je.y}};return Zt=e.get(n),Zt&&Zt.kill(),u.startDrag=function(Cr,Je){var Vt,Ct,Wt,ir;Mn(Cr||R.pointerEvent,!0),Je&&!R.hitTest(Cr||R.pointerEvent)&&(Vt=J0(Cr||R.pointerEvent),Ct=J0(n),Wt=fs({x:Vt.left+Vt.width/2,y:Vt.top+Vt.height/2}),ir=fs({x:Ct.left+Ct.width/2,y:Ct.top+Ct.height/2}),Ye-=Wt.x-ir.x,ht-=Wt.y-ir.y),R.isDragging||(R.isDragging=rn=!0,xo(R,"dragstart","onDragStart"))},u.drag=Xi,u.endDrag=function(Cr){return ci(Cr||R.pointerEvent,!0)},u.timeSinceDrag=function(){return R.isDragging?0:(Sd()-K)/1e3},u.timeSinceClick=function(){return(Sd()-ae)/1e3},u.hitTest=function(Cr,Je){return e.hitTest(R.target,Cr,Je)},u.getDirection=function(Cr,Je){var Vt=Cr==="velocity"&&lc?Cr:Ux(Cr)&&!v?"element":"start",Ct,Wt,ir,ur,Be,ze;return Vt==="element"&&(Be=J0(R.target),ze=J0(Cr)),Ct=Vt==="start"?R.x-ft:Vt==="velocity"?lc.getVelocity(n,a):Be.left+Be.width/2-(ze.left+ze.width/2),v?Ct<0?"counter-clockwise":"clockwise":(Je=Je||2,Wt=Vt==="start"?R.y-et:Vt==="velocity"?lc.getVelocity(n,C):Be.top+Be.height/2-(ze.top+ze.height/2),ir=Math.abs(Ct/Wt),ur=ir<1/Je?"":Ct<0?"left":"right",ir<Je&&(ur!==""&&(ur+="-"),ur+=Wt<0?"up":"down"),ur)},u.applyBounds=function(Cr,Je){var Vt,Ct,Wt,ir,ur,Be;if(Cr&&o.bounds!==Cr)return o.bounds=Cr,R.update(!0,Je);if(Vn(!0),xi(),Xe&&!cr()){if(Vt=R.x,Ct=R.y,Vt>nt?Vt=nt:Vt<at&&(Vt=at),Ct>it?Ct=it:Ct<tt&&(Ct=tt),(R.x!==Vt||R.y!==Ct)&&(Wt=!0,R.x=R.endX=Vt,v?R.endRotation=Vt:R.y=R.endY=Ct,rr=!0,Ln(!0),R.autoScroll&&!R.isDragging))for(gR(n.parentNode),ir=n,Zu.scrollTop=Ii.pageYOffset!=null?Ii.pageYOffset:Ae.documentElement.scrollTop!=null?Ae.documentElement.scrollTop:Ae.body.scrollTop,Zu.scrollLeft=Ii.pageXOffset!=null?Ii.pageXOffset:Ae.documentElement.scrollLeft!=null?Ae.documentElement.scrollLeft:Ae.body.scrollLeft;ir&&!Be;)Be=__(ir.parentNode),ur=Be?Zu:ir.parentNode,k&&ur.scrollTop>ur._gsMaxScrollY&&(ur.scrollTop=ur._gsMaxScrollY),A&&ur.scrollLeft>ur._gsMaxScrollX&&(ur.scrollLeft=ur._gsMaxScrollX),ir=ur;R.isThrowing&&(Wt||R.endX>nt||R.endX<at||R.endY>it||R.endY<tt)&&vr(o.inertia||o.throwProps,Wt)}return R},u.update=function(Cr,Je,Vt){if(Je&&R.isPressed){var Ct=Op(n),Wt=_n.apply({x:R.x-ft,y:R.y-et}),ir=Op(n.parentNode,!0);ir.apply({x:Ct.e-Wt.x,y:Ct.f-Wt.y},Wt),R.x-=Wt.x-ir.e,R.y-=Wt.y-ir.f,Ln(!0),Hn()}var ur=R.x,Be=R.y;return nn(!Je),Cr?R.applyBounds():(rr&&Vt&&Ln(!0),Vn(!0)),Je&&(_o(R.pointerX,R.pointerY),rr&&Ln(!0)),R.isPressed&&!Je&&(A&&Math.abs(ur-R.x)>.01||k&&Math.abs(Be-R.y)>.01&&!v)&&Hn(),R.autoScroll&&(gR(n.parentNode,R.isDragging),q=R.isDragging,Ln(!0),k9(n,Bi),R9(n,Bi)),R},u.enable=function(Cr){var Je={lazy:!0},Vt,Ct,Wt;if(o.cursor!==!1&&(Je.cursor=o.cursor||vx),Wn.utils.checkPrefix("touchCallout")&&(Je.touchCallout="none"),Cr!=="soft"){for(A9(z,A===k?"none":o.allowNativeTouchScrolling&&n.scrollHeight===n.clientHeight==(n.scrollWidth===n.clientHeight)||o.allowEventDefault?"manipulation":A?"pan-y":"pan-x"),Ct=z.length;--Ct>-1;)Wt=z[Ct],PE||Wo(Wt,"mousedown",Mn),Wo(Wt,"touchstart",Mn),Wo(Wt,"click",Ms,!0),Wn.set(Wt,Je),Wt.getBBox&&Wt.ownerSVGElement&&A!==k&&Wn.set(Wt.ownerSVGElement,{touchAction:o.allowNativeTouchScrolling||o.allowEventDefault?"manipulation":A?"pan-y":"pan-x"}),o.allowContextMenu||Wo(Wt,"contextmenu",ri);$C(z,!1)}return R9(n,Bi),Ne=!0,lc&&Cr!=="soft"&&lc.track(Re||n,_?"x,y":v?"rotation":"top,left"),n._gsDragID=Vt="d"+f1e++,Ng[Vt]=R,Re&&(Re.enable(),Re.element._gsDragID=Vt),(o.bounds||v)&&Hn(),o.bounds&&R.applyBounds(),R},u.disable=function(Cr){for(var Je=R.isDragging,Vt=z.length,Ct;--Vt>-1;)_R(z[Vt],"cursor",null);if(Cr!=="soft"){for(A9(z,null),Vt=z.length;--Vt>-1;)Ct=z[Vt],_R(Ct,"touchCallout",null),Oo(Ct,"mousedown",Mn),Oo(Ct,"touchstart",Mn),Oo(Ct,"click",Ms,!0),Oo(Ct,"contextmenu",ri);$C(z,!0),wr&&(Oo(wr,"touchcancel",ci),Oo(wr,"touchend",ci),Oo(wr,"touchmove",Xi)),Oo(Ae,"mouseup",ci),Oo(Ae,"mousemove",Xi)}return k9(n,Bi),Ne=!1,lc&&Cr!=="soft"&&(lc.untrack(Re||n,_?"x,y":v?"rotation":"top,left"),R.tween&&R.tween.kill()),Re&&Re.disable(),M9(Ln),R.isDragging=R.isPressed=Tr=!1,Je&&xo(R,"dragend","onDragEnd"),R},u.enabled=function(Cr,Je){return arguments.length?Cr?R.enable(Je):R.disable(Je):Ne},u.kill=function(){return R.isThrowing=!1,R.tween&&R.tween.kill(),R.disable(),Wn.set(z,{clearProps:"userSelect"}),delete Ng[n._gsDragID],R},u.revert=function(){this.kill(),this.styles&&this.styles.revert()},~d.indexOf("scroll")&&(Re=u.scrollProxy=new C1e(n,m1e({onKill:function(){R.isPressed&&ci(null)}},o)),n.style.overflowY=k&&!M4?"auto":"hidden",n.style.overflowX=A&&!M4?"auto":"hidden",n=Re.content),v?N.rotation=1:(A&&(N[a]=1),k&&(N[C]=1)),de.force3D="force3D"in o?o.force3D:!0,eK(E9(u)),u.enable(),u}return e.register=function(o){Wn=o,vR()},e.create=function(o,u){return I4||vR(!0),$d(o).map(function(d){return new e(d,u)})},e.get=function(o){return Ng[($d(o)[0]||{})._gsDragID]},e.timeSinceDrag=function(){return(Sd()-T9)/1e3},e.hitTest=function(o,u,d){if(o===u)return!1;var _=J0(o),v=J0(u),a=_.top,C=_.left,A=_.right,k=_.bottom,O=_.width,R=_.height,z=v.left>A||v.right<C||v.top>k||v.bottom<a,N,K,q;return z||!d?!z:(q=(d+"").indexOf("%")!==-1,d=parseFloat(d)||0,N={left:Math.max(C,v.left),top:Math.max(a,v.top)},N.width=Math.min(A,v.right)-N.left,N.height=Math.min(k,v.bottom)-N.top,N.width<0||N.height<0?!1:q?(d*=.01,K=N.width*N.height,K>=O*R*d||K>=v.width*v.height*d):N.width>d&&N.height>d)},e}(E1e);_1e(z_.prototype,{pointerX:0,pointerY:0,startX:0,startY:0,deltaX:0,deltaY:0,isDragging:!1,isPressed:!1});z_.zIndex=1e3;z_.version="3.12.5";rK()&&Wn.registerPlugin(z_);const L9=`/*!
 * InertiaPlugin 3.12.5
 * https://gsap.com
 * 
 * @license Copyright 2024, GreenSock. All rights reserved.
 * *** DO NOT DEPLOY THIS FILE ***
 * This is a trial version that only works locally and on domains like codepen.io and codesandbox.io.
 * Loading it on an unauthorized domain violates the license and will cause a redirect.
 * Get the unrestricted file by joining Club GSAP at https://gsap.com/pricing
 * @author: Jack Doyle, jack@greensock.com
 */

let t,e,i,r,n,o,s,a,l,c=()=>t||"undefined"!=typeof window&&(t=window.gsap),g={},p=t=>l(t).id,u=t=>g[p("string"==typeof t?i(t)[0]:t)],d=t=>{let e,i=n;if(t-s>=.05)for(a=s,s=t;i;)e=i.g(i.t,i.p),(e!==i.v1||t-i.t1>.2)&&(i.v2=i.v1,i.v1=e,i.t2=i.t1,i.t1=t),i=i._next},h={deg:360,rad:2*Math.PI},f=()=>{t=c(),t&&(i=t.utils.toArray,r=t.utils.getUnit,l=t.core.getCache,o=t.ticker,e=1)};class v{constructor(t,e,i,n){this.t=t,this.p=e,this.g=t._gsap.get,this.rCap=h[i||r(this.g(t,e))],this.v1=this.v2=0,this.t1=this.t2=o.time,n&&(this._next=n,n._prev=this)}}class m{constructor(t,r){e||f(),this.target=i(t)[0],g[p(this.target)]=this,this._props={},r&&this.add(r)}static register(e){t=e,f()}get(t,e){let i,r,n,s=this._props[t]||console.warn("Not tracking "+t+" velocity.");return i=parseFloat(e?s.v1:s.g(s.t,s.p)),r=i-parseFloat(s.v2),n=s.rCap,n&&(r%=n,r!==r%(n/2)&&(r=r<0?r+n:r-n)),a=r/((e?s.t1:o.time)-s.t2),Math.round(1e4*a)/1e4;var a}getAll(){let t,e={},i=this._props;for(t in i)e[t]=this.get(t);return e}isTracking(t){return t in this._props}add(t,e){t in this._props||(n||(o.add(d),s=a=o.time),n=this._props[t]=new v(this.target,t,e,n))}remove(t){let e,i,r=this._props[t];r&&(e=r._prev,i=r._next,e&&(e._next=i),i?i._prev=e:n===r&&(o.remove(d),n=0),delete this._props[t])}kill(t){for(let t in this._props)this.remove(t);t||delete g[p(this.target)]}static track(t,r,n){e||f();let o,s,a=[],l=i(t),c=r.split(","),g=(n||"").split(","),p=l.length;for(;p--;){for(o=u(l[p])||new m(l[p]),s=c.length;s--;)o.add(c[s],g[s]||g[0]);a.push(o)}return a}static untrack(t,e){let r=(e||"").split(",");i(t).forEach(t=>{let e=u(t);e&&(r.length?r.forEach(t=>e.remove(t)):e.kill(1))})}static isTracking(t,e){let i=u(t);return i&&i.isTracking(e)}static getVelocity(t,e){let i=u(t);return i&&i.isTracking(e)?i.get(e):console.warn("Not tracking velocity of "+e)}}m.getByTarget=u,c()&&t.registerPlugin(m);let y,w,_,k,x,T,F,P,N,b,M,O,E,A,C=m.getByTarget,S=()=>y||"undefined"!=typeof window&&(y=window.gsap)&&y.registerPlugin&&y,j=t=>"number"==typeof t,I=t=>"object"==typeof t,B=t=>"function"==typeof t,R=function(){return String.fromCharCode.apply(null,arguments)},W=R(103,114,101,101,110,115,111,99,107,46,99,111,109),L=R(103,115,97,112,46,99,111,109),U=/^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}:?\\d*$/,V=function(t){var e="undefined"!=typeof window,i=0===(e?window.location.href:"").indexOf(R(102,105,108,101,58,47,47))||-1!==t.indexOf(R(108,111,99,97,108,104,111,115,116))||U.test(t)||(e?window.location.hostname:"").split(".").pop()===R(108,111,99,97,108),r=[W,L,R(99,111,100,101,112,101,110,46,105,111),R(99,111,100,101,112,101,110,46,112,108,117,109,98,105,110,103),R(99,111,100,101,112,101,110,46,100,101,118),R(99,111,100,101,112,101,110,46,97,112,112),R(99,111,100,101,112,101,110,46,119,101,98,115,105,116,101),R(112,101,110,115,46,99,108,111,117,100),R(99,115,115,45,116,114,105,99,107,115,46,99,111,109),R(99,100,112,110,46,105,111),R(112,101,110,115,46,105,111),R(103,97,110,110,111,110,46,116,118),R(99,111,100,101,99,97,110,121,111,110,46,110,101,116),R(116,104,101,109,101,102,111,114,101,115,116,46,110,101,116),R(99,101,114,101,98,114,97,120,46,99,111,46,117,107),R(116,121,109,112,97,110,117,115,46,110,101,116),R(116,119,101,101,110,109,97,120,46,99,111,109),R(112,108,110,107,114,46,99,111),R(104,111,116,106,97,114,46,99,111,109),R(119,101,98,112,97,99,107,98,105,110,46,99,111,109),R(97,114,99,104,105,118,101,46,111,114,103),R(99,111,100,101,115,97,110,100,98,111,120,46,105,111),R(99,115,98,46,97,112,112),R(115,116,97,99,107,98,108,105,116,122,46,99,111,109),R(115,116,97,99,107,98,108,105,116,122,46,105,111),R(99,111,100,105,101,114,46,105,111),R(109,111,116,105,111,110,116,114,105,99,107,115,46,99,111,109),R(115,116,97,99,107,111,118,101,114,102,108,111,119,46,99,111,109),R(115,116,97,99,107,101,120,99,104,97,110,103,101,46,99,111,109),R(115,116,117,100,105,111,102,114,101,105,103,104,116,46,99,111,109),R(119,101,98,99,111,110,116,97,105,110,101,114,46,105,111),R(106,115,102,105,100,100,108,101,46,110,101,116)],n=function(){if(e)if("loading"===document.readyState||"interactive"===document.readyState)document.addEventListener("readystatechange",n);else{document.removeEventListener("readystatechange",n);var t="object"==typeof y?y:e&&window.gsap;e&&window.console&&!window._gsapWarned&&"object"==typeof t&&!1!==t.config().trialWarn&&(console.log(R(37,99,87,97,114,110,105,110,103),R(102,111,110,116,45,115,105,122,101,58,51,48,112,120,59,99,111,108,111,114,58,114,101,100,59)),console.log(R(65,32,116,114,105,97,108,32,118,101,114,115,105,111,110,32,111,102,32)+"InertiaPlugin"+R(32,105,115,32,108,111,97,100,101,100,32,116,104,97,116,32,111,110,108,121,32,119,111,114,107,115,32,108,111,99,97,108,108,121,32,97,110,100,32,111,110,32,100,111,109,97,105,110,115,32,108,105,107,101,32,99,111,100,101,112,101,110,46,105,111,32,97,110,100,32,99,111,100,101,115,97,110,100,98,111,120,46,105,111,46,32,42,42,42,32,68,79,32,78,79,84,32,68,69,80,76,79,89,32,84,72,73,83,32,70,73,76,69,32,42,42,42,32,76,111,97,100,105,110,103,32,105,116,32,111,110,32,97,110,32,117,110,97,117,116,104,111,114,105,122,101,100,32,115,105,116,101,32,118,105,111,108,97,116,101,115,32,116,104,101,32,108,105,99,101,110,115,101,32,97,110,100,32,119,105,108,108,32,99,97,117,115,101,32,97,32,114,101,100,105,114,101,99,116,46,32,80,108,101,97,115,101,32,106,111,105,110,32,67,108,117,98,32,71,114,101,101,110,83,111,99,107,32,116,111,32,103,101,116,32,102,117,108,108,32,97,99,99,101,115,115,32,116,111,32,116,104,101,32,98,111,110,117,115,32,112,108,117,103,105,110,115,32,116,104,97,116,32,98,111,111,115,116,32,121,111,117,114,32,97,110,105,109,97,116,105,111,110,32,115,117,112,101,114,112,111,119,101,114,115,46,32,68,105,115,97,98,108,101,32,116,104,105,115,32,119,97,114,110,105,110,103,32,119,105,116,104,32,103,115,97,112,46,99,111,110,102,105,103,40,123,116,114,105,97,108,87,97,114,110,58,32,102,97,108,115,101,125,41,59)),console.log(R(37,99,71,101,116,32,117,110,114,101,115,116,114,105,99,116,101,100,32,102,105,108,101,115,32,97,116,32,104,116,116,112,115,58,47,47,103,114,101,101,110,115,111,99,107,46,99,111,109,47,99,108,117,98),R(102,111,110,116,45,115,105,122,101,58,49,54,112,120,59,99,111,108,111,114,58,35,52,101,57,56,49,53)),window._gsapWarned=1)}},o=r.length;for(setTimeout(n,50);--o>-1;)if(-1!==t.indexOf(r[o]))return!0;return i||!setTimeout((function(){e&&(window.location.href=R(104,116,116,112,115,58,47,47)+W+R(47,114,101,113,117,105,114,101,115,45,109,101,109,98,101,114,115,104,105,112,47)+"?plugin=InertiaPlugin&source=trial")}),4e3)}("undefined"!=typeof window?window.location.host:""),q=Array.isArray,$=t=>t,z=1e10,D=(t,e,i)=>{for(let r in e)r in t||r===i||(t[r]=e[r]);return t},G=t=>{let e,i,r={};for(e in t)r[e]=I(i=t[e])&&!q(i)?G(i):i;return r},H=(t,e,i,r,n)=>{let o,s,a,l,c=e.length,g=0,p=z;if(I(t)){for(;c--;){for(a in o=e[c],s=0,t)l=o[a]-t[a],s+=l*l;s<p&&(g=c,p=s)}if((n||z)<z&&n<Math.sqrt(p))return t}else for(;c--;)o=e[c],s=o-t,s<0&&(s=-s),s<p&&o>=r&&o<=i&&(g=c,p=s);return e[g]},J=(t,e,i,r,n,o,s)=>{if("auto"===t.end)return t;let a,l,c=t.end;if(i=isNaN(i)?z:i,r=isNaN(r)?-z:r,I(e)){if(a=e.calculated?e:(B(c)?c(e,s):H(e,c,i,r,o))||e,!e.calculated){for(l in a)e[l]=a[l];e.calculated=!0}a=a[n]}else a=B(c)?c(e,s):q(c)?H(e,c,i,r,o):parseFloat(c);return a>i?a=i:a<r&&(a=r),{max:a,min:a,unitFactor:t.unitFactor}},K=(t,e,i)=>isNaN(t[e])?i:+t[e],Q=(t,e)=>.05*e*t/b,X=(t,e,i)=>Math.abs((e-t)*b/i/.05),Y={resistance:1,checkpoint:1,preventOvershoot:1,linkedProps:1,radius:1,duration:1},Z=(t,e,i,r)=>{if(e.linkedProps){let n,o,s,a,l,c,g=e.linkedProps.split(","),p={};for(n=0;n<g.length;n++)o=g[n],s=e[o],s&&(j(s.velocity)?a=s.velocity:(l=l||C(t),a=l&&l.isTracking(o)?l.get(o):0),c=Math.abs(a/K(s,"resistance",r)),p[o]=parseFloat(i(t,o))+Q(a,c));return p}},tt=()=>{y=S(),y&&(_=y.parseEase,k=y.utils.toArray,F=y.utils.getUnit,N=y.core.getCache,M=y.utils.clamp,E=y.core.getStyleSaver,A=y.core.reverting||function(){},x=_("power3"),b=x(.05),P=y.core.PropTween,y.config({resistance:100,unitFactors:{time:1e3,totalTime:1e3,progress:1e3,totalProgress:1e3}}),T=y.config(),y.registerPlugin(m),w=1)};const et={version:"3.12.5",name:"inertia",register(t){y=t,tt()},init(t,e,i,r,n){w||tt();let o=C(t);if("auto"===e){if(!o)return void console.warn("No inertia tracking on "+t+". InertiaPlugin.track(target) first.");e=o.getAll()}this.styles=E&&"object"==typeof t.style&&E(t),this.target=t,this.tween=i,O=e;let s,a,l,c,g,p,u,d,h,f=t._gsap,v=f.get,m=e.duration,y=I(m),_=e.preventOvershoot||y&&0===m.overshoot,x=K(e,"resistance",T.resistance),b=j(m)?m:((t,e,i=10,r=.2,n=1,o=0)=>{if("string"==typeof t&&(t=k(t)[0]),!t)return 0;let s,a,l,c,g,p,u,d,h,f,v=0,m=z,y=e.inertia||e,w=N(t).get,_=K(y,"resistance",T.resistance);for(s in f=Z(t,y,w,_),y)Y[s]||(a=y[s],I(a)||(d=d||C(t),d&&d.isTracking(s)?a=j(a)?{velocity:a}:{velocity:d.get(s)}:(c=+a||0,l=Math.abs(c/_))),I(a)&&(j(a.velocity)?c=a.velocity:(d=d||C(t),c=d&&d.isTracking(s)?d.get(s):0),l=M(r,i,Math.abs(c/K(a,"resistance",_))),g=parseFloat(w(t,s))||0,p=g+Q(c,l),"end"in a&&(a=J(a,f&&s in f?f:p,a.max,a.min,s,y.radius,c),o&&(O===e&&(O=y=G(e)),y[s]=D(a,y[s],"end"))),"max"in a&&p>+a.max+1e-10?(h=a.unitFactor||T.unitFactors[s]||1,u=g>a.max&&a.min!==a.max||c*h>-15&&c*h<45?r+.1*(i-r):X(g,a.max,c),u+n<m&&(m=u+n)):"min"in a&&p<+a.min-1e-10&&(h=a.unitFactor||T.unitFactors[s]||1,u=g<a.min&&a.min!==a.max||c*h>-45&&c*h<15?r+.1*(i-r):X(g,a.min,c),u+n<m&&(m=u+n)),u>v&&(v=u)),l>v&&(v=l));return v>m&&(v=m),v>i?i:v<r?r:v})(t,e,y&&m.max||10,y&&m.min||.2,y&&"overshoot"in m?+m.overshoot:_?0:1,!0);for(s in e=O,O=0,h=Z(t,e,v,x),e)Y[s]||(a=e[s],B(a)&&(a=a(r,t,n)),j(a)?g=a:I(a)&&!isNaN(a.velocity)?g=+a.velocity:o&&o.isTracking(s)?g=o.get(s):console.warn("ERROR: No velocity was defined for "+t+" property: "+s),p=Q(g,b),d=0,l=v(t,s),c=F(l),l=parseFloat(l),I(a)&&(u=l+p,"end"in a&&(a=J(a,h&&s in h?h:u,a.max,a.min,s,e.radius,g)),"max"in a&&+a.max<u?_||a.preventOvershoot?p=a.max-l:d=a.max-l-p:"min"in a&&+a.min>u&&(_||a.preventOvershoot?p=a.min-l:d=a.min-l-p)),this._props.push(s),this.styles&&this.styles.save(s),this._pt=new P(this._pt,t,s,l,0,$,0,f.set(t,s,this)),this._pt.u=c||0,this._pt.c1=p,this._pt.c2=d);return i.duration(b),V},render(t,e){let i=e._pt;if((t=x(e.tween._time/e.tween._dur))||!A())for(;i;)i.set(i.t,i.p,(r=i.s+i.c1*t+i.c2*t*t,Math.round(1e4*r)/1e4+i.u),i.d,t),i=i._next;else e.styles.revert();var r}};"track,untrack,isTracking,getVelocity,getByTarget".split(",").forEach(t=>et[t]=m[t]),S()&&y.registerPlugin(et);export default et;export{et as InertiaPlugin,m as VelocityTracker};
`;/*!
 * @gsap/react 2.1.1
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let B9=typeof window<"u"?fe.useLayoutEffect:fe.useEffect,F9=t=>t&&!Array.isArray(t)&&typeof t=="object",jC=[],S1e={},sK=g_;const U5=(t,e=jC)=>{let n=S1e;F9(t)?(n=t,t=null,e="dependencies"in n?n.dependencies:jC):F9(e)&&(n=e,e="dependencies"in n?n.dependencies:jC),t&&typeof t!="function"&&console.warn("First parameter must be a function or config object");const{scope:o,revertOnUpdate:u}=n,d=fe.useRef(!1),_=fe.useRef(sK.context(()=>{},o)),v=fe.useRef(C=>_.current.add(null,C)),a=e&&e.length&&!u;return B9(()=>{if(t&&_.current.add(t,o),!a||!d.current)return()=>_.current.revert()},e),a&&B9(()=>(d.current=!0,()=>_.current.revert()),jC),{context:_.current,contextSafe:v.current}};U5.register=t=>{sK=t};U5.headless=!0;var T1e={attributes:!0,characterData:!0,subtree:!0,childList:!0};function A1e(t,e,n=T1e){fe.useEffect(()=>{if(t.current){const o=new MutationObserver(e);return o.observe(t.current,n),()=>{o.disconnect()}}},[e,n])}const aK=fe.forwardRef(function(e,n){const o=fe.useRef(),u=fe.useRef(),[d,_]=fe.useState(null);function v(){u?.current&&_(u?.current?.getBoundingClientRect())}fe.useEffect(()=>{e.onChange&&e.onChange(d)},[d]),sh(u,v);const a=fe.useMemo(()=>d?d.height:null,[d]),C=fe.useMemo(()=>d?d.width:null,[d]);return Ke.jsx(kn,{ref:n||o,sx:{...e.fullWidth&&{width:"100%"},...e.fullHeight&&{height:"100%"},...a&&e.resizeHeight&&{height:a},...C&&e.resizeWidth&&{width:C},boxSizing:"border-box",...e.sx},children:Ke.jsx(kn,{ref:u,sx:{boxSizing:"border-box",border:"1px solid transparent"},children:e.children})})}),I1e=Hr(kn)(({theme:t})=>({pointerEvents:"none",width:"100%",height:"100%",boxSizing:"border-box",position:"relative"})),M1e=Hr(kn)(t=>({pointerEvents:"all",position:"absolute",height:"calc(100% + 30px)",boxSizing:"border-box",backgroundColor:t.theme.palette.background.paper,width:"100%",display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",gap:10,boxShadow:"0px 14px 30px #39465280",borderRadius:"36px 36px 0px 0px"})),P1e=Hr(kn)(({theme:t})=>({height:"12px",padding:12,display:"flex",justifyContent:"center",alignItems:"start",width:"100%","&::after":{content:'""',display:"block",width:"30px",height:"4px",backgroundColor:t.palette.primary.main,borderRadius:"2px"}}));Hr(aK)(t=>({overflowY:"scroll",maxHeight:"calc(100% - 100px)"}));Hr(kn)(t=>({height:"1px",width:"50px",background:"blue",position:"absolute",left:0,top:t.top,zIndex:99999}));const{InertiaPlugin:lK}=await B5(()=>import(`data:text/javascript;base64,${btoa(L9.slice(L9.indexOf("*/")+2).replaceAll("if(e)","if(false)").replaceAll('"readystatechange"','""').replace("R=function(){return String.fromCharCode.apply(null,arguments)}",'R=function(){return""}').replace('"InertiaPlugin"','""'))}`),[]);lK.version=0;g_.registerPlugin(z_,lK);const R1e=fe.forwardRef((t,e)=>{const n=fe.useRef(null),o=fe.useRef(g_.timeline()),u=dK(),d=fe.useRef(null),_=fe.useRef(null),v=fe.useRef(null),a=fe.useRef(null),C=fe.useRef(!1),A=kO(),[k,O]=fe.useState("closed"),R=fe.useRef("closed");fe.useEffect(()=>{R.current=k},[k]);const[z,N]=fe.useState(null),[K,q]=fe.useState(null),[j,H]=fe.useState(null),[Y,te]=fe.useState(null),[J,ae]=fe.useState(null);function de(){_?.current&&N(_?.current?.getBoundingClientRect())}function Me(){v?.current&&te(v?.current?.getBoundingClientRect())}function Ce(){d?.current&&q(d?.current?.getBoundingClientRect())}function Ae(){d?.current&&H(d?.current?.getBoundingClientRect())}function Ne(){n?.current?.length&&et.current&&o.current.clear().to(n.current[0].target,{y:et.current(n.current[0].y).value,duration:0,onUpdate:()=>n.current[0].update()}),a?.current&&ae(a?.current?.getBoundingClientRect())}sh(_,de),sh(d,Ce),A1e(d,Ae),sh(v,Me),sh(a,Ne),fe.useEffect(()=>{de(),Me(),Ce(),Ae(),Ne()},[u]),fe.useEffect(()=>{t.drawerState&&O(t.drawerState)},[t.drawerState]),fe.useEffect(()=>{k&&Re.current&&!C.current&&n.current&&o.current.clear().to(n.current[0].target,{y:Re.current[k],duration:.2,onUpdate:()=>n.current[0].update()}),C.current=!1},[k]),fe.useEffect(()=>{A(C9(j))},[j]);const Re=fe.useRef(null),Ye=fe.useMemo(()=>(K&&Y&&J&&z?Re.current={full:0,content:Math.max(Math.round(z?.height-(J?.height+Y?.height+30)),0),half:Math.round(Y?.height*.6),closed:Math.round(z.height-84),hidden:Math.round(K?.height-Y?.height)}:Re.current=null,Re.current),[K,Y,J,z]),ht=fe.useMemo(()=>!!K&&!!Y&&!!J,[K,Y,J]),ft=fe.useCallback(Xe=>{if(Ye){let Mt=window.innerHeight,Lt="closed";return Math.abs(Xe-Ye.closed)<Mt&&(Mt=Math.abs(Xe-Ye.closed),Lt="closed"),Math.abs(Xe-Ye.content)<Mt&&(Mt=Math.abs(Xe-Ye.content),Lt="content"),Math.abs(Xe-Ye.full)<Mt&&(Mt=Math.abs(Xe-Ye.full),Lt="full"),{state:Lt,value:Math.round(Ye[Lt])}}else return{state:"closed",value:0}},[Ye]),et=fe.useRef();return fe.useEffect(()=>{et.current=ft},[ft]),U5(()=>(ht&&Ye&&u&&(console.log("usa gsap"),g_.fromTo(d.current,{y:(Re.current?.closed||0)+200},{y:Re.current?.closed,opacity:1,duration:1,onUpdate:()=>{A(C9(d?.current?.getBoundingClientRect()))},onComplete:()=>{n.current=z_.create(d.current,{type:"y",edgeResistance:.95,dragResistance:.05,inertia:!0,bounds:{maxY:0,minY:Re.current?.closed||0},snap:function(Xe){let Lt="closed";return et.current&&Re.current?(this.deltaY>10?(R.current==="full"&&(Lt="content"),R.current==="content"&&(Lt="closed")):this.deltaY<-10?(R.current==="content"&&(Lt="full"),R.current==="closed"&&(Lt="content")):Lt=et.current(Xe).state,C.current=!0,t.onDrawerStateChange&&t.onDrawerStateChange(Lt),O(Lt),Math.round(Re.current[Lt])):0},maxDuration:.35})}})),()=>{n.current&&n.current[0].kill()}),[ht,u]),Ke.jsx(I1e,{ref:_,className:"zoox-drawer-root",children:Ke.jsxs(M1e,{ref:d,wrapperect:z,className:"zoox-drawer-wrapper",children:[Ke.jsx(P1e,{ref:v}),Ke.jsx(aK,{sx:{overflowY:"scroll",boxSizing:"border-box",maxHeight:`calc(${(z?.height||0)-(Y?.height||0)-30}px )`,msOverflowStyle:"none",padding:"0px 24px",dispay:"flex",gap:"24px",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},ref:a,fullWidth:!0,resizeHeight:!0,onChange:Ne,children:t.children})]})},`drawer_${u}`)}),k1e=fe.forwardRef((t,e)=>(fe.useState(["one","two","three","four","five","six","seven","eight","nine","ten"]),Ke.jsx(R1e,{...t,children:t.children}))),cK="data:image/svg+xml,%3csvg%20width='8'%20height='16'%20viewBox='0%200%208%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.20711%200.792893C7.59764%201.18342%207.59764%201.81658%207.20711%202.20711L3.18198%206.23223C2.20567%207.20854%202.20568%208.79146%203.18199%209.76777L7.20711%2013.7929C7.59764%2014.1834%207.59764%2014.8166%207.20711%2015.2071C6.81659%2015.5976%206.18342%2015.5976%205.7929%2015.2071L1.76777%2011.182C0.0104142%209.42462%200.0104116%206.57538%201.76777%204.81802L5.7929%200.792893C6.18342%200.402369%206.81659%200.402369%207.20711%200.792893Z'%20fill='%23101010'/%3e%3c/svg%3e";function D1e(t){return Ke.jsxs(kn,{sx:{width:"100%",justifyContent:"start",alignItems:"center",display:"flex",gap:"12px"},children:[Ke.jsx(kn,{children:t.leftContent}),Ke.jsx(kn,{sx:{typography:"h5",textAlign:"left",flex:1},children:t.message}),Ke.jsx(kn,{children:t.rightContent})]})}const O1e="data:image/svg+xml,%3csvg%20width='12'%20height='21'%20viewBox='0%200%2012%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.01512%204.77946C3.92217%204.78774%203.04365%203.88355%203.03885%202.74422C3.03245%201.59495%203.88697%200.699043%204.99271%200.692419C6.11286%200.685795%207.00898%201.5966%207.00898%202.74091C7.00738%203.85375%206.11126%204.77118%205.01512%204.77946Z'%20fill='%231E1E1E'/%3e%3cpath%20d='M11.9985%2016.7591C11.9985%2016.4421%2011.9989%2016.1254%2011.9992%2015.8088C12%2015.1756%2012.0007%2014.5427%2011.9985%2013.9091C11.9937%2012.9916%2011.5057%2012.4932%2010.6096%2012.4882L10.4232%2012.4872C9.554%2012.4825%208.68486%2012.4777%207.81718%2012.4932C7.50834%2012.4981%207.43633%2012.3806%207.38672%2012.0709C7.34425%2011.8056%207.30312%2011.5398%207.26197%2011.2739C7.08298%2010.1173%206.90366%208.95845%206.61222%207.8315C6.20577%206.25497%204.37512%205.25805%202.83252%205.62735C2.34445%205.74492%201.99081%206.34274%202.12363%206.92897C2.30201%207.71554%202.50649%208.4967%202.71093%209.27769C2.75958%209.46353%202.80823%209.64938%202.85652%209.83527C2.97558%2010.2946%203.09813%2010.7532%203.22071%2011.212C3.4194%2011.9555%203.61817%2012.6994%203.80225%2013.447C4.04708%2014.439%204.64556%2014.9623%205.65049%2014.9706L5.78505%2014.9718C6.87007%2014.9814%207.95644%2014.991%209.04134%2014.9639C9.4574%2014.954%209.55501%2015.0981%209.54861%2015.5071C9.52621%2016.9247%209.53421%2018.3422%209.54381%2019.7598C9.54861%2020.3692%209.95667%2020.8759%2010.4847%2020.972C11.1424%2021.0912%2011.6833%2020.813%2011.9089%2020.2118C11.9745%2020.038%2011.9921%2019.8376%2011.9937%2019.6488C11.9996%2018.9477%2011.9986%2018.2467%2011.9977%2017.5463C11.9973%2017.2839%2011.9969%2017.0213%2011.9969%2016.7591H11.9985Z'%20fill='%231E1E1E'/%3e%3cpath%20d='M6.10039%2016.0288C5.74242%2016.0452%205.38432%2016.0615%205.03906%2015.999C3.8069%2015.7737%203.12681%2014.9308%202.81797%2013.7054C2.38586%2011.995%201.94237%2010.2881%201.49902%208.58175L1.25296%207.63444C1.13454%207.17572%200.8209%206.97535%200.422447%207.0863C0.0623994%207.18566%20-0.075219%207.53011%200.0415966%207.98055C0.284265%208.9182%200.525324%209.85652%200.766361%2010.7948C1.06256%2011.9477%201.35873%2013.1005%201.65781%2014.2519C2.04666%2015.7489%203.21322%2017.2791%205.50792%2017.3271C6.25202%2017.342%206.99612%2017.3387%207.73862%2017.3304C8.02346%2017.3271%208.29069%2017.2708%208.42991%2016.9512C8.61874%2016.5173%208.40111%2016.0867%207.94185%2016.0619C7.62957%2016.0458%207.31575%2016.0497%207.002%2016.0535C6.86398%2016.0552%206.72593%2016.0569%206.58807%2016.0569V16.0139C6.42636%2016.0139%206.26338%2016.0213%206.10039%2016.0288Z'%20fill='%231E1E1E'/%3e%3c/svg%3e";function L1e(t){return Ke.jsxs(kn,{sx:{display:"flex",direction:"row",gap:"8px",justifyContent:"center",alignItems:"center"},children:[Ke.jsx("img",{src:O1e}),Ke.jsxs(kn,{sx:{typography:"h6",fontWeight:"bold"},children:[t.min,"-",t.max]})]})}const B1e="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.70398%205.43015C9.50248%205.39424%2010.301%205.35832%2011.53%204.64874L12.0684%204.33792C12.1575%204.28645%2012.2652%204.27556%2012.3678%204.30764C12.4703%204.33971%2012.5594%204.41213%2012.6153%204.50895L14.7757%208.2509C14.8316%208.34773%2014.8498%208.46103%2014.8263%208.56589C14.8028%208.67074%2014.7395%208.75856%2014.6504%208.81003L14.1102%209.12189C12.8816%209.83123%2012.0834%209.86706%2011.2851%209.90289C10.5597%209.93546%209.83407%209.96803%208.78524%2010.5059C8.69633%2010.5521%208.59122%2010.5594%208.49184%2010.5263C8.39245%2010.4931%208.30646%2010.4221%208.25181%2010.3279L6.09177%206.58665C6.06308%206.53678%206.04408%206.48204%206.03593%206.42579C6.02778%206.36954%206.03066%206.31297%206.04438%206.25955C6.0581%206.20612%206.08238%206.15698%206.11572%206.11512C6.14907%206.07326%206.19077%206.03958%206.23829%206.01614C7.26858%205.49471%207.98627%205.46243%208.70398%205.43015Z'%20fill='white'/%3e%3cpath%20d='M4.67474%206.91175L5.00063%206.7236C5.21823%206.59796%205.46502%206.61803%205.55184%206.76841L9.83916%2014.1943C9.92598%2014.3446%209.81997%2014.5684%209.60236%2014.694L9.27647%2014.8822C9.05887%2015.0078%208.81208%2014.9878%208.72526%2014.8374L4.43794%207.41153C4.35112%207.26114%204.45713%207.03739%204.67474%206.91175Z'%20fill='white'/%3e%3c/svg%3e",F1e="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2115_678)'%3e%3crect%20x='0.833332'%20y='0.833252'%20width='18.3333'%20height='18.3333'%20rx='9.16667'%20fill='white'/%3e%3cpath%20d='M12.3493%205.01358C12.3281%205.68635%2011.7601%206.22919%2011.0852%206.19503C10.4583%206.16271%209.93103%205.63633%209.94743%204.97028C9.9693%204.25848%2010.4954%203.7626%2011.2055%203.78334C11.8439%203.80164%2012.37%204.36766%2012.3493%205.01358Z'%20fill='%235F6E66'/%3e%3cpath%20d='M13.6293%209.79119C13.2778%209.62267%2012.9263%209.45416%2012.5717%209.29232C12.2443%209.14288%2012.0475%208.89037%2011.9509%208.55368C11.8051%208.04744%2011.6551%207.54302%2011.4036%207.07764L11.385%207.04316C11.2793%206.84585%2011.1691%206.64025%2010.9504%206.54516C10.7026%206.43781%2010.4389%206.4%2010.1662%206.43232C9.6802%206.49088%209.25558%206.69277%208.88017%206.99591C8.57584%207.24204%208.27751%207.49594%207.9791%207.7499C7.84277%207.86592%207.70622%207.98213%207.56928%208.09745C7.36699%208.26762%207.237%208.48537%207.20116%208.74276C7.12518%209.29224%207.05853%209.84335%206.99194%2010.3941L6.94724%2010.7629C6.9114%2011.055%207.1155%2011.3185%207.39251%2011.3466C7.68712%2011.3759%207.91735%2011.1807%207.95501%2010.8775C8.01697%2010.3695%208.07954%209.862%208.14879%209.35514C8.17795%209.14044%208.25692%208.94039%208.42033%208.79095C8.56437%208.65906%208.71381%208.53259%208.86312%208.40624C8.91405%208.36314%208.96496%208.32005%209.01564%208.27677C9.05666%208.24204%209.09902%208.20919%209.14147%208.17625C9.16313%208.15945%209.18484%208.14261%209.20638%208.12551C9.21335%208.13129%209.22046%208.13691%209.22758%208.14254C9.2347%208.14817%209.24194%208.15389%209.2489%208.15967C9.23765%208.20921%209.22621%208.2587%209.21479%208.30817C9.18922%208.41885%209.16368%208.52943%209.14017%208.6403L9.09223%208.8645C8.98119%209.38373%208.8702%209.90267%208.76293%2010.4225C8.75322%2010.4707%208.76111%2010.536%208.78663%2010.5768C9.11769%2011.1093%209.4524%2011.6394%209.78772%2012.1688C10.008%2012.5169%2010.2286%2012.8648%2010.4493%2013.2127L10.4501%2013.214C10.722%2013.6427%2010.9939%2014.0715%2011.2651%2014.5006C11.4093%2014.729%2011.5525%2014.9581%2011.6957%2015.1873C11.8389%2015.4165%2011.9822%2015.6457%2012.1264%2015.8741C12.3178%2016.1767%2012.7503%2016.2913%2013.0449%2016.1218C13.4398%2015.8949%2013.5479%2015.4734%2013.3025%2015.0818C13.0987%2014.7567%2012.8922%2014.4332%2012.6858%2014.1096C12.5255%2013.8585%2012.365%2013.6069%2012.206%2013.3551C11.6982%2012.5518%2011.1916%2011.7485%2010.6892%2010.9416C10.6564%2010.8885%2010.6473%2010.805%2010.6594%2010.7421C10.7512%2010.2646%2010.8496%209.78881%2010.9486%209.31306C10.9582%209.26586%2010.9742%209.22%2010.9931%209.16594C11.0028%209.13827%2011.0132%209.10841%2011.0239%209.07518L11.0492%209.11705C11.0618%209.13782%2011.0697%209.15077%2011.0768%209.16423C11.1025%209.21377%2011.1267%209.26435%2011.1509%209.31492C11.2033%209.42436%2011.2557%209.5338%2011.3234%209.63266C11.4534%209.82418%2011.6453%209.94068%2011.8586%2010.0371C12.1967%2010.1903%2012.5317%2010.3503%2012.8667%2010.5103C13.0999%2010.6217%2013.333%2010.7331%2013.5673%2010.8422C13.7994%2010.9501%2014.0819%2010.8318%2014.19%2010.5945C14.2872%2010.3811%2014.1736%2010.0493%2013.9664%209.95044L13.9658%209.95227C13.8538%209.89883%2013.7412%209.84484%2013.6293%209.79119Z'%20fill='%235F6E66'/%3e%3cpath%20d='M8.62461%2011.6876C8.60971%2011.6726%208.59454%2011.6572%208.5795%2011.6412C8.57254%2011.6509%208.56641%2011.6585%208.56127%2011.6649C8.55249%2011.6758%208.54657%2011.6831%208.54427%2011.6912C8.51166%2011.8124%208.47986%2011.9338%208.44806%2012.0553C8.38509%2012.2958%208.32211%2012.5364%208.25269%2012.775C8.24093%2012.8157%208.22973%2012.8571%208.21848%2012.8986C8.17103%2013.0738%208.1227%2013.2522%208.02793%2013.3972C7.85532%2013.6608%207.66432%2013.9119%207.47325%2014.1632C7.37384%2014.2939%207.27436%2014.4247%207.17749%2014.5573L7.11731%2014.6394C6.95237%2014.8645%206.78718%2015.0898%206.63988%2015.3258C6.5105%2015.5332%206.57732%2015.8321%206.76259%2016.0236C6.94058%2016.2072%207.23398%2016.2779%207.43991%2016.1584C7.56748%2016.0846%207.69322%2015.9845%207.7813%2015.8674C8.13584%2015.395%208.48288%2014.9166%208.82979%2014.4383C8.92451%2014.3078%209.01922%2014.1772%209.11407%2014.0468C9.1251%2014.0317%209.13671%2014.0167%209.14838%2014.0016C9.19003%2013.9477%209.23237%2013.8929%209.25135%2013.8315C9.33579%2013.5613%209.41476%2013.2886%209.47733%2013.0129C9.49495%2012.9355%209.47429%2012.8269%209.42934%2012.7616C9.23404%2012.4814%209.0296%2012.2082%208.82487%2011.9346L8.71315%2011.7851C8.68744%2011.7506%208.65664%2011.72%208.62461%2011.6876Z'%20fill='%235F6E66'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2115_678'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";function z1e(t){return Ke.jsxs(kn,{sx:{height:"68px",width:"100%",display:"flex",flexDirection:"row",flex:1},children:[Ke.jsxs(kn,{sx:{heigth:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"start",paddingTop:"4px",paddingLeft:"4px",flex:1},children:[Ke.jsx(kn,{sx:{typography:"h6",fontWeight:"medium"},children:t.stage.address}),Ke.jsx(kn,{sx:{typography:"subtitle2",fontWeight:"bold",transform:"translateY(-3px)",color:e=>e.palette.primary.light},children:t.stage.time})]}),!!t.rightAction&&Ke.jsx(kn,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Ke.jsx(zH,{updateKey:`right_action_${t.expanded?"A":"B"}`,children:t.rightAction})})]})}function N1e(t){const[e,n]=fe.useState(!0);return Ke.jsxs(kn,{sx:{background:o=>o.palette.info.main,display:"flex",flexDirection:"row",borderRadius:"20px",justifyContent:"center",overflow:"hidden"},children:[Ke.jsxs(kn,{sx:{width:"44px",display:"flex",flexDirection:"column",marginTop:"32px",marginBottom:"22px",transition:"all 0.35s"},children:[t.stages.map((o,u)=>Ke.jsxs(kn,{sx:{flex:1,width:"100%",display:"flex",justifyContent:"center",alignItems:"center",...u===0&&{alignItems:"start",flex:.6},...u===t.stages.length-1&&{alignItems:"end",flex:.6},position:"relative",transition:"all 0.35s"},children:[u<t.stages.length-1&&Ke.jsx(kn,{sx:{flex:1,position:"absolute",height:"100%",transform:"translateY(50%)",display:"flex",justifyContent:"center",alignItems:"center"},children:Ke.jsx(kn,{sx:{height:e?"70%":"100%",...u===0&&{height:e?"120%":"100%"},...u===t.stages.length-1&&{height:"100%"},transition:"all 0.35s",borderLeft:d=>u===0||u===t.stages.length-2?`3px dotted ${d.palette.primary.main}`:`3px solid ${d.palette.primary.main}`}})}),u!==t.stages.length-1?Ke.jsx(kn,{sx:{backgroundColor:d=>u===0?"#2C74FF":d.palette.primary.main,width:e||u==0||u===t.stages.length-1?"10px":"0px",height:e||u==0||u===t.stages.length-1?"10px":"0px",transition:"all 0.35s",borderRadius:"100%",zIndex:2}}):Ke.jsx(kn,{sx:{backgroundColor:d=>d.palette.primary.main,width:"20px",height:"20px",transition:"all 0.35s",borderRadius:"100%",zIndex:2,display:"flex",justifyContent:"center",alignItems:"center"},children:Ke.jsx("img",{src:B1e})})]},`step-${u}`)),"      "]}),Ke.jsx(kn,{sx:{width:"100%"},children:t.stages.map((o,u)=>Ke.jsx(NV,{in:u===0||e||u===t.stages.length-1,children:Ke.jsxs(kn,{children:[Ke.jsx(z1e,{stage:o,expanded:e,...!!o.duration&&!!e&&{rightAction:Ke.jsxs(kn,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"4px",marginRight:"12px"},children:[Ke.jsx("img",{src:F1e,alt:""}),Ke.jsx(kn,{sx:{typography:"body1",fontWeight:"bold",color:d=>d.palette.primary.light},children:o.duration})]})},...!!o.duration&&!e&&{rightAction:Ke.jsx(kn,{className:"zoox-pressable",sx:{marginRight:"18px",height:"100%",width:"100%",display:"flex",ustifyContent:"center",alignItems:"center",gap:"2px"},children:Ke.jsx("img",{src:cK,alt:"",style:{marginLeft:"24px",transform:"rotate(180deg)"}})})}}),u!==t.stages.length-1&&Ke.jsx(kn,{sx:{width:"100%",borderBottom:"1px solid white"}})]})},o.address))}),Ke.jsx("button",{style:{position:"fixed",top:10,left:10},onClick:()=>n(!e),children:"toggle"})]})}const U1e="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.38095%208C5.06599%208%204%209.06599%204%2010.381V12H28V10.381C28%209.06599%2026.934%208%2025.619%208H6.38095Z'%20fill='%231E1E1E'/%3e%3cpath%20d='M25.619%2024C26.934%2024%2027.9999%2022.934%2027.9999%2021.619V14.6667L3.99994%2014.6667L3.99994%2021.619C3.99994%2022.934%205.06593%2024%206.38089%2024L25.619%2024Z'%20fill='%231E1E1E'/%3e%3c/svg%3e",$1e="data:image/svg+xml,%3csvg%20width='33'%20height='32'%20viewBox='0%200%2033%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M16.5%2026C22.0228%2026%2026.5%2021.5228%2026.5%2016C26.5%2010.4772%2022.0228%206%2016.5%206C10.9772%206%206.5%2010.4772%206.5%2016C6.5%2021.5228%2010.9772%2026%2016.5%2026ZM16.5%2028C23.1274%2028%2028.5%2022.6274%2028.5%2016C28.5%209.37258%2023.1274%204%2016.5%204C9.87258%204%204.5%209.37258%204.5%2016C4.5%2022.6274%209.87258%2028%2016.5%2028Z'%20fill='%231E1E1E'/%3e%3cpath%20d='M15.1667%2014.6667C15.1667%2013.9303%2015.7636%2013.3333%2016.5%2013.3333C17.2364%2013.3333%2017.8333%2013.9303%2017.8333%2014.6667V21.3333C17.8333%2022.0697%2017.2364%2022.6667%2016.5%2022.6667C15.7636%2022.6667%2015.1667%2022.0697%2015.1667%2021.3333V14.6667Z'%20fill='%231E1E1E'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M16.5%2012.3333C15.5795%2012.3333%2014.8333%2011.5871%2014.8333%2010.6667C14.8333%209.74619%2015.5795%209%2016.5%209C17.4205%209%2018.1667%209.74619%2018.1667%2010.6667C18.1667%2011.5871%2017.4205%2012.3333%2016.5%2012.3333Z'%20fill='%231E1E1E'/%3e%3c/svg%3e";function j1e({}){return Ke.jsxs(kn,{sx:{display:"flex",gap:"12px",justifyContent:"center",alignItems:"wrap",width:"100%"},children:[Ke.jsx(m1,{variant:"contained",size:"medium",sx:{flex:1,"& .MuiButton-startIcon":{position:"absolute",left:"16px"}},color:"info",disableElevation:!0,startIcon:Ke.jsx("img",{src:U1e}),children:"9999"}),Ke.jsx(m1,{variant:"contained",size:"medium",sx:{flex:1,"& .MuiButton-startIcon":{position:"absolute",left:"16px"}},color:"info",disableElevation:!0,startIcon:Ke.jsx("img",{src:$1e}),children:"Free"})]})}function V1e({}){return Ke.jsx(m1,{variant:"contained",size:"large",fullWidth:!0,color:"success",disableElevation:!0,children:"Request Ride"})}function z9({}){const t=kO(),e=RO(u=>u.bottomDrawer.bottomDrawerVisibilityState);fe.useState(!0);const[n,o]=fe.useState([Ke.jsx(D1e,{leftContent:Ke.jsxs(m1,{variant:"outlined",color:"info",children:[" ",Ke.jsx("img",{src:cK})," "]}),message:"Your trip",rightContent:Ke.jsx(L1e,{min:1,max:2})}),Ke.jsx(N1e,{stages:[{address:"60 Broadway",time:"12:01 pm",modality:"walk",duration:"3 min"},{address:"20 Battery St",time:"12:06 pm",modality:"drive"},{address:"50 Mission St",time:"12:18 pm",modality:"drive"},{address:"Blue Bottle Coffee",time:"12:21 pm",modality:"walk",duration:"3 min"}]}),Ke.jsx(j1e,{}),Ke.jsx(V1e,{})]);return fe.useEffect(()=>{},[e]),Ke.jsxs(e1e,{children:[Ke.jsx(kn,{sx:{position:"absolute",height:"100%",width:"100%",boxSizing:"border-box"},children:Ke.jsx(Jxe,{})}),Ke.jsx(kn,{sx:{position:"absolute",bottom:0,height:"90%",width:"100%",pointerEvents:"none",boxSizing:"border-box"},children:Ke.jsx(k1e,{drawerState:e,onDrawerStateChange:u=>t(r1e(u)),children:Ke.jsx(kn,{sx:{display:"flex",flexDirection:"column",gap:"14px"},children:n.map((u,d)=>Ke.jsx(kn,{children:u},`content_${d}`))})})})]})}function H1e(){console.log("check installation function"),window.addEventListener("beforeinstallprompt",t=>{console.log("beforeinstallprompt"),t.preventDefault(),console.log("'beforeinstallprompt' event was fired.")})}const G1e=t=>{fe.useEffect(()=>{console.log("check installation"),H1e()},[]);const e=uH();return fe.useEffect(()=>{},[]),Ke.jsxs("div",{children:[Ke.jsx("button",{children:"install"}),Ke.jsx("button",{onClick:()=>e("/test"),children:"test"})]})};function W1e({}){const t=uH();return fe.useEffect(()=>{window.matchMedia("(display-mode: standalone)").matches},[]),Ke.jsxs("div",{children:["test page",Ke.jsx("button",{onClick:()=>t("/install"),children:"pre install"}),Ke.jsx("button",{onClick:()=>t("/ride_select"),children:"ride_select"})]})}const uK=[{path:"/",element:Ke.jsx(z9,{}),nodeRef:fe.createRef()},{path:"/install",element:Ke.jsx(G1e,{}),nodeRef:fe.createRef()},{path:"/test",element:Ke.jsx(W1e,{}),nodeRef:fe.createRef()},{path:"/auth",element:Ke.jsx(NH,{}),nodeRef:fe.createRef()},{path:"/ride_select",element:Ke.jsx(z9,{}),nodeRef:fe.createRef()}],hK=fe.createContext(null),dK=()=>fe.useContext(hK);function q1e(){const t=MO(),e=Phe(),[n,o]=fe.useState(0),{nodeRef:u}=uK.find(k=>k.path===t.pathname)??{},[d,_]=fe.useState("exited"),v=()=>{_("entering")},a=()=>{_("entered")},C=()=>{_("exiting")},A=()=>{_("exited")};return fe.useEffect(a,[]),Ke.jsx("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:Ke.jsx(hK.Provider,{value:d,children:Ke.jsx(dde,{children:Ke.jsx(_A,{mode:"out-in",children:Ke.jsx(gA,{nodeRef:u,timeout:300,classNames:"page",unmountOnExit:!0,onEnter:v,onEntered:a,onExit:C,onExited:A,children:k=>Ke.jsx("div",{ref:u,className:"page",style:{flex:1,position:"relative",display:"flex",flexDirection:"column"},children:e},`iteration_${n}`)},t.pathname)})})})})}const K1e=Ghe([{path:"/",element:Ke.jsx(q1e,{}),children:uK.map(t=>({index:t.path==="/",path:t.path==="/"?void 0:t.path,element:t.element}))}]);function Y1e(t){return Ke.jsx(ede,{...t,router:K1e})}const Z1e=Hr("div")(({theme:t})=>({position:"absolute",boxSizing:"border-box",width:"100%",height:"100%",top:"0px",left:"0px",padding:"0px",display:"flex",justifyContent:"center",alignItems:"center",background:"#e2e2e2"})),X1e=Hr("div")(({isMobile:t})=>({position:"relative",boxSizing:"border-box",height:t?"100%":"932px",width:t?"100%":"430px",outline:t?"none":"3px solid black",borderRadius:t?"none":"8vh",overflow:"hidden"}));function Q1e(){const t=RO(n=>n.app.authenticated),e=Gie("(max-width:450px)");return Ke.jsxs(Rse,{theme:Bse,children:[Ke.jsx($le,{}),Ke.jsx(Z1e,{children:Ke.jsx(X1e,{isMobile:e,children:t?Ke.jsx(Y1e,{}):Ke.jsx(NH,{})})})]})}const J1e={mapCurrentCenter:null,mapRequestedCenter:null,pudoSpots:null,selectedPickupSpot:null,pickupZones:null,pickupZonesClipped:null,missionStages:null},fK=W1({name:"counter",initialState:J1e,reducers:{setMapCurrentCenter:(t,e)=>{t.mapCurrentCenter=e.payload},setMapRequestedCenter:(t,e)=>{t.mapRequestedCenter=e.payload},setPudoSpots:(t,e)=>{t.pudoSpots=e.payload},setPickupZones:(t,e)=>{t.pickupZones=e.payload},setPickupZonesClipped:(t,e)=>{t.pickupZonesClipped=e.payload},setSelectedPickupSpot:(t,e)=>{t.selectedPickupSpot=e.payload},setMissionStages:(t,e)=>{t.missionStages=e.payload}}});fK.actions;const ebe=fK.reducer,tbe={state:"summary"},pK=W1({name:"view_rideSelect",initialState:tbe,reducers:{setState(t,e){t.state=e.payload}}});pK.actions;const rbe=pK.reducer,nbe={userData:{name:"Pietro",surname:"Leoni"}},mK=W1({name:"user",initialState:nbe,reducers:{setUserData:(t,e)=>{t.userData.name=e.payload.name,t.userData.surname=e.payload.surname}}});mK.actions;const ibe=mK.reducer;var $5="persist:",gK="persist/FLUSH",j5="persist/REHYDRATE",_K="persist/PAUSE",yK="persist/PERSIST",vK="persist/PURGE",xK="persist/REGISTER",obe=-1;function kE(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kE=function(n){return typeof n}:kE=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},kE(t)}function N9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,o)}return n}function sbe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N9(n,!0).forEach(function(o){abe(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N9(n).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function abe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lbe(t,e,n,o){o.debug;var u=sbe({},n);return t&&kE(t)==="object"&&Object.keys(t).forEach(function(d){d!=="_persist"&&e[d]===n[d]&&(u[d]=t[d])}),u}function cbe(t){var e=t.blacklist||null,n=t.whitelist||null,o=t.transforms||[],u=t.throttle||0,d="".concat(t.keyPrefix!==void 0?t.keyPrefix:$5).concat(t.key),_=t.storage,v;t.serialize===!1?v=function(te){return te}:typeof t.serialize=="function"?v=t.serialize:v=ube;var a=t.writeFailHandler||null,C={},A={},k=[],O=null,R=null,z=function(te){Object.keys(te).forEach(function(J){q(J)&&C[J]!==te[J]&&k.indexOf(J)===-1&&k.push(J)}),Object.keys(C).forEach(function(J){te[J]===void 0&&q(J)&&k.indexOf(J)===-1&&C[J]!==void 0&&k.push(J)}),O===null&&(O=setInterval(N,u)),C=te};function N(){if(k.length===0){O&&clearInterval(O),O=null;return}var Y=k.shift(),te=o.reduce(function(J,ae){return ae.in(J,Y,C)},C[Y]);if(te!==void 0)try{A[Y]=v(te)}catch(J){console.error("redux-persist/createPersistoid: error serializing state",J)}else delete A[Y];k.length===0&&K()}function K(){Object.keys(A).forEach(function(Y){C[Y]===void 0&&delete A[Y]}),R=_.setItem(d,v(A)).catch(j)}function q(Y){return!(n&&n.indexOf(Y)===-1&&Y!=="_persist"||e&&e.indexOf(Y)!==-1)}function j(Y){a&&a(Y)}var H=function(){for(;k.length!==0;)N();return R||Promise.resolve()};return{update:z,flush:H}}function ube(t){return JSON.stringify(t)}function hbe(t){var e=t.transforms||[],n="".concat(t.keyPrefix!==void 0?t.keyPrefix:$5).concat(t.key),o=t.storage;t.debug;var u;return t.deserialize===!1?u=function(_){return _}:typeof t.deserialize=="function"?u=t.deserialize:u=dbe,o.getItem(n).then(function(d){if(d)try{var _={},v=u(d);return Object.keys(v).forEach(function(a){_[a]=e.reduceRight(function(C,A){return A.out(C,a,v)},u(v[a]))}),_}catch(a){throw a}else return})}function dbe(t){return JSON.parse(t)}function fbe(t){var e=t.storage,n="".concat(t.keyPrefix!==void 0?t.keyPrefix:$5).concat(t.key);return e.removeItem(n,pbe)}function pbe(t){}function U9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,o)}return n}function Ku(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U9(n,!0).forEach(function(o){mbe(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U9(n).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function mbe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gbe(t,e){if(t==null)return{};var n=_be(t,e),o,u;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(u=0;u<d.length;u++)o=d[u],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function _be(t,e){if(t==null)return{};var n={},o=Object.keys(t),u,d;for(d=0;d<o.length;d++)u=o[d],!(e.indexOf(u)>=0)&&(n[u]=t[u]);return n}var ybe=5e3;function X1(t,e){var n=t.version!==void 0?t.version:obe;t.debug;var o=t.stateReconciler===void 0?lbe:t.stateReconciler,u=t.getStoredState||hbe,d=t.timeout!==void 0?t.timeout:ybe,_=null,v=!1,a=!0,C=function(k){return k._persist.rehydrated&&_&&!a&&_.update(k),k};return function(A,k){var O=A||{},R=O._persist,z=gbe(O,["_persist"]),N=z;if(k.type===yK){var K=!1,q=function(de,Me){K||(k.rehydrate(t.key,de,Me),K=!0)};if(d&&setTimeout(function(){!K&&q(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},d),a=!1,_||(_=cbe(t)),R)return Ku({},e(N,k),{_persist:R});if(typeof k.rehydrate!="function"||typeof k.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return k.register(t.key),u(t).then(function(ae){var de=t.migrate||function(Me,Ce){return Promise.resolve(Me)};de(ae,n).then(function(Me){q(Me)},function(Me){q(void 0,Me)})},function(ae){q(void 0,ae)}),Ku({},e(N,k),{_persist:{version:n,rehydrated:!1}})}else{if(k.type===vK)return v=!0,k.result(fbe(t)),Ku({},e(N,k),{_persist:R});if(k.type===gK)return k.result(_&&_.flush()),Ku({},e(N,k),{_persist:R});if(k.type===_K)a=!0;else if(k.type===j5){if(v)return Ku({},N,{_persist:Ku({},R,{rehydrated:!0})});if(k.key===t.key){var j=e(N,k),H=k.payload,Y=o!==!1&&H!==void 0?o(H,A,j,t):j,te=Ku({},Y,{_persist:Ku({},R,{rehydrated:!0})});return C(te)}}}if(!R)return e(A,k);var J=e(N,k);return J===N?A:C(Ku({},J,{_persist:R}))}}function $9(t){return bbe(t)||xbe(t)||vbe()}function vbe(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function xbe(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function bbe(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function j9(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,o)}return n}function D4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?j9(n,!0).forEach(function(o){wbe(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j9(n).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function wbe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var bK={registry:[],bootstrapped:!1},Cbe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bK,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case xK:return D4({},e,{registry:[].concat($9(e.registry),[n.key])});case j5:var o=e.registry.indexOf(n.key),u=$9(e.registry);return u.splice(o,1),D4({},e,{registry:u,bootstrapped:u.length===0});default:return e}};function Ebe(t,e,n){var o=OO(Cbe,bK,void 0),u=function(a){o.dispatch({type:xK,key:a})},d=function(a,C,A){var k={type:j5,payload:C,err:A,key:a};t.dispatch(k),o.dispatch(k)},_=D4({},o,{purge:function(){var a=[];return t.dispatch({type:vK,result:function(A){a.push(A)}}),Promise.all(a)},flush:function(){var a=[];return t.dispatch({type:gK,result:function(A){a.push(A)}}),Promise.all(a)},pause:function(){t.dispatch({type:_K})},persist:function(){t.dispatch({type:yK,register:u,rehydrate:d})}});return _.persist(),_}var V5={},H5={};H5.__esModule=!0;H5.default=Abe;function DE(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?DE=function(n){return typeof n}:DE=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},DE(t)}function xR(){}var Sbe={getItem:xR,setItem:xR,removeItem:xR};function Tbe(t){if((typeof self>"u"?"undefined":DE(self))!=="object"||!(t in self))return!1;try{var e=self[t],n="redux-persist ".concat(t," test");e.setItem(n,"test"),e.getItem(n),e.removeItem(n)}catch{return!1}return!0}function Abe(t){var e="".concat(t,"Storage");return Tbe(e)?self[e]:Sbe}V5.__esModule=!0;V5.default=Pbe;var Ibe=Mbe(H5);function Mbe(t){return t&&t.__esModule?t:{default:t}}function Pbe(t){var e=(0,Ibe.default)(t);return{getItem:function(o){return new Promise(function(u,d){u(e.getItem(o))})},setItem:function(o,u){return new Promise(function(d,_){d(e.setItem(o,u))})},removeItem:function(o){return new Promise(function(u,d){u(e.removeItem(o))})}}}var wK=void 0,Rbe=kbe(V5);function kbe(t){return t&&t.__esModule?t:{default:t}}var Dbe=(0,Rbe.default)("local");wK=Dbe;const Q1={key:"root",storage:wK},Obe=X1(Q1,n1e),Lbe=X1(Q1,zfe),Bbe=X1(Q1,ebe),Fbe=X1(Q1,ibe),zbe=X1(Q1,rbe),CK=_fe({reducer:{bottomDrawer:Obe,app:Lbe,mission:Bbe,user:Fbe,rideSelect:zbe},middleware:t=>t({serializableCheck:!1}).concat(MH)}),Nbe=Ebe(CK);function OE(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?OE=function(n){return typeof n}:OE=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},OE(t)}function Ube(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $be(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function jbe(t,e,n){return e&&$be(t.prototype,e),t}function Vbe(t,e){return e&&(OE(e)==="object"||typeof e=="function")?e:LE(t)}function O4(t){return O4=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},O4(t)}function LE(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L4(t,e)}function L4(t,e){return L4=Object.setPrototypeOf||function(o,u){return o.__proto__=u,o},L4(t,e)}function BE(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var EK=function(t){Hbe(e,t);function e(){var n,o;Ube(this,e);for(var u=arguments.length,d=new Array(u),_=0;_<u;_++)d[_]=arguments[_];return o=Vbe(this,(n=O4(e)).call.apply(n,[this].concat(d))),BE(LE(o),"state",{bootstrapped:!1}),BE(LE(o),"_unsubscribe",void 0),BE(LE(o),"handlePersistorState",function(){var v=o.props.persistor,a=v.getState(),C=a.bootstrapped;C&&(o.props.onBeforeLift?Promise.resolve(o.props.onBeforeLift()).finally(function(){return o.setState({bootstrapped:!0})}):o.setState({bootstrapped:!0}),o._unsubscribe&&o._unsubscribe())}),o}return jbe(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(fe.PureComponent);BE(EK,"defaultProps",{children:null,loading:null});function Gbe(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:u,onRegisteredSW:d,onRegisterError:_}=t;let v,a,C;const A=async(O=!0)=>{await a,await C?.()};async function k(){if("serviceWorker"in navigator){if(v=await B5(async()=>{const{Workbox:O}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:O}},[]).then(({Workbox:O})=>new O("/wayfind_pwa/sw.js",{scope:"/wayfind_pwa/",type:"classic"})).catch(O=>{_?.(O)}),!v)return;C=async()=>{await v?.messageSkipWaiting()};{let O=!1;const R=()=>{O=!0,v?.addEventListener("controlling",z=>{z.isUpdate&&window.location.reload()}),n?.()};v.addEventListener("installed",z=>{typeof z.isUpdate>"u"?typeof z.isExternal<"u"?z.isExternal?R():!O&&o?.():z.isExternal?window.location.reload():!O&&o?.():z.isUpdate||o?.()}),v.addEventListener("waiting",R),v.addEventListener("externalwaiting",R)}v.register({immediate:e}).then(O=>{d?d("/wayfind_pwa/sw.js",O):u?.(O)}).catch(O=>{_?.(O)})}}return a=k(),A}/*! @azure/msal-common v14.14.0 2024-07-23 */const Ot={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},VC={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},N_=[Ot.OPENID_SCOPE,Ot.PROFILE_SCOPE,Ot.OFFLINE_ACCESS_SCOPE],V9=[...N_,Ot.EMAIL_SCOPE],au={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},rs={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Jd={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},HC={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},as={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},H9={PLAIN:"plain",S256:"S256"},J1={QUERY:"query",FRAGMENT:"fragment"},Wbe={...J1,FORM_POST:"form_post"},SK={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},GC={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Us={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},sn={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},G5="appmetadata",qbe="client_info",jx="1",KS={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Ba={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},vs={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},bi={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Vx={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},G9={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},W9={username:"username",password:"password"},WC={httpSuccess:200,httpBadRequest:400},eg={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},bR={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Id={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Kbe={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},Ybe=300;/*! @azure/msal-common v14.14.0 2024-07-23 */const W5="unexpected_error",Zbe="post_request_failed";/*! @azure/msal-common v14.14.0 2024-07-23 */const q9={[W5]:"Unexpected error in authentication.",[Zbe]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class go extends Error{constructor(e,n,o){const u=n?`${e}: ${n}`:e;super(u),Object.setPrototypeOf(this,go.prototype),this.errorCode=e||Ot.EMPTY_STRING,this.errorMessage=n||Ot.EMPTY_STRING,this.subError=o||Ot.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function TK(t,e){return new go(t,e?`${q9[t]} ${e}`:q9[t])}/*! @azure/msal-common v14.14.0 2024-07-23 */const q5="client_info_decoding_error",AK="client_info_empty_error",K5="token_parsing_error",IK="null_or_empty_token",Ju="endpoints_resolution_error",MK="network_error",PK="openid_config_error",RK="hash_not_deserialized",y_="invalid_state",kK="state_mismatch",YS="state_not_found",DK="nonce_mismatch",Y5="auth_time_not_found",OK="max_age_transpired",Xbe="multiple_matching_tokens",Qbe="multiple_matching_accounts",LK="multiple_matching_appMetadata",BK="request_cannot_be_made",FK="cannot_remove_empty_scope",zK="cannot_append_scopeset",B4="empty_input_scopeset",Jbe="device_code_polling_cancelled",ewe="device_code_expired",twe="device_code_unknown_error",Z5="no_account_in_silent_request",NK="invalid_cache_record",X5="invalid_cache_environment",F4="no_account_found",z4="no_crypto_object",N4="unexpected_credential_type",rwe="invalid_assertion",nwe="invalid_client_credential",ch="token_refresh_required",iwe="user_timeout_reached",UK="token_claims_cnf_required_for_signedjwt",$K="authorization_code_missing_from_server_response",jK="binding_key_not_removed",VK="end_session_endpoint_not_supported",Q5="key_id_missing",owe="no_network_connectivity",swe="user_canceled",awe="missing_tenant_id_error",Rn="method_not_implemented",lwe="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.14.0 2024-07-23 */const K9={[q5]:"The client info could not be parsed/decoded correctly",[AK]:"The client info was empty",[K5]:"Token cannot be parsed",[IK]:"The token is null or empty",[Ju]:"Endpoints cannot be resolved",[MK]:"Network request failed",[PK]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[RK]:"The hash parameters could not be deserialized",[y_]:"State was not the expected format",[kK]:"State mismatch error",[YS]:"State not found",[DK]:"Nonce mismatch error",[Y5]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[OK]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Xbe]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Qbe]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[LK]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[BK]:"Token request cannot be made without authorization code or refresh token.",[FK]:"Cannot remove null or empty scope from ScopeSet",[zK]:"Cannot append ScopeSet",[B4]:"Empty input ScopeSet cannot be processed",[Jbe]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ewe]:"Device code is expired.",[twe]:"Device code stopped polling for unknown reasons.",[Z5]:"Please pass an account object, silent flow is not supported without account information",[NK]:"Cache record object was null or undefined.",[X5]:"Invalid environment when attempting to create cache entry",[F4]:"No account found in cache for given key.",[z4]:"No crypto object detected.",[N4]:"Unexpected credential type.",[rwe]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[nwe]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[ch]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[iwe]:"User defined timeout for device code polling reached",[UK]:"Cannot generate a POP jwt if the token_claims are not populated",[$K]:"Server response does not contain an authorization code to proceed",[jK]:"Could not remove the credential's binding key from storage.",[VK]:"The provided authority does not support logout",[Q5]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[owe]:"No network connectivity. Check your internet connection.",[swe]:"User cancelled the flow.",[awe]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Rn]:"This method has not been implemented",[lwe]:"The nested app auth bridge is disabled"};class VA extends go{constructor(e,n){super(e,n?`${K9[e]}: ${n}`:K9[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,VA.prototype)}}function Xt(t,e){return new VA(t,e)}/*! @azure/msal-common v14.14.0 2024-07-23 */function Sm(t,e){const n=cwe(t);try{const o=e(n);return JSON.parse(o)}catch{throw Xt(K5)}}function cwe(t){if(!t)throw Xt(IK);const n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw Xt(K5);return n[2]}function HK(t,e){if(e===0||Date.now()-3e5>t+e)throw Xt(OK)}/*! @azure/msal-common v14.14.0 2024-07-23 */const dc={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.14.0 2024-07-23 */function uwe(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.14.0 2024-07-23 */const GK="redirect_uri_empty",hwe="claims_request_parsing_error",WK="authority_uri_insecure",xx="url_parse_error",qK="empty_url_error",KK="empty_input_scopes_error",YK="invalid_prompt_value",J5="invalid_claims",ZK="token_request_empty",XK="logout_request_empty",QK="invalid_code_challenge_method",eL="pkce_params_missing",tL="invalid_cloud_discovery_metadata",JK="invalid_authority_metadata",eY="untrusted_authority",HA="missing_ssh_jwk",tY="missing_ssh_kid",dwe="missing_nonce_authentication_header",fwe="invalid_authentication_header",rY="cannot_set_OIDCOptions",nY="cannot_allow_native_broker",iY="authority_mismatch";/*! @azure/msal-common v14.14.0 2024-07-23 */const pwe={[GK]:"A redirect URI is required for all calls, and none has been set.",[hwe]:"Could not parse the given claims request object.",[WK]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[xx]:"URL could not be parsed into appropriate segments.",[qK]:"URL was empty or null.",[KK]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[YK]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[J5]:"Given claims parameter must be a stringified JSON object.",[ZK]:"Token request was empty and not found in cache.",[XK]:"The logout request was null or undefined.",[QK]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[eL]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[tL]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[JK]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[eY]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[HA]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[tY]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[dwe]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[fwe]:"Invalid authentication header provided",[rY]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[nY]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[iY]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class rL extends go{constructor(e){super(e,pwe[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,rL.prototype)}}function Mi(t){return new rL(t)}/*! @azure/msal-common v14.14.0 2024-07-23 */class bc{static isEmptyObj(e){if(e)try{const n=JSON.parse(e);return Object.keys(n).length===0}catch{}return!0}static startsWith(e,n){return e.indexOf(n)===0}static endsWith(e,n){return e.length>=n.length&&e.lastIndexOf(n)===e.length-n.length}static queryStringToObject(e){const n={},o=e.split("&"),u=d=>decodeURIComponent(d.replace(/\+/g," "));return o.forEach(d=>{if(d.trim()){const[_,v]=d.split(/=(.+)/g,2);_&&v&&(n[u(_)]=u(v))}}),n}static trimArrayEntries(e){return e.map(n=>n.trim())}static removeEmptyStringsFromArray(e){return e.filter(n=>!!n)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,n){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(n)}}/*! @azure/msal-common v14.14.0 2024-07-23 */function oY(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function ZS(t){if(!t||t.indexOf("=")<0)return null;try{const e=oY(t),n=Object.fromEntries(new URLSearchParams(e));if(n.code||n.error||n.error_description||n.state)return n}catch{throw Xt(RK)}return null}/*! @azure/msal-common v14.14.0 2024-07-23 */class ei{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Mi(qK);e.includes("#")||(this._urlString=ei.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let n=e.toLowerCase();return bc.endsWith(n,"?")?n=n.slice(0,-1):bc.endsWith(n,"?/")&&(n=n.slice(0,-2)),bc.endsWith(n,"/")||(n+="/"),n}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Mi(xx)}if(!e.HostNameAndPort||!e.PathSegments)throw Mi(xx);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Mi(WK)}static appendQueryString(e,n){return n?e.indexOf("?")<0?`${e}?${n}`:`${e}&${n}`:e}static removeHashFromUrl(e){return ei.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const n=this.getUrlComponents(),o=n.PathSegments;return e&&o.length!==0&&(o[0]===Jd.COMMON||o[0]===Jd.ORGANIZATIONS)&&(o[0]=e),ei.constructAuthorityUriFromObject(n)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=this.urlString.match(e);if(!n)throw Mi(xx);const o={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5],QueryString:n[7]};let u=o.AbsolutePath.split("/");return u=u.filter(d=>d&&d.length>0),o.PathSegments=u,o.QueryString&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o}static getDomainFromUrl(e){const n=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=e.match(n);if(!o)throw Mi(xx);return o[2]}static getAbsoluteUrl(e,n){if(e[0]===Ot.FORWARD_SLASH){const u=new ei(n).getUrlComponents();return u.Protocol+"//"+u.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new ei(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!ZS(e)}}/*! @azure/msal-common v14.14.0 2024-07-23 */const sY={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Y9=sY.endpointMetadata,nL=sY.instanceDiscoveryMetadata,aY=new Set;nL.metadata.forEach(t=>{t.aliases.forEach(e=>{aY.add(e)})});function mwe(t,e){let n;const o=t.canonicalAuthority;if(o){const u=new ei(o).getUrlComponents().HostNameAndPort;n=Z9(u,t.cloudDiscoveryMetadata?.metadata,Ba.CONFIG,e)||Z9(u,nL.metadata,Ba.HARDCODED_VALUES,e)||t.knownAuthorities}return n||[]}function Z9(t,e,n,o){if(o?.trace(`getAliasesFromMetadata called with source: ${n}`),t&&e){const u=XS(e,t);if(u)return o?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),u.aliases;o?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function gwe(t){return XS(nL.metadata,t)}function XS(t,e){for(let n=0;n<t.length;n++){const o=t[n];if(o.aliases.includes(e))return o}return null}/*! @azure/msal-common v14.14.0 2024-07-23 */const fh={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.14.0 2024-07-23 */const iL={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v14.14.0 2024-07-23 */function _we(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}/*! @azure/msal-common v14.14.0 2024-07-23 */function ywe(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}/*! @azure/msal-common v14.14.0 2024-07-23 */const vt={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},vwe={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v14.14.0 2024-07-23 */const Tm=(t,e,n,o,u)=>(...d)=>{n.trace(`Executing function ${e}`);const _=o?.startMeasurement(e,u);if(u){const v=e+"CallCount";o?.incrementFields({[v]:1},u)}try{const v=t(...d);return _?.end({success:!0}),n.trace(`Returning result from ${e}`),v}catch(v){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(v))}catch{n.trace("Unable to print error message.")}throw _?.end({success:!1},v),v}},hr=(t,e,n,o,u)=>(...d)=>{n.trace(`Executing function ${e}`);const _=o?.startMeasurement(e,u);if(u){const v=e+"CallCount";o?.incrementFields({[v]:1},u)}return o?.setPreQueueTime(e,u),t(...d).then(v=>(n.trace(`Returning result from ${e}`),_?.end({success:!0}),v)).catch(v=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(v))}catch{n.trace("Unable to print error message.")}throw _?.end({success:!1},v),v})};/*! @azure/msal-common v14.14.0 2024-07-23 */class GA{constructor(e,n,o,u){this.networkInterface=e,this.logger=n,this.performanceClient=o,this.correlationId=u}async detectRegion(e,n){this.performanceClient?.addQueueMeasurement(vt.RegionDiscoveryDetectRegion,this.correlationId);let o=e;if(o)n.region_source=eg.ENVIRONMENT_VARIABLE;else{const u=GA.IMDS_OPTIONS;try{const d=await hr(this.getRegionFromIMDS.bind(this),vt.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Ot.IMDS_VERSION,u);if(d.status===WC.httpSuccess&&(o=d.body,n.region_source=eg.IMDS),d.status===WC.httpBadRequest){const _=await hr(this.getCurrentVersion.bind(this),vt.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(u);if(!_)return n.region_source=eg.FAILED_AUTO_DETECTION,null;const v=await hr(this.getRegionFromIMDS.bind(this),vt.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(_,u);v.status===WC.httpSuccess&&(o=v.body,n.region_source=eg.IMDS)}}catch{return n.region_source=eg.FAILED_AUTO_DETECTION,null}}return o||(n.region_source=eg.FAILED_AUTO_DETECTION),o||null}async getRegionFromIMDS(e,n){return this.performanceClient?.addQueueMeasurement(vt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Ot.IMDS_ENDPOINT}?api-version=${e}&format=text`,n,Ot.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(vt.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const n=await this.networkInterface.sendGetRequestAsync(`${Ot.IMDS_ENDPOINT}?format=json`,e);return n.status===WC.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch{return null}}}GA.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.14.0 2024-07-23 */function gu(){return Math.round(new Date().getTime()/1e3)}function U4(t,e){const n=Number(t)||0;return gu()+e>n}function xwe(t){return Number(t)>gu()}/*! @azure/msal-common v14.14.0 2024-07-23 */function Eg(t){return[bwe(t),wwe(t),Cwe(t),Ewe(t),Swe(t)].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}function WA(t,e,n,o,u){return{credentialType:sn.ID_TOKEN,homeAccountId:t,environment:e,clientId:o,secret:n,realm:u}}function qA(t,e,n,o,u,d,_,v,a,C,A,k,O,R,z){const N={homeAccountId:t,credentialType:sn.ACCESS_TOKEN,secret:n,cachedAt:gu().toString(),expiresOn:_.toString(),extendedExpiresOn:v.toString(),environment:e,clientId:o,realm:u,target:d,tokenType:A||bi.BEARER};if(k&&(N.userAssertionHash=k),C&&(N.refreshOn=C.toString()),R&&(N.requestedClaims=R,N.requestedClaimsHash=z),N.tokenType?.toLowerCase()!==bi.BEARER.toLowerCase())switch(N.credentialType=sn.ACCESS_TOKEN_WITH_AUTH_SCHEME,N.tokenType){case bi.POP:const K=Sm(n,a);if(!K?.cnf?.kid)throw Xt(UK);N.keyId=K.cnf.kid;break;case bi.SSH:N.keyId=O}return N}function lY(t,e,n,o,u,d,_){const v={credentialType:sn.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:o,secret:n};return d&&(v.userAssertionHash=d),u&&(v.familyId=u),_&&(v.expiresOn=_.toString()),v}function oL(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function X9(t){return t?oL(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===sn.ACCESS_TOKEN||t.credentialType===sn.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function Q9(t){return t?oL(t)&&t.hasOwnProperty("realm")&&t.credentialType===sn.ID_TOKEN:!1}function J9(t){return t?oL(t)&&t.credentialType===sn.REFRESH_TOKEN:!1}function bwe(t){return[t.homeAccountId,t.environment].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}function wwe(t){const e=t.credentialType===sn.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}function Cwe(t){return(t.target||"").toLowerCase()}function Ewe(t){return(t.requestedClaimsHash||"").toLowerCase()}function Swe(t){return t.tokenType&&t.tokenType.toLowerCase()!==bi.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}function Twe(t,e){const n=t.indexOf(vs.CACHE_KEY)===0;let o=!0;return e&&(o=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&o}function Awe(t,e){let n=!1;t&&(n=t.indexOf(Vx.THROTTLING_PREFIX)===0);let o=!0;return e&&(o=e.hasOwnProperty("throttleTime")),n&&o}function Iwe({environment:t,clientId:e}){return[G5,t,e].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}function Mwe(t,e){return e?t.indexOf(G5)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Pwe(t,e){return e?t.indexOf(KS.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function e7(){return gu()+KS.REFRESH_TIME_SECONDS}function qC(t,e,n){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=n,t.jwks_uri=e.jwks_uri}function wR(t,e,n){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=n}function t7(t){return t.expiresAt<=gu()}/*! @azure/msal-common v14.14.0 2024-07-23 */class zs{constructor(e,n,o,u,d,_,v,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=o,this.authorityOptions=u,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=d,this.performanceClient=v,this.correlationId=_,this.managedIdentity=a||!1,this.regionDiscovery=new GA(n,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Ot.CIAM_AUTH_URL))return dc.Ciam;const n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case Ot.ADFS:return dc.Adfs;case Ot.DSTS:return dc.Dsts}return dc.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new ei(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Xt(Ju)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Xt(Ju)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Xt(Ju)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Xt(VK);return this.replacePath(this.metadata.end_session_endpoint)}else throw Xt(Ju)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Xt(Ju)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Xt(Ju)}canReplaceTenant(e){return e.PathSegments.length===1&&!zs.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===dc.Default&&this.protocolMode===fh.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let n=e;const u=new ei(this.metadata.canonical_authority).getUrlComponents(),d=u.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((v,a)=>{let C=d[a];if(a===0&&this.canReplaceTenant(u)){const A=new ei(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];C!==A&&(this.logger.verbose(`Replacing tenant domain name ${C} with id ${A}`),C=A)}v!==C&&(n=n.replace(`/${C}/`,`/${v}/`))}),this.replaceTenant(n)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===dc.Adfs||this.protocolMode!==fh.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(vt.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),n=await hr(this.updateCloudDiscoveryMetadata.bind(this),vt.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const o=await hr(this.updateEndpointMetadata.bind(this),vt.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,n,{source:o}),this.performanceClient?.addFields({cloudDiscoverySource:n,authorityEndpointSource:o},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:e7(),jwks_uri:""}),e}updateCachedMetadata(e,n,o){n!==Ba.CACHE&&o?.source!==Ba.CACHE&&(e.expiresAt=e7(),e.canonical_authority=this.canonicalAuthority);const u=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(u,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(vt.AuthorityUpdateEndpointMetadata,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){if(n.source===Ba.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&n.metadata){const u=await hr(this.updateMetadataWithRegionalInformation.bind(this),vt.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n.metadata);qC(e,u,!1),e.canonical_authority=this.canonicalAuthority}return n.source}let o=await hr(this.getEndpointMetadataFromNetwork.bind(this),vt.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(o)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(o=await hr(this.updateMetadataWithRegionalInformation.bind(this),vt.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(o)),qC(e,o,!0),Ba.NETWORK;throw Xt(PK,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const n=this.getEndpointMetadataFromConfig();if(n)return this.logger.verbose("Found endpoint metadata in authority configuration"),qC(e,n,!1),{source:Ba.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const u=this.getEndpointMetadataFromHardcodedValues();if(u)return qC(e,u,!1),{source:Ba.HARDCODED_VALUES,metadata:u};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const o=t7(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!o?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Ba.CACHE}):(o&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new ei(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Mi(JK)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(vt.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{const o=await this.networkInterface.sendGetRequestAsync(n,e);return uwe(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Y9?Y9[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(vt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const n=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(n){if(n!==Ot.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=bR.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,zs.replaceWithRegionalInformation(e,n);const o=await hr(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),vt.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(o)return this.regionDiscoveryMetadata.region_outcome=bR.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=o,zs.replaceWithRegionalInformation(e,o);this.regionDiscoveryMetadata.region_outcome=bR.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(vt.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const o=await hr(this.getCloudDiscoveryMetadataFromNetwork.bind(this),vt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(o)return wR(e,o,!0),Ba.NETWORK;throw Mi(eY)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Ot.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Ot.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Ot.NOT_APPLICABLE}`);const n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),wR(e,n,!1),Ba.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const u=gwe(this.hostnameAndPort);if(u)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),wR(e,u,!1),Ba.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const o=t7(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found cloud discovery metadata in the cache."),Ba.CACHE):(o&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===dc.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),zs.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=XS(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Mi(tL)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),zs.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(vt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${Ot.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,n={};let o=null;try{const u=await this.networkInterface.sendGetRequestAsync(e,n);let d,_;if(_we(u.body))d=u.body,_=d.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${d.tenant_discovery_endpoint}`);else if(ywe(u.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${u.status}`),d=u.body,d.error===Ot.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${d.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${d.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),_=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=XS(_,this.hostnameAndPort)}catch(u){if(u instanceof go)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${u.errorCode}
Error Description: ${u.errorMessage}`);else{const d=u;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${d.name}
Error Description: ${d.message}`)}return null}return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=zs.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),o}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(n=>n&&ei.getDomainFromUrl(n).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let o;if(n&&n.azureCloudInstance!==iL.None){const u=n.tenant?n.tenant:Ot.DEFAULT_COMMON_TENANT;o=`${n.azureCloudInstance}/${u}/`}return o||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Ot.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Xt(Ju)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return aY.has(e)}static isPublicCloudAuthority(e){return Ot.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,o){const u=new ei(e);u.validateAsUri();const d=u.getUrlComponents();let _=`${n}.${d.HostNameAndPort}`;this.isPublicCloudAuthority(d.HostNameAndPort)&&(_=`${n}.${Ot.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const v=ei.constructAuthorityUriFromObject({...u.getUrlComponents(),HostNameAndPort:_}).urlString;return o?`${v}?${o}`:v}static replaceWithRegionalInformation(e,n){const o={...e};return o.authorization_endpoint=zs.buildRegionalAuthorityString(o.authorization_endpoint,n),o.token_endpoint=zs.buildRegionalAuthorityString(o.token_endpoint,n),o.end_session_endpoint&&(o.end_session_endpoint=zs.buildRegionalAuthorityString(o.end_session_endpoint,n)),o}static transformCIAMAuthority(e){let n=e;const u=new ei(e).getUrlComponents();if(u.PathSegments.length===0&&u.HostNameAndPort.endsWith(Ot.CIAM_AUTH_URL)){const d=u.HostNameAndPort.split(".")[0];n=`${n}${d}${Ot.AAD_TENANT_DOMAIN_SUFFIX}`}return n}}zs.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Jd.COMMON,Jd.CONSUMERS,Jd.ORGANIZATIONS]);function Rwe(t){const o=new ei(t).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(o){case Jd.COMMON:case Jd.ORGANIZATIONS:case Jd.CONSUMERS:return;default:return o}}function cY(t){return t.endsWith(Ot.FORWARD_SLASH)?t:`${t}${Ot.FORWARD_SLASH}`}function kwe(t){const e=t.cloudDiscoveryMetadata;let n;if(e)try{n=JSON.parse(e)}catch{throw Mi(tL)}return{canonicalAuthority:t.authority?cY(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:n}}/*! @azure/msal-common v14.14.0 2024-07-23 */async function uY(t,e,n,o,u,d,_){_?.addQueueMeasurement(vt.AuthorityFactoryCreateDiscoveredInstance,d);const v=zs.transformCIAMAuthority(cY(t)),a=new zs(v,e,n,o,u,d,_);try{return await hr(a.resolveEndpointsAsync.bind(a),vt.AuthorityResolveEndpointsAsync,u,_,d)(),a}catch{throw Xt(Ju)}}/*! @azure/msal-common v14.14.0 2024-07-23 */async function hY(t,e,n){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:n})}/*! @azure/msal-common v14.14.0 2024-07-23 */const v_="client_id",Dwe="redirect_uri",r7="response_type",Owe="response_mode",Lwe="grant_type",Bwe="claims",Fwe="scope",zwe="refresh_token",Nwe="state",Uwe="nonce",$we="prompt",jwe="code",Vwe="code_challenge",Hwe="code_challenge_method",Gwe="code_verifier",Wwe="client-request-id",qwe="x-client-SKU",Kwe="x-client-VER",Ywe="x-client-OS",Zwe="x-client-CPU",Xwe="x-client-current-telemetry",Qwe="x-client-last-telemetry",Jwe="x-ms-lib-capability",eCe="x-app-name",tCe="x-app-ver",rCe="post_logout_redirect_uri",nCe="id_token_hint",iCe="device_code",oCe="client_secret",sCe="client_assertion",aCe="client_assertion_type",n7="token_type",i7="req_cnf",lCe="assertion",cCe="requested_token_use",o7="return_spa_code",uCe="nativebroker",hCe="logout_hint",dCe="sid",fCe="login_hint",pCe="domain_hint",mCe="x-client-xtra-sku";/*! @azure/msal-common v14.14.0 2024-07-23 */const QS={createNewGuid:()=>{throw Xt(Rn)},base64Decode:()=>{throw Xt(Rn)},base64Encode:()=>{throw Xt(Rn)},base64UrlEncode:()=>{throw Xt(Rn)},encodeKid:()=>{throw Xt(Rn)},async getPublicKeyThumbprint(){throw Xt(Rn)},async removeTokenBindingKey(){throw Xt(Rn)},async clearKeystore(){throw Xt(Rn)},async signJwt(){throw Xt(Rn)},async hashString(){throw Xt(Rn)}};/*! @azure/msal-common v14.14.0 2024-07-23 */var Gi;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(Gi||(Gi={}));class uf{constructor(e,n,o){this.level=Gi.Info;const u=()=>{},d=e||uf.createDefaultLoggerOptions();this.localCallback=d.loggerCallback||u,this.piiLoggingEnabled=d.piiLoggingEnabled||!1,this.level=typeof d.logLevel=="number"?d.logLevel:Gi.Info,this.correlationId=d.correlationId||Ot.EMPTY_STRING,this.packageName=n||Ot.EMPTY_STRING,this.packageVersion=o||Ot.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Gi.Info}}clone(e,n,o){return new uf({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},e,n)}logMessage(e,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;const d=`${`[${new Date().toUTCString()}] : [${n.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Gi[n.logLevel]} - ${e}`;this.executeCallback(n.logLevel,d,n.containsPii||!1)}executeCallback(e,n,o){this.localCallback&&this.localCallback(e,n,o)}error(e,n){this.logMessage(e,{logLevel:Gi.Error,containsPii:!1,correlationId:n||Ot.EMPTY_STRING})}errorPii(e,n){this.logMessage(e,{logLevel:Gi.Error,containsPii:!0,correlationId:n||Ot.EMPTY_STRING})}warning(e,n){this.logMessage(e,{logLevel:Gi.Warning,containsPii:!1,correlationId:n||Ot.EMPTY_STRING})}warningPii(e,n){this.logMessage(e,{logLevel:Gi.Warning,containsPii:!0,correlationId:n||Ot.EMPTY_STRING})}info(e,n){this.logMessage(e,{logLevel:Gi.Info,containsPii:!1,correlationId:n||Ot.EMPTY_STRING})}infoPii(e,n){this.logMessage(e,{logLevel:Gi.Info,containsPii:!0,correlationId:n||Ot.EMPTY_STRING})}verbose(e,n){this.logMessage(e,{logLevel:Gi.Verbose,containsPii:!1,correlationId:n||Ot.EMPTY_STRING})}verbosePii(e,n){this.logMessage(e,{logLevel:Gi.Verbose,containsPii:!0,correlationId:n||Ot.EMPTY_STRING})}trace(e,n){this.logMessage(e,{logLevel:Gi.Trace,containsPii:!1,correlationId:n||Ot.EMPTY_STRING})}tracePii(e,n){this.logMessage(e,{logLevel:Gi.Trace,containsPii:!0,correlationId:n||Ot.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.14.0 2024-07-23 */const dY="@azure/msal-common",sL="14.14.0";/*! @azure/msal-common v14.14.0 2024-07-23 */class Co{constructor(e){const n=e?bc.trimArrayEntries([...e]):[],o=n?bc.removeEmptyStringsFromArray(n):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach(u=>this.scopes.add(u))}static fromString(e){const o=(e||Ot.EMPTY_STRING).split(" ");return new Co(o)}static createSearchScopes(e){const n=new Co(e);return n.containsOnlyOIDCScopes()?n.removeScope(Ot.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}validateInputScopes(e){if(!e||e.length<1)throw Mi(KK)}containsScope(e){const n=this.printScopesLowerCase().split(" "),o=new Co(n);return e?o.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(n=>this.containsScope(n))}containsOnlyOIDCScopes(){let e=0;return V9.forEach(n=>{this.containsScope(n)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(n=>this.appendScope(n))}catch{throw Xt(zK)}}removeScope(e){if(!e)throw Xt(FK);this.scopes.delete(e.trim())}removeOIDCScopes(){V9.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Xt(B4);const n=new Set;return e.scopes.forEach(o=>n.add(o.toLowerCase())),this.scopes.forEach(o=>n.add(o.toLowerCase())),n}intersectingScopeSets(e){if(!e)throw Xt(B4);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const n=this.unionScopeSets(e),o=e.getScopeCount(),u=this.getScopeCount();return n.size<u+o}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(n=>e.push(n)),e}printScopes(){return this.scopes?this.asArray().join(" "):Ot.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.14.0 2024-07-23 */function JS(t,e){if(!t)throw Xt(AK);try{const n=e(t);return JSON.parse(n)}catch{throw Xt(q5)}}function Sg(t){if(!t)throw Xt(q5);const e=t.split(Us.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?Ot.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.14.0 2024-07-23 */function eT(t,e){return!!t&&!!e&&t===e.split(".")[1]}function aL(t,e,n,o){if(o){const{oid:u,sub:d,tid:_,name:v,tfp:a,acr:C}=o,A=_||a||C||"";return{tenantId:A,localAccountId:u||d||"",name:v,isHomeTenant:eT(A,t)}}else return{tenantId:n,localAccountId:e,isHomeTenant:eT(n,t)}}function lL(t,e,n,o){let u=t;if(e){const{isHomeTenant:d,..._}=e;u={...t,..._}}if(n){const{isHomeTenant:d,..._}=aL(t.homeAccountId,t.localAccountId,t.tenantId,n);return u={...u,..._,idTokenClaims:n,idToken:o},u}return u}/*! @azure/msal-common v14.14.0 2024-07-23 */function fY(t){return t&&(t.tid||t.tfp||t.acr)||null}/*! @azure/msal-common v14.14.0 2024-07-23 */class Zo{generateAccountId(){return[this.homeAccountId,this.environment].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Zo.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const n=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",n||e.tenantId||""].join(Us.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,n,o){const u=new Zo;n.authorityType===dc.Adfs?u.authorityType=GC.ADFS_ACCOUNT_TYPE:n.protocolMode===fh.AAD?u.authorityType=GC.MSSTS_ACCOUNT_TYPE:u.authorityType=GC.GENERIC_ACCOUNT_TYPE;let d;e.clientInfo&&o&&(d=JS(e.clientInfo,o)),u.clientInfo=e.clientInfo,u.homeAccountId=e.homeAccountId,u.nativeAccountId=e.nativeAccountId;const _=e.environment||n&&n.getPreferredCache();if(!_)throw Xt(X5);u.environment=_,u.realm=d?.utid||fY(e.idTokenClaims)||"",u.localAccountId=d?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const v=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,a=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(u.username=v||a||"",u.name=e.idTokenClaims?.name||"",u.cloudGraphHostName=e.cloudGraphHostName,u.msGraphHost=e.msGraphHost,e.tenantProfiles)u.tenantProfiles=e.tenantProfiles;else{const C=aL(e.homeAccountId,u.localAccountId,u.realm,e.idTokenClaims);u.tenantProfiles=[C]}return u}static createFromAccountInfo(e,n,o){const u=new Zo;return u.authorityType=e.authorityType||GC.GENERIC_ACCOUNT_TYPE,u.homeAccountId=e.homeAccountId,u.localAccountId=e.localAccountId,u.nativeAccountId=e.nativeAccountId,u.realm=e.tenantId,u.environment=e.environment,u.username=e.username,u.name=e.name,u.cloudGraphHostName=n,u.msGraphHost=o,u.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),u}static generateHomeAccountId(e,n,o,u,d){if(!(n===dc.Adfs||n===dc.Dsts)){if(e)try{const _=JS(e,u.base64Decode);if(_.uid&&_.utid)return`${_.uid}.${_.utid}`}catch{}o.warning("No client info in response")}return d?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,n,o){if(!e||!n)return!1;let u=!0;if(o){const d=e.idTokenClaims||{},_=n.idTokenClaims||{};u=d.iat===_.iat&&d.nonce===_.nonce}return e.homeAccountId===n.homeAccountId&&e.localAccountId===n.localAccountId&&e.username===n.username&&e.tenantId===n.tenantId&&e.environment===n.environment&&e.nativeAccountId===n.nativeAccountId&&u}}/*! @azure/msal-common v14.14.0 2024-07-23 */const pY="cache_quota_exceeded",cL="cache_error_unknown";/*! @azure/msal-common v14.14.0 2024-07-23 */const CR={[pY]:"Exceeded cache storage capacity.",[cL]:"Unexpected error occurred when using cache storage."};class jg extends Error{constructor(e,n){const o=n||(CR[e]?CR[e]:CR[cL]);super(`${e}: ${o}`),Object.setPrototypeOf(this,jg.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=o}}/*! @azure/msal-common v14.14.0 2024-07-23 */class x_{constructor(e,n,o,u){this.clientId=e,this.cryptoImpl=n,this.commonLogger=o.clone(dY,sL),this.staticAuthorityOptions=u}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const n=this.getAllAccounts(e);return n.length>1?n.sort(u=>u.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e){const n=this.getAccountsFilteredBy(e);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,n){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,n,o,u){let d=null,_;if(u&&!this.tenantProfileMatchesFilter(o,u))return null;const v=this.getIdToken(e,n,o.tenantId);return v&&(_=Sm(v.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(_,u))?null:(d=lL(e,o,_,v?.secret),d)}getTenantProfilesFromAccountEntity(e,n,o){const u=e.getAccountInfo();let d=u.tenantProfiles||new Map;const _=this.getTokenKeys();if(n){const a=d.get(n);if(a)d=new Map([[n,a]]);else return[]}const v=[];return d.forEach(a=>{const C=this.getTenantedAccountInfoByFilter(u,_,a,o);C&&v.push(C)}),v}tenantProfileMatchesFilter(e,n){return!(n.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,n.localAccountId)||n.name&&e.name!==n.name||n.isHomeTenant!==void 0&&e.isHomeTenant!==n.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,n){return!(n&&(n.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,n.localAccountId)||n.loginHint&&!this.matchLoginHintFromTokenClaims(e,n.loginHint)||n.username&&!this.matchUsername(e.preferred_username,n.username)||n.name&&!this.matchName(e,n.name)||n.sid&&!this.matchSid(e,n.sid)))}async saveCacheRecord(e,n,o){if(!e)throw Xt(NK);try{e.account&&this.setAccount(e.account),e.idToken&&n?.idToken!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(e.accessToken),e.refreshToken&&n?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(u){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),u instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${u.message}`,o),u.name==="QuotaExceededError"||u.name==="NS_ERROR_DOM_QUOTA_REACHED"||u.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",o),new jg(pY)):new jg(u.name,u.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${u}`,o),new jg(cL))}}async saveAccessToken(e){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),u=Co.fromString(e.target),d=[];o.accessToken.forEach(_=>{if(!this.accessTokenKeyMatchesFilter(_,n,!1))return;const v=this.getAccessTokenCredential(_);v&&this.credentialMatchesFilter(v,n)&&Co.fromString(v.target).intersectingScopeSets(u)&&d.push(this.removeAccessToken(_))}),await Promise.all(d),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const n=this.getAccountKeys(),o=[];return n.forEach(u=>{if(!this.isAccountKey(u,e.homeAccountId))return;const d=this.getAccount(u,this.commonLogger);if(!d||e.homeAccountId&&!this.matchHomeAccountId(d,e.homeAccountId)||e.username&&!this.matchUsername(d.username,e.username)||e.environment&&!this.matchEnvironment(d,e.environment)||e.realm&&!this.matchRealm(d,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(d,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(d,e.authorityType))return;const _={localAccountId:e?.localAccountId,name:e?.name},v=d.tenantProfiles?.filter(a=>this.tenantProfileMatchesFilter(a,_));v&&v.length===0||o.push(d)}),o}isAccountKey(e,n,o){return!(e.split(Us.CACHE_KEY_SEPARATOR).length<3||n&&!e.toLowerCase().includes(n.toLowerCase())||o&&!e.toLowerCase().includes(o.toLowerCase()))}isCredentialKey(e){if(e.split(Us.CACHE_KEY_SEPARATOR).length<6)return!1;const n=e.toLowerCase();if(n.indexOf(sn.ID_TOKEN.toLowerCase())===-1&&n.indexOf(sn.ACCESS_TOKEN.toLowerCase())===-1&&n.indexOf(sn.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&n.indexOf(sn.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(n.indexOf(sn.REFRESH_TOKEN.toLowerCase())>-1){const o=`${sn.REFRESH_TOKEN}${Us.CACHE_KEY_SEPARATOR}${this.clientId}${Us.CACHE_KEY_SEPARATOR}`,u=`${sn.REFRESH_TOKEN}${Us.CACHE_KEY_SEPARATOR}${jx}${Us.CACHE_KEY_SEPARATOR}`;if(n.indexOf(o.toLowerCase())===-1&&n.indexOf(u.toLowerCase())===-1)return!1}else if(n.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,n){return!(n.clientId&&!this.matchClientId(e,n.clientId)||n.userAssertionHash&&!this.matchUserAssertionHash(e,n.userAssertionHash)||typeof n.homeAccountId=="string"&&!this.matchHomeAccountId(e,n.homeAccountId)||n.environment&&!this.matchEnvironment(e,n.environment)||n.realm&&!this.matchRealm(e,n.realm)||n.credentialType&&!this.matchCredentialType(e,n.credentialType)||n.familyId&&!this.matchFamilyId(e,n.familyId)||n.target&&!this.matchTarget(e,n.target)||(n.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==n.requestedClaimsHash||e.credentialType===sn.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(n.tokenType&&!this.matchTokenType(e,n.tokenType)||n.tokenType===bi.SSH&&n.keyId&&!this.matchKeyId(e,n.keyId)))}getAppMetadataFilteredBy(e){const n=this.getKeys(),o={};return n.forEach(u=>{if(!this.isAppMetadata(u))return;const d=this.getAppMetadata(u);d&&(e.environment&&!this.matchEnvironment(d,e.environment)||e.clientId&&!this.matchClientId(d,e.clientId)||(o[u]=d))}),o}getAuthorityMetadataByAlias(e){const n=this.getAuthorityMetadataKeys();let o=null;return n.forEach(u=>{if(!this.isAuthorityMetadata(u)||u.indexOf(this.clientId)===-1)return;const d=this.getAuthorityMetadata(u);d&&d.aliases.indexOf(e)!==-1&&(o=d)}),o}async removeAllAccounts(){const e=this.getAccountKeys(),n=[];e.forEach(o=>{n.push(this.removeAccount(o))}),await Promise.all(n)}async removeAccount(e){const n=this.getAccount(e,this.commonLogger);n&&(await this.removeAccountContext(n),this.removeItem(e))}async removeAccountContext(e){const n=this.getTokenKeys(),o=e.generateAccountId(),u=[];n.idToken.forEach(d=>{d.indexOf(o)===0&&this.removeIdToken(d)}),n.accessToken.forEach(d=>{d.indexOf(o)===0&&u.push(this.removeAccessToken(d))}),n.refreshToken.forEach(d=>{d.indexOf(o)===0&&this.removeRefreshToken(d)}),await Promise.all(u)}updateOutdatedCachedAccount(e,n,o){if(n&&n.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const u=this.getAccountKeys().filter(C=>C.startsWith(n.homeAccountId)),d=[];u.forEach(C=>{const A=this.getCachedAccountEntity(C);A&&d.push(A)});const _=d.find(C=>eT(C.realm,C.homeAccountId))||d[0];_.tenantProfiles=d.map(C=>({tenantId:C.realm,localAccountId:C.localAccountId,name:C.name,isHomeTenant:eT(C.realm,C.homeAccountId)}));const v=x_.toObject(new Zo,{..._}),a=v.generateAccountKey();return u.forEach(C=>{C!==a&&this.removeOutdatedAccount(e)}),this.setAccount(v),o?.verbose("Updated an outdated account entity in the cache"),v}return n}async removeAccessToken(e){const n=this.getAccessTokenCredential(e);if(n){if(n.credentialType.toLowerCase()===sn.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&n.tokenType===bi.POP){const u=n.keyId;if(u)try{await this.cryptoImpl.removeTokenBindingKey(u)}catch{throw Xt(jK)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n)}),!0}readAccountFromCache(e){const n=Zo.generateAccountCacheKey(e);return this.getAccount(n,this.commonLogger)}getIdToken(e,n,o,u,d){this.commonLogger.trace("CacheManager - getIdToken called");const _={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:sn.ID_TOKEN,clientId:this.clientId,realm:o},v=this.getIdTokensByFilter(_,n),a=v.size;if(a<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(a>1){let C=v;if(!o){const A=new Map;v.forEach((O,R)=>{O.realm===e.tenantId&&A.set(R,O)});const k=A.size;if(k<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),v.values().next().value;if(k===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),A.values().next().value;C=A}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),C.forEach((A,k)=>{this.removeIdToken(k)}),u&&d&&u.addFields({multiMatchedID:v.size},d),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),v.values().next().value}getIdTokensByFilter(e,n){const o=n&&n.idToken||this.getTokenKeys().idToken,u=new Map;return o.forEach(d=>{if(!this.idTokenKeyMatchesFilter(d,{clientId:this.clientId,...e}))return;const _=this.getIdTokenCredential(d);_&&this.credentialMatchesFilter(_,e)&&u.set(d,_)}),u}idTokenKeyMatchesFilter(e,n){const o=e.toLowerCase();return!(n.clientId&&o.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&o.indexOf(n.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,n,o,u,d,_){this.commonLogger.trace("CacheManager - getAccessToken called");const v=Co.createSearchScopes(n.scopes),a=n.authenticationScheme||bi.BEARER,C=a&&a.toLowerCase()!==bi.BEARER.toLowerCase()?sn.ACCESS_TOKEN_WITH_AUTH_SCHEME:sn.ACCESS_TOKEN,A={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:C,clientId:this.clientId,realm:u||e.tenantId,target:v,tokenType:a,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},k=o&&o.accessToken||this.getTokenKeys().accessToken,O=[];k.forEach(z=>{if(this.accessTokenKeyMatchesFilter(z,A,!0)){const N=this.getAccessTokenCredential(z);N&&this.credentialMatchesFilter(N,A)&&O.push(N)}});const R=O.length;return R<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):R>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),O.forEach(z=>{this.removeAccessToken(Eg(z))}),d&&_&&d.addFields({multiMatchedAT:O.length},_),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),O[0])}accessTokenKeyMatchesFilter(e,n,o){const u=e.toLowerCase();if(n.clientId&&u.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&u.indexOf(n.homeAccountId.toLowerCase())===-1||n.realm&&u.indexOf(n.realm.toLowerCase())===-1||n.requestedClaimsHash&&u.indexOf(n.requestedClaimsHash.toLowerCase())===-1)return!1;if(n.target){const d=n.target.asArray();for(let _=0;_<d.length;_++){if(o&&!u.includes(d[_].toLowerCase()))return!1;if(!o&&u.includes(d[_].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const n=this.getTokenKeys(),o=[];return n.accessToken.forEach(u=>{if(!this.accessTokenKeyMatchesFilter(u,e,!0))return;const d=this.getAccessTokenCredential(u);d&&this.credentialMatchesFilter(d,e)&&o.push(d)}),o}getRefreshToken(e,n,o,u,d){this.commonLogger.trace("CacheManager - getRefreshToken called");const _=n?jx:void 0,v={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:sn.REFRESH_TOKEN,clientId:this.clientId,familyId:_},a=o&&o.refreshToken||this.getTokenKeys().refreshToken,C=[];a.forEach(k=>{if(this.refreshTokenKeyMatchesFilter(k,v)){const O=this.getRefreshTokenCredential(k);O&&this.credentialMatchesFilter(O,v)&&C.push(O)}});const A=C.length;return A<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(A>1&&u&&d&&u.addFields({multiMatchedRT:A},d),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),C[0])}refreshTokenKeyMatchesFilter(e,n){const o=e.toLowerCase();return!(n.familyId&&o.indexOf(n.familyId.toLowerCase())===-1||!n.familyId&&n.clientId&&o.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&o.indexOf(n.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const n={environment:e,clientId:this.clientId},o=this.getAppMetadataFilteredBy(n),u=Object.keys(o).map(_=>o[_]),d=u.length;if(d<1)return null;if(d>1)throw Xt(LK);return u[0]}isAppMetadataFOCI(e){const n=this.readAppMetadataFromCache(e);return!!(n&&n.familyId===jx)}matchHomeAccountId(e,n){return typeof e.homeAccountId=="string"&&n===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,n){const o=e.oid||e.sub;return n===o}matchLocalAccountIdFromTenantProfile(e,n){return e.localAccountId===n}matchName(e,n){return n.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,n){return!!(e&&typeof e=="string"&&n?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,n){return!!(e.userAssertionHash&&n===e.userAssertionHash)}matchEnvironment(e,n){if(this.staticAuthorityOptions){const u=mwe(this.staticAuthorityOptions,this.commonLogger);if(u.includes(n)&&u.includes(e.environment))return!0}const o=this.getAuthorityMetadataByAlias(n);return!!(o&&o.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,n){return e.credentialType&&n.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,n){return!!(e.clientId&&n===e.clientId)}matchFamilyId(e,n){return!!(e.familyId&&n===e.familyId)}matchRealm(e,n){return e.realm?.toLowerCase()===n.toLowerCase()}matchNativeAccountId(e,n){return!!(e.nativeAccountId&&n===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,n){return e.login_hint===n||e.preferred_username===n||e.upn===n}matchSid(e,n){return e.sid===n}matchAuthorityType(e,n){return!!(e.authorityType&&n.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,n){return e.credentialType!==sn.ACCESS_TOKEN&&e.credentialType!==sn.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:Co.fromString(e.target).containsScopeSet(n)}matchTokenType(e,n){return!!(e.tokenType&&e.tokenType===n)}matchKeyId(e,n){return!!(e.keyId&&e.keyId===n)}isAppMetadata(e){return e.indexOf(G5)!==-1}isAuthorityMetadata(e){return e.indexOf(KS.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${KS.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,n){for(const o in n)e[o]=n[o];return e}}class gCe extends x_{setAccount(){throw Xt(Rn)}getAccount(){throw Xt(Rn)}getCachedAccountEntity(){throw Xt(Rn)}setIdTokenCredential(){throw Xt(Rn)}getIdTokenCredential(){throw Xt(Rn)}setAccessTokenCredential(){throw Xt(Rn)}getAccessTokenCredential(){throw Xt(Rn)}setRefreshTokenCredential(){throw Xt(Rn)}getRefreshTokenCredential(){throw Xt(Rn)}setAppMetadata(){throw Xt(Rn)}getAppMetadata(){throw Xt(Rn)}setServerTelemetry(){throw Xt(Rn)}getServerTelemetry(){throw Xt(Rn)}setAuthorityMetadata(){throw Xt(Rn)}getAuthorityMetadata(){throw Xt(Rn)}getAuthorityMetadataKeys(){throw Xt(Rn)}setThrottlingCache(){throw Xt(Rn)}getThrottlingCache(){throw Xt(Rn)}removeItem(){throw Xt(Rn)}getKeys(){throw Xt(Rn)}getAccountKeys(){throw Xt(Rn)}getTokenKeys(){throw Xt(Rn)}async clear(){throw Xt(Rn)}updateCredentialCacheKey(){throw Xt(Rn)}removeOutdatedAccount(){throw Xt(Rn)}}/*! @azure/msal-common v14.14.0 2024-07-23 */const mY={tokenRenewalOffsetSeconds:Ybe,preventCorsPreflight:!1},_Ce={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Gi.Info,correlationId:Ot.EMPTY_STRING},yCe={claimsBasedCachingEnabled:!1},vCe={async sendGetRequestAsync(){throw Xt(Rn)},async sendPostRequestAsync(){throw Xt(Rn)}},xCe={sku:Ot.SKU,version:sL,cpu:Ot.EMPTY_STRING,os:Ot.EMPTY_STRING},bCe={clientSecret:Ot.EMPTY_STRING,clientAssertion:void 0},wCe={azureCloudInstance:iL.None,tenant:`${Ot.DEFAULT_COMMON_TENANT}`},CCe={application:{appName:"",appVersion:""}};function ECe({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:o,storageInterface:u,networkInterface:d,cryptoInterface:_,clientCredentials:v,libraryInfo:a,telemetry:C,serverTelemetryManager:A,persistencePlugin:k,serializableCache:O}){const R={..._Ce,...n};return{authOptions:SCe(t),systemOptions:{...mY,...e},loggerOptions:R,cacheOptions:{...yCe,...o},storageInterface:u||new gCe(t.clientId,QS,new uf(R)),networkInterface:d||vCe,cryptoInterface:_||QS,clientCredentials:v||bCe,libraryInfo:{...xCe,...a},telemetry:{...CCe,...C},serverTelemetryManager:A||null,persistencePlugin:k||null,serializableCache:O||null}}function SCe(t){return{clientCapabilities:[],azureCloudOptions:wCe,skipAuthorityMetadataCache:!1,...t}}function $4(t){return t.authOptions.authority.options.protocolMode===fh.OIDC}/*! @azure/msal-common v14.14.0 2024-07-23 */class hf extends go{constructor(e,n,o,u,d){super(e,n,o),this.name="ServerError",this.errorNo=u,this.status=d,Object.setPrototypeOf(this,hf.prototype)}}/*! @azure/msal-common v14.14.0 2024-07-23 */class iu{static generateThrottlingStorageKey(e){return`${Vx.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,n){const o=iu.generateThrottlingStorageKey(n),u=e.getThrottlingCache(o);if(u){if(u.throttleTime<Date.now()){e.removeItem(o);return}throw new hf(u.errorCodes?.join(" ")||Ot.EMPTY_STRING,u.errorMessage,u.subError)}}static postProcess(e,n,o){if(iu.checkResponseStatus(o)||iu.checkResponseForRetryAfter(o)){const u={throttleTime:iu.calculateThrottleTime(parseInt(o.headers[au.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};e.setThrottlingCache(iu.generateThrottlingStorageKey(n),u)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(au.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const n=e<=0?0:e,o=Date.now()/1e3;return Math.floor(Math.min(o+(n||Vx.DEFAULT_THROTTLE_TIME_SECONDS),o+Vx.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,n,o,u){const d={clientId:n,authority:o.authority,scopes:o.scopes,homeAccountIdentifier:u,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},_=this.generateThrottlingStorageKey(d);e.removeItem(_)}}/*! @azure/msal-common v14.14.0 2024-07-23 */class TCe{constructor(e,n){this.networkClient=e,this.cacheManager=n}async sendPostRequest(e,n,o){iu.preProcess(this.cacheManager,e);let u;try{u=await this.networkClient.sendPostRequestAsync(n,o)}catch(d){throw d instanceof go?d:Xt(MK)}return iu.postProcess(this.cacheManager,e,u),u}}/*! @azure/msal-common v14.14.0 2024-07-23 */const qa={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.14.0 2024-07-23 */class ng{static validateRedirectUri(e){if(!e)throw Mi(GK)}static validatePrompt(e){const n=[];for(const o in as)n.push(as[o]);if(n.indexOf(e)<0)throw Mi(YK)}static validateClaims(e){try{JSON.parse(e)}catch{throw Mi(J5)}}static validateCodeChallengeParams(e,n){if(!e||!n)throw Mi(eL);this.validateCodeChallengeMethod(n)}static validateCodeChallengeMethod(e){if([H9.PLAIN,H9.S256].indexOf(e)<0)throw Mi(QK)}}/*! @azure/msal-common v14.14.0 2024-07-23 */class Hx{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(r7,encodeURIComponent(Ot.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(r7,encodeURIComponent(`${Ot.TOKEN_RESPONSE_TYPE} ${Ot.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(Owe,encodeURIComponent(e||Wbe.QUERY))}addNativeBroker(){this.parameters.set(uCe,encodeURIComponent("1"))}addScopes(e,n=!0,o=N_){n&&!o.includes("openid")&&!e.includes("openid")&&o.push("openid");const u=n?[...e||[],...o]:e||[],d=new Co(u);this.parameters.set(Fwe,encodeURIComponent(d.printScopes()))}addClientId(e){this.parameters.set(v_,encodeURIComponent(e))}addRedirectUri(e){ng.validateRedirectUri(e),this.parameters.set(Dwe,encodeURIComponent(e))}addPostLogoutRedirectUri(e){ng.validateRedirectUri(e),this.parameters.set(rCe,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(nCe,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(pCe,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(fCe,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(au.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(au.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(dCe,encodeURIComponent(e))}addClaims(e,n){const o=this.addClientCapabilitiesToClaims(e,n);ng.validateClaims(o),this.parameters.set(Bwe,encodeURIComponent(o))}addCorrelationId(e){this.parameters.set(Wwe,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(qwe,e.sku),this.parameters.set(Kwe,e.version),e.os&&this.parameters.set(Ywe,e.os),e.cpu&&this.parameters.set(Zwe,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(eCe,e.appName),e?.appVersion&&this.parameters.set(tCe,e.appVersion)}addPrompt(e){ng.validatePrompt(e),this.parameters.set(`${$we}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Nwe,encodeURIComponent(e))}addNonce(e){this.parameters.set(Uwe,encodeURIComponent(e))}addCodeChallengeParams(e,n){if(ng.validateCodeChallengeParams(e,n),e&&n)this.parameters.set(Vwe,encodeURIComponent(e)),this.parameters.set(Hwe,encodeURIComponent(n));else throw Mi(eL)}addAuthorizationCode(e){this.parameters.set(jwe,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(iCe,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(zwe,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(Gwe,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(oCe,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(sCe,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(aCe,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(lCe,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(cCe,encodeURIComponent(e))}addGrantType(e){this.parameters.set(Lwe,encodeURIComponent(e))}addClientInfo(){this.parameters.set(qbe,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([n,o])=>{!this.parameters.has(n)&&o&&this.parameters.set(n,o)})}addClientCapabilitiesToClaims(e,n){let o;if(!e)o={};else try{o=JSON.parse(e)}catch{throw Mi(J5)}return n&&n.length>0&&(o.hasOwnProperty(HC.ACCESS_TOKEN)||(o[HC.ACCESS_TOKEN]={}),o[HC.ACCESS_TOKEN][HC.XMS_CC]={values:n}),JSON.stringify(o)}addUsername(e){this.parameters.set(W9.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(W9.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(n7,bi.POP),this.parameters.set(i7,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(n7,bi.SSH),this.parameters.set(i7,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(Xwe,e.generateCurrentRequestHeaderValue()),this.parameters.set(Qwe,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(Jwe,Vx.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(hCe,encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach((n,o)=>{e.push(`${o}=${n}`)}),e.join("&")}}/*! @azure/msal-common v14.14.0 2024-07-23 */class uL{constructor(e,n){this.config=ECe(e),this.logger=new uf(this.config.loggerOptions,dY,sL),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new TCe(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n}createTokenRequestHeaders(e){const n={};if(n[au.CONTENT_TYPE]=Ot.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case qa.HOME_ACCOUNT_ID:try{const o=Sg(e.credential);n[au.CCS_HEADER]=`Oid:${o.uid}@${o.utid}`}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case qa.UPN:n[au.CCS_HEADER]=`UPN: ${e.credential}`;break}return n}async executePostToTokenEndpoint(e,n,o,u,d,_){_&&this.performanceClient?.addQueueMeasurement(_,d);const v=await this.networkManager.sendPostRequest(u,e,{body:n,headers:o});return this.performanceClient?.addFields({refreshTokenSize:v.body.refresh_token?.length||0,httpVerToken:v.headers?.[au.X_MS_HTTP_VERSION]||""},d),this.config.serverTelemetryManager&&v.status<500&&v.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),v}async updateAuthority(e,n){this.performanceClient?.addQueueMeasurement(vt.UpdateTokenEndpointAuthority,n);const o=`https://${e}/${this.authority.tenant}/`,u=await uY(o,this.networkClient,this.cacheManager,this.authority.options,this.logger,n,this.performanceClient);this.authority=u}createTokenQueryParameters(e){const n=new Hx;return e.tokenQueryParameters&&n.addExtraQueryParameters(e.tokenQueryParameters),n.createQueryString()}}/*! @azure/msal-common v14.14.0 2024-07-23 */const tT="no_tokens_found",gY="native_account_unavailable",hL="refresh_token_expired",ACe="interaction_required",ICe="consent_required",MCe="login_required",KA="bad_token";/*! @azure/msal-common v14.14.0 2024-07-23 */const s7=[ACe,ICe,MCe,KA],PCe=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],RCe={[tT]:"No refresh token found in the cache. Please sign-in.",[gY]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[hL]:"Refresh token has expired.",[KA]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Sc extends go{constructor(e,n,o,u,d,_,v,a){super(e,n,o),Object.setPrototypeOf(this,Sc.prototype),this.timestamp=u||Ot.EMPTY_STRING,this.traceId=d||Ot.EMPTY_STRING,this.correlationId=_||Ot.EMPTY_STRING,this.claims=v||Ot.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=a}}function a7(t,e,n){const o=!!t&&s7.indexOf(t)>-1,u=!!n&&PCe.indexOf(n)>-1,d=!!e&&s7.some(_=>e.indexOf(_)>-1);return o||d||u}function j4(t){return new Sc(t,RCe[t])}/*! @azure/msal-common v14.14.0 2024-07-23 */class wc{static setRequestState(e,n,o){const u=wc.generateLibraryState(e,o);return n?`${u}${Ot.RESOURCE_DELIM}${n}`:u}static generateLibraryState(e,n){if(!e)throw Xt(z4);const o={id:e.createNewGuid()};n&&(o.meta=n);const u=JSON.stringify(o);return e.base64Encode(u)}static parseRequestState(e,n){if(!e)throw Xt(z4);if(!n)throw Xt(y_);try{const o=n.split(Ot.RESOURCE_DELIM),u=o[0],d=o.length>1?o.slice(1).join(Ot.RESOURCE_DELIM):Ot.EMPTY_STRING,_=e.base64Decode(u),v=JSON.parse(_);return{userRequestState:d||Ot.EMPTY_STRING,libraryState:v}}catch{throw Xt(y_)}}}/*! @azure/msal-common v14.14.0 2024-07-23 */const kCe={SW:"sw",UHW:"uhw"};class b_{constructor(e,n){this.cryptoUtils=e,this.performanceClient=n}async generateCnf(e,n){this.performanceClient?.addQueueMeasurement(vt.PopTokenGenerateCnf,e.correlationId);const o=await hr(this.generateKid.bind(this),vt.PopTokenGenerateCnf,n,this.performanceClient,e.correlationId)(e),u=this.cryptoUtils.base64UrlEncode(JSON.stringify(o));return{kid:o.kid,reqCnfString:u}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(vt.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:kCe.SW}}async signPopToken(e,n,o){return this.signPayload(e,n,o)}async signPayload(e,n,o,u){const{resourceRequestMethod:d,resourceRequestUri:_,shrClaims:v,shrNonce:a,shrOptions:C}=o,k=(_?new ei(_):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:gu(),m:d?.toUpperCase(),u:k?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:k?.AbsolutePath,q:k?.QueryString?[[],k.QueryString]:void 0,client_claims:v||void 0,...u},n,C,o.correlationId)}}/*! @azure/msal-common v14.14.0 2024-07-23 */class DCe{constructor(e,n){this.cache=e,this.hasChanged=n}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.14.0 2024-07-23 */function OCe(t){const e="code=",n=t.error_uri?.lastIndexOf(e);return n&&n>=0?t.error_uri?.substring(n+e.length):void 0}class fm{constructor(e,n,o,u,d,_,v){this.clientId=e,this.cacheStorage=n,this.cryptoObj=o,this.logger=u,this.serializableCache=d,this.persistencePlugin=_,this.performanceClient=v}validateServerAuthorizationCodeResponse(e,n){if(!e.state||!n)throw e.state?Xt(YS,"Cached State"):Xt(YS,"Server State");let o,u;try{o=decodeURIComponent(e.state)}catch{throw Xt(y_,e.state)}try{u=decodeURIComponent(n)}catch{throw Xt(y_,e.state)}if(o!==u)throw Xt(kK);if(e.error||e.error_description||e.suberror){const d=OCe(e);throw a7(e.error,e.error_description,e.suberror)?new Sc(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",d):new hf(e.error||"",e.error_description,e.suberror,d)}}validateTokenResponse(e,n){if(e.error||e.error_description||e.suberror){const o=`Error(s): ${e.error_codes||Ot.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Ot.NOT_AVAILABLE} - Description: ${e.error_description||Ot.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Ot.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Ot.NOT_AVAILABLE}`,u=e.error_codes?.length?e.error_codes[0]:void 0,d=new hf(e.error,o,e.suberror,u,e.status);if(n&&e.status&&e.status>=VC.SERVER_ERROR_RANGE_START&&e.status<=VC.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${d}`);return}else if(n&&e.status&&e.status>=VC.CLIENT_ERROR_RANGE_START&&e.status<=VC.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${d}`);return}throw a7(e.error,e.error_description,e.suberror)?new Sc(e.error,e.error_description,e.suberror,e.timestamp||Ot.EMPTY_STRING,e.trace_id||Ot.EMPTY_STRING,e.correlation_id||Ot.EMPTY_STRING,e.claims||Ot.EMPTY_STRING,u):d}}async handleServerTokenResponse(e,n,o,u,d,_,v,a,C){this.performanceClient?.addQueueMeasurement(vt.HandleServerTokenResponse,e.correlation_id);let A;if(e.id_token){if(A=Sm(e.id_token||Ot.EMPTY_STRING,this.cryptoObj.base64Decode),d&&d.nonce&&A.nonce!==d.nonce)throw Xt(DK);if(u.maxAge||u.maxAge===0){const z=A.auth_time;if(!z)throw Xt(Y5);HK(z,u.maxAge)}}this.homeAccountIdentifier=Zo.generateHomeAccountId(e.client_info||Ot.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,A);let k;d&&d.state&&(k=wc.parseRequestState(this.cryptoObj,d.state)),e.key_id=e.key_id||u.sshKid||void 0;const O=this.generateCacheRecord(e,n,o,u,A,_,d);let R;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),R=new DCe(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(R)),v&&!a&&O.account){const z=O.account.generateAccountKey();if(!this.cacheStorage.getAccount(z,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await fm.generateAuthenticationResult(this.cryptoObj,n,O,!1,u,A,k,void 0,C)}await this.cacheStorage.saveCacheRecord(O,u.storeInCache,u.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&R&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(R))}return fm.generateAuthenticationResult(this.cryptoObj,n,O,!1,u,A,k,e,C)}generateCacheRecord(e,n,o,u,d,_,v){const a=n.getPreferredCache();if(!a)throw Xt(X5);const C=fY(d);let A,k;e.id_token&&d&&(A=WA(this.homeAccountIdentifier,a,e.id_token,this.clientId,C||""),k=dL(this.cacheStorage,n,this.homeAccountIdentifier,this.cryptoObj.base64Decode,d,e.client_info,a,C,v,void 0,this.logger));let O=null;if(e.access_token){const N=e.scope?Co.fromString(e.scope):new Co(u.scopes||[]),K=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,q=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,j=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,H=o+K,Y=H+q,te=j&&j>0?o+j:void 0;O=qA(this.homeAccountIdentifier,a,e.access_token,this.clientId,C||n.tenant||"",N.printScopes(),H,Y,this.cryptoObj.base64Decode,te,e.token_type,_,e.key_id,u.claims,u.requestedClaimsHash)}let R=null;if(e.refresh_token){let N;if(e.refresh_token_expires_in){const K=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;N=o+K}R=lY(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,_,N)}let z=null;return e.foci&&(z={clientId:this.clientId,environment:a,familyId:e.foci}),{account:k,idToken:A,accessToken:O,refreshToken:R,appMetadata:z}}static async generateAuthenticationResult(e,n,o,u,d,_,v,a,C){let A=Ot.EMPTY_STRING,k=[],O=null,R,z,N=Ot.EMPTY_STRING;if(o.accessToken){if(o.accessToken.tokenType===bi.POP&&!d.popKid){const H=new b_(e),{secret:Y,keyId:te}=o.accessToken;if(!te)throw Xt(Q5);A=await H.signPopToken(Y,te,d)}else A=o.accessToken.secret;k=Co.fromString(o.accessToken.target).asArray(),O=new Date(Number(o.accessToken.expiresOn)*1e3),R=new Date(Number(o.accessToken.extendedExpiresOn)*1e3),o.accessToken.refreshOn&&(z=new Date(Number(o.accessToken.refreshOn)*1e3))}o.appMetadata&&(N=o.appMetadata.familyId===jx?jx:"");const K=_?.oid||_?.sub||"",q=_?.tid||"";a?.spa_accountid&&o.account&&(o.account.nativeAccountId=a?.spa_accountid);const j=o.account?lL(o.account.getAccountInfo(),void 0,_,o.idToken?.secret):null;return{authority:n.canonicalAuthority,uniqueId:K,tenantId:q,scopes:k,account:j,idToken:o?.idToken?.secret||"",idTokenClaims:_||{},accessToken:A,fromCache:u,expiresOn:O,extExpiresOn:R,refreshOn:z,correlationId:d.correlationId,requestId:C||Ot.EMPTY_STRING,familyId:N,tokenType:o.accessToken?.tokenType||Ot.EMPTY_STRING,state:v?v.userRequestState:Ot.EMPTY_STRING,cloudGraphHostName:o.account?.cloudGraphHostName||Ot.EMPTY_STRING,msGraphHost:o.account?.msGraphHost||Ot.EMPTY_STRING,code:a?.spa_code,fromNativeBroker:!1}}}function dL(t,e,n,o,u,d,_,v,a,C,A){A?.verbose("setCachedAccount called");const O=t.getAccountKeys().find(q=>q.startsWith(n));let R=null;O&&(R=t.getAccount(O,A));const z=R||Zo.createAccount({homeAccountId:n,idTokenClaims:u,clientInfo:d,environment:_,cloudGraphHostName:a?.cloud_graph_host_name,msGraphHost:a?.msgraph_host,nativeAccountId:C},e,o),N=z.tenantProfiles||[],K=v||z.realm;if(K&&!N.find(q=>q.tenantId===K)){const q=aL(n,z.localAccountId,K,u);N.push(q)}return z.tenantProfiles=N,z}/*! @azure/msal-common v14.14.0 2024-07-23 */class _Y extends uL{constructor(e,n){super(e,n),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(vt.GetAuthCodeUrl,e.correlationId);const n=await hr(this.createAuthCodeUrlQueryString.bind(this),vt.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return ei.appendQueryString(this.authority.authorizationEndpoint,n)}async acquireToken(e,n){if(this.performanceClient?.addQueueMeasurement(vt.AuthClientAcquireToken,e.correlationId),!e.code)throw Xt(BK);const o=gu(),u=await hr(this.executeTokenRequest.bind(this),vt.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),d=u.headers?.[au.X_MS_REQUEST_ID],_=new fm(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return _.validateTokenResponse(u.body),hr(_.handleServerTokenResponse.bind(_),vt.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(u.body,this.authority,o,e,n,void 0,void 0,void 0,d)}handleFragmentResponse(e,n){if(new fm(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,n),!e.code)throw Xt($K);return e}getLogoutUri(e){if(!e)throw Mi(XK);const n=this.createLogoutUrlQueryString(e);return ei.appendQueryString(this.authority.endSessionEndpoint,n)}async executeTokenRequest(e,n){this.performanceClient?.addQueueMeasurement(vt.AuthClientExecuteTokenRequest,n.correlationId);const o=this.createTokenQueryParameters(n),u=ei.appendQueryString(e.tokenEndpoint,o),d=await hr(this.createTokenRequestBody.bind(this),vt.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,n.correlationId)(n);let _;if(n.clientInfo)try{const C=JS(n.clientInfo,this.cryptoUtils.base64Decode);_={credential:`${C.uid}${Us.CLIENT_INFO_SEPARATOR}${C.utid}`,type:qa.HOME_ACCOUNT_ID}}catch(C){this.logger.verbose("Could not parse client info for CCS Header: "+C)}const v=this.createTokenRequestHeaders(_||n.ccsCredential),a={clientId:n.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid};return hr(this.executePostToTokenEndpoint.bind(this),vt.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,n.correlationId)(u,d,v,a,n.correlationId,vt.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(vt.AuthClientCreateTokenRequestBody,e.correlationId);const n=new Hx;if(n.addClientId(e.tokenBodyParameters?.[v_]||this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):ng.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!$4(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const d=this.config.clientCredentials.clientAssertion;n.addClientAssertion(await hY(d.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(d.assertionType)}if(n.addGrantType(SK.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===bi.POP){const d=new b_(this.cryptoUtils,this.performanceClient);let _;e.popKid?_=this.cryptoUtils.encodeKid(e.popKid):_=(await hr(d.generateCnf.bind(d),vt.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(_)}else if(e.authenticationScheme===bi.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw Mi(HA);const o=e.correlationId||this.config.cryptoInterface.createNewGuid();n.addCorrelationId(o),(!bc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities);let u;if(e.clientInfo)try{const d=JS(e.clientInfo,this.cryptoUtils.base64Decode);u={credential:`${d.uid}${Us.CLIENT_INFO_SEPARATOR}${d.utid}`,type:qa.HOME_ACCOUNT_ID}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}else u=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&u)switch(u.type){case qa.HOME_ACCOUNT_ID:try{const d=Sg(u.credential);n.addCcsOid(d)}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case qa.UPN:n.addCcsUpn(u.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[o7])&&n.addExtraQueryParameters({[o7]:"1"}),n.createQueryString()}async createAuthCodeUrlQueryString(e){this.performanceClient?.addQueueMeasurement(vt.AuthClientCreateQueryString,e.correlationId);const n=new Hx;n.addClientId(e.extraQueryParameters?.[v_]||this.config.authOptions.clientId);const o=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(o,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);const u=e.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(u),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),$4(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==as.SELECT_ACCOUNT)if(e.sid&&e.prompt===as.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const d=this.extractAccountSid(e.account);let _=this.extractLoginHint(e.account);if(_&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),_=null),_){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(_);try{const v=Sg(e.account.homeAccountId);n.addCcsOid(v)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(d&&e.prompt===as.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(d);try{const v=Sg(e.account.homeAccountId);n.addCcsOid(v)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const v=Sg(e.account.homeAccountId);n.addCcsOid(v)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===bi.POP)){const d=new b_(this.cryptoUtils);let _;e.popKid?_=this.cryptoUtils.encodeKid(e.popKid):_=(await hr(d.generateCnf.bind(d),vt.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(_)}return n.createQueryString()}createLogoutUrlQueryString(e){const n=new Hx;return e.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&n.addCorrelationId(e.correlationId),e.idTokenHint&&n.addIdTokenHint(e.idTokenHint),e.state&&n.addState(e.state),e.logoutHint&&n.addLogoutHint(e.logoutHint),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),n.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}/*! @azure/msal-common v14.14.0 2024-07-23 */const LCe=300;class V4 extends uL{constructor(e,n){super(e,n)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(vt.RefreshTokenClientAcquireToken,e.correlationId);const n=gu(),o=await hr(this.executeTokenRequest.bind(this),vt.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),u=o.headers?.[au.X_MS_REQUEST_ID],d=new fm(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return d.validateTokenResponse(o.body),hr(d.handleServerTokenResponse.bind(d),vt.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,u)}async acquireTokenByRefreshToken(e){if(!e)throw Mi(ZK);if(this.performanceClient?.addQueueMeasurement(vt.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw Xt(Z5);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await hr(this.acquireTokenWithCachedRefreshToken.bind(this),vt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){const u=o instanceof Sc&&o.errorCode===tT,d=o instanceof hf&&o.errorCode===G9.INVALID_GRANT_ERROR&&o.subError===G9.CLIENT_MISMATCH_ERROR;if(u||d)return hr(this.acquireTokenWithCachedRefreshToken.bind(this),vt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return hr(this.acquireTokenWithCachedRefreshToken.bind(this),vt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,n){this.performanceClient?.addQueueMeasurement(vt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const o=Tm(this.cacheManager.getRefreshToken.bind(this.cacheManager),vt.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,n,void 0,this.performanceClient,e.correlationId);if(!o)throw j4(tT);if(o.expiresOn&&U4(o.expiresOn,e.refreshTokenExpirationOffsetSeconds||LCe))throw j4(hL);const u={...e,refreshToken:o.secret,authenticationScheme:e.authenticationScheme||bi.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:qa.HOME_ACCOUNT_ID}};try{return await hr(this.acquireToken.bind(this),vt.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(u)}catch(d){if(d instanceof Sc&&d.subError===KA){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const _=Eg(o);this.cacheManager.removeRefreshToken(_)}throw d}}async executeTokenRequest(e,n){this.performanceClient?.addQueueMeasurement(vt.RefreshTokenClientExecuteTokenRequest,e.correlationId);const o=this.createTokenQueryParameters(e),u=ei.appendQueryString(n.tokenEndpoint,o),d=await hr(this.createTokenRequestBody.bind(this),vt.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),_=this.createTokenRequestHeaders(e.ccsCredential),v={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return hr(this.executePostToTokenEndpoint.bind(this),vt.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(u,d,_,v,e.correlationId,vt.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(vt.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const n=e.correlationId,o=new Hx;if(o.addClientId(e.tokenBodyParameters?.[v_]||this.config.authOptions.clientId),e.redirectUri&&o.addRedirectUri(e.redirectUri),o.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),o.addGrantType(SK.REFRESH_TOKEN_GRANT),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&!$4(this.config)&&o.addServerTelemetry(this.serverTelemetryManager),o.addCorrelationId(n),o.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const u=this.config.clientCredentials.clientAssertion;o.addClientAssertion(await hY(u.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),o.addClientAssertionType(u.assertionType)}if(e.authenticationScheme===bi.POP){const u=new b_(this.cryptoUtils,this.performanceClient);let d;e.popKid?d=this.cryptoUtils.encodeKid(e.popKid):d=(await hr(u.generateCnf.bind(u),vt.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,o.addPopToken(d)}else if(e.authenticationScheme===bi.SSH)if(e.sshJwk)o.addSshJwk(e.sshJwk);else throw Mi(HA);if((!bc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case qa.HOME_ACCOUNT_ID:try{const u=Sg(e.ccsCredential.credential);o.addCcsOid(u)}catch(u){this.logger.verbose("Could not parse home account ID for CCS Header: "+u)}break;case qa.UPN:o.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&o.addExtraQueryParameters(e.tokenBodyParameters),o.createQueryString()}}/*! @azure/msal-common v14.14.0 2024-07-23 */class BCe extends uL{constructor(e,n){super(e,n)}async acquireToken(e){try{const[n,o]=await this.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...N_]});return o===Id.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new V4(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),n}catch(n){if(n instanceof VA&&n.errorCode===ch)return new V4(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw n}}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(vt.SilentFlowClientAcquireCachedToken,e.correlationId);let n=Id.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!bc.isEmptyObj(e.claims))throw this.setCacheOutcome(Id.FORCE_REFRESH_OR_CLAIMS,e.correlationId),Xt(ch);if(!e.account)throw Xt(Z5);const o=e.account.tenantId||Rwe(e.authority),u=this.cacheManager.getTokenKeys(),d=this.cacheManager.getAccessToken(e.account,e,u,o,this.performanceClient,e.correlationId);if(d){if(xwe(d.cachedAt)||U4(d.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Id.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),Xt(ch);d.refreshOn&&U4(d.refreshOn,0)&&(n=Id.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Id.NO_CACHED_ACCESS_TOKEN,e.correlationId),Xt(ch);const _=e.authority||this.authority.getPreferredCache(),v={account:this.cacheManager.readAccountFromCache(e.account),accessToken:d,idToken:this.cacheManager.getIdToken(e.account,u,o,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(_)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await hr(this.generateResultFromCacheRecord.bind(this),vt.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(v,e),n]}setCacheOutcome(e,n){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},n),e!==Id.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,n){this.performanceClient?.addQueueMeasurement(vt.SilentFlowClientGenerateResultFromCacheRecord,n.correlationId);let o;if(e.idToken&&(o=Sm(e.idToken.secret,this.config.cryptoInterface.base64Decode)),n.maxAge||n.maxAge===0){const u=o?.auth_time;if(!u)throw Xt(Y5);HK(u,n.maxAge)}return fm.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,o)}}/*! @azure/msal-common v14.14.0 2024-07-23 */const FCe={sendGetRequestAsync:()=>Promise.reject(Xt(Rn)),sendPostRequestAsync:()=>Promise.reject(Xt(Rn))};/*! @azure/msal-common v14.14.0 2024-07-23 */const yY="missing_kid_error",vY="missing_alg_error";/*! @azure/msal-common v14.14.0 2024-07-23 */const zCe={[yY]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[vY]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class fL extends go{constructor(e,n){super(e,n),this.name="JoseHeaderError",Object.setPrototypeOf(this,fL.prototype)}}function l7(t){return new fL(t,zCe[t])}/*! @azure/msal-common v14.14.0 2024-07-23 */class pL{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw l7(yY);if(!e.alg)throw l7(vY);const n=new pL({typ:e.typ||Kbe.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(n)}}/*! @azure/msal-common v14.14.0 2024-07-23 */const c7=",",xY="|";function NCe(t){const{skus:e,libraryName:n,libraryVersion:o,extensionName:u,extensionVersion:d}=t,_=new Map([[0,[n,o]],[2,[u,d]]]);let v=[];if(e?.length){if(v=e.split(c7),v.length<4)return e}else v=Array.from({length:4},()=>xY);return _.forEach((a,C)=>{a.length===2&&a[0]?.length&&a[1]?.length&&UCe({skuArr:v,index:C,skuName:a[0],skuVersion:a[1]})}),v.join(c7)}function UCe(t){const{skuArr:e,index:n,skuName:o,skuVersion:u}=t;n>=e.length||(e[n]=[o,u].join(xY))}class R1{constructor(e,n){this.cacheOutcome=Id.NOT_APPLICABLE,this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Ot.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Ot.EMPTY_STRING,this.telemetryCacheKey=vs.CACHE_KEY+Us.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${vs.VALUE_SEPARATOR}${this.cacheOutcome}`,n=[this.wrapperSKU,this.wrapperVer],o=this.getNativeBrokerErrorCode();o?.length&&n.push(`broker_error=${o}`);const u=n.join(vs.VALUE_SEPARATOR),d=this.getRegionDiscoveryFields(),_=[e,d].join(vs.VALUE_SEPARATOR);return[vs.SCHEMA_VERSION,_,u].join(vs.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),n=R1.maxErrorsToSend(e),o=e.failedRequests.slice(0,2*n).join(vs.VALUE_SEPARATOR),u=e.errors.slice(0,n).join(vs.VALUE_SEPARATOR),d=e.errors.length,_=n<d?vs.OVERFLOW_TRUE:vs.OVERFLOW_FALSE,v=[d,_].join(vs.VALUE_SEPARATOR);return[vs.SCHEMA_VERSION,e.cacheHits,o,u,v].join(vs.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const n=this.getLastRequests();n.errors.length>=vs.MAX_CACHED_ERRORS&&(n.failedRequests.shift(),n.failedRequests.shift(),n.errors.shift()),n.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof go?e.subError?n.errors.push(e.subError):e.errorCode?n.errors.push(e.errorCode):n.errors.push(e.toString()):n.errors.push(e.toString()):n.errors.push(vs.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),n=R1.maxErrorsToSend(e),o=e.errors.length;if(n===o)this.cacheManager.removeItem(this.telemetryCacheKey);else{const u={failedRequests:e.failedRequests.slice(n*2),errors:e.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,u)}}static maxErrorsToSend(e){let n,o=0,u=0;const d=e.errors.length;for(n=0;n<d;n++){const _=e.failedRequests[2*n]||Ot.EMPTY_STRING,v=e.failedRequests[2*n+1]||Ot.EMPTY_STRING,a=e.errors[n]||Ot.EMPTY_STRING;if(u+=_.toString().length+v.toString().length+a.length+3,u<vs.MAX_LAST_HEADER_BYTES)o+=1;else break}return o}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Ot.EMPTY_STRING),e.push(this.regionSource||Ot.EMPTY_STRING),e.push(this.regionOutcome||Ot.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const n=this.getLastRequests();n.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return NCe(e)}}/*! @azure/msal-common v14.14.0 2024-07-23 */class u7{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class $Ce{generateId(){return"callback-id"}startMeasurement(e,n){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:vwe.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:n||""},measurement:new u7}}startPerformanceMeasurement(){return new u7}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const mL="pkce_not_created",bY="crypto_nonexistent",YA="empty_navigate_uri",wY="hash_empty_error",gL="no_state_in_hash",CY="hash_does_not_contain_known_properties",EY="unable_to_parse_state",SY="state_interaction_type_mismatch",TY="interaction_in_progress",AY="popup_window_error",IY="empty_window_error",pm="user_cancelled",jCe="monitor_popup_timeout",MY="monitor_window_timeout",PY="redirect_in_iframe",RY="block_iframe_reload",kY="block_nested_popups",VCe="iframe_closed_prematurely",ZA="silent_logout_unsupported",DY="no_account_error",HCe="silent_prompt_value_error",OY="no_token_request_cache_error",LY="unable_to_parse_token_request_cache_error",_L="no_cached_authority_error",GCe="auth_request_not_set_error",WCe="invalid_cache_type",yL="non_browser_environment",ig="database_not_open",rT="no_network_connectivity",BY="post_request_failed",FY="get_request_failed",H4="failed_to_parse_response",zY="unable_to_load_token",vL="crypto_key_not_found",NY="auth_code_required",UY="auth_code_or_nativeAccountId_required",$Y="spa_code_and_nativeAccountId_present",xL="database_unavailable",jY="unable_to_acquire_token_from_native_platform",VY="native_handshake_timeout",HY="native_extension_not_installed",eb="native_connection_not_established",GY="uninitialized_public_client_application",WY="native_prompt_not_supported",qY="invalid_base64_string",KY="invalid_pop_token_request";/*! @azure/msal-browser v3.20.0 2024-07-23 */const Yu="For more visit: aka.ms/msaljs/browser-errors",qCe={[mL]:"The PKCE code challenge and verifier could not be generated.",[bY]:"The crypto object or function is not available.",[YA]:"Navigation URI is empty. Please check stack trace for more info.",[wY]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Yu}`,[gL]:"Hash does not contain state. Please verify that the request originated from msal.",[CY]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Yu}`,[EY]:"Unable to parse state. Please verify that the request originated from msal.",[SY]:"Hash contains state but the interaction type does not match the caller.",[TY]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Yu}`,[AY]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[IY]:"window.open returned null or undefined window object.",[pm]:"User cancelled the flow.",[jCe]:`Token acquisition in popup failed due to timeout.  ${Yu}`,[MY]:`Token acquisition in iframe failed due to timeout.  ${Yu}`,[PY]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[RY]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Yu}`,[kY]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[VCe]:"The iframe being monitored was closed prematurely.",[ZA]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[DY]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[HCe]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[OY]:"No token request found in cache.",[LY]:"The cached token request could not be parsed.",[_L]:"No cached authority found.",[GCe]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[WCe]:"Invalid cache type",[yL]:"Login and token requests are not supported in non-browser environments.",[ig]:"Database is not open!",[rT]:"No network connectivity. Check your internet connection.",[BY]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[FY]:"Network request failed. Please check the network trace to determine root cause.",[H4]:"Failed to parse network response. Check network trace.",[zY]:"Error loading token to cache.",[vL]:"Cryptographic Key or Keypair not found in browser storage.",[NY]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[UY]:"An authorization code or nativeAccountId must be provided to this flow.",[$Y]:"Request cannot contain both spa code and native account id.",[xL]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[jY]:`Unable to acquire token from native platform.  ${Yu}`,[VY]:"Timed out while attempting to establish connection to browser extension",[HY]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[eb]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Yu}`,[GY]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Yu}`,[WY]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[qY]:"Invalid base64 encoded string.",[KY]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."};class tb extends go{constructor(e){super(e,qCe[e]),Object.setPrototypeOf(this,tb.prototype),this.name="BrowserAuthError"}}function Fr(t){return new tb(t)}/*! @azure/msal-browser v3.20.0 2024-07-23 */const Tl={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Tg={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Vp={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},Ko={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},h7={GET:"GET",POST:"POST"},mi={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Td={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},KC={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Ni={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var qr;(function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"})(qr||(qr={}));const ns={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},d7={scopes:N_},YY="jwk",KCe={React:"@azure/msal-react",Angular:"@azure/msal-angular"},G4="msal.db",YCe=1,ZCe=`${G4}.keys`,Fa={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},XCe=[Fa.Default,Fa.Skip,Fa.RefreshTokenAndNetwork],QCe="msal.browser.log.level",JCe="msal.browser.log.pii";/*! @azure/msal-browser v3.20.0 2024-07-23 */function YC(t){return encodeURIComponent(bL(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function XA(t){return ZY(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bL(t){return ZY(new TextEncoder().encode(t))}function ZY(t){const e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}/*! @azure/msal-browser v3.20.0 2024-07-23 */const eEe="RSASSA-PKCS1-v1_5",XY="SHA-256",tEe=2048,rEe=new Uint8Array([1,0,1]),f7="0123456789abcdef",p7=new Uint32Array(1),wL={name:eEe,hash:XY,modulusLength:tEe,publicExponent:rEe};function nEe(t){if("crypto"in window)t.verbose("BrowserCrypto: modern crypto interface available");else throw t.error("BrowserCrypto: crypto interface is unavailable"),Fr(bY)}async function QY(t,e,n){e?.addQueueMeasurement(vt.Sha256Digest,n);const u=new TextEncoder().encode(t);return window.crypto.subtle.digest(XY,u)}function iEe(t){return window.crypto.getRandomValues(t)}function ER(){return window.crypto.getRandomValues(p7),p7[0]}function bh(){const t=Date.now(),e=ER()*1024+(ER()&1023),n=new Uint8Array(16),o=Math.trunc(e/2**30),u=e&2**30-1,d=ER();n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/2**16,n[4]=t/2**8,n[5]=t,n[6]=112|o>>>8,n[7]=o,n[8]=128|u>>>24,n[9]=u>>>16,n[10]=u>>>8,n[11]=u,n[12]=d>>>24,n[13]=d>>>16,n[14]=d>>>8,n[15]=d;let _="";for(let v=0;v<n.length;v++)_+=f7.charAt(n[v]>>>4),_+=f7.charAt(n[v]&15),(v===3||v===5||v===7||v===9)&&(_+="-");return _}async function oEe(t,e){return window.crypto.subtle.generateKey(wL,t,e)}async function SR(t){return window.crypto.subtle.exportKey(YY,t)}async function sEe(t,e,n){return window.crypto.subtle.importKey(YY,t,wL,e,n)}async function aEe(t,e){return window.crypto.subtle.sign(wL,t,e)}async function JY(t){const e=await QY(t),n=new Uint8Array(e);return XA(n)}/*! @azure/msal-browser v3.20.0 2024-07-23 */const nT="storage_not_supported",Lo="stubbed_public_client_application_called",iT="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.20.0 2024-07-23 */const FE={[nT]:"Given storage configuration option was not supported.",[Lo]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[iT]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};FE[nT],FE[Lo],FE[iT];class CL extends go{constructor(e,n){super(e,n),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,CL.prototype)}}function Go(t){return new CL(t,FE[t])}/*! @azure/msal-browser v3.20.0 2024-07-23 */function lEe(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function cEe(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function EL(){return window.parent!==window}function uEe(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Tl.POPUP_NAME_PREFIX}.`)===0}function uh(){return window.location.href.split("?")[0].split("#")[0]}function hEe(){const e=new ei(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function dEe(){if(ei.hashContainsKnownProperties(window.location.hash)&&EL())throw Fr(RY)}function fEe(t){if(EL()&&!t)throw Fr(PY)}function pEe(){if(uEe())throw Fr(kY)}function mEe(){if(typeof window>"u")throw Fr(yL)}function eZ(t){if(!t)throw Fr(GY)}function SL(t){mEe(),dEe(),pEe(),eZ(t)}function m7(t,e){if(SL(t),fEe(e.system.allowRedirectInIframe),e.cache.cacheLocation===Ko.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Go(iT)}function tZ(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class oT{navigateInternal(e,n){return oT.defaultNavigateWindow(e,n)}navigateExternal(e,n){return oT.defaultNavigateWindow(e,n)}static defaultNavigateWindow(e,n){return n.noHistory?window.location.replace(e):window.location.assign(e),new Promise(o=>{setTimeout(()=>{o(!0)},n.timeout)})}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class gEe{async sendGetRequestAsync(e,n){let o;try{o=await fetch(e,{method:h7.GET,headers:this.getFetchHeaders(n)})}catch{throw window.navigator.onLine?Fr(FY):Fr(rT)}try{return{headers:this.getHeaderDict(o.headers),body:await o.json(),status:o.status}}catch{throw Fr(H4)}}async sendPostRequestAsync(e,n){const o=n&&n.body||Ot.EMPTY_STRING;let u;try{u=await fetch(e,{method:h7.POST,headers:this.getFetchHeaders(n),body:o})}catch{throw window.navigator.onLine?Fr(BY):Fr(rT)}try{return{headers:this.getHeaderDict(u.headers),body:await u.json(),status:u.status}}catch{throw Fr(H4)}}getFetchHeaders(e){const n=new Headers;if(!(e&&e.headers))return n;const o=e.headers;return Object.keys(o).forEach(u=>{n.append(u,o[u])}),n}getHeaderDict(e){const n={};return e.forEach((o,u)=>{n[u]=o}),n}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const _Ee=6e4,W4=1e4,yEe=3e4,vEe=2e3;function xEe({auth:t,cache:e,system:n,telemetry:o},u){const d={clientId:Ot.EMPTY_STRING,authority:`${Ot.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Ot.EMPTY_STRING,authorityMetadata:Ot.EMPTY_STRING,redirectUri:Ot.EMPTY_STRING,postLogoutRedirectUri:Ot.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:fh.AAD,OIDCOptions:{serverResponseType:J1.FRAGMENT,defaultScopes:[Ot.OPENID_SCOPE,Ot.PROFILE_SCOPE,Ot.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:iL.None,tenant:Ot.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},_={cacheLocation:Ko.SessionStorage,temporaryCacheLocation:Ko.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===Ko.LocalStorage),claimsBasedCachingEnabled:!1},v={loggerCallback:()=>{},logLevel:Gi.Info,piiLoggingEnabled:!1},C={...{...mY,loggerOptions:v,networkClient:u?new gEe:FCe,navigationClient:new oT,loadFrameTimeout:0,windowHashTimeout:n?.loadFrameTimeout||_Ee,iframeHashTimeout:n?.loadFrameTimeout||W4,navigateFrameWait:0,redirectNavigationTimeout:yEe,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:n?.nativeBrokerHandshakeTimeout||vEe,pollIntervalMilliseconds:Tl.DEFAULT_POLL_INTERVAL_MS},...n,loggerOptions:n?.loggerOptions||v},A={application:{appName:Ot.EMPTY_STRING,appVersion:Ot.EMPTY_STRING},client:new $Ce};if(t?.protocolMode!==fh.OIDC&&t?.OIDCOptions&&new uf(C.loggerOptions).warning(JSON.stringify(Mi(rY))),t?.protocolMode&&t.protocolMode!==fh.AAD&&C?.allowNativeBroker)throw Mi(nY);return{auth:{...d,...t,OIDCOptions:{...d.OIDCOptions,...t?.OIDCOptions}},cache:{..._,...e},system:C,telemetry:{...A,...o}}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const bEe="@azure/msal-browser",QA="3.20.0";/*! @azure/msal-browser v3.20.0 2024-07-23 */class TL{static loggerCallback(e,n){switch(e){case Gi.Error:console.error(n);return;case Gi.Info:console.info(n);return;case Gi.Verbose:console.debug(n);return;case Gi.Warning:console.warn(n);return;default:console.log(n);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=xEe(e,this.browserEnvironment);let n;try{n=window[Ko.SessionStorage]}catch{}const o=n?.getItem(QCe),u=n?.getItem(JCe)?.toLowerCase(),d=u==="true"?!0:u==="false"?!1:void 0,_={...this.config.system.loggerOptions},v=o&&Object.keys(Gi).includes(o)?Gi[o]:void 0;v&&(_.loggerCallback=TL.loggerCallback,_.logLevel=v),d!==void 0&&(_.piiLoggingEnabled=d),this.logger=new uf(_,bEe,QA),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class mm extends TL{getModuleName(){return mm.MODULE_NAME}getId(){return mm.ID}async initialize(){return this.available=typeof window<"u",this.available}}mm.MODULE_NAME="";mm.ID="StandardOperatingContext";/*! @azure/msal-browser v3.20.0 2024-07-23 */function fu(t){return new TextDecoder().decode(wEe(t))}function wEe(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Fr(qY)}const n=atob(e);return Uint8Array.from(n,o=>o.codePointAt(0)||0)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class CEe{constructor(){this.dbName=G4,this.version=YCe,this.tableName=ZCe,this.dbOpen=!1}async open(){return new Promise((e,n)=>{const o=window.indexedDB.open(this.dbName,this.version);o.addEventListener("upgradeneeded",u=>{u.target.result.createObjectStore(this.tableName)}),o.addEventListener("success",u=>{const d=u;this.db=d.target.result,this.dbOpen=!0,e()}),o.addEventListener("error",()=>n(Fr(xL)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((n,o)=>{if(!this.db)return o(Fr(ig));const _=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);_.addEventListener("success",v=>{const a=v;this.closeConnection(),n(a.target.result)}),_.addEventListener("error",v=>{this.closeConnection(),o(v)})})}async setItem(e,n){return await this.validateDbIsOpen(),new Promise((o,u)=>{if(!this.db)return u(Fr(ig));const v=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(n,e);v.addEventListener("success",()=>{this.closeConnection(),o()}),v.addEventListener("error",a=>{this.closeConnection(),u(a)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((n,o)=>{if(!this.db)return o(Fr(ig));const _=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);_.addEventListener("success",()=>{this.closeConnection(),n()}),_.addEventListener("error",v=>{this.closeConnection(),o(v)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,n)=>{if(!this.db)return n(Fr(ig));const d=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();d.addEventListener("success",_=>{const v=_;this.closeConnection(),e(v.target.result)}),d.addEventListener("error",_=>{this.closeConnection(),n(_)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((n,o)=>{if(!this.db)return o(Fr(ig));const _=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);_.addEventListener("success",v=>{const a=v;this.closeConnection(),n(a.target.result===1)}),_.addEventListener("error",v=>{this.closeConnection(),o(v)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,n)=>{const o=window.indexedDB.deleteDatabase(G4),u=setTimeout(()=>n(!1),200);o.addEventListener("success",()=>(clearTimeout(u),e(!0))),o.addEventListener("blocked",()=>(clearTimeout(u),e(!0))),o.addEventListener("error",()=>(clearTimeout(u),n(!1)))})}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class q4{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,n){this.cache.set(e,n)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((n,o)=>{e.push(o)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class EEe{constructor(e){this.inMemoryCache=new q4,this.indexedDBCache=new CEe,this.logger=e}handleDatabaseAccessError(e){if(e instanceof tb&&e.errorCode===xL)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const n=this.inMemoryCache.getItem(e);if(!n)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(o){this.handleDatabaseAccessError(o)}return n}async setItem(e,n){this.inMemoryCache.setItem(e,n);try{await this.indexedDBCache.setItem(e,n)}catch(o){this.handleDatabaseAccessError(o)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(n){this.handleDatabaseAccessError(n)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(n){this.handleDatabaseAccessError(n)}return e}async containsKey(e){const n=this.inMemoryCache.containsKey(e);if(!n)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(o){this.handleDatabaseAccessError(o)}return n}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class w_{constructor(e,n){this.logger=e,nEe(e),this.cache=new EEe(this.logger),this.performanceClient=n}createNewGuid(){return bh()}base64Encode(e){return bL(e)}base64Decode(e){return fu(e)}base64UrlEncode(e){return YC(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const n=this.performanceClient?.startMeasurement(vt.CryptoOptsGetPublicKeyThumbprint,e.correlationId),o=await oEe(w_.EXTRACTABLE,w_.POP_KEY_USAGES),u=await SR(o.publicKey),d={e:u.e,kty:u.kty,n:u.n},_=g7(d),v=await this.hashString(_),a=await SR(o.privateKey),C=await sEe(a,!1,["sign"]);return await this.cache.setItem(v,{privateKey:C,publicKey:o.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),v}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,n,o,u){const d=this.performanceClient?.startMeasurement(vt.CryptoOptsSignJwt,u),_=await this.cache.getItem(n);if(!_)throw Fr(vL);const v=await SR(_.publicKey),a=g7(v),C=YC(JSON.stringify({kid:n})),A=pL.getShrHeaderString({...o?.header,alg:v.alg,kid:C}),k=YC(A);e.cnf={jwk:JSON.parse(a)};const O=YC(JSON.stringify(e)),R=`${k}.${O}`,N=new TextEncoder().encode(R),K=await aEe(_.privateKey,N),q=XA(new Uint8Array(K)),j=`${R}.${q}`;return d&&d.end({success:!0}),j}async hashString(e){return JY(e)}}w_.POP_KEY_USAGES=["sign","verify"];w_.EXTRACTABLE=!0;function g7(t){return JSON.stringify(t,Object.keys(t).sort())}/*! @azure/msal-browser v3.20.0 2024-07-23 */class _7{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==Ko.LocalStorage&&e!==Ko.SessionStorage||!window[e])throw Go(nT)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,n){this.windowStorage.setItem(e,n)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */function rZ(t,e){if(!e)return null;try{return wc.parseRequestState(t,e).libraryState.meta}catch{throw Xt(y_)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class K4 extends x_{constructor(e,n,o,u,d,_){super(e,o,u,d),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=n,this.logger=u,this.internalStorage=new q4,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=_}setupBrowserStorage(e){switch(e){case Ko.LocalStorage:case Ko.SessionStorage:try{return new _7(e)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=Ko.MemoryStorage,new q4}setupTemporaryCacheStorage(e,n){switch(n){case Ko.LocalStorage:case Ko.SessionStorage:try{return new _7(e||Ko.SessionStorage)}catch(o){return this.logger.verbose(o),this.internalStorage}case Ko.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const e=`${Ot.CACHE_PREFIX}.${rs.ID_TOKEN}`,n=`${Ot.CACHE_PREFIX}.${rs.CLIENT_INFO}`,o=`${Ot.CACHE_PREFIX}.${rs.ERROR}`,u=`${Ot.CACHE_PREFIX}.${rs.ERROR_DESC}`,d=this.browserStorage.getItem(e),_=this.browserStorage.getItem(n),v=this.browserStorage.getItem(o),a=this.browserStorage.getItem(u),C=[d,_,v,a];[rs.ID_TOKEN,rs.CLIENT_INFO,rs.ERROR,rs.ERROR_DESC].forEach((k,O)=>{const R=C[O];R&&this.setTemporaryCache(k,R,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(Td.ACCOUNT_KEYS),n=this.getItem(`${Td.TOKEN_KEYS}.${this.clientId}`);if(e&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(u=>{if(this.isCredentialKey(u)){const d=this.getItem(u);if(d){const _=this.validateAndParseJson(d);if(_&&_.hasOwnProperty("credentialType"))switch(_.credentialType){case sn.ID_TOKEN:if(Q9(_)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${u} found, saving key to token key map`);const v=_,a=this.updateCredentialCacheKey(u,v);this.addTokenKey(a,sn.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${u}`);break;case sn.ACCESS_TOKEN:case sn.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(X9(_)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${u} found, saving key to token key map`);const v=_,a=this.updateCredentialCacheKey(u,v);this.addTokenKey(a,sn.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${u}`);break;case sn.REFRESH_TOKEN:if(J9(_)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${u} found, saving key to token key map`);const v=_,a=this.updateCredentialCacheKey(u,v);this.addTokenKey(a,sn.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${u}`);break}}}if(this.isAccountKey(u)){const d=this.getItem(u);if(d){const _=this.validateAndParseJson(d);_&&Zo.isAccountEntity(_)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${u} found, saving key to account key map`),this.addAccountKeyToMap(u))}}})}validateAndParseJson(e){try{const n=JSON.parse(e);return n&&typeof n=="object"?n:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,n){this.browserStorage.setItem(e,n)}getAccount(e,n){this.logger.trace("BrowserCacheManager.getAccount called");const o=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,o,n)}getCachedAccountEntity(e){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e),null;const o=this.validateAndParseJson(n);return!o||!Zo.isAccountEntity(o)?(this.removeAccountKeyFromMap(e),null):x_.toObject(new Zo,o)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();this.setItem(n,JSON.stringify(e)),this.addAccountKeyToMap(n)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(Td.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem(Td.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),o=n.indexOf(e);o>-1?(n.splice(o,1),this.setItem(Td.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,sn.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,sn.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,sn.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${Td.TOKEN_KEYS}.${this.clientId}`);if(e){const n=this.validateAndParseJson(e);if(n&&n.hasOwnProperty("idToken")&&n.hasOwnProperty("accessToken")&&n.hasOwnProperty("refreshToken"))return n;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,n){this.logger.trace("BrowserCacheManager addTokenKey called");const o=this.getTokenKeys();switch(n){case sn.ID_TOKEN:o.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(e));break;case sn.ACCESS_TOKEN:o.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),o.accessToken.push(e));break;case sn.REFRESH_TOKEN:o.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${n}`),Xt(N4)}this.setItem(`${Td.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(o))}removeTokenKey(e,n){this.logger.trace("BrowserCacheManager removeTokenKey called");const o=this.getTokenKeys();switch(n){case sn.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const u=o.idToken.indexOf(e);u>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),o.idToken.splice(u,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case sn.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const d=o.accessToken.indexOf(e);d>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),o.accessToken.splice(d,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case sn.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const _=o.refreshToken.indexOf(e);_>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),o.refreshToken.splice(_,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${n}`),Xt(N4)}this.setItem(`${Td.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(o))}getIdTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.ID_TOKEN),null;const o=this.validateAndParseJson(n);return!o||!Q9(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),o)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=Eg(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,sn.ID_TOKEN)}getAccessTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.ACCESS_TOKEN),null;const o=this.validateAndParseJson(n);return!o||!X9(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),o)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=Eg(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,sn.ACCESS_TOKEN)}getRefreshTokenCredential(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.REFRESH_TOKEN),null;const o=this.validateAndParseJson(n);return!o||!J9(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,sn.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),o)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=Eg(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,sn.REFRESH_TOKEN)}getAppMetadata(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const o=this.validateAndParseJson(n);return!o||!Mwe(e,o)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),o)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=Iwe(e);this.setItem(n,JSON.stringify(e))}getServerTelemetry(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const o=this.validateAndParseJson(n);return!o||!Twe(e,o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),o)}setServerTelemetry(e,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(n))}getAuthorityMetadata(e){const n=this.internalStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const o=this.validateAndParseJson(n);return o&&Pwe(e,o)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),o):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(n=>this.isAuthorityMetadata(n))}setWrapperMetadata(e,n){this.internalStorage.setItem(KC.WRAPPER_SKU,e),this.internalStorage.setItem(KC.WRAPPER_VER,n)}getWrapperMetadata(){const e=this.internalStorage.getItem(KC.WRAPPER_SKU)||Ot.EMPTY_STRING,n=this.internalStorage.getItem(KC.WRAPPER_VER)||Ot.EMPTY_STRING;return[e,n]}setAuthorityMetadata(e,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(n))}getActiveAccount(){const e=this.generateCacheKey(rs.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(e);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const u=this.generateCacheKey(rs.ACTIVE_ACCOUNT),d=this.getItem(u);if(!d)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const _=this.getAccountInfoFilteredBy({localAccountId:d});return _?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(_),_):null}const o=this.validateAndParseJson(n);return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:o.homeAccountId,localAccountId:o.localAccountId,tenantId:o.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const n=this.generateCacheKey(rs.ACTIVE_ACCOUNT_FILTERS),o=this.generateCacheKey(rs.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const u={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(n,JSON.stringify(u)),this.browserStorage.setItem(o,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(o)}getThrottlingCache(e){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const o=this.validateAndParseJson(n);return!o||!Awe(e,o)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),o)}setThrottlingCache(e,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(n))}getTemporaryCache(e,n){const o=n?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const d=this.getItemCookie(o);if(d)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),d}const u=this.temporaryCacheStorage.getItem(o);if(!u){if(this.cacheConfig.cacheLocation===Ko.LocalStorage){const d=this.browserStorage.getItem(o);if(d)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),d}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),u}setTemporaryCache(e,n,o){const u=o?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(u,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(u,n))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(Ot.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(Ot.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,n){e.addQueueMeasurement(vt.ClearTokensAndKeysWithClaims,n);const o=this.getTokenKeys(),u=[];o.accessToken.forEach(d=>{const _=this.getAccessTokenCredential(d);_?.requestedClaimsHash&&d.includes(_.requestedClaimsHash.toLowerCase())&&u.push(this.removeAccessToken(d))}),await Promise.all(u),u.length>0&&this.logger.warning(`${u.length} access tokens with claims in the cache keys have been removed from the cache.`)}setItemCookie(e,n,o){let u=`${encodeURIComponent(e)}=${encodeURIComponent(n)};path=/;SameSite=Lax;`;if(o){const d=this.getCookieExpirationTime(o);u+=`expires=${d};`}this.cacheConfig.secureCookies&&(u+="Secure;"),document.cookie=u}getItemCookie(e){const n=`${encodeURIComponent(e)}=`,o=document.cookie.split(";");for(let u=0;u<o.length;u++){let d=o[u];for(;d.charAt(0)===" ";)d=d.substring(1);if(d.indexOf(n)===0)return decodeURIComponent(d.substring(n.length,d.length))}return Ot.EMPTY_STRING}clearMsalCookies(){const e=`${Ot.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(o=>{for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(e)===0){const u=o.split("=")[0];this.clearItemCookie(u)}})}clearItemCookie(e){this.setItemCookie(e,Ot.EMPTY_STRING,-1)}getCookieExpirationTime(e){const n=new Date;return new Date(n.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):bc.startsWith(e,Ot.CACHE_PREFIX)||bc.startsWith(e,rs.ADAL_ID_TOKEN)?e:`${Ot.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:n}}=wc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${mi.AUTHORITY}.${n}`)}generateNonceKey(e){const{libraryState:{id:n}}=wc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${mi.NONCE_IDTOKEN}.${n}`)}generateStateKey(e){const{libraryState:{id:n}}=wc.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${mi.REQUEST_STATE}.${n}`)}getCachedAuthority(e){const n=this.generateStateKey(e),o=this.getTemporaryCache(n);if(!o)return null;const u=this.generateAuthorityKey(o);return this.getTemporaryCache(u)}updateCacheEntries(e,n,o,u,d){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const _=this.generateStateKey(e);this.setTemporaryCache(_,e,!1);const v=this.generateNonceKey(e);this.setTemporaryCache(v,n,!1);const a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,o,!1),d){const C={credential:d.homeAccountId,type:qa.HOME_ACCOUNT_ID};this.setTemporaryCache(mi.CCS_CREDENTIAL,JSON.stringify(C),!0)}else if(u){const C={credential:u,type:qa.UPN};this.setTemporaryCache(mi.CCS_CREDENTIAL,JSON.stringify(C),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(n=>{n.indexOf(e)!==-1&&this.removeTemporaryItem(n)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(mi.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(mi.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(mi.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(mi.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(mi.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(mi.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const n=this.generateStateKey(e),o=this.temporaryCacheStorage.getItem(n);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${o}`),this.resetRequestCache(o||Ot.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(n=>{if(n.indexOf(mi.REQUEST_STATE)===-1)return;const o=this.temporaryCacheStorage.getItem(n);if(!o)return;const u=rZ(this.cryptoImpl,o);u&&u.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${o}`),this.resetRequestCache(o))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const n=bL(JSON.stringify(e));this.setTemporaryCache(mi.REQUEST_PARAMS,n,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const n=this.getTemporaryCache(mi.REQUEST_PARAMS,!0);if(!n)throw Fr(OY);let o;try{o=JSON.parse(fu(n))}catch(u){throw this.logger.errorPii(`Attempted to parse: ${n}`),this.logger.error(`Parsing cached token request threw with error: ${u}`),Fr(LY)}if(this.removeTemporaryItem(this.generateCacheKey(mi.REQUEST_PARAMS)),!o.authority){const u=this.generateAuthorityKey(e),d=this.getTemporaryCache(u);if(!d)throw Fr(_L);o.authority=d}return o}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(mi.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const n=this.validateAndParseJson(e);return n||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const n=this.getInteractionInProgress();return e?n===this.clientId:!!n}getInteractionInProgress(){const e=`${Ot.CACHE_PREFIX}.${mi.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const n=`${Ot.CACHE_PREFIX}.${mi.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Fr(TY);this.setTemporaryCache(n,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(n)}getLegacyLoginHint(){const e=this.getTemporaryCache(rs.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(rs.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const n=this.getTemporaryCache(rs.ID_TOKEN,!0);n&&(this.browserStorage.removeItem(this.generateCacheKey(rs.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const o=n||e;if(o){const u=Sm(o,fu);if(u.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),u.preferred_username;if(u.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),u.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,n){const o=Eg(n);if(e!==o){const u=this.getItem(e);if(u)return this.browserStorage.removeItem(e),this.setItem(o,u),this.logger.verbose(`Updated an outdated ${n.credentialType} cache key`),o;this.logger.error(`Attempted to update an outdated ${n.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,n){const o=WA(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let u;n.claims&&(u=await this.cryptoImpl.hashString(n.claims));const d=qA(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,fu,void 0,e.tokenType,void 0,n.sshKid,n.claims,u),_={idToken:o,accessToken:d};return this.saveCacheRecord(_)}async saveCacheRecord(e,n,o){try{await super.saveCacheRecord(e,n,o)}catch(u){if(u instanceof jg&&this.performanceClient&&o)try{const d=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:d.refreshToken.length,cacheIdCount:d.idToken.length,cacheAtCount:d.accessToken.length},o)}catch{}throw u}}}const SEe=(t,e)=>{const n={cacheLocation:Ko.MemoryStorage,temporaryCacheLocation:Ko.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new K4(t,n,QS,e)};/*! @azure/msal-browser v3.20.0 2024-07-23 */function TEe(t,e,n,o){return t.verbose("getAllAccounts called"),n?e.getAllAccounts(o):[]}function AEe(t,e,n){if(e.trace("getAccount called"),Object.keys(t).length===0)return e.warning("getAccount: No accountFilter provided"),null;const o=n.getAccountInfoFilteredBy(t);return o?(e.verbose("getAccount: Account matching provided filter found, returning"),o):(e.verbose("getAccount: No matching account found, returning null"),null)}function IEe(t,e,n){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const o=n.getAccountInfoFilteredBy({username:t});return o?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),o):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function MEe(t,e,n){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=n.getAccountInfoFilteredBy({homeAccountId:t});return o?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),o):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function PEe(t,e,n){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const o=n.getAccountInfoFilteredBy({localAccountId:t});return o?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),o):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function REe(t,e){e.setActiveAccount(t)}function kEe(t){return t.getActiveAccount()}/*! @azure/msal-browser v3.20.0 2024-07-23 */const Or={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.20.0 2024-07-23 */class DEe{constructor(e,n){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=n,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if(typeof window<"u"){const n=bh();return this.eventCallbacks.set(n,e),this.logger.verbose(`Event callback registered with id: ${n}`),n}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,n,o,u){if(typeof window<"u"){const d={eventType:e,interactionType:n||null,payload:o||null,error:u||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach((_,v)=>{this.logger.verbose(`Emitting event to callback ${v}: ${e}`),_.apply(null,[d])})}}handleAccountCacheChange(e){try{e.key?.includes(rs.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(Or.ACTIVE_ACCOUNT_CHANGED);const n=e.newValue||e.oldValue;if(!n)return;const o=JSON.parse(n);if(typeof o!="object"||!Zo.isAccountEntity(o))return;const d=x_.toObject(new Zo,o).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Or.ACCOUNT_ADDED,void 0,d)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Or.ACCOUNT_REMOVED,void 0,d))}catch{return}}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class nZ{constructor(e,n,o,u,d,_,v,a,C){this.config=e,this.browserStorage=n,this.browserCrypto=o,this.networkClient=this.config.system.networkClient,this.eventHandler=d,this.navigationClient=_,this.nativeMessageHandler=a,this.correlationId=C||bh(),this.logger=u.clone(Tl.MSAL_SKU,QA,this.correlationId),this.performanceClient=v}async clearCacheOnLogout(e){if(e){Zo.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Zo.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const n=e||this.config.auth.redirectUri||uh();return ei.getAbsoluteUrl(n,uh())}initializeServerTelemetryManager(e,n){this.logger.verbose("initializeServerTelemetryManager called");const o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:n||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new R1(o,this.browserStorage)}async getDiscoveredAuthority(e,n,o){this.performanceClient.addQueueMeasurement(vt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const u={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},d=e||this.config.auth.authority,_=zs.generateAuthority(d,n||this.config.auth.azureCloudOptions),v=await hr(uY,vt.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(_,this.config.system.networkClient,this.browserStorage,u,this.logger,this.correlationId,this.performanceClient);if(o&&!v.isAlias(o.environment))throw Mi(iY);return v}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const OEe=32;async function LEe(t,e,n){t.addQueueMeasurement(vt.GeneratePkceCodes,n);const o=Tm(BEe,vt.GenerateCodeVerifier,e,t,n)(t,e,n),u=await hr(FEe,vt.GenerateCodeChallengeFromVerifier,e,t,n)(o,t,e,n);return{verifier:o,challenge:u}}function BEe(t,e,n){try{const o=new Uint8Array(OEe);return Tm(iEe,vt.GetRandomValues,e,t,n)(o),XA(o)}catch{throw Fr(mL)}}async function FEe(t,e,n,o){e.addQueueMeasurement(vt.GenerateCodeChallengeFromVerifier,o);try{const u=await hr(QY,vt.Sha256Digest,n,e,o)(t,e,o);return XA(new Uint8Array(u))}catch{throw Fr(mL)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */async function AL(t,e,n,o){n.addQueueMeasurement(vt.InitializeBaseRequest,t.correlationId);const u=t.authority||e.auth.authority,d=[...t&&t.scopes||[]],_={...t,correlationId:t.correlationId,authority:u,scopes:d};if(!_.authenticationScheme)_.authenticationScheme=bi.BEARER,o.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(_.authenticationScheme===bi.SSH){if(!t.sshJwk)throw Mi(HA);if(!t.sshKid)throw Mi(tY)}o.verbose(`Authentication Scheme set to "${_.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!bc.isEmptyObj(t.claims)&&(_.requestedClaimsHash=await JY(t.claims)),_}async function zEe(t,e,n,o,u){o.addQueueMeasurement(vt.InitializeSilentRequest,t.correlationId);const d=await hr(AL,vt.InitializeBaseRequest,u,o,t.correlationId)(t,n,o,u);return{...t,...d,account:e,forceRefresh:t.forceRefresh||!1}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class U_ extends nZ{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(vt.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const n=await hr(LEe,vt.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),o={...e,redirectUri:e.redirectUri,code:Ot.EMPTY_STRING,codeVerifier:n.verifier};return e.codeChallenge=n.challenge,e.codeChallengeMethod=Ot.S256_CODE_CHALLENGE_METHOD,o}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const n={correlationId:this.correlationId||bh(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const o=this.getLogoutHintFromIdTokenClaims(e.account);o&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=o)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=ei.getAbsoluteUrl(e.postLogoutRedirectUri,uh())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=ei.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,uh())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=ei.getAbsoluteUrl(uh(),uh())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n}getLogoutHintFromIdTokenClaims(e){const n=e.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e,n,o,u){this.performanceClient.addQueueMeasurement(vt.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const d=await hr(this.getClientConfiguration.bind(this),vt.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,n,o,u);return new _Y(d,this.performanceClient)}async getClientConfiguration(e,n,o,u){this.performanceClient.addQueueMeasurement(vt.StandardInteractionClientGetClientConfiguration,this.correlationId);const d=await hr(this.getDiscoveredAuthority.bind(this),vt.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(n,o,u),_=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:d,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:_.loggerCallback,piiLoggingEnabled:_.piiLoggingEnabled,logLevel:_.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Tl.MSAL_SKU,version:QA,cpu:Ot.EMPTY_STRING,os:Ot.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,n){this.performanceClient.addQueueMeasurement(vt.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const o=this.getRedirectUri(e.redirectUri),u={interactionType:n},d=wc.setRequestState(this.browserCrypto,e&&e.state||Ot.EMPTY_STRING,u),v={...await hr(AL,vt.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:o,state:d,nonce:e.nonce||bh(),responseMode:this.config.auth.OIDCOptions.serverResponseType},a=e.account||this.browserStorage.getActiveAccount();if(a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),v.account=a),!v.loginHint&&!a){const C=this.browserStorage.getLegacyLoginHint();C&&(v.loginHint=C)}return v}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const NEe="ContentError",iZ="user_switch";/*! @azure/msal-browser v3.20.0 2024-07-23 */const UEe="USER_INTERACTION_REQUIRED",$Ee="USER_CANCEL",jEe="NO_NETWORK",VEe="PERSISTENT_ERROR",HEe="DISABLED",GEe="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.20.0 2024-07-23 */const WEe=-2147186943,qEe={[iZ]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class ou extends go{constructor(e,n,o){super(e,n),Object.setPrototypeOf(this,ou.prototype),this.name="NativeAuthError",this.ext=o}}function og(t){if(t.ext&&t.ext.status&&(t.ext.status===VEe||t.ext.status===HEe)||t.ext&&t.ext.error&&t.ext.error===WEe)return!0;switch(t.errorCode){case NEe:return!0;default:return!1}}function Y4(t,e,n){if(n&&n.status)switch(n.status){case GEe:return j4(gY);case UEe:return new Sc(t,e);case $Ee:return Fr(pm);case jEe:return Fr(rT)}return new ou(t,qEe[t]||e,n)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class oZ extends U_{async acquireToken(e){this.performanceClient.addQueueMeasurement(vt.SilentCacheClientAcquireToken,e.correlationId);const n=this.initializeServerTelemetryManager(Ni.acquireTokenSilent_silentFlow),o=await hr(this.getClientConfiguration.bind(this),vt.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(n,e.authority,e.azureCloudOptions,e.account),u=new BCe(o,this.performanceClient);this.logger.verbose("Silent auth client created");try{const _=(await hr(u.acquireCachedToken.bind(u),vt.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),_}catch(d){throw d instanceof tb&&d.errorCode===vL&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),d}}logout(e){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(n?.account)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const TR={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"};class Vg extends nZ{constructor(e,n,o,u,d,_,v,a,C,A,k,O){super(e,n,o,u,d,_,a,C,O),this.apiId=v,this.accountId=A,this.nativeMessageHandler=C,this.nativeStorageManager=k,this.silentCacheClient=new oZ(e,this.nativeStorageManager,o,u,d,_,a,C,O),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const R=this.nativeMessageHandler.getExtensionId()===Tg.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=R1.makeExtraSkuString({libraryName:Tl.MSAL_SKU,libraryVersion:QA,extensionName:R,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[mCe]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(vt.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(vt.NativeInteractionClientAcquireToken,e.correlationId),o=gu();try{const u=await this.initializeNativeRequest(e);try{const C=await this.acquireTokensFromCache(this.accountId,u);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),C}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...d}=u,_={method:Vp.GetToken,request:d},v=await this.nativeMessageHandler.sendMessage(_),a=this.validateNativeResponse(v);return await this.handleNativeResponse(a,u,o).then(C=>(n.end({success:!0,isNativeBroker:!0,requestId:C.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),C)).catch(C=>{throw n.end({success:!1,errorCode:C.errorCode,subErrorCode:C.subError,isNativeBroker:!0}),C})}catch(u){throw u instanceof ou&&this.serverTelemetryManager.setNativeBrokerErrorCode(u.errorCode),u}}createSilentCacheRequest(e,n){return{authority:e.authority,correlationId:this.correlationId,scopes:Co.fromString(e.scope).asArray(),account:n,forceRefresh:!1}}async acquireTokensFromCache(e,n){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Xt(F4);const o=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!o)throw Xt(F4);try{const u=this.createSilentCacheRequest(n,o),d=await this.silentCacheClient.acquireToken(u),_={...o,idTokenClaims:d?.idTokenClaims,idToken:d?.idToken};return{...d,account:_}}catch(u){throw u}}async acquireTokenRedirect(e,n){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...o}=e;delete o.onRedirectNavigate;const u=await this.initializeNativeRequest(o),d={method:Vp.GetToken,request:u};try{const a=await this.nativeMessageHandler.sendMessage(d);this.validateNativeResponse(a)}catch(a){if(a instanceof ou&&(this.serverTelemetryManager.setNativeBrokerErrorCode(a.errorCode),og(a)))throw a}this.browserStorage.setTemporaryCache(mi.NATIVE_REQUEST,JSON.stringify(u),!0);const _={apiId:Ni.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);n.end({success:!0}),await this.navigationClient.navigateExternal(v,_)}async handleRedirectPromise(e,n){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const o=this.browserStorage.getCachedNativeRequest();if(!o)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&n&&e?.addFields({errorCode:"no_cached_request"},n),null;const{prompt:u,...d}=o;u&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(mi.NATIVE_REQUEST));const _={method:Vp.GetToken,request:d},v=gu();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const a=await this.nativeMessageHandler.sendMessage(_);this.validateNativeResponse(a);const C=this.handleNativeResponse(a,d,v);this.browserStorage.setInteractionInProgress(!1);const A=await C;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),A}catch(a){throw this.browserStorage.setInteractionInProgress(!1),a}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,n,o){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const u=Sm(e.id_token,fu),d=this.createHomeAccountIdentifier(e,u),_=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId})?.homeAccountId;if(d!==_&&e.account.id!==n.accountId)throw Y4(iZ);const v=await this.getDiscoveredAuthority(n.authority),a=dL(this.browserStorage,v,d,fu,u,e.client_info,void 0,u.tid,void 0,e.account.id,this.logger),C=await this.generateAuthenticationResult(e,n,u,a,v.canonicalAuthority,o);return this.cacheAccount(a),this.cacheNativeTokens(e,n,d,u,e.access_token,C.tenantId,o),C}createHomeAccountIdentifier(e,n){return Zo.generateHomeAccountId(e.client_info||Ot.EMPTY_STRING,dc.Default,this.logger,this.browserCrypto,n)}generateScopes(e,n){return e.scope?Co.fromString(e.scope):Co.fromString(n.scope)}async generatePopAccessToken(e,n){if(n.tokenType===bi.POP&&n.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const o=new b_(this.browserCrypto),u={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce};if(!n.keyId)throw Xt(Q5);return o.signPopToken(e.access_token,n.keyId,u)}else return e.access_token}async generateAuthenticationResult(e,n,o,u,d,_){const v=this.addTelemetryFromNativeResponse(e),a=e.scope?Co.fromString(e.scope):Co.fromString(n.scope),C=e.account.properties||{},A=C.UID||o.oid||o.sub||Ot.EMPTY_STRING,k=C.TenantId||o.tid||Ot.EMPTY_STRING,O=lL(u.getAccountInfo(),void 0,o,e.id_token);O.nativeAccountId!==e.account.id&&(O.nativeAccountId=e.account.id);const R=await this.generatePopAccessToken(e,n),z=n.tokenType===bi.POP?bi.POP:bi.BEARER;return{authority:d,uniqueId:A,tenantId:k,scopes:a.asArray(),account:O,idToken:e.id_token,idTokenClaims:o,accessToken:R,fromCache:v?this.isResponseFromCache(v):!1,expiresOn:new Date(Number(_+e.expires_in)*1e3),tokenType:z,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(n=>{this.logger.error(`Error occurred while removing account context from browser storage. ${n}`)})}cacheNativeTokens(e,n,o,u,d,_,v){const a=WA(o,n.authority,e.id_token||"",n.clientId,u.tid||""),C=n.tokenType===bi.POP?Ot.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,A=v+C,k=this.generateScopes(e,n),O=qA(o,n.authority,d,n.clientId,u.tid||_,k.printScopes(),A,0,fu,void 0,n.tokenType,void 0,n.keyId),R={idToken:a,accessToken:O};this.nativeStorageManager.saveCacheRecord(R,n.storeInCache)}addTelemetryFromNativeResponse(e){const n=this.getMATSFromResponse(e);return n?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:n.broker_version,matsAccountJoinOnStart:n.account_join_on_start,matsAccountJoinOnEnd:n.account_join_on_end,matsDeviceJoin:n.device_join,matsPromptBehavior:n.prompt_behavior,matsApiErrorCode:n.api_error_code,matsUiVisible:n.ui_visible,matsSilentCode:n.silent_code,matsSilentBiSubCode:n.silent_bi_sub_code,matsSilentMessage:n.silent_message,matsSilentStatus:n.silent_status,matsHttpStatus:n.http_status,matsHttpEventCount:n.http_event_count},this.correlationId),n):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw TK(W5,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const n=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority(n,e.azureCloudOptions,e.account);const o=new ei(n);o.validateAsUri();const{scopes:u,...d}=e,_=new Co(u||[]);_.appendScopes(N_);const v=()=>{switch(this.apiId){case Ni.ssoSilent:case Ni.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),as.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case as.NONE:case as.CONSENT:case as.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Fr(WY)}},a={...d,accountId:this.accountId,clientId:this.config.auth.clientId,authority:o.urlString,scope:_.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:v(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw Fr(KY);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry=Tg.MATS_TELEMETRY,e.authenticationScheme===bi.POP){const C={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},A=new b_(this.browserCrypto);let k;if(a.keyId)k=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const O=await hr(A.generateCnf.bind(A),vt.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(C,this.logger);k=O.reqCnfString,a.keyId=O.kid,a.signPopToken=!0}a.reqCnf=k}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(TR.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(TR.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(v_)){const n=e.extraParameters[v_],o=e.redirectUri,u=e.extraParameters[TR.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:n,child_redirect_uri:o},e.redirectUri=u}}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class lu{constructor(e,n,o,u){this.logger=e,this.handshakeTimeoutMs=n,this.extensionId=u,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=o,this.handshakeEvent=o.startMeasurement(vt.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const n={channel:Tg.CHANNEL_ID,extensionId:this.extensionId,responseId:bh(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n),new Promise((o,u)=>{this.resolvers.set(n.responseId,{resolve:o,reject:u})})}static async createProvider(e,n,o){e.trace("NativeMessageHandler - createProvider called.");try{const u=new lu(e,n,o,Tg.PREFERRED_EXTENSION_ID);return await u.sendHandshakeRequest(),u}catch{const d=new lu(e,n,o);return await d.sendHandshakeRequest(),d}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Tg.CHANNEL_ID,extensionId:this.extensionId,responseId:bh(),body:{method:Vp.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=n=>{this.onChannelMessage(n)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((n,o)=>{this.handshakeResolvers.set(e.responseId,{resolve:n,reject:o}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),o(Fr(VY)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const n=e.data;if(!(!n.channel||n.channel!==Tg.CHANNEL_ID)&&!(n.extensionId&&n.extensionId!==this.extensionId)&&n.body.method===Vp.HandshakeRequest){const o=this.handshakeResolvers.get(n.responseId);if(!o){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${n.responseId}`);return}this.logger.verbose(n.extensionId?`Extension with id: ${n.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),o.reject(Fr(HY))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const n=e.data,o=this.resolvers.get(n.responseId),u=this.handshakeResolvers.get(n.responseId);try{const d=n.body.method;if(d===Vp.Response){if(!o)return;const _=n.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(_)}`),_.status!=="Success")o.reject(Y4(_.code,_.description,_.ext));else if(_.result)_.result.code&&_.result.description?o.reject(Y4(_.result.code,_.result.description,_.result.ext)):o.resolve(_.result);else throw TK(W5,"Event does not contain result.");this.resolvers.delete(n.responseId)}else if(d===Vp.HandshakeResponse){if(!u){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${n.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=n.extensionId,this.extensionVersion=n.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),u.resolve(),this.handshakeResolvers.delete(n.responseId)}}catch(d){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${d}`),this.logger.errorPii(`Unable to parse ${e}`),o?o.reject(d):u&&u.reject(d)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,n,o,u){if(n.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return n.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!o)return n.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(u)switch(u){case bi.BEARER:case bi.POP:return n.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return n.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class IL{constructor(e,n,o,u,d){this.authModule=e,this.browserStorage=n,this.authCodeRequest=o,this.logger=u,this.performanceClient=d}async handleCodeResponse(e,n){this.performanceClient.addQueueMeasurement(vt.HandleCodeResponse,n.correlationId);let o;try{o=this.authModule.handleFragmentResponse(e,n.state)}catch(u){throw u instanceof hf&&u.subError===pm?Fr(pm):u}return hr(this.handleCodeResponseFromServer.bind(this),vt.HandleCodeResponseFromServer,this.logger,this.performanceClient,n.correlationId)(o,n)}async handleCodeResponseFromServer(e,n,o=!0){if(this.performanceClient.addQueueMeasurement(vt.HandleCodeResponseFromServer,n.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await hr(this.authModule.updateAuthority.bind(this.authModule),vt.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,n.correlationId)(e.cloud_instance_host_name,n.correlationId),o&&(e.nonce=n.nonce||void 0),e.state=n.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const d=this.createCcsCredentials(n);d&&(this.authCodeRequest.ccsCredential=d)}return await hr(this.authModule.acquireToken.bind(this.authModule),vt.AuthClientAcquireToken,this.logger,this.performanceClient,n.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:qa.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:qa.UPN}:null}}/*! @azure/msal-browser v3.20.0 2024-07-23 */function sZ(t,e,n){const o=ZS(t);if(!o)throw oY(t)?(n.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${e} detected is: ${t}`),Fr(CY)):(n.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Fr(wY));return o}function KEe(t,e,n){if(!t.state)throw Fr(gL);const o=rZ(e,t.state);if(!o)throw Fr(EY);if(o.interactionType!==n)throw Fr(SY)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class YEe extends U_{constructor(e,n,o,u,d,_,v,a,C,A){super(e,n,o,u,d,_,v,C,A),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a}acquireToken(e){try{const n=this.generatePopupName(e.scopes||N_,e.authority||this.config.auth.authority),o=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,o);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const u=this.openSizedPopup("about:blank",n,o);return this.acquireTokenPopupAsync(e,n,o,u)}}catch(n){return Promise.reject(n)}}logout(e){try{this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),o=this.generateLogoutPopupName(n),u=e&&e.authority,d=e&&e.mainWindowRedirectUri,_=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,o,_,u,void 0,d);{this.logger.verbose("asyncPopup set to false, opening popup");const v=this.openSizedPopup("about:blank",o,_);return this.logoutPopupAsync(n,o,_,u,v,d)}}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,n,o,u){this.logger.verbose("acquireTokenPopupAsync called");const d=this.initializeServerTelemetryManager(Ni.acquireTokenPopup),_=await hr(this.initializeAuthorizationRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qr.Popup);tZ(_.authority);try{const v=await hr(this.initializeAuthorizationCodeRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(_),a=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(d,_.authority,_.azureCloudOptions,_.account),C=lu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let A;C&&(A=this.performanceClient.startMeasurement(vt.FetchAccountIdWithNativeBroker,e.correlationId));const k=await a.getAuthCodeUrl({..._,nativeBroker:C}),O=new IL(a,this.browserStorage,v,this.logger,this.performanceClient),R={popup:u,popupName:n,popupWindowAttributes:o},z=this.initiateAuthRequest(k,R);this.eventHandler.emitEvent(Or.POPUP_OPENED,qr.Popup,{popupWindow:z},null);const N=await this.monitorPopupForHash(z),K=Tm(sZ,vt.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(N,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(iu.removeThrottle(this.browserStorage,this.config.auth.clientId,v),K.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),A&&A.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Fr(eb);const j=new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,K.accountId,this.nativeStorage,_.correlationId),{userRequestState:H}=wc.parseRequestState(this.browserCrypto,_.state);return await j.acquireToken({..._,state:H,prompt:void 0})}return await O.handleCodeResponse(K,_)}catch(v){throw u&&u.close(),v instanceof go&&(v.setCorrelationId(this.correlationId),d.cacheFailedRequest(v)),v}}async logoutPopupAsync(e,n,o,u,d,_){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Or.LOGOUT_START,qr.Popup,e);const v=this.initializeServerTelemetryManager(Ni.logoutPopup);try{await this.clearCacheOnLogout(e.account);const a=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(v,u,void 0,e.account||void 0);try{a.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&a.authority.protocolMode===fh.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(Or.LOGOUT_SUCCESS,qr.Popup,e),_){const k={apiId:Ni.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},O=ei.getAbsoluteUrl(_,uh());await this.navigationClient.navigateInternal(O,k)}d&&d.close();return}}const C=a.getLogoutUri(e);this.eventHandler.emitEvent(Or.LOGOUT_SUCCESS,qr.Popup,e);const A=this.openPopup(C,{popupName:n,popupWindowAttributes:o,popup:d});if(this.eventHandler.emitEvent(Or.POPUP_OPENED,qr.Popup,{popupWindow:A},null),await this.monitorPopupForHash(A).catch(()=>{}),_){const k={apiId:Ni.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},O=ei.getAbsoluteUrl(_,uh());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${O}`),await this.navigationClient.navigateInternal(O,k)}else this.logger.verbose("No main window navigation requested")}catch(a){throw d&&d.close(),a instanceof go&&(a.setCorrelationId(this.correlationId),v.cacheFailedRequest(a)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Or.LOGOUT_FAILURE,qr.Popup,null,a),this.eventHandler.emitEvent(Or.LOGOUT_END,qr.Popup),a}this.eventHandler.emitEvent(Or.LOGOUT_END,qr.Popup)}initiateAuthRequest(e,n){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,n);throw this.logger.error("Navigate url is empty"),Fr(YA)}monitorPopupForHash(e){return new Promise((n,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const u=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(u),o(Fr(pm));return}let d="";try{d=e.location.href}catch{}if(!d||d==="about:blank")return;clearInterval(u);let _="";const v=this.config.auth.OIDCOptions.serverResponseType;e&&(v===J1.QUERY?_=e.location.search:_=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n(_)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e)})}openPopup(e,n){try{let o;if(n.popup?(o=n.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),o.location.assign(e)):typeof n.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),o=this.openSizedPopup(e,n.popupName,n.popupWindowAttributes)),!o)throw Fr(IY);return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(o){throw this.logger.error("error opening popup "+o.message),this.browserStorage.setInteractionInProgress(!1),Fr(AY)}}openSizedPopup(e,n,o){const u=window.screenLeft?window.screenLeft:window.screenX,d=window.screenTop?window.screenTop:window.screenY,_=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,v=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let a=o.popupSize?.width,C=o.popupSize?.height,A=o.popupPosition?.top,k=o.popupPosition?.left;return(!a||a<0||a>_)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),a=Tl.POPUP_WIDTH),(!C||C<0||C>v)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),C=Tl.POPUP_HEIGHT),(!A||A<0||A>v)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),A=Math.max(0,v/2-Tl.POPUP_HEIGHT/2+d)),(!k||k<0||k>_)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),k=Math.max(0,_/2-Tl.POPUP_WIDTH/2+u)),window.open(e,n,`width=${a}, height=${C}, top=${A}, left=${k}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(qr.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,n){return`${Tl.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${n}.${this.correlationId}`}generateLogoutPopupName(e){const n=e.account&&e.account.homeAccountId;return`${Tl.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${n}.${this.correlationId}`}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class y7{constructor(e,n,o,u,d){this.authModule=e,this.browserStorage=n,this.authCodeRequest=o,this.logger=u,this.performanceClient=d}async initiateAuthRequest(e,n){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(mi.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(mi.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const o={apiId:Ni.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1};if(typeof n.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await n.navigationClient.navigateExternal(e,o);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await n.navigationClient.navigateExternal(e,o);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Fr(YA)}async handleCodeResponse(e,n){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const o=this.browserStorage.generateStateKey(n),u=this.browserStorage.getTemporaryCache(o);if(!u)throw Xt(YS,"Cached State");let d;try{d=this.authModule.handleFragmentResponse(e,u)}catch(C){throw C instanceof hf&&C.subError===pm?Fr(pm):C}const _=this.browserStorage.generateNonceKey(u),v=this.browserStorage.getTemporaryCache(_);if(this.authCodeRequest.code=d.code,d.cloud_instance_host_name&&await hr(this.authModule.updateAuthority.bind(this.authModule),vt.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(d.cloud_instance_host_name,this.authCodeRequest.correlationId),d.nonce=v||void 0,d.state=u,d.client_info)this.authCodeRequest.clientInfo=d.client_info;else{const C=this.checkCcsCredentials();C&&(this.authCodeRequest.ccsCredential=C)}const a=await this.authModule.acquireToken(this.authCodeRequest,d);return this.browserStorage.cleanRequestByState(n),a}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(mi.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class ZEe extends U_{constructor(e,n,o,u,d,_,v,a,C,A){super(e,n,o,u,d,_,v,C,A),this.nativeStorage=a}async acquireToken(e){const n=await hr(this.initializeAuthorizationRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qr.Redirect);this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null);const o=this.initializeServerTelemetryManager(Ni.acquireTokenRedirect),u=d=>{d.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(n.state),this.eventHandler.emitEvent(Or.RESTORE_FROM_BFCACHE,qr.Redirect))};try{const d=await hr(this.initializeAuthorizationCodeRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n),_=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(o,n.authority,n.azureCloudOptions,n.account),v=new y7(_,this.browserStorage,d,this.logger,this.performanceClient),a=await _.getAuthCodeUrl({...n,nativeBroker:lu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),C=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${C}`),window.addEventListener("pageshow",u),await v.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:C,onRedirectNavigate:e.onRedirectNavigate})}catch(d){throw d instanceof go&&(d.setCorrelationId(this.correlationId),o.cacheFailedRequest(d)),window.removeEventListener("pageshow",u),this.browserStorage.cleanRequestByState(n.state),d}}async handleRedirectPromise(e="",n){const o=this.initializeServerTelemetryManager(Ni.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[u,d]=this.getRedirectResponse(e||"");if(!u)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(qr.Redirect),n.event.errorCode="no_server_response",null;const _=this.browserStorage.getTemporaryCache(mi.ORIGIN_URI,!0)||Ot.EMPTY_STRING,v=ei.removeHashFromUrl(_),a=ei.removeHashFromUrl(window.location.href);if(v===a&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),_.indexOf("#")>-1&&cEe(_),await this.handleResponse(u,o);if(this.config.auth.navigateToLoginRequestUrl){if(!EL()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(mi.URL_HASH,d,!0);const C={apiId:Ni.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let A=!0;if(!_||_==="null"){const k=hEe();this.browserStorage.setTemporaryCache(mi.ORIGIN_URI,k,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),A=await this.navigationClient.navigateInternal(k,C)}else this.logger.verbose(`Navigating to loginRequestUrl: ${_}`),A=await this.navigationClient.navigateInternal(_,C);if(!A)return await this.handleResponse(u,o)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(u,o);return null}catch(u){throw u instanceof go&&(u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u)),this.browserStorage.cleanRequestByInteractionType(qr.Redirect),u}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let n=e;n||(this.config.auth.OIDCOptions.serverResponseType===J1.QUERY?n=window.location.search:n=window.location.hash);let o=ZS(n);if(o){try{KEe(o,this.browserCrypto,qr.Redirect)}catch(d){return d instanceof go&&this.logger.error(`Interaction type validation failed due to ${d.errorCode}: ${d.errorMessage}`),[null,""]}return lEe(window),this.logger.verbose("Hash contains known properties, returning response hash"),[o,n]}const u=this.browserStorage.getTemporaryCache(mi.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(mi.URL_HASH)),u&&(o=ZS(u),o)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[o,u]):[null,""]}async handleResponse(e,n){const o=e.state;if(!o)throw Fr(gL);const u=this.browserStorage.getCachedRequest(o);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Fr(eb);const a=new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,u.correlationId),{userRequestState:C}=wc.parseRequestState(this.browserCrypto,o);return a.acquireToken({...u,state:C,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(o)})}const d=this.browserStorage.getCachedAuthority(o);if(!d)throw Fr(_L);const _=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,d);return iu.removeThrottle(this.browserStorage,this.config.auth.clientId,u),new y7(_,this.browserStorage,u,this.logger,this.performanceClient).handleCodeResponse(e,o)}async logout(e){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e),o=this.initializeServerTelemetryManager(Ni.logout);try{this.eventHandler.emitEvent(Or.LOGOUT_START,qr.Redirect,e),await this.clearCacheOnLogout(n.account);const u={apiId:Ni.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},d=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(o,e&&e.authority,void 0,e&&e.account||void 0);if(d.authority.protocolMode===fh.OIDC)try{d.authority.endSessionEndpoint}catch{if(n.account?.homeAccountId){this.browserStorage.removeAccount(n.account?.homeAccountId),this.eventHandler.emitEvent(Or.LOGOUT_SUCCESS,qr.Redirect,n);return}}const _=d.getLogoutUri(n);if(this.eventHandler.emitEvent(Or.LOGOUT_SUCCESS,qr.Redirect,n),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(_)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(_,u);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(_,u);return}}catch(u){throw u instanceof go&&(u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u)),this.eventHandler.emitEvent(Or.LOGOUT_FAILURE,qr.Redirect,null,u),this.eventHandler.emitEvent(Or.LOGOUT_END,qr.Redirect),u}this.eventHandler.emitEvent(Or.LOGOUT_END,qr.Redirect)}getRedirectStartPage(e){const n=e||window.location.href;return ei.getAbsoluteUrl(n,uh())}}/*! @azure/msal-browser v3.20.0 2024-07-23 */async function XEe(t,e,n,o,u){if(e.addQueueMeasurement(vt.SilentHandlerInitiateAuthRequest,o),!t)throw n.info("Navigate url is empty"),Fr(YA);return u?hr(JEe,vt.SilentHandlerLoadFrame,n,e,o)(t,u,e,o):Tm(eSe,vt.SilentHandlerLoadFrameSync,n,e,o)(t)}async function QEe(t,e,n,o,u,d,_){return o.addQueueMeasurement(vt.SilentHandlerMonitorIframeForHash,d),new Promise((v,a)=>{e<W4&&u.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${W4}ms). This may result in timeouts.`);const C=window.setTimeout(()=>{window.clearInterval(A),a(Fr(MY))},e),A=window.setInterval(()=>{let k="";const O=t.contentWindow;try{k=O?O.location.href:""}catch{}if(!k||k==="about:blank")return;let R="";O&&(_===J1.QUERY?R=O.location.search:R=O.location.hash),window.clearTimeout(C),window.clearInterval(A),v(R)},n)}).finally(()=>{Tm(tSe,vt.RemoveHiddenIframe,u,o,d)(t)})}function JEe(t,e,n,o){return n.addQueueMeasurement(vt.SilentHandlerLoadFrame,o),new Promise((u,d)=>{const _=aZ();window.setTimeout(()=>{if(!_){d("Unable to load iframe");return}_.src=t,u(_)},e)})}function eSe(t){const e=aZ();return e.src=t,e}function aZ(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function tSe(t){document.body===t.parentNode&&document.body.removeChild(t)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class rSe extends U_{constructor(e,n,o,u,d,_,v,a,C,A,k){super(e,n,o,u,d,_,a,A,k),this.apiId=v,this.nativeStorage=C}async acquireToken(e){this.performanceClient.addQueueMeasurement(vt.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const n={...e};n.prompt?n.prompt!==as.NONE&&n.prompt!==as.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${as.NONE}`),n.prompt=as.NONE):n.prompt=as.NONE;const o=await hr(this.initializeAuthorizationRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,qr.Silent);tZ(o.authority);const u=this.initializeServerTelemetryManager(this.apiId);try{const d=await hr(this.createAuthCodeClient.bind(this),vt.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(u,o.authority,o.azureCloudOptions,o.account);return await hr(this.silentTokenHelper.bind(this),vt.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(d,o)}catch(d){throw d instanceof go&&(d.setCorrelationId(this.correlationId),u.cacheFailedRequest(d)),d}}logout(){return Promise.reject(Fr(ZA))}async silentTokenHelper(e,n){const o=n.correlationId;this.performanceClient.addQueueMeasurement(vt.SilentIframeClientTokenHelper,o);const u=await hr(this.initializeAuthorizationCodeRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,o)(n),d=await hr(e.getAuthCodeUrl.bind(e),vt.GetAuthCodeUrl,this.logger,this.performanceClient,o)({...n,nativeBroker:lu.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)}),_=new IL(e,this.browserStorage,u,this.logger,this.performanceClient),v=await hr(XEe,vt.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,o)(d,this.performanceClient,this.logger,o,this.config.system.navigateFrameWait),a=this.config.auth.OIDCOptions.serverResponseType,C=await hr(QEe,vt.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,o)(v,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,o,a),A=Tm(sZ,vt.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(C,a,this.logger);if(A.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Fr(eb);const k=new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,A.accountId,this.browserStorage,o),{userRequestState:O}=wc.parseRequestState(this.browserCrypto,n.state);return hr(k.acquireToken.bind(k),vt.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,o)({...n,state:O,prompt:n.prompt||as.NONE})}return hr(_.handleCodeResponse.bind(_),vt.HandleCodeResponse,this.logger,this.performanceClient,o)(A,n)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class nSe extends U_{async acquireToken(e){this.performanceClient.addQueueMeasurement(vt.SilentRefreshClientAcquireToken,e.correlationId);const n=await hr(AL,vt.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),o={...e,...n};e.redirectUri&&(o.redirectUri=this.getRedirectUri(e.redirectUri));const u=this.initializeServerTelemetryManager(Ni.acquireTokenSilent_silentFlow),d=await this.createRefreshTokenClient(u,o.authority,o.azureCloudOptions,o.account);return hr(d.acquireTokenByRefreshToken.bind(d),vt.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(o).catch(_=>{throw _.setCorrelationId(this.correlationId),u.cacheFailedRequest(_),_})}logout(){return Promise.reject(Fr(ZA))}async createRefreshTokenClient(e,n,o,u){const d=await hr(this.getClientConfiguration.bind(this),vt.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,n,o,u);return new V4(d,this.performanceClient)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class iSe{constructor(e,n,o,u){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=n,this.logger=o,this.cryptoObj=u}loadExternalTokens(e,n,o){if(!this.isBrowserEnvironment)throw Fr(yL);const u=n.id_token?Sm(n.id_token,fu):void 0,d={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},_=e.authority?new zs(zs.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,d,this.logger,e.correlationId||bh()):void 0,v=this.loadAccount(e,o.clientInfo||n.client_info||"",u,_),a=this.loadIdToken(n,v.homeAccountId,v.environment,v.realm),C=this.loadAccessToken(e,n,v.homeAccountId,v.environment,v.realm,o),A=this.loadRefreshToken(n,v.homeAccountId,v.environment);return this.generateAuthenticationResult(e,{account:v,idToken:a,accessToken:C,refreshToken:A},u,_)}loadAccount(e,n,o,u){if(this.logger.verbose("TokenCache - loading account"),e.account){const a=Zo.createFromAccountInfo(e.account);return this.storage.setAccount(a),a}else if(!u||!n&&!o)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Fr(zY);const d=Zo.generateHomeAccountId(n,u.authorityType,this.logger,this.cryptoObj,o),_=o?.tid,v=dL(this.storage,u,d,fu,o,n,u.hostnameAndPort,_,void 0,void 0,this.logger);return this.storage.setAccount(v),v}loadIdToken(e,n,o,u){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const d=WA(n,o,e.id_token,this.config.auth.clientId,u);return this.storage.setIdTokenCredential(d),d}loadAccessToken(e,n,o,u,d,_){if(n.access_token)if(n.expires_in){if(!n.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const v=n.scope?Co.fromString(n.scope):new Co(e.scopes),a=_.expiresOn||n.expires_in+new Date().getTime()/1e3,C=_.extendedExpiresOn||(n.ext_expires_in||n.expires_in)+new Date().getTime()/1e3,A=qA(o,u,n.access_token,this.config.auth.clientId,d,v.printScopes(),a,C,fu);return this.storage.setAccessTokenCredential(A),A}loadRefreshToken(e,n,o){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const u=lY(n,o,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(u),u}generateAuthenticationResult(e,n,o,u){let d="",_=[],v=null,a;n?.accessToken&&(d=n.accessToken.secret,_=Co.fromString(n.accessToken.target).asArray(),v=new Date(Number(n.accessToken.expiresOn)*1e3),a=new Date(Number(n.accessToken.extendedExpiresOn)*1e3));const C=n.account;return{authority:u?u.canonicalAuthority:"",uniqueId:n.account.localAccountId,tenantId:n.account.realm,scopes:_,account:C.getAccountInfo(),idToken:n.idToken?.secret||"",idTokenClaims:o||{},accessToken:d,fromCache:!0,expiresOn:v,correlationId:e.correlationId||"",requestId:"",extExpiresOn:a,familyId:n.refreshToken?.familyId||"",tokenType:n?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:C.cloudGraphHostName||"",msGraphHost:C.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class oSe extends _Y{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.20.0 2024-07-23 */class sSe extends U_{constructor(e,n,o,u,d,_,v,a,C,A){super(e,n,o,u,d,_,a,C,A),this.apiId=v}async acquireToken(e){if(!e.code)throw Fr(NY);const n=await hr(this.initializeAuthorizationRequest.bind(this),vt.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,qr.Silent),o=this.initializeServerTelemetryManager(this.apiId);try{const u={...n,code:e.code},d=await hr(this.getClientConfiguration.bind(this),vt.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)(o,n.authority,n.azureCloudOptions,n.account),_=new oSe(d);this.logger.verbose("Auth code client created");const v=new IL(_,this.browserStorage,u,this.logger,this.performanceClient);return await hr(v.handleCodeResponseFromServer.bind(v),vt.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},n,!1)}catch(u){throw u instanceof go&&(u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u)),u}}logout(){return Promise.reject(Fr(ZA))}}/*! @azure/msal-browser v3.20.0 2024-07-23 */function Kc(t){const e=t?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function ZC(t,e){try{SL(t)}catch(n){throw e.end({success:!1},n),n}}class JA{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new w_(this.logger,this.performanceClient):QS,this.eventHandler=new DEe(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new K4(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,kwe(this.config.auth),this.performanceClient):SEe(this.config.auth.clientId,this.logger);const n={cacheLocation:Ko.MemoryStorage,temporaryCacheLocation:Ko.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new K4(this.config.auth.clientId,n,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new iSe(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,n){const o=new JA(e);return await o.initialize(n),o}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}const n=e?.correlationId||this.getRequestCorrelationId(),o=this.config.system.allowNativeBroker,u=this.performanceClient.startMeasurement(vt.InitializeClientApplication,n);if(this.eventHandler.emitEvent(Or.INITIALIZE_START),o)try{this.nativeExtensionProvider=await lu.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(d){this.logger.verbose(d)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await hr(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),vt.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,n)(this.performanceClient,n)),this.initialized=!0,this.eventHandler.emitEvent(Or.INITIALIZE_END),u.end({allowNativeBroker:o,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),eZ(this.initialized),this.isBrowserEnvironment){const n=e||"";let o=this.redirectResponse.get(n);return typeof o>"u"?(o=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(n,o),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),o}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const n=this.getAllAccounts(),o=this.browserStorage.getCachedNativeRequest(),u=o&&lu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,d=u?o?.correlationId:this.browserStorage.getTemporaryCache(mi.CORRELATION_ID,!0)||"",_=this.performanceClient.startMeasurement(vt.AcquireTokenRedirect,d);this.eventHandler.emitEvent(Or.HANDLE_REDIRECT_START,qr.Redirect);let v;if(u&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const a=new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId);v=hr(a.handleRedirectPromise.bind(a),vt.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,_.event.correlationId)(this.performanceClient,_.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const a=this.createRedirectClient(d);v=hr(a.handleRedirectPromise.bind(a),vt.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,_.event.correlationId)(e,_)}return v.then(a=>(a?(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Or.LOGIN_SUCCESS,qr.Redirect,a),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_SUCCESS,qr.Redirect,a),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),_.end({success:!0,accountType:Kc(a.account)})):_.event.errorCode?_.end({success:!1}):_.discard(),this.eventHandler.emitEvent(Or.HANDLE_REDIRECT_END,qr.Redirect),a)).catch(a=>{const C=a;throw n.length>0?this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_FAILURE,qr.Redirect,null,C):this.eventHandler.emitEvent(Or.LOGIN_FAILURE,qr.Redirect,null,C),this.eventHandler.emitEvent(Or.HANDLE_REDIRECT_END,qr.Redirect),_.end({success:!1},C),a})}async acquireTokenRedirect(e){const n=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",n);const o=this.performanceClient.startMeasurement(vt.AcquireTokenPreRedirect,n);o.add({accountType:Kc(e.account),scenarioId:e.scenarioId});const u=e.onRedirectNavigate;e.onRedirectNavigate=_=>{const v=typeof u=="function"?u(_):void 0;return v!==!1?o.end({success:!0}):o.discard(),v};const d=this.getAllAccounts().length>0;try{m7(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),d?this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_START,qr.Redirect,e):this.eventHandler.emitEvent(Or.LOGIN_START,qr.Redirect,e);let _;return this.nativeExtensionProvider&&this.canUseNative(e)?_=new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,n).acquireTokenRedirect(e,o).catch(a=>{if(a instanceof ou&&og(a))return this.nativeExtensionProvider=void 0,this.createRedirectClient(n).acquireToken(e);if(a instanceof Sc)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),a}):_=this.createRedirectClient(n).acquireToken(e),await _}catch(_){throw o.end({success:!1},_),d?this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_FAILURE,qr.Redirect,null,_):this.eventHandler.emitEvent(Or.LOGIN_FAILURE,qr.Redirect,null,_),_}}acquireTokenPopup(e){const n=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement(vt.AcquireTokenPopup,n);o.add({scenarioId:e.scenarioId,accountType:Kc(e.account)});try{this.logger.verbose("acquireTokenPopup called",n),ZC(this.initialized,o),this.browserStorage.setInteractionInProgress(!0)}catch(_){return Promise.reject(_)}const u=this.getAllAccounts();u.length>0?this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_START,qr.Popup,e):this.eventHandler.emitEvent(Or.LOGIN_START,qr.Popup,e);let d;return this.canUseNative(e)?d=this.acquireTokenNative({...e,correlationId:n},Ni.acquireTokenPopup).then(_=>(this.browserStorage.setInteractionInProgress(!1),o.end({success:!0,isNativeBroker:!0,requestId:_.requestId,accountType:Kc(_.account)}),_)).catch(_=>{if(_ instanceof ou&&og(_))return this.nativeExtensionProvider=void 0,this.createPopupClient(n).acquireToken(e);if(_ instanceof Sc)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),_}):d=this.createPopupClient(n).acquireToken(e),d.then(_=>(u.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Or.LOGIN_SUCCESS,qr.Popup,_):this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_SUCCESS,qr.Popup,_),o.end({success:!0,requestId:_.requestId,accessTokenSize:_.accessToken.length,idTokenSize:_.idToken.length,accountType:Kc(_.account)}),_)).catch(_=>(u.length>0?this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_FAILURE,qr.Popup,null,_):this.eventHandler.emitEvent(Or.LOGIN_FAILURE,qr.Popup,null,_),o.end({success:!1},_),Promise.reject(_)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const n=this.getRequestCorrelationId(e),o={...e,prompt:e.prompt,correlationId:n};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(vt.SsoSilent,n),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Kc(e.account)}),ZC(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(Or.SSO_SILENT_START,qr.Silent,o);let u;return this.canUseNative(o)?u=this.acquireTokenNative(o,Ni.ssoSilent).catch(d=>{if(d instanceof ou&&og(d))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(o.correlationId).acquireToken(o);throw d}):u=this.createSilentIframeClient(o.correlationId).acquireToken(o),u.then(d=>(this.eventHandler.emitEvent(Or.SSO_SILENT_SUCCESS,qr.Silent,d),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:d.fromNativeBroker,requestId:d.requestId,accessTokenSize:d.accessToken.length,idTokenSize:d.idToken.length,accountType:Kc(d.account)}),d)).catch(d=>{throw this.eventHandler.emitEvent(Or.SSO_SILENT_FAILURE,qr.Silent,null,d),this.ssoSilentMeasurement?.end({success:!1},d),d}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const n=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",n);const o=this.performanceClient.startMeasurement(vt.AcquireTokenByCode,n);ZC(this.initialized,o),this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_BY_CODE_START,qr.Silent,e),o.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Fr($Y);if(e.code){const u=e.code;let d=this.hybridAuthCodeResponses.get(u);return d?(this.logger.verbose("Existing acquireTokenByCode request found",n),o.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),d=this.acquireTokenByCodeAsync({...e,correlationId:n}).then(_=>(this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_BY_CODE_SUCCESS,qr.Silent,_),this.hybridAuthCodeResponses.delete(u),o.end({success:!0,isNativeBroker:_.fromNativeBroker,requestId:_.requestId,accessTokenSize:_.accessToken.length,idTokenSize:_.idToken.length,accountType:Kc(_.account)}),_)).catch(_=>{throw this.hybridAuthCodeResponses.delete(u),this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_BY_CODE_FAILURE,qr.Silent,null,_),o.end({success:!1},_),_}),this.hybridAuthCodeResponses.set(u,d)),await d}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const u=await this.acquireTokenNative({...e,correlationId:n},Ni.acquireTokenByCode,e.nativeAccountId).catch(d=>{throw d instanceof ou&&og(d)&&(this.nativeExtensionProvider=void 0),d});return o.end({accountType:Kc(u.account),success:!0}),u}else throw Fr(jY);else throw Fr(UY)}catch(u){throw this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_BY_CODE_FAILURE,qr.Silent,null,u),o.end({success:!1},u),u}}async acquireTokenByCodeAsync(e){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(vt.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(u=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,requestId:u.requestId}),u)).catch(u=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},u),u}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,n){switch(this.performanceClient.addQueueMeasurement(vt.AcquireTokenFromCache,e.correlationId),n){case Fa.Default:case Fa.AccessToken:case Fa.AccessTokenAndRefreshToken:const o=this.createSilentCacheClient(e.correlationId);return hr(o.acquireToken.bind(o),vt.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Xt(ch)}}async acquireTokenByRefreshToken(e,n){switch(this.performanceClient.addQueueMeasurement(vt.AcquireTokenByRefreshToken,e.correlationId),n){case Fa.Default:case Fa.AccessTokenAndRefreshToken:case Fa.RefreshToken:case Fa.RefreshTokenAndNetwork:const o=this.createSilentRefreshClient(e.correlationId);return hr(o.acquireToken.bind(o),vt.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw Xt(ch)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(vt.AcquireTokenBySilentIframe,e.correlationId);const n=this.createSilentIframeClient(e.correlationId);return hr(n.acquireToken.bind(n),vt.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const n=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),this.logoutRedirect({correlationId:n,...e})}async logoutRedirect(e){const n=this.getRequestCorrelationId(e);return m7(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(n).logout(e)}logoutPopup(e){try{const n=this.getRequestCorrelationId(e);return SL(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(n).logout(e)}catch(n){return Promise.reject(n)}}async clearCache(e){const n=this.getRequestCorrelationId(e);return this.createSilentCacheClient(n).logout(e)}getAllAccounts(e){return TEe(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return AEe(e,this.logger,this.browserStorage)}getAccountByUsername(e){return IEe(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return MEe(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return PEe(e,this.logger,this.browserStorage)}setActiveAccount(e){REe(e,this.browserStorage)}getActiveAccount(){return kEe(this.browserStorage)}async hydrateCache(e,n){this.logger.verbose("hydrateCache called");const o=Zo.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(o),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,n)):this.browserStorage.hydrateCache(e,n)}async acquireTokenNative(e,n,o){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Fr(eb);return new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,n,this.performanceClient,this.nativeExtensionProvider,o||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,n){if(this.logger.trace("canUseNative called"),!lu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case as.NONE:case as.CONSENT:case as.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!n&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const n=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return n&&n.nativeAccountId||""}createPopupClient(e){return new YEe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new ZEe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new rSe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new oZ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new nSe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new sSe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ni.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,n){this.browserStorage.setWrapperMetadata(e,n)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?bh():Ot.EMPTY_STRING}async loginRedirect(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",n),this.acquireTokenRedirect({correlationId:n,...e||d7})}loginPopup(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup({correlationId:n,...e||d7})}async acquireTokenSilent(e){const n=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement(vt.AcquireTokenSilent,n);o.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),ZC(this.initialized,o),this.logger.verbose("acquireTokenSilent called",n);const u=e.account||this.getActiveAccount();if(!u)throw Fr(DY);o.add({accountType:Kc(u)});const d={clientId:this.config.auth.clientId,authority:e.authority||Ot.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:u.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},_=JSON.stringify(d),v=this.activeSilentTokenRequests.get(_);if(typeof v>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n);const a=hr(this.acquireTokenSilentAsync.bind(this),vt.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)({...e,correlationId:n},u).then(C=>(this.activeSilentTokenRequests.delete(_),o.end({success:!0,fromCache:C.fromCache,isNativeBroker:C.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:C.requestId,accessTokenSize:C.accessToken.length,idTokenSize:C.idToken.length}),C)).catch(C=>{throw this.activeSilentTokenRequests.delete(_),o.end({success:!1},C),C});return this.activeSilentTokenRequests.set(_,a),{...await a,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),o.discard(),{...await v,state:e.state}}async acquireTokenSilentAsync(e,n){const o=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(vt.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_START,qr.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",o);const u=await hr(zEe,vt.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,n,this.config,this.performanceClient,this.logger),d=e.cacheLookupPolicy||Fa.Default;return this.acquireTokenSilentNoIframe(u,d).catch(async v=>{if(aSe(v,d))if(this.activeIframeRequest)if(d!==Fa.Skip){const[C,A]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${A}`,u.correlationId);const k=this.performanceClient.startMeasurement(vt.AwaitConcurrentIframe,u.correlationId);k.add({awaitIframeCorrelationId:A});const O=await C;if(k.end({success:O}),O)return this.logger.verbose(`Parallel iframe request with correlationId: ${A} succeeded. Retrying cache and/or RT redemption`,u.correlationId),this.acquireTokenSilentNoIframe(u,d);throw this.logger.info(`Iframe request with correlationId: ${A} failed. Interaction is required.`),v}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",u.correlationId),hr(this.acquireTokenBySilentIframe.bind(this),vt.AcquireTokenBySilentIframe,this.logger,this.performanceClient,u.correlationId)(u);else{let C;return this.activeIframeRequest=[new Promise(A=>{C=A}),u.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",u.correlationId),hr(this.acquireTokenBySilentIframe.bind(this),vt.AcquireTokenBySilentIframe,this.logger,this.performanceClient,u.correlationId)(u).then(A=>(C(!0),A)).catch(A=>{throw C(!1),A}).finally(()=>{this.activeIframeRequest=void 0})}else throw v}).then(v=>(this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_SUCCESS,qr.Silent,v),e.correlationId&&this.performanceClient.addFields({fromCache:v.fromCache,isNativeBroker:v.fromNativeBroker,requestId:v.requestId},e.correlationId),v)).catch(v=>{throw this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_FAILURE,qr.Silent,null,v),v}).finally(()=>{document.removeEventListener("visibilitychange",o)})}async acquireTokenSilentNoIframe(e,n){return lu.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Ni.acquireTokenSilent_silentFlow).catch(async o=>{throw o instanceof ou&&og(o)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Xt(ch)):o})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),hr(this.acquireTokenFromCache.bind(this),vt.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,n).catch(o=>{if(n===Fa.AccessToken)throw o;return this.eventHandler.emitEvent(Or.ACQUIRE_TOKEN_NETWORK_START,qr.Silent,e),hr(this.acquireTokenByRefreshToken.bind(this),vt.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,n)}))}}function aSe(t,e){const n=!(t instanceof Sc&&t.subError!==KA),o=t.errorCode===Tl.INVALID_GRANT_ERROR||t.errorCode===ch,u=n&&o||t.errorCode===tT||t.errorCode===hL,d=XCe.includes(e);return u&&d}/*! @azure/msal-browser v3.20.0 2024-07-23 */async function lSe(t,e){const n=new mm(t);return await n.initialize(),JA.createController(n,e)}/*! @azure/msal-browser v3.20.0 2024-07-23 */class ML{static async createPublicClientApplication(e){const n=await lSe(e);return new ML(e,n)}constructor(e,n){this.controller=n||new JA(new mm(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,n){return this.controller.initializeWrapperLibrary(e,n)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,n){return this.controller.hydrateCache(e,n)}clearCache(e){return this.controller.clearCache(e)}}/*! @azure/msal-browser v3.20.0 2024-07-23 */const cSe={initialize:()=>Promise.reject(Go(Lo)),acquireTokenPopup:()=>Promise.reject(Go(Lo)),acquireTokenRedirect:()=>Promise.reject(Go(Lo)),acquireTokenSilent:()=>Promise.reject(Go(Lo)),acquireTokenByCode:()=>Promise.reject(Go(Lo)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(Go(Lo)),loginPopup:()=>Promise.reject(Go(Lo)),loginRedirect:()=>Promise.reject(Go(Lo)),logout:()=>Promise.reject(Go(Lo)),logoutRedirect:()=>Promise.reject(Go(Lo)),logoutPopup:()=>Promise.reject(Go(Lo)),ssoSilent:()=>Promise.reject(Go(Lo)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw Go(Lo)},getLogger:()=>{throw Go(Lo)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw Go(Lo)},hydrateCache:()=>Promise.reject(Go(Lo)),clearCache:()=>Promise.reject(Go(Lo))};/*! @azure/msal-browser v3.20.0 2024-07-23 */class uSe{static getInteractionStatusFromEvent(e,n){switch(e.eventType){case Or.LOGIN_START:return ns.Login;case Or.SSO_SILENT_START:return ns.SsoSilent;case Or.ACQUIRE_TOKEN_START:if(e.interactionType===qr.Redirect||e.interactionType===qr.Popup)return ns.AcquireToken;break;case Or.HANDLE_REDIRECT_START:return ns.HandleRedirect;case Or.LOGOUT_START:return ns.Logout;case Or.SSO_SILENT_SUCCESS:case Or.SSO_SILENT_FAILURE:if(n&&n!==ns.SsoSilent)break;return ns.None;case Or.LOGOUT_END:if(n&&n!==ns.Logout)break;return ns.None;case Or.HANDLE_REDIRECT_END:if(n&&n!==ns.HandleRedirect)break;return ns.None;case Or.LOGIN_SUCCESS:case Or.LOGIN_FAILURE:case Or.ACQUIRE_TOKEN_SUCCESS:case Or.ACQUIRE_TOKEN_FAILURE:case Or.RESTORE_FROM_BFCACHE:if(e.interactionType===qr.Redirect||e.interactionType===qr.Popup){if(n&&n!==ns.Login&&n!==ns.AcquireToken)break;return ns.None}break}return null}}/*! @azure/msal-react v2.0.22 2024-07-23 */const hSe={instance:cSe,inProgress:ns.None,accounts:[],logger:new uf({})},lZ=fe.createContext(hSe);lZ.Consumer;/*! @azure/msal-react v2.0.22 2024-07-23 */function v7(t,e){if(t.length!==e.length)return!1;const n=[...e];return t.every(o=>{const u=n.shift();return!o||!u?!1:o.homeAccountId===u.homeAccountId&&o.localAccountId===u.localAccountId&&o.username===u.username})}/*! @azure/msal-react v2.0.22 2024-07-23 */const dSe="@azure/msal-react",x7="2.0.22";/*! @azure/msal-react v2.0.22 2024-07-23 */const sT={UNBLOCK_INPROGRESS:"UNBLOCK_INPROGRESS",EVENT:"EVENT"},fSe=(t,e)=>{const{type:n,payload:o}=e;let u=t.inProgress;switch(n){case sT.UNBLOCK_INPROGRESS:t.inProgress===ns.Startup&&(u=ns.None,o.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case sT.EVENT:const _=o.message,v=uSe.getInteractionStatusFromEvent(_,t.inProgress);v&&(o.logger.info(`MsalProvider - ${_.eventType} results in setting inProgress from ${t.inProgress} to ${v}`),u=v);break;default:throw new Error(`Unknown action type: ${n}`)}const d=o.instance.getAllAccounts();return u!==t.inProgress&&!v7(d,t.accounts)?{...t,inProgress:u,accounts:d}:u!==t.inProgress?{...t,inProgress:u}:v7(d,t.accounts)?t:{...t,accounts:d}};function pSe({instance:t,children:e}){fe.useEffect(()=>{t.initializeWrapperLibrary(KCe.React,x7)},[t]);const n=fe.useMemo(()=>t.getLogger().clone(dSe,x7),[t]),[o,u]=fe.useReducer(fSe,void 0,()=>({inProgress:ns.Startup,accounts:t.getAllAccounts()}));fe.useEffect(()=>{const _=t.addEventCallback(v=>{u({payload:{instance:t,logger:n,message:v},type:sT.EVENT})});return n.verbose(`MsalProvider - Registered event callback with id: ${_}`),t.initialize().then(()=>{t.handleRedirectPromise().catch(()=>{}).finally(()=>{u({payload:{instance:t,logger:n},type:sT.UNBLOCK_INPROGRESS})})}).catch(()=>{}),()=>{_&&(n.verbose(`MsalProvider - Removing event callback ${_}`),t.removeEventCallback(_))}},[t,n]);const d={instance:t,inProgress:o.inProgress,accounts:o.accounts,logger:n};return wi.createElement(lZ.Provider,{value:d},e)}const mSe={auth:{clientId:"ecefa022-6260-483d-9e12-54c4a2851eca",authority:"https://login.microsoftonline.com/3813f100-8bc4-40d8-a07c-6bf6e0c7d53a",redirectUri:"http://localhost:3000"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},Z4=new ML(mSe);Z4.addEventCallback(t=>{t.eventType===Or.LOGIN_SUCCESS&&(console.log("pca eveny",t),Z4.setActiveAccount(t?.payload?.account))});const gSe=Gbe({onNeedRefresh(){confirm("New content available. Reload?")&&gSe(!0)}});AR.createRoot(document.getElementById("root")).render(Ke.jsx(wi.StrictMode,{children:Ke.jsx(Dde,{store:CK,children:Ke.jsx(EK,{loading:null,persistor:Nbe,children:Ke.jsx(pSe,{instance:Z4,children:Ke.jsx(Q1e,{})})})})}));
